define("odsp-next/pages/photos/odc/Photos",["require","exports","./PhotosViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Photos.html","./Photos.css","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/list/AllPhotosList","../../../controls/list/AlbumsList","../../../controls/list/SingleAlbumList","../../../controls/list/TagsList","../../../controls/list/TagGrid"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-photos",template:e("./Photos.html"),viewModel:o.default,synchronous:!0});t.default=n});define("odsp-next/pages/photos/odc/PhotosViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./PhotosCommandSet","../../baseInnerPage/od/DataManagerPageViewModel","../../../bindings/clientRect/ClientRectBinding","../../../bindings/component/ControlBinding","../../../bindings/contextMenu/ContextMenuHelper","../../../bindings/element/ElementBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../controls/infoPane/InfoPane.key","../../../controls/itemContent/album/AlbumItemContent.key","../../../controls/itemContent/albums/AlbumsContent.key","../../../controls/itemContent/albumsRoot/AlbumsRootItemContent.key","../../../controls/itemContent/folder/FolderItemContent","../../../controls/itemContent/onThisDay/OnThisDayItemContent.key","../../../controls/itemContent/photosRoot/PhotosRootItemContent","../../../controls/itemContent/tagsRoot/TagsRootItemContent.key","../../../controls/list/layouts/LayoutType","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/photos/Photos.resx","../../../controls/smartBannerV2/SmartBannerV2","../../../controls/transclusion/content/TransclusionContent","../../../dataSources/album/odc/AlbumDataSource","../../../dataSources/promotedPhotos/odc/PromotedPhotosDataSource","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../models/item/VirtualItemType","../../../providers/dataManager/files/FilesDataManager","../../../providers/dataManager/mapper/AlbumsDataManagerMapper","../../../providers/dataManager/photos/PhotosDataManager","../../../providers/itemHistory/ItemHistoryProvider","../../../providers/promotedPhotos/PromotedPhotosProvider","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../../utilities/features/Features"],function(a,e,t,i,s,o,r,l,d,u,m,c,h,p,g,x,f,v,P,b,y,S,A,_,C,I,T,w,H,k,M,B,R,D,V,L,E,N,O,K){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var F;!function(e){e[e.none=0]="none";e[e.allPhotos=1]="allPhotos";e[e.albums=2]="albums";e[e.autoAlbums=3]="autoAlbums";e[e.tags=4]="tags";e[e.places=5]="places";e[e.singleAlbum=6]="singleAlbum";e[e.singleTag=7]="singleTag";e[e.singlePlace=8]="singlePlace";e[e.search=9]="search";e[e.onThisDay=10]="onThisDay"}(F||(F={}));var n=function(n){t.__extends(e,n);function e(e){var o=n.call(this,e)||this;o.oneUpOverlayTagName=S.default.tagName;o.transclusionContentTagName=C.default.tagName;o.smartBannerTagName=_.default.tagName;o.addBindingHandlers({clientRect:l.default,element:m.default,scrollContainer:c.default,control:d.default});o._canMarqueeSelect=o.resources.consume(L.canUserSelect);var t=o.resources.consume(O.bundleLoader);o.haveDeferredControlsLoaded=t.getBundleInfo(1).isLoaded;t.queueBundle(1,function(){return new i.default(function(e,t){a(["odsp-next/controls/promotedPhotos/PromotedPhotos"],e,t)})});o.resources.expose(E.promotedPhotos,new(o.managed(T.default)));o.resources.expose(O.promotedPhotos,new(o.managed(V.default)));o.platform=o.resources.consume(s.platformDetection);o.resources.expose(O.itemHistory,new(o.managed(D.default)));o.infoPaneSpecification=d.toSpecification(h.resourceKey,{});o.photoType=o.createPureComputed(o._computePhotoType,{deferEvaluation:!0});o._activePivot=o.createPureComputed(o._computeActivePivot,{deferEvaluation:!0});o.createComputed(function(){var e=o.layoutType();o.isSuiteNavHamburgerVisible();var t=o.responsiveUI;o.isTopBarHamburgerVisible(e!==y.SingleAlbum&&0<t.compareSize(t.formFactorSize(),"Large"))});o.hideLeftNav(!0);o._initCommandSets();o.createBackgroundComputed(o._computeUpdateCanMarqueeSelect).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});var r=o.observables;o._photoPage=r.pureCompute(o._computePhotoPage);o.pivotHeading=r.pureCompute(o._computePivotHeading);o.shouldShowPromotedPhotos=o.createPureComputed(o._computeShouldShowPromotedPhotos);o.promotedPhotosParams={};o.createComputed(o._computeIsSuiteNavHidden);o.createComputed(o._computeIsSearchHidden);return o}e.prototype.dispose=function(){n.prototype.dispose.call(this);this.isTopBarHamburgerVisible(!1);this.hideLeftNav(!1);this.isSearchHidden(!1);this.isSuiteNavHidden(!1);this.isCommandBarDarkTheme(!1);this.commandSet(null)};e.prototype.computeCurrentPageName=function(){var e=this._photoPage&&this._photoPage(),t=F[e||F.none];return"Photos-"+(""+t.substring(0,1).toUpperCase()+t.substring(1))};e.prototype.computeContentControl=function(){var e=n.prototype.computeContentControl.call(this);if(e)return e;var t=this.getContentControlParams();switch(this._photoPage()){case F.allPhotos:case F.singleTag:case F.singlePlace:return d.toSpecification(P.resourceKey,t);case F.search:return d.toSpecification(f.resourceKey,t);case F.tags:case F.places:return d.toSpecification(b.resourceKey,t);case F.albums:return K.isFeatureEnabled(K.EnableEvokeAlignments)?d.toSpecification(g.resourceKey,t):d.toSpecification(x.resourceKey,t);case F.singleAlbum:return d.toSpecification(p.resourceKey,t);case F.onThisDay:return d.toSpecification(v.resourceKey,t)}};e.prototype.computeCreateDataManager=function(){var e,t=this.viewParams(),o=this.urlDataSource.getQueryType(t);if("photos"!==t.v)return null;switch(o){case H.default.Search:e=this._createFilesDataManager;break;default:e=this._createPhotosDataManager}return e};e.prototype.computeDataManagerMapper=function(){var e=this._photoPage(),t=this.viewParams(),o=this.dataManager();return K.isFeatureEnabled(K.EnableEvokeAlignments)&&e===F.albums&&t.tagFilter!==I.NEW_ALBUM_TAG?new(this.managed(B.default))({itemSet:this.unmappedItemSet,requiredRange:o.requiredRange}):n.prototype.computeDataManagerMapper.call(this)};e.prototype._computeIsSuiteNavHidden=function(){var e=this._photoPage();this.isSuiteNavHidden(e===F.singleAlbum)};e.prototype._computeIsSearchHidden=function(){var e=this._photoPage();this.isSearchHidden(e===F.singleAlbum)};e.prototype._createPhotosDataManager=function(){return new(this.managed(R.default))({requiredPageType:w.default.Photos})};e.prototype._createFilesDataManager=function(){return new(this.managed(M.default))({requiredPageType:w.default.Photos})};e.prototype._computePhotoType=function(){var e=this.viewParams();return this.urlDataSource.getPhotoType(e)};e.prototype._computeUpdateCanMarqueeSelect=function(){var e;switch(this.photoType()){case 2:case 3:e=!1;break;default:e=!0}this._canMarqueeSelect(e)};e.prototype._initCommandSets=function(){var e={currentView:this._activePivot,photoType:this.photoType},t=new(this.managed(o.default))(e);this.resources.expose(N.listViewContextMenuHelper,new(this.managed(u.default))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));this.contextMenuHelper(new(this.managed(u.default))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"od-Photos",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));this.commandSet(t)};e.prototype._computeActivePivot=function(){var e=this.photoType();return 1===e||5===e?1:2===e||6===e?2:3===e||7===e?3:0===e?0:null};e.prototype._computeShouldShowPromotedPhotos=function(){return K.isFeatureEnabled(K.PromotedPhotosContentEnabled)&&this._photoPage()===F.allPhotos};e.prototype._computePhotoPage=function(){var e=this.item(),t=this.urlDataSource.getKeyParams(e.key);return"search"===t.qt?F.search:"allmyphotos"===t.qt?t.tagFilter?F.singleTag:t.locationFilter?F.singlePlace:t.onThisDay?F.onThisDay:F.allPhotos:"tags"===t.id?F.tags:"places"===t.id?F.places:"albums"===t.id?F.albums:e.virtualItemType===k.default.Album?F.singleAlbum:F.none};e.prototype._computePivotHeading=function(){switch(this._photoPage()){case F.albums:return A.strings.albumsNavLink;case F.tags:return A.strings.tagsNavLink;case F.places:return A.strings.placesNavLink;case F.allPhotos:default:return A.strings.allPhotosNavLink}};return e}(r.default);e.default=n});define("odsp-next/pages/photos/odc/PhotosCommandSet",["require","exports","tslib","knockout","../../../controls/commands/Command","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/commands/SeparatorCommandSet","../../../utilities/features/Features","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/ODCResourceKeys","../../../dataSources/url/QueryType","../../../utilities/icons/Icon","../../../controls/commands/Commands.resx","../../../controls/photos/Photos.resx","../../../controls/operation/commands/OperationCommandBuilder","../../../controls/addToAlbum/AddToAlbum.resx","../../../utilities/optimizely/OptimizelyHelper","../../../controls/infoPane/InfoPane.resx","../../../controls/folderBuilder/FolderBuilder.resx"],function(e,t,r,u,m,c,o,h,n,a,i,p,g,s,l,x,d,f,v,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=l.strings,y=s.strings,S=d.strings,A=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._viewParams=t.resources.consume(n.viewParams);t._urlDataSource=t.resources.consume(i.urlDataSource);t._currentView=e.currentView;t._photoType=e.photoType;t._photoProvider=t.resources.consume(a.photo);t._arePivotsHidden=t.createComputed(t._computeArePivotsHidden);t._initOptimizelyExperiments();t._buildCommands();return t}e.prototype._buildCommands=function(){var o=this,e=new(this.managed(this.actionMap.SaveAutoAlbumAction))({isHidden:!0}),t=[new(this.managed(m.CommandViewModel))({text:this._shareText,isHidden:this._shareHidden,tooltip:y.ShareCommandTooltipV3,renderLabel:2,icon:this._shareIcon,keys:["S"],action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.ShareByLinkAction)),saveAutoAlbumAction:e})}),new(this.managed(m.CommandViewModel))({text:y.copyLink,isHidden:this._getALinkHidden,tooltip:y.CopyLinkCommandTooltipV3,renderLabel:2,icon:new g.default("Link"),action:new(this.managed(this.actionMap.ShareByLinkAction))}),new(this.managed(m.CommandViewModel))({text:y.addToSharedList,renderLabel:2,icon:new g.default("Add"),action:new(this.managed(this.actionMap.AddToSharedListAction))})],r=[new(this.managed(m.CommandViewModel))({text:y.selectItems,renderLabel:2,icon:new g.default("CheckboxComposite"),action:new(this.managed(this.actionMap.ToggleSelectionModeAction))}),new(this.managed(m.CommandViewModel))({text:S.newAlbumPlaceholder,renderLabel:2,icon:new g.default("Add"),action:new(this.managed(this.actionMap.CreateAlbumAction)),isHidden:this.createObservable(h.isFeatureEnabled(h.EnableEvokeAlignments))}),new(this.managed(m.CommandViewModel))({text:y.AddToAlbum,renderLabel:2,icon:new g.default("Photo2Add"),action:new(this.managed(this.actionMap.AddToAlbumAction))}),new(this.managed(m.CommandViewModel))({text:y.addToBundle,icon:new g.default("Add"),renderLabel:2,action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.AddPhotosToAlbumAction)),saveAutoAlbumAction:e})}),new(this.managed(m.CommandViewModel))({text:y.editTags,renderLabel:2,icon:new g.default("Tag"),keys:["T"],action:new(this.managed(this.actionMap.EditTagsAction))}),new(this.managed(m.CommandViewModel))({text:y.Download,renderLabel:2,icon:new g.default("Download"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.DownloadAction)),saveAutoAlbumAction:e})}),new(this.managed(m.CommandViewModel))({text:y.setCoverPhotoTitle,renderLabel:2,icon:new g.default("Picture"),action:new(this.managed(this.actionMap.SetAlbumCoverPhotoAction))}),new(this.managed(m.CommandViewModel))({text:y.rotate,renderLabel:2,icon:new g.default("rotate"),action:new(this.managed(this.actionMap.RotateAction))({})}),new(this.managed(m.CommandViewModel))({text:y.DeleteItem,renderLabel:2,icon:new g.default("Delete"),action:new(this.managed(this.actionMap.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(m.CommandViewModel))({text:y.Remove,renderLabel:2,icon:new g.default("Cancel"),action:new(this.managed(this.actionMap.RemoveFromAlbumAction))}),new(this.managed(m.CommandViewModel))({text:y.Remove,renderLabel:2,icon:new g.default("Cancel"),action:new(this.managed(this.actionMap.RemoveTagFromItemAction))}),new(this.managed(m.CommandViewModel))({text:y.OrderPrints,icon:new g.default("Print"),renderLabel:2,action:new(this.managed(this.actionMap.OrderPrintsAction))}),new(this.managed(m.CommandViewModel))({text:y.viewInFolder,icon:new g.default("Folder"),action:new(this.managed(this.actionMap.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),new(this.managed(m.CommandViewModel))({text:y.Rename,renderLabel:2,icon:new g.default("Edit"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.RenameAction)),saveAutoAlbumAction:e}),keys:["F2"],automationId:"rename"}),new(this.managed(m.CommandViewModel))({text:y.Embed,icon:new g.default("Embed"),renderLabel:2,hasLineBreakAfter:!0,automationId:"embed",action:new(this.managed(this.actionMap.EmbedAction))}),new(this.managed(m.CommandViewModel))({text:y.saveAutoAlbum,icon:new g.default("Add"),renderLabel:2,action:new(this.managed(this.actionMap.SaveAutoAlbumAction))}),new(this.managed(m.CommandViewModel))({text:y.discardAutoAlbum,icon:new g.default("Delete"),renderLabel:2,action:new(this.managed(this.actionMap.DiscardAutoAlbumAction))}),this.overflowHostCommand,new(this.managed(x.default))({renderLabel:2}).command],n=this.createPureComputed(function(){var e=o.selection&&o.selection.selection().length||0;return o.responsiveUI.showLabels()?c.format(y.NumberSelected,e):e.toString()}),a=new(this.managed(m.CommandViewModel))({text:n,tooltip:y.showSelection,isHidden:this.selectionModeOff,icon:new g.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}),i=this.createPureComputed(function(){var e=o._photoType(),t=o.selectionModeOn();return 5!==e||t}),s=new(this.managed(m.CommandViewModel))({icon:new g.default("Cancel"),hasIconOnly:!0,isHidden:i,isDisabled:i,action:new(this.managed(this.actionMap.NavigationAction))({ignoreHistory:!1,url:this._urlDataSource.getAlbumsQueryUrl()}),keys:["AltUp"],location:4}),l=[a,new(this.managed(m.CommandViewModel))({text:y.setRootPhotosIdTitle,icon:new g.default("Settings"),renderLabel:2,requiredChildren:2,location:4,isHidden:this.createPureComputed(function(){var e=o.selectionModeOn();return o._urlDataSource.getQueryType(o._viewParams())===p.default.Search||e}),children:u.observableArray([new(this.managed(m.CommandViewModel))({text:y.setRootPhotosValueAll,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:0}),isToggleable:!0}),new(this.managed(m.CommandViewModel))({text:y.setRootPhotosValuePhotos,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:1}),isToggleable:!0})])}),s,new(this.managed(m.CommandViewModel))({text:y.Details,icon:new g.default("Info"),location:12,hasIconOnly:!0,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),renderLabel:0,keys:["I"],automationId:"showProperties"})],d=[t=this._makePivots(1).concat(t),r,l].map(function(e){return o.createObservable(e)});this.commandSets(d)};e.prototype._computeArePivotsHidden=function(){var e=this._photoType(),t=this.selectionModeOn();return 5===e||t};e.prototype._makePivots=function(e){var t=this._photoProvider.getAllPhotosSettings()(),o=[new(this.managed(m.CommandViewModel))({text:b.allPhotosNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(0),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAllMyPhotosQueryUrl(t.rootId)}),location:3}),new(this.managed(m.CommandViewModel))({text:b.albumsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(1),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAlbumsQueryUrl()}),location:3}),new(this.managed(m.CommandViewModel))({text:b.tagsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(2),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getTagsQueryUrl()}),automationId:"showTags",location:3}),new(this.managed(m.CommandViewModel))({text:b.placesNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(3),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getPlacesQueryUrl()}),location:3})];o[o.length-1].isLastPivot=!0;return o};e.prototype._createComputedIsCurrentViewAndNotSearch=function(e){var t=this;return this.createPureComputed(function(){return t._isCurrentViewAndNotSearch(e)})};e.prototype._isCurrentViewAndNotSearch=function(e){var t=this._urlDataSource.getQueryType(this._viewParams())===p.default.Search;return this._currentView()===e&&!t};e.prototype._initOptimizelyExperiments=function(){var o=this;this._shareIcon=u.observable(new g.default("Share"));this._shareText=u.observable(y.Share);this._shareHidden=u.observable(!1);this._getALinkHidden=u.observable(!0);f.OptimizelyHelper.GetVariationIdsMapForExperiment(f.OptimizelyHelper.SHARE_EXPERIMENT_ID).done(function(e){if(e&&e.length){var t=parseInt(e[0],10);if(t===f.OptimizelyHelper.SHARE_VARIATION_LINK_ID){o._shareHidden(!0);o._getALinkHidden(!1)}else if(t===f.OptimizelyHelper.SHARE_VARIATION_SHARE_LINK_ID)o._getALinkHidden(!1);else if(t===f.OptimizelyHelper.SHARE_VARIATION_EMAIL_ID){o._shareIcon(new g.default("Mail"));o._shareText(v.strings.extractedTextEmailTypeName);o._getALinkHidden(!1)}else if(t===f.OptimizelyHelper.SHARE_VARIATION_INVITE_ID){o._shareIcon(new g.default("PeopleAdd"));o._shareText(P.strings.AddEditors);o._getALinkHidden(!1)}}})};return e}(o.default);t.default=A});define("odsp-next/controls/itemContent/album/AlbumItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:o("module").id,loader:new n.AliasResourceLoader(function(){return r.loadModuleExport({path:"./AlbumItemContent",getModule:function(){return new t.default(function(e,t){o(["./AlbumItemContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/itemContent/albums/AlbumsContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:o("module").id,loader:new n.AliasResourceLoader(function(){return r.loadModuleExport({path:"./AlbumsContent",getModule:function(){return new t.default(function(e,t){o(["./AlbumsContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/itemContent/albumsRoot/AlbumsRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:o("module").id,loader:new n.AliasResourceLoader(function(){return r.loadModuleExport({path:"./AlbumsRootItemContent",getModule:function(){return new t.default(function(e,t){o(["./AlbumsRootItemContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/itemContent/onThisDay/OnThisDayItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:o("module").id,loader:new n.AliasResourceLoader(function(){return r.loadModuleExport({path:"./OnThisDayItemContent",getModule:function(){return new t.default(function(e,t){o(["./OnThisDayItemContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent",["require","exports","./PhotosRootItemContentViewModel","../../../bindings/component/ControlBinding","./PhotosRootItemContent.html","../ItemContent.css","./PhotosRootItemContent.css","../../list/AllPhotosList","../../emptyFolder/EmptyFolder","../../breadcrumbBar/BreadcrumbBar","../../scrollBarTooltip/ScrollBarTooltip"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-photos-root-item-content",template:e("./PhotosRootItemContent.html"),viewModelType:o.default})});define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../emptyFolder/EmptyFolder","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../photos/Photos.resx","../../scrollBarTooltip/ScrollBarTooltip","@ms/odsp-utilities/lib/object/ObjectUtil","../../../bindings/component/ControlBinding","../../breadcrumbBar/BreadcrumbBar","../../../models/itemSet/ItemSetMonitor","../../../models/item/OneDriveItem","../../../models/item/ItemType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/tag/TagType","../../../utilities/tag/GroupPacker","../../list/layouts/LayoutType","../../../actions/toggleListLayout/ToggleListLayoutHelper"],function(e,t,o,r,n,a,i,s,l,d,u,m,c,h,p,g,x,f,v,P,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(r){o.__extends(e,r);function e(e,t){var o=r.call(this,e,t)||this;o.addBindingHandlers({control:m.default});o.breadcrumbBarTagName=c.default.tagName;o.emptyFolderControl=m.toSpecification(n.resourceKey,{});o.scrollBarTooltipTagName=d.default.tagName;o._itemSetMonitor=o.resources.consume(h.resourceKey);o.itemSet=o._itemSetMonitor.itemSet;o.itemSetSelectionModel=o.resources.consume(a.itemsSelection);o.contentRange=o.resources.consume(i.contentRange);o._photoProvider=o.resources.consume(s.photo);o.resources.expose(i.files.layoutType,o.createObservable(P.AllPhotos));o.layoutType=o.resources.consume(b.resolvedLayoutTypeResourceKey);o._dataManagerMapper=o.resources.consume(a.currentDataManagerMapper);o.listViewContextMenuHelper=o.resources.consume(i.listViewContextMenuHelper.optional);o.visibleItemRange=o.createObservable();o.visibleItemRange.equalityComparer=u.deepCompare;o._crumbs=o.createPureComputed(o._computeCrumbs);o.title=o._itemSetMonitor.name;o.heading=l.strings.monthlyPhotosHeading;o.item=o._itemSetMonitor.item;o.showList=o.createPureComputed(function(){return!!o.layoutType()&&o._itemSetMonitor.hasItems()});o.showEmpty=o._itemSetMonitor.isEmpty;o.showBreadcrumb=o.createPureComputed(o._computeShowBreadcrumb);o.showTitle=o.createPureComputed(o._computeShowTitle);o.hasGroupings=o.createPureComputed(o._computeHasGroupings);o.scrollBarTooltipParams={listRange:o.contentRange,label:o.createPureComputed(o._computeScrollBarTooltipLabel)};o.layoutParams={itemSet:o.itemSet,selectionModel:o.itemSetSelectionModel,requiredRange:o.contentRange,visibleItemRange:o.visibleItemRange,enableMarqueeSelection:!0,contextMenuHelper:o.listViewContextMenuHelper,mode:0};return o}e.prototype.getCrumbs=function(e){function t(e,t){var o=new p.default(t);o.id=e;o.isDropEnabled=!1;o.isPlaceholder=!0;o.properties={};o.type=g.default.Folder;o.tagInfo={tagType:f.default.allPlaces};return o}var o=x.deserializeQuery(e.key);if(!o.locationFilter)return[];var r=o.locationFilter.split(v.ALLPLACES_GEOLOCATION_DELIMITER);delete o.locationFilter;for(var n=x.serializeQuery(o),a=!1,i=[];0<r.length;){var s=a,l=!a,d=r.join(v.ALLPLACES_GEOLOCATION_DELIMITER),u=n+"&locationFilter="+r.join(v.ALLPLACES_GEOLOCATION_HARDCODED),m=r.pop();if(0!==m.length){var c=t(d,u);i.push({key:c.key,url:"#"+c.key,name:m,showNextChevron:a,isDroppingTarget:this.createObservable(!1),item:c,isOverflow:!1,isNavItem:s,isStaticItem:l});a=!0}}return i};e.prototype._computeScrollBarTooltipLabel=function(){var e=this.visibleItemRange();if(e){var t=this._itemSetMonitor.itemSet(),o=Math.floor((e.end-e.start)/2)+e.start,r=this._dataManagerMapper().getOriginalItemIndexByMappedIndex(o),n=this._photoProvider.findMonthGroupingByIndex(t.key,r);return n&&n.name||""}return""};e.prototype._computeShowTitle=function(){var e=this._itemSetMonitor.item();return this._itemSetMonitor.hasName()&&!e.isRootFolder&&!this._crumbs().length};e.prototype._computeShowBreadcrumb=function(){return!!this._crumbs().length};e.prototype._computeCrumbs=function(){return this.getCrumbs(this._itemSetMonitor.item())};e.prototype._computeHasGroupings=function(){return!!(this._itemSetMonitor.itemSet().content().groupings||[]).length};return e}(r.default);t.default=y});define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltip",["require","exports","./ScrollBarTooltipViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ScrollBarTooltip.html","./ScrollBarTooltip.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-scroll-bar-tooltip",template:e("./ScrollBarTooltip.html"),viewModel:o.default,synchronous:!0});t.default=n});define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltipViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/css/VisibilityBinding","../../bindings/scrollBarPosition/ScrollBarPositionBinding","../overlays/Overlay","@ms/odsp-utilities/lib/locale/Locale","../../utilities/browser/ResponsiveUI","../../bindings/drag/DragBinding","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,o,s,r,l,d,u,n,m,c,h,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.addBindingHandlers({scrollBarPosition:d.default,visibility:l.default,drag:c.default});t._platformDetection=t.resources.consume(g.platformDetection);t._scrollBarWidth=m.default.getScrollbarWidth();t.overlayTagName=u.default.tagName;t.scrollContainerClientRect=s.observable();t.scrollContainerClientRect.equalityComparer=p.deepCompare;t.scrollPosition=s.observable();t.scrollPosition.equalityComparer=p.deepCompare;t.scrollContainer=s.observable();var o=e.label,r=void 0===o?s.observable(""):o,n=e.isDragging,a=void 0===n?s.observable(!1):n;t._label=r;t.isDragging=a;t.mousePoint=s.observable(new h.default(0,0));t.isIdle=s.observable(!0);t.left=t.createComputed(t._computeLeft);t.right=t.createComputed(t._computeRight);t.top=t.createComputed(t._computeTop);t.displayText=t.createComputed(t._computeDisplayText);t.isVisible=t.createPureComputed(t._computeIsVisible);t.createComputed(t._computeUpdateScrollPositionOnDrag);t.createComputed(t._computeSuspendIdleOnScrollPosition);t.createComputed(t._computeGoIdle).extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}});return t}e.prototype._computeLeft=function(){return n.default.isRightToLeft?this._computeMarginOffset():null};e.prototype._computeRight=function(){return n.default.isRightToLeft?null:this._computeMarginOffset()};e.prototype._computeMarginOffset=function(){var e=0;this._platformDetection.isMac&&(e=m.default.MAC_SCROLL_BAR_WIDTH);return this._scrollBarWidth+4+e+"px"};e.prototype._computeDisplayText=function(){var e=this._label();return e||""};e.prototype._computeTop=function(){var e=this.scrollPosition(),t=this.scrollContainerClientRect();if(!e||!t)return"0";var o=t.height-40;return e.y*o+"px"};e.prototype._computeUpdateScrollPositionOnDrag=function(){if(this.isDragging()){var e=this.mousePoint(),t=this.scrollContainerClientRect(),o=e.y-t.top,r=t.height-40,n=new h.default(0,Math.max(0,Math.min(1,o/r)));this.scrollPosition(n)}};e.prototype._computeIsVisible=function(){return!!this._label()&&(!this.isIdle()||this.isDragging())};e.prototype._computeSuspendIdleOnScrollPosition=function(){this.scrollPosition();this.isIdle(!1)};e.prototype._computeGoIdle=function(){this.scrollPosition();this.isIdle()||this.isDragging()||this.isIdle(!0)};return e}(r.default);t.default=a});define("odsp-next/bindings/css/VisibilityBinding",["require","exports","knockout"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}e.update=function(e,t){var o=r.unwrap(t());e.style.visibility=o?"inherit":"hidden"};return e}();t.default=o});define("odsp-next/bindings/scrollBarPosition/ScrollBarPositionBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout","../scrollContainer/ScrollContainerBinding","@ms/odsp-utilities/lib/math/Point","../clientRect/ClientRectBinding","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,o,r,n,a,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){o.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._container=a.getScrollContainer(t.element);var o=t.valueAccessor();t._position=n.observable();t._isUpdatingScrollPosition=!1;t.events.on(t._container,"scroll",t._updateScrollPosition);t.events.on(window,"resize",t._updateScrollPosition);t._updateScrollPosition();t._containerClientRect=n.observable();t._containerClientRect.equalityComparer=l.deepCompare;new(t.managed(s.default))({element:t._container,bindingContext:t.bindingContext,allBindingsAccessor:t.allBindingsAccessor,valueAccessor:function(){return{size:t._containerClientRect,includePosition:!0}}});if(o.position){t.createComputed(function(){return o.position(t._position())});t.subscribe(o.position,t._position)}o.containerClientRect&&t.createComputed(function(){return o.containerClientRect(t._containerClientRect())});o.container&&o.container(t._container);t.subscribe(t._position,t._onScrollPositionChanged);return t}e.prototype._updateScrollPosition=function(){var e=new i.default(this._container.scrollLeft/this._container.scrollWidth,this._container.scrollTop/this._container.scrollHeight);this._isUpdatingScrollPosition=!0;try{this._position(e)}finally{this._isUpdatingScrollPosition=!1}};e.prototype._onScrollPositionChanged=function(e){if(!this._isUpdatingScrollPosition){var t=this._container.scrollWidth,o=this._container.scrollHeight;this._container.scrollLeft=Math.max(0,Math.min(t,e.x*t));this._container.scrollTop=Math.max(0,Math.min(o,e.y*o))}};e.supportsVirtualElements=!0;return e}(r.default);t.default=d});define("odsp-next/bindings/drag/DragBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/math/Point"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){o.__extends(e,r);function e(e){var t=r.call(this,e)||this,o=e.valueAccessor();t._isDragging=o.isDragging;t._mousePoint=o.mousePoint;t._initEvents();return t}e.prototype._onMouseDown=function(e){this._isDragging(!0)};e.prototype._onMouseUp=function(e){this._isDragging(!1);this._mousePoint(new n.default(e.clientX,e.clientY))};e.prototype._onMouseMove=function(e){this._isDragging.peek()&&this._mousePoint(new n.default(e.clientX,e.clientY))};e.prototype._onTouchStart=function(e){this._isDragging(!0)};e.prototype._onTouchEnd=function(e){this._isDragging(!1);this._mousePoint(new n.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY))};e.prototype._onTouchMove=function(e){if(this._isDragging.peek()){e.preventDefault();this._mousePoint(new n.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY))}};e.prototype._initEvents=function(){var e=document.body,t=this.element;this.events.on(t,"touchstart",this._onTouchStart,!0);this.events.on(t,"touchend",this._onTouchEnd,!0);this.events.on(document,"touchmove",this._onTouchMove,!0);this.events.on(t,"mousedown",this._onMouseDown);this.events.on(t,"mouseup",this._onMouseUp);this.events.on(e,"dragend",this._onMouseUp);this.events.on(e,"mousemove",this._onMouseMove);this.events.on(document,"mouseup",this._onMouseUp)};return e}(r.default);t.default=a});define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltip.html",[],function(){return'\x3c!--ko scrollBarPosition: {\r\n containerClientRect: scrollContainerClientRect,\r\n position: scrollPosition,\r\n container: scrollContainer\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !!scrollContainerClientRect() && !!scrollContainer() && isVisible()--\x3e\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n alignToParent: true,\r\n parentElement: scrollContainer(),\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 267\r\n }\r\n }\r\n}--\x3e<div class=od-ScrollBarTooltip data-bind="style: { top: top, left: left, right: right }, drag: { isDragging: isDragging, mousePoint: mousePoint }"><span class="od-ScrollBarTooltip-displayText ms-font-m" data-bind="text: displayText"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltip.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ScrollBarTooltip{height:40px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;padding:4px 10px;cursor:default;box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";box-sizing:border-box}.od-ScrollBarTooltip-displayText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";line-height:30px}.od-OverlayHost-overlay .od-ScrollBarTooltip{transition:opacity 267ms linear,visibility 0s linear 267ms;opacity:0;visibility:hidden}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ScrollBarTooltip{transition-delay:0s,0s;opacity:1;visibility:inherit}"}])});define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent.html",[],function(){return'<div class="od-PhotosRootItemContent od-ItemContent" data-bind="css: { \'od-PhotosRootItemContent--hasGroupings\': hasGroupings }">\x3c!--ko if: showTitle() || showBreadcrumb()--\x3e<div class="od-PhotosRootItemContent-header od-ItemContent-header">\x3c!--ko if: showTitle--\x3e<div class="od-PhotosRootItemContent-title od-ItemContent-title" data-bind="text: title"></div>\x3c!--/ko--\x3e\x3c!--ko if: showBreadcrumb--\x3e<div class="od-PhotosRootItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component: { name: breadcrumbBarTagName, params: { item: item, getCrumbs: $component.getCrumbs.bind($component) } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: showList--\x3e<h3 class=ms-accessible data-bind="text: heading"></h3><div class="od-PhotosRootItemContent-list od-ItemContent-list" data-bind="component: { name: layoutType, params: layoutParams }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showEmpty--\x3e<div class="od-PhotosRootItemContent-empty od-ItemContent-empty" data-bind="control: emptyFolderControl"></div>\x3c!--/ko--\x3e\x3c!--ko component: {\r\n name: scrollBarTooltipTagName,\r\n params: scrollBarTooltipParams\r\n }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:48px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:48px}[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:54px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:54px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}.xlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list{padding-top:0}"}])});define("odsp-next/controls/list/AllPhotosList",["require","exports","knockout","./viewModels/AllPhotosListViewModel","./List.html","./List.css","../itemTile/ItemTile"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:"ms-all-photos-list",template:e("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(r.default))(e,t)}},synchronous:!0};o.components.isRegistered(n.tagName)||o.components.register(n.tagName,n);t.default=n});define("odsp-next/controls/list/viewModels/AllPhotosListViewModel",["require","exports","tslib","./ListViewModel","../layouts/AllPhotosLayout"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){o.__extends(e,r);function e(e,t){var o=r.call(this,e,t)||this;o.initialize(new(o.managed(n.default))(e));return o}return e}(r.default);t.default=a});define("odsp-next/controls/list/layouts/AllPhotosLayout",["require","exports","tslib","./BaseGridLayout","../../allPhotosHeader/AllPhotosHeader","../../allPhotosMonthHeader/AllPhotosMonthHeader"],function(e,t,o,r,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this,o=e.mode,r=void 0===o?0:o;t._mode=t.wrapObservable(r);return t}e.prototype.getInnerMargin=function(){return 2};e.prototype.getMinRowHeight=function(){switch(this.responsiveHelper.formFactorSize.peek()){case"Small":case"Medium":return 120;default:return 220}};e.prototype.getGroup=function(e){var t=this._itemSet.peek().content.peek(),o=t.groupings||[],r=t.items,n=0===this._mode.peek()?0:2;if(o&&o.length){for(var a=void 0,i=void 0,s=r[e].peek(),l=0,d=o;l<d.length;l++){var u=d[l];if(u.groupType===n){i=(a=u).groups;break}}if(!a||!i.length)return;return a.groupMap[a.itemToGroupMap[s.key]]}};e.prototype.getHeader=function(e,t,o){var r=null;if(t&&t.peek&&t.peek()){var n=this.getGroup(o);if(n&&this.currentGroup!==n){if((!this.currentGroup||this.currentGroup.latestPhotoTime.monthName!==n.latestPhotoTime.monthName||this.currentGroup.latestPhotoTime.year!==n.latestPhotoTime.year)&&1!==this._mode.peek()){var a=new Date(n.latestPhotoTime.isoDate).getFullYear(),i=p.default.tagName,s={resources:this.resources,headerText:n.latestPhotoTime.monthName+" "+a},l=this._shouldInlineHeadersLineBreak()?64:80;r={key:o+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:l,viewType:i,viewData:s,shouldLineBreak:!0,isHeader:!0};this.addToCurrentRow(r,!0)}var d,u,m,c=void 0;this.currentGroup=n;u=h.default.tagName;m={group:n,resources:this.resources,startIndex:o,mode:this._mode.peek()};d=this._shouldInlineHeadersLineBreak();c=40;0!==o||u||(c=0);r={key:o+"_header",cellIndex:this.cells.length,left:0,top:0,width:d?0:124,height:c,viewType:u,viewData:m,shouldLineBreak:d,aspectRatio:d?void 0:.55,isHeader:!0,shouldNotBeLastInRow:!0,isFixedWidth:!d};this.nextGroup=n}}return r};e.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);for(var t=this.getRowRangeForViewport(e),o=t.start,r=t.end,n=0,a=0,i=0;i<r;i++){var s=this.rows[i],l=s.cells.length-s.itemCellCount;i<=o&&(n+=l);i<r&&(a+=l)}this._shouldInlineHeadersLineBreak()&&(a=n=0);var d=this.rows[o],u=this.rows[r-1];return{start:0<=o?d.cells[0].cellIndex-n:-1,end:0<=r?u.cells[u.cells.length-1].cellIndex-a:-1}};e.prototype._shouldInlineHeadersLineBreak=function(){var e=this.responsiveHelper;return e.compareSize(e.formFactorSize.peek(),"Medium")<=0};return e}(r.default);t.default=n});define("odsp-next/controls/allPhotosHeader/AllPhotosHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllPhotosHeaderViewModel","./AllPhotosHeader.html","./AllPhotosHeader.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-all-photos-header",template:e("./AllPhotosHeader.html"),viewModel:r.default,synchronous:!0});t.default=n});define("odsp-next/controls/allPhotosHeader/AllPhotosHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../commands/Commands.resx","../itemCheck/ItemCheck","../../actions/base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys"],function(e,t,o,r,i,s,l,d,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(a){o.__extends(e,a);function e(e){var t=a.call(this,e)||this,o=e.mode,r=void 0===o?0:o;t.itemCheckTagName=l.default.tagName;t._itemSetSelectionModel=t.resources.consume(i.itemsSelection);t._itemCommandHelper=new(t.managed(d.default));t._startIndex=e.startIndex;t._mode=r;t.displayMonth=0===t._mode?e.group.latestPhotoTime.monthName:"";t.displayDay=0===t._mode?e.group.latestPhotoTime.day:"";t.displayDate=0===t._mode?e.group.latestPhotoTime.longDate:"";t.displayYear=1===t._mode?e.group.latestPhotoTime.year:"";t.group=e.group;t.eventName=t.group&&t.group.location||"";t.shareText=s.strings.Share;t._range=t.createPureComputed(t._computeRange,{deferEvaluation:!0});t._selectedCount=t.createPureComputed(t._computeSelectedCount,{deferEvaluation:!0});t.areAllPhotosSelected=t.createPureComputed(t._computeAreAllPhotosSelected,{deferEvaluation:!0});t.isSelectAllAvailable=t.createPureComputed(t._computeIsSelectAllAvailable,{deferEvaluation:!0});t.isCheckVisible=t.createPureComputed(t._computeIsCheckVisible,{deferEvaluation:!0});t._isShareSupported=t.createPureComputed(t._computeIsShareSupported,{deferEvaluation:!0});t.isShareAvailable=t.createPureComputed(t._computeIsShareAvailable,{deferEvaluation:!0});var n=t.resources.consume(i.actionMap);t._shareAction=new(t.managed(n.ShareByLinkAction));return t}e.prototype.onClickSelectAll=function(e,t){for(var o=this.areAllPhotosSelected.peek(),r=this._range.peek(),n=r.start;n<r.end;n++)this._itemSetSelectionModel.setIndexSelected(n,!o);t.stopPropagation();t.preventDefault();return!1};e.prototype.onClickShare=function(e,t){this._itemSetSelectionModel.clear();for(var o=this._range.peek(),r=o.start;r<o.end;r++)this._itemSetSelectionModel.setIndexSelected(r,!0);this._shareAction.isAvailable.peek()&&this._shareAction.execute(t);t.stopPropagation();t.preventDefault();return!1};e.prototype.onClickDate=function(e,t){return!1};e.prototype._computeRange=function(){var e,t=this._itemSetSelectionModel.itemSet().content(),o=t.groupings&&t.groupings[0],r=o&&o.groups;if(r)for(var n=0,a=r;n<a.length;n++){var i=a[n];if(i.startIndex===this._startIndex){e=i;break}}return e&&e.keys?{start:e.startIndex,end:e.keys.length+e.startIndex}:{start:-1,end:0}};e.prototype._computeSelectedCount=function(){this._itemSetSelectionModel.selection();for(var e=this._range.peek(),t=0,o=e.start;o<e.end;o++)this._itemSetSelectionModel.isIndexSelected(o)&&t++;return t};e.prototype._computeAreAllPhotosSelected=function(){var e=this._selectedCount(),t=this._range.peek();return 0===this._itemSetSelectionModel.mode?e===t.end-t.start:0<e};e.prototype._computeIsShareAvailable=function(){var e=this._range.peek();return this._isShareSupported()&&(0===this._itemSetSelectionModel.mode||e.end-e.start==1)};e.prototype._computeIsCheckVisible=function(){return 0===this._itemSetSelectionModel.mode||0<this._selectedCount()};e.prototype._computeIsSelectAllAvailable=function(){return 0===this._itemSetSelectionModel.mode||0<this._selectedCount()};e.prototype._computeIsShareSupported=function(){var e=this._itemSetSelectionModel.itemSet().content().items,t=this._range.peek(),o=this.unwrapObservable(e[t.start]);return this._itemCommandHelper.isCommandSupported(o,n.share)};return e}(r.default);t.default=a});define("odsp-next/controls/allPhotosHeader/AllPhotosHeader.html",[],function(){return'<div class=od-AllPhotosHeader><div class=od-AllPhotosHeader-date><span class=od-AllPhotosHeader-month data-bind="text: displayMonth, click: onClickDate"></span>\x3c!--ko if: displayDay--\x3e<span class="od-AllPhotosHeader-day ms-font-xxl" data-bind="text: displayDay, click: onClickDate"></span>\x3c!--/ko--\x3e\x3c!--ko if: displayYear--\x3e<span class="od-AllPhotosHeader-year ms-font-xxl" data-bind="text: displayYear"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if: eventName--\x3e<div class="od-AllPhotosHeader-eventName ms-font-l ms-fontColor-neutralPrimary" data-bind="text: eventName"></div>\x3c!--/ko--\x3e\x3c!--ko if: isShareAvailable--\x3e<a href=# class="od-AllPhotosHeader-share ms-Link ms-font-l" data-bind="text: shareText, click: onClickShare"></a>\x3c!--/ko--\x3e\x3c!--ko if: isCheckVisible--\x3e<span class=od-AllPhotosHeader-check data-bind="click: onClickSelectAll, css: { \'is-selected\': areAllPhotosSelected, \'can-select\': isSelectAllAvailable }, component: { name: itemCheckTagName }"></span>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/allPhotosHeader/AllPhotosHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-AllPhotosHeader{width:100%;height:100%}.md .od-AllPhotosHeader,.sm .od-AllPhotosHeader{height:40px;line-height:40px}.od-AllPhotosHeader:hover .od-AllPhotosHeader-check{opacity:1}.lg .od-AllPhotosHeader::before,.xlg .od-AllPhotosHeader::before,.xxlg .od-AllPhotosHeader::before,.xxxlg .od-AllPhotosHeader::before,.xxxxlg .od-AllPhotosHeader::before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(0,0,0,.06)}.md .od-AllPhotosHeader-eventName,.sm .od-AllPhotosHeader-eventName{display:inline-block}[dir=ltr] .md .od-AllPhotosHeader-eventName,[dir=ltr] .sm .od-AllPhotosHeader-eventName{padding-left:10px}[dir=rtl] .md .od-AllPhotosHeader-eventName,[dir=rtl] .sm .od-AllPhotosHeader-eventName{padding-right:10px}.lg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-eventName{position:absolute;left:16px;right:16px;top:120px}html[dir=ltr] .lg .od-AllPhotosHeader-eventName,html[dir=ltr] .xlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-eventName{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-eventName,html[dir=rtl] .xlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-eventName{text-align:left}.od-AllPhotosHeader-month{color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.md .od-AllPhotosHeader-month,.sm .od-AllPhotosHeader-month{font-size:17px;font-weight:300}.lg .od-AllPhotosHeader-month,.xlg .od-AllPhotosHeader-month,.xxlg .od-AllPhotosHeader-month,.xxxlg .od-AllPhotosHeader-month,.xxxxlg .od-AllPhotosHeader-month{font-size:15px;font-weight:400;font-weight:100}.lg .od-AllPhotosHeader-month::after,.xlg .od-AllPhotosHeader-month::after,.xxlg .od-AllPhotosHeader-month::after,.xxxlg .od-AllPhotosHeader-month::after,.xxxxlg .od-AllPhotosHeader-month::after{content:'\\A';white-space:pre}.lg .od-AllPhotosHeader-eventName,.lg .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-share{font-size:14px;font-weight:400}.md .od-AllPhotosHeader-check,.sm .od-AllPhotosHeader-check{top:10px;position:absolute}[dir=ltr] .md .od-AllPhotosHeader-check,[dir=ltr] .sm .od-AllPhotosHeader-check{right:0}[dir=rtl] .md .od-AllPhotosHeader-check,[dir=rtl] .sm .od-AllPhotosHeader-check{left:0}.md .od-AllPhotosHeader-check .ItemCheck,.sm .od-AllPhotosHeader-check .ItemCheck{display:inline-block}.lg .od-AllPhotosHeader-check,.xlg .od-AllPhotosHeader-check,.xxlg .od-AllPhotosHeader-check,.xxxlg .od-AllPhotosHeader-check,.xxxxlg .od-AllPhotosHeader-check{top:8px;position:absolute;opacity:0}[dir=ltr] .lg .od-AllPhotosHeader-check,[dir=ltr] .xlg .od-AllPhotosHeader-check,[dir=ltr] .xxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxxlg .od-AllPhotosHeader-check{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-check,[dir=rtl] .xlg .od-AllPhotosHeader-check,[dir=rtl] .xxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxxlg .od-AllPhotosHeader-check{left:16px}.od-AllPhotosHeader-check.is-selected{opacity:1}.od-AllPhotosHeader .od-AllPhotosHeader-share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader .od-AllPhotosHeader-share,.sm .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;top:0}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-right:15px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-left:15px}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{right:18px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{left:18px}.lg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;bottom:16px}[dir=ltr] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{right:16px}[dir=rtl] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{left:16px}.od-AllPhotosHeader .od-AllPhotosHeader-share:focus,.od-AllPhotosHeader .od-AllPhotosHeader-share:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-AllPhotosHeader .od-AllPhotosHeader-share:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader-date,.sm .od-AllPhotosHeader-date{display:inline-block}.lg .od-AllPhotosHeader-date,.xlg .od-AllPhotosHeader-date,.xxlg .od-AllPhotosHeader-date,.xxxlg .od-AllPhotosHeader-date,.xxxxlg .od-AllPhotosHeader-date{position:absolute;top:40px}[dir=ltr] .lg .od-AllPhotosHeader-date,[dir=ltr] .xlg .od-AllPhotosHeader-date,[dir=ltr] .xxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-date,[dir=rtl] .xlg .od-AllPhotosHeader-date,[dir=rtl] .xxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{left:16px}html[dir=ltr] .lg .od-AllPhotosHeader-date,html[dir=ltr] .xlg .od-AllPhotosHeader-date,html[dir=ltr] .xxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-date,html[dir=rtl] .xlg .od-AllPhotosHeader-date,html[dir=rtl] .xxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{text-align:left}[dir=ltr] .md .od-AllPhotosHeader-day,[dir=ltr] .sm .od-AllPhotosHeader-day{margin-left:5px}[dir=rtl] .md .od-AllPhotosHeader-day,[dir=rtl] .sm .od-AllPhotosHeader-day{margin-right:5px}.lg .od-AllPhotosHeader-day,.xlg .od-AllPhotosHeader-day,.xxlg .od-AllPhotosHeader-day,.xxxlg .od-AllPhotosHeader-day,.xxxxlg .od-AllPhotosHeader-day{font-size:42px}"}])});define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllPhotosMonthHeaderViewModel","./AllPhotosMonthHeader.html","./AllPhotosMonthHeader.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-all-photos-month-header",template:e("./AllPhotosMonthHeader.html"),viewModel:r.default,synchronous:!0});t.default=n});define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.headerText=e.headerText;return t}return e}(o.default);t.default=n});define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeader.html",[],function(){return'<div class=od-allPhotosMonthHeader><div class=od-allPhotosMonthHeader-text role=heading aria-level=4 data-bind="text: headerText"></div></div>'});define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".md .od-allPhotosMonthHeader,.sm .od-allPhotosMonthHeader{height:64px;line-height:64px}.lg .od-allPhotosMonthHeader,.xlg .od-allPhotosMonthHeader,.xxlg .od-allPhotosMonthHeader,.xxxlg .od-allPhotosMonthHeader,.xxxxlg .od-allPhotosMonthHeader{height:80px;line-height:80px}.od-allPhotosMonthHeader-text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block;font-size:21px;font-weight:100}[dir=ltr] .od-allPhotosMonthHeader-text{margin-right:15px}[dir=rtl] .od-allPhotosMonthHeader-text{margin-left:15px}.xlg .od-allPhotosMonthHeader-text,.xxlg .od-allPhotosMonthHeader-text,.xxxlg .od-allPhotosMonthHeader-text,.xxxxlg .od-allPhotosMonthHeader-text{font-size:28px;font-weight:100}"}])});define("odsp-next/controls/itemContent/tagsRoot/TagsRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:o("module").id,loader:new n.AliasResourceLoader(function(){return r.loadModuleExport({path:"./TagsRootItemContent",getModule:function(){return new t.default(function(e,t){o(["./TagsRootItemContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/smartBannerV2/SmartBannerV2",["require","exports","./SmartBannerV2ViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SmartBannerV2.html","./SmartBannerV2.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-smart-bannerv2",template:e("./SmartBannerV2.html"),viewModel:o.default});t.default=n});define("odsp-next/controls/smartBannerV2/SmartBannerV2ViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../bindings/dismiss/DismissBinding","@ms/odsp-shared/lib/base/ViewModel","../../models/store/ItemsStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../resources/DataSourceResourceKeys","./SmartBannerV2.resx","../../bindings/logClick/LogClickBinding","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,a,i,s,o,l,d,u,m,c,h,p,g,x,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){n.__extends(o,r);function o(e){var t=r.call(this,e)||this;t.addBindingHandlers({dismiss:s.default});t._platformDetection=t.resources.consume(v.platformDetection);t._navigation=t.resources.consume(f.navigation);var o=t._navigation.viewParams;t._isTestHookEnabled=!!o.mobileupsell;t.buttonText=m.strings.SmartBannerV2ButtonUseText;t.taglineText=m.strings.SmartBannerV2TaglineText;t.leadText=m.strings.SmartBannerV2LeadText;t.useSquareIcon=!1;if(t._platformDetection.isWinPhone){t.hideTagline=!0;t.taglineText="";t.leadText=m.strings.SmartBannerV2LeadTextWP;t.useSquareIcon=!0}else if(t._platformDetection.isAndroid)t.hideTagline=!1;else{t.buttonText=m.strings.SmartBannerV2ButtonText;t.hideTagline=!1}t._urlDataSource=t.resources.consume(u.url);t._dataStore=t.resources.consume(l.resourceKey);t._iosMobilePathDataSource=t.resources.isExposed(u.iosMobileAppPath)?t.resources.consume(u.iosMobileAppPath):null;t._isVisible=e.isVisible;t._updateIsVisibleBinding();t.isCloseVisible=a.observable(!0);t._storePath=e.useODCAdjustLink?"https://app.adjust.com/k8x1qd_mpo9r5":"https://app.adjust.com/xxf6jd_wkry4s_qxfx79";return t}o.prototype.onCloseButtonClick=function(){this._dismiss()};o.prototype.onCloseClick=function(){this.isCloseVisible.peek()||this._dismiss()};o.prototype.onContentClick=function(){var e=this,t=Date.now(),o=x.format(c.default.ENGAGEMENT_NAME_FORMAT,p.default[this._urlDataSource.getPageType()],g.default[this._urlDataSource.getQueryType()],h.default[h.default.SmartBannerV2_Click]);i.Engagement.logData({name:o.toLowerCase()});if(this._platformDetection.isIOS)this._navigation.navigateTo(this._storePath);else{this.async.setTimeout(function(){Date.now()-t<750&&e._navigation.navigateTo(e._storePath)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};o.prototype._dismiss=function(){this._isVisible(!1);this._dataStore.setValue(o.STORAGE_KEY,Date.now(),d.default.local);var e=x.format(c.default.ENGAGEMENT_NAME_FORMAT,p.default[this._urlDataSource.getPageType()],g.default[this._urlDataSource.getQueryType()],h.default[h.default.SmartBannerV2_Close]);i.Engagement.logData({name:e.toLowerCase(),extraData:{action:c.default.BINDING_ACTION}})};o.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource){e=!0;if(!this._isTestHookEnabled){var t=this._dataStore.getValue(o.STORAGE_KEY,d.default.local);if(t){this._getPromptWaitTimeMilli()<t&&(e=!1)}}}e&&i.Engagement.logData({name:"SmartBannerV2_View",currentPage:p.default[this._urlDataSource.getPageType()],extraData:{queryType:g.default[this._urlDataSource.getQueryType()]}});this._isVisible(e)};o.prototype._getPromptWaitTimeMilli=function(){return Date.now()-864e5};o.STORAGE_KEY="oneDriveSmartBannerVisible";return o}(o.default);t.default=r});define("odsp-next/bindings/logClick/LogClickBinding",["require","exports","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType"],function(e,t,d,u,m,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function l(){}l.init=function(e,t,o,r,n){var a,i,s=d.utils.unwrapObservable(t());if(s){a=s.logClickContext.contextKey;c.default[a]&&d.utils.registerEventHandler(e,l.BINDING_ACTION,function(){i=m.format(l.ENGAGEMENT_NAME_FORMAT,h.default[s.logClickContext.pageType],p.default[s.logClickContext.queryType],c.default[a]);u.Engagement.logData({name:i.toLowerCase(),extraData:{action:l.BINDING_ACTION}})});if(s.click){return d.bindingHandlers.click.init(e,function(){return s.click},o,r,n)}}};l.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}";l.BINDING_ACTION="click";return l}();t.default=o});define("odsp-next/bindings/logClick/ClickContextKeyEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;!function(e){e[e.SmartBannerV2_Close=0]="SmartBannerV2_Close";e[e.SmartBannerV2_Click=1]="SmartBannerV2_Click"}(o||(o={}));t.default=o});define("odsp-next/controls/smartBannerV2/SmartBannerV2.html",[],function(){return'<div class=SmartBannerV2 data-bind="dismiss: onCloseClick">\x3c!--ko if: isCloseVisible--\x3e<button class=SmartBanner-close data-bind="click: onCloseButtonClick"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e<div class=SmartBanner-content><div class=SmartBanner-icon data-bind="css: { \'SmartBanner-useSquareIcon\': useSquareIcon }"><span class="ms-Icon ms-Icon--OneDrive" role=img data-bind="icon: true"></span></div><div class=SmartBanner-text data-bind="css: { \'SmartBanner-noTagline\': hideTagline }"><div class=SmartBanner-lead data-bind="text: leadText"></div><div class=SmartBanner-tagline data-bind="text: taglineText, visible: !hideTagline"></div></div><div class=SmartBanner-button><button class="od-Button od-Button--primary" data-bind="click: onContentClick"><span class=od-Button-label data-bind="text: buttonText"></span></button></div><div class=ms-clearfix></div></div></div>'});define("odsp-next/controls/smartBannerV2/SmartBannerV2.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.SmartBannerV2{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:80px;overflow:hidden;cursor:pointer;border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";position:fixed;z-index:298;bottom:0;left:0;right:0;padding:10px;box-shadow:-7px 0 10px rgba(0,0,0,.22)}.SmartBannerV2 .SmartBanner-close{position:absolute;top:0;width:40px;text-align:center;line-height:40px;cursor:pointer;border:none;background-color:transparent;font-size:20px}[dir=ltr] .SmartBannerV2 .SmartBanner-close{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-close{left:0}.lg .SmartBannerV2 .SmartBanner-close,.xlg .SmartBannerV2 .SmartBanner-close,.xxlg .SmartBannerV2 .SmartBanner-close,.xxxlg .SmartBannerV2 .SmartBanner-close,.xxxxlg .SmartBannerV2 .SmartBanner-close{top:-5px;font-size:16px}[dir=ltr] .SmartBannerV2 .SmartBanner-content{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-content{left:0}.lg .SmartBannerV2 .SmartBanner-content,.xlg .SmartBannerV2 .SmartBanner-content,.xxlg .SmartBannerV2 .SmartBanner-content,.xxxlg .SmartBannerV2 .SmartBanner-content,.xxxxlg .SmartBannerV2 .SmartBanner-content{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button{padding-top:17px}.md .SmartBannerV2 .SmartBanner-content .SmartBanner-button,.sm .SmartBannerV2 .SmartBanner-content .SmartBanner-button{clear:both;padding-top:12px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:right}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:left}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:5px;height:40px;width:40px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:right}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon.SmartBanner-useSquareIcon{border-radius:0}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:6px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:42px;margin:10px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{height:64px;width:64px}[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-left:10px}[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-right:10px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:right}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:14px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:17px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text.SmartBanner-noTagline .SmartBanner-lead{margin-top:7px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:12px;height:15px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:14px}"}])});define("odsp-next/dataSources/promotedPhotos/odc/PromotedPhotosDataSource",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../models/tag/TagType","../../../utilities/tag/GroupPacker","../../url/odc/UrlDataSource"],function(e,t,o,r,n,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){o.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.extractSharedAlbumsFromItemSet=function(e){for(var o=this,t=[],r=0,n=e.content.peek().items;r<n.length;r++){var a=n[r],i=this.peekUnwrapObservable(a);i.isAlbum&&i.ownerId!==s.default.viewerId&&t.push(a)}return t.sort(function(e,t){return o.peekUnwrapObservable(t).dateSharedTime.getTime()-o.peekUnwrapObservable(e).dateSharedTime.getTime()})};e.prototype.getTagsAndPlaces=function(e,t){for(var o=[],r={},n=[],a={},i=0;i<100;i++){var s=e[i];if(!s)break;var l=s.peek(),d=l.tags&&0<l.tags.length,u=l.geoLocation&&l.geoLocation.hierarchyIndex;if(d&&u){Math.random()<.5?this._makeTagEntry(l,r,o,t):this._makePlaceEntry(l,a,n,t)}else d?this._makeTagEntry(l,r,o,t):u&&this._makePlaceEntry(l,a,n,t)}return{tags:o,places:n}};e.prototype._makePlaceEntry=function(e,t,o,r){var n=e.geoLocation,a=n&&n.hierarchyIndex;if(a&&e.thumbnail){var i=t[a];if(!i){var s=this._makePlace(n,r);i=t[a]=s;o.push(s)}var l=i.peek();l.folder.covers?l.folder.covers.push(e.thumbnail):l.folder.covers=[e.thumbnail];i(l)}};e.prototype._makeTagEntry=function(e,t,o,r){var n=e.tags[Math.floor(Math.random()*e.tags.length)],a=t[n.tag];if(!a){var i=this._makeTag(n,r);a=t[n.tag]=i;o.push(i)}var s=a.peek();s.folder.covers?s.folder.covers.push(e.thumbnail):s.folder.covers=[e.thumbnail];a(s)};e.prototype._makeTag=function(e,t){var o={count:0,localizedTag:e.localizedTag,tag:e.tag};return r.observable(i.createNewTagItem(a.default.allTags,o,null,t))};e.prototype._makePlace=function(e,t){return r.observable(i.createNewTagItem(a.default.allPlaces,null,e,t))};return e}(n.default);t.default=l});define("odsp-next/providers/dataManager/mapper/AlbumsDataManagerMapper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../models/itemSet/ItemSet","../../../models/item/ItemHelper"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.itemSet=e.itemSet;t._requiredRange=e.requiredRange;t.mappedRequiredRange=t.createObservable({start:0,end:0});t.mappedItemSet=t.createPureComputed(t._computeMappedItemSet,{deferEvaluation:!0});t.mappedItemSet.equalityComparer=n.objectStrictEquality;t.createBackgroundComputed(t._computeRequiredRange);t.createBackgroundComputed(t._computeMappedItemSetContent);return t}e.prototype.getOriginalItemIndexByMappedIndex=function(e){return this._indexMap?this._indexMap[e]:e};e.prototype.getNewMappedIndexByOldIndex=function(e){throw"Not implemented"};e.prototype._computeMappedItemSet=function(){var e=this.itemSet(),t=new a.default(e.key,e.context);t.item=e.item;t.content.peek().groupings=e.content.peek().groupings;t.schema=e.schema;t.isPlaceholder=e.isPlaceholder;t.content.peek().items=[];return t};e.prototype._computeRequiredRange=function(){var e=this.mappedRequiredRange(),t=0,o=0;if(this._indexMap){t=this._indexMap[e.start];o=this._indexMap[e.end]}var r={start:t,end:o};this._requiredRange(r)};e.prototype._computeMappedItemSetContent=function(){for(var e=this.itemSet(),t=e.content(),o=[],r=[],n=0;n<t.items.length;n++)if(t.items[n]){var a=t.items[n],i=a.peek();if(!s.isAutoAlbum(i)){o.push(a);r.push(n)}}else{o.push(void 0);r.push(n)}this._indexMap=r;this.mappedItemSet.peek().isPlaceholder=e.isPlaceholder;this.mappedItemSet.peek().content({items:o,groupings:t.groupings})};return e}(o.default);t.AlbumsDataManagerMapper=i;t.default=i});define("odsp-next/providers/dataManager/photos/PhotosDataManager",["require","exports","tslib","../DataManager","../../album/AlbumProvider","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Semaphore","../../../controls/list/layouts/LayoutType","../../../models/tag/TagType","../../../dataSources/url/QueryType","../../../models/item/VirtualItemType","../../../utilities/features/Features"],function(e,t,o,r,n,a,u,c,i,s,h,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(r){o.__extends(m,r);function m(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._photoProvider=t.resources.consume(a.photo);t._albumProvider=t.resources.consume(n.resourceKey);t._tagProvider=t.resources.consume(a.tag);var o=t.viewParams.peek();if(o&&o.noRootId)t._allPhotosUserSettings=t.createObservable({rootId:"",isAscending:!1});else{t._allPhotosUserSettings=t._photoProvider.getAllPhotosSettings();t.createBackgroundComputed(t._computeAllPhotosSettings).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}t.createBackgroundComputed(t._markNewAutoAlbumAsSeen);t.createBackgroundComputed(t._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});return t}m.prototype.getDefaultLayoutForView=function(){var e=this.referenceItemSet(),t=this.layoutType.peek()||i.Grid;if(!e)return t;var o=e.context,r=e.item(),n=this.urlDataSource.getKeyParams(r.key);if(this._isGetItemRequest(o))if(r.isPlaceholder)switch(n.id){case"albums":t=i.Albums}else switch(r.virtualItemType){case l.default.Album:t=i.SingleAlbum;break;case l.default.AlbumRoot:t=i.Albums}else{switch(n.qt){case"allmyphotos":t=i.AllPhotos}switch(n.id){case"tags":case"places":t=i.TagGrid}}return t};m.prototype.isItemResolved=function(e){return r.prototype.isItemResolved.call(this,e)&&!!e.peek().itemFromServer};m.prototype.resolveIndices=function(e){for(var t=this,o=new c.default(6),r=this.itemSet.peek().content.peek().items,n=[],a=function(e){return function(){return t.itemProvider.getItem(e)}},i=0,s=e;i<s.length;i++){var l=r[s[i]];if(l&&l.peek()&&l.peek().key){var d={parentKey:l.peek().key,resultSetOptions:this.itemResultSetOptions};n.push(o.enqueue(a(d)))}}return u.default.all(n).then(function(){})};m.prototype.getOnThisDayContext=function(){var e=this.requiredRange.peek(),t=this._allPhotosUserSettings.peek().rootId,o=this.referenceRevision.peek(),r=this.currentItemKey.peek(),n=this.urlDataSource.getKeyParams(r),a=this.viewParams.peek(),i={parentKey:void 0,photoType:9,startIndex:e.start,endIndex:e.end,rootItemId:t,revision:o,ascending:!1,pageSize:m.REQUEST_PAGE_SIZE,locationFilter:n.locationFilter,tagFilter:n.tagFilter},s=new Date;s.setHours(0);s.setMinutes(0);s.setSeconds(0);s.setMilliseconds(0);var l=s.toISOString(),d=!0,u=!1;try{d=l=new Date(Date.parse(a.onThisDay)).toISOString();u=!!a.highlights&&!!a.highlights}catch(e){}i.startDate=l;i.onThisDay=d;i.highlights=u;return i};m.prototype.getCurrentItemSetSync=function(e){var t;if(this._isGetItemRequest(e))t=this.itemProvider.getItemSync(e);else{switch(e.photoType){case 0:case 6:case 7:case 8:case 9:t=this._photoProvider.getAllPhotosSync(e);break;case 2:t=this._tagProvider.getAllTagsSync(e,s.default.allTags);break;case 3:t=this._tagProvider.getAllTagsSync(e,s.default.allPlaces);break;default:t=this.itemSet.peek()}}return t};m.prototype.getCurrentItemSet=function(e){var t;if(this._isGetItemRequest(e)){switch(this.urlDataSource.getKeyParams(e.parentKey).id){case"albums":default:t=this.itemProvider.getItem(e)}}else switch(e.photoType){case 0:case 6:case 7:case 8:t=this._photoProvider.getAllPhotosForPage(e);break;case 9:t=this._photoProvider.getOnThisDayPhotos(e);break;case 2:t=this._tagProvider.getAllTags(e);break;case 3:t=this._tagProvider.getAllPlaces(e);break;default:t=null}return t};m.prototype.computeCurrentContext=function(){var e,t=this.requiredRange(),o=this.viewParams(),r=this.referenceRevision(),n=this.urlDataSource.getPhotoType(o),a=this.currentItemKey();if(1===n){e={parentKey:a,queryType:h.default.AllMyPhotos,startIndex:t.start,endIndex:t.end,revision:r,ownerId:this.urlDataSource.getOwnerId(a,o)}}else if(5===n){var i=this.urlDataSource.getFocusItemKey(),s=null;i&&this.focusItemIndexInItemSet()<0&&(s=i);e={parentKey:a,queryType:h.default.AllMyPhotos,startKey:s,startIndex:t.start,endIndex:t.end,revision:r,ownerId:this.urlDataSource.getOwnerId(a,o),resultSetOptions:this.itemResultSetOptions}}else if(4===n)e=this._determineFaceContext();else{var l=this.urlDataSource.getKeyParams(a),d=void 0;"allmyphotos"!==l.qt||l.tagFilter||l.locationFilter||(d=this._allPhotosUserSettings().rootId);e=9===n?this.getOnThisDayContext():{parentKey:null,photoType:n,startIndex:t.start,endIndex:t.end,rootItemId:d,revision:r,ascending:!1,pageSize:m.REQUEST_PAGE_SIZE,locationFilter:l.locationFilter,tagFilter:l.tagFilter}}return e};m.prototype._markNewAutoAlbumAsSeen=function(){var e=this.item();!d.isFeatureEnabled(d.EnableEvokeAlignments)&&e.properties.newTag&&e.properties.autoAlbumTag&&this._albumProvider.markAutoAlbumAsSeen(e)};m.prototype._determineFaceContext=function(){var e=this.requiredRange();return{startIndex:e.start,endIndex:e.end,parentKey:this.currentItemKey(),queryType:h.default.AllMyPhotos,sortField:"size",isAscending:!1,revision:this.referenceRevision()}};m.prototype._computeAllPhotosSettings=function(){var e=this._allPhotosUserSettings(),t=this.currentItemKey(),o=this.urlDataSource.getKeyParams(t),r=o.id,n=this.urlDataSource.getQueryType(o),a=!o.locationFilter&&!o.tagFilter;if(e&&r!==e.rootId&&n===h.default.AllMyPhotos&&a){o.id=e.rootId;this.navigation.navigateTo({url:this.urlDataSource.getItemUrl(this.urlDataSource.getKey(o),{viewParams:this.viewParams.peek()}),ignoreHistory:!0})}};m.prototype._computeRequestFocusItem=function(){var e=this.focusItem();if(e){var t=e();if(!t.parentKey&&!t.isPlaceholder){var o=this.focusItemContext();this.trackPromise(this.itemProvider.getItem(o))}}};m.prototype._isGetItemRequest=function(e){return!!e.parentKey};m.REQUEST_PAGE_SIZE=100;return m}(r.default);t.default=m});define("odsp-next/providers/album/AlbumProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","../operation/OperationProvider","../item/ItemProvider","../../resources/ProviderResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/task/Task","../../dataSources/item/IGetWorkProgressContext","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-utilities/lib/resources/Resources","../../dataSources/album/odc/AlbumDataSource","../../models/item/ItemHelper"],function(e,t,o,n,a,d,i,s,u,m,c,h,p,g,x,f,r,v,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){o.__extends(l,r);function l(e,t){var o=r.call(this,e,t)||this;o._albumDataSource=t.albumDataSource;o._operationProvider=t.operationProvider;o._itemProvider=t.itemProvider;o._urlDataSource=t.urlDataSource;o._tagProvider=t.tagProvider;return o}l.prototype.addToAlbum=function(n){for(var a=this,o=new c.default,i=this.observables.createArray(n.items).map(function(e){var t=a._operationProvider.register({name:e.name,type:h.default.addItemsToAlbum,payloads:{addItemsToAlbum:{item:e,album:n.album}},iconName:e.iconName,batch:o});t.progress.maximum(1);t.progress.current(0);return t}),e=0,t=i();e<t.length;e++){t[e].state(m.default.started)}return this._albumDataSource.addToAlbum(n.album,n.items.map(function(e){return e.id})).then(function(e){a._itemProvider.invalidateItem(n.album.key);a._itemProvider.invalidateItem(a.getAlbumsParentKey());for(var t=0,o=i();t<o.length;t++){var r=o[t];r.progress.current(1);r.state(m.default.completed)}return e},function(e){for(var t=0,o=i();t<o.length;t++){o[t].state(m.default.failed)}return d.default.wrapError(e)})};l.prototype.createAlbum=function(e,o){var t=this,r=[new p.default("createAlbum="+e.name,e.name)],n=e.keys;return this._albumDataSource.createAlbum(e.name,n).then(function(e){return t._getNewlyCreatedAlbum(e.id)}).then(function(t){r=t?r.map(function(e){return e.succeed(t)}):r.map(function(e){return e.fail(f.strings.DefaultTitle)});o.update(r)},function(t){r=r.map(function(e){return e.fail(t.error)});o.update(r);return d.default.wrapError(t)})};l.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],o=0;o<e.length;o++)e[o].photo&&!e[o].video&&t.push(e[o].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)};l.prototype.removeFromAlbum=function(t){var o=this;return this._albumDataSource.removeFromAlbum(t.album,t.items.map(function(e){return e.id})).then(function(e){o._itemProvider.invalidateItem(o.getAlbumsParentKey());o._itemProvider.invalidateItem(t.album.key);return e},function(e){return d.default.wrapError(e)})};l.prototype.createAlbumFromFolder=function(e,a){for(var i=this,s=[new p.default("createAlbumFromFolder="+e.folder.id,e.folder.name)],t=0,o=s;t<o.length;t++){o[t].status=0}a.update(s);return this._albumDataSource.createAlbumFromFolder(e).then(function(e){return i._getNewlyCreatedAlbum(e.id)}).then(function(o){if(!o){var t=f.strings.DefaultTitle;s=s.map(function(e){return e.fail(t)});a.update(s);return d.default.wrapError(t)}var r=null,n=function(){var e={type:g.IGetWorkProgressTypes.albumFolderExtraction};r&&(e.workItemIds=r);i._itemProvider.getWorkProgress(e).done(function(e){var t;e.progress&&e.progress.length&&(t=e.progress[0]);if(t&&t.status!==x.ITaskStatuses[x.ITaskStatuses.Completed]){r||(r=[t.id]);i.async.setTimeout(n,l.ASYNC_DELAY)}else{s=s.map(function(e){return e.succeed(o)});a.update(s)}},function(e){s=s.map(function(e){return e.fail(f.strings.DefaultTitle)});a.update(s)})};i.async.setTimeout(n,l.ASYNC_DELAY)},function(e){var t=f.strings.DefaultTitle,o=new Error(t);s=s.map(function(e){return e.fail(o)});a.update(s);return d.default.wrapError(o)})};l.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});return this._albumDataSource.getAlbumsParentKey(e)};l.prototype.setCoverPhoto=function(e,o){var r=this,n=this.getAlbumsParentKey(),a=[new p.default(n+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(t){r._itemProvider.invalidateItem(n);r._itemProvider.invalidateItem(e.album.key);a=a.map(function(e){return e.succeed(t.id)});o.update(a)},function(e){var t=new Error(e);a=a.map(function(e){return e.fail(t)});o.update(a);return d.default.wrapError(t)})};l.prototype.saveAutoAlbum=function(e,o){var t=this,r=e.album,n=r.properties.newTag,a=new p.default(r.key,r);if(!P.isAutoAlbum(r)){a=a.fail();o.update([a]);return d.default.wrap(void 0)}o.update([a]);return this._tagProvider.updateTags({items:[r],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey()}).then(function(e){a=a.succeed();o.update([a]);t._itemProvider.invalidateItem(t.getAlbumsParentKey({tagFilter:v.NEW_ALBUM_TAG}));t._itemProvider.invalidateItem(t.getAlbumsParentKey());t._itemProvider.invalidateItem(r.key)},function(e){var t=new Error(e);a=a.fail();o.update([a]);return d.default.wrapError(t)})};l.prototype.markAutoAlbumAsSeen=function(e){var t=e.properties.newTag,o=e.properties.autoAlbumTag;return t&&o?this._tagProvider.updateTags({items:[e],tagsToDelete:[t],tagsToAdd:null,rootItemId:this.getAlbumsParentKey()}).then(function(e){return e&&!e.error},function(e){return!1}):d.default.wrap(!1)};l.prototype.convertToAutoAlbum=function(t,o){var r=this,e=t.properties.newTag,n=t.properties.autoAlbumTag,a=new p.default(t.key,t);if(e){a=a.fail();o.update([a]);return d.default.wrap(void 0)}e={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"};n||(n={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"});return this._tagProvider.updateTags({items:[t],tagsToDelete:null,tagsToAdd:[n,e],rootItemId:this.getAlbumsParentKey()}).then(function(e){a=a.succeed();o.update([a]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:v.NEW_ALBUM_TAG}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(t.key)},function(e){var t=new Error(e);a=a.fail();o.update([a]);return d.default.wrapError(t)})};l.prototype._getNewlyCreatedAlbum=function(a){var e=this.getAlbumsParentKey();this._itemProvider.invalidateItem(e);var t={parentKey:e,ownerId:this._urlDataSource.getOwnerId(e),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(t).then(function(e){for(var t=e.content.peek().items,o=t.length,r=0;r<o;r++){var n=t[r].peek();if(n.id===a)return n}})};l.dependencies=o.__assign({},n.default.dependencies,{operationProvider:i.resourceKey,itemProvider:s.resourceKey,albumDataSource:a.album,urlDataSource:a.url,tagProvider:u.tag});l.ASYNC_DELAY=5e3;l.ASYNC_RETRY_LIMIT=5;l.ASYNC_RETRY_DELAY=15e3;return l}(n.default);t.default=l;t.resourceKey=r.createResolvedResourceKey(e("module").id,l)});define("odsp-next/providers/itemHistory/ItemHistoryProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.lastItem=n.observable(null);t._itemKeyToHistoryItem={};t._currentItemSet=t.resources.consume(a.currentItemSet);t.currentItem=t.createComputed(function(){var e=t._currentItemSet();return t.lastItem.peek()&&e.key===t.currentItem.peek().item.key?t.currentItem.peek():t._pushCurrentItemSet()},{deferEvaluation:!0});return t}e.prototype.getHistoryItemByKey=function(e){return this._itemKeyToHistoryItem[e]};e.prototype._pushCurrentItemSet=function(){var e=this._currentItemSet.peek();if(e){var t=this._itemKeyToHistoryItem[e.key],o={item:e,anchorItem:t&&t.anchorItem||n.observable(null)};this.lastItem(this.currentItem.peek());this._itemKeyToHistoryItem[e.key]=o;return this._itemKeyToHistoryItem[e.key]}};return e}(o.default);t.default=i});define("odsp-next/providers/promotedPhotos/PromotedPhotosProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../album/AlbumProvider","../item/ItemProvider","../../dataSources/url/QueryType","../../utilities/features/Features","../../models/item/ItemHelper"],function(e,t,r,i,o,n,a,s,l,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(o){r.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t._promotedPhotosDataSource=t.resources.consume(n.promotedPhotos);t._albumProvider=t.resources.consume(s.resourceKey);t._photoProvider=t.resources.consume(a.photo);t._itemProvider=t.resources.consume(l.resourceKey);t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return u.isFeatureEnabled(u.EnableEvokeAlignments)&&m.isAutoAlbum(t)||!u.isFeatureEnabled(u.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})};e.prototype.getTagsAndPlaces=function(t){var o=this,r=this._photoProvider.getAllPhotosSync(t);return this._photoProvider.getAllPhotosForPage(t).then(function(){var e=r.content().items;return o._promotedPhotosDataSource.getTagsAndPlaces(e,t)})};e.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);t.setMilliseconds(0);var o={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},r=this._photoProvider.getAllPhotosSync(o),n=r.item,a=n.peek();return r.isPlaceholder||r.isExpired||a.isPlaceholder?this._photoProvider.getOnThisDayPhotos(o).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):a.folder.covers.length?i.default.wrap([n]):i.default.wrap([])};e.prototype.getSharedAlbums=function(){var t=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(d.default.SharedWithMe)}).then(function(e){return t._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(e)})};return e}(o.default);t.default=c});define("odsp-next/pages/photos/odc/Photos.html",[],function(){return'<h2 class=ms-accessible data-bind="text: pivotHeading"></h2>\x3c!--ko if: shouldShowPromotedPhotos--\x3e<div class=od-photos-promotedWrapper data-bind="css: { \'od-photos-promotedWrapper--loaded\': haveDeferredControlsLoaded }">\x3c!--ko if: haveDeferredControlsLoaded--\x3e<div class=od-photos-promoted data-bind="component: { name: \'od-promoted-photos\', params: promotedPhotosParams }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: isBannerApplicable--\x3e<div class=od-photos-smartBanner data-bind="component: { name: smartBannerTagName, params: { isVisible: isSmartBannerVisible } }"></div>\x3c!--/ko--\x3e\x3c!--ko control: contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isInfoPaneExpanded() && !isOneUp()--\x3e\x3c!--ko component: { name: transclusionContentTagName, params: infoPaneTransclusionContentParams }--\x3e<div class=od-BasePage-infoPane data-bind="control: infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isOneUp--\x3e\x3c!--ko component: {\r\n name: oneUpOverlayTagName,\r\n params: {}\r\n}--\x3e\x3c!--ko control: oneUpSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/pages/photos/odc/Photos.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-BasePage:not(.od-BasePage--hasSmartBanner) .od-photos-smartBanner{display:none}.od-photos-smartBanner .SmartBannerV2{position:absolute}.od-photos-promoted{position:relative}.md .od-photos-promoted,.sm .od-photos-promoted{margin-left:16px;margin-right:16px}.lg .od-photos-promoted,.xlg .od-photos-promoted,.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:32px;margin-right:32px}.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:48px;margin-right:48px}.od-photos-promoted .od-PromotedPhotos-title{margin-top:23px}.od-photos-promotedWrapper.od-photos-promotedWrapper--loaded{transition:height 467ms cubic-bezier(.1,.25,.75,.9);height:385px}.od-photos-promotedWrapper{overflow:hidden;height:0}"}])});define("odsp-next/controls/list/AlbumsList",["require","exports","knockout","./viewModels/AlbumsListViewModel","./layouts/LayoutType","./List.html","./List.css","../itemTile/ItemTile"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={tagName:n.Albums,template:e("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(r.default))(e,t)}},synchronous:!0};o.components.isRegistered(a.tagName)||o.components.register(a.tagName,a);t.default=a});define("odsp-next/controls/list/viewModels/AlbumsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/AlbumsLayout"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){o.__extends(e,r);function e(e,t){var o=r.call(this,e,t)||this;o.initialize(new(o.managed(n.default))(e));return o}return e}(r.default);t.default=a});define("odsp-next/controls/list/layouts/AlbumsLayout",["require","exports","tslib","./GridLayout","../../autoAlbumHeader/AutoAlbumHeader","../../allPhotosMonthHeader/AllPhotosMonthHeader","../../../utilities/features/Features"],function(e,t,o,r,l,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(d){o.__extends(e,d);function e(e){e.isGrouped=!0;return d.call(this,e)||this}e.prototype.getMinRowHeight=function(){return m.isFeatureEnabled(m.EnableEvokeAlignments)?240:d.prototype.getMinRowHeight.call(this)};e.prototype.getItemAspectRatio=function(e){return m.isFeatureEnabled(m.EnableEvokeAlignments)?4/3:d.prototype.getItemAspectRatio.call(this,e)};e.prototype.getInnerMargin=function(){return 4};e.prototype.getGroup=function(e,t){if(!m.isFeatureEnabled(m.EnableEvokeAlignments)){var o=this._itemSet().content.peek().groupings||[];if(o&&o.length&&o[1]&&o[1].itemGroups)for(var r=0,n=o[1].itemGroups;r<n.length;r++){var a=n[r];if(a){var i=a.startIndex+a.count-1;if(a.startIndex<=e&&e<=i)return a}}}};e.prototype.getHeader=function(e,t,o){if(!m.isFeatureEnabled(m.EnableEvokeAlignments))return d.prototype.getHeader.call(this,e,t,o);var r=e&&e.peek&&e.peek(),n=t&&t.peek&&t.peek();if(r&&r.dateCreatedTime&&n&&n.dateCreatedTime&&r.dateCreatedTime.getFullYear()!==n.dateCreatedTime.getFullYear()){var a=n.dateCreatedTime.getFullYear(),i=u.default.tagName,s={resources:this.resources,headerText:""+a},l=this.isSmallWidthLayout?64:80;return{key:o+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:l,viewType:i,viewData:s,shouldLineBreak:!0,isHeader:!0}}};e.prototype.finalizeRow=function(e,t){var o=this._itemSet().content.peek().groupings;if(!m.isFeatureEnabled(m.EnableEvokeAlignments)&&o&&o.length){var r=this.currentRow,n=!1;if(r&&this.currentGroup&&this.currentGroup.state){var a=this.currentGroup.state.peek();a&&(n=a.isCollapsed&&!r.isHeader)}n?this.currentRow=null:d.prototype.finalizeRow.call(this,e,t)}else d.prototype.finalizeRow.call(this,e,t)};e.prototype.getHeaderDetails=function(e,t){var o=this,r="",n={group:null,cellsInGroup:null},a=20,i=this.responsiveHelper,s=i.formFactorSize.peek();if(e){r=l.default.tagName;n={startIndex:t,group:e,cellsInGroup:0,resources:this.resources,onToggle:function(){o.evaluateLayout(!0)}};a=0<=i.compareSize(s,"XLarge")?74:0<i.compareSize(s,"Small")?49:46}return{viewType:r,viewData:n,headerHeight:a}};return e}(r.default);t.default=n});define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AutoAlbumHeaderViewModel","./AutoAlbumHeader.html","./AutoAlbumHeader.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-auto-album-header",template:e("./AutoAlbumHeader.html"),viewModel:r.default,synchronous:!0});t.default=n});define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeaderViewModel",["require","exports","tslib","./AutoAlbumHeader.resx","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.group=e.group;t._onToggle=e.onToggle;t.text=t.createPureComputed(t._computeText);t.chevronClass=t.createPureComputed(t._computeChevron);return t}e.prototype.onClickHeader=function(e,t){var o=this.group.state.peek().isCollapsed;this.group.state({isCollapsed:!o});this._onToggle();return!1};e.prototype._computeText=function(){return this.group.state().isCollapsed?n.strings.ShowMoreAlbums:n.strings.ShowLessAlbums};e.prototype._computeChevron=function(){return a.getIconClassName(this.group.state().isCollapsed?"ChevronDown":"ChevronUp")};return e}(o.default);t.default=i});define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeader.html",[],function(){return'<div class=od-autoAlbumHeader><div class=od-autoAlbumHeader-textWrapper data-bind="click: onClickHeader"><div class="od-autoAlbumHeader-text ms-fontColor-neutralSecondary" data-bind="text: text"></div><div class=ms-Icon data-bind="class: chevronClass"></div></div></div>'});define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-autoAlbumHeader-textWrapper{position:absolute;cursor:pointer}.xlg .od-autoAlbumHeader-textWrapper,.xxlg .od-autoAlbumHeader-textWrapper,.xxxlg .od-autoAlbumHeader-textWrapper,.xxxxlg .od-autoAlbumHeader-textWrapper{top:38px;font-size:14px;font-weight:400}.lg .od-autoAlbumHeader-textWrapper,.md .od-autoAlbumHeader-textWrapper,.sm .od-autoAlbumHeader-textWrapper{top:18px;font-size:14px;font-weight:400}.sm .od-autoAlbumHeader-textWrapper{top:20px;font-size:12px;font-weight:400}.od-autoAlbumHeader-text{display:inline-block}.xlg .od-autoAlbumHeader,.xxlg .od-autoAlbumHeader,.xxxlg .od-autoAlbumHeader,.xxxxlg .od-autoAlbumHeader{height:74px}.lg .od-autoAlbumHeader,.md .od-autoAlbumHeader,.sm .od-autoAlbumHeader{height:49px}.sm .od-autoAlbumHeader{height:46px}.od-autoAlbumHeader .ms-Icon{padding-bottom:2px;vertical-align:middle}"}])});define("odsp-next/controls/list/TagsList",["require","exports","knockout","./viewModels/TagsListViewModel","./layouts/LayoutType","./List.html","./List.css","../detailsRow/DetailsRow","../detailsHeader/DetailsHeader"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={tagName:n.TagsList,template:e("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(r.default))(e,t)}},synchronous:!0};o.components.isRegistered(a.tagName)||o.components.register(a.tagName,a);t.default=a});define("odsp-next/controls/list/viewModels/TagsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/TagsListLayout"],function(e,t,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){o.__extends(e,n);function e(e,t){var o=n.call(this,e,t)||this,r=new(o.managed(a.default))(e);o.initialize(r);return o}return e}(r.default);t.default=n});define("odsp-next/controls/list/layouts/TagsListLayout",["require","exports","tslib","./DetailsLayout","../../../resources/ControlResourceKeys","knockout"],function(e,t,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){o.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:24}};t.prototype.isCheckSupported=function(){return!1};t.prototype.getHeaderCell=function(){return null};t.prototype.onRowInvoke=function(e){var t=this.resources.consume(n.itemsSelection);t.clear(!0);t.setItemSelected(a.dataFor(e.target).item,!0);e.stopPropagation();e.preventDefault();return!1};return t}(r.default);t.default=i});define("odsp-next/controls/list/TagGrid",["require","exports","knockout","./viewModels/TagGridViewModel","./layouts/LayoutType","./List.html","./List.css","../itemTile/ItemTile"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={tagName:n.TagGrid,template:e("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(r.default))(e,t)}},synchronous:!0};o.components.isRegistered(a.tagName)||o.components.register(a.tagName,a);t.default=a});define("odsp-next/controls/list/viewModels/TagGridViewModel",["require","exports","tslib","./ListViewModel","../layouts/TagGridLayout"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){o.__extends(e,r);function e(e,t){var o=r.call(this,e,t)||this;o.initialize(new(o.managed(n.default))(e));return o}return e}(r.default);t.default=a});define("odsp-next/controls/list/layouts/TagGridLayout",["require","exports","tslib","./GridLayout","../../allTagsHeader/AllTagsHeader"],function(e,t,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){o.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHeaderDetails=function(e){var t="",o={},r=20;if(e){var n=this.responsiveHelper,a=0<=n.compareSize(n.formFactorSize.peek(),"XXLarge"),i=a?37:28,s=a?22:14,l=a?12:0;t=d.default.tagName;o={group:e,cellsInGroup:0,resources:this.resources};r=i+s+l}return{viewType:t,viewData:o,headerHeight:r}};return t}(r.default);t.default=n});define("odsp-next/controls/allTagsHeader/AllTagsHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllTagsHeaderViewModel","./AllTagsHeader.html","./AllTagsHeader.css"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"ms-allTags-header",template:e("./AllTagsHeader.html"),viewModel:r.default,synchronous:!0});t.default=n});define("odsp-next/controls/allTagsHeader/AllTagsHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.header=e.group.tagHeader.title;t.subtext=e.group.tagHeader.countSubtitle;t.regionUrl=e.group.tagHeader.regionUrl;return t}return e}(o.default);t.default=n});define("odsp-next/controls/allTagsHeader/AllTagsHeader.html",[],function(){return'<div class=AllTagsHeader><div class=AllTagsHeader-title>\x3c!--ko if: regionUrl--\x3e<a class=AllTagsHeader-regionLink data-bind="text: header, attr: { href: regionUrl }"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: regionUrl--\x3e<span data-bind="text: header"></span>\x3c!--/ko--\x3e</div><div class=AllTagsHeader-subText data-bind="text: subtext"></div></div>'});define("odsp-next/controls/allTagsHeader/AllTagsHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".AllTagsHeader{position:relative;font-weight:100;white-space:nowrap;text-overflow:ellipsis}.xxlg .AllTagsHeader,.xxxlg .AllTagsHeader,.xxxxlg .AllTagsHeader{padding-top:22px;padding-bottom:12px;height:37px}.lg .AllTagsHeader,.md .AllTagsHeader,.sm .AllTagsHeader,.xlg .AllTagsHeader{padding-top:14px;height:28px}.AllTagsHeader-title,a.AllTagsHeader-regionLink{font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir=ltr] .AllTagsHeader-title,html[dir=ltr] a.AllTagsHeader-regionLink{float:left}html[dir=rtl] .AllTagsHeader-title,html[dir=rtl] a.AllTagsHeader-regionLink{float:right}[dir=ltr] .AllTagsHeader-title,[dir=ltr] a.AllTagsHeader-regionLink{margin-right:8px}[dir=rtl] .AllTagsHeader-title,[dir=rtl] a.AllTagsHeader-regionLink{margin-left:8px}.xxlg .AllTagsHeader-title,.xxlg a.AllTagsHeader-regionLink,.xxxlg .AllTagsHeader-title,.xxxlg a.AllTagsHeader-regionLink,.xxxxlg .AllTagsHeader-title,.xxxxlg a.AllTagsHeader-regionLink{font-size:28px;font-weight:100}.lg .AllTagsHeader-title,.lg a.AllTagsHeader-regionLink,.md .AllTagsHeader-title,.md a.AllTagsHeader-regionLink,.sm .AllTagsHeader-title,.sm a.AllTagsHeader-regionLink,.xlg .AllTagsHeader-title,.xlg a.AllTagsHeader-regionLink{font-size:21px;font-weight:100}.AllTagsHeader-subText{position:absolute;display:inline;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.xxlg .AllTagsHeader-subText,.xxxlg .AllTagsHeader-subText,.xxxxlg .AllTagsHeader-subText{bottom:16px}.lg .AllTagsHeader-subText,.md .AllTagsHeader-subText,.sm .AllTagsHeader-subText,.xlg .AllTagsHeader-subText{bottom:2px}"}])});define("odsp-next/controls/itemTile/ItemTileDeferred",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemTileAlbum.html","./ItemTileDiscoverCard.html","./ItemTileTag.html"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o.registerTemplate("ms-item-tile-album",e("./ItemTileAlbum.html"));o.registerTemplate("ms-item-tile-tag",e("./ItemTileTag.html"));o.registerTemplate("ms-item-tile-discover",e("./ItemTileDiscoverCard.html"))});define("odsp-next/controls/itemTile/ItemTileAlbum.html",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, imageRect: imageRect, pulseTarget: pulseTarget } }"></div><div class=ItemTile-dragDropIcon></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().name"></div><div class=ItemTile-childCount data-bind="text: childCount"></div><div class=ItemTile-date data-bind="text: dateText"></div></div>\x3c!--ko if: button--\x3e<button class=od-ItemTile-button data-bind="attr: { title: button.title }, click: onButtonClick"><span class=od-ItemTile-buttonIcon data-bind="component: { name: \'od-icon-glyph\', params: { icon: button.icon } }"></span></button>\x3c!--/ko--\x3e'});define("odsp-next/controls/itemTile/ItemTileDiscoverCard.html",[],function(){return'<div class=ItemTile-discoverFileContainer>\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: \'cover\',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=ItemTile-fileIconContainer><div class=ItemTile-fileIcon data-bind="css: { \'ItemTile-fileIcon--thumbnail\': hasThumbnail(), \'ItemTile-fileIcon--noThumbnail\': !hasThumbnail() }, component: { name: \'ms-file-type-icon\', params: { iconName: item().iconName, iconSize: iconSize(), desiredSize: desiredSize() } }"></div></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().displayName"></div><div class=ItemTile-subText><div class=ItemTile-entity-container><img class=ItemTile-entity data-bind="attr:{src: item().editorProfilePicUrl}, visible: showPerson()"><div class=ItemTile-entity data-bind="visible: !showPerson()"><i class="Icon-main ms-Icon" data-bind="icon: true, css: { \'ms-Icon--Chart\' : item().viewersCount > 1, \'ms-Icon--FavoriteStarFill\': !item().viewersCount }"></i></div></div><div class=ItemTile-longText data-bind="text: subText"></div><div class="ItemTile-viewerCount ItemTile-entity-container" data-bind="visible: !showPerson() && !!item().viewersCount"><i class="ms-Icon ms-Icon--View" data-bind="icon: true"></i> <span data-bind="text: item().viewersCount"></span></div></div></div></div>'});define("odsp-next/controls/itemTile/ItemTileTag.html",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, thumbnail: thumbnail, imageRect: imageRect, pulseTarget: pulseTarget } }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"></div><div class=ItemTile-nameCover><div class="ItemTile-tagText ms-fontWeight-regular"><div class=ItemTile-name data-bind="text: item().name"></div>\x3c!--ko if: showTagCount && tagCount() > 0--\x3e<div class=ItemTile-tagCount data-bind="text: tagCount"></div>\x3c!--/ko--\x3e</div></div>'});