define("odsp-next/bundles/odc/FirstRun",["require","exports","../../controls/premiumIntro/PremiumIntro","../../controls/firstRunExperience/FirstRunExperience","../../controls/featureCards/FeatureCards","../../controls/firstRunDialog/FirstRunDialog","../../controls/positioningPresetPlanCard/PositioningPresetPlanCard","../../controls/guidedTour/GuidedTour","../../controls/firstRunBanner/FirstRunBanner","../../controls/guidedTourShareLightBox/GuidedTourShareLightBox","../../providers/firstRunExperience/FirstRunExperienceProvider","../../providers/guidedTour/GuidedTourProvider","../../dataSources/firstRunExperience/odc/FirstRunExperienceDataSource","../../dataSources/guidedTour/odc/GuidedTourDataSource","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource","../../models/inAppMessaging/MessagingType","../../models/inAppMessaging/MessagingTypeHelper","../../providers/inAppMessaging/InAppMessagingProvider"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("odsp-next/controls/premiumIntro/PremiumIntro",["require","exports","./PremiumIntroViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PremiumIntro.html","./PremiumIntro.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-premium-intro",template:e("./PremiumIntro.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/premiumIntro/PremiumIntroViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/focus/FocusTrapBinding","../../bindings/element/ElementBinding","../../utilities/accessibility/Accessibility","../overlays/Overlay","../positioningPresetPlanCard/PositioningPresetPlanCard","../../bindings/keyboard/KeyboardBinding","../../providers/premium/PremiumLightboxProvider","../securityMomentLightbox/SecurityMomentLightbox","../../utilities/features/Features","../../providers/featureCards/FeatureCardsProvider","../../providers/premium/PremiumStateProvider"],function(e,t,i,o,r,n,a,s,d,u,l,c,g,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(e){i.__extends(t,e);function t(i){var o=e.call(this,i)||this;o.overlayTagName=u.default.tagName;o.addBindingHandlers({element:s.default,bindableHtml:r.default,focusTrap:a.default,preserveFocus:n.default,keyboard:c.default});o.contentRoot=o.createObservable();var t=o.subscribe(o.contentRoot,function(e){d.focusFirstTabStop(e);t.dispose()});o.isPositioningVisible=o.createObservable(!1);o.isOverlayVisible=o.createObservable(!1);o.resources.consume(g.resourceKey).getPremiumLightboxData(i.upsellType).then(function(t){if(!m.isFeatureEnabled(m.EnableSecurityMomentLightbox)||5!==i.upsellType&&6!==i.upsellType){o.isOverlayVisible(!0);o.positioningComponent={name:l.default.tagName,params:{pageData:t,onDismissPositioningClick:o.hide.bind(o)}};o.isPositioningVisible(!0)}else{o.isOverlayVisible(!0);var e=o.resources.consume(h.resourceKey);t.featureCards=e.getFeatureCardsForSecurityMomentLightbox();o.resources.consume(f.resourceKey).getPremiumState(!1).then(function(e){o.positioningComponent={name:p.default.tagName,params:{pageData:t,onDismissPositioningClick:o.hide.bind(o),hasPremium:3===e}};o.isPositioningVisible(!0)})}});return o}t.prototype.hide=function(){this.isPositioningVisible(!1);this.isOverlayVisible(!1)};return t}(o.default);t.default=x});define("odsp-next/controls/positioningPresetPlanCard/PositioningPresetPlanCard",["require","exports","./PositioningPresetPlanCardViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PositioningPresetPlanCard.html","./PositioningPresetPlanCard.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-premium-retro-positioning-card",template:e("./PositioningPresetPlanCard.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/positioningPresetPlanCard/PositioningPresetPlanCardViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ProviderResourceKeys","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../utilities/attribution/AttributionHelper","../featureCards/FeatureCards","../firstRunExperience/FirstRunExperience.resx","../firstRunExperience/FirstRunExperience.resx","../../providers/engagement/Engagement"],function(e,t,o,i,r,n,a,s,d,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="PremiumPositioningPreset",p=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.isIconExperimentLayout=!1;t._instrumentationProvider=t.resources.consume(r.instrumentation);t._actionMap=t.resources.consume(n.actionMap);t._attributionHelper=t.resources.consume(s.resourceKey);t._languageDataSource=t.resources.consume(a.language);t._engagement=t.resources.consume(c.resourceKey);t.pageData=e.pageData;t.isNewFeaturesPage=5===t.pageData.pageType;t.isNewFeaturesPremiumPage=6===t.pageData.pageType;t.isWelcomeNewUsersPage=2===t.pageData.pageType;t.isWelcomeExistingUsersPage=3===t.pageData.pageType;t.isWelcomePage=t.isWelcomeNewUsersPage||t.isWelcomeExistingUsersPage;t.isSyncPage=4===t.pageData.pageType;t.isIconExperimentLayout=!!t.pageData.isIconExperimentLayout;t.showOfficeIcons=t.createComputed(t._computeShowOfficeIcons);t._setUpAccessibilityVariables();t._onDismissPositioningClick=e.onDismissPositioningClick;t.displayFeatureCards=t.createObservable(!1);t.featureCardsTagName=d.default.tagName;t.desiredCarouselIndex=t.createObservable(0);t.featureCardsAriaLabel=u.strings.featureCardsAriaLabel;t.numberOfFeatureCardsViewed=0;t._fireStartupTelemetry();t.resources.consume(n.hasSeenPositioningThisSession)(!0);return t}e.prototype.launchFeatureCards=function(e,t){this.desiredCarouselIndex(e);this.displayFeatureCards(!0);this._logFeatureCardEngagementEvent("LaunchFeatureCard",t)};e.prototype.launchSeeAllFeatures=function(){this.desiredCarouselIndex(0);this.displayFeatureCards(!0);this._logFeatureCardEngagementEvent("SeeAllFeatures")};e.prototype.closeFeatureCards=function(e,t){this._closeFeatureCards(t);this._logFeatureCardEngagementEvent("CloseCards",e)};e.prototype.mainButtonClickFeatureCards=function(e,t){this._closeFeatureCards(t);this._logFeatureCardEngagementEvent("GotIt",e)};e.prototype.purchasePlan=function(e){var t=this._getUrlWithAttribution();new(this.managed(this._actionMap.NavigationAction))({url:t,target:"_blank"}).execute({});this._onDismissPositioningClick&&this._onDismissPositioningClick();this._attributionHelper.logAttributionViaAWA({uri:t});this._logEngagementEvent("PurchasePlan")};e.prototype.dismissPositioningClick=function(){this._onDismissPositioningClick&&this._onDismissPositioningClick();this._logEngagementEvent("StayBasic.Click")};e.prototype.onCloseButtonClick=function(){this._onDismissPositioningClick&&this._onDismissPositioningClick();this._logEngagementEvent("Close.Click")};e.prototype._closeFeatureCards=function(e){this.displayFeatureCards(!1);e&&(this.numberOfFeatureCardsViewed=e)};e.prototype._logFeatureCardEngagementEvent=function(e,t){this._engagement.logData({name:g+"."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{isOnSyncPage:this.isSyncPage,cardIndex:t,pageType:this.pageData.pageType}})};e.prototype._logEngagementEvent=function(e){this._engagement.logData({name:g+"."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{isOnSyncPage:this.isSyncPage,pageType:this.pageData.pageType}})};e.prototype._setUpAccessibilityVariables=function(){this.multiGleamAltText=l.strings.multiPremiumGleamAltText;this.singleGleamAltText=l.strings.premiumGleamAltText;this.closeButtonAriaLabel=l.strings.closeButtonAriaLabel};e.prototype._computeShowOfficeIcons=function(){var e=this._languageDataSource.getCurrentLanguageCode().toLowerCase();return-1!==["en-us","pt-br","es-es","fr-fr","en-gb","de-de","es-mx","nl-nl","tr-tr","es-us","it-it","en-ca","zh-tw","en-au","th-th"].indexOf(e)};e.prototype._fireStartupTelemetry=function(){this._logEngagementEvent("Show");if(!this.isSyncPage){this.resources.consume(r.userInfo).setPositioningUserFactWithParams(!0)}};e.prototype._getUrlWithAttribution=function(){var e=this.isSyncPage?"Sync":"Web",t="FREUpsellCardPresetPlan";5===this.pageData.pageType||6===this.pageData.pageType?t="NewPremiumFeaturesUpsellCard":7===this.pageData.pageType&&(t="TargetedMLUpsell");return this._attributionHelper.appendPurchaseAttribution({source:t,cta:"GoPremium",attributionEndpoint:e},this.pageData.purchaseUrl)};return e}(i.default);t.default=p});define("odsp-next/controls/featureCards/FeatureCards",["require","exports","./FeatureCardsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FeatureCards.html","./FeatureCards.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-feature-cards",template:e("./FeatureCards.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/featureCards/FeatureCardsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/element/ElementBinding","../../utilities/accessibility/Accessibility","../../bindings/imageLoader/ImageLoaderBinding","../overlays/Overlay","../../controls/firstRunExperience/FirstRunExperience.resx","../../providers/featureCards/FeatureCards.resx","../../providers/engagement/Engagement","../carousel/Carousel"],function(e,t,i,o,r,n,a,s,d,u,l,c,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EngagementPrefix="PremiumFeatureCards";var h=function(o){i.__extends(e,o);function e(e){var t=o.call(this)||this;t.overlayTagName=l.default.tagName;t.includeOverlay=e.includeOverlay||!1;t.addBindingHandlers({element:s.default,imageLoader:u.default,bindableHtml:r.default,focusTrap:n.default,preserveFocus:a.default});t.contentRoot=t.createObservable();var i=t.contentRoot.subscribe(function(e){d.focusFirstTabStop(e);i.dispose()});t.closeButtonAriaLabel=c.strings.closeButtonAriaLabel;t.nextButtonAriaLabel=g.strings.nextButtonAriaLabel;t.previousButtonAriaLabel=g.strings.previousButtonAriaLabel;t.primaryButtonText=g.strings.gotItButton;t.comingSoonText=g.strings.comingSoonExcited;t.currentCardIndex=t.createObservable(e.currentIndex);t.cards=e.cards;t.currentCard=t.createPureComputed(t._computeCurrentCard);t._close=e.close;t._mainButtonClick=e.mainButtonClick;t.carouselComponent={name:m.default.tagName,params:{item:t.currentCard,items:t.observables.createArray(t.cards),isEnabled:!1}};t._engagement=t.resources.consume(p.resourceKey);t._numberCardsViewed=e.numberCardsViewed||0;t._logEventForFeatureCardsViewed();return t}e.prototype.onNextBtnClick=function(){this.currentCardIndex(this.currentCardIndex.peek()+1);this._logEventForFeatureCardsViewed()};e.prototype.onPreviousBtnClick=function(){this.currentCardIndex(this.currentCardIndex.peek()-1);this._logEventForFeatureCardsViewed()};e.prototype.onPaginationClick=function(e){this.currentCardIndex(e);this._logEventForFeatureCardsViewed()};e.prototype.onCloseBtnClick=function(){this._close(this.currentCardIndex.peek(),this._numberCardsViewed)};e.prototype.onGotItButtonClick=function(){this._mainButtonClick?this._mainButtonClick(this.currentCardIndex.peek(),this._numberCardsViewed):this._close(this.currentCardIndex.peek(),this._numberCardsViewed)};e.prototype.setImageLoaded=function(e){var t=this.createObservable(!1);this.createComputed(function(){t()&&e(2)});return t};e.prototype._computeCurrentCard=function(){return this.cards[this.currentCardIndex()]};e.prototype._logEventForFeatureCardsViewed=function(){this._numberCardsViewed++;var e={1:"sawOneFeatureCard",2:"sawTwoFeatureCards",3:"sawThreeFeatureCards",4:"sawFourFeatureCards",5:"sawFiveFeatureCards",6:"sawSixFeatureCards"}[this._numberCardsViewed];e&&this._engagement.logData({name:t.EngagementPrefix+"."+e,isIntentional:!0})};return e}(o.default);t.default=h});define("odsp-next/controls/featureCards/FeatureCards.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-FeatureCards-modal>\x3c!--ko if: includeOverlay--\x3e<div class=ms-ModalOverlay></div>\x3c!--/ko--\x3e\x3c!--ko focusTrap: {}--\x3e<div class=od-FeatureCards-main data-bind="preserveFocus: true, element: contentRoot"><div class=od-FeatureCards-welcome data-bind="text: currentCard().featureName"></div><div class=od-FeatureCards-page><div class=od-FeatureCards-carousel data-bind="component: carouselComponent, style: { \'background-color\': currentCard().backgroundColor }"><div class=od-FeatureCards-animationArea data-bind="style: { \'background-color\': $host.item.backgroundColor }"><img class=od-FeatureCards-image data-bind="imageLoader: { src: $host.item.imageUrl, isLoaded: setImageLoaded.call($component, $host.loadState) }, attr: { alt: $host.item.featureName }"></div></div><div class=od-FeatureCards-closeBtn><button data-bind="click: onCloseBtnClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--ko if: (currentCardIndex() < cards.length - 1)--\x3e<button class=od-FeatureCards-NavigateNextButton data-bind="click: onNextBtnClick, attr: { \'aria-label\': nextButtonAriaLabel }"><i class="ms-Icon ms-Icon--ChevronRight" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e\x3c!--ko if: (currentCardIndex() !== 0)--\x3e<button class=od-FeatureCards-NavigatePreviousButton data-bind="click: onPreviousBtnClick, attr: { \'aria-label\': previousButtonAriaLabel }"><i class="ms-Icon ms-Icon--ChevronLeft" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e<div class=od-FeatureCards-description role=region aria-live=polite><div class=od-FeatureCards-descriptionTitle data-bind="text: currentCard().headline"></div><div class=od-FeatureCards-descriptionArea data-bind="css: { \'od-FeatureCards-descriptionArea--includesComingSoon\': currentCard().comingSoon }"><div class=od-FeatureCards-descriptionText data-bind="text: currentCard().description"></div>\x3c!--ko if: currentCard().comingSoon--\x3e<div class=od-FeatureCards-comingSoon data-bind="text: comingSoonText"></div>\x3c!--/ko--\x3e</div></div><div class=od-FeatureCards-button><button class="od-FeatureCards-mainButton od-Button" data-bind="click: onGotItButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }, text: primaryButtonText"></button></div></div><div class=od-FeatureCards-pagination data-bind="visible: cards.length > 1">\x3c!--ko foreach: cards--\x3e<a href=javascript:; class=od-FeatureCards-unselectedPage data-bind="css: { \'od-FeatureCards-curPage\': $index() === $parent.currentCardIndex() }, click: $parent.onPaginationClick.bind($parent, $index())"><i class="ms-Icon ms-Icon--CircleRing" data-bind="icon: true"></i></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/featureCards/FeatureCards.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FeatureCards-modal{font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%}@media (max-width:639px){.od-FeatureCards-modal{display:none}}.od-FeatureCards-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-FeatureCards-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default}.od-FeatureCards-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.od-FeatureCards-welcome{font-weight:100;opacity:1;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;line-height:50px;font-size:32px;padding-bottom:15px}.od-FeatureCards-page{margin:0 auto;position:relative;width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}@media (max-width:1023px){.od-FeatureCards-page{width:524px}}.od-FeatureCards-closeBtn{position:absolute;top:0}[dir=ltr] .od-FeatureCards-closeBtn{right:0}[dir=rtl] .od-FeatureCards-closeBtn{left:0}html[dir=ltr] .od-FeatureCards-closeBtn{text-align:right}html[dir=rtl] .od-FeatureCards-closeBtn{text-align:left}.od-FeatureCards-closeBtn button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.od-FeatureCards-NavigateNextButton,.od-FeatureCards-NavigatePreviousButton{position:absolute;top:120px;padding:0;background-color:transparent;display:block;border:none}.od-FeatureCards-NavigateNextButton .ms-Icon,.od-FeatureCards-NavigatePreviousButton .ms-Icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:14px;cursor:pointer;background:rgba(0,0,0,.5);padding:15px}[dir=ltr] .od-FeatureCards-NavigateNextButton{right:0}[dir=rtl] .od-FeatureCards-NavigateNextButton{left:0}[dir=ltr] .od-FeatureCards-NavigatePreviousButton{left:0}[dir=rtl] .od-FeatureCards-NavigatePreviousButton{right:0}html[dir=ltr] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{float:right}html[dir=rtl] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{float:left}html[dir=ltr] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{float:left}html[dir=rtl] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{float:right}.od-FeatureCards-carousel{height:272px;position:relative;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FeatureCards-animationArea{height:272px}.od-FeatureCards-image{height:215px;margin-top:40px}.od-FeatureCards-description{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .od-FeatureCards-description{text-align:left}html[dir=rtl] .od-FeatureCards-description{text-align:right}.od-FeatureCards-descriptionTitle{font-size:28px;font-weight:100;display:block;padding:16px 24px 12px;line-height:32px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FeatureCards-descriptionArea{font-size:14px;font-weight:400;display:block;line-height:20px;min-height:40px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:0 24px 24px}.od-FeatureCards-descriptionArea--includesComingSoon{padding-bottom:14px}.od-FeatureCards-comingSoon{padding-top:10px;font-weight:600}.od-FeatureCards-button{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center}.od-FeatureCards-mainButton{font-size:14px;font-weight:400;background-color:#107C10;border:1px solid #107C10;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:200px;height:40px;margin-bottom:16px}.od-FeatureCards-mainButton:hover{background-color:#0b6a0b;border:1px solid #0b6a0b}.od-FeatureCards-mainButton:focus{background-color:#0b6a0b;border:1px solid #004b1c}.od-FeatureCards-pagination{width:100%;height:36px}.od-FeatureCards-unselectedPage{width:12px;height:12px;margin:12px 8px;border-radius:50%;border:solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:" 1px;display:inline-block;cursor:pointer}.od-FeatureCards-pagination .od-FeatureCards-curPage{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/controls/positioningPresetPlanCard/PositioningPresetPlanCard.html",[],function(){return'\x3c!--ko ifnot: isSyncPage || displayFeatureCards()--\x3e<div class=od-PositioningPreset-headlineArea>\x3c!--ko if: pageData.supportsGleams--\x3e<img class=od-PositioningPreset-headlineGleam data-bind="attr: { src: pageData.headlineGleam, \'aria-hidden\': true, alt: multiGleamAltText }">\x3c!--/ko--\x3e<h1 class=od-PositioningPreset-header data-bind="text: pageData.headline"></h1></div>\x3c!--/ko--\x3e<div data-bind="css: { \'od-PositioningPreset-card\': !isSyncPage }"><div class=od-PositioningPreset-backgroundArea data-bind="style: { \'background-image\': \'url(\\\'\' + pageData.backgroundImage + \'\\\')\'}, visible: !displayFeatureCards(), css: { \'od-PositioningPreset-backgroundArea--syncPage\': isSyncPage }">\x3c!--ko ifnot: isSyncPage--\x3e<div class=od-PositioningPreset-closeBtnContainer><button class=od-PositioningPreset-closeBtn data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e<div class=od-PositioningPreset-textHolder data-bind="style: { \'background-image\': \'url(\\\'\' + pageData.secondaryBackgroundImage + \'\\\')\' }, css: { \'od-PositioningPreset-textHolder--syncPage\': isSyncPage, \'od-PositioningPreset-textHolder--welcomePage\': isWelcomeNewUsersPage, \'od-positioningPreset-textHolder--welcomeExistingPage\': isWelcomeExistingUsersPage, \'od-PositioningPreset-textHolder--iconExperiment\': !!pageData.planIndicatorImage}"><div class="od-PositioningPreset-smallHeadline od-PositioningPreset-smallHeadline--iconExperiment" data-bind="{ text: pageData.mainTitle }"></div><hr class=od-PositioningPreset-titleSeparator>\x3c!--ko if: pageData.planIndicatorImage--\x3e<img class=od-PositioningPreset-planBadgeIndicator--iconExperiment data-bind="attr: { src: pageData.planIndicatorImage, \'aria-hidden\': true, alt: singleGleamAltText }">\x3c!--/ko--\x3e<div class=od-PositioningPreset-mainHeadline data-bind="{text: pageData.secondaryTitle}"></div><div class=od-PositioningPreset-features><ul class=od-PositioningPreset-featureList>\x3c!--ko foreach: pageData.featureListItems--\x3e<li class=od-PositioningPreset-featureListItem><i class="ms-Icon ms-Icon--CheckMark od-PositioningPreset-checkMarkIcon" data-bind="icon: true, attr: { \'aria-hidden\': true }"></i> <button class=od-PositioningPreset-listItemText data-bind="text: $data.text, click: $parent.isSyncPage ? undefined : ($parent.launchFeatureCards.bind($parent, $data.indexInFeatureCardCarousel, $index(), $data.category)), css: { \'od-PositioningPreset-boldedListItem\': $index() === 0, \'od-PositioningPreset-listItemTextUnderline\': !($parent.isSyncPage) }, attr: { \'aria-label\': $parent.featureCardsAriaLabel, \'id\': \'od-PositioningPreset-listItem--\' + $index() }"></button>\x3c!--ko if: $parent.pageData.supportsGleams && $data.hasGleam--\x3e<img class=od-PositioningPreset-featureGleam data-bind="attr: { src: $parent.pageData.featureGleam, \'aria-hidden\': true, alt: $parent.singleGleamAltText }">\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e</ul></div>\x3c!--ko if: pageData.offiecAppsFeatureItem--\x3e<button class="od-PositiongPreset-officeFeatureText od-PositioningPreset-listItemTextUnderline od-PositioningPreset-boldedListItem" data-bind="text: pageData.officeAppsFeatureTextHeader, click: launchFeatureCards.bind($data, pageData.offiecAppsFeatureItem.indexInFeatureCardCarousel, undefined, pageData.offiecAppsFeatureItem.category)"></button>\x3c!--/ko--\x3e\x3c!--ko if: showOfficeIcons()--\x3e<img class=od-PositioningPreset-officeIcons data-bind="attr: { src: pageData.officeAppsImageUrl, alt: pageData.officeAppsImageAlt }">\x3c!--/ko--\x3e</div><div class=od-PositioningPreset-actionButtons data-bind="css: { \'od-PositioningPreset-actionButtons--syncPage\': isSyncPage, \'od-PositioningPreset-actionButtons--welcomePage\': isWelcomeNewUsersPage, \'od-PositioningPreset-actionButtons--welcomePageExistingUsers\': isWelcomeExistingUsersPage, \'od-PositioningPreset-actionButtons--iconExperiment\': !!pageData.planIndicatorImage }">\x3c!--ko ifnot: (isWelcomePage || isNewFeaturesPremiumPage)--\x3e<div class=od-PositioningPreset-price data-bind="text: pageData.price"></div><button class="od-Button od-PositioningPreset-upgradeButton" data-bind="text: pageData.primaryButtonText, click: purchasePlan"></button>\x3c!--/ko--\x3e\x3c!--ko if: (isWelcomePage || isNewFeaturesPremiumPage)--\x3e<div class=od-PositioningPreset-congratulations><img class=od-PositioningPreset-congratulationsGleam data-bind="attr: { src: pageData.headlineGleam, \'aria-hidden\': true, alt: multiGleamAltText }"><div class=od-PositioningPreset-congratulationsText data-bind="text: pageData.primaryButtonText"></div></div>\x3c!--/ko--\x3e\x3c!--Note that sync uses the id "launchTutorial" for a test, do not remove it--\x3e<button id=launchTutorial class="ms-Link od-PositioningPreset-secondaryLink od-PositioningPreset-secondaryLink--iconExperiment" data-bind="text: pageData.secondaryLinkText, click: isSyncPage ? dismissPositioningClick: launchSeeAllFeatures, css: { \'od-PositioningPreset-secondaryLink--welcomeExisting\': isWelcomeExistingUsersPage }"></button></div>\x3c!--ko if: isWelcomeNewUsersPage--\x3e<div class=od-PositioningPreset-welcomeNavigationButtons><button class=od-PositioningPreset-finishLaterButton data-bind="text: pageData.finishLaterButtonText, click: $parent.onTutorialLeftButtonClick.bind($parent, true)"></button> <button class=od-PositioningPreset-nextButton data-bind="text: pageData.nextButtonText, click: $parent.onTutorialRightButtonClick.bind($parent, true)"></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: displayFeatureCards()--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: pageData.featureCards, currentIndex: desiredCarouselIndex(), close: $component.closeFeatureCards.bind($component), numberCardsViewed: numberOfFeatureCardsViewed, mainButtonClick: $component.mainButtonClickFeatureCards.bind($component) } }"></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/positioningPresetPlanCard/PositioningPresetPlanCard.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-PositioningPreset-headlineArea{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.od-PositioningPreset-header{font-weight:100;opacity:1;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;height:40px;font-size:32px;padding-bottom:15px;margin:0}.od-PositioningPreset-headlineGleam{width:30px;height:30px;margin-right:5px}.od-PositioningPreset-card{width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023px){.od-PositioningPreset-card{width:524px}}.od-PositioningPreset-backgroundArea{top:0;width:100%;height:452px;background-repeat:no-repeat;background-position-x:center;background-size:cover;text-align:center;overflow:auto;position:relative}.od-PositioningPreset-closeBtnContainer{position:absolute;width:620px}html[dir=ltr] .od-PositioningPreset-closeBtnContainer{text-align:right}html[dir=rtl] .od-PositioningPreset-closeBtnContainer{text-align:left}@media (max-width:1023px){.od-PositioningPreset-closeBtnContainer{width:524px}}.od-PositioningPreset-closeBtn{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.od-PositioningPreset-backgroundArea--syncPage{background-size:591px 471px;height:471px}.od-PositioningPreset-planBadgeIndicator{width:48px;height:48px;margin-top:25px}.od-PositioningPreset-planBadgeIndicator--iconExperiment{width:25px;height:25px;padding:5px}.od-PositioningPreset-titleSeparator{width:180px;margin:5px auto;border:0;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PositioningPreset-planBadgeIndicator--welcomePage{margin-top:15px}.od-PositioningPreset-textHolder{background-repeat:no-repeat;background-position:center top;height:392px;margin-top:-35px}.od-PositioningPreset-textHolder--welcomePage{height:365px}.od-PositioningPreset-textHolder--iconExperiment{height:445px;margin-top:0}.od-PositioningPreset-textHolder--syncPage{height:460px;margin-top:0}.od-positioningPreset-textHolder--welcomeExistingPage.od-PositioningPreset-textHolder--iconExperiment{height:430px;margin-top:5px}.od-positioningPreset-textHolder--welcomeExistingPage.od-PositioningPreset-textHolder--withoutBadgeIcon{height:400px;margin-top:30px}.od-PositioningPreset-textHolder--welcomePage.od-PositioningPreset-textHolder--iconExperiment{height:410px;margin-top:-5px}.od-PositioningPreset-textHolder--welcomePage.od-PositioningPreset-textHolder--withoutBadgeIcon{height:385px;margin-top:10px}.od-PositioningPreset-smallHeadline{font-size:17px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-weight:600;padding-top:40px;max-width:280px;margin:0 auto}.od-PositioningPreset-smallHeadline--iconExperiment{font-size:21px;padding-top:30px}.od-PositioningPreset-smallHeadline--planIndicatorImage{padding-top:30px}.od-PositioningPreset-mainHeadline{font-size:17px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-weight:600;padding-top:2px;max-width:280px;margin:0 auto}.od-PositiongPreset-officeFeatureHeaderText,.od-PositioningPreset-mainHeadline--iconExperiment{font-size:14px}.od-PositiongPreset-officeFeatureText{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";max-width:250px;margin:auto auto 8px;background-color:transparent;border:none}.od-PositioningPreset-listItemText{padding:1px 0;font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:inline-block;background-color:transparent;border:none}[dir=ltr] .od-PositioningPreset-listItemText{margin-left:8px}[dir=rtl] .od-PositioningPreset-listItemText{margin-right:8px}html[dir=ltr] .od-PositioningPreset-listItemText{text-align:left}html[dir=rtl] .od-PositioningPreset-listItemText{text-align:right}.od-PositioningPreset-listItemTextUnderline{cursor:pointer}.od-PositioningPreset-listItemTextUnderline:hover{text-decoration:underline}.od-PositioningPreset-boldedListItem{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.od-PositioningPreset-checkMarkIcon{font-size:16px;color:#107C10;display:inline-block;-ms-flex-preferred-size:auto;flex-basis:auto;padding-top:2px}.od-PositioningPreset-featureGleam{display:inline-block;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;padding:0 8px;width:10px;height:10px}.od-PositioningPreset-features{display:-ms-flexbox;display:flex;margin:14px auto 0;padding:0}html[dir=ltr] .od-PositioningPreset-features{text-align:left}html[dir=rtl] .od-PositioningPreset-features{text-align:right}.od-PositioningPreset-featureList{max-width:270px;margin:0 auto;padding:0;min-width:1px}.od-PositioningPreset-featureListItem{margin-bottom:8px;display:-ms-flexbox;display:flex}.od-PositioningPreset-officeIcons{height:30px;display:block;margin:auto}.od-PositioningPreset-price{font-size:17px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding-bottom:14px;margin:0 auto}.od-PositioningPreset-price--iconExperiment{font-size:14px}.od-PositioningPreset-congratulationsText{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-PositioningPreset-congratulationsText{margin-left:2px}[dir=rtl] .od-PositioningPreset-congratulationsText{margin-right:2px}.od-PositioningPreset-congratulations{display:-ms-flexbox;display:flex;padding:0 30px}.od-PositioningPreset-congratulationsGleam{width:15px;height:15px}.od-PositioningPreset-actionButtons{position:absolute;bottom:45px;left:0;right:0;margin:0 auto;display:inline-block;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";max-width:290px;width:100%}.od-PositioningPreset-actionButtons.od-PositioningPreset-actionButtons--iconExperiment{bottom:35px}.od-PositioningPreset-actionButtons.od-PositioningPreset-actionButtons--welcomePage{bottom:90px}.od-PositioningPreset-actionButtons.od-PositioningPreset-actionButtons--syncPage{bottom:40px}.od-PositioningPreset-actionButtons.od-PositioningPreset-actionButtons--welcomePageExistingUsers{bottom:50px}.od-PositioningPreset-actionButtons.od-PositioningPreset-actionButtons--welcomePage.od-PositioningPreset-actionButtons--iconExperiment{bottom:75px}.od-PositioningPreset-upgradeButton{background-color:#107C10;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid #107C10;font-weight:600;min-width:200px;max-width:260px;height:40px;padding:0 20px}.od-PositioningPreset-upgradeButton:hover{background-color:#0b6a0b;border:1px solid #0b6a0b}.od-PositioningPreset-upgradeButton:focus{background-color:#0b6a0b;border:1px solid #004b1c}.od-PositioningPreset-secondaryLink{font-size:12px;display:block;margin:0 auto;margin-top:12px;cursor:pointer;background-color:transparent;border:none}.od-PositioningPreset-secondaryLink.od-PositioningPreset-secondaryLink--welcomeExisting{margin-top:25px}.od-PositioningPreset-secondaryLink.od-PositioningPreset-secondaryLink--iconExperiment{font-size:14px}.od-PositioningPreset-welcomeNavigationButtons{bottom:0;position:absolute;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PositioningPreset-welcomeNavigationButtons button{width:50%;font-size:14px;font-weight:400;display:inline-block;padding:18px 0 18px 0;text-transform:uppercase;cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:0 0;border:0}html[dir=ltr] .od-PositioningPreset-welcomeNavigationButtons>.od-PositioningPreset-nextButton{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .od-PositioningPreset-welcomeNavigationButtons>.od-PositioningPreset-nextButton{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PositioningPreset-welcomeNavigationButtons>.od-PositioningPreset-finishLaterButton{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("odsp-next/providers/premium/PremiumLightboxProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../controls/firstRunExperience/FirstRunExperience.resx","../../controls/planCard/PlanCard.resx","../../pages/storageOptions/odc/ODCStorageOptions.resx","../../providers/featureCards/FeatureCardsProvider","../../providers/featureCards/FeatureCardsProvider","../../models/storageOptions/IStorageOptions","../../resources/ProviderResourceKeys"],function(t,e,i,o,r,n,a,s,d,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){this._featureCardsProvider=t.featureCardsProvider;this._storageOptionsProvider=t.storageOptionsProvider}e.prototype.getPremiumLightboxData=function(e){var t=this;this._pageType=e;this._getDefaultLightboxData();return this._storageOptionsProvider.getPremiumPurchaseInformation(!1).then(function(e){t._modifyPageDataByPageType();e&&t._addPurchaseInformation(e);return t._defaultLightboxData},function(e){t._modifyPageDataByPageType();return t._defaultLightboxData})};e.prototype._getDefaultLightboxData=function(){var e=n.strings.Office365PrefixName;this._defaultLightboxData={pageType:this._pageType,backgroundImage:"undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/positioning-web-background.svg"):t("@ms/odsp-media/dist/media/images/premium/positioning-web-background.svg"),planIndicatorImage:"undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/diamond-blue-24.svg"):t("@ms/odsp-media/dist/media/images/premium/diamond-blue-24.svg"),secondaryBackgroundImage:"undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/positioning-white-background-large.svg"):t("@ms/odsp-media/dist/media/images/premium/positioning-white-background-large.svg"),headline:o.strings.getPremiumTitle,headlineGleam:"undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/premium-gleam-multi.svg"):t("@ms/odsp-media/dist/media/images/premium/premium-gleam-multi.svg"),mainTitle:e,secondaryTitle:o.strings.featuresTitle,primaryButtonText:o.strings.goPremiumButton,secondaryLinkText:r.strings.SeeFeaturesLink,featureListItems:this._featureCardsProvider.getFeatureListItems(d.PlanType.Personal),featureCards:this._featureCardsProvider.getFeatureCards(d.PlanType.Personal),longFormFeatureCards:this._featureCardsProvider.getReactFeatureCards(d.PlanType.Personal),featureGleam:"undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/premium-gleam-single.svg"):t("@ms/odsp-media/dist/media/images/premium/premium-gleam-single.svg"),planType:d.PlanType.Personal,supportsGleams:!1,nextButtonText:o.strings.nextButtonText,finishLaterButtonText:o.strings.finishLaterButtonText,purchaseUrl:"https://go.microsoft.com/fwlink/?LinkId=733395",officeAppsFeatureTextHeader:r.strings.officeAppsFeatureTextHeader,officeAppsImageUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/premium/office_icons.svg"):t("@ms/odsp-media/dist/media/images/premium/office_icons.svg"),officeAppsImageAlt:r.strings.OfficeAppsImageAlt,offiecAppsFeatureItem:s.OFFICE_APPS_FEATURE_ITEM}};e.prototype._addPurchaseInformation=function(e){var t=n.strings.Office365PrefixName+" "+e.planName;this._defaultLightboxData.mainTitle=t;this._defaultLightboxData.featureListItems=this._featureCardsProvider.getFeatureListItems(e.planType);this._defaultLightboxData.price=e.price;this._defaultLightboxData.purchaseUrl=e.purchaseUrl;this._defaultLightboxData.planType=e.planType;this._defaultLightboxData.featureCards=this._featureCardsProvider.getFeatureCards(e.planType);this._defaultLightboxData.longFormFeatureCards=this._featureCardsProvider.getReactFeatureCards(e.planType)};e.prototype._modifyPageDataByPageType=function(){switch(this._pageType){case 4:this._defaultLightboxData.secondaryLinkText=o.strings.laterButtonText;this._defaultLightboxData.backgroundImage="undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/positioning-sync-background.svg"):t("@ms/odsp-media/dist/media/images/premium/positioning-sync-background.svg");break;case 6:case 5:this._defaultLightboxData.backgroundImage="undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/mountain-background-large.svg"):t("@ms/odsp-media/dist/media/images/premium/mountain-background-large.svg");this._defaultLightboxData.headline=o.strings.newFeaturesHeader;6===this._pageType&&(this._defaultLightboxData.primaryButtonText=o.strings.congratsBodyText);break;case 2:case 3:this._defaultLightboxData.backgroundImage="undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/mountain-background-large.svg"):t("@ms/odsp-media/dist/media/images/premium/mountain-background-large.svg");this._defaultLightboxData.headline=o.strings.welcomeHeader;this._defaultLightboxData.primaryButtonText=o.strings.congratsBodyText;this._defaultLightboxData.secondaryLinkText=r.strings.LearnMoreText;2===this._pageType&&(this._defaultLightboxData.secondaryBackgroundImage="undefined"==typeof __webpack_public_path__?t.toUrl("@ms/odsp-media/lib/images/premium/welcome-premium-background.svg"):t("@ms/odsp-media/dist/media/images/premium/welcome-premium-background.svg"))}};return e}();e.default=l;e.resourceKey=i.createResolvedResourceKey(t("module").id,l,{featureCardsProvider:a.resourceKey,storageOptionsProvider:u.storageOptions})});define("odsp-next/providers/featureCards/FeatureCardsProvider",["require","exports","tslib","./FeatureCards.resx","../../providers/featureCards/FeatureCards.resx","../../controls/firstRunExperience/FirstRunExperience.resx","../../controls/planCard/PlanCard.resx","../../pages/storageOptions/odc/ODCStorageOptions.resx","../../models/storageOptions/IStorageOptions","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/features/Features"],function(s,e,t,i,d,u,o,r,l,n,a,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g=c.isFeatureEnabled(c.EnablePasswordProtectedLinks),p={text:o.strings.SecurityBulletAlternate,hasGleam:!0,indexInFeatureCardCarousel:1,category:1},m={text:o.strings.ProductivityToolsBullet,hasGleam:!0,indexInFeatureCardCarousel:c.isFeatureEnabled(c.EnableSecurityMomentLightbox)?5:3,category:2},h={text:u.strings.spaceListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},f={text:u.strings.spaceHomeListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},x={text:u.strings.space50ListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0};e.OFFICE_APPS_FEATURE_ITEM={text:d.strings.officeFeatureNameTwo,hasGleam:!1,indexInFeatureCardCarousel:c.isFeatureEnabled(c.EnableSecurityMomentLightbox)?8:6,category:3};var b={text:d.strings.fileRecoveryFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:0,category:1},y={text:d.strings.emailProtectionFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},T={text:d.strings.privacyToolsFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:2,category:1},P={text:d.strings.expiringLinksFeatureName,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},v={text:u.strings.offlineListItem,hasGleam:!1,indexInFeatureCardCarousel:5,category:2},_={text:d.strings.multiScanHeadline,hasGleam:!1,indexInFeatureCardCarousel:6,category:2},C={type:8,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/password-protected-links.svg"):s("@ms/odsp-media/dist/media/images/premium/password-protected-links.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.passwordProtectedLinksFeatureName,description:i.strings.passwordProtectedBody,comingSoon:!g},k={type:4,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-powered-productivity.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-powered-productivity.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:i.strings.multiScanHeadline,description:i.strings.scanFeatureBodyFallBackTwo,comingSoon:!1},S={type:3,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-expiring-links.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-expiring-links.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.expiringLinksFeatureName,description:i.strings.expiringLinksBody,comingSoon:!1},w={type:2,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-personal.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-personal.svg"),backgroundColor:"#30C6CC",featureName:i.strings.officePersonalCategory,headline:i.strings.officePersonalFeatureName,description:i.strings.officePersonalFeatureBodyFallback2,comingSoon:!1},F=t.__assign({},w,{featureName:i.strings.premiumFeaturesCategory}),I={type:1,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-home.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-home.svg"),backgroundColor:"#FDB813",featureName:i.strings.officeHomeCategory,headline:i.strings.officeHomeFeatureName,description:i.strings.officeHomeFeatureBodyFallBackThree,comingSoon:!1},B={type:0,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-storage-only.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-storage-only.svg"),backgroundColor:"#9C5096",featureName:o.strings.BasicCapacity,headline:i.strings.storageOnlyFeatureName,description:i.strings.storageOnlyFeatureBody,comingSoon:!1},G={type:7,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-sharing.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-sharing.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:i.strings.moreSharingHeadline,description:i.strings.shareFeatureBody,comingSoon:!1},R={type:6,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-office-apps.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-office-apps.svg"),backgroundColor:"#FDB813",featureName:i.strings.officeFeatureNameTwo,headline:i.strings.officeAppsFeatureName,description:i.strings.officeAppsFeatureBodyAlternate,comingSoon:!1},A=t.__assign({},R,{featureName:i.strings.premiumFeaturesCategory}),L={type:5,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-offline.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-offline.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:u.strings.offlineListItem,description:i.strings.productivityBody,comingSoon:!1},D={type:10,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-files-restore.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.fileRecoveryFeatureHeadline,description:i.strings.fileRecoveryFeatureBody,comingSoon:!1},E={type:9,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-files-restore.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.filesRestoreFeatureHeadline,description:i.strings.filesRestoreFeatureBody,comingSoon:!1},M={type:14,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-virus-protection.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.ransomwareDetectionFeatureHeadline,description:i.strings.ransomwareDetectionFeatureBody,comingSoon:!1},O={type:11,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-virus-protection.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.emailProtectionFeatureHeadline,description:i.strings.emailProtectionFeatureBody,comingSoon:!1},N={type:12,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-privacy-tools.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-privacy-tools.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.privacyToolsFeatureHeadline,description:i.strings.privacyToolsFeatureBody,comingSoon:!1},V={type:13,imageUrl:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/feature-card-outlook-premium.svg"):s("@ms/odsp-media/dist/media/images/premium/feature-card-outlook-premium.svg"),backgroundColor:"#0078D7",featureName:i.strings.premiumFeaturesCategory,headline:i.strings.outlookPremiumFeatureHeadline,description:i.strings.outlookPremiumFeatureBody,comingSoon:!1},U={type:2,title:i.strings.officePersonalFeatureName,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.oneTBStorageBody,comingSoon:!1},H={type:1,title:i.strings.officeHomeCategory,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.fiveTBStorageBody,comingSoon:!1},z={type:0,title:i.strings.storageOnlyFeatureName,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.fiftyGBStorageBody,comingSoon:!1},K={type:4,title:i.strings.multiScanHeadline,icon:"Copy",bubbleColor:"rgba(92, 45, 145, 0.1)",iconColor:"rgb(92, 45, 145)",bodyText:i.strings.multiPageScanExtendedBody,comingSoon:!1},q={type:3,title:i.strings.expiringLinksExpandedFeatureName,icon:"AlarmClock",bubbleColor:"rgba(232, 17, 35, 0.1)",iconColor:"rgb(232, 17, 35)",bodyText:i.strings.expirationDateBody,comingSoon:!1},$={type:8,title:i.strings.passwordProtectedLinksFeatureName,icon:"Lock",bubbleColor:"rgba(180, 0, 158, 0.1)",iconColor:"rgb(180, 0, 158)",bodyText:i.strings.passwordProtectedBody,comingSoon:!g},W={type:7,title:i.strings.moreSharingExpandedFeatureName,icon:"Share",bubbleColor:"rgba(255, 185, 0, 0.1)",iconColor:"rgb(255, 185, 0)",bodyText:i.strings.sharingLimitBody,comingSoon:!1},j={type:6,title:o.strings.appListWinMacTitle,icon:"ThisPC",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:i.strings.officeAppsExtendedBody,comingSoon:!1},Q={type:6,title:i.strings.officeMobileFeatureName,icon:"CellPhone",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:i.strings.officeMobileBody,comingSoon:!1},J={type:5,title:u.strings.offlineListItem,icon:"CloudDownload",bubbleColor:"rgba(16, 124, 16, 0.1)",iconColor:"rgb(16, 124, 16)",bodyText:i.strings.offlineFoldersExtendedBody,comingSoon:!1},X={type:0,features:[U],title:d.strings.storageCategoryName},Y={type:1,features:[q,$],title:o.strings.SecurityBulletAlternate},Z={type:2,features:[J,K,W],title:o.strings.ProductivityToolsBullet},ee={type:3,features:[j,Q],title:d.strings.officeAppsCategoryName},te=function(){function e(){}e.prototype.getFeatureListItems=function(e,t){void 0===t&&(t="");var i=this._getSpaceFeatureListItem(e);e!==l.PlanType.Home&&e!==l.PlanType.Personal&&e!==l.PlanType.Solo&&0<t.length&&(i.text=t);return[i,p,m]};e.prototype.getStandardFeatureListItemsForPostPurchasePlansPage=function(e){return[this._getSpaceFeatureListItem(e),P,_,v]};e.prototype.getSecurityFeatureListItems=function(){return[b,y,T]};e.prototype.getFeatureCards=function(e){var t=this._getCarouselStorageFeatureCard(e);if(e===l.PlanType.Storage)return[t];var i=c.isFeatureEnabled(c.EnableSecurityMomentLightbox)?[M,E]:[];return[t,S,C].concat(i,[L,k,G,R])};e.prototype.getFeatureCardsForSecurityMomentLightbox=function(e){void 0===e&&(e=!1);return[D,O,N].concat(e?[]:[F,V,A])};e.prototype.getReactFeatureCards=function(e){return{categories:this._getCategories(e),headerFooter:this._getHeaderFooter(e)}};e.prototype._getCategories=function(e){var t=this._getReactStorageFeatureCard(e),i=X;i.features=[t];return e===l.PlanType.Storage?[i]:[i,Y,Z,ee]};e.prototype._getHeaderFooter=function(e){var t,i=e===l.PlanType.Storage?u.strings.fiftyGBListHeader:u.strings.featuresTitle,o=this._getSecondaryTitle(e),r=this._getImageAltText(e),n=d.strings.gotItButton,a=u.strings.closeButtonAriaLabel;switch(e){case l.PlanType.Home:t="undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/storageoptions/premium-home.svg"):s("@ms/odsp-media/dist/media/images/storageOptions/premium-home.svg");break;case l.PlanType.Storage:t="undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/storage-only-badge-large.svg"):s("@ms/odsp-media/dist/media/images/premium/storage-only-badge-large.svg");break;default:t="undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/premium/premium-diamond-large.svg"):s("@ms/odsp-media/dist/media/images/premium/premium-diamond-large.svg")}return{image:t,imageAltText:r,mainTitle:i,secondaryTitle:o,buttonText:n,closeButtonAriaLabel:a}};e.prototype._getSecondaryTitle=function(e){void 0===e&&(e=l.PlanType.Personal);switch(e){case l.PlanType.Home:case l.PlanType.Trial:return o.strings.planHomeHeaderText;case l.PlanType.Storage:return u.strings.fiftyGBTitle;case l.PlanType.Solo:return a.format(u.strings.shortenedListHeader,r.strings.office365Solo);default:return o.strings.planPersonalHeaderText}};e.prototype._getImageAltText=function(e){void 0===e&&(e=l.PlanType.Personal);switch(e){case l.PlanType.Home:case l.PlanType.Trial:return u.strings.multiPremiumGleamAltText;case l.PlanType.Storage:return a.format(r.strings.iconAltText,r.strings.ListFiftyGBPlanDescription);default:return u.strings.premiumGleamAltText}};e.prototype._getSpaceFeatureListItem=function(e){void 0===e&&(e=l.PlanType.Personal);switch(e){case l.PlanType.Home:case l.PlanType.Trial:return f;case l.PlanType.Storage:return x;default:return h}};e.prototype._getCarouselStorageFeatureCard=function(e){void 0===e&&(e=l.PlanType.Personal);switch(e){case l.PlanType.Home:case l.PlanType.Trial:return I;case l.PlanType.Storage:return B;default:return w}};e.prototype._getReactStorageFeatureCard=function(e){void 0===e&&(e=l.PlanType.Personal);switch(e){case l.PlanType.Home:case l.PlanType.Trial:return H;case l.PlanType.Storage:return z;default:return U}};return e}();e.default=te;e.resourceKey=new n.ResourceKey({name:s("module").id,factory:new n.SimpleResourceFactory(te)})});define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox",["require","exports","./SecurityMomentLightboxViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SecurityMomentLightbox.html","./SecurityMomentLightbox.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-security-moment-lightbox",template:e("./SecurityMomentLightbox.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightboxViewModel",["require","exports","tslib","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../utilities/attribution/AttributionHelper","../featureCards/FeatureCards","@ms/odsp-shared/lib/base/ViewModel","../../providers/engagement/Engagement","../firstRunExperience/FirstRunExperience.resx","./SecurityMomentLightbox.resx"],function(r,e,t,n,a,s,d,i,u,l,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g="SecurityMomentLightbox",o=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.imageSource="undefined"==typeof __webpack_public_path__?r.toUrl("@ms/odsp-media/lib/images/premium/security-lightbox-shield.svg"):r("@ms/odsp-media/dist/media/images/premium/security-lightbox-shield.svg");t.closeButtonAriaLabel=l.strings.closeButtonAriaLabel;t.showFeatureCardsLinkText=c.strings.lightboxShowFeatureCardsLink;t.pageData=e.pageData;t.hasPremium=e.hasPremium;var i=t.hasPremium;t.imageAltText=i?c.strings.lightboxPaidUserTitle:c.strings.lightboxFreeUserTitle;t.headerText=i?c.strings.lightboxPaidUserTitle:c.strings.lightboxFreeUserTitle;t.descriptionText=i?c.strings.lightboxPaidUserBody:c.strings.lightboxFreeUserBody;t.displayFeatureCards=t.createObservable(!1);t.featureCardsTagName=d.default.tagName;t._onDismissPositioningClick=e.onDismissPositioningClick;t._engagement=t.resources.consume(u.resourceKey);t._instrumentationProvider=t.resources.consume(a.instrumentation);t._attributionHelper=t.resources.consume(s.resourceKey);t._actionMap=t.resources.consume(n.actionMap);t.resources.consume(a.userInfo).setPositioningUserFactWithParams(!0);t._logEngagementEvent("Show");return t}e.prototype.onCloseButtonClick=function(){this._onDismissPositioningClick();this._logEngagementEvent("Close.Click")};e.prototype.showFeatureCards=function(){this.displayFeatureCards(!0);this._logFeatureCardEngagementEvent("SeeAllFeatures.Click")};e.prototype.purchasePlan=function(){var e=this._getUrlWithAttribution();new(this.managed(this._actionMap.NavigationAction))({url:e,target:"_blank"}).execute({});this._onDismissPositioningClick();this._attributionHelper.logAttributionViaAWA({uri:e});this._logEngagementEvent("GoPremium.Click")};e.prototype.closeFeatureCards=function(e,t){this._closeFeatureCards();this._logFeatureCardEngagementEvent("CloseCards.Click",e)};e.prototype.mainButtonClickFeatureCards=function(e,t){this._closeFeatureCards();this._logFeatureCardEngagementEvent("GotIt.Click",e)};e.prototype._closeFeatureCards=function(){this.displayFeatureCards(!1)};e.prototype._logFeatureCardEngagementEvent=function(e,t){this._engagement.logData({name:g+"."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{cardIndex:t,hasPremium:this.hasPremium}})};e.prototype._logEngagementEvent=function(e){this._engagement.logData({name:g+"."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{hasPremium:this.hasPremium}})};e.prototype._getUrlWithAttribution=function(){return this._attributionHelper.appendPurchaseAttribution({source:"Positioning-Security-ReturningUser",cta:"GoPremium",attributionEndpoint:"Web"},this.pageData.purchaseUrl)};return e}(i.default);e.default=o});define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox.html",[],function(){return'\x3c!--ko ifnot: displayFeatureCards()--\x3e<div class=od-SecurityMomentLightbox><div class=od-SecurityMomentLightbox-closeButtonContainer><button class=od-SecurityMomentLightbox-closeButton data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div><img class=od-SecurityMomentLightbox-image data-bind="attr: { src: imageSource, alt: imageAltText }"><div class=od-SecurityMomentLightbox-textArea><h2 class=od-SecurityMomentLightbox-header data-bind="text: headerText"></h2><p class=od-SecurityMomentLightbox-description data-bind="text: descriptionText"></p><a href=javascript:; class=od-SecurityMomentLightbox-showFeatureCardsLink data-bind="click: showFeatureCards, text: showFeatureCardsLinkText"></a>\x3c!--ko ifnot: hasPremium--\x3e<p class=od-SecurityMomentLightbox-price data-bind="text: pageData.price"></p><button class="od-Button od-SecurityMomentLightbox-upgradeButton" data-bind="text: pageData.primaryButtonText, click: purchasePlan"></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: displayFeatureCards()--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: pageData.featureCards, currentIndex: 0, close: $component.closeFeatureCards.bind($component), mainButtonClick: $component.mainButtonClickFeatureCards.bind($component) } }"></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SecurityMomentLightbox{width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023px){.od-SecurityMomentLightbox{width:524px}}.od-SecurityMomentLightbox-image{background-color:#1A9BF5}.od-SecurityMomentLightbox-textArea{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:130px;text-align:center;padding-bottom:20px}.od-SecurityMomentLightbox-header{font-size:28px;font-weight:100;font-weight:600;display:block;padding:16px 24px 15px 24px;line-height:32px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.od-SecurityMomentLightbox-description{font-size:14px;font-weight:400;display:block;line-height:20px;padding:0 36px 10px 36px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.od-SecurityMomentLightbox-closeButtonContainer{position:absolute;width:620px}html[dir=ltr] .od-SecurityMomentLightbox-closeButtonContainer{text-align:right}html[dir=rtl] .od-SecurityMomentLightbox-closeButtonContainer{text-align:left}@media (max-width:1023px){.od-SecurityMomentLightbox-closeButtonContainer{width:524px}}.od-SecurityMomentLightbox-closeButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.od-SecurityMomentLightbox-price{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding-top:8px;padding-bottom:14px;margin:0 auto}.od-SecurityMomentLightbox-upgradeButton{background-color:#107C10;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid #107C10;font-weight:600;height:40px}.od-SecurityMomentLightbox-upgradeButton:hover{background-color:#0b6a0b;border:1px solid #0b6a0b}.od-SecurityMomentLightbox-upgradeButton:focus{background-color:#0b6a0b;border:1px solid #004b1c}.od-SecurityMomentLightbox-showFeatureCardsLink{font-size:14px;font-weight:400}"}])});define("odsp-next/providers/premium/PremiumStateProvider",["require","exports","tslib","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._userInfoProvider=t.userInfoProvider;i._storageOptionsProvider=t.storageOptionsProvider;i._userStateProvider=t.userStateProvider;return i}e.prototype.getPremiumState=function(e){return this._checkHasOffice(e).then(function(e){return null==e?0:e?3:2})};e.prototype._checkHasOffice=function(t){var i=this;return this._userInfoProvider.getIsPremium(t).then(function(e){return e},function(e){return i._storageOptionsProvider.getHasCurrentOfficePlan(t).then(function(e){return e},function(e){i._userStateProvider=i.resources.consume(r.quota.optional);if(i._userStateProvider)return 1099511627776<=i._userStateProvider.total.peek()})})};e.dependencies=i.__assign({},n.default.dependencies,{userStateProvider:r.quota.optional,userInfoProvider:r.userInfo,storageOptionsProvider:r.storageOptions});return e}(n.default);t.default=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("odsp-next/controls/premiumIntro/PremiumIntro.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-PremiumIntro-modal data-bind="visible: isOverlayVisible"><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-PremiumIntro-main data-bind="preserveFocus: true, element: contentRoot">\x3c!--ko if: isPositioningVisible--\x3e\x3c!--ko component: positioningComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/premiumIntro/PremiumIntro.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-PremiumIntro-modal{display:block;font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639px){.od-PremiumIntro-modal{display:none}}[dir=ltr] .od-PremiumIntro-modal{left:0}[dir=rtl] .od-PremiumIntro-modal{right:0}.od-PremiumIntro-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-PremiumIntro-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(.455,.03,.515,.955);animation-duration:1s}@media (prefers-reduced-motion:reduce){.od-PremiumIntro-modal .ms-ModalOverlay{animation:none}}.od-PremiumIntro-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.od-PremiumIntro-welcome{font-weight:100;opacity:1;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;height:40px;font-size:32px;padding-bottom:15px}.od-PremiumIntro-page{position:relative;width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023px){.od-PremiumIntro-page{width:524px}}.od-PremiumIntro-closeButton{position:absolute;top:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}[dir=ltr] .od-PremiumIntro-closeButton{right:0}[dir=rtl] .od-PremiumIntro-closeButton{left:0}html[dir=ltr] .od-PremiumIntro-closeButton{text-align:right}html[dir=rtl] .od-PremiumIntro-closeButton{text-align:left}"}])});define("odsp-next/controls/firstRunExperience/FirstRunExperience",["require","exports","./FirstRunExperienceViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunExperience.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-first-run-page",template:e("./FirstRunExperience.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/firstRunExperience/FirstRunExperienceViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../firstRunDialog/FirstRunDialog","../../providers/engagement/Engagement","../../controls/firstRunExperience/FirstRunExperience.resx","../../resources/ProviderResourceKeys","../../utilities/dragAndDropRobot/DragAndDropAnimationHelper"],function(e,t,i,o,r,n,a,s,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="FirstRunDialog",c="FirstRunLightBox",g=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.dialogTagName=n.default.tagName;t._provider=t.resources.consume(d.firstRunExperience);var i=t._engagement=t.resources.consume(a.resourceKey);t._provider.incrementViewCount();t.dialogParams={laterBtnText:t._provider.getLaterButtonText(),previousBtnText:s.strings.previousButtonText,nextBtnText:s.strings.nextButtonText,finishBtnText:s.strings.finishButtonText,closeBtnAriaLabel:s.strings.closeButtonAriaLabel,pages:t.createObservable(t._provider.getFirstRunPages()),onClose:t.onClose.bind(t),onFinish:t.onFinish.bind(t),onLater:t.onLater.bind(t),onNext:t.onNext.bind(t),onPrevious:t.onPrevious.bind(t),isReady:t._provider.isReady,positioningPageType:t.createPureComputed(function(){return t._provider.isReady()&&t._provider.getPositioningPageType()}),isStandardPositioningReady:t.createPureComputed(function(){return t._provider.isReady()&&t._provider.getIsStandardPositioningReady()})};i.logData({name:l+".Show"});t._currentPage=1;i.logData({name:c+".ShowPage",extraData:{variation:t._provider.getOptimizelyVariationId(),page:t._currentPage}});t.async.setTimeout(function(){t._provider.timeoutGetUpgradeOptions()},1e3);return t}e.prototype.onClose=function(){var e=this._engagement;e.logData({name:l+".Close.Click",isIntentional:!0});e.logData({name:c+".Close.Click",isIntentional:!0,extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}});this.close();this._provider.setFirstRunFlag(!0);this.resources.consume(u.resourceKey).isDialogClosed(!0)};e.prototype.onLater=function(){var e=this._engagement;e.logData({name:l+".Later.Click",isIntentional:!0});e.logData({name:c+".Later.Click",isIntentional:!0,extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}});this.close();this._provider.getShouldDismissOnLater()&&this._provider.setFirstRunFlag(!0)};e.prototype.onFinish=function(){var e=this._engagement;e.logData({name:l+".Finish.Click",isIntentional:!0});e.logData({name:c+".Finish.Click",isIntentional:!0,extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}});this.close();this._provider.setFirstRunFlag(!0)};e.prototype.onNext=function(){var e=this._engagement;e.logData({name:l+".Next.Click",isIntentional:!0});e.logData({name:c+".Next.Click",isIntentional:!0,extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}});this._currentPage++;e.logData({name:c+".ShowPage",extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}})};e.prototype.onPrevious=function(){var e=this._engagement;e.logData({name:l+".Previous.Click",isIntentional:!0});e.logData({name:c+".Previous.Click",isIntentional:!0,extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}});this._currentPage--;e.logData({name:c+".ShowPage",extraData:{variation:this._provider.getOptimizelyVariationId(),page:this._currentPage}})};e.prototype.close=function(){this.resources.consume(r.isFirstRunExperienceVisible)(!1)};return e}(o.default);t.default=g});define("odsp-next/controls/firstRunDialog/FirstRunDialog",["require","exports","./FirstRunDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunDialog.html","./FirstRunDialog.css","../overlays/Overlay"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-first-run-dialog",template:e("./FirstRunDialog.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/firstRunDialog/FirstRunDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/focus/FocusTrapBinding","../../bindings/element/ElementBinding","../../bindings/keyboard/KeyboardBinding","../overlays/Overlay","../positioningPresetPlanCard/PositioningPresetPlanCard","../firstRunExperience/FirstRunExperience.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/interactionScope/InteractionScopeBinding","../../bindings/focus/RecoverFocusBinding","../../providers/premium/PremiumLightboxProvider"],function(e,t,i,o,r,n,a,s,d,u,l,c,g,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(o){i.__extends(e,o);function e(e){var t=o.call(this)||this;t.overlayTagName=u.default.tagName;t.addBindingHandlers({element:s.default,bindableHtml:r.default,preserveFocus:n.default,focusTrap:a.default,keyboard:d.default,interactionScope:p.default,recoverFocus:m.default});var i=t.observables;t.contentRoot=i.create();t.isOverlayVisible=i.create(!0);t.currentPageIndex=i.create(0);t.welcomeText=i.pureCompute(t._computeWelcomeText);t.pages=e.pages;t.isReady=e.isReady;t.laterBtnText=e.laterBtnText;t.previousBtnText=e.previousBtnText;t.nextBtnText=e.nextBtnText;t.finishBtnText=e.finishBtnText;t.closeBtnAriaLabel=e.closeBtnAriaLabel;t.indicatorIconsAriaLabel=i.pureCompute(t._computeIndicatorIconsAriaLabel);t.isActive=i.create(!0);t.currentPage=t.createPureComputed(function(){return t.isReady()&&t.pages()[t.currentPageIndex()]});t._onClose=e.onClose;t._onLater=e.onLater;t._onFinish=e.onFinish;t._onNext=e.onNext;t._onPrevious=e.onPrevious;t._premiumLightboxProvider=t.resources.consume(h.resourceKey.optional);t._positioningPageType=e.positioningPageType;t.isStandardPositioningReady=e.isStandardPositioningReady;t.isStandardPositioning=t.createPureComputed(function(){return t._computePositioningType(1)});t.isWelcomePositioning=t.createPureComputed(function(){return t._computePositioningType(2)});t.isPositioningVisible=t.createObservable(!1);t.displayPositioning=t.createObservable(t.isWelcomePositioning());t.createComputed(t._computePositioningComponent);t.isFirstCardInStandaloneTutorial=t.createPureComputed(function(){return 0===t.currentPageIndex()&&!t.isWelcomePositioning()});t.displayIndicatorIcons=t.createPureComputed(function(){return t.displayPositioning()?t.isWelcomePositioning():1<t.pages().length});t.numberIndicatorIcons=t.createPureComputed(t._computeNumberIndicatorIcons);t.currentIndicatorIndex=t.createObservable(0);return t}e.prototype.onTutorialRightButtonClick=function(e){var t=this.currentPageIndex.peek()===this.pages.peek().length-1,i=this.displayPositioning.peek();this._navigateTutorial(!0,e,t,i,this._onFinish,this._onNext)};e.prototype.onTutorialLeftButtonClick=function(e){var t=0===this.currentIndicatorIndex.peek(),i=this.isWelcomePositioning.peek()&&1===this.currentIndicatorIndex.peek();this._navigateTutorial(!1,e,t,i,this._onLater,this._onPrevious)};e.prototype.onCloseBtnClick=function(){if(this.isStandardPositioning.peek()&&this.isStandardPositioningReady.peek())this.displayPositioning(!0);else{this._hide();this._onClose&&this._onClose()}};e.prototype.onIndicatorClick=function(e){var t=e;if(this.isWelcomePositioning.peek())if(0===e)this.displayPositioning(!0);else{t--;0===this.currentIndicatorIndex.peek()&&this.displayPositioning(!1)}this.currentPageIndex(t);this.currentIndicatorIndex(e)};e.prototype._navigateTutorial=function(e,t,i,o,r,n){var a=this.isStandardPositioning.peek()&&this.isStandardPositioningReady.peek();if(i)t&&(a?this.displayPositioning(!0):this._hideAndFireHelper(r));else{this._manageIndexes(e);o&&this.displayPositioning(!e);n&&n()}};e.prototype._hide=function(){this.isActive(!1);this.isOverlayVisible(!1)};e.prototype.dismissPositioningClick=function(){this.displayPositioning(!1);this._hide();this._onClose&&this._onClose()};e.prototype._hideAndFireHelper=function(e){this._hide();e&&e()};e.prototype._manageIndexes=function(e){if(e){this.displayPositioning.peek()||this.currentPageIndex(this.currentPageIndex.peek()+1);this.currentIndicatorIndex(this.currentIndicatorIndex.peek()+1)}else{this.isWelcomePositioning.peek()&&1===this.currentIndicatorIndex.peek()||this.currentPageIndex(this.currentPageIndex.peek()-1);this.currentIndicatorIndex(this.currentIndicatorIndex.peek()-1)}};e.prototype._computePositioningType=function(e){var t=this._positioningPageType;return this.isReady()&&t&&t()&&t()===e};e.prototype._computeNumberIndicatorIcons=function(){var e=this.pages.peek().length;return this.isWelcomePositioning()?1+e:e};e.prototype._computeWelcomeText=function(){return this.displayPositioning()?"":this.currentPage().welcomeText};e.prototype._computeIndicatorIconsAriaLabel=function(){var e=this.currentPageIndex()+1;return g.format(c.strings.indicatorIconsAriaLabel,e,this.pages.peek().length)};e.prototype._computePositioningComponent=function(){var t=this,e=this._positioningPageType.peek();this.displayPositioning()&&this.isReady()&&e&&this._premiumLightboxProvider.getPremiumLightboxData(e).then(function(e){t.positioningComponent={name:l.default.tagName,params:{pageData:e,onDismissPositioningClick:t.dismissPositioningClick.bind(t)}};t.isPositioningVisible(!0)})};return e}(o.default);t.default=f});define("odsp-next/controls/firstRunDialog/FirstRunDialog.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=FirstRunDialog-modal data-bind="visible: isOverlayVisible"><div class=ms-ModalOverlay></div>\x3c!--ko if: isReady()--\x3e\x3c!--ko focusTrap: {}--\x3e<div class=FirstRunDialog-main tabindex=-1 role=alertdialog aria-labelledby=FirstRunDialog-welcome data-bind="preserveFocus: true, element: contentRoot, interactionScope: { isScope: true }, recoverFocus: { isEnabled: isActive }, keyboard: { mappings: { Esc: onCloseBtnClick }, allowButtonEvents: true }">\x3c!--ko if: displayPositioning() && isPositioningVisible()--\x3e\x3c!--ko component: positioningComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: displayPositioning()--\x3e<h1 id=FirstRunDialog-welcome class=FirstRunDialog-welcome data-bind="text: welcomeText"></h1>\x3c!--/ko--\x3e<div class=FirstRunDialog-page><div class=FirstRunDialog-tutorial data-bind="visible: !displayPositioning(), attr: { id: \'FirstRunDialog-tutorial--\' + currentPageIndex() }"><div class=FirstRunDialog-closeBtnContainer><button class=FirstRunDialog-closeBtn data-bind="click: onCloseBtnClick, attr: { \'aria-label\': closeBtnAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div><div class=FirstRunDialog-animationArea><img data-bind="attr: { src: currentPage().imageUrl, alt: currentPage().imageAltText }"></div><div class=FirstRunDialog-desc role=region aria-live=polite><h2 id=FirstRunDialog-descTitle class=FirstRunDialog-descTitle data-bind="bindableHtml: currentPage().title"></h2><p id=FirstRunDialog-descText class=FirstRunDialog-descText data-bind="bindableHtml: currentPage().textHtml"></p></div><div class=FirstRunDialog-buttons><button class=FirstRunDialog-prevBtn data-bind="click: onTutorialLeftButtonClick.bind($data, true), text: isFirstCardInStandaloneTutorial() ? laterBtnText : previousBtnText, css: { \'FirstRunDialog-lightBtn\': isFirstCardInStandaloneTutorial(), \'FirstRunDialog-withOptional\': (currentPage().showOptionalButton && pages().length > 1) }"></button> <button class=FirstRunDialog-nextBtn data-bind="click: onTutorialRightButtonClick.bind($data, true), visible: pages().length > 1, text: currentPageIndex() === (pages().length - 1) ? finishBtnText : nextBtnText, css: { \'FirstRunDialog-withOptional\': currentPage().showOptionalButton }"></button> <button class=FirstRunDialog-optionalBtn data-bind="click: currentPage().onOptional, text: currentPage().optionalButtonText, visible: currentPage().showOptionalButton, css: { \'FirstRunDialog-withOptional\': pages().length > 1, \'FirstRunDialog-optionalBtnGreen\': currentPage().isOptionalButtonGreen, \'FirstRunDialog-optionalBtnBlue\': currentPage().isOptionalButtonBlue }"></button></div></div></div>\x3c!--ko if: displayIndicatorIcons()--\x3e<div class=FirstRunDialog-pagination role=application tabindex=0 data-bind="visible: displayPositioning() ? isWelcomePositioning() : (pages().length > 1), keyboard: { mappings: { Right: onTutorialRightButtonClick.bind($data, false), Left: onTutorialLeftButtonClick.bind($data, false) }, allowButtonEvents: true }, attr: { \'aria-label\': indicatorIconsAriaLabel }">\x3c!--ko foreach: new Array(numberIndicatorIcons())--\x3e<button class=FirstRunDialog-page tabindex=-1 data-bind="css: { \'FirstRunDialog-curPage\': ($index() === $parent.currentIndicatorIndex()) }, attr: { id: \'FirstRunDialog-page--\' + $index() }, click: $parent.onIndicatorClick.bind($parent, $index())"></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/firstRunDialog/FirstRunDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.FirstRunDialog-modal{display:block;font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639px){.FirstRunDialog-modal{display:none}}[dir=ltr] .FirstRunDialog-modal{left:0}[dir=rtl] .FirstRunDialog-modal{right:0}.FirstRunDialog-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.FirstRunDialog-modal>.ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(.455,.03,.515,.955);animation-duration:1.1s}@media (prefers-reduced-motion:reduce){.FirstRunDialog-modal>.ms-ModalOverlay{animation:none}}.FirstRunDialog-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.FirstRunDialog-main:focus{outline:0}.FirstRunDialog-welcome{font-weight:100;opacity:1;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;height:40px;font-size:32px;padding-bottom:15px;margin:0}.FirstRunDialog-page{width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023px){.FirstRunDialog-page{width:524px}}.FirstRunDialog-closeBtnContainer{position:absolute;width:620px}html[dir=ltr] .FirstRunDialog-closeBtnContainer{text-align:right}html[dir=rtl] .FirstRunDialog-closeBtnContainer{text-align:left}@media (max-width:1023px){.FirstRunDialog-closeBtnContainer{width:524px}}.FirstRunDialog-closeBtn{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.FirstRunDialog-animationArea{top:0;width:100%;height:auto;background-color:#30C6CC}.FirstRunDialog-animationArea img{width:100%;height:100%}.FirstRunDialog-desc{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:130px}html[dir=ltr] .FirstRunDialog-desc{text-align:left}html[dir=rtl] .FirstRunDialog-desc{text-align:right}.FirstRunDialog-descTitle{font-size:28px;font-weight:100;display:block;padding:16px 24px 15px 24px;line-height:24pt;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.FirstRunDialog-descText{font-size:14px;font-weight:400;display:block;line-height:15pt;padding:0 24px 22px 24px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.FirstRunDialog-buttons{width:100%;height:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";white-space:nowrap}.FirstRunDialog-buttons button{width:50%;font-size:14px;font-weight:400;display:inline-block;padding:18px 0 19px 0;text-align:center;text-transform:uppercase;cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:0 0;border:0}.FirstRunDialog-buttons>.FirstRunDialog-lightBtn{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}html[dir=ltr] .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.FirstRunDialog-buttons>.FirstRunDialog-optionalBtnBlue{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.FirstRunDialog-buttons>.FirstRunDialog-optionalBtnGreen{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:#107C10}.FirstRunDialog-buttons>.FirstRunDialog-withOptional{width:33.33%}.FirstRunDialog-pagination{width:100%;height:36px;opacity:1}.FirstRunDialog-pagination .FirstRunDialog-page{background-color:transparent;cursor:pointer;width:12px;height:12px;margin:12px 8px;border-radius:50%;border:solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:" 1px;display:inline-block}.FirstRunDialog-pagination .FirstRunDialog-curPage{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.isAnimation=i.createObservable(!1);i.isDialogClosed=i.createObservable(!1);i._isExperimentSeen=!1;i._initTime=null;i._fileUploaded=!1;i._isInitialized=!1;i._variationId=i.createObservable(0);return i}e.prototype.getInitialized=function(){return this._isInitialized};e.prototype.getExperimentSeen=function(){return this._isExperimentSeen};e.prototype.setExperimentSeen=function(){this._isExperimentSeen=!0};e.prototype.setIntializeTime=function(){this._initTime=Date.now()};e.prototype.setOptimizelyVariationId=function(e){this._variationId(e)};e.prototype.setIsInitialized=function(e){this._isInitialized=e};e.prototype.getExperimentInitTime=function(){return this._initTime};e.prototype.setFileUploaded=function(){this._fileUploaded=!0};e.prototype.getFileUploaded=function(){return this._fileUploaded};e.prototype.getOptimizelyVariationId=function(){return this._variationId};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=n;t.resourceKey=o.createResolvedResourceKey(e("module").id,n)});define("odsp-next/controls/firstRunExperience/FirstRunExperience.html",[],function(){return"\x3c!--ko component: {\r\n name: dialogTagName,\r\n params: dialogParams\r\n}--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/guidedTour/GuidedTour",["require","exports","./GuidedTourViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./GuidedTour.html","./GuidedTour.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-guided-tour",template:e("./GuidedTour.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/guidedTour/GuidedTourViewModel",["require","exports","tslib","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/PagesResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/element/ElementBinding","../guidedTourShareLightBox/GuidedTourShareLightBox","../../utilities/icons/Icon","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/ViewModel","../../utilities/accessibility/Accessibility","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../providers/engagement/Engagement","../firstRunExperience/FirstRunExperience.resx","./GuidedTour.resx","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(r,e,t,d,n,u,l,i,c,a,s,g,p,o,m,h,f,x,b,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var T,P="GuidedTour";!function(e){e[e.SignIn=0]="SignIn";e[e.Upload=1]="Upload";e[e.Mobile=2]="Mobile";e[e.Sync=3]="Sync";e[e.Share=4]="Share"}(T||(T={}));var v=function(o){t.__extends(e,o);function e(e){var n=o.call(this,e)||this;n.addBindingHandlers({element:c.default,keyboard:g.default});n.contentRoot=n.createObservable();n.taskElements=[];for(var t=0;t<5;++t)n.taskElements.push(n.createObservable());n.rocketAltText=b.strings.guidedTourRocketImageAltText;n.isReady=n.createObservable(!1);var a=n._engagement=n.resources.consume(f.resourceKey);n.isInfoPaneExpanded=n.resources.consume(u.base.infoPane.isInfoPaneExpanded);n.lightboxComponent=n.createObservable();n._provider=n.resources.consume(l.guidedTour);n._userInfoProvider=n.resources.consume(l.userInfo);n.completedSteps=n.createObservable(0);n._actionMap=n.resources.consume(d.actionMap);n._getSyncMacNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/?LinkId=248255",target:"_blank"});n._getSyncOtherNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/p/?LinkId=248256",target:"_blank"});var i=n._provider.getMobileTargetUrl();n._getMobileNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:i,target:"_blank"});n._onClose=e.onClose;var s=n._provider.getOptimizelyVariation();n.uploadHintButtonText=b.strings.uploadButtonText;n.tasks=n._getTasks();n.isInProgress=n.createPureComputed(function(){return n.completedSteps()<n.tasks.length});n.createBackgroundComputed(function(){if(!n.isInProgress()){n._userInfoProvider.updateGuidedTourData(!0,!1);n._userInfoProvider.getGuidedTourViewCount().then(function(e){a.logData({name:P+".CompleteTour",extraData:{viewCount:e,variation:n._provider.getOptimizelyVariation()}})})}});n.selectedTask=n.createObservable(null);n.headerText=n.createPureComputed(function(){if(n.isInProgress()){var e=n.selectedTask();return e&&e.subHeader?b.strings.guidedTourHeader:b.strings.guidedTourHeaderNoSubtitle}return b.strings.guidedTourConclusionHeader});n.selectedTaskAriaLabel=n.createComputed(n._computeSelectedTaskAriaLabel);n.imageUrl=n.createPureComputed(function(){var e=p.default.isRightToLeft?"_rtol":"";return"undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/guidedtour/rocket_"+n.completedSteps()+"_steps_completed"+e+".svg"):r("@ms/odsp-media/dist/media/images/guidedTour/rocket_"+n.completedSteps()+"_steps_completed"+e+".svg")});n.closeButtonAriaLabel=x.strings.closeButtonAriaLabel;n.createComputed(function(){var e=n._provider.getUploadCompleted()();n.isReady()&&e&&n._markTaskAsComplete(n._uploadTask)});n._userInfoProvider.getCompletedGuidedTourActions().then(function(e){for(var t,i=0,o=n.tasks;i<o.length;i++){var r=o[i];void 0===r.userFactIdentifier||-1<e.indexOf(r.userFactIdentifier)?r.isCompleted(!0):t||(t=r)}n.completedSteps(e.length+1);n._goToTask(t);if(!n._provider.getSeenThisSession()){n._userInfoProvider.updateGuidedTourData(!1,!0);n._provider.setSeenThisSession()}n._userInfoProvider.getGuidedTourViewCount().then(function(e){var t=new y.Qos({name:"GuidedTour.Show"}),i={resultType:y.ResultTypeEnum.Success};t.end(i);a.logData({name:P+".Show",extraData:{viewCount:e,variation:s}})});n.isReady(!0);t&&m.focusFirstTabStop(t.htmlElement.peek(),!0)});return n}e.prototype.onCloseButtonClick=function(){this._provider.setDismissedThisSession();this._engagement.logData({name:P+".Close",extraData:{isComplete:!this.isInProgress.peek(),completedTaskCount:this.completedSteps.peek(),selectedTask:this.selectedTask.peek().telemetryIdentifier,variation:this._provider.getOptimizelyVariation()}});this._onClose()};e.prototype.onTaskClicked=function(e){var t=this.tasks[e];this._engagement.logData({name:P+".ClickTask",isIntentional:!0,extraData:{task:t.telemetryIdentifier,isTaskComplete:t.isCompleted.peek(),variation:this._provider.getOptimizelyVariation()}});this._goToTask(t)};e.prototype.onRightKeyPressed=function(){var e,t=this.selectedTask.peek(),i=this.tasks.indexOf(t);e=i!==this.tasks.length-1?i+1:0;var o=this.tasks[e];this.selectedTask(o);m.focusFirstTabStop(o.htmlElement.peek(),!0)};e.prototype.onLeftKeyPressed=function(){var e,t=this.selectedTask.peek(),i=this.tasks.indexOf(t);e=0!==i?i-1:this.tasks.length-1;var o=this.tasks[e];this.selectedTask(o);m.focusFirstTabStop(o.htmlElement.peek(),!0)};e.prototype.onCTAButtonClicked=function(e){e.onClickButton();this._engagement.logData({name:P+".ClickCTAButton",isIntentional:!0,extraData:{task:e.telemetryIdentifier,variation:this._provider.getOptimizelyVariation()}});e.completeOnClickButton&&this._markTaskAsComplete(e)};e.prototype._markTaskAsComplete=function(e){if(!e.isCompleted.peek()){var t=this.tasks.filter(function(e){return!e.isCompleted.peek()});this.completedSteps(this.completedSteps.peek()+1);if(1<t.length&&e===this.selectedTask.peek()){var i=t.indexOf(e),o=t[(i+1)%t.length];this._goToTask(o);m.focusFirstTabStop(o.htmlElement.peek(),!0)}this._userInfoProvider.completeGuidedTourAction(e.userFactIdentifier);e.isCompleted(!0);this._engagement.logData({name:P+".CompleteTask",extraData:{task:e.telemetryIdentifier,completedTaskCount:this.completedSteps.peek(),variation:this._provider.getOptimizelyVariation()}})}};e.prototype._getIncompleteIcon=function(e,t){var i=this;return this.createPureComputed(function(){return new s.default(i.tasks[t].isCompleted()?"CheckMark":e)})};e.prototype._isTaskSelected=function(e){var t=this;return this.createPureComputed(function(){return t.selectedTask()===t.tasks[e]})};e.prototype._initializeLightBoxComponent=function(){this.lightboxComponent({name:a.default.tagName,params:{onClose:this._onCloseLightBoxComponent.bind(this)}})};e.prototype._onCloseLightBoxComponent=function(){this.lightboxComponent(null);this._markTaskAsComplete(this.tasks[4])};e.prototype._getSyncTask=function(){var i=this,o=this.resources.consume(h.platformDetection);return o.isIPad||o.isAndroid?this._makeSyncTask(b.strings.getSyncActionMobileSubheader,b.strings.getSyncActionMobileText,b.strings.getSyncActionWindows81MobileButtonText,function(){}):o.isMac?this._makeSyncTask(b.strings.getSyncActionMacSubheader,b.strings.getSyncActionMacText,b.strings.getSyncActionMacOtherButtonText,function(){i._getSyncMacNavigationAction.execute({})}):o.isWindows81?this._makeSyncTask(b.strings.getSyncActionPCSubheader,b.strings.getSyncActionWindows81Text,b.strings.getSyncActionWindows81MobileButtonText,function(){}):this._makeSyncTask(b.strings.getSyncActionPCSubheader,b.strings.getSyncActionOtherText,b.strings.getSyncActionMacOtherButtonText,function(){if(o.isWindows10){var e="odopen://sync?userEmail="+i.resources.consume(n.identity).getIdentity().email,t=document.createElement("iframe");t.setAttribute("src",e);t.style.display="none";t.style.width="1px";t.style.height="1px";document.documentElement.appendChild(t);i.async.setTimeout(function(){document.documentElement.removeChild(t)},1e3)}else i._getSyncOtherNavigationAction.execute({})})};e.prototype._makeSyncTask=function(e,t,i,o){return{subHeader:e,actionName:b.strings.getSyncActionName,actionText:t,buttonText:i,onClickButton:o,completeOnClickButton:!0,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("TVMonitor",T.Sync),isSelected:this._isTaskSelected(T.Sync),userFactIdentifier:2,telemetryIdentifier:"Sync",htmlElement:this.createObservable()}};e.prototype._getTasks=function(){var e=this,t={actionName:b.strings.noneCompletedActionName,actionText:this._provider.getSignInString(),isCompleted:this.createObservable(!0),incompleteIcon:this.createObservable(new s.default("CheckMark")),isSelected:this._isTaskSelected(T.SignIn),telemetryIdentifier:"SignIn",htmlElement:this.createObservable()};this._uploadTask={subHeader:b.strings.uploadActionSubheader,actionName:b.strings.uploadActionName,actionText:b.strings.uploadActionText,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("Upload",T.Upload),isSelected:this._isTaskSelected(T.Upload),userFactIdentifier:0,telemetryIdentifier:"Upload",htmlElement:this.createObservable()};var i={subHeader:b.strings.getMobileActionSubheader,actionName:b.strings.getMobileActionName,actionText:b.strings.getMobileActionText,buttonText:b.strings.getMobileActionButtonText,completeOnClickButton:!0,onClickButton:function(){e._getMobileNavigationAction.execute({})},isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("CellPhone",T.Mobile),isSelected:this._isTaskSelected(T.Mobile),userFactIdentifier:1,telemetryIdentifier:"Mobile",htmlElement:this.createObservable()},o=this._getSyncTask(),r={subHeader:b.strings.shareActionSubheader,actionName:b.strings.shareActionName,actionText:this._provider.getShareString(),buttonText:b.strings.shareActionButtonText,onClickButton:function(){e._initializeLightBoxComponent()},completeOnClickButton:!1,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("Share",T.Share),isSelected:this._isTaskSelected(T.Share),userFactIdentifier:3,telemetryIdentifier:"Share",htmlElement:this.createObservable()};return[t,this._uploadTask,i,o,r]};e.prototype._goToTask=function(e){e!==this.selectedTask.peek()&&this._engagement.logData({name:P+".ViewTask",extraData:{task:e.telemetryIdentifier,isTaskComplete:e.isCompleted.peek(),variation:this._provider.getOptimizelyVariation()}});this.selectedTask(e)};e.prototype._computeSelectedTaskAriaLabel=function(){var e=this.selectedTask();if(!e)return"";var t=this.tasks.indexOf(e);return(1===this.completedSteps.peek()?i.format(b.strings.guidedTourTaskAriaLabelOneCompleted,e.actionName,e.isCompleted.peek()?b.strings.guidedTourAriaLabelComplete:"",t+1):i.format(b.strings.guidedTourTaskAriaLabelMultipleCompleted,e.actionName,e.isCompleted.peek()?b.strings.guidedTourAriaLabelComplete:"",t+1,this.completedSteps.peek()))+" "+(e.subHeader||"")+" "+e.actionText};return e}(o.default);e.default=v});define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox",["require","exports","./GuidedTourShareLightBoxViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./GuidedTourShareLightBox.html","./GuidedTourShareLightBox.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-guided-tour-share-lightbox",template:e("./GuidedTourShareLightBox.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBoxViewModel",["require","exports","tslib","../../bindings/html/BindableHtmlBinding","../../bindings/element/ElementBinding","../../bindings/focus/FocusTrapBinding","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","../overlays/Overlay","../../bindings/focus/PreserveFocusBinding","@ms/odsp-shared/lib/base/ViewModel","../../utilities/accessibility/Accessibility","../../controls/firstRunExperience/FirstRunExperience.resx","../guidedTour/GuidedTour.resx"],function(n,e,t,a,s,d,u,l,c,g,i,p,m,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.overlayTagName=c.default.tagName;t._onClose=e.onClose;t.addBindingHandlers({element:s.default,bindableHtml:a.default,focusTrap:d.default,preserveFocus:g.default,keyboard:u.default});t.contentRoot=t.createObservable();var i=t.subscribe(t.contentRoot,function(e){p.focusFirstTabStop(e);i.dispose()});t.closeButtonAriaLabel=m.strings.closeButtonAriaLabel;t.imageAltText=h.strings.guidedTourShareLightboxImageAltText;t.title=h.strings.shareActionLightBoxHeader;t.text=h.strings.shareActionLightBoxBodyText;var o=l.default.isRightToLeft?"_rtol":"";t.imageUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/guidedtour/share_lightbox"+o+".svg"):n("@ms/odsp-media/dist/media/images/guidedTour/share_lightbox"+o+".svg");t.buttonText=h.strings.shareActionLightBoxButtonText;return t}e.prototype.onCloseButtonClick=function(){this._onClose()};return e}(i.default);e.default=o});define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-GuidedTourShareLightBox-modal><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-GuidedTourShareLightBox-main data-bind="preserveFocus: true, element: contentRoot"><div class=od-GuidedTourShareLightBox-animationArea><img data-bind="attr: { \'src\': imageUrl, \'alt\': imageAltText }"></div><div class=od-GuidedTourShareLightBox-desc><div><h2 id=od-GuidedTourShareLightBox-descTitle class=od-GuidedTourShareLightBox-descTitle data-bind="text: title"></h2><p id=od-GuidedTourShareLightBox-descText class=od-GuidedTourShareLightBox-descText data-bind="text: text"></p></div><div class=od-GuidedTourShareLightBox-buttonArea><button class="od-Button od-GuidedTourShareLightBox-GotIt" data-bind="click: onCloseButtonClick, text: buttonText"></button></div></div><button class=od-GuidedTourShareLightBox-closeButton data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }, keyboard: { allowButtonEvents: true, mappings: { Esc: $component.onCloseButtonClick } }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-GuidedTourShareLightBox-modal{display:block;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639px){.od-GuidedTourShareLightBox-modal{display:none}}[dir=ltr] .od-GuidedTourShareLightBox-modal{left:0}[dir=rtl] .od-GuidedTourShareLightBox-modal{right:0}.od-GuidedTourShareLightBox-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-GuidedTourShareLightBox-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default}.od-GuidedTourShareLightBox-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative;box-shadow:0 0 16px 0 '},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:524px}@media (max-width:1023px){.od-GuidedTourShareLightBox-main{width:524px}}.xlg .od-GuidedTourShareLightBox-main,.xxlg .od-GuidedTourShareLightBox-main,.xxxlg .od-GuidedTourShareLightBox-main,.xxxxlg .od-GuidedTourShareLightBox-main{width:620px}.od-GuidedTourShareLightBox-closeButton{position:absolute;top:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:10px 12px}[dir=ltr] .od-GuidedTourShareLightBox-closeButton{right:0}[dir=rtl] .od-GuidedTourShareLightBox-closeButton{left:0}html[dir=ltr] .od-GuidedTourShareLightBox-closeButton{text-align:right}html[dir=rtl] .od-GuidedTourShareLightBox-closeButton{text-align:left}.od-GuidedTourShareLightBox-animationArea{top:0;width:100%;height:auto;background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-GuidedTourShareLightBox-animationArea img{width:524px;height:226px}.xlg .od-GuidedTourShareLightBox-animationArea img,.xxlg .od-GuidedTourShareLightBox-animationArea img,.xxxlg .od-GuidedTourShareLightBox-animationArea img,.xxxxlg .od-GuidedTourShareLightBox-animationArea img{width:620px}.od-GuidedTourShareLightBox-desc{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:188px;max-height:288px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:column;flex-direction:column}html[dir=ltr] .od-GuidedTourShareLightBox-desc{text-align:left}html[dir=rtl] .od-GuidedTourShareLightBox-desc{text-align:right}.od-GuidedTourShareLightBox-descTitle{font-size:28px;font-weight:100;display:block;padding:12px 24px;line-height:24pt;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:auto}.od-GuidedTourShareLightBox-descText{font-size:14px;font-weight:400;display:block;line-height:15pt;padding:0 24px 12px 24px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:auto}.od-GuidedTourShareLightBox-buttonArea{text-align:center;padding-bottom:12px}.od-GuidedTourShareLightBox-buttonArea .od-Button{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/controls/guidedTour/GuidedTour.html",[],function(){return'\x3c!--ko if: isReady() && !isInfoPaneExpanded()--\x3e<div class=od-GuidedTour tabindex=0 data-bind="element: contentRoot, keyboard: { mappings: { Right: onRightKeyPressed, Left: onLeftKeyPressed, Esc: onCloseButtonClick }, allowButtonEvents: true }, attr: { \'aria-labelledby\': \'od-GuidedTour-titleText \' + \'od-GuidedTour-actionGlyph-\' + selectedTask().actionName }"><div class=od-GuidedTour-imageArea data-bind="css: { \'od-GuidedTour-imageArea-tourCompleted\': !isInProgress() }"><img data-bind="attr: { \'src\': imageUrl, \'alt\': rocketAltText }"></div><div class=od-GuidedTour-primaryTextArea data-bind="css: { \'od-GuidedTour-primaryTextArea-tourComplete\': !isInProgress() }"><div class=od-GuidedTour-headerArea><h2 id=od-GuidedTour-titleText class=od-GuidedTour-titleText data-bind="text: headerText(), css: { \'od-GuidedTour-titleText-tourComplete\': !isInProgress() }"></h2>\x3c!--ko if: isInProgress()--\x3e<h3 id=od-GuidedTour-primaryText class=od-GuidedTour-primaryText data-bind="text: selectedTask().subHeader"></h3>\x3c!--/ko--\x3e</div>\x3c!--ko if: isInProgress()--\x3e<div class=od-GuidedTour-actionGlyphArea>\x3c!--ko foreach: tasks--\x3e<button class=od-GuidedTour-actionGlyph tabindex=-1 data-bind="click: $parent.onTaskClicked.bind($parent, $index.peek()), css: { \'od-GuidedTour-actionGlyph-selected\': isSelected, \'od-GuidedTour-actionGlyph-completed\': isCompleted, \'od-GuidedTour-actionGlyph-completed-selected\': isCompleted && isSelected }, element: htmlElement, attr: { \'id\': \'od-GuidedTour-actionGlyph-\' + telemetryIdentifier, \'aria-label\': isSelected() ? $parent.selectedTaskAriaLabel : actionName }"><div class=od-GuidedTour-actionIcon data-bind="component: { name: \'od-icon-glyph\', params: { icon: incompleteIcon } }"></div><div class=od-GuidedTour-actionName data-bind="text: actionName"></div></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div><div class=od-GuidedTour-secondaryTextArea>\x3c!--ko if: isInProgress()--\x3e<p id=od-GuidedTour-actionText class=od-GuidedTour-actionText data-bind="text: selectedTask().actionText"></p>\x3c!--ko if: selectedTask().buttonText--\x3e<button class="od-Button od-Button--primary od-GuidedTour-CTAButton" data-bind="text: selectedTask().buttonText, click: onCTAButtonClicked.bind($data, selectedTask.peek()), disable: (selectedTask().disableButtonAfterCompletion && selectedTask().isCompleted)"></button>\x3c!--/ko--\x3e\x3c!--ko if: selectedTask().telemetryIdentifier === "Upload"--\x3e<button class="od-Button od-Button--primary od-GuidedTour-uploadHintButton" aria-hidden=true data-bind="text: uploadHintButtonText, disable: true"></button>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-GuidedTour-closeButton><button data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div></div>\x3c!--ko with: lightboxComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/guidedTour/GuidedTour.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-GuidedTour-closeButton{cursor:pointer;position:absolute;top:0;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-GuidedTour-closeButton{right:0}[dir=rtl] .od-GuidedTour-closeButton{left:0}.od-GuidedTour-closeButton button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:6px 8px}.od-GuidedTour-imageArea{display:none}@media screen and (min-width:801px){.od-GuidedTour-imageArea{display:block;bottom:0;position:absolute;height:188px;max-width:100%;overflow:hidden}[dir=ltr] .od-GuidedTour-imageArea{left:0}[dir=rtl] .od-GuidedTour-imageArea{right:0}.od-GuidedTour-imageArea img{height:188px}}.od-GuidedTour-imageArea-tourCompleted{display:block;bottom:0;position:absolute;height:188px;max-width:100%;overflow:hidden}[dir=ltr] .od-GuidedTour-imageArea-tourCompleted{left:0}[dir=rtl] .od-GuidedTour-imageArea-tourCompleted{right:0}.od-GuidedTour-imageArea-tourCompleted img{height:188px}.od-GuidedTour{border:none;height:188px;overflow:hidden;margin:32px 32px 0 32px;position:relative;display:none}.lg .od-GuidedTour,.xlg .od-GuidedTour,.xxlg .od-GuidedTour,.xxxlg .od-GuidedTour,.xxxxlg .od-GuidedTour{display:block}.od-GuidedTour .od-GuidedTour-headerArea{margin-right:32px;height:56px;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.xxlg .od-GuidedTour .od-GuidedTour-headerArea,.xxxlg .od-GuidedTour .od-GuidedTour-headerArea,.xxxxlg .od-GuidedTour .od-GuidedTour-headerArea{display:block;margin-right:0;height:auto}.od-GuidedTour .od-GuidedTour-primaryTextArea{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start;box-sizing:border-box;border:0;width:100%;background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";height:112px}[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:24px}@media screen and (min-width:801px){[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:196px}}.xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,.xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:justify;justify-content:space-between;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:row;flex-direction:row}[dir=ltr] .xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=ltr] .xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=ltr] .xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:204px}[dir=rtl] .xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=rtl] .xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=rtl] .xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:204px}[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete{padding-right:196px}.od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea{height:112px}.xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea,.xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea{height:auto}.od-GuidedTour .od-GuidedTour-titleText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:auto;display:inline;font-size:14px;font-weight:300;cursor:default}.xxlg .od-GuidedTour .od-GuidedTour-titleText,.xxxlg .od-GuidedTour .od-GuidedTour-titleText,.xxxxlg .od-GuidedTour .od-GuidedTour-titleText{font-size:21px;padding-bottom:2px;display:block}.od-GuidedTour .od-GuidedTour-titleText-tourComplete{font-size:21px}.xxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete,.xxxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete,.xxxxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete{padding-bottom:0}.od-GuidedTour .od-GuidedTour-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:14px;display:inline;margin-left:4px;font-weight:300;cursor:default}.xxlg .od-GuidedTour .od-GuidedTour-primaryText,.xxxlg .od-GuidedTour .od-GuidedTour-primaryText,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryText{font-size:17px;margin:auto;display:block}.od-GuidedTour .od-GuidedTour-secondaryTextArea{-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:start;justify-content:flex-start;display:-ms-flexbox;display:flex;box-sizing:border-box;border:0;background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";height:76px;width:100%}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:24px}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:16px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:16px}@media screen and (min-width:801px){[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:196px}}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";white-space:nowrap;min-width:inherit}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{margin-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{margin-right:24px}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button.is-disabled,.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button:disabled{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";border:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-GuidedTour-uploadHintButton.is-disabled,.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-GuidedTour-uploadHintButton:disabled{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";font-size:14px;font-weight:600}[dir=ltr] .xxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=ltr] .xxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=ltr] .xxxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:204px}[dir=rtl] .xxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=rtl] .xxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=rtl] .xxxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:204px}.od-GuidedTour .od-GuidedTour-actionText{font-size:12px;color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";max-width:632px;margin:0;cursor:default}.xxlg .od-GuidedTour .od-GuidedTour-actionText,.xxxlg .od-GuidedTour .od-GuidedTour-actionText,.xxxxlg .od-GuidedTour .od-GuidedTour-actionText{font-size:14px}.od-GuidedTour .od-GuidedTour-actionGlyphArea{display:-ms-inline-flexbox;display:inline-flex;white-space:nowrap}[dir=ltr] .od-GuidedTour .od-GuidedTour-actionGlyphArea{padding-right:32px}[dir=rtl] .od-GuidedTour .od-GuidedTour-actionGlyphArea{padding-left:32px}.od-GuidedTour .od-GuidedTour-actionGlyph{height:56px;width:84px;padding:8px 4px;border:0;background:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-align:center;display:inline-block;position:relative;cursor:pointer}.od-GuidedTour .od-GuidedTour-actionGlyph:hover{background:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph{width:100px;padding:12px 4px 16px 4px;height:inherit}.od-GuidedTour .od-GuidedTour-actionIcon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon{vertical-align:top;margin-bottom:8px;font-size:17px}.xxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon{padding:17.5px;font-size:21px;margin-bottom:6px;border-radius:50%;border:1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" dashed}.od-GuidedTour .od-GuidedTour-actionGlyph-selected{background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-selected:hover{background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon{border:1px #6EC9CD solid}.od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName{font-size:13px;font-weight:600}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName{font-size:15px}.od-GuidedTour .od-GuidedTour-actionGlyph-completed:hover .od-GuidedTour-actionName{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed:hover .od-GuidedTour-actionIcon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionName{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon{border:0;font-size:14px;padding-top:3px}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon{padding:22px;border:0}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected .od-GuidedTour-actionName{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected .od-GuidedTour-actionIcon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected:hover .od-GuidedTour-actionName{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected:hover .od-GuidedTour-actionIcon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionName{font-weight:400;font-size:12px;font-weight:300;color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.xxlg .od-GuidedTour .od-GuidedTour-actionName,.xxxlg .od-GuidedTour .od-GuidedTour-actionName,.xxxxlg .od-GuidedTour .od-GuidedTour-actionName{font-size:14px;height:20px}"}])});define("odsp-next/controls/firstRunBanner/FirstRunBanner",["require","exports","./FirstRunBannerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunBanner.html","./FirstRunBanner.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-first-run-banner",template:e("./FirstRunBanner.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/firstRunBanner/FirstRunBannerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../models/upsell/UpsellTypes","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/images/ImagePromise","../../bindings/css/VisibilityBinding","../../bindings/element/ElementBinding"],function(e,t,o,a,i,r,s,d,u,l,c,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="message",n=function(i){o.__extends(n,i);function n(e){var t=i.call(this,e)||this;t.upsellTypes=r.default;t.addBindingHandlers({visibility:c.default,element:g.default});t._upsellProvider=t.resources.consume(s.upsell);t._marketingRequestApiId=t._upsellProvider.getMarketingRequestApiId();t._userInfoProvider=t.resources.consume(s.userInfo);t.isIframeClosing=a.observable(!1);t.upsellIframe=a.observable(null);t.marketingRequest=a.observable("");t.isIframeVisible=a.observable(!1);t.isUpsellClosed=a.observable(!1);t.isContentLoaded=a.observable(!1);t._item=e.item;t.upsell=t.wrapObservable(e.upsell);t._init();return t}n.prototype.onCloseButtonClick=function(e,t){var i=this,o=a.utils.unwrapObservable(this.upsell);this._userInfoProvider.updateUpsellData(o,!0,!1).then(null,function(e){});this.events.off(window,p);if(o.shouldSendMessageOnClose)if(0===o.renderType){var r=a.utils.unwrapObservable(this.upsellIframe);r&&r.contentWindow&&r.contentWindow.postMessage&&r.contentWindow.postMessage("dismiss","*")}else 1===o.renderType&&this._oneRmResponse&&this._userInfoProvider.sendCloseUpsell(this._oneRmResponse,$Config.upsellUserId,$Config.mkt);this.isIframeVisible(!1);this.isIframeClosing(!0);this.async.setInterval(function(){i.isUpsellClosed(!0)},n.MARKETING_REQUEST_TIMEOUT_LENGTH);this._dimissUrl&&l.request(this._dimissUrl).then(function(){},function(){})};n.prototype.dispose=function(){i.prototype.dispose.call(this);this._ajaxRequest&&this._ajaxRequest.cancel()};n.prototype._init=function(){var t=this,i=this.upsell();this.events.on(window,p,this._onReceivedMarketingMessage);this._userInfoProvider.getUpsellIframeSrc(i,this._item()).then(function(e){if(0===i.renderType){t.marketingRequest(e);t._initMarketingRequest()}else 1===i.renderType&&t._makeAjaxRequest(e)},function(e){})};n.prototype._initMarketingRequest=function(){var e=this;this._marketingRequestTimeout=this.async.setTimeout(function(){new d.Qos({name:e._marketingRequestApiId+"-marketing-timeout"}).end({resultType:u.ResultTypeEnum.Failure});e.isUpsellClosed(!0);e.events.off(window,p)},n.MARKETING_REQUEST_TIMEOUT_LENGTH)};n.prototype._onReceivedMarketingMessage=function(e){if(null!==e){var t=e,i=[n.UPSELL_MARKETING_HOST,n.TESTING_ONERM_MARKETING_HOST,n.O365_UPSELL_MARKETING_HOST,n.TESTING_UPSELL_MARKETING_HOST,n.ONERM_MARKETING_HOST];if(-1!==t.origin.indexOf(location.host)||-1!==i.indexOf(t.origin)){this.async.clearTimeout(this._marketingRequestTimeout);if(t.data){if("close"===t.data)this.onCloseButtonClick(null,t);else if("fre"===t.data.source&&t.data.success){new d.Qos({name:this._marketingRequestApiId}).end({resultType:u.ResultTypeEnum.Success});this.isIframeVisible(!0);this.isContentLoaded(!0);this._incrementUpsellCount();this._dimissUrl=t.data.dismissUrl||""}}else{new d.Qos({name:this._marketingRequestApiId}).end({resultType:u.ResultTypeEnum.Success});this.isUpsellClosed(!0);this.events.off(window,p)}}}};n.prototype._makeAjaxRequest=function(e){var i=this,o=function(){i.isIframeVisible(!1);i.events.off(window,p)};this._ajaxRequest=this._upsellProvider.getUpsellFromOneRm(e).then(function(e){if(!(i._oneRmResponse=e))return o();if(2===e.ContentType){i.isIframeVisible(!1);i.isUpsellClosed(!0)}else if(0===e.ContentType){var t=i.upsellIframe.peek().contentWindow.document;t.open();t.write(e.Html);t.close();i.isIframeVisible(!0);i._userInfoProvider.sendShowUpsell(i._oneRmResponse,$Config.upsellUserId,$Config.mkt);i.isContentLoaded(!0)}else o()},function(e){o()})};n.prototype._incrementUpsellCount=function(){this._userInfoProvider.updateUpsellData(this.upsell(),!1,!0).then(null,function(e){})};n.MARKETING_REQUEST_TIMEOUT_LENGTH=1e4;n.ONERM_MARKETING_HOST="https://dynmsg.modpim.com";n.TESTING_ONERM_MARKETING_HOST="https://messaging-int.msonerm.com";n.UPSELL_MARKETING_HOST="https://sc.imp.live.com";n.O365_UPSELL_MARKETING_HOST="https://ocb.trafficmanager.net";n.TESTING_UPSELL_MARKETING_HOST="https://sc-ppe.imp.live.com";return n}(i.default);t.default=n});define("odsp-next/bindings/css/VisibilityBinding",["require","exports","knockout"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.update=function(e,t){var i=o.unwrap(t());e.style.visibility=i?"inherit":"hidden"};return e}();t.default=i});define("odsp-next/controls/firstRunBanner/FirstRunBanner.html",[],function(){return'\x3c!--ko if: upsell() !== null && !isUpsellClosed()--\x3e<div class=FirstRunBanner data-bind="class: \'upsell-\' + upsell().id, css: { \'FirstRunBanner--isContentLoaded\': isContentLoaded }"><iframe class=FirstRunBanner-iframe data-bind="visible: isIframeVisible, attr: { src: marketingRequest }, css: { fre: upsell().type === upsellTypes.FRE, oneUnit: upsell().type === upsellTypes.ONEUNIT, \'FirstRunBanner--isIframeClosing\': isIframeClosing }, automation: \'fre-iframe\', element: upsellIframe" scrolling=no></iframe><div class=FirstRunBanner-loadingArea data-bind="visibility: !isIframeVisible()"></div><span class="FirstRunBanner-closeButton ms-Icon ms-Icon--Cancel" role=button data-bind="icon: true, visibility: isIframeVisible, click: onCloseButtonClick"></span></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/firstRunBanner/FirstRunBanner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".FirstRunBanner{overflow:hidden;padding:0 29px 0 32px;right:0;left:0;position:relative;overflow:hidden}html[dir=rtl] .FirstRunBanner{padding:0 32px 0 29px}[dir=ltr] .FirstRunBanner{margin-right:3px}[dir=rtl] .FirstRunBanner{margin-left:3px}.FirstRunBanner-closeButton{cursor:pointer;position:absolute;top:15px;color:#666}[dir=ltr] .FirstRunBanner-closeButton{right:50px}[dir=rtl] .FirstRunBanner-closeButton{left:50px}.FirstRunBanner-iframe{border:none;width:100%}.FirstRunBanner-iframe.fre{height:260px}.FirstRunBanner-iframe.oneUnit{height:168px}.FirstRunBanner--isIframeClosing{display:none}"}])});define("odsp-next/providers/firstRunExperience/FirstRunExperienceProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._dataSource=t.resources.consume(r.firstRunExperience);t.isReady=t.createComputed(function(){return t._dataSource.isReady()});t.resources.isExposed(n.userInfo)&&(t._userInfoProvider=t.resources.consume(n.userInfo));return t}e.prototype.getFirstRunFlag=function(){return this._dataSource.getFirstRunFlag()};e.prototype.setFirstRunFlag=function(e){return this._dataSource.setFirstRunFlag(e)};e.prototype.getLaterButtonText=function(){return this._dataSource.getLaterButtonText()};e.prototype.getFirstRunPages=function(){return this._dataSource.getFirstRunPages()};e.prototype.getViewCount=function(){return this._userInfoProvider?this._userInfoProvider.getFirstRunExperienceViewCount():null};e.prototype.incrementViewCount=function(){return this._userInfoProvider?this._userInfoProvider.updateFirstRunExperienceData(!1,!0):null};e.prototype.getShouldDismissOnLater=function(){return this._dataSource.getShouldDismissOnLater()};e.prototype.getOptimizelyVariationId=function(){return this._dataSource.getOptimizelyVariationId()};e.prototype.setOptimizelyVariationId=function(e){this._dataSource.setOptimizelyVariationId(e)};e.prototype.timeoutGetUpgradeOptions=function(){this._dataSource.timeoutGetUpgradeOptions()};e.prototype.getPositioningPageType=function(){return this._dataSource.getPositioningPageType&&this._dataSource.getPositioningPageType()};e.prototype.getIsStandardPositioningReady=function(){return this._dataSource.getIsStandardPositioningReady&&this._dataSource.getIsStandardPositioningReady()};return e}(i.default);t.FirstRunExperienceProvider=a;t.default=a});define("odsp-next/providers/guidedTour/GuidedTourProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../engagement/Engagement","@ms/odsp-utilities/lib/async/Promise"],function(e,t,a,i,o,s,d,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="GuidedTour",r=function(t){a.__extends(e,t);function e(e){void 0===e&&(e={});var r=t.call(this,e)||this;r._uploadCompleted=r.resources.consume(o.didUserUploadOrCreateFile);r._dataSource=r.resources.consume(d.guidedTour);r._variation=0;r._uploadTimerStartTime=0;r._fileUploadedEventFired=!1;r._seenThisSession=!1;r._dismissedThisSession=!1;r._userInfoProvider=r.resources.consume(s.userInfo);var n=r.subscribe(r._uploadCompleted,function(e){e&&r._dismissedThisSession&&l.default.all({completedActions:r._userInfoProvider.getCompletedGuidedTourActions(),viewCount:r._userInfoProvider.getGuidedTourViewCount()}).then(function(e){var t=e.completedActions;e.viewCount;if(-1===t.indexOf(0)){r._userInfoProvider.completeGuidedTourAction(0);var i={completedTaskCount:t.length+1,variation:r._variation},o=r.resources.consume(u.resourceKey);o.logData({name:c+".CompleteTask",extraData:a.__assign({task:"Upload"},i)});o.logData({name:c+".CompleteUploadAfterDismissal",extraData:i})}n.dispose()})});return r}e.prototype.getFinalTaskParams=function(){return this._dataSource.getFinalTaskParams()};e.prototype.getFinalTaskCompleted=function(){return this._dataSource.getFinalTaskCompleted()};e.prototype.getUploadCompleted=function(){return this._uploadCompleted};e.prototype.setOptimizelyVariation=function(e){this._variation=e};e.prototype.getOptimizelyVariation=function(){return this._variation};e.prototype.logOptimizelyEvent=function(e){this._dataSource.logOptimizelyEvent(e)};e.prototype.setUploadTimerStartTime=function(e){this._uploadTimerStartTime=e};e.prototype.getUploadTimerStartTime=function(){return this._uploadTimerStartTime};e.prototype.setFileUploadedEventFired=function(){this._fileUploadedEventFired=!0};e.prototype.getFileUploadedEventFired=function(){return this._fileUploadedEventFired};e.prototype.setSeenThisSession=function(){this._seenThisSession=!0};e.prototype.getSeenThisSession=function(){return this._seenThisSession};e.prototype.getMobileTargetUrl=function(){return this._dataSource.getMobileTargetUrl()};e.prototype.setDismissedThisSession=function(){this._dismissedThisSession=!0};e.prototype.getDismissedThisSession=function(){return this._dismissedThisSession};e.prototype.getSignInString=function(){return this._dataSource.getSignInString()};e.prototype.getShareString=function(){return this._dataSource.getShareString()};return e}(i.default);t.GuidedTourProvider=r;t.default=r});define("odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/firstRunExperience/FirstRunExperience.resx","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Styling","../../../providers/inAppMessaging/InAppMessagingProvider.key","../../../utilities/features/Features","../../../utilities/educationAndUpsells/EducationAndUpsells"],function(t,e,o,i,r,n,a,s,d,u,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.isReady=t.createObservable(!1);t._userInfoProvider=t.resources.consume(n.userInfo);t._storageOptionsProvider=t.resources.consume(n.storageOptions);t._iamProvider=t.resources.consumeAsync(d.resourceKey);t._educationAndUpsells=t.resources.consume(l.resourceKey);t._shouldDismissOnLater=!1;t._isGetUpgradeOptionsTimedOut=t.createObservable(!1);t._tutorialPages=t._computeTutorialPages();t._laterButtonText=r.strings.finishLaterButtonText;t._isStandardPositioningReady=!1;t.createComputed(t._initializePositioningPage);return t}e.prototype.getFirstRunFlag=function(){return this._userInfoProvider.getFirstRunExperienceDismissed()};e.prototype.setFirstRunFlag=function(e){return this._userInfoProvider.updateFirstRunExperienceData(!0,!1).then(function(){})};e.prototype.getLaterButtonText=function(){return this._laterButtonText};e.prototype.getFirstRunPages=function(){return this._tutorialPages};e.prototype.getPositioningPageType=function(){if(!u.isFeatureEnabled(u.InAppMessagingFREPositioning)){var t="Nothing";2===this._lightboxType?t="PositioningNew":1===this._lightboxType&&(t="PositioningStandard");this._iamProvider.then(function(e){return e.logFREPositioningTelemetryData(t)})}return this._lightboxType};e.prototype.getIsStandardPositioningReady=function(){return this._isStandardPositioningReady};e.prototype.getShouldDismissOnLater=function(){return this._shouldDismissOnLater};e.prototype.getOptimizelyVariationId=function(){return this._variationId};e.prototype.setOptimizelyVariationId=function(e){this._variationId=e};e.prototype.timeoutGetUpgradeOptions=function(){this._isGetUpgradeOptionsTimedOut(!0)};e.prototype._computeTutorialPages=function(){var e=a.format(r.strings.versionBSecondPageTitle,'<i class="'+s.getIconClassName("HeartFill")+' ms-fontColor-red" style="position:relative; top:4px;">');new Array;return[{welcomeText:r.strings.versionABCWelcomeText,imageUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/firstrunexperience/versiona04_versionb01.png"):t("@ms/odsp-media/dist/media/images/firstrunexperience/versiona04_versionb01.png"),imageAltText:r.strings.versionABCFirstPageTitle,title:r.strings.versionABCFirstPageTitle,textHtml:r.strings.versionBFirstPageText},{imageUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/firstrunexperience/versionb02.png"):t("@ms/odsp-media/dist/media/images/firstrunexperience/versionb02.png"),imageAltText:e,title:e,textHtml:r.strings.versionBSecondPageText},{imageUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/firstrunexperience/versionb03.png"):t("@ms/odsp-media/dist/media/images/firstrunexperience/versionb03.png"),imageAltText:r.strings.versionBThirdPageTitle,title:r.strings.versionBThirdPageTitle,textHtml:r.strings.versionBThirdPageText}]};e.prototype._initializePositioningPage=function(){var t=this,e=this._storageOptionsProvider.isReady();e&&this._educationAndUpsells.isEligibleForPremiumUpsell("fre")&&this._userInfoProvider.hasPositioningBeenViewed().then(function(e){t._isStandardPositioningReady=!e});if(u.isFeatureEnabled(u.InAppMessagingFREPositioning))this._iamProvider.then(function(e){return e.getPremiumUpsellType()}).then(function(e){t._lightboxType=e;2===t._lightboxType&&(t._tutorialPages[0].welcomeText="");t.isReady(!0)}).catch(function(e){t.isReady(!0)});else if(this._isGetUpgradeOptionsTimedOut()||e)if(e)this._userInfoProvider.hasPositioningBeenViewed().then(function(e){if(e)t.isReady(!0);else if(t._storageOptionsProvider.hasOffice.peek()){t._lightboxType=2;t._tutorialPages[0].welcomeText="";t.isReady(!0)}else{t._storageOptionsProvider.isEligibleForPremium.peek()&&(t._lightboxType=1);t.isReady(!0)}},function(e){t.isReady(!0)});else{this._lightboxType=1;this.isReady(!0)}};return e}(i.default);e.default=c});define("odsp-next/dataSources/guidedTour/odc/GuidedTourDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/guidedTour/GuidedTour.resx","../../../resources/ProviderResourceKeys","../../../actions/odc/SkyApiHelper","../../../resources/ControlResourceKeys","../../../utilities/attribution/AttributionHelper"],function(e,t,o,i,r,n,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._finalTaskCompleted=t.createObservable(!1);t._storageOptionsProvider=t.resources.consume(n.storageOptions);t.createComputed(function(){t._storageOptionsProvider.isReady()&&t._finalTaskCompleted(t._storageOptionsProvider.hasOffice.peek())});t._didUserComeBack=t.createObservable(!1);t.createComputed(function(){t._didUserComeBack()&&!t._finalTaskCompleted.peek()&&t._storageOptionsProvider.getStorageOptions().then(function(e){t._finalTaskCompleted(e.hasCurrentOfficePlan)})});t._attributionHelper=t.resources.consume(d.resourceKey);return t}e.prototype.getFinalTaskParams=function(){var e=this,t=this.resources.consume(s.actionMap),i=this._attributionHelper.appendPurchaseAttribution({source:"GuidedTour",cta:"TryPremium",attributionEndpoint:"Web"},"https://go.microsoft.com/fwlink/?linkid=834613");return{subHeader:r.strings.premiumActionSubheader,actionName:r.strings.premiumActionName,actionText:r.strings.premiumActionText,buttonText:r.strings.premiumActionButtonText,onClickButton:function(){e._didUserComeBack(!1);a.refreshWhenVisible(e._didUserComeBack);new(e.managed(t.NavigationAction))({url:i,target:"_blank"}).execute({});e._attributionHelper.logAttributionViaAWA({uri:i})},isCompleted:this.createObservable(!1),incompleteIconName:"Diamond"}};e.prototype.getFinalTaskCompleted=function(){return this._finalTaskCompleted};e.prototype.logOptimizelyEvent=function(e){};e.prototype.getSignInString=function(){return r.strings.noneCompletedActionText};e.prototype.getShareString=function(){return r.strings.shareActionText};e.prototype.getMobileTargetUrl=function(){return"https://go.microsoft.com/fwlink/?linkid=835704"};return e}(i.default);t.GuidedTourDataSource=u;t.default=u});define("odsp-next/dataSources/inAppMessaging/odc/InAppMessagingDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-graph/lib/Models","../../url/odc/UrlDataSource","../../../dataSources/base/vroom/VroomDataRequestor","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,s,d,u,n,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(a,o);function a(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._pendingRequests={};i._cachedMessages=null;i._vroomDataRequestor=t.vroomDataRequestor;return i}a.prototype.getMessages=function(e){var i=this;void 0===e&&(e=!1);var o=this._getApiUrl()+"/messages";if(this._pendingRequests[o])return this._pendingRequests[o];if(null!=this._cachedMessages&&!e)return s.default.wrap(this._cachedMessages);var t={apiName:a.API_NAME,path:o,requestType:"GET",useAuthorizationHeaders:!0},r=new d.Qos({name:"InAppMessaging.GetMessages"}),n=this._vroomDataRequestor.send(t).then(function(e){delete i._pendingRequests[o];var t=e.messageIds;i._cachedMessages=t;r.end({resultType:d.ResultTypeEnum.Success,extraMetrics:{count:t.length}});return t},function(e){delete i._pendingRequests[o];r.end({resultType:d.ResultTypeEnum.Failure,resultCode:u.getResultCodeFromError(e),extraData:u.getQosExtraDataFromError(e)});return s.default.wrapError(e)});return this._pendingRequests[o]=n};a.prototype.markMessagesAsRead=function(e){if(0===e.length)return s.default.wrap();var t=this._getApiUrl()+"/messages",i={messageIds:e},o=new d.Qos({name:"InAppMessaging.MarkMessagesAsRead",extraMetrics:{count:e.length}}),r={apiName:a.API_NAME,path:t,requestType:"POST",postData:JSON.stringify(i),useAuthorizationHeaders:!0};this._cachedMessages=null;return this._vroomDataRequestor.send(r).then(function(){o.end({resultType:d.ResultTypeEnum.Success})},function(e){o.end({resultType:d.ResultTypeEnum.Failure,resultCode:u.getResultCodeFromError(e),extraData:u.getQosExtraDataFromError(e)});return s.default.wrapError(e)})};a.prototype._getApiUrl=function(){var e=n.default.getVroomBaseUrl(),t=e.lastIndexOf("/v1.0");-1!==t&&(e=e.substring(0,t));return e+="/inappmessaging/v1"};a.dependencies=i.__assign({},r.default.dependencies,{vroomDataRequestor:l.resourceKey});a.API_NAME="inAppMessaging";return a}(r.default);t.default=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("@ms/odsp-graph/lib/Models",["require","exports","tslib","./models/error/Error"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("odsp-next/models/inAppMessaging/MessagingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("odsp-next/providers/inAppMessaging/InAppMessagingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","../../models/inAppMessaging/MessagingTypeHelper","../../providers/engagement/Engagement","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource.key"],function(e,t,i,r,o,n,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="PositioningLogic",l=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.dataSource=t.inAppMessagingDataSource;i._engagement=t.engagement;i._didUserNavigateAwayFromRoot=!1;i._didUserVisitRoot=!1;return i}e.prototype.getPremiumUpsellType=function(i){void 0===i&&(i=!1);return this.dataSource.getMessages().then(function(e){var t=e.map(function(e){return a.convertInAppMessageToPremiumUpsellType(e,i)}).filter(function(e){return void 0!==e});if(0!==t.length)return t[0]})};e.prototype.isNewUser=function(){return this.isAnyMessageActive(206)};e.prototype.markMessagesRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.dataSource.markMessagesAsRead(e)};e.prototype.markMessagesReadIfPresent=function(){for(var i=this,o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];return this.dataSource.getMessages().then(function(t){var e=o.filter(function(e){return-1!==t.indexOf(e)});return i.dataSource.markMessagesAsRead(e)})};e.prototype.isAnyMessageActive=function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];return this.dataSource.getMessages().then(function(e){for(var t=0,i=e;t<i.length;t++)for(var o=i[t],r=0,n=a;r<n.length;r++){if(o===n[r])return!0}return!1})};e.prototype.areAllMessagesNotActive=function(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];return this.dataSource.getMessages().then(function(e){for(var t=0,i=e;t<i.length;t++){for(var o=i[t],r=!1,n=0,a=s;n<a.length;n++){if(o===a[n]){r=!0;break}}if(r)return!1}return!0})};e.prototype.logPositioningTelemetryData=function(i,e){var o=this;void 0===e&&(e=!1);n.isFeatureEnabled(n.UseInAppMessagingAPI)&&!this._didUserNavigateAwayFromRoot&&this.getPremiumUpsellType(e).then(function(e){var t="Nothing";switch(e){case 1:t="PositioningStandard";break;case 2:t="PositioningNew";break;case 3:t="PositioningExisting";break;case 5:t="NewFeature";break;case 6:t="NewFeaturePremium";break;case 7:return}o._engagement.logData({name:u+".ExistingPos."+i+".OldCalc"});o._engagement.logData({name:u+".ExistingPos."+t+".NewCalc"})},function(e){o._engagement.logData({name:u+".ExistingPos.Error.NewCalc"})})};e.prototype.logFREPositioningTelemetryData=function(i){var o=this;n.isFeatureEnabled(n.UseInAppMessagingAPI)&&!this._didUserNavigateAwayFromRoot&&this.getPremiumUpsellType().then(function(e){var t="Nothing";switch(e){case 1:t="PositioningStandard";break;case 2:t="PositioningNew";break;case 3:t="PositioningExisting";break;case 5:t="NewFeature";break;case 6:t="NewFeaturePremium"}o._engagement.logData({name:u+".FREPos."+i+".OldCalc"});o._engagement.logData({name:u+".FREPos."+t+".NewCalc"})},function(e){o._engagement.logData({name:u+".FREPos.Error.NewCalc"})})};e.prototype.logNewUserTelemetryData=function(t){var i=this;n.isFeatureEnabled(n.UseInAppMessagingAPI)&&!this._didUserNavigateAwayFromRoot&&this.isAnyMessageActive(206).then(function(e){i._engagement.logData({name:u+".ShowFRE."+(t?"True":"False")+".OldCalc"});i._engagement.logData({name:u+".ShowFRE."+(e?"True":"False")+".NewCalc"})},function(e){i._engagement.logData({name:u+".ShowFRE.Error.NewCalc"})})};e.prototype.didUserNavigateAwayFromRoot=function(){return this._didUserNavigateAwayFromRoot};e.prototype.didUserVisitRoot=function(){return this._didUserVisitRoot};e.prototype.markUserNavigatedAwayFromRoot=function(){this._didUserNavigateAwayFromRoot=!0};e.prototype.markUserVisitedRoot=function(){this._didUserVisitRoot=!0};e.dependencies=i.__assign({},r.default.dependencies,{inAppMessagingDataSource:d.resourceKey,engagement:s.resourceKey});return e}(r.default);t.default=l;t.resourceKey=o.createResolvedResourceKey(e("module").id,l)});