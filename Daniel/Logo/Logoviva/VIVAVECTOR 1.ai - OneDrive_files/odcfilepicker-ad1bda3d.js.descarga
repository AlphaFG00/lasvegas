define("odsp-next/pages/filePicker/odc/ConsumerFilePicker",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ConsumerFilePickerViewModel","./ConsumerFilePicker.html"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-consumer-file-picker",template:e("./ConsumerFilePicker.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/pages/filePicker/odc/ConsumerFilePickerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../od/FilePicker","../od/FilePickerAgentHelper","../../../resources/DataSourceResourceKeys","../../../dataSources/itemPicker/odc/ItemPickerDataSource","../../../dataSources/itemPicker/odc/LeftNavDataSource","../../../bindings/host/HostBinding","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,s,c,l,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(a){i.__extends(e,a);function e(e,t){void 0===t&&(t={});var i=a.call(this,e)||this;i.addBindingHandlers({host:p.default});var r,o=i.resources;o.exposeFactory(l.itemPicker,new m.AliasResourceFactory(d.resourceKey));o.exposeFactory(l.leftNav,new m.AliasResourceFactory(u.resourceKey));if(e.agent)r=e;else{var n=new(i.child(c.typeResourceKey));r={agent:n.getAgent(),behavior:n.getBehavior()}}i.filePickerTagName=s.default.tagName;i.filePickerParams=r;return i}return e}(r.default);t.default=o});define("odsp-next/pages/filePicker/od/FilePicker",["require","exports","./FilePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePicker.html","./FilePicker.css","../../../controls/progressSpinnerFlat/ProgressSpinnerFlat","../../../controls/itemPicker/ItemPicker"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-filepicker",template:e("./FilePicker.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/pages/filePicker/od/FilePickerViewModel",["require","exports","tslib","../../baseInnerPage/od/DataManagerPageViewModel","../../../providers/dataManager/files/FilesDataManager","../../../providers/dataManager/photos/PhotosDataManager","./commandSets/FilePickerCommandSet","../../../dataSources/itemPicker/ItemPickerConstants","../../../dataSources/url/QueryType","../../../bindings/component/ControlBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/host/HostBinding","../../../controls/itemContent/photosRoot/PhotosRootItemContent.key","../../../controls/itemContent/folder/FolderItemContent","../../../models/engagement/Engagement","../Engagement","../../../models/command/set/UnionCommandSet","./commandSets/FilePickerItemCommandProvider","../../../providers/itemCommand/ItemCommandProvider","../../../models/itemPicker/ItemPickerSelectionHelper","../../../bindings/aria/HideWhenInactiveBinding","../../../providers/dialog/DialogProvider","../../../providers/panel/PanelProvider","../../../controls/overlays/host/OverlayHost","../../../controls/dialogHost/DialogHost","../../../controls/panelHost/PanelHost","../../../controls/FabricIconsDeferred"],function(e,t,i,r,o,n,m,a,s,c,f,v,l,d,h,g,P,y,k,u,_,b,I,x,w,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(p){i.__extends(e,p);function e(e,t){void 0===t&&(t={});var i=p.call(this,e)||this;i.overlayHostTagName=x.default.tagName;i.dialogHostTagName=w.default.tagName;i.panelHostTagName=S.default.tagName;i.addBindingHandlers({scrollContainer:f.default,host:v.default,hideWhenInactive:_.default});var r=i.resources;r.bind(I.resourceKey);r.bind(b.resourceKey);var o=e.behavior,n=e.commandSet,a=e.agent,s=e.shouldHostOverlays,c=void 0===s||s;i._behavior=o;r.expose(h.engagementSourceResourceKey,r.consume(h.engagementSourceResourceKey).withPart(g.filePickerEngagementPart,{behavior:o}));i.shouldHostOverlays=c;var l=new(r.consume(y.typeResourceKey))({behavior:o});r.expose(k.resourceKey,l);var d=new(i.managed(m.default))({behavior:o}),u=[];u.push(d);n&&u.push(n);i.itemPickerParams={behavior:o,agent:a,commandSet:new(i.managed(P.default))({commandSets:u})};d.navigateToPivot();return i}e.prototype.computeCurrentPageName=function(){var e;switch(this.item.peek().displayType){case s.default.AllMyPhotos:e="Photos";break;default:e="Files"}return"FilePicker-"+e};e.prototype.computeContentControl=function(){var e=p.prototype.computeContentControl.call(this);if(e)return e;var t=this.getContentControlParams();switch(this.item().displayType){case s.default.AllMyPhotos:return c.toSpecification(l.resourceKey,t);default:return c.toSpecification(d.resourceKey,t)}};e.prototype.computeCreateDataManager=function(){var e,t=this.viewParams();switch(this.urlDataSource.getQueryType(t)){case s.default.AllMyPhotos:e=this._createPhotosDataManager;break;default:e=this._createFilesDataManager}return e};e.prototype.getSelectionOptions=function(e){var t=e.behavior,i=t.selectionMode,r=t.maximumSelectedCount,o=e.behavior,n=new(this.child(u.typeResourceKey))({behavior:o});return{mode:a.SELECTION_MODE_MAPPING[i],maximumSelectedCount:r,canSelectItem:n.getCanSelectItem()}};e.prototype._createFilesDataManager=function(){return new(this.managed(o.default))({itemResultSetOptions:this._behavior.itemResultSetOptions})};e.prototype._createPhotosDataManager=function(){return new(this.managed(n.default))({itemResultSetOptions:this._behavior.itemResultSetOptions})};return e}(r.default);t.default=p});define("odsp-next/pages/filePicker/od/commandSets/FilePickerCommandSet",["require","exports","tslib","knockout","../../../../controls/commands/BaseCommandSet","../../../../resources/ControlResourceKeys","../../../../controls/commands/Command","../../../../controls/commands/Commands.resx","../../../../utilities/icons/Icon","../../../../controls/itemPicker/resources/ItemPickerResourceKeys","../../../../controls/operation/commands/OperationCommandBuilder","../../../files/od/SwitchLayoutCommandBuilder","../../../../providers/itemPicker/ItemPickerProvider","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,i,c,r,l,d,u,p,m,f,v,h,g,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(s,a);function s(e){void 0===e&&(e={});var t=a.call(this,e)||this;t._itemPickerProvider=t.resources.consume(h.resourceKey);t._viewParams=t.resources.consume(l.viewParams);t._selection=t.resources.consume(l.itemsSelection);t._isSelectionModeOn=t.createPureComputed(t._computeSelectionModeOn);var i=e.behavior,r=void 0===i?t.resources.consume(m.behavior):i;t._behavior=r;t._actionMap=t.resources.consume(l.actionMap);t._initializePivots(t._behavior);t._navigationAction=new(t.managed(t._actionMap.NavigationAction))({url:t.createPureComputed(t._computeInitialUrl),ignoreHistory:!0});var o,n=new(t.managed(f.default))({renderLabel:1}).command;(o=t.commands).push.apply(o,t._pivots.concat([new(t.managed(d.CommandViewModel))({location:0,action:new(t.managed(t._actionMap.OpenAction))({openRelation:3}),keys:["AltUp"]}),new(t.managed(d.CommandViewModel))({text:u.strings.CreateFolderCommand,icon:new p.default("Folder"),action:new(t.managed(t._actionMap.CreateFolderAction)),automationId:"createFolder",engagementName:"NewFolder"+s.sourceNameEngagement}),new(t.managed(d.CommandViewModel))({text:u.strings.Upload,tooltip:u.strings.UploadCommandTooltip,icon:new p.default("Upload"),requiredChildren:1,automationId:"upload",engagementName:"Upload"+s.sourceNameEngagement,children:c.observableArray([new(t.managed(d.CommandViewModel))({text:u.strings.UploadFile,collapsedText:t.createObservable(u.strings.Upload),action:new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:g.UploadProcessorType.Html5file}),automationId:"uploadFiles",engagementName:"UploadFiles"+s.sourceNameEngagement}),new(t.managed(d.CommandViewModel))({text:u.strings.UploadFolder,action:new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:g.UploadProcessorType.Folder}),automationId:"uploadFolder",engagementName:"UploadFolder"+s.sourceNameEngagement})])}),new(t.managed(d.CommandViewModel))({text:u.strings.selectItems,renderLabel:2,icon:new p.default("CheckboxComposite"),action:new(t.managed(t._actionMap.ToggleSelectionModeAction))}),n,new(t.managed(v.default))({isSelectionMode:t._isSelectionModeOn}).command,new(t.managed(d.CommandViewModel))({location:0,action:new(t.managed(t._actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]})]));return t}s.prototype.navigateToPivot=function(){this._navigationAction.execute(null).done()};s.prototype._initializePivots=function(e){var t=this;this._pivots=[];if(!e.showNavigation){var i=this._itemPickerProvider.getPivots({behavior:e,viewParams:this._viewParams.peek()}).pivots;if(1===i.length)return;for(var r=function(e){return t.createPureComputed(function(){return e(t._viewParams())})},o=0;o<i.length;o++){var n=i[o],a=n.item,s=r(n.isActive),c=this.createObservable(a);this._pivots.push(new(this.managed(d.CommandViewModel))({text:a.displayName,isPermanent:!0,action:new(this.managed(this._actionMap.DefaultClickAction))({item:c,sourceEngagement:"FilePicker.Pivot.Click"}),isCurrentView:s,isLastPivot:o===i.length-1}))}}};s.prototype._computeInitialUrl=function(){var e=this._itemPickerProvider.getInitialViewParams({behavior:this._behavior,viewParams:this._viewParams.peek()}).viewParams;return"#"+o.serializeQuery(e)};s.prototype._computeSelectionModeOn=function(){return this._selection&&0<this._selection.selection().length};s.sourceNameEngagement=".InFilePickerCommandBar";return s}(r.default);t.default=n});define("odsp-next/controls/itemPicker/resources/ItemPickerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.actionMap=new i.ResourceKey("actionMap");t.agent=new i.ResourceKey("agent");t.behavior=new i.ResourceKey("behavior");t.status=new i.ResourceKey("status")});define("odsp-next/pages/files/od/SwitchLayoutCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/commands/Command","../FilesCommandSetHelper","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../controls/commands/Commands.resx","../../../utilities/features/Features","../../../controls/list/layouts/LayoutType","../../../utilities/icons/Icon","knockout"],function(e,t,i,r,o,v,h,g,P,y,n,k,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=n.isFeatureEnabled(n.CompactListViewInFiles),a=function(f){i.__extends(e,f);function e(e){void 0===e&&(e={});var t=f.call(this,e)||this,i=t.resources.consume(g.actionMap);t._layoutType=t.resources.consume(P.files.layoutType);var r=e.isSelectionMode,o=void 0===r?t.createObservable(!1):r,n=e.location,a=void 0===n?4:n,s=e.allowAlbumView,c=void 0!==s&&s,l=e.clearContextualFilter,d=void 0!==l&&l;t._shouldClearContextualFilter=d;var u=new(t.managed(h.default))({showLabels:null});t._viewToggleIcon=t.createPureComputed(function(){return u.computeViewSelectorIcon()},{deferEvaluation:!0});t._viewSelectorAriaLabel=t.createPureComputed(t._computeViewSelectorAriaLabel);var p=[new(t.managed(v.CommandViewModel))({text:y.strings.ViewList,tooltip:y.strings.ViewListCommandTooltip,icon:new _.default(h.default.detailsIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(i.ToggleListLayoutAction))({layoutType:k.Details,clearContextualFilter:t._shouldClearContextualFilter}),automationId:"switchLayout",engagementName:"ViewList"})].concat(I?[new(t.managed(v.CommandViewModel))({text:y.strings.ViewCompactList,tooltip:y.strings.ViewCompactListCommandTooltip,icon:new _.default(h.default.compactDetailsIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(i.ToggleListLayoutAction))({layoutType:k.CompactDetails,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewCompactList"})]:[],[new(t.managed(v.CommandViewModel))({text:y.strings.ViewGrid,tooltip:y.strings.ViewGridCommandTooltip,icon:new _.default(h.default.gridIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(i.ToggleListLayoutAction))({layoutType:k.Grid,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewGrid"})]);c&&p.push(new(t.managed(v.CommandViewModel))({text:y.strings.ViewLargeGrid,renderLabel:0,icon:new _.default(h.default.singleAlbumIcon),isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(i.ToggleListLayoutAction))({layoutType:k.SingleAlbum,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewLargeGrid"}));var m=new(t.managed(v.CommandViewModel))({tooltip:y.strings.ViewsCommandTooltip,accessibleLabel:t._viewSelectorAriaLabel,renderLabel:0,icon:t._viewToggleIcon,location:a,isHidden:o,hasIconOnly:!0,collapseSingleChildCommands:!0,requiredChildren:2,children:b.observableArray(p)});t.command=m;return t}e.prototype._computeViewSelectorAriaLabel=function(){var e,t=this._layoutType();e=t===k.SingleAlbum?y.strings.ViewAlbumView:t===k.Grid||t===k.CustomGridList?y.strings.ViewGrid:t===k.CompactDetails?y.strings.ViewCompactList:y.strings.ViewList;return o.format(y.strings.ViewsCommandAriaLabel,e,"","")};return e}(r.default);t.default=a});define("odsp-next/providers/itemPicker/ItemPickerProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,o,i,n,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){o.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._itemPickerDataSource=t.itemPickerDataSource;i._urlDataSource=t.urlDataSource;return i}e.prototype.getHandler=function(e){return this._itemPickerDataSource.getHandler(e)};e.prototype.getPivots=function(e){return this._itemPickerDataSource.getPivots(e)};e.prototype.getInitialViewParams=function(e){var t=e.behavior.typeFilter,i=void 0===t?{filters:[]}:t,r=e.viewParams;return{viewParams:o.__assign({},r,this._urlDataSource.saveItemTypeFilter(i))}};e.prototype.getItemFromPickerItem=function(e){var t={key:""};a.default(t,{itemId:e.id,graph:{itemId:e.id,driveId:s.optional(e.parentReference&&e.parentReference.driveId)},name:s.backup(e.name),extension:s.backup(e.extension),folder:s.optional(e.folder&&{})});a.default(t,this._itemPickerDataSource.getItemFromPickerItem(e));return t};e.prototype.getPickerItemFromItem=function(e,t){var i={id:e.itemId};a.default(i,{id:e.itemId,parentReference:s.optional(e.graph&&{driveId:e.graph.driveId}),folder:s.optional(e.folder&&{})});0<t.hostAuthenticationLevel&&a.default(i,{name:e.name,extension:e.extension});a.default(i,this._itemPickerDataSource.getPickerItemFromItem(e,t));return i};e.dependencies=o.__assign({},i.default.dependencies,{itemPickerDataSource:n.itemPicker,urlDataSource:n.url});return e}(i.default);t.default=c;t.resourceKey=r.createResolvedResourceKey(e("module").id,c)});define("odsp-next/dataSources/itemPicker/ItemPickerConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MSA_CLIENT_ID_PARAM="msa_client_id";t.AAD_CLIENT_ID_PARAM="aad_client_id";t.RETURN_URL_PARAM="ru";t.VIEW_TYPE_PARAM="view_type";t.SELECTION_MODE_PARAM="selection_mode";t.LINK_TYPE_PARAM="link_type";t.ACCESS_LEVEL_PARAM="access";t.PROMPT_PARAM="prompt";t.PROMPT_SELECT_ACCUNT_VALUE="select_account";t.SELECTION_MODE_VALUES={"":0,multi:1,multiple:1,single:0};t.SELECTION_MODE_MAPPING=((i={})[1]=0,i[0]=1,i);t.VIEW_TYPE_VALUES={"":1,file:1,folder:2,all:0};t.LINK_TYPE_VALUES={"":1,weblink:1,downloadlink:2,webviewlink:0};t.ACCESS_LEVEL_VALUES={"":0,read:0,readwrite:1};t.SELECTION_MAX_ITEMS=10;var i});define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(i,e,t,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./PhotosRootItemContent",getModule:function(){return new t.default(function(e,t){i(["./PhotosRootItemContent"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/pages/filePicker/Engagement",["require","exports","../../models/engagement/Engagement"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filePickerEngagementPart=new i.EngagementPart("FilePicker",3,{getEngagementData:function(e){var t=e.behavior;return{scenario:"FilePicker",extraData:{clientId:t.aadClientId||t.msaClientId,isFilePicker:1}}}})});define("odsp-next/pages/filePicker/od/commandSets/FilePickerItemCommandProvider",["require","exports","../../../../providers/itemCommand/ItemCommandProvider","../../../../models/item/command/CoreItemCommandKeys","../../../../models/item/command/FileSystemItemCommandKeys","../../../../models/item/command/WebItemCommandKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._behavior=e.behavior;this._itemCommandProvider=t.itemCommandProvider}e.prototype.getCommand=function(e,t){var i,r=this._behavior.viewType;switch(t){case o.defaultClick:case n.createFolder:case n.open:i=!0;break;case a.upload:i=2!==r;break;default:i=!1}if(i)return this._itemCommandProvider.getCommand(e,t)};e.dependencies={itemCommandProvider:i.resourceKey};return e}();t.default=s;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/models/itemPicker/ItemPickerSelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../item/ItemType","../item/ItemParentHelper","../item/IItemTypeFilter","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,l,n,d,u,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this,r=e.behavior;i._behavior=r;i._itemParentHelper=t.itemParentHelper;return i}e.prototype.getCanSelectItem=function(){for(var i=this,e=this._behavior,t=e.viewType,r=e.typeFilter,o=[],n=function(t){if("string"==typeof t)"."===t[0]&&o.push(function(e){return u.equalsCaseInsensitive(e.extension,t)});else switch(t){case d.ItemTypeFilter.folder:break;case d.ItemTypeFilter.photo:o.push(function(e){return!!e.photo&&!e.video});break;case d.ItemTypeFilter.video:o.push(function(e){return!!e.video});break;case d.ItemTypeFilter.media:o.push(function(e){return!!e.audio||!!e.photo||!!e.video});break;case d.ItemTypeFilter.document:o.push(function(e){return!!e.appMap});break;case d.ItemTypeFilter.audio:o.push(function(e){return!!e.audio})}},a=0,s=(void 0===r?{filters:[]}:r).filters;a<s.length;a++){n(s[a])}var c=[];o.length&&c.push(function(t){return o.some(function(e){return e(t)})});switch(t){case 1:c.push(function(e){return e.type!==l.default.Folder});break;case 2:c.push(function(e){return e.type===l.default.Folder})}c.push(function(e){return!e.subsite});c.push(function(e){return!i.peekUnwrapObservable(i._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint"))});return function(e){var t=i.peekUnwrapObservable(e);return!t||c.every(function(e){return e(t)})}};e.dependencies=i.__assign({},r.default.dependencies,{itemParentHelper:n.resourceKey});return e}(r.default);t.default=a;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,a)});define("odsp-next/pages/filePicker/od/FilePicker.html",[],function(){return"<div class=od-FilePicker><div class=od-FilePicker-picker data-bind=\"component: { name: 'od-item-picker', params: itemPickerParams }, hideWhenInactive\">\x3c!--ko if: isRetrievingData--\x3e<div class=od-FilePicker-loadingDiv data-bind=\"component: { name: 'ms-progressSpinnerFlat' }\"></div>\x3c!--/ko--\x3e<div class=od-FilePicker-content data-bind=scrollContainer><div class=od-FilePicker-innerContent>\x3c!--ko host: {\r\n data: $host\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--ko control: contentControl--\x3e\x3c!--/ko--\x3e</div></div></div>\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko if: shouldHostOverlays--\x3e\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/pages/filePicker/od/FilePicker.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FilePicker{position:absolute;top:0;bottom:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;z-index:280}.od-FilePicker-content{overflow-y:hidden;position:absolute;bottom:0;left:0;right:0;top:0;overflow-y:scroll;-webkit-overflow-scrolling:touch}.od-FilePicker-innerContent{position:relative;min-height:100%;padding-bottom:32px;box-sizing:border-box}.lg .od-FilePicker-innerContent,.md .od-FilePicker-innerContent,.xlg .od-FilePicker-innerContent,.xxlg .od-FilePicker-innerContent,.xxxlg .od-FilePicker-innerContent,.xxxxlg .od-FilePicker-innerContent{padding-bottom:70px}.sm .od-FilePicker-innerContent{padding-bottom:100px}.od-FilePicker-loadingDiv{position:absolute;top:0;left:0;right:0;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(255,255,255,0))}"}])});define("odsp-next/controls/itemPicker/ItemPicker",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerViewModel","./ItemPicker.html","./ItemPicker.css","../buttonBar/ButtonBar","../notificationHost/NotificationHost","./header/ItemPickerHeader"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-item-picker",template:e("./ItemPicker.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/itemPicker/ItemPickerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding","./commandSets/ItemPickerInlineCommandSet","./commandSets/ItemPickerSecureExperienceCommandSet","./actions/ItemPickerActionMap","./resources/ItemPickerResourceKeys","../../resources/ControlResourceKeys","./header/ItemPickerHeader","../commandBar/CommandBar.key","../buttonBar/ButtonBar","../../models/command/set/UnionCommandSet","./commandSets/ItemPickerTopCommandSet","../topBar/TopBar","../overlays/dialog2/DialogOverlay","./ItemPicker.resx","./commands/ItemPickerStatusHelper","../commands/CommandState","../leftPane/LeftPane","../leftNavExpander/LeftNavExpander","../../resources/PagesResourceKeys","../../bindings/component/ControlBinding","../../bindings/dismiss/DismissBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/RecoverFocusBinding","../../bindings/focus/PreserveFocusBinding","../overlays/Overlay","../../utilities/browser/ResponsiveUI","../../models/leftNav/SourceTypeFilter","../../dataSources/rootItems/RootItemsTypeFilter.key","../../dataSources/leftNav/RootSourceTypeFilter.key"],function(e,t,i,r,w,S,C,T,A,E,M,O,R,H,F,L,N,D,B,o,K,U,V,q,j,W,z,G,Q,Y,X,$,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(x){i.__extends(e,x);function e(e,t){void 0===t&&(t={});var i=x.call(this,e)||this;i.itemPickerHeaderTagName=M.default.tagName;i.buttonBarTagName=R.default.tagName;i.topBarTagName=L.default.tagName;i.dialogOverlayTagName=N.default.tagName;i.leftNavExpanderTagName=U.default.tagName;i.overlayTagName=Q.default.tagName;i.secureExperienceWarningText=D.strings.secureExperienceWarningText;i.addBindingHandlers({host:w.default,control:q.default,dismiss:j.default,focusTrap:W.default,recoverFocus:z.default,preserveFocus:G.default});var r=e.behavior,o=void 0===r?{}:r,n=e.agent,a=e.commandSet,s=o.showActions,c=void 0!==s&&s,l=o.showBranding,d=void 0!==l&&l,u=o.showNavigation,p=void 0!==u&&u,m=o.enableFocusTrap,f=void 0!==m&&m,v=i,h=v.resources,g=v.observables;i._isNavigationEnabled=p;h.expose(A.actionMap,new(i.managed(T.default)));h.expose(A.agent,n);i._status=h.expose(A.status,g.create({state:0}));h.expose(A.behavior,o);h.expose($.resourceKey,o.typeFilter);h.expose(J.resourceKey,X.mergeSourceTypeFilters(o.sourceTypes,X.getSourceTypeFilter(o.typeFilter)));i._responsiveUI=h.consume(Y.resourceKey);i._statusHelper=h.consume(B.resourceKey);i._itemsSelection=h.consume(E.itemsSelection);g.subscribe(i._itemsSelection.selection,i._onSelectionChanged);i.itemPickerHeaderParams={};if(a||!c){var P=[];c||P.push(new(i.managed(F.default)));P.push(a);i.commandBarSpecification=q.toSpecification(O.resourceKey,{commandSet:new(i.managed(H.default))({commandSets:P})})}if(c){var y=t.commandSet,k=void 0===y?new(i.managed(S.default)):y;i.buttonBarParams={commandSet:k}}i.showContent=g.create(!1);i.showSecureExperienceDialog=g.create(!1);i.secureExperienceErrorText=g.pureCompute(i._computeSecureExperienceErrorText);i.secureExperienceErrorStyle=g.pureCompute(i._computeSecureExperienceErrorStyle);i.showBranding=d;i.showActions=c;i.showCommandBar=!!a;i.isFocusTrapEnabled=g.create(f);var _=t.secureExperienceCommandSet,b=void 0===_?new(i.managed(C.default)):_;i.secureExperienceCommandSet=b;i.hostBindingOptions={data:{status:i._status}};i.showLeftPane=g.pureCompute(i._computeShowLeftPane);i.showLeftPaneExpander=g.pureCompute(i._computeShowLeftPaneExpander);var I=i.isLeftPaneOpen=g.create(!1);i.leftPaneSpecification=q.toSpecification(K.default,{isLeftNavVisible:g.pureCompute(function(){return i.showLeftPane()||I()})});h.expose(V.base.leftNav.isLeftNavUserExpanded,I);h.expose(V.base.leftNav.toggleIsLeftNavUserExpanded,function(){I(!I.peek());return!1});n.initialize().done(function(){i.showContent(!0)},function(e){i.showSecureExperienceDialog(!0)});return i}e.prototype._onSelectionChanged=function(){this._status({state:0})};e.prototype._computeSecureExperienceErrorText=function(){var e=this._statusHelper.commandStatus();return e&&e.text||""};e.prototype._computeSecureExperienceErrorStyle=function(){var e=this._statusHelper.commandStatus();return o.default[e&&e.state||o.default.initialized]};e.prototype._computeShowLeftPane=function(){var e=this._responsiveUI;return this._isNavigationEnabled&&0<e.compareSize(e.formFactorSize(),"Large")};e.prototype._computeShowLeftPaneExpander=function(){return this._isNavigationEnabled&&!this.showLeftPane()};return e}(r.default);t.default=n});define("odsp-next/controls/itemPicker/commandSets/ItemPickerInlineCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../resources/ItemPickerResourceKeys","../commands/ItemPickerStatusCommandBuilder","../ItemPicker.resx","../../loadingSpinner/LoadingSpinner.resx"],function(u,e,t,i,p,m,f,v,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(d){t.__extends(e,d);function e(e){void 0===e&&(e={});var t=d.call(this,e)||this,i=t.resources.consume(m.behavior),r=t.resources.consume(m.actionMap),o=t.resources.consume(m.status),n="undefined"==typeof __webpack_public_path__?u.toUrl("odsp-media/images/loading/loadingspinner.gif"):u("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif"),a=i.completeText,s=void 0===a?2===i.viewType&&1===i.accessLevel?v.strings.completeReadWriteFoldersActionText:v.strings.completeReadFilesActionText:a,c=i.cancelText,l=void 0===c?v.strings.cancelActionText:c;t.commands.push(new(t.managed(f.default))({location:12}).command,new(t.managed(p.CommandViewModel))({location:12,iconUrl:n,isDisabled:t.createObservable(!0),isHidden:t.createPureComputed(function(){return 1!==o().state}),text:h.strings.LoadingText,renderLabel:0}),new(t.managed(p.CommandViewModel))({text:s,action:new(t.managed(r.ItemPickerCompleteAction)),isPermanent:!0}),new(t.managed(p.CommandViewModel))({text:l,action:new(t.managed(r.ItemPickerCancelAction)),isPermanent:!0}));return t}return e}(i.default);e.default=r});define("odsp-next/controls/itemPicker/commands/ItemPickerStatusCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../commands/Command","../../commands/CommandState","./ItemPickerStatusHelper"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=t.resources.consume(a.resourceKey);t._commandStatus=i.commandStatus;t._label=t.createPureComputed(t._computeLabel);t.command=new(t.managed(o.CommandViewModel))({isDisabled:t.createObservable(!0),text:t._label,location:e.location,isHidden:t.createPureComputed(function(){return!t._label()}),state:t.createPureComputed(t._computeState)});return t}e.prototype._computeLabel=function(){var e=this._commandStatus();return e&&e.text};e.prototype._computeState=function(){var e=this._commandStatus();return e&&e.state||n.default.initialized};return e}(r.default);t.default=s});define("odsp-next/controls/itemPicker/commands/ItemPickerStatusHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../resources/ItemPickerResourceKeys","../../../resources/ControlResourceKeys","../../commands/CommandState","@ms/odsp-utilities/lib/string/StringHelper","../ItemPicker.resx","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,i,r,n,a,s,c,l,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(o){i.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._itemPickerStatus=t.itemPickerStatus;i._behavior=t.behavior;i._itemsSelection=t.itemsSelection;i._error=i.createObservable();i._application=i.createObservable();i.commandStatus=i.createPureComputed(i._computeCommandStatus);i.commandStatus.equalityComparer=d.deepCompare;var r=t.agent;r&&i.trackPromise(r.getApplication()).done(function(e){i._application(e)},function(e){i._error(e)});return i}e.prototype._computeCommandStatus=function(){var e,t=this._itemPickerStatus(),i=this._behavior.viewType,r=this._itemsSelection.maximumSelectedCount,o=this._itemsSelection.selectedCount();1===t.state||(e=t.error?{text:c.pluralSelect(o,2===i?l.strings.shareSingleFolderErrorText:l.strings.shareSingleFileErrorText,2===i?l.strings.shareMultipleFolderErrorText:l.strings.shareMultipleFileErrorText),state:s.default.failed}:r&&r<=o?{text:c.format(2===i?l.strings.selectionMaxFoldersErrorFormat:l.strings.selectionMaxFilesErrorFormat,r),state:s.default.failed}:this._computeConsentCommandStatus());return e};e.prototype._computeConsentCommandStatus=function(){var e,t=this._application();if(t){var i=this._behavior,r=i.viewType,o=i.linkType,n=i.selectionMode,a=i.accessLevel;e={text:c.format(2===r&&1===a?l.strings.saveSingleConsentFormat:2!==o&&0===a?0===n?l.strings.shareSingleConsentFormat:l.strings.shareMultipleConsentFormat:0===n?l.strings.openSingleConsentFormat:l.strings.openMultipleConsentFormat,t.name)}}else this._error()&&(e={text:l.strings.unknownApplicationErrorText,state:s.default.failed});return e};e.dependencies=i.__assign({},r.default.dependencies,{behavior:n.behavior,agent:n.agent,itemsSelection:a.itemsSelection,itemPickerStatus:n.status});return e}(r.default);t.ItemPickerStatusHelper=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u);t.default=u});define("odsp-next/controls/itemPicker/commandSets/ItemPickerSecureExperienceCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/CommandViewModel","../resources/ItemPickerResourceKeys","../ItemPicker.resx"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this,i=t.resources.consume(n.actionMap);t.commands.push(new(t.managed(o.default))({text:a.strings.secureExperienceActionText,action:new(t.managed(i.ItemPickerSecureExperienceAction)),isPermanent:!0}),new(t.managed(o.default))({text:a.strings.cancelActionText,action:new(t.managed(i.ItemPickerCancelAction)),isPermanent:!0}));return t}return e}(r.default);t.default=s});define("odsp-next/controls/itemPicker/actions/ItemPickerActionMap",["require","exports","./ItemPickerCompleteAction","./ItemPickerCancelAction","./ItemPickerSwitchAccountAction","./secureExperience/ItemPickerSecureExperienceAction"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){this.ItemPickerCompleteAction=i.default;this.ItemPickerCancelAction=r.default;this.ItemPickerSwitchAccountAction=o.default;this.ItemPickerSecureExperienceAction=n.default};t.default=a});define("odsp-next/controls/itemPicker/actions/ItemPickerCompleteAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ItemPickerResourceKeys","../../../actions/base/ItemSelectionHelper","../../../models/itemPicker/ItemPickerSelectionHelper"],function(e,t,i,r,o,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(d){i.__extends(e,d);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=d.call(this,e,t)||this;i.name="ItemPicker.Complete";var r=i._itemPickerBehavior=i.resources.consume(u.behavior);i._itemPickerAgent=i.resources.consume(u.agent);i._itemPickerStatus=i.resources.consume(u.status);i._canSelectItem=new(i.child(m.typeResourceKey))({behavior:r}).getCanSelectItem();var o=r.viewType,n=void 0===o?0:o,a=r.selectionMode,s=void 0===a?0:a,c=t.ItemSelectionHelper,l=void 0===c?p.default:c;i._itemSelectionHelper=new(i.managed(l))({overrideItem:e.item,canFallback:1!==n,allowMultiSelect:1===s});return i}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection()[0],t=this.unwrapObservable(e),i=this._itemPickerStatus().state;return!!this._itemPickerAgent&&!!t&&this._canSelectItem(e)&&(0===i||2===i)};e.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemPickerAgent.complete(e)}).then(function(){t._itemPickerStatus({state:3});return{resultType:o.ResultTypeEnum.Success}},function(e){t._itemPickerStatus({state:2,error:e});return{resultType:o.ResultTypeEnum.ExpectedFailure}})};return e}(r.default);t.default=n});define("odsp-next/controls/itemPicker/actions/ItemPickerCancelAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../resources/ItemPickerResourceKeys"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="ItemPicker.Cancel";t._itemPickerAgent=t.resources.consume(a.agent);t._itemPickerStatus=t.resources.consume(a.status);return t}e.prototype.onIsAvailable=function(){return!!this._itemPickerAgent};e.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemPickerAgent.cancel().then(function(){t._itemPickerStatus({state:4});return{resultType:o.ResultTypeEnum.Success}},function(e){t._itemPickerStatus({state:2,error:e});return n.default.wrapError(e)})};return e}(i.default);t.default=s});define("odsp-next/controls/itemPicker/actions/ItemPickerSwitchAccountAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../resources/ItemPickerResourceKeys"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="ItemPicker.SwitchAccount";t._behavior=t.resources.consume(a.behavior);t._agent=t.resources.consume(a.agent);return t}e.prototype.onExecute=function(e){return this._agent.switchAccount().then(function(){return n.default.wrap({resultType:o.ResultTypeEnum.Success})})};e.prototype.onIsAvailable=function(){var e=this._behavior.showSwitchAccount;return void 0!==e&&e};return e}(i.default);t.default=s});define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../actions/base/ControlExecutorAction","./ItemPickerSecureExperienceExecutor"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.state=t.createObservable({isAvailable:!0});return t}return e}(i.default);t.ItemPickerSecureExperienceHandler=a;var s=o.create({name:"ItemPickerSecureExperience",source:{component:n.default}});t.default=s});define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerSecureExperienceExecutorViewModel","./ItemPickerSecureExperienceExecutor.html"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-item-picker-secure-experience-executor",template:e("./ItemPickerSecureExperienceExecutor.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutorViewModel",["require","exports","tslib","../../../../actions/base/ControlExecutorViewModel","../../../filePickerRemoteHost/FilePickerRemoteHost","../../resources/ItemPickerResourceKeys","@ms/odsp-utilities/lib/async/Promise"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.filePickerRemoteHostTagName=o.default.tagName;t._agent=t.resources.consume(n.agent);t._behavior=t.resources.consume(n.behavior);t._status=t.resources.consume(n.status);t.showFilePicker=t.createObservable(!0);t.filePickerRemoteHostParams={agent:{initialize:function(){return t._agent.initialize()},complete:function(e){return t._complete(e)},cancel:function(){return t._cancel()},switchAccount:function(){return t._switchAccount()},getApplication:function(){return t._agent.getApplication()}},behavior:t._behavior};return t}e.prototype._complete=function(e){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.complete(e).then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};e.prototype._cancel=function(){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.cancel().then(function(){t._status({state:4});t.action.cancel()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};e.prototype._switchAccount=function(){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.switchAccount().then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};return e}(i.default);t.default=s});define("odsp-next/actions/base/ControlExecutorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.action;t.action=i;return t}e.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})};e.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){t.action.fail(e);return o.default.wrapError(e)})};return e}(r.default);t.default=n});define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePickerRemoteHostViewModel","./FilePickerRemoteHost.html"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-file-picker-remote-host",template:e("./FilePickerRemoteHost.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/window/ChildWindowBinding","../../dataSources/itemPicker/Sdk71","@ms/odsp-utilities/lib/async/Promise","../../providers/itemPicker/ItemPickerProvider","@ms/odsp-utilities/lib/guid/Guid","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/uri/SimpleUri","../../models/item/ItemType","../../dataSources/url/PageType","../../dataSources/itemPicker/Sdk71PickerUrlHelper","../../dataSources/itemPicker/Sdk72PickerUrlHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/math/Rectangle"],function(e,t,x,i,w,a,s,S,C,T,A,E,M,O,R,H,F,L,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(I){x.__extends(e,I);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=I.call(this,e,t)||this;i.addBindingHandlers({childWindow:w.default});i._itemPickerProvider=i.resources.consume(S.resourceKey);var r=i.resources.consume(T.url);i._messenger=i.createObservable();i._pickerId=C.default.generate();var o=e.itemKey,n=e.agent,a=t.window,s=void 0===a?window:a;i._agent=n;var c={};A.default(c,e.behavior||{});A.default(c,{id:i._pickerId,showBranding:!0,showActions:!0,returnUrl:E.remove(),origin:new M.default(s.location.href).authority,state:E.remove()});var l,d,u=r.getDefaultClickUrl({key:o||r.getRootItemKey(),type:O.default.Folder},{page:R.default.FilePicker,viewParams:{}}),p=r.qualifyUrl("#"+L.serializeQuery(x.__assign({},L.deserializeQuery(u.substring(1)),"7.2"===c.sdkVersion?F.saveItemPickerBehavior(c):H.saveItemPickerBehavior(c)))),m=s.screen,f=void 0===m?{availLeft:0,availTop:0,left:0,top:0,width:window.innerWidth,height:window.innerHeight}:m;l=void 0===(h=f.availLeft)?l=void 0===(v=f.left)?0:v:h,d=void 0===(P=f.availTop)?d=void 0===(g=f.top)?0:g:P;var v,h,g,P,y=Math.min(800,f.width-20),k=Math.min(600,f.height-20),_=(f.width-y)/2+l,b=(f.height-k)/2+d;i.childWindowOptions={url:p,position:new N.default(_,b,y,k),messenger:i._messenger,onMessage:function(e){return i._onMessage(e)},onCancel:function(){return i._agent.cancel().done()}};return i}e.prototype._onMessage=function(e){var t=this._messenger.peek();if(0===e.indexOf(a.MESSAGE_FROM_PICKER_PREFIX)){var i=JSON.parse(e.substring(a.MESSAGE_FROM_PICKER_PREFIX.length)),r=i.conversationId,o=i.pickerId;if(o!==this._pickerId)return;var n=void 0;switch(i.type){case"success":n=this._onSuccess(i);break;case"cancel":n=this._onCancel(i);break;case"switch":n=this._onSwitch(i);break;case"initialize":n=s.default.wrap({pickerId:o,conversationId:r,type:"activate"})}s.default.as(n).done(function(e){e&&t.postMessage(""+a.MESSAGE_TO_PICKER_PREFIX+JSON.stringify(e))})}};e.prototype._onSuccess=function(e){var t=this,i=e.items.map(function(e){return t._itemPickerProvider.getItemFromPickerItem(e)});return o(this._agent.complete(i),e)};e.prototype._onCancel=function(e){return o(this._agent.cancel(),e)};e.prototype._onSwitch=function(e){return o(this._agent.switchAccount(),e)};return e}(i.default);t.default=r;function o(e,t){return e.then(function(){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"acknowledge"}},function(e){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"error",error:{message:e.message}}})}});define("odsp-next/bindings/window/ChildWindowBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,i,r,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(m){i.__extends(e,m);function e(e,t){void 0===t&&(t={});var i=m.call(this,e,t)||this,r=i.valueAccessor(),o=r.url,n=r.position,a=r.messenger,s=r.onMessage,c=r.onCancel;i._onMessage=s;i._onCancel=c;var l=t.window,d=void 0===l?window:l;i._window=d;var u=new f.default(o);i._targetOrigin=u.authority;s&&i.events.on(i._window,"message",i._onMessageReceived);var p=["scrollbars=yes"];n&&p.push("left="+n.x,"top="+n.y,"width="+n.width,"height="+n.height);i._childWindow=i._window.open(o,"_blank",p.join(", "));i.async.setInterval(i._checkWindow,100);i.addDisposable({dispose:function(){i._childWindow&&!i._childWindow.closed&&i._childWindow.close()}});a&&a(i._createMessenger());return i}e.prototype._checkWindow=function(){this._childWindow&&!this._childWindow.closed||this._onCancel&&this._onCancel()};e.prototype._onMessageReceived=function(e){if(e.source===this._childWindow&&e.origin===this._targetOrigin){var t=""+(e.data||"");this._onMessage&&this._onMessage(t)}};e.prototype._createMessenger=function(){var t=this;return{postMessage:function(e){t._childWindow.postMessage(e,t._targetOrigin)}}};e.supportsVirtualElements=!0;return e}(r.default);t.default=o});define("odsp-next/dataSources/itemPicker/Sdk71",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MESSAGE_FROM_PICKER_PREFIX="[OneDrive-FromPicker]";t.MESSAGE_TO_PICKER_PREFIX="[OneDrive-ToPicker]";t.PICKER_PARAM_KEY="picker"});define("odsp-next/dataSources/itemPicker/Sdk71PickerUrlHelper",["require","exports","tslib","./Sdk70PickerUrlHelper","./ItemTypeFilterHelper","./Sdk71","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,i,y,k,r,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="state",o="access_token";t.isApplicable=function(e){return!0};t.getItemPickerBehavior=function(e){return i.__assign({},a(s(e)),c(e))};function a(e){void 0===e&&(e={});var t=e.id,i=e.aid,r=e.a,o=e.v,n=e.s,a=e.l,s=e.f,c=e.o,l=e.sa,d=void 0===l||l,u=e.ss,p=void 0===u||u,m=e.tf,f=void 0!==m&&m,v=e.sn,h=void 0===v||v,g=!function(){try{return!!parent.document}catch(e){return!1}}()||h,P=y.getViewType(o);return{id:t,showActions:d,showBranding:g,showSwitchAccount:p,enableFocusTrap:f,aadClientId:i,accessLevel:y.getAccessLevel(r),viewType:P,selectionMode:y.getSelectionMode(n),linkType:y.getLinkType(a),origin:c,typeFilter:k.getItemTypeFilter({typeFilter:y.getTypeFilter(s),viewType:P}),sdkVersion:"7.1"}}t.getItemPickerBehaviorFromOptions=a;function s(e){var t,i=e[r.PICKER_PARAM_KEY]||"";try{t=JSON.parse(i)}catch(e){t={}}return t}t.getItemPickerOptions=s;function c(e){return{state:e[n],accessToken:e[o]}}t.getStateAndAccessToken=c;t.saveItemPickerBehavior=function(e){var t=d(e);return i.__assign({},u(e),l(t))};function l(e){return(t={})[r.PICKER_PARAM_KEY]=JSON.stringify(e),t;var t}t.saveItemPickerOptions=l;function d(e){var t=e.showActions,i=e.showBranding,r=e.showSwitchAccount,o=e.aadClientId,n=e.accessLevel,a=e.viewType,s=e.selectionMode,c=e.linkType,l=e.typeFilter,d=e.origin,u=e.id,p={};m.default(p,{sa:f.optional(t),sn:f.optional(i),ss:f.optional(r),aid:f.optional(o),id:f.optional(u),o:f.optional(d),a:f.optional(y.saveAccessLevel(n)),s:f.optional(y.saveSelectionMode(s)),v:f.optional(y.saveViewType(a)),f:f.optional(y.saveTypeFilter(l)),l:f.optional(y.saveLinkType(c))});return p}t.saveItemPickerBehaviorToOptions=d;function u(e){var t=e.msaClientId,i=e.state,r=e.accessToken,o={};i&&(o[n]=i);t&&(o.client_id=t);r&&(o.access_token=r);return o}t.saveStateAndAccessToken=u});define("odsp-next/dataSources/itemPicker/Sdk70PickerUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/WindowStateManager","../../models/item/IItemTypeFilter","./ItemTypeFilterHelper","../../utilities/uri/UriValidator"],function(e,m,f,c,v,h){"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.WINDOW_STATE_PICKER_KEY="picker";m.WINDOW_STATE_OPTIONS_KEY="options";m.isApplicable=function(e){return!!(new f.default).getState(m.WINDOW_STATE_PICKER_KEY)};m.getItemPickerBehavior=function(e){var t=new f.default,i=t.getState(m.WINDOW_STATE_PICKER_KEY)||{},r=t.getState(m.WINDOW_STATE_OPTIONS_KEY)||{},o=i.accessLevel,n=i.viewType,a=i.linkType,s=i.selectionMode,c=i.filter,l=r.clientId,d=r.advanced.redirectUri,u=!!l&&!!d,p=k(n);return{showActions:!0,showBranding:!0,accessLevel:g(o),viewType:p,linkType:y(a),selectionMode:P(s),typeFilter:v.getItemTypeFilter({typeFilter:_(c),viewType:p}),aadClientId:l,returnUrl:h.getSafeAbsoluteWebUrl(d),showSwitchAccount:u}};function g(e){void 0===e&&(e="");var t;switch(e){case"readwrite":t=1;break;default:case"read":t=0}return t}m.getAccessLevel=g;m.saveAccessLevel=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readwrite";break;default:case 0:}return t};function P(e){void 0===e&&(e="");var t;switch(e){case"multiple":t=1;break;default:case"single":t=0}return t}m.getSelectionMode=P;m.saveSelectionMode=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:}return t};function y(e){void 0===e&&(e="");var t;switch(e){case"download":t=2;break;case"webView":t=0;break;case"share":t=3;break;case"all":t=4;break;default:case"web":t=1}return t}m.getLinkType=y;m.saveLinkType=function(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;default:case 1:}return t};function k(e){void 0===e&&(e="");var t;switch(e){case"files":t=1;break;case"folders":t=2;break;default:t=0}return t}m.getViewType=k;m.saveViewType=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:}return t};function _(e){void 0===e&&(e="");var t;if(e){for(var i=[],r=0,o="string"==typeof e?e.split(","):e;r<o.length;r++){var n=o[r];if("."===n.charAt(0)){var a=n.toLowerCase();i.indexOf(a)<0&&i.push(a)}else{var s=void 0;switch(n){case"folder":s=c.ItemTypeFilter.folder;break;case"photo":s=c.ItemTypeFilter.media}s&&i.push(s)}}i.length&&i.push(c.ItemTypeFilter.folder);t={filters:i}}return t}m.getTypeFilter=_;m.saveTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t,i=[],r=0,o=e.filters;r<o.length;r++){var n=o[r];if("string"==typeof n)i.push(n);else{var a=void 0;switch(n){case c.ItemTypeFilter.folder:a="folder";break;case c.ItemTypeFilter.photo:a="photo"}a&&i.push(a)}}1<i.length?t=i:i.length&&(t=i[0]);return t}});define("@ms/odsp-shared/lib/utilities/navigation/WindowStateManager",["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.VALUE_KEY="value";var t=function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var i=this._getNormalizedWindowName();i[e]=t;window.name=JSON.stringify(i)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),i=t[e];delete t[e];window.name=JSON.stringify(t);return i};e.prototype._getNormalizedWindowName=function(){var t,e;try{t=JSON.parse(name)||{}}catch(e){t={}}"object"!=typeof t&&(t=((e={})[i.VALUE_KEY]=t,e));return t};return e}();i.default=t});define("odsp-next/dataSources/itemPicker/ItemTypeFilterHelper",["require","exports","../../models/item/IItemTypeFilter","../../utilities/array/ArrayHelper"],function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemTypeFilter=function(e){var t=e.viewType,i=void 0===t?0:t,r=e.typeFilter,o=(void 0===r?{filters:[]}:r).filters;2===i&&(o=o.concat([n.ItemTypeFilter.folder]));return{filters:a.removeDuplicates(o)}}});define("odsp-next/utilities/uri/UriValidator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["HTTP:","HTTPS:"];t.getSafeAbsoluteWebUrl=function(e){void 0===e&&(e="");var t=e.toUpperCase();return i.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0};t.isGallatin=function(){return location.origin.indexOf(".cn")===location.origin.length-3}});define("odsp-next/dataSources/itemPicker/Sdk72PickerUrlHelper",["require","exports","tslib","./Sdk71PickerUrlHelper","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,r,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={ONEDRIVE:"oneDrive",SITES:"sites",RECENT:"recent",SHARED:"shared",PHOTOS:"photos",BUSINESS:"business",CONSUMER:"consumer"};t.isApplicable=function(e){var t=o.getItemPickerOptions(e);return!!t&&"7.2"===t.sdk};t.getItemPickerBehavior=function(e){return r.__assign({},a(o.getItemPickerOptions(e)),o.getStateAndAccessToken(e))};t.saveItemPickerBehavior=function(e){var t=s(e);return r.__assign({},o.saveStateAndAccessToken(e),o.saveItemPickerOptions(t))};function a(e){var t=e.ln,i=void 0===t||t;return r.__assign({},o.getItemPickerBehaviorFromOptions(e),function(e){var t="string"==typeof e?e.split(","):e;if(t){for(var i={},r=0,o=t;r<o.length;r++){var n=o[r],a=(""+n).trim().toUpperCase(),s=c[a];s&&(i[s]=!0)}return{sourceTypes:i}}}(e.st)||{},{showNavigation:i,showBranding:!1,sdkVersion:"7.2"})}t.getItemPickerBehaviorFromOptions=a;function s(e){var t=r.__assign({},o.saveItemPickerBehaviorToOptions(e),{sdk:"7.2"});i.default(t,{ln:n.optional(e.showNavigation),st:n.optional(function(e){if(e){var t=[];for(var i in e)e[i]&&t.push(i);return 1===t.length?t[0]:t}}(e.sourceTypes)),sn:!1});return t}t.saveItemPickerBehaviorToOptions=s});define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHost.html",[],function(){return"\x3c!--ko childWindow: childWindowOptions--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutor.html",[],function(){return"\x3c!--ko if: showFilePicker--\x3e\x3c!--ko component: {\r\n name: filePickerRemoteHostTagName,\r\n params: filePickerRemoteHostParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/itemPicker/header/ItemPickerHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerHeaderViewModel","../../contextualMenu/ContextualMenu","./ItemPickerHeader.html","./ItemPickerHeader.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-item-picker-header",template:e("./ItemPickerHeader.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/itemPicker/header/ItemPickerHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/dismiss/DismissBinding","../../../bindings/imageLoader/ImageLoaderBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","@ms/odsp-utilities/lib/locale/Locale","../resources/ItemPickerResourceKeys","../../../resources/DataSourceResourceKeys","../ItemPicker.resx"],function(n,e,t,i,a,s,c,l,d,u,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(o){t.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.applicationText=m.strings.applicationName;t.addBindingHandlers({dismiss:a.default,imageLoader:s.default});t._identityDataSource=t.resources.consume(p.identity);var i=t.resources.consume(u.actionMap),r=t._identityDataSource.getIdentity();t.accountCommand=new(t.managed(c.default))({text:r.email?r.email:r.loginName,engagementName:"SwitchAccountMenu",requiredChildren:1,collapseSingleChildCommands:!1,isPermanent:!0});t.accountCommand.children.push(new(t.managed(c.default))({text:m.strings.switchAccountActionText,action:new(t.managed(i.ItemPickerSwitchAccountAction))}));t.accountMenuParams={items:t.accountCommand.children,isOpen:t.accountCommand.isOpen,alignment:t.createObservable(d.default.isRightToLeft?l.default.Left:l.default.Right),left:t.createObservable(d.default.isRightToLeft?"0":"100%"),hasExplicitAlignment:!0};t.applicationLogoUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/filepicker/onedrivelogolight.png"):n("@ms/odsp-media/dist/media/images/filePicker/oneDriveLogoLight.png");t.isLogoLoaded=t.createObservable(!1);return t}return e}(i.default);e.default=r});define("odsp-next/controls/itemPicker/header/ItemPickerHeader.html",[],function(){return'<div class=od-ItemPickerHeader><div class=od-ItemPickerHeader-application data-bind="css: { \'od-ItemPickerHeader-application--hasLogo\': isLogoLoaded }"><span class=od-ItemPickerHeader-applicationLogo><img data-bind="imageLoader: { src: applicationLogoUrl, isLoaded: isLogoLoaded }"></span> <span class=od-ItemPickerHeader-applicationTitle data-bind="text: applicationText"></span></div><div class=od-ItemPickerHeader-account data-bind="dismiss: { isOpen: accountCommand.isOpen }"><span class=od-ItemPickerHeader-accountDropdown data-bind="css: { \'od-ItemPickerHeader-accountDropdown--isOpen\': accountCommand.isOpen, \'od-ItemPickerHeader-accountDropdown--isEnabled\': !accountCommand.isDisabled() }, click: accountCommand.onClick.bind(accountCommand)"><span class=od-ItemPickerHeader-accountDropdownLabel data-bind="text: accountCommand.label"></span>\x3c!--ko ifnot: accountCommand.isDisabled--\x3e<i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e</span>\x3c!--ko if: accountCommand.isOpen--\x3e<div class=od-ItemPickerHeader-accountMenu data-bind="component: { name: \'ms-contextual-menu\', params: accountMenuParams }"></div>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/itemPicker/header/ItemPickerHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemPickerHeader{height:50px;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPickerHeader-application{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-application{left:16px}[dir=rtl] .od-ItemPickerHeader-application{right:16px}.od-ItemPickerHeader-applicationTitle{font-size:21px;font-weight:300}.od-ItemPickerHeader-applicationLogo{display:none}.od-ItemPickerHeader-account{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-account{right:16px}[dir=rtl] .od-ItemPickerHeader-account{left:16px}.od-ItemPickerHeader-accountDropdown{padding:0 4px;height:100%;display:inline-block;font-size:12px;font-weight:300}.od-ItemPickerHeader-accountDropdown .ms-Icon{font-size:14px;vertical-align:middle}[dir=ltr] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-left:4px}[dir=rtl] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-right:4px}.od-ItemPickerHeader-accountDropdown--isEnabled{cursor:pointer}.od-ItemPickerHeader-accountDropdown--isEnabled:hover{background-color:rgba(255,255,255,.28)}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationLogo{display:inline-block;padding-top:5px}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationTitle{display:inline-block;width:0;height:0;overflow:hidden}"}])});define("odsp-next/controls/itemPicker/commandSets/ItemPickerTopCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../ItemPicker.resx","../resources/ItemPickerResourceKeys","../../../utilities/icons/Icon"],function(e,t,i,r,l,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(c){i.__extends(e,c);function e(e){void 0===e&&(e={});var t=c.call(this,e)||this,i=t.resources.consume(u.behavior),r=i.completeText,o=void 0===r?2===i.viewType&&1===i.accessLevel?d.strings.completeReadWriteFoldersActionText:d.strings.completeReadFilesActionText:r,n=i.cancelText,a=void 0===n?d.strings.cancelActionText:n,s=t.resources.consume(u.actionMap);t.commands.push(new(t.managed(l.CommandViewModel))({text:o,action:new(t.managed(s.ItemPickerCompleteAction)),icon:new p.default("CheckMark"),renderLabel:2}),new(t.managed(l.CommandViewModel))({text:a,action:new(t.managed(s.ItemPickerCancelAction)),icon:new p.default("Cancel"),location:12,renderLabel:0}));return t}return e}(r.default);t.default=o});define("odsp-next/controls/overlays/dialog2/DialogOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DialogOverlayViewModel","./DialogOverlay.html","../dialog/DialogOverlay.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-dialog-overlay-2",template:e("./DialogOverlay.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/overlays/dialog2/DialogOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../Overlay","../../../bindings/dismiss/DismissBinding","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/element/ElementBinding","../../../utilities/browser/ResponsiveUI","../../panelHost/PanelHost.resx","../../buttonBar/ButtonBar"],function(e,t,i,r,u,p,m,f,v,h,g,P,y,o,k,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(d){i.__extends(e,d);function e(e){void 0===e&&(e={});var t=d.call(this,e)||this;t.overlayTagName=u.default.tagName;t.buttonBarTagName=_.default.tagName;t.closeLabel=k.strings.closePanelLabel;t.addBindingHandlers({dismiss:p.default,element:y.default,host:m.default,interactionScope:f.default,focusTrap:P.default,recoverFocus:g.default,preserveFocus:h.default,scrollContainer:v.default});var i=e.size,r=void 0===i?"Small":i,o=e.title,n=void 0===o?"":o,a=e.onClose,s=e.showCloseButton,c=void 0===s||s,l=e.commandSet;t._size=r;t._onClose=a;t.contentElement=t.createObservable();t.title=t.wrapObservable(n);t.showCloseButton=t.createObservable(!!t._onClose&&c);t.showTitle=t.createPureComputed(t._computeShowTitle);t.widthClass=t.createPureComputed(t._computeWidthClass);t.showActions=t.createObservable(!!l);t.buttonBarParams={commandSet:l};return t}e.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype._computeWidthClass=function(){return o.default.determineCssClass(this._size)};e.prototype._computeShowTitle=function(){return!!this.title()};return e}(r.default);t.default=n});define("odsp-next/controls/overlays/dialog2/DialogOverlay.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n beforeRemove: 500\r\n },\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-Dialog data-bind="css: { \'od-Dialog--close\': showCloseButton }, focusTrap: {}"><div class="ms-ModalOverlay od-DialogOverlay"></div><div class="od-Dialog-main od-Dialog-main--dialog od-Dialog-main--visible" role=dialog tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: $host.isOpen }, scrollContainer, dismiss: { close: $component.onDismiss.bind($component) }, class: \'od-Dialog-main--\' + $component.widthClass(), attr: { \'aria-label\': title }, element: $component.contentElement">\x3c!--ko if: showTitle--\x3e<div class="od-Dialog-header od-Dialog-header--s"><div class=od-Dialog-title data-bind="text: title"></div></div>\x3c!--/ko--\x3e<div class=od-Dialog-inner><div class=od-Dialog-content data-bind="host: {}"></div>\x3c!--ko if: showActions--\x3e<div class=od-Dialog-actions><div class=od-Dialog-actionsRight data-bind="component: { name: buttonBarTagName, params: buttonBarParams }"></div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: showCloseButton--\x3e<button class="od-Dialog-button od-Dialog-button--close" data-bind="attr: { \'aria-label\': $component.closeLabel, title: $component.closeLabel }, click: $component.onClose.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("odsp-next/models/leftNav/SourceTypeFilter",["require","exports","../item/IItemTypeFilter","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSourceTypeFilter=function(e){void 0===e&&(e={filters:[]});var t=e.filters;if(t.length){for(var i={},r=0,o=t;r<o.length;r++){var n=o[r];if("string"==typeof n){var a=c.getIconNameFromExtension(n);if(l.OfficeIconFileTypeMap[a]){i.recent=!0;i.shared=!0}else switch(a){case"photo":case"video":i.photos=!0;i.shared=!0}}else switch(n){case s.ItemTypeFilter.media:case s.ItemTypeFilter.photo:case s.ItemTypeFilter.video:i.photos=!0;i.shared=!0;break;case s.ItemTypeFilter.audio:i.shared=!0;break;default:case s.ItemTypeFilter.folder:i.oneDrive=!0;i.sites=!0;i.shared=!0;i.business=!0;i.consumer=!0}}return i}};t.mergeSourceTypeFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){if(!t)return e;if(!e)return t;var i={};for(var r in t)e[r]&&t[r]&&(i[r]=!0);return i},void 0)}});define("odsp-next/dataSources/leftNav/RootSourceTypeFilter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey(e("module").id)});define("odsp-next/controls/itemPicker/ItemPicker.html",[],function(){return'<div class=od-ItemPicker data-bind="css: { \'od-ItemPicker--hasBranding\': showBranding, \'od-ItemPicker--hasActions\': showActions, \'od-ItemPicker--hasCommandBar\': showCommandBar, \'od-ItemPicker--hasLeftPane\': showLeftPane, \'od-ItemPicker--leftPaneIsOpen\': showLeftPane() && isLeftPaneOpen() }, focusTrap: { isEnabled: isFocusTrapEnabled }">\x3c!--ko if: showSecureExperienceDialog--\x3e\x3c!--ko component: {\r\n name: dialogOverlayTagName,\r\n params: {\r\n commandSet: secureExperienceCommandSet\r\n }\r\n }--\x3e<p data-bind="text: secureExperienceWarningText"></p>\x3c!--ko if: secureExperienceErrorText--\x3e<p data-bind="text: secureExperienceErrorText, class: \'od-ItemPicker-secureExperienceStatus--\' + secureExperienceErrorStyle()"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showBranding--\x3e<div class=od-ItemPicker-branding data-bind="component: { name: itemPickerHeaderTagName, params: itemPickerHeaderParams }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showContent--\x3e\x3c!--ko if: showCommandBar--\x3e<div class=od-ItemPicker-topBar data-bind="component: { name: topBarTagName, params: {} }">\x3c!--ko if: showLeftPaneExpander--\x3e<div class="od-ItemPicker-leftNavExpander od-TopBar-item od-TopBar-leftNavExpander" data-bind="component: { name: leftNavExpanderTagName }"></div>\x3c!--/ko--\x3e<div class="od-ItemPicker-commandBar od-TopBar-item od-TopBar-commandBar" data-bind="control: commandBarSpecification"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: showLeftPane()--\x3e<div class=od-ItemPicker-leftPane data-bind="control: leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if: !showLeftPane() && isLeftPaneOpen()--\x3e\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n alignToParent: true,\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n }\r\n }\r\n }--\x3e<div class="od-ItemPicker-leftPaneModal ms-ModalOverlay"></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-ItemPicker-leftPaneOverlay tabindex=-1 data-bind="dismiss: { isOpen: isLeftPaneOpen }, recoverFocus: { isEnabled: $host.isOpen }, preserveFocus: {}, control: leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-ItemPicker-selector data-bind="host: hostBindingOptions"></div>\x3c!--ko if: showActions--\x3e<div class=od-ItemPicker-actions data-bind="component: { name: buttonBarTagName, params: buttonBarParams }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/itemPicker/ItemPicker.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemPicker{position:absolute;top:0;left:0;bottom:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPicker-branding{position:absolute;top:0;left:0;right:0;height:50px;z-index:3}.od-ItemPicker-topBar{position:absolute;top:0;left:0;right:0;height:40px}.md .od-ItemPicker-topBar,.sm .od-ItemPicker-topBar{height:44px}.od-ItemPicker-leftPane{position:absolute;top:0;bottom:0;width:208px;box-sizing:border-box}[dir=ltr] .od-ItemPicker-leftPane{left:0}[dir=rtl] .od-ItemPicker-leftPane{right:0}html[dir=ltr] .od-ItemPicker-leftPane{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .od-ItemPicker-leftPane{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.md .od-ItemPicker-commandBar,.sm .od-ItemPicker-commandBar{padding-left:4px;padding-right:4px}.lg .od-ItemPicker-commandBar,.xlg .od-ItemPicker-commandBar,.xxlg .od-ItemPicker-commandBar,.xxxlg .od-ItemPicker-commandBar,.xxxxlg .od-ItemPicker-commandBar{padding-left:16px;padding-right:16px}.od-ItemPicker-selector{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.od-ItemPicker--hasBranding .od-ItemPicker-topBar{top:50px}.od-ItemPicker--hasBranding .od-ItemPicker-selector{top:50px}[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{left:208px}[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{right:208px}.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:40px}.md .od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:44px}.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:40px}.md .od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane,.sm .od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:44px}.od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:90px}.md .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:94px}.od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:90px}.md .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane,.sm .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:94px}.od-ItemPicker--hasActions .od-ItemPicker-selector{bottom:50px}.od-ItemPicker-actions{position:absolute;left:0;right:0;bottom:0;height:50px;box-sizing:border-box;padding:10px 20px;z-index:1}html[dir=ltr] .od-ItemPicker-actions{text-align:right}html[dir=rtl] .od-ItemPicker-actions{text-align:left}.od-ItemPicker-actions .od-Button--primary:enabled,.od-ItemPicker-actions .od-Button:active{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPicker-actions .od-ButtonBarCommand--text{font-size:12px}.od-ItemPicker .DetailsRow,.od-ItemPicker .ItemTile{opacity:.3}.od-ItemPicker .DetailsRow.can-select,.od-ItemPicker .DetailsRow.od-DetailsRow--isInvokable,.od-ItemPicker .DetailsRow.od-ItemTile--isInvokable,.od-ItemPicker .ItemTile.can-select,.od-ItemPicker .ItemTile.od-DetailsRow--isInvokable,.od-ItemPicker .ItemTile.od-ItemTile--isInvokable{opacity:1}.od-ItemPicker-secureExperienceStatus{font-style:italic}.od-ItemPicker-secureExperienceStatus--failed{color:#a80000}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{position:absolute;top:40px;bottom:0;width:272px;box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;opacity:0}[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{left:0}[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{right:0}html[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay:focus{outline:1px solid transparent}.md .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay,.sm .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{top:44px}.od-OverlayHost-overlay .od-ItemPicker-leftPaneModal{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{opacity:1;animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation:none}}"}])});define("odsp-next/pages/filePicker/od/FilePickerAgentHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ControlResourceKeys","../../../providers/itemPicker/ItemPickerProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,a,c,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(s){i.__extends(e,s);function e(e,t){void 0===e&&(e={});var i=s.call(this,e,t)||this;i._applicationDataSource=t.applicationDataSource;var r=t.itemPickerProvider,o=t.viewParams.peek(),n=r.getHandler({viewParams:o}).handlerTypeKey,a=new(i.child(n))({viewParams:o,getApplication:function(){return i._getApplication()}});i._behavior=a.getBehavior();i._agent={initialize:function(){return a.initialize()},getApplication:function(){return i._getApplication()},complete:function(e){return a.complete(e)},cancel:function(){return a.cancel()},switchAccount:function(){return a.switchAccount()}};return i}e.prototype.getAgent=function(){return this._agent};e.prototype.getBehavior=function(){return this._behavior};e.prototype._getApplication=function(){var e,t=this._behavior.msaClientId;e=this._applicationDataSource&&t?this._applicationDataSource.getApplicationDetails({clientId:t}):c.default.wrap();this._getApplication=function(){return e};return e};e.dependencies=i.__assign({},r.default.dependencies,{applicationDataSource:a.application.optional,viewParams:o.viewParams,itemPickerProvider:n.resourceKey});return e}(r.default);t.default=l;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,l)});define("odsp-next/dataSources/itemPicker/odc/ItemPickerDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk50Handler","./Sdk60Handler","./Sdk70Handler","./Sdk71Handler","../Sdk72Handler","../../../models/item/OneDriveItem","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../controls/leftPane/LeftPane.resx","./Sdk50PickerUrlHelper","./Sdk60PickerUrlHelper","./Sdk70PickerUrlHelper","../Sdk72PickerUrlHelper","../../../models/item/IItemTypeFilter","../../../models/store/ItemsStore","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,n,a,s,c,l,d,u,p,m,f,v,h,g,P,y,k,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemsStore;return i}e.prototype.getHandler=function(e){var t=e.viewParams;return{handlerTypeKey:f.isApplicable(t)?n.typeResourceKey:h.isApplicable(t)?s.typeResourceKey:v.isApplicable(t)?a.typeResourceKey:g.isApplicable(t)?l.typeResourceKey:c.typeResourceKey}};e.prototype.getPivots=function(e){var t=e.behavior,i=this._createFilesRootItem(t),r=this._createPhotosRootItem(t),o=[];i&&o.push({item:i,isActive:this._isCurrentViewFiles});r&&o.push({item:r,isActive:this._isCurrentViewPhotos});return{pivots:o}};e.prototype.getItemFromPickerItem=function(e){var t;return{key:this._urlDataSource.getKey(((t={}).id=e.id,t)),id:e.root?"root":e.id}};e.prototype.getPickerItemFromItem=function(e){return{id:e.itemId,root:k.optional("root"===e.id?{}:void 0)}};e.prototype._isCurrentViewFiles=function(e){return!e.qt};e.prototype._isCurrentViewPhotos=function(e){return"allmyphotos"===e.qt};e.prototype._createFilesRootItem=function(e){var t=e.typeFilter,i=void 0===t?{filters:[]}:t,r=new d.default(this._urlDataSource.getKey(this._urlDataSource.saveItemTypeFilter(i)));r.name=m.strings.Files;r.displayName=m.strings.Files;r.properties.commandsSupported={defc:"1"};r.type=u.default.Folder;var o=this._itemsStore.getItem(r.key);o&&!o.peek().isPlaceholder||this._itemsStore.setItem(r);return r};e.prototype._createPhotosRootItem=function(e){for(var t,i,r=e.typeFilter,o=void 0===r?{filters:[]}:r,n=0===o.filters.length,a=0,s=o.filters;a<s.length;a++){var c=s[a];if(n)break;if("string"==typeof c);else switch(c){case P.ItemTypeFilter.media:case P.ItemTypeFilter.file:case P.ItemTypeFilter.photo:case P.ItemTypeFilter.video:n=!0}}if(n){(t=new d.default(this._urlDataSource.getKey(((i={}).qt="allmyphotos",i)))).name=m.strings.Photos;t.displayName=m.strings.Photos;t.properties.commandsSupported={defc:"1"};t.type=u.default.Folder;var l=this._itemsStore.getItem(t.key);l&&!l.peek().isPlaceholder||this._itemsStore.setItem(t)}return t};e.dependencies=i.__assign({},o.default.dependencies,{urlDataSource:p.url,itemsStore:y.resourceKey});return e}(o.default);t.default=_;t.resourceKey=r.createResolvedResourceKey(e("module").id,_)});define("odsp-next/dataSources/itemPicker/odc/Sdk50Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../url/odc/UrlDataSource","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/uri/Uri","../../base/odc/Config","./Sdk50PickerUrlHelper","../../base/odc/DataRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../SecureExperienceHelper","../OriginValidator","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o,s,c,l,u,p,m,f,v,h,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="livesdk",P="js.live.net",y="js.live-int.net",k=function(d){i.__extends(e,d);function e(e,t){var i=d.call(this,e)||this,r=e.viewParams;i._liveSdkScriptSource=r.livesdk;i._urlType=r.auth===u.Files.skyDrivePickerOAuth?2:1;var o=t.getSkyDrivePicker,n=void 0===o?_:o,a=t.DataRequest,s=void 0===a?m.default:a;i._getSkyDrivePicker=n;var c=i._behavior=p.getBehavior(r);i._validateSignal=i._getValidateSignal();var l=i.scope;i._dataRequest=new(l.attached(s));i._secureExperienceHelper=new(l.attached(t.secureExperienceHelperType))({behavior:c});return i}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var t=this;return this._loadSkyDrivePicker().then(function(){t.async.setTimeout(function(){t._validateSignal.complete({authenticationLevel:0})},300);return t._validateSignal.getPromise()}).then(function(e){return t._secureExperienceHelper.validateExperience(e)})};e.prototype.complete=function(e){var t=this,i=n.default.all(e.map(function(e){return t._getSkyApiItem(e)}));return this._loadSkyDrivePicker().then(function(t){return i.then(function(e){t.onSuccess(e)})})};e.prototype.cancel=function(){return this._loadSkyDrivePicker().then(function(e){e.onFailure(void 0)})};e.prototype.switchAccount=function(){return n.default.wrap()};e.prototype._loadSkyDrivePicker=function(){var e=this.trackPromise(this._getSkyDrivePicker(this._liveSdkScriptSource).then(function(t){return new n.default(function(i,e){t.init({subscribe:function(e,t){i({onSuccess:e,onFailure:t})}})})}));this._loadSkyDrivePicker=function(){return e};return e};e.prototype._getSkyApiItem=function(e){var t={caller:o.default.viewerId,m:u.Config.mkt,rset:"skyweb_picker",v:""+Math.random(),d:"1",iabch:"1",pi:"5",path:1,lct:1,id:e.id,urlType:this._urlType},i=o.default.skyApiBaseUrl+"GetItems?"+f.serializeQuery(t),r={"X-SkyApiOriginId":""+Math.random()};return this._dataRequest.send({apiName:"GetItems",url:i,headers:r}).then(function(e){return(e.items||[e.item])[0]})};e.prototype._getValidateSignal=function(){var i=this,r=this._behavior.origin,o=new a.default;h.isApprovedDomain(r)?this.events.on(window,"message",function(e){var t=""+(e.data||"");if(e.source===window.parent&&e.origin===r&&0===t.indexOf("<file_dialog>")){o.complete({authenticationLevel:2});i.events.off(window,"message")}}):o.complete({authenticationLevel:0});return o};e.dependencies=i.__assign({},r.default.dependencies,{secureExperienceHelperType:v.typeResourceKey});return e}(r.default);t.default=k;function _(e){var t=u.Config.isINT,i=void 0!==t&&t?y:P;if((new l.default(e).getHost()||"").toUpperCase()!==i.toUpperCase())throw new Error("Cannot continue with the picker because the SDK is not from a trusted domain");var r,o=e.lastIndexOf(".js");o===e.length-3&&(e=e.substring(0,o));s.default.addPaths(((r={})[g]=e,r));return c.loadModule({path:"livesdk",getModule:function(){return new n.default(function(e,t){window.require(["livesdk"],e,t)})}}).then(function(){return WL&&WL.skydrivePicker})}t.typeResourceKey=d.createResolvedTypeResourceKey(e("module").id,k)});define("odsp-next/dataSources/itemPicker/odc/Sdk50PickerUrlHelper",["require","exports","./FolderPickerUrlHelper","../ItemTypeFilterHelper"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!!e.livesdk};t.getBehavior=function(e){var t=a.getFolderPickerOverrides(e),i=t.viewType,r=t.accessLevel,o=e.domain,n={showActions:!0,showBranding:!0,showSwitchAccount:!1,viewType:i,selectionMode:function(e){var t;switch(e){case"multi":t=1;break;default:case"single":t=0}return t}(e.select),accessLevel:r,typeFilter:s.getItemTypeFilter({viewType:i})};o&&(n.origin="https://"+o);return n}});define("odsp-next/dataSources/itemPicker/odc/FolderPickerUrlHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFolderPickerOverrides=function(e){var t,i;switch(e.v){case"1":case"FolderPickerView":t=2;i=1}return{viewType:t,accessLevel:i}}});define("odsp-next/dataSources/itemPicker/SecureExperienceHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this,r=t.currentWindow,o=void 0===r?window:r;i._currentWindow=o;return i}e.prototype.validateExperience=function(e){void 0===e&&(e={authenticationLevel:0});var t=this._currentWindow;if(t.self===t.top)return o.default.wrap();var i=t.parent;if(i)try{if(i.location.href)return o.default.wrap()}catch(e){}return 0<e.authenticationLevel?o.default.wrap():this._createInsecureError()};e.prototype._createInsecureError=function(){return o.default.wrapError(new Error("The picker is not being loaded in a secure context."))};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=a;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,a)});define("odsp-next/dataSources/itemPicker/OriginValidator",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=["DOCS.COM","ONEDRIVE.COM","LIVE.COM","LIVE-INT.COM","OFFICE.COM","LIVE-TST.COM","OFFICEAPPS.LIVE.COM","GOV.ONLINE.OFFICE365.US","DOD.ONLINE.OFFICE365.US","OFFICEAPPS-DF.LIVE.COM","ONLINE.OFFICE.DE","PARTNER.OFFICEWEBAPPS.CN"];t.isApprovedDomain=function(e){for(var t=new a.default(e).domain.toUpperCase(),i=0,r=s;i<r.length;i++){var o=r[i],n="."+o;if(o===t||-1<t.indexOf(n,t.length-n.length))return!0}return!1};t.validateOrigin=function(e){if(!e)throw new Error("No specified origin");var t=new o.default(e),i=t.getScheme();if(!i||!/http(s)?/.test(i))throw new Error("Invalid origin scheme");var r=t.getHost();if(!r||-1<r.indexOf("*"))throw new Error("Invalid origin host")}});define("odsp-next/dataSources/itemPicker/odc/Sdk60Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk60PickerUrlHelper","../Sdk60AccountChooserUrlHelper","./OAuthConsentHelper","../AccountChooserQueryStringHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,c,l,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,r=e.viewParams,o=e.getApplication,n=i._behavior=c.getItemPickerBehavior(r),a=i.scope;i._oAuthConsentHelper=new(a.attached(t.oAuthConsentHelperType))({behavior:n,returnUrl:c.getOAuthReturnUrl(r),getApplication:o});i._accountChooserQueryStringHelper=new(a.attached(t.accountChooserQueryStringHelperType))({accountChooserUrl:l.getAccountChooserUrl(n)});i._secureExperienceHelper=new(a.attached(t.secureExperienceHelperType))({behavior:n});return i}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};e.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};e.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};e.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};e.dependencies=i.__assign({},r.default.dependencies,{oAuthConsentHelperType:o.typeResourceKey,accountChooserQueryStringHelperType:n.typeResourceKey,secureExperienceHelperType:a.typeResourceKey});return e}(r.default);t.default=d;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,d)});define("odsp-next/dataSources/itemPicker/odc/Sdk60PickerUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/WindowStateManager","./ItemPickerConstants","@ms/odsp-utilities/lib/uri/Uri","../ItemTypeFilterHelper","../../../utilities/uri/UriValidator"],function(e,t,u,p,m,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!!e.scope};t.getItemPickerBehavior=function(e){var t=((new u.default).getState(p.WINDOW_STATE_KEY)||{}).aad_client_id,i=e.scope,r=h(e),o=function(e){void 0===e&&(e="");var t,i,r,o,n=e.split(":")[1],a=(void 0===n?"":n).split("|"),s=a[0],c=void 0===s?"":s,l=a[1],d=void 0===l?"":l,u=a[2],p=void 0===u?"":u;switch(c.toUpperCase()){case"READWRITEFOLDER":t=1;o=2;break;case"READWRITEFILE":o=t=1;break;case"READFOLDER":t=0;o=2;break;default:case"READFILE":t=0;o=1}switch(d.toUpperCase()){case"MULTI":case"MULTIPLE":i=1;break;default:case"SINGLE":i=0}switch(p.toUpperCase()){case"DOWNLOADLINK":r=2;break;case"WEBVIEWLINK":r=0;break;default:case"WEBLINK":r=1}return{accessLevel:t,viewType:o,selectionMode:i,linkType:r}}(i),n=o.accessLevel,a=o.viewType,s=o.selectionMode,c=o.linkType,l=g(e),d=function(e){void 0===e&&(e="");var t=new m.default(e).getQueryParameter("redirect_uri");return t&&v.getSafeAbsoluteWebUrl(t)}(r);return{showActions:!0,showBranding:!0,showSwitchAccount:!(!d||!l&&!t),accessLevel:n,viewType:a,selectionMode:s,linkType:c,returnUrl:d,aadClientId:t,msaClientId:l,typeFilter:f.getItemTypeFilter({viewType:a})}};function h(e){return v.getSafeAbsoluteWebUrl(e.ru)}t.getOAuthReturnUrl=h;function g(e){var t=e.client_id;return(void 0===t?"":t).split(",")[0]}t.getMsaClientId=g;t.getState=function(e){return new m.default(e.ru||"").getQueryParameter("state")}});define("odsp-next/dataSources/itemPicker/odc/ItemPickerConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WINDOW_STATE_KEY="odcpicker";t.HIDE_HEADER_PARAM="hideHeader";t.HIDE_FOOTER_PARAM="hideFooter";t.NO_MAX_ITEMS_PARAM="noMaxItems";t.SELECTION_OVERRIDE_PARAM="selection";t.SELECTION_OVERRIDE_PARAM_SHORT="select";t.API_SCENARIO="skyweb_picker";t.SELECTION_MAX_ITEMS=100;t.MAX_ITEMS_MAPPINGS={"":t.SELECTION_MAX_ITEMS,true:void 0}});define("odsp-next/dataSources/itemPicker/Sdk60AccountChooserUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./ItemPickerConstants"],function(e,o,n,a){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.ACCOUNT_CHOOSER_BASE_URL="https://onedrive.live.com/picker/accountchooser";var t,i,r,s,c=((t={})[1]="file",t[2]="folder",t),l=((i={})[0]="webViewLink",i[1]="webLink",i[2]="downloadLink",i),d=((r={})[1]="multi",r[0]="single",r),u=((s={})[1]="readwrite",s[0]="read",s);o.getAccountChooserUrl=function(e){var t,i;if(e.msaClientId||e.aadClientId){var r=((i={})[a.MSA_CLIENT_ID_PARAM]=e.msaClientId,i[a.AAD_CLIENT_ID_PARAM]=e.aadClientId,i[a.RETURN_URL_PARAM]=e.returnUrl,i[a.VIEW_TYPE_PARAM]=c[e.viewType],i[a.SELECTION_MODE_PARAM]=d[e.selectionMode],i[a.LINK_TYPE_PARAM]=l[e.linkType],i[a.ACCESS_LEVEL_PARAM]=u[e.accessLevel],i[a.PROMPT_PARAM]=a.PROMPT_SELECT_ACCUNT_VALUE,i);t=o.ACCOUNT_CHOOSER_BASE_URL+"?"+n.serializeQuery(r,null,!0)}return t}});define("odsp-next/dataSources/itemPicker/odc/OAuthConsentHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../providers/sharing/SharingProvider","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,l,o,d,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,r=e.behavior,o=e.returnUrl,n=e.getApplication,a=void 0===n?function(){return l.default.wrap()}:n;i._behavior=r;i._returnUrl=o;i._sharingProvider=t.sharingProvider;i._navigation=t.navigation;i._onGetApplication=a;return i}e.prototype.complete=function(i){var r=this,e=this._behavior,o=e.accessLevel,n=e.linkType,a=this._returnUrl;if(!a)return l.default.wrapError(new Error("No return URL specified to handle completion."));var s=1!==o&&2!==n,c=1===o?2:1;return this.trackPromise(this._onGetApplication().then(function(e){if(!e)return l.default.wrapError({code:1});if(s){var t={role:c,type:4,name:e.name,create:!0,person:e};return r._sharingProvider.manageSharingLinks(i,t).then(function(e){return{userId:e[0].id,itemId:e[0].item.id}})}return r._sharingProvider.share([e],{items:i,roleValue:String(c)}).then(function(e){return{userId:e.people[0].sharingInfo.userId,itemId:e.itemId}})}).then(function(e){var t=[e.itemId];1!==o&&2!==n&&t.push(e.userId);var i={res:"success",resuictx:{uriValue:"selection_"+t.join("!")}};r._navigation.navigateTo({url:a+"&"+d.serializeQuery(i)})}))};e.prototype.cancel=function(){var e=this._returnUrl;if(!e)return l.default.wrapError(new Error("No return URL specified to handle cancellation."));this._navigation.navigateTo({url:e+"&"+d.serializeQuery({res:"cancel"})});return l.default.wrap()};e.dependencies=i.__assign({},r.default.dependencies,{sharingProvider:o.resourceKey,navigation:n.navigation});return e}(r.default);t.default=s;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/dataSources/itemPicker/AccountChooserQueryStringHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this,r=e.accountChooserUrl;i._accountChooserUrl=r;i._navigation=t.navigation;return i}e.prototype.switchAccount=function(){var e=this._accountChooserUrl;this._navigation.navigateTo({url:e});return a.default.wrap()};e.dependencies=i.__assign({},r.default.dependencies,{navigation:n.navigation});return e}(r.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/dataSources/itemPicker/odc/Sdk70Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk70PickerUrlHelper","./Sdk60PickerUrlHelper","../Sdk70AccountChooserUrlHelper","./OAuthConsentHelper","../AccountChooserQueryStringHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,s,c,l,o,n,d,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this,r=e.viewParams,o=i.scope,n=i._behavior=s.getItemPickerBehavior(r);i._oAuthConsentHelper=new(o.attached(t.oAuthConsentHelperType))({behavior:n,returnUrl:c.getOAuthReturnUrl(r),getApplication:e.getApplication});i._accountChooserQueryStringHelper=new(o.attached(t.accountChooserQueryStringHelperType))({accountChooserUrl:l.getAccountChooserUrl(n)});i._secureExperienceHelper=new(o.attached(t.secureExperienceHelperType))({behavior:n});return i}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};e.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};e.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};e.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};e.dependencies=i.__assign({},r.default.dependencies,{oAuthConsentHelperType:o.typeResourceKey,accountChooserQueryStringHelperType:n.typeResourceKey,secureExperienceHelperType:d.typeResourceKey});return e}(r.default);t.default=u;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,u)});define("odsp-next/dataSources/itemPicker/odc/Sdk70PickerUrlHelper",["require","exports","./Sdk60PickerUrlHelper","../Sdk70PickerUrlHelper"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return i.isApplicable(e)&&r.isApplicable(e)};t.getItemPickerBehavior=function(e){var t=r.getItemPickerBehavior(e);t.msaClientId=i.getMsaClientId(e);return t}});define("odsp-next/dataSources/itemPicker/Sdk70AccountChooserUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/guid/Guid"],function(e,n,a,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.LOGIN_BASE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize";n.getAccountChooserUrl=function(e){var t=e.aadClientId,i=e.returnUrl,r=e.state;if(!t||!i)return"";var o={client_id:t,redirect_uri:i,response_type:{uriValue:"id_token+token"},scope:"profile openid https://graph.microsoft.com/Files.ReadWrite https://graph.microsoft.com/User.Read",response_mode:"fragment",state:void 0===r?"aad_login":r,nonce:s.default.generate()};return n.LOGIN_BASE_URL+"?"+a.serializeQuery(o,null,!0)}});define("odsp-next/dataSources/itemPicker/odc/Sdk71Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk71PickerUrlHelper","../PostMessageHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,s,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this,r=e.viewParams,o=i._behavior=s.getItemPickerBehavior(r),n=i.scope;i._postMessageHelper=new(n.attached(t.postMessageHelperType))({behavior:o});i._secureExperienceHelper=new(n.attached(t.secureExperienceHelperType))({behavior:o});return i}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var t=this;return this._postMessageHelper.initialize().then(function(e){return t._secureExperienceHelper.validateExperience(e)})};e.prototype.complete=function(e){return this._postMessageHelper.complete(e)};e.prototype.cancel=function(){return this._postMessageHelper.cancel()};e.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};e.dependencies=i.__assign({},r.default.dependencies,{postMessageHelperType:o.typeResourceKey,secureExperienceHelperType:n.typeResourceKey});return e}(r.default);t.default=c;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/dataSources/itemPicker/odc/Sdk71PickerUrlHelper",["require","exports","../Sdk71PickerUrlHelper"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return i.isApplicable(e)};t.getItemPickerBehavior=function(e){return i.getItemPickerBehavior(e)}});define("odsp-next/dataSources/itemPicker/PostMessageHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/uri/SimpleUri","./OriginValidator","./Sdk71","./PickerItemHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,h,a,g,l,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(v){i.__extends(o,v);function o(e,t){var i=v.call(this,e,t)||this,r=e.behavior;i._behavior=r;var o=t.currentWindow,n=void 0===o?window:o,a=i._postMessageTargetSignal=new h.default,s=i._hostIdentitySignal=new h.default,c=n.parent!==n?n.parent:void 0,l=n.opener,d=r.origin,u=c||l;if(u){var p=i._getOrigin(u,d),m=p.origin,f=p.hostAuthenticationLevel;a.complete({window:u,origin:m});f&&s.complete({authenticationLevel:f})}g.isApprovedDomain(r.origin)||s.complete({authenticationLevel:0});i._pickerItemHelper=new t.pickerItemHelperType({behavior:r});i._responseSignals={};i.events.on(n,"message",i._onMessage);return i}o.prototype.initialize=function(){var e=this._behavior.id,t=this._hostIdentitySignal;this.async.setTimeout(function(){t.complete({authenticationLevel:0})},300);this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"initialize"}).done(function(e){t.complete({authenticationLevel:0})});return t.getPromise()};o.prototype.complete=function(t){var i=this,r=this._behavior.id;return this._hostIdentitySignal.getPromise().then(function(e){return i._pickerItemHelper.getPickerItemsFromItems(t,{hostAuthenticationLevel:e.authenticationLevel}).then(function(e){return i._sendRequest({conversationId:++o._nextConversationId,pickerId:r,type:"success",items:e})}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})})};o.prototype.cancel=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"cancel"}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})};o.prototype.switchAccount=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"switch"}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})};o.prototype._getOrigin=function(e,t){var i,r;try{i=new a.default(e.location.href).authority;r=2}catch(e){t===this._behavior.origin&&(i=t)}return{origin:i,hostAuthenticationLevel:r}};o.prototype._sendRequest=function(a){var s=this;return this._postMessageTargetSignal.getPromise().then(function(e){var t=e.window,i=e.origin;g.validateOrigin(i);var r=a.conversationId,o=""+l.MESSAGE_FROM_PICKER_PREFIX+JSON.stringify(a),n=new h.default;s._responseSignals[r]=n;t.postMessage(o,i);return n.getPromise().then(function(e){delete s._responseSignals[r];return e})})};o.prototype._onMessage=function(i){var r=this,e=""+(i.data||"");if(0===e.indexOf(l.MESSAGE_TO_PICKER_PREFIX))try{var o=JSON.parse(e.substring(l.MESSAGE_TO_PICKER_PREFIX.length));if(o.pickerId===this._behavior.id){var t=this._postMessageTargetSignal;if("activate"===o.type){var n=this._getOrigin(i.source,i.origin),a=n.hostAuthenticationLevel,s=void 0===a?g.isApprovedDomain(i.origin)?2:0:a,c=n.origin;this._hostIdentitySignal.complete({authenticationLevel:s});t.complete({window:i.source,origin:c})}t.getPromise().done(function(e){if(i.origin===e.origin){var t=r._responseSignals[o.conversationId];t&&t.complete(o)}})}}catch(e){}};o.dependencies=i.__assign({},r.default.dependencies,{pickerItemHelperType:s.typeResourceKey});o._nextConversationId=0;return o}(r.default);t.default=c;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/dataSources/itemPicker/PickerItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/vroom/VroomDataRequestor","../../providers/itemPicker/ItemPickerProvider","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(i,e,n,t,r,o,a,s,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l;!function(e){var t=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getItem=function(e){var t=e.itemUrl,i=e.accessToken;return this._vroomDataRequestor.send({path:t+"?select=*,sharePointIds",accessToken:i,apiName:"GetItem"})};e.prototype.createLink=function(e){var t=e.itemUrl,i=e.accessToken;return this._vroomDataRequestor.send({path:t+"/oneDrive.createLink",accessToken:i,apiName:"CreateLink",postData:JSON.stringify({type:"view"}),requestType:"POST"})};e.dependencies={vroomDataRequestor:r.resourceKey};return e}();e.PickerItemService=t;e.pickerItemServiceResourceKey=new c.ResourceKey({name:i("module").id+".internals.pickerItemService",factory:new c.ResolvedResourceFactory(t)})}(l=e.Internals||(e.Internals={}));var d=function(r){n.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._pickerItemService=t.pickerItemService;i._itemPickerProvider=t.itemPickerProvider;i._behavior=e.behavior;return i}e.prototype.getPickerItemsFromItems=function(e,t){var r=this,o=t.hostAuthenticationLevel;return s.default.all(e.map(function(t){var e=s.default.wrap(r._itemPickerProvider.getPickerItemFromItem(t,{hostAuthenticationLevel:o}));if(2<=o){var i=r._behavior.linkType;4!==i&&2!==i||(e=e.then(function(e){return r._attachDriveItemToPickerItem(t,e)}));4!==i&&3!==i||(e=e.then(function(e){return r._attachShareUrlToPickerItem(t,e)}))}return e}))};e.prototype._attachDriveItemToPickerItem=function(e,t){var i=t.urls,r=void 0===i?{}:i,o=n.__rest(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){return n.__assign({},o,{urls:n.__assign({},r,{download:e["@content.downloadUrl"]}),driveItem:e})})};e.prototype._attachShareUrlToPickerItem=function(e,t){var i=t.urls,r=void 0===i?{}:i,o=n.__rest(t,["urls"]);return this._getShareLink(e).then(function(e){return n.__assign({},o,{urls:n.__assign({},r,{share:e})})})};e.prototype._getOneDrivePickerItem=function(t){var i=this;return this.resources.consumeAsync(a.graph).then(function(e){return i._pickerItemService.getItem({itemUrl:e.getItemUrl(t,{useDirectEndpoint:!0,isPath:!1}),accessToken:e.getAccessToken(t)})})};e.prototype._getShareLink=function(t){var i=this;return this.resources.consumeAsync(a.graph).then(function(e){return i._pickerItemService.createLink({itemUrl:e.getItemUrl(t,{useDirectEndpoint:!0,isPath:!1}),accessToken:e.getAccessToken(t)}).then(function(e){return e.link.webUrl})})};e.dependencies=n.__assign({},t.default.dependencies,{pickerItemService:l.pickerItemServiceResourceKey,itemPickerProvider:o.resourceKey});return e}(t.default);e.default=d;e.typeResourceKey=c.createResolvedTypeResourceKey(i("module").id,d)});define("odsp-next/dataSources/itemPicker/Sdk72Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk72PickerUrlHelper","./PostMessageHelper","./SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,a,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this,r=i._behavior=a.getItemPickerBehavior(e.viewParams),o=i.scope;i._postMessageHelper=new(o.attached(t.postMessageHelperType))({behavior:r});i._secureExperienceHelper=new(o.attached(t.secureExperienceHelperType))({behavior:r});return i}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var t=this;return this._postMessageHelper.initialize().then(function(e){return t._secureExperienceHelper.validateExperience(e)})};e.prototype.complete=function(e){return this._postMessageHelper.complete(e)};e.prototype.cancel=function(){return this._postMessageHelper.cancel()};e.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};e.dependencies={postMessageHelperType:o.typeResourceKey,secureExperienceHelperType:s.typeResourceKey};return e}(r.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/dataSources/itemPicker/odc/LeftNavDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../leftNav/handlers/SwitchAccountLeftNavHandler","../../leftNav/odc/handlers/OneDriveLeftNavHandler.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHandlerTypeKeys=function(){return[n.typeResourceKey,o.typeResourceKey]};return t}(r.default);t.LeftNavDataSource=s;t.resourceKey=a.createResolvedResourceKey(e("module").id,s)});define("odsp-next/dataSources/itemPicker/leftNav/handlers/SwitchAccountLeftNavHandler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../controls/itemPicker/resources/ItemPickerResourceKeys","../../../../controls/itemPicker/ItemPicker.resx","@ms/odsp-utilities/lib/resources/Resources","../../../../utilities/icons/Icon"],function(e,t,i,r,o,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){i.__extends(e,n);function e(e,t){void 0===e&&(e={});var i=n.call(this,e,t)||this,r=i.observables;i._switchAccountAction=new(i.child(t.itemPickerActionMap.ItemPickerSwitchAccountAction));var o=r.createArray();o.push({url:"#",action:i._switchAccountAction,isActive:r.create(!1),isFocused:r.create(!1),text:a.strings.switchAccountActionText,engagementName:"SwitchAccount",altText:a.strings.switchAccountActionText,icon:new s.default("Contact")});(i.linkGroups=r.createArray()).push({text:"",url:void 0,isActive:r.create(!1),isFocused:r.create(!1),automationId:"switchAccount",hideGroupHeader:!0,isExpanded:r.create(!0),links:i.scope.attach(o.filter(function(e){return e.action.isAvailable()}))});return i}e.dependencies=i.__assign({},r.default.dependencies,{itemPickerActionMap:o.actionMap});return e}(r.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/dataSources/leftNav/odc/handlers/OneDriveLeftNavHandler.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.typeResourceKey=new r.ResourceKey({name:i("module").id,loader:new r.AliasResourceLoader(function(){return o.loadModuleExport({path:"./OneDriveLeftNavHandler",getModule:function(){return new t.default(function(e,t){i(["./OneDriveLeftNavHandler"],e,t)})},getExport:function(e){return e.typeResourceKey.local}})})})});define("odsp-next/pages/filePicker/odc/ConsumerFilePicker.html",[],function(){return"\x3c!--ko component: {\r\n name: filePickerTagName,\r\n params: filePickerParams\r\n}--\x3e\x3c!--ko host: {\r\n data: $host\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/dataSources/leftNav/odc/handlers/OneDriveLeftNavHandler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../controls/leftPane/LeftPane.resx","../../../../controls/leftNav/LeftNav.resx","../../../../resources/ControlResourceKeys","../../../url/QueryType","../../../../models/item/ItemParentHelper","../../../../resources/DataSourceResourceKeys","../../RootSourceTypeFilter.key","../../../base/odc/Config","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(i,e,t,o,n,d,a,u,s,c,l,p,m,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=function(r){t.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._rootItems=t.rootItems;i._actionMap=t.actionMap;i._itemParentHelper=t.itemParentHelper;i._currentItem=t.currentItem;i._rootSourceTypeFilter=t.rootSourceTypeFilter;i._config=t.config;i.linkGroups=i._getLinkGroups();return i}e.prototype._getLinkGroups=function(){var e=this.observables,t=e.createArray();t.push({text:m.format(n.strings.oneDriveGroupHeaderFormat,n.strings.oneDriveGroupTitle,n.strings.consumerOneDriveName),subText:this._config.email,icon:e.create({iconUrl:"undefined"==typeof __webpack_public_path__?i.toUrl("@ms/odsp-media/lib/images/apps/onedrive_48x1_5.svg"):i("@ms/odsp-media/dist/media/images/apps/OneDrive_48x1_5.svg"),mode:"person"}),url:null,isExpanded:e.create(!0),isActive:e.create(!1),isFocused:e.create(!1),automationId:"LeftNav-OneDriveGrouping",links:this._getOneDriveLinks()});return t};e.prototype._getOneDriveLinks=function(){var e=this,t=this.observables,i=t.createArray(),r=this._rootItems.peek(),o=r.files,n=r.recent,a=r.photos,s=this._rootSourceTypeFilter,c=!s||s.recent,l=!s||s.photos;i.push({text:o.peek().displayName,altText:d.strings.filesAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:o}),isActive:this._getIsActive(o),isFocused:t.create(!1),engagementName:"Files"});c&&i.push({text:n.peek().displayName,altText:d.strings.recentAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:n}),isActive:this._getIsActive(n),isFocused:t.create(!1),engagementName:"Recent"});l&&i.push({text:a.peek().displayName,altText:d.strings.photosAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:a}),isActive:t.pureCompute(function(){return e._currentItem().displayType===u.default.AllMyPhotos}),isFocused:t.create(!1),engagementName:"Photos"});return i};e.prototype._getIsActive=function(e){var i=this,r=this.observables;return r.pureCompute(function(){var t=e().key;return!!r.unwrap(i._itemParentHelper.getAncestorOrSelf(i._currentItem(),function(e){return e.key===t}))})};e.dependencies=t.__assign({},o.default.dependencies,{rootItems:c.rootItems,actionMap:a.actionMap,currentItem:a.currentItem,itemParentHelper:s.resourceKey,rootSourceTypeFilter:l.resourceKey.optional,config:p.configResourceKey});return e}(o.default);e.default=f;e.typeResourceKey=r.createResolvedTypeResourceKey(i("module").id,f)});