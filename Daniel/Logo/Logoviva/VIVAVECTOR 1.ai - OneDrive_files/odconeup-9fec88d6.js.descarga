define("odsp-next/controls/oneUp/OneUp",["require","exports","./OneUpViewModel","../../bindings/component/ControlBinding","./OneUp.html","./OneUp.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-one-up",name:e("module").id,template:e("./OneUp.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/OneUpViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../models/selection/ItemSetSelectionModel","./commandSets/OneUpCommandSet","./commandSets/OneUpCoreCommandSet","./commandSets/SlideshowCommandSet","../../models/command/set/UnionCommandSet","../../bindings/clientRect/ClientRectBinding","../../bindings/focus/ChildFocusBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/throttledClick/ThrottledClickBinding","../../bindings/idle/IdleBinding","../../resources/PagesResourceKeys","../../providers/panel/PanelProvider","../../providers/transclusion/TransclusionProvider","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","./OneUp.resx","../infoPane/InfoPane.resx","../../utilities/ui/FullScreen","../../models/itemSet/ItemSet","../../models/itemSet/ItemSetContent","../commands/SelectableCommandSet","@ms/odsp-shared/lib/utilities/object/EqualityComparers","knockout","@ms/odsp-utilities/lib/locale/Locale","../../utilities/browser/ResponsiveUI","../overlays/host/OverlayHost","../dialogHost/DialogHost","../panelHost/PanelHost","./logging/OneUpCarousel.event","../../bindings/component/ControlBinding","../detailsPaneHost/legacy/LegacyDetailsPaneHost.key","./OneUpSlide","../carousel/Carousel","../transclusion/host/TransclusionHost","../sharing/share/commands/ShareCommandBuilder","../../utilities/features/Features","@ms/odsp-utilities/lib/events/EventGroup","./wrs/AccessibilityMode.key","../../bindings/aria/HideWhenInactiveBinding","../../providers/dialog/DialogProvider","./ToolbarProvider.key","../commandBar/CommandBar.key","../../utilities/killSwitch/KillSwitch","../infoPane/FocusedInfoPaneSection.key"],function(e,t,r,n,m,f,l,c,u,h,g,b,v,w,_,y,x,C,O,a,o,i,s,d,P,S,U,k,I,M,E,T,F,B,R,A,D,L,V,H,K,N,j,q,z,Z,W,G,Q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var $=o.strings,p=function(p){r.__extends(e,p);function e(e,t){void 0===e&&(e={});var n=p.call(this,e,t)||this;n.overlayHostTagName=E.default.tagName;n.dialogHostTagName=T.default.tagName;n.panelHostTagName=F.default.tagName;n.carouselTagName=L.default.tagName;n.transclusionHostTagName=V.default.tagName;n.oneUpSlideTagName=D.default.tagName;n.addBindingHandlers({clientRect:g.default,keyboard:v.default,idle:_.default,throttledClick:w.default,control:R.default,childFocus:b.default,hideWhenInactive:q.default});n._carouselEvent=new B.OneUpCarousel;n._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var o=t.rateLimitExtenders,i=void 0===o?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:o;n._rateLimitExtenders=i;var a=n,r=a.observables,s=a.resources;n.slideLoadState=r.create(0);n.toolbarProvider=t.toolbarProvider;s.bind(H.shareFocusItemResourceKey);s.bind(H.copyLinkFocusItemResourceKey);s.expose(j.default,r.create(!1));s.exposeFactory(O.overlay,C.factory);s.bind(x.resourceKey);s.bind(z.resourceKey);n.isSlideShowModeEnabled=r.create(!1);s.expose(m.slideshowState,n);n.addCaptionLabel=r.create("");n.isRotating=r.create(!1);n.isIdle=r.create(!1);n._actionMap=t.actionMap;n._initializeItem({item:t.focusItem});var d=t.currentItemSet;n._initializeItemSet({itemSet:t.focusItemSet||d});n._parent=r.pureCompute(function(){return d().item()});s.block(m.currentSelectionModelGroup);n._selectionModel=s.expose(m.itemsSelection,new(n.managed(f.default))({indexResolver:t.indexResolver}));n.allocationRange=e.requiredRange;n.size=r.create({width:0,height:0});s.expose(y.base.infoPane.hidePreview,r.create(!0));n.isInfoPaneExpanded=s.expose(y.base.infoPane.isInfoPaneExpanded,r.create(!1));n._focusedInfoPaneSection=t.focusedInfoPaneSection;n.isCommandBarVisible=r.create(!0);n.oneUp={isRotating:n.isRotating,isCommandBarVisible:n.isCommandBarVisible,isInfoPaneExpanded:n.isInfoPaneExpanded,enableSlideControls:r.create(!1),size:n.size,slide:r.create(),shareLinkId:e.shareLinkId};var l={deferEvaluation:!0};n.canNavigate=r.pureCompute(n._computeCanNavigate,l);n.caption=r.pureCompute(n._computeCaption,l);n.showEditCaption=r.pureCompute(n._computeIsEditCaptionEnabled,l);n._dataManagerMapper=t.dataManagerMapper;n._areFlippersPermanent=r.pureCompute(function(){return 1<n.items().length});n.legend=r.pureCompute(n._computeLegend,l);n._initializeActions();n.commandBarSpecification=R.toSpecification(W.resourceKey,{commandSet:n._getCommandSet(t),isMobile:!1});n._initializeOpenParentWhenEmpty();n.isIdleEnabled=r.pureCompute(n._computeIsIdleEnabled,l);n.isDetailsFocused=r.create(!1);n.isAwake=r.pureCompute(n._computeIsAwake,l);n.isPanningEnabled=r.pureCompute(n._computeIsPanningEnabled,l);var c=M.default.getScrollbarWidth()+"px";n.nextFlipperStyle={};n.nextFlipperStyle[I.default.safeRight]=c;n.previousFlipperStyle={};n.previousFlipperStyle[I.default.safeLeft]=c;n.detailsBarStyle=r.pureCompute(n._computeDetailsBarStyle,l);var u=r.pureCompute(function(){return 2<=n.slideLoadState()});n.infoPaneSpecification=R.toSpecification(A.resourceKey,{showSections:u});e.isSlideshow&&r.compute(function(){e.isSlideshow(n.isSlideShowModeEnabled())}).extend({deferred:!0});r.backgroundCompute(n._computeSetCaptionLabel);r.backgroundCompute(n._computeClearCaptionFocus);r.backgroundCompute(n._computeSelectItem);r.backgroundCompute(n._computeTriggerClientRectUpdate);r.backgroundCompute(n._computeCommandBarShownOnIdleFullScreen);r.backgroundCompute(n._computeIsFirstSlideOpened);r.backgroundCompute(n._computePagesViewed);return n}e.prototype.executeAction=function(e,t){if(e.isAvailable.peek()){e.execute(t);return!1}return!0};e.prototype.enterSlideshowMode=function(){s.default.enterFullScreen();if(this.isSlideShowModeEnabled.peek()){this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!0}return!1};e.prototype.exitSlideshowMode=function(){s.default.exitFullScreen();this.isSlideShowModeEnabled(!1);if(this._timeOutId){this.async.clearTimeout(this._timeOutId);return!0}return!1};e.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){k.removeNode(e)},500)};e.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())};e.prototype.toggleInfoPaneExpanded=function(e){this._showPropertiesAction.execute(e);return!1};e.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1);this._showPropertiesAction.execute(e)}return!1};e.prototype.dispose=function(){var e=this.peekUnwrapObservable(this._itemSet);if(e){var t=e.content.peek();this._carouselEventData.totalPages=t.items.length}this._carouselEvent.end(this._carouselEventData);s.default.exitFullScreen();p.prototype.dispose.call(this)};e.prototype._startSlideshow=function(){this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null);if(!this.isSlideShowModeEnabled.peek())return!1;this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0};e.prototype._initializeItemSet=function(e){var n=this,o=e.itemSet;this._sourceItemSet=o;var i,a=this.observables;this.index=a.pureCompute(this._computeIndex);this._isPlaceholderItemSetRequired=a.pureCompute(function(){var e=o();return(!e.content()||e.isPlaceholder)&&-1===n.index()},{deferEvaluation:!0});var t=a.pureCompute(function(){var t;if(n._isPlaceholderItemSetRequired()){(t=new d.default).item=o.peek().item;i&&i.dispose();i=a.compute(function(){var e=new P.default;e.items=[n.item()];t.content(e)})}else t=o();return t});t.equalityComparer=U.objectStrictEquality;if(!G.default.isActivated("d0e78ab2-757c-4eed-8e4b-46b10f8371d8","01/08/2018","Override currentItem in OneUp")){var r=a.pureCompute(function(){return t().item()});r.equalityComparer=U.objectStrictEquality;this.resources.expose(m.currentItem,r)}this._itemSet=this.resources.expose(m.currentItemSet,t);this.items=a.createArray();a.backgroundCompute(function(){n.items(n._itemSet().content().items)})};e.prototype._initializeItem=function(e){var t=this,n=e.item,o=this.observables,i=this.item=o.create();i.equalityComparer=U.objectStrictEquality;if(n){o.backgroundCompute(function(){i(n())});o.backgroundCompute(function(){if(i()!==n.peek()){var e=t._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}};e.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1};e.prototype._initializeActions=function(){var e=this,t=this.observables,n=t.pureCompute(function(){return t.unwrap(e.item())}),o=this._actionMap,i=this.managed(o.OpenAction),a={openRelation:2,focusUrl:!0,ignoreHistory:!0};this._openCurrent=new i(r.__assign({},a,{item:n}));this._openPrevious=new i(r.__assign({},a,{item:t.pureCompute(this._computePreviousItem)}));this._openNext=new i(r.__assign({},a,{item:t.pureCompute(this._computeNextItem)}));this.updateCaptionAction=new(this.managed(o.UpdateCaptionAction))({item:n});this._showPropertiesAction=new(this.managed(o.ShowPropertiesAction))({useToggleBehavior:!0})};e.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),o=e-1;0<=o;o--){var i=this.unwrapObservable(n[o]);if(!t||i&&!i.video)return i}};e.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),o=e+1,i=n.length;o<i;o++){var a=this.unwrapObservable(n[o]);if(!t||a&&!a.video)return a}t&&this.exitSlideshowMode()}};e.prototype._initializeOpenParentWhenEmpty=function(){var t=this,e=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,o=n.pureCompute(function(){var e=t._itemSet();e.content();return!e.isPlaceholder&&!e.item().isPlaceholder||e.item().error?t.items().length:o.peek()});n.backgroundCompute(function(){0===o()&&e.isAvailable.peek()&&e.execute(null)}).extend(this._rateLimitExtenders)};e.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded();this.isCommandBarVisible();k.computedContext.isInitial()||this.async.setTimeout(function(){N.default.raise(document.body,"resize",void 0,!0)},500)};e.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)};e.prototype._computeCommandBarShownOnIdleFullScreen=function(){s.default.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())};e.prototype._computePagesViewed=function(){var e=this.oneUp.slide();if(e){this._carouselEventData.pagesViewed++;e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0)}};e.prototype._computeCanNavigate=function(){if(!K.isFeatureEnabled(K.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e){this.item();return!1}var t=e.peek();if(!t||t.isPlaceholder){e();return!1}return!!t.photo};e.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var o=this._carouselEventData;o.initialFileSize=n.size;o.initialFileType=n.iconName&&n.iconName.toLowerCase();o.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()};e.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this._createSelectableCommandSet(e):t};e.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,o=void 0===n?new(this.managed(l.default)):n,i=e.slideshowCommandSet,a=void 0===i?new(this.managed(u.default)):i,r=this.observables,s=new(this.managed(S.default))({commandSet:r.pureCompute(function(){if(t.isSlideShowModeEnabled())return a;var e=t.oneUp.slide();return e&&e.commandSet()||o})}),d=new(this.managed(c.default))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent});return new(this.managed(h.default))({commandSets:[s,d]})};e.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=M.default.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,o=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};i[I.default.safeRight]=o+"px";return i};e.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?i.strings.captionAddCaption:i.strings.captionAddDescription;this.addCaptionLabel(n)};e.prototype._computeLegend=function(){var e=this.index(),t=this._dataManagerMapper,n=t&&t(),o=n?n.itemSet():this._itemSet(),i=n?n.getOriginalItemIndexByMappedIndex(e):e;return-1<i?a.format($.legendFormat,i+1,o.content().items.length):""};e.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption};e.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()};e.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()};e.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()};e.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())};e.prototype._computeSelectItem=function(){var e=this.item(),t=this._selectionModel;if(t.selection()[0]!==e){var n=t.getItemKey(e);t.setSelectedKeys([n])}};e.dependencies=r.__assign({},n.default.dependencies,{focusItem:m.focusItem.optional,focusItemSet:m.focusItemSet.optional,currentItemSet:m.currentItemSet,indexResolver:m.selectionIndexResolver.optional,toolbarProvider:Z.resourceKey,actionMap:m.actionMap,focusedInfoPaneSection:Q.focusedInfoPaneSectionResourceKey.optional,dataManagerMapper:m.currentDataManagerMapper.optional,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0});return e}(n.default);t.default=p});define("odsp-next/controls/oneUp/commandSets/OneUpCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Commands.resx","../../commands/Command","../../../resources/ControlResourceKeys","../../../resources/SPOResourceKeys","../../../utilities/features/Features","../../../utilities/icons/Icon","../../../utilities/icons/OfficeFileNameHelper","../../../utilities/selection/SelectionHelper","../../fileHandler/FileHandlerCommands","../../../controls/sharing/share/commands/ShareCommandBuilder","../wrs/AccessibilityMode.key","../../../actions/accessibilityMode/AccessibilityModeAction","../../../controls/FabricIconsDeferred"],function(e,t,n,o,b,v,w,_,y,x,i,a,C,O,P,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var U=b.strings,k=["S"],r=function(g){n.__extends(e,g);function e(e){void 0===e&&(e={});var t=g.call(this,e)||this;t._actionMap=t.resources.consume(w.actionMap);t._selection=t.resources.consume(w.itemsSelection);var n=t.resources.consume(_.pageContext.optional),o=t.scope.attach(new(t.resources.consume(C.typeResourceKey.local))({})),i=t.createPureComputed(t._computeOpenInOfficeOnlineText),a=t.createPureComputed(t._computeOpenInOfficeClientText),r=t.createPureComputed(t._computOpenInOfficeSuffixClass),s=t.createPureComputed(t._computeOfficeIcon),d=[new(t.managed(v.CommandViewModel))({text:i,renderLabel:2,icon:s,classSuffix:r,action:new(t.managed(t._actionMap.OpenInOfficeOnlineAction))}),new(t.managed(v.CommandViewModel))({text:a,renderLabel:2,icon:s,classSuffix:r,action:new(t.managed(t._actionMap.OpenInOfficeClientAction))})],l=[new(t.managed(v.CommandViewModel))({text:U.OpenInBrowser,renderLabel:2,icon:new x.default("PDF"),classSuffix:"PDF",action:new(t.managed(t._actionMap.OpenPdfInBrowserAction))}),new(t.managed(v.CommandViewModel))({text:U.OpenInTextEditor,renderLabel:2,icon:new x.default("Edit"),action:new(t.managed(t._actionMap.OpenInTextEditorAction))})],c=t.observables.createArray([]);t.createBackgroundComputed(function(){c.splice.apply(c,[0,c.peek().length].concat(d,o.openWithCommands(),l))});var u=t.createPureComputed(function(){for(var e={},t=0,n=c();t<n.length;t++){var o=n[t];if(o.isVisible()){var i=o.icon(),a=o.iconUrl();if(i&&"Page"!==i.toString()||a){e.icon=i;e.iconUrl=a;return e}}}e.icon=new x.default("Page");return e}),p=t.createPureComputed(function(){return u().icon}),m=t.createPureComputed(function(){return u().iconUrl}),f=n?y.isFeatureEnabled(y.ShareV3)?new(t.managed(O.default))({renderLabel:2,mode:0}).command:new(t.managed(v.CommandViewModel))({text:b.strings.Share,tooltip:b.strings.ShareCommandTooltipV3,renderLabel:2,icon:new x.default("Share"),action:y.isFeatureEnabled(y.UseNewSharingDialog)&&"21"===n.webTemplate?new(t.managed(t._actionMap.ShareByLinkAction))({sharingMethod:2}):new(t.managed(t._actionMap.ShareAction))({activeTab:1}),keys:k}):new(t.managed(v.CommandViewModel))({text:U.Share,renderLabel:2,icon:new x.default("Share"),action:new(t.managed(t._actionMap.ShareByLinkAction)),keys:k}),h=t.resources.consume(P.default);t.commands([new(t.managed(v.CommandViewModel))({text:U.Open,icon:p,iconUrl:m,classSuffix:r,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:c}),f,y.isFeatureEnabled(y.ShareV3)?new(t.managed(O.default))({renderLabel:2,mode:1}).command:new(t.managed(v.CommandViewModel))({text:b.strings.GetLink,renderLabel:2,icon:new x.default("Link"),action:new(t.managed(t._actionMap.GetLinkAction))({useOldSharingDialog:n&&"21"!==n.webTemplate})}),new(t.managed(v.CommandViewModel))({text:U.print,renderLabel:2,icon:new x.default("Print"),keys:["CtrlP"],action:new(t.managed(t._actionMap.PrintPdfAction))}),new(t.managed(v.CommandViewModel))({text:U.addToSharedList,renderLabel:2,icon:new x.default("Add"),action:new(t.managed(t._actionMap.AddToSharedListAction))}),new(t.managed(v.CommandViewModel))({text:U.removeFromSharedList,renderLabel:2,icon:new x.default("Cancel"),action:new(t.managed(t._actionMap.RemoveFromSharedListAction))}),new(t.managed(v.CommandViewModel))({text:U.AddToAlbum,icon:new x.default("Photo2Add"),renderLabel:2,action:new(t.managed(t._actionMap.AddToAlbumAction))({})}),new(t.managed(v.CommandViewModel))({text:U.playSlideshow,icon:new x.default("Play"),renderLabel:2,action:new(t.managed(t._actionMap.PlaySlideShowAction))({})}),new(t.managed(v.CommandViewModel))({text:U.rotate,icon:new x.default("rotate"),renderLabel:2,action:new(t.managed(t._actionMap.RotateAction))({})}),new(t.managed(v.CommandViewModel))({text:U.applyOfficeLens,renderLabel:2,icon:new x.default("LightningBolt"),action:new(t.managed(t._actionMap.ApplyOfficeLensAction))}),new(t.managed(v.CommandViewModel))({text:U.removeOfficeLens,renderLabel:2,icon:new x.default("Undo"),action:new(t.managed(t._actionMap.RemoveOfficeLensAction))}),new(t.managed(v.CommandViewModel))({text:U.Download,icon:new x.default("Download"),renderLabel:2,action:new(t.managed(t._actionMap.DownloadAction))({})}),new(t.managed(v.CommandViewModel))({text:U.DeleteItem,icon:new x.default("Delete"),renderLabel:2,action:new(t.managed(t._actionMap.DeleteAction))({})}),new(t.managed(v.CommandViewModel))({text:U.viewOriginal,icon:new x.default("Picture"),renderLabel:2,action:new(t.managed(t._actionMap.ViewOriginalAction))({})}),new(t.managed(v.CommandViewModel))({text:U.viewInFolder,icon:new x.default("Folder"),action:new(t.managed(t._actionMap.ViewInFolderAction)),renderLabel:2}),new(t.managed(v.CommandViewModel))({text:U.OrderPrints,icon:new x.default("Print"),renderLabel:2,action:new(t.managed(t._actionMap.OrderPrintsAction))({})}),new(t.managed(v.CommandViewModel))({text:U.Embed,icon:new x.default("Embed"),renderLabel:2,action:new(t.managed(t._actionMap.EmbedAction))({})}),new(t.managed(v.CommandViewModel))({text:U.editTags,renderLabel:2,icon:new x.default("Tag"),keys:["T"],action:new(t.managed(t._actionMap.EditTagsAction))}),new(t.managed(v.CommandViewModel))({renderLabel:2,text:t.createPureComputed(function(){return h()?U.ViewMode:U.AccessibilityMode}),icon:t.createPureComputed(function(){return h()?new x.default("Page"):new x.default("EaseOfAccessLegacy")}),action:new(t.managed(S.default))({accessibilityMode:h})}),new(t.managed(v.CommandViewModel))({text:U.Copy,renderLabel:2,icon:new x.default("Copy"),automationId:"copy",action:new(t.managed(t._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(t.managed(v.CommandViewModel))({text:b.strings.ShowVersionHistory,renderLabel:2,icon:new x.default("StackIndicator"),action:new(t.managed(t._actionMap.ShowVersionHistoryAction))})].concat(n&&n.allowInfectedDownload?[new(t.managed(v.CommandViewModel))({text:b.strings.Download,renderLabel:2,icon:new x.default("Download"),action:new(t.managed(t._actionMap.ShowMalwareDetectedAction))({})})]:[],[o.actionsCommand,t.overflowHostCommand,new(t.managed(v.CommandViewModel))({text:U.Details,icon:new x.default("Info"),location:12,action:new(t.managed(t._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"})]));return t}e.prototype._computeOpenInOfficeOnlineText=function(){return i.getOfficeOnlineStringMap(a.getSelectedItemApp(this._selection))||b.strings.Open};e.prototype._computeOpenInOfficeClientText=function(){return i.getOfficeStringMap(a.getSelectedItemApp(this._selection))};e.prototype._computOpenInOfficeSuffixClass=function(){return i.getOfficeAppFriendlyName(a.getSelectedItemApp(this._selection))};e.prototype._computeOfficeIcon=function(){var e,t=a.getSelectedItemApp(this._selection);t&&(e=i.getOfficeIconMap(t));return e||new x.default("Page")};return e}(o.default);t.default=r});define("odsp-next/controls/fileHandler/FileHandlerCommands",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../commands/Command","../../utilities/icons/Icon","../../providers/fileHandler/FileHandlerProvider","../../actions/fileHandler/FileHandlerCreateAction","../../actions/fileHandler/FileHandlerCustomAction","../../actions/fileHandler/FileHandlerOpenAction","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,g,n,u,p,o,a,m,i,r,s,b,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(c){g.__extends(e,c);function e(e,t){var n=c.call(this,e,t)||this,o=e.sourceEngagementName,i=e.item,a=e.includeLegacyActions;n._sourceEngagementName=o;n._overrideItem=i;var r=n.observables;n._legacyCommandMap=r.create({});n._commandViewModelType=n.managed(u.CommandViewModel);n._actionMap=t.actionMap;n._customActionProvider=t.customActionProvider;n._fileHandlerProvider=t.fileHandlerProvider;n._commonParams={renderLabel:2,location:10};a&&n._loadLegacyCommandMap();n._commandMap=r.pureCompute(n._computeCommandMap);n._fullCommandMap=r.pureCompute(n._computeFullCommandMap);n._flatten=r.pureCompute(n._computeFlatten);n.newFileCommands=r.pureCompute(n._computeNewFileCommands);n.openWithCommands=r.pureCompute(n._computeOpenWithCommands);var s=r.createArray(),d=n.scope.attach(s.filter(function(e){return e.isVisible()}));n.actionsCommand=new n._commandViewModelType({text:b.strings.Actions,icon:r.pureCompute(function(){return 1<d().length?new p.default("SetAction"):void 0}),renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!0,children:s});var l=r.pureCompute(n._computeCustomCommands);r.backgroundCompute(function(){s.splice.apply(s,[0,1/0].concat(l()))});return n}e.prototype._computeNewFileCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.create.map(this._createNewFileCommand,this):[]};e.prototype._createNewFileCommand=function(e,t){var n=e.handler,o={text:e.handler.fileTypeDisplayName||d.format(b.strings.CreateFileWithExtension,e.availableOn.file.extensions[0]),action:new(this.managed(a.default))({fileHandlerAction:e}),renderLabel:2,engagementName:"FileHandlerCreate",source:this._sourceEngagementName};0===t&&(o.hasLineBreakBefore=!0);var i=this._fileHandlerProvider.getIconUrl(e.icon||n.fileTypeIcon);i?o.iconUrl=i:o.icon=new p.default("Page");return new this._commandViewModelType(o)};e.prototype._computeOpenWithCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.open.map(this._createOpenFileCommand,this):[]};e.prototype._createOpenFileCommand=function(e){var t=e.handler,n={fileHandlerAction:e};this._overrideItem&&(n.item=this._overrideItem);var o={text:e.displayName||d.format(b.strings.OpenWithFileHandler,t.displayName),collapsedText:this.createObservable(b.strings.Open),action:new(this.managed(i.default))(n),renderLabel:2,engagementName:"FileHandlerOpen",source:this._sourceEngagementName,iconUrl:this._fileHandlerProvider.getIconUrl(e.icon||t.fileTypeIcon)};return new this._commandViewModelType(o)};e.prototype._computeCommandMap=function(){for(var a=this,r=this._fileHandlerProvider,e=r?r.data().actions.custom:[],s=this._commonParams,d={},l=this.observables,t=function(e){var t=e.handler,n=t.appId,o=d[n]||(d[n]=new c._commandViewModelType(g.__assign({},s,{iconUrl:r.getIconUrl(t.appIcon),text:t.actionMenuDisplayName||t.displayName,requiredChildren:1,collapseSingleChildCommands:!0}))),i=new c._commandViewModelType(g.__assign({},s,{text:l.pureCompute(function(){return!a._flatten()&&e.shortDisplayName||e.displayName}),collapsedText:l.create(e.displayName),iconUrl:r.getIconUrl(e.icon),action:new(c.managed(m.default))({fileHandlerAction:e}),engagementName:"FileHandlerCustom",source:c._sourceEngagementName}));o.children.push(i)},c=this,n=0,o=e;n<o.length;n++){t(o[n])}return d};e.prototype._loadLegacyCommandMap=function(){var m=this,f=this._customActionProvider,h=this._actionMap;f&&h&&f.getCustomActionData().then(function(e){var t={},n=[],o=e.ContextMenu;if(o&&0!==o.length){for(var i=m._commandViewModelType,a=m.managed(h.CustomActionNavigationAction),r=m.observables,s=m._commonParams,d=0,l=o;d<l.length;d++){var c=l[d],u=g.__assign({},s,{text:c.text});if(f.isGroup(c)){var p=c.children.map(function(e){return new i({text:e.text,engagementName:"CustomActionRibbonTab",iconUrl:e.iconUrl,renderLabel:2,action:new a({customAction:e})})});n.push(new i(g.__assign({},u,{tooltip:c.tooltip,requiredChildren:1,children:r.createArray(p)})))}else n.push(new i(g.__assign({},u,{iconUrl:c.iconUrl,engagementName:"CustomActionECB",action:new a({customAction:c})})))}t["Add-ins"]=new i(g.__assign({},s,{text:b.strings.AddIns,children:r.createArray(n),requiredChildren:1}));m._legacyCommandMap(t)}})};e.prototype._computeFullCommandMap=function(){return g.__assign({},this._commandMap&&this._commandMap()||{},this._legacyCommandMap&&this._legacyCommandMap()||{})};e.prototype._computeCustomCommands=function(){var e=this._fullCommandMap(),t=[],n=[],o=this._flatten();for(var i in e){for(var a=e[i],r=a.visibleChildren(),s=0,d=r;s<d.length;s++){var l=d[s];l.parentCommand=o?void 0:a;o&&(1<l.visibleChildren().length?t:n).push(l)}!o&&a.isVisible()&&(1<r.length?t:n).push(a)}return t.concat(n)};e.prototype._computeFlatten=function(){var e=this._fullCommandMap(),t=0,n=0,o=0;for(var i in e){var a=e[i].visibleChildren().length;1<a&&o++;a&&n++;t+=a;if(0<o&&1<n&&4<t)return!1}return!0};e.dependencies=g.__assign({},n.default.dependencies,{actionMap:r.actionMap.optional,customActionProvider:s.customAction.optional,fileHandlerProvider:o.resourceKey.optional});return e}(n.default);t.FileHandlerCommands=c;t.typeResourceKey=new l.ResourceKey({name:e("module").id,factory:new l.ResolvedResourceTypeFactory(c)});t.default=c});define("odsp-next/actions/fileHandler/FileHandlerCreateAction",["require","exports","tslib","../../base/BaseItemAction","../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../resources/UtilityResourceKeys","../../dataSources/url/QueryType"],function(e,t,o,n,i,s,d,a,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="FileHandlerCreate";t._fileHandlerAction=e.fileHandlerAction;t._itemProvider=t.resources.consume(i.resourceKey);t._urlDataSource=t.resources.consume(a.url);return t}e.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this.item().key);return this._urlDataSource.isCurrentQuery(r.default.Files,e)};e.prototype.onExecute=function(e,t){var n=this,o=window.open("","_blank"),i=this._fileHandlerAction,a=i.availableOn.file.extensions[0].replace(".",""),r=this.item.peek().key;return this._itemProvider.createCustomDocument(r,a).then(function(t){return t?n.resources.consumeAsync(l.fileHandlerHelper).then(function(e){return e.invokeAction({items:[t],action:i,document:o.document})}):d.default.wrapError()}).then(function(){return d.default.wrap({resultType:s.ResultTypeEnum.Success})},function(){o.close();return d.default.wrap({resultType:s.ResultTypeEnum.Failure})})};return e}(n.default);t.FileHandlerCreateAction=c;t.default=c});define("odsp-next/actions/fileHandler/FileHandlerCustomAction",["require","exports","tslib","../../base/BaseAction","../../providers/fileHandler/FileHandlerProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../resources/UtilityResourceKeys"],function(e,t,n,o,a,r,s,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="FileHandlerCustom";var n=e.fileHandlerAction;t._fileHandlerAction=n;t._fileHandlerProvider=t.resources.consume(a.resourceKey);var o=n.availableOn;t._itemSelectionHelper=new(t.managed(s.default))({overrideItem:e.item,allowMultiSelect:!!o.allowMultiSelect,canFallback:!!o.folder});return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection();return!!e&&!!e.length&&e.every(this._acceptItemObservable,this)};e.prototype.onExecute=function(e){var n=this,o=window.open("","_blank");return this._itemSelectionHelper.resolveSelection().then(function(t){n.resources.consumeAsync(l.fileHandlerHelper).then(function(e){return e.invokeAction({items:t,action:n._fileHandlerAction,document:o.document})})}).then(function(){return d.default.wrap({resultType:r.ResultTypeEnum.Success})},function(){o.close();return d.default.wrap({resultType:r.ResultTypeEnum.Failure})})};e.prototype._acceptItemObservable=function(e){var t=e.peek(),n=this._fileHandlerAction;return!!t.graph&&(t.folder?!!n.availableOn.folder&&!t.isRootFolder:this._fileHandlerProvider.isActionForExtension(n,t.extension))};return e}(o.default);t.FileHandlerCustomAction=i;t.default=i});define("odsp-next/actions/fileHandler/FileHandlerOpenAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../providers/fileHandler/FileHandlerProvider","../../resources/UtilityResourceKeys"],function(e,t,o,n,i,a,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="FileHandlerOpen";t._fileHandlerAction=e.fileHandlerAction;t._fileHandlerProvider=t.resources.consume(s.resourceKey);t._itemSelectionHelper=new(t.managed(a.default))({overrideItem:e.item,allowMultiSelect:!1,canFallback:!1});return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,o=this._fileHandlerAction;return o?n.isActionForExtension(o,t):!!n.getDefaultOpenHandler(t)};e.prototype.onExecute=function(e){var n=this,o=window.open("","_blank");return this._itemSelectionHelper.resolveFirst().then(function(t){return n.resources.consumeAsync(d.fileHandlerHelper).then(function(e){return e.invokeAction({items:[t],action:n._fileHandlerAction||n._fileHandlerProvider.getDefaultOpenHandler(t.extension,!0),document:o.document})})}).then(function(){return r.default.wrap({resultType:i.ResultTypeEnum.Success})},function(){o.close();return r.default.wrap({resultType:i.ResultTypeEnum.Failure})})};return e}(n.default);t.FileHandlerOpenAction=l;t.default=l});define("odsp-next/controls/sharing/share/commands/ShareCommandBuilder",["require","exports","tslib","../../../../controls/commands/Command","../../../../controls/commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","../../../../utilities/icons/Icon","../Share.key","../../../../models/store/ItemsStore","../../../../base/ColorVariation","./ShareCommandKeys","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces"],function(e,t,n,o,i,p,m,a,r,s,f,d,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareFocusItemResourceKey=l.shareFocusItemResourceKey;t.copyLinkFocusItemResourceKey=l.copyLinkFocusItemResourceKey;t.copyFormLinkFocusItemResourceKey=l.copyFormLinkFocusItemResourceKey;t.shareFromDetailPaneFocusItemResourceKey=l.shareFromDetailPaneFocusItemResourceKey;var u=function(u){n.__extends(e,u);function e(e,t){void 0===t&&(t={});var n=u.call(this,e,t)||this,o=n,i=o.observables,a=o.resources,r=e.renderLabel,s=void 0===r?0:r,d=e.mode,l=e.item,c=e.engagementName;n._mode=d;n._overrideSelectedItem=l&&l.peek();n._overrideEngagementName=c;n._copyLinkShortcut=1===n._mode||3===n._mode;n._hideShareDialogOverflowButton=2===n._mode;n._actionMap=a.consume(p.actionMap);n._itemsStore=a.consume(f.resourceKey);if(m.isFeatureEnabled(m.ShareV3)){n._focusItemResourceKey=n._getShareItemResourceKey();n._itemBeingShared=a.consume(n._focusItemResourceKey);i.backgroundCompute(n._computeIsOpen)}n._renderLabel=s;n._initializeCommand();return n}e.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(o.CommandViewModel))(e)};e.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)};e.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)};e.prototype._resizeShare=function(){if(!this._registeredClear){this._registeredClear=!0;this.observables.backgroundCompute(this._computeShouldClearItem)}};e.prototype._dismissShare=function(){this._itemBeingShared(void 0)};e.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),o=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();t.backgroundCompute(function(){o.peek()?e.trackPromise(e.resources.consumeAsync(s.default.local)).done(function(e){i(e)}):o()});return this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};e.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?c.Mode.addPeople:void 0}};e.prototype._getShareItemResourceKey=function(){switch(this._mode){case 0:return t.shareFocusItemResourceKey;case 1:return t.copyLinkFocusItemResourceKey;case 2:return t.shareFromDetailPaneFocusItemResourceKey;case 3:return t.copyFormLinkFocusItemResourceKey;case 4:return l.shareFromGrantAccessItemResourceKey;default:return t.shareFocusItemResourceKey}};e.prototype._getCommandProperties=function(){var e={text:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0},t=m.isFeatureEnabled(m.ShareV3);if(4===this._mode){e.text=i.strings.grantAccess;e.icon=new r.default("PlayerSettings");e.tooltip=i.strings.grantAccessCommandLabel}else if(this._copyLinkShortcut){e.text=t?i.strings.CopyLinkCommandText:i.strings.GetLink;e.tooltip=i.strings.CopyLinkCommandTooltipV3;e.icon=new r.default("Link")}else{e.text=i.strings.Share;e.tooltip=i.strings.ShareCommandTooltipV3;e.icon=new r.default("Share");e.keys=["S"]}this._overrideEngagementName?e.engagementName=this._overrideEngagementName:this._copyLinkShortcut?e.engagementName="GetLink":e.engagementName="Share";if(t){e.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem});e.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0};e.enableRecoverFocusBinding=!1;e.beakColor=d.default.neutralLighterAlt}else this._copyLinkShortcut?e.action=new(this.managed(this._actionMap.GetLinkAction)):e.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2});return e};return e}(a.default);t.default=u});define("odsp-next/controls/sharing/share/Share.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./Share",getModule:function(){return new t.default(function(e,t){n(["./Share"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/sharing/share/commands/ShareCommandKeys",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){return{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType({}),n=t.create();o&&(n.equalityComparer=i.objectStrictEquality);return{instance:n,disposable:t}}}};t.shareFocusItemResourceKey=new o.ResourceKey({name:e("module").id+".shareFocusItem",factory:a(!0)});t.copyLinkFocusItemResourceKey=new o.ResourceKey({name:e("module").id+".copyLinkFocusItem",factory:a()});t.copyFormLinkFocusItemResourceKey=new o.ResourceKey({name:e("module").id+".copyFormLinkFocusItem",factory:a()});t.shareFromDetailPaneFocusItemResourceKey=new o.ResourceKey({name:e("module").id+".copyLinkFocusItem",factory:a()});t.shareFromGrantAccessItemResourceKey=new o.ResourceKey({name:e("module").id+".shareFromGrantAccess",factory:a()})});define("@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces",["require","exports","@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces","./enums/OutlookAvailability","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","./enums/ShareType"],function(e,t,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UpdatePermissionsRole=n.UpdatePermissionsRole;t.Mode=n.Mode;t.ClientId=n.ClientId;t.OutlookAvailability=o.default;t.PrincipalType=i.default;t.ShareType=a.default});define("@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces",["require","exports","./IUpdatePermissionsResponse","./enums/SharingLinkKind","./enums/SharingLinkType","./enums/SharingInfoType","./enums/SharingRole","./enums/AccessStatus","./enums/ClientId","./enums/Error","./enums/Mode","./enums/SharePermission","./enums/SharingAudience","./enums/SharingRoleV3"],function(e,t,n,o,i,a,r,s,d,l,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UpdatePermissionsRole=n.UpdatePermissionsRole;t.SharingLinkKind=o.SharingLinkKind;t.SharingLinkType=i.SharingLinkType;t.SharingInfoType=a.SharingInfoType;t.SharingRole=r.SharingRole;t.AccessStatus=s.AccessStatus;t.ClientId=d.default;t.Error=l.default;t.Category=l.Category;t.Mode=c.default;t.SharePermission=u.default;t.SharingAudience=p.SharingAudience;t.SharingRoleV3=m.SharingRoleV3});define("@ms/odsp-datasources/lib/interfaces/sharing/IUpdatePermissionsResponse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT"}(t.UpdatePermissionsRole||(t.UpdatePermissionsRole={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingLinkKind",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible"}(t.SharingLinkKind||(t.SharingLinkKind={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingLinkType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Network=1]="Network";e[e.Embed=3]="Embed";e[e.App=4]="App";e[e.View=5]="View";e[e.Edit=6]="Edit";e[e.Form=7]="Form";e[e.Direct=8]="Direct";e[e.Organization=9]="Organization";e[e.AppAccess=10]="AppAccess"}(t.SharingLinkType||(t.SharingLinkType={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingInfoType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Email=0]="Email";e[e.User=1]="User";e[e.Group=2]="Group";e[e.Link=3]="Link";e[e.Public=4]="Public";e[e.Friends=5]="Friends";e[e.Facebook=6]="Facebook";e[e.Application=7]="Application";e[e.GroupOwned=99]="GroupOwned"}(t.SharingInfoType||(t.SharingInfoType={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingRole",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Owner=0]="Owner";e[e.View=1]="View";e[e.Edit=2]="Edit";e[e.Submitter=3]="Submitter";e[e.CoOwner=4]="CoOwner";e[e.None=5]="None";e[e.Review=6]="Review";e[e.Custom=7]="Custom"}(t.SharingRole||(t.SharingRole={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/AccessStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=1]="none";e[e.pending=2]="pending";e[e.hasAccess=3]="hasAccess"}(t.AccessStatus||(t.AccessStatus={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/ClientId",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos"}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/Error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.authFailure=1]="authFailure";e[e.serverFailure=2]="serverFailure";e[e.invalidItem=3]="invalidItem";e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl";e[e.generic=5]="generic";e[e.objectNotSupported=6]="objectNotSupported";e[e.invalidEmail=7]="invalidEmail"}(n||(n={}));!function(e){e[e.getSharingInformation=1]="getSharingInformation";e[e.shareLink=2]="shareLink";e[e.shareObject=3]="shareObject"}(t.Category||(t.Category={}));t.default=n});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/Mode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharePermission",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.view=1]="view";e[e.edit=2]="edit"}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingAudience",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(t.SharingAudience||(t.SharingAudience={}))});define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingRoleV3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview"}(t.SharingRoleV3||(t.SharingRoleV3={}))});define("@ms/odsp-shared-sharing/lib/interfaces/enums/OutlookAvailability",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"}(n||(n={}));t.default=n});define("@ms/odsp-shared-sharing/lib/interfaces/enums/ShareType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"}(n||(n={}));t.default=n});define("odsp-next/controls/oneUp/wrs/AccessibilityMode.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new n.ResourceKey({name:e("module").id});t.default=o});define("odsp-next/actions/accessibilityMode/AccessibilityModeAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/icons/OfficeFileNameHelper"],function(e,t,o,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="AccessibilityMode";t._accessibilityMode=e.accessibilityMode;return t}e.prototype.onSelectionIsAvailable=function(e,t){return t&&t.officeBundle&&t.appMap===r.wordType};e.prototype.onExecute=function(e,t){this._accessibilityMode(!this._accessibilityMode.peek());return i.default.wrap({resultType:a.ResultTypeEnum.Success})};return e}(n.default);t.default=s});define("odsp-next/controls/oneUp/commandSets/OneUpCoreCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Commands.resx","../../commands/Command","../../../resources/ControlResourceKeys","../../../utilities/icons/Icon","knockout","../../operation/commands/OperationCommandBuilder","@ms/odsp-utilities/lib/locale/Locale","../../pdfViewer/PdfViewer.resx","../../../actions/base/wrappers/ConditionalAction"],function(e,t,n,o,s,d,l,c,u,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){n.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._legend=e.legend;t._actionMap=t.resources.consume(l.actionMap);var n=t.createPureComputed(function(){return!e.canNavigate()}),o=t.createPureComputed(function(){return e.canNavigate()&&e.areFlippersPermanent()}),i=new(t.managed(h.default))({action:e.previous,condition:e.canNavigate}),a=new(t.managed(h.default))({action:e.next,condition:e.canNavigate});t.commands.push(new(t.managed(p.default))({renderLabel:2}).command,new(t.managed(d.CommandViewModel))({text:f.strings.previousTooltip,icon:new c.default(m.default.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:o,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[m.default.isRightToLeft?"Right":"Left"],action:i}),new(t.managed(d.CommandViewModel))({text:t._legend,location:12,automationId:"oneUpPageCount",isDisabled:u.observable(!0),isHidden:n}),new(t.managed(d.CommandViewModel))({text:f.strings.nextTooltip,icon:new c.default(m.default.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:o,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[m.default.isRightToLeft?"Left":"Right"],action:a}),new(t.managed(d.CommandViewModel))({icon:new c.default("Cancel"),text:s.strings.Close,hasIconOnly:!0,renderLabel:0,action:new(t.managed(t._actionMap.OpenAction))({openRelation:2,ignoreHistory:!0,item:e.parent}),keys:["Esc"],location:12}));return t}return e}(o.default);t.default=i});define("odsp-next/actions/base/wrappers/ConditionalAction",["require","exports","tslib","../../../base/BaseAction"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="Conditional";t.isQosLogged=!1;t._action=e.action;t._condition=e.condition;return t}e.prototype.onExecute=function(e,t){return this._action.execute(e)};e.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()};return e}(n.default);t.default=i});define("odsp-next/controls/oneUp/commandSets/SlideshowCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../../../utilities/icons/Icon","../../commands/Commands.resx","../../../resources/ControlResourceKeys","knockout"],function(e,t,o,n,i,a,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r.strings,c=function(n){o.__extends(e,n);function e(e){void 0===e&&(e={});var t=n.call(this,e)||this;t._actionMap=t.resources.consume(s.actionMap);t.commands=d.observableArray([new(t.managed(i.CommandViewModel))({text:l.pauseSlideshow,renderLabel:2,icon:new a.default("Pause"),action:new(t.managed(t._actionMap.StopSlideShowAction))({})})]);return t}return e}(n.default);t.default=c});define("odsp-next/bindings/throttledClick/ThrottledClickBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){n.__extends(e,o);function e(e){var t=o.call(this,e)||this,n=e.valueAccessor();t._callback=n.callback;t._delay=n.delay||500;t.events.on(t.element,"click",t._onClick);return t}e.prototype._onClick=function(e){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}else this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)};e.prototype._onClickTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return e}(o.default);t.default=i});define("odsp-next/utilities/ui/FullScreen",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(){}t.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement};t.enterFullScreen=function(){var e=window.document.body;t.isFullScreen()||(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())};t.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()};t.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled};return t}();t.default=n});define("odsp-next/controls/commands/SelectableCommandSet",["require","exports","tslib","./BaseCommandSet","@ms/odsp-shared/lib/utilities/knockout/Translators"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._commandSet=e.commandSet;t.overflowHostCommand=t._commandSet.peek().overflowHostCommand||t.overflowHostCommand;t.createComputed(function(){t._commandsSubscription&&t._commandsSubscription.dispose();t._commandSet().commands&&(t._commandsSubscription=i.replicateArray(t._commandSet().commands,t.commands))});return t}return e}(n.default);t.default=a});define("odsp-next/controls/oneUp/logging/OneUpCarousel.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OneUpCarousel=n.createPairedEvent({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:1,initialFileExtension:1,initialFileSize:2,pagesViewed:2,totalPages:2,isFolderShownInSession:3});t.default=t.OneUpCarousel});define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./LegacyDetailsPaneHost",getModule:function(){return new t.default(function(e,t){n(["./LegacyDetailsPaneHost"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/OneUpSlide",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OneUpSlideViewModel","./OneUpSlide.html","./OneUpSlide.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-one-up-slide",template:e("./OneUpSlide.html"),viewModel:o.default,synchronous:!0});t.default=i});define("odsp-next/controls/oneUp/OneUpSlideViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/engagement/Engagement","../../bindings/component/ControlBinding","../../utilities/features/Features","./photo/OneUpPhoto","./thumbnail/OneUpThumbnail","./video/OneUpVideo.key","./panorama/OneUpPanorama.key","./pdf/OneUpPdf.key","./zip/OneUpZip.key","./error/OneUpError","./3d/OneUp3d.key","./html/OneUpHtml","./other/OneUpOther","./fileHandler/OneUpFileHandler.key","./wrs/OneUpWrs.key","./textFile/OneUpTextFile.key","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../providers/fileHandler/FileHandlerProvider","../../utilities/mime/MimeHelper"],function(e,t,v,n,s,w,_,d,i,o,a,r,l,c,u,p,m,f,h,g,b,y,x,C,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P={"3d":m.default,Error:p.default,FileHandler:g.default,Html:f.default,Other:h.default,Panorama:l.default,Pdf:c.default,Photo:o.default,TextFile:y.default,Thumbnail:a.default,Video:r.default,Wrs:b.default,Zip:u.default},S=function(r){v.__extends(e,r);function e(e,t){var n=r.call(this,e,t)||this;n.addBindingHandlers({control:d.default});n._offset=e.slide.offset;n._oneUp=e.oneUp;var o=e.renderOptions,i=n.observables,a=i.createCallback(s.forSingleValue());e.loadResult&&n.scope.attach(e.loadResult.register(a));n._slide={loadState:e.slide.loadState,offset:n._getSlideOffset(),item:e.slide.item,isIdleEnabled:i.create(!0),isEditCaptionEnabled:i.create(!1),isPanningEnabled:i.create(!o),hasHorizontalScrollbar:i.create(!1),hasVerticalScrollbar:i.create(!1),isFirstSlideOpened:i.create(!1),commandSet:i.create(),loadResult:a,renderOptions:o};n._fileHandlerProvider=n.resources.consume(C.resourceKey.optional);n._extension=i.pureCompute(n._computeExtension);n._hasFileHandler=i.pureCompute(n._computeHasFileHandler);n.name=i.pureCompute(n._computeName);n.key=i.pureCompute(n._computeKey);n.key.equalityComparer=x.objectStrictEquality;n.component=i.pureCompute(n._computeComponent);n._qos=i.compute(n._computeQos);i.compute(n._computeUpdateOneUpSlide);i.backgroundCompute(n._computeCompleteQos);return n}e.prototype.dispose=function(){r.prototype.dispose.call(this);this._oneUp.slide.peek()===this._slide&&this._oneUp.slide(void 0)};e.prototype._computeComponent=function(){var e=this.key(),t={slide:this._slide,oneUp:this._oneUp};return e&&d.toSpecification(e.bypass,t)};e.prototype._computeName=function(){var e=this._slide.item(),t=this._extension(),n=(this._slide.renderOptions||{}).viewer,o=i.isFeatureEnabled(i.UseSandboxHtmlViewer)&&"srcdoc"in HTMLIFrameElement.prototype;return!e||e.isPlaceholder?void 0:e.error?"Error":3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":this._hasFileHandler()?"FileHandler":o&&e.htmlConversion?"Html":i.isFeatureEnabled(i.UseWebPdfViewer)&&(".pdf"===t||".ai"===t||e.pdfConversion)?"Pdf":e.video||e.audio&&i.isFeatureEnabled(i.EnableAudioPlayer)?"Video":e.panorama?"Panorama":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")};e.prototype._computeKey=function(){var e=this.name();return P[e]};e.prototype._useTextEditor=function(e){return i.isFeatureEnabled(i.UseOneUpTextEditor)&&O.canOpenItemInMonaco(e)};e.prototype._computeExtension=function(){var e=this._slide.item();return e&&e.extension&&e.extension.toLowerCase()};e.prototype._computeHasFileHandler=function(){var e=this._fileHandlerProvider;return!!e&&(!!this._slide.item().graph&&!!e.getDefaultPreviewHandler(this._extension()))};e.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this._slide&&this._oneUp.slide(void 0):this._oneUp.slide(this._slide)};e.prototype._getSlideOffset=function(){var t=this,n=this.createPureComputed(function(){var e=n.peek();return void 0!==e&&t._oneUp.isRotating()?e:t._offset()});return n};e.prototype._computeQos=function(){var e=this._slide,t=this._qosValue,n=this.name();if(n){if(t&&t.loaded.data.extraData.viewer===n)return t;if(!e.offset()&&!(0<e.loadState()||e.loadResult())){var o=e.item.peek().size,i=e.renderOptions,a=i&&i.qosEvent,r=v.__assign({},a&&a.data.extraData||{},{viewer:n,extension:this._extension.peek(),fileSize:o,fileSizeRange:U(o)});return this._qosValue={loaded:new w.Qos({name:"LoadSlide",extraData:r}),loaded2:new w.Qos({name:"ItemViewer."+n+".Load",extraData:r}),rendered:new w.Qos({name:"ItemViewer."+n+".Render",extraData:r})}}}};e.prototype._computeCompleteQos=function(){var e=this._slide;if(!e.offset()){var t=this._qos()||{},n=t.loaded,o=t.loaded2,i=t.rendered;if(n){var a=this.name(),r={extension:this._extension(),fileSizeRange:U(e.item.peek().size),viewer:a},s=this.key(),d=e.loadState();s&&1<=d&&i.end({resultType:w.ResultTypeEnum.Success,extraData:v.__assign({},i.data.extraData,r)});var l=e.loadResult();if(s&&l){var c=function(e){e&&(e=(e=e.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*"));return e}(l.error),u=v.__assign({},l,{error:c}),p=e.renderOptions,m=p&&p.qosEvent,f=v.__assign({},n.data.extraData,r),h=v.__assign({},u,{extraData:f});n.end(h);o.end(h);m&&m.end(h);if(this._oneUp.shareLinkId){var g={};try{g.previewLoaded=Date.now();g.navigationStart=performance.timing.navigationStart;g.redirectStart=performance.timing.redirectStart;g.redirectEnd=performance.timing.redirectEnd}catch(e){}var b=v.__assign({},u,f,g,{slrid:this._oneUp.shareLinkId});this.resources.consume(_.resourceKey).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:b})}}}}};return e}(n.default);t.default=S;function U(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return(1<<t%10)+"-"+(1<<t%10+1)+(t<10?" B":" "+"KMGTPEZY"[t/10-1|0]+"iB")}});define("odsp-next/controls/oneUp/photo/OneUpPhoto",["require","exports","./OneUpPhotoViewModel","../../../bindings/component/ControlBinding","./OneUpPhoto.html","../../projector/Projector","../thumbnail/OneUpThumbnail"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-photo",name:e("module").id,template:e("./OneUpPhoto.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/photo/OneUpPhotoViewModel",["require","exports","tslib","../../../bindings/component/ControlBinding","../thumbnail/OneUpThumbnail","../OneUpContentViewModel","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,s,d,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(a){n.__extends(e,a);function e(e,t){var n=a.call(this,e,t)||this;n.addBindingHandlers({control:s.default});n.slide.isEditCaptionEnabled(!0);var o=e.item,i=void 0===o?n.slide.item:o;n._item=i;n._isZoomed=n.createObservable(!1);n.projectorParams={isEnabled:n.createPureComputed(function(){return!n.slide.offset()&&!n.oneUp.isRotating()}),isZoomed:n._isZoomed};n.createBackgroundComputed(n._computeChangesOnZoom);return n}e.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,o=e.isGliding,i=this.createPureComputed(function(){return n().scale}),a=this.createPureComputed(function(){return{width:t.oneUp.size().width*n().scale,height:t.oneUp.size().height*n().scale}});a.equalityComparer=l.deepCompare;var r=this.createPureComputed(function(){return!o()});return s.toSpecification(d.default,{slide:this.slide,oneUp:this.oneUp,size:a,scale:i,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:r,item:this._item})};e.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,o=e.height;if(t)return{url:t,width:n,height:o}}};e.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)};return e}(o.default);t.default=i});define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnail",["require","exports","./OneUpThumbnailViewModel","../../../bindings/component/ControlBinding","./OneUpThumbnail.html","../../image/frame/ImageFrame"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-thumbnail",name:e("module").id,template:e("./OneUpThumbnail.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnailViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/Rotation","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-shared/lib/utilities/knockout/Extenders","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/object/ObjectUtil","../../../bindings/component/ControlBinding","../../image/frame/ImageFrame","../other/OneUpOther","../OneUpContentViewModel"],function(e,t,y,n,x,o,C,i,O,P,S,U,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(_){y.__extends(e,_);function e(e,t){var n=_.call(this,e,t)||this;n.addBindingHandlers({control:P.default});n.thumbnailTagName=S.default.tagName;var o=n.observables,i=e.slide.renderOptions,a=e.scale,r=void 0===a?o.create(1):a,s=e.size,d=void 0===s?n.oneUp.size:s,l=e.allowLoading,c=void 0===l?o.create(!0):l,u=e.fallbackThumbnail,p=e.showErrorActions,m=void 0===p?!i||!i.hideDownload:p,f=e.allowError,h=void 0===f||f,g=e.item,b=void 0===g?n.slide.item:g;n._item=b;n._scale=r;n._size=d;n._fallbackThumbnail=u;n._allowError=o.wrap(h);n._isLoaded=o.create(!1);n._isRendered=o.create(!1);o.backgroundCompute(n._updateSlideLoadState);n._image=o.pureCompute(n._computeImage);n._image.equalityComparer=O.deepCompare;n._rotation=o.pureCompute(n._computeRotation);n._error=o.create();n._fadeIn=o.pureCompute(function(){return Math.abs(n.slide.offset())<2});n._allowLoading=o.pureCompute(function(){var e=c(),t=n.oneUp.isRotating();return e&&!t});n._coverage=C.withComparer(o.pureCompute(n._computeImageFrameCoverage),O.deepCompare);n.hasThumbnail=o.pureCompute(n._computeHasThumbnail);n.thumbnailParams=o.pureCompute(n._computeThumbnailParams);n.hasError=o.pureCompute(n._computeHasError);var v=y.__assign({},e,{showActions:m,slide:y.__assign({},e.slide,{loadResult:o.createCallback(x.forSingleValue())})});n.fallbackControl=P.toSpecification(U.default,v);var w=n._result=o.pureCompute(n._computeResult);n.scope.attach(e.slide.loadResult.register(w));return n}e.prototype._computeImage=function(){var e=this._item();return(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail)};e.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:n.default.none};e.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25);return{minimum:0,maximum:1,fallback:e}};e.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())};e.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=t.code;return{resultType:n?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:i.ResultTypeEnum.Success}:void 0};e.prototype._computeHasError=function(){var e=this.hasError.peek();e||(e=this._allowError()&&!!this._error());return e};e.prototype._computeThumbnailParams=function(){var e;this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._size,scale:this._scale,error:this._error,alignment:o.AlignmentType.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading});return e};e.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(2):this._isRendered()&&e(1)};return e}(a.default);t.default=r});define("odsp-next/controls/oneUp/other/OneUpOther",["require","exports","./OneUpOtherViewModel","../../../bindings/component/ControlBinding","./OneUpOther.html"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-other",name:e("module").id,template:e("./OneUpOther.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/other/OneUpOtherViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/activate/ActivateBinding","../../../bindings/component/ControlBinding","../OneUpContentViewModel","../OneUp.resx","../../fileTypeIcon/FileTypeIcon","./commands/ItemActionBar.key","../../../models/malwareDetection/MalwareDetection.key"],function(s,e,t,n,d,l,c,o,u,p,m,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',a=function(r){t.__extends(e,r);function e(t,e){var n=r.call(this,t,e)||this;n.strings=u.strings;n.addBindingHandlers({activate:l.default,control:c.default});var o=t.slide.renderOptions,i=t.showActions,a=void 0===i?!o||!o.hideDownload:i;n.showActions=a;n._allowInfectedDownload=e.allowInfectedDownload;n.malwareDetectedSvgUrl="undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/images/atp/malware_icon_208x208.svg"):s("@ms/odsp-media/dist/media/images/atp/malware_icon_208x208.svg");n.malwareDetectedIconAlt=u.strings.malwareDetectedIconAriaLabel;n.itemMalwareDetected=n.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0});n.fileTypeIconTagName=p.default.tagName;n.fileName=n.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0});n.fileTypeIconViewModelParams=n.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:96}},{deferEvaluation:!0});n.actionBarControl=c.toSpecification(m.resourceKey,{forceExternal:!!o,item:t.slide.item,hideOpenCommand:n.itemMalwareDetected});n.message=n.createPureComputed(function(){var e=t.slide.item();return n.itemMalwareDetected()?n._allowInfectedDownload?d.format(u.strings.malwareDetectedAllowDownloadMessage,f,"</a>"):d.format(u.strings.malwareDetectedMessage,f,"</a>"):3===e.itemStatus?u.strings.blockedByPolicy:u.strings.notPreviewAvaible});return n}e.prototype.activate=function(){var e=this.observables.create({resultType:n.ResultTypeEnum.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}),t=this.slide;this.scope.attach(t.loadResult.register(e));t.loadState(2)};e.dependencies=t.__assign({},o.default.dependencies,{allowInfectedDownload:i.allowInfectedFileDownloadsResourceKey});return e}(o.default);e.default=a});define("odsp-next/bindings/activate/ActivateBinding",["require","exports","knockout"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.init=function(e,t,n,o,i){var a=s.utils.unwrapObservable(t()),r=a&&a.activate||a;r&&r.call(i.$data,e)};e.supportsVirtualElements=!0;return e}();t.default=n});define("odsp-next/controls/oneUp/OneUpContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){n.__extends(e,o);function e(e,t){var n=o.call(this,e,t)||this;n.slide=e.slide;n.oneUp=e.oneUp;return n}return e}(o.default);t.default=i});define("odsp-next/controls/oneUp/other/commands/ItemActionBar.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:n("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./ItemActionBar",getModule:function(){return new t.default(function(e,t){n(["./ItemActionBar"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/models/malwareDetection/MalwareDetection.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allowInfectedFileDownloadsResourceKey=new n.ResourceKey({name:e("module").id+".allowInfectedFileDownloads",factory:new n.ConstantResourceFactory(!1)})});define("odsp-next/controls/oneUp/other/OneUpOther.html",[],function(){return'<div class=OneUp-other data-bind="activate: $component.activate.bind($component)"><div class=OneUp-other-content>\x3c!--ko if: itemMalwareDetected()--\x3e<div><img class=OneUp-other-malwareDetectedIcon data-bind="attr: { src: malwareDetectedSvgUrl, alt: malwareDetectedIconAlt }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: itemMalwareDetected()--\x3e<div class=OneUp-other-fileIcon data-bind="component: { name: fileTypeIconTagName, params: fileTypeIconViewModelParams }"></div>\x3c!--/ko--\x3e<div class=OneUp-other-fileName data-bind="text: fileName"></div><div class=OneUp-other-message data-bind="html: message"></div>\x3c!--ko if: showActions--\x3e<div class=OneUp-other-actions data-bind="control: actionBarControl"></div>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnail.html",[],function(){return"\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !hasError() && hasThumbnail()--\x3e\x3c!--ko component: {\r\n name: thumbnailTagName,\r\n params: thumbnailParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/oneUp/photo/OneUpPhoto.html",[],function(){return"<div class=OneUp-photo data-bind=\"component: { name: 'od-projector', params: projectorParams }\">\x3c!--ko control: getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/projector/Projector",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ProjectorViewModel","./Projector.html","./Projector.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-projector",template:e("./Projector.html"),viewModel:o.default,synchronous:!0});t.default=i});define("odsp-next/controls/projector/ProjectorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding","../../bindings/pan/PanBinding","../../bindings/clientRect/ClientRectBinding","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-utilities/lib/math/Size","@ms/odsp-utilities/lib/math/Point","@ms/odsp-shared/lib/utilities/knockout/Extenders"],function(e,t,n,o,p,m,f,h,s,d,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b,c=new s.default(0,0,1,1),v=c.getCenter(),i=100;!function(e){e[e.live=0]="live";e[e.preview=1]="preview"}(b=t.ProjectorMode||(t.ProjectorMode={}));var a=function(u){n.__extends(e,u);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=u.call(this,e,t)||this;n.addBindingHandlers({host:p.default,pan:m.default,clientRect:f.default});var o=e.isZoomed,i=void 0===o?n.createObservable(!1):o,a=e.isEnabled,r=void 0===a?n.createObservable(!0):a,s=e.mode,d=void 0===s?b.live:s;n.panTransform=n.createObservable(h.default.IDENTITY);n.panTransform.equalityComparer=m.areTransformsEqual;n.contentTransform=n.createObservable(h.default.IDENTITY);n.contentTransform.equalityComparer=m.areTransformsEqual;n.imageTransform=n.createObservable(h.default.IDENTITY);n.imageTransform.equalityComparer=m.areTransformsEqual;n.isPanning=n.createObservable(!1);n.isGliding=n.createObservable(!1);n.isZoomed=i;n.isEnabled=r;n.size=n.createObservable();n._lastZoomTogglePosition=null;n._mode=d;n.mode=b[n._mode];n.createBackgroundComputed(n._computeResetGlide);n.createBackgroundComputed(n._computePreviewTransform);n.createBackgroundComputed(n._computeCommitTransform);var l=n.createBackgroundComputed(n._computeStartGlide);n.createBackgroundComputed(n._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var c=n.createBackgroundComputed(n._computeApplyTransformOnZoomed);n.createBackgroundComputed(n._computeResetZoomOnTransformed);n.imageStyle=n.createPureComputed(n._computeImageStyle,{deferEvaluation:!0});if(!t||!t.disableFrameSkip){g.skipAnimationFrame(l,n.async);g.skipAnimationFrame(c,n.async)}n.host={transform:n._mode===b.live?n.panTransform:n.contentTransform,isGliding:n.isGliding};return n}e.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),o=n&&new l.default(t.clientX/n.width,t.clientY/n.height)||v;this._lastZoomTogglePosition=o;this.isZoomed(!this.isZoomed())};e.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(10<=Math.abs(t)&&2<=n.length||this.isZoomed.peek()&&10<=e.translate.abs())};e.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))};e.prototype._computeResetGlide=function(){if(this.isPanning()){this.isGliding(!1);this.isZoomed(!0)}};e.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=r(e,!0);this.imageTransform(this.contentTransform().invert().multiply(e))}};e.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<h.default.IDENTITY.scale?h.default.IDENTITY:r(e);this._applyTransform(e)}};e.prototype._computeStartGlide=function(){if(!this.isPanning()&&!h.default.areEqual(this.imageTransform(),h.default.IDENTITY)){this.isGliding(!0);this.imageTransform(h.default.IDENTITY)}};e.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)};e.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),o=this.contentTransform.peek();n||(e&&t?h.default.areEqual(o,h.default.IDENTITY)&&this._applyTransform(h.default.zoom(l.default.ORIGIN,this._lastZoomTogglePosition||v,3)):h.default.areEqual(o,h.default.IDENTITY)||this._applyTransform(h.default.IDENTITY));this._lastZoomTogglePosition=null};e.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&h.default.areEqual(t,h.default.IDENTITY)&&this.isZoomed(!1)};e.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===b.live){var n=e.multiply(t);return{left:n.translate.x*i+"%",top:n.translate.y*i+"%",width:n.scale*i+"%",height:n.scale*i+"%"}}var o="translate("+t.translate.x*i+"%, "+t.translate.y*i+"%)";return{left:e.translate.x*i+"%",top:e.translate.y*i+"%",width:e.scale*i+"%",height:e.scale*i+"%","-ms-transform":o,"-webkit-transform":o,transform:o}};e.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e);this.imageTransform(e.invert().multiply(t));this.panTransform(e)};return e}(o.default);t.default=a;function r(e,t){void 0===t&&(t=!1);var n=Math.max(h.default.IDENTITY.scale,e.scale),o=new s.default(e.apply(v).subtract(new l.default(n,n).scale(.5)),new d.default(n,n)),i=c,a=i.nudge(o),r=i.getCenter().subtract(a.getCenter());t&&(r=r.unit().scale(r.abs()-Math.atan(Math.PI*r.abs())/Math.PI*Math.log(e.scale/h.default.IDENTITY.scale)));return new h.default(r).multiply(e)}});define("odsp-next/controls/projector/Projector.html",[],function(){return"<div class=od-Projector data-bind=\"class: 'od-Projector--' + mode, css: { 'od-Projector--gliding': isGliding, 'od-Projector--panning': isPanning }, pan: { isActive: isPanning, transform: panTransform, mayStartPan: $component.mayStartPan.bind($component), constrainScale: $component.constrainPanScale.bind($component) }, clientRect: { size: size }, event: { dblclick: $component.toggleIsZoomed.bind($component) }\"><div class=od-Projector-image data-bind=\"style: imageStyle, host: { data: host }\"></div></div>"});define("odsp-next/controls/projector/Projector.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;-ms-transform-origin:0 0;transform-origin:0 0;-ms-touch-action:none;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/oneUp/video/OneUpVideo.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpVideo",getModule:function(){return new t.default(function(e,t){n(["./OneUpVideo"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/panorama/OneUpPanorama.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpPanorama",getModule:function(){return new t.default(function(e,t){n(["./OneUpPanorama"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/pdf/OneUpPdf.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(n,e,t,o,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a.default.addConfig({map:{"*":{"../build/pdf.js":"pdfjs-dist/build/pdf"}}});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpPdf",getModule:function(){return new t.default(function(e,t){n(["./OneUpPdf"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/zip/OneUpZip.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpZip",getModule:function(){return new t.default(function(e,t){n(["./OneUpZip"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/error/OneUpError",["require","exports","./OneUpErrorViewModel","../../../bindings/component/ControlBinding","./OneUpError.html"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-error",name:e("module").id,template:e("./OneUpError.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/error/OneUpErrorViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../OneUpContentViewModel","../../error/Error","../../../bindings/component/ControlBinding"],function(e,t,n,i,o,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(d){n.__extends(e,d);function e(e,t){var n=d.call(this,e,t)||this;n.addBindingHandlers({control:c.default});var o=e.slide.item.peek(),i=o&&o.error&&o.error.data,a=e.slide.renderOptions,r=e.showErrorActions,s=void 0===r||r;n.errorComponent={specification:c.toSpecification(l.resourceKey,{error:i,hideAction:!!a||!s}),afterRender:function(){return n._activate()}};return n}e.prototype._activate=function(){var e=this.slide,t=e.item.peek(),n=t&&t.error&&t.error.data,o=this.observables.create({resultType:i.ResultTypeEnum.Failure,resultCode:""+n.errorCode,error:n&&n.errorDetailedText,extraData:{CorrelationId:n&&n.correlationId}});this.scope.attach(e.loadResult.register(o));e.loadState(2)};return e}(o.default);t.default=a});define("odsp-next/controls/oneUp/error/OneUpError.html",[],function(){return'<div class=OneUp-error data-bind="control: errorComponent"></div>'});define("odsp-next/controls/oneUp/3d/OneUp3d.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUp3d",getModule:function(){return new t.default(function(e,t){n(["./OneUp3d"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/html/OneUpHtml",["require","exports","./OneUpHtmlViewModel","../../../bindings/component/ControlBinding","./OneUpHtml.html","./OneUpHtml.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-html",name:e("module").id,template:e("./OneUpHtml.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/html/OneUpHtmlViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/xhr/XHRPromise","../OneUpContentViewModel","../../../models/item/FileContentHelper","../../../bindings/iframe/IFrameBinding","../../../bindings/component/ControlBinding","../thumbnail/OneUpThumbnail","../../../resources/DataSourceResourceKeys"],function(e,t,n,o,a,r,s,d,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){n.__extends(e,i);function e(e,t){var n=i.call(this,e,t)||this;n.addBindingHandlers({control:l.default,iframe:d.default});n.thumbnailControl=l.toSpecification(c.default,e);n.iframeOptions=n.createObservable();n.showHtml=n.createPureComputed(n._computeShowHtml);n._downloadDataSource=t.downloadDataSource;var o=n._loadResult=n.observables.create();n.scope.attach(n.slide.loadResult.register(o));n._populateContent();return n}e.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()};e.prototype._populateContent=function(){var t=this,e=this.slide.item();this.trackPromise(this._getContents(e).then(function(e){e?t.iframeOptions({type:"content",sandbox:"",content:e,onLoad:function(){t.slide.loadState(2);t._loadResult({resultType:o.ResultTypeEnum.Success})}}):t._showThumbnail()},function(){t._showThumbnail()}))};e.prototype._showThumbnail=function(){this.slide.loadState(2)};e.prototype._getContents=function(e){var t=e.htmlConversion;return t&&t.url?a.default.start({url:t.url}).then(function(e){return e.responseText}):this._downloadDataSource.getItemContents(e).then(function(e){return s.quickParse(e,"text/html")}).then(function(e){return e.text})};e.dependencies=n.__assign({},r.default.dependencies,{downloadDataSource:u.download});return e}(r.default);t.default=i});define("odsp-next/models/item/FileContentHelper",["require","exports","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullParse=function(e,i,t){return n.default.all([o(e),o(e,t)]).then(function(e){var t=e[0],n=e[1],o=n.length>t.length;return{text:o?t:n,mimeType:i,isSafeText:o||function(e){for(var t=0;t<e.length;t++)if(!((n=e.charCodeAt(t))<127||a[n]))return!1;var n;return!0}(n)}})};t.quickParse=function(e,t){return o(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})};function o(e,t){var n=new i.default,o=new FileReader;o.onload=function(){n.complete(o.result)};o.readAsText(e,t);return n.getPromise()}var a={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}});define("odsp-next/bindings/iframe/IFrameBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout","../../actions/NavigateViaPost"],function(e,t,o,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.controlsDescendantBindings=!0;t.createComputed(t._computeUpdate);return t}e.prototype._computeUpdate=function(){var e=this,t=this.unwrapObservable(this.valueAccessor());if(t){var n,o,i;switch(t.type){case"get":if(t.url){i=!0;o=function(e){e.src=t.url}}break;case"content":i=!0;o=function(e){e.srcdoc=t.content};break;case"post":if(t.url){i=!0;n=function(e){s.navigateViaPost({url:t.url,postdata:t.postdata,document:e.contentDocument})}}}var a=i&&(this._iframe||document.createElement("iframe"));!function(e,t){if(e){t.className&&(e.className=t.className);t.title&&(e.title=t.title);t.role&&e.setAttribute("role",t.role);"string"==typeof t.sandbox&&e.setAttribute("sandbox",t.sandbox);e.frameBorder="0"}}(a,t);o&&o(a);if(a&&!this._iframe){this._iframe=a;this.events.on(a,"load",this._onLoad);r.virtualElements.setDomNodeChildren(this.element,[a]);r.utils.domNodeDisposal.addDisposeCallback(a,function(){e.events.off(a,"load",e._onLoad);!function(e){e.src="";e.srcdoc=""}(a)})}n&&n(a);if(a);else{r.virtualElements.emptyNode(this.element);this._iframe=void 0}}else{r.virtualElements.emptyNode(this.element);this._iframe=void 0}};e.prototype._onLoad=function(e){var t=this.peekUnwrapObservable(this.valueAccessor());t.onLoad&&t.onLoad(e)};e.supportsVirtualElements=!0;return e}(n.default);t.IFrameBinding=i;t.default=i});define("odsp-next/actions/NavigateViaPost",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url;n.method="POST";n.style.visibility="hidden";n.target="_self";var o=e.postdata;for(var i in o){var a=t.createElement("input");a.type="hidden";a.name=i;a.value=o[i];n.appendChild(a)}t.body.appendChild(n);n.submit()}});define("odsp-next/controls/oneUp/html/OneUpHtml.html",[],function(){return'\x3c!--ko ifnot: showHtml--\x3e\x3c!--ko control: thumbnailControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showHtml--\x3e<div class=OneUp-html data-bind="iframe: iframeOptions"></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/oneUp/html/OneUpHtml.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 10%}.OneUp-html iframe{width:100%;height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15)}"}])});define("odsp-next/controls/oneUp/fileHandler/OneUpFileHandler.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpFileHandler",getModule:function(){return new t.default(function(e,t){n(["./OneUpFileHandler"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/wrs/OneUpWrs.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpWrs",getModule:function(){return new t.default(function(e,t){n(["./OneUpWrs"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/textFile/OneUpTextFile.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./OneUpTextFile",getModule:function(){return new t.default(function(e,t){n(["./OneUpTextFile"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/oneUp/OneUpSlide.html",[],function(){return'<div class=OneUp-slide data-bind="control: component" role=presentation></div>'});define("odsp-next/controls/oneUp/OneUpSlide.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:'';background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.OneUp-photo .od-ImageStack-tile{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"}])});define("odsp-next/controls/oneUp/ToolbarProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../providers/transclusion/TransclusionProvider"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:""+e("module").id,factory:o.factory})});define("odsp-next/controls/infoPane/FocusedInfoPaneSection.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.focusedInfoPaneSectionResourceKey=new o.ResourceKey({name:""+e("module").id,factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(void 0),disposable:t}}}})});define("odsp-next/controls/oneUp/OneUp.html",[],function(){return'<div class=OneUp data-bind="css: { \'OneUp--hasInfoPane\': isInfoPaneExpanded, \'OneUp--awake\': isAwake, \'OneUp--panningEnabled\': isPanningEnabled, \'OneUp--hasItems\': items().length, \'OneUp--hasCommandBar\': isCommandBarVisible, \'OneUp--slideShowOn\': isSlideShowModeEnabled }" role=presentation><div class=OneUp-commandBar data-bind="hideWhenInactive, control: commandBarSpecification"></div><div class=OneUp-content data-bind="hideWhenInactive, clientRect: { size: size }" role=presentation><div class=OneUp-carousel data-bind="component: { name: carouselTagName, params: { item: item, items: items, canNavigate: canNavigate, allocationRange: allocationRange, loadState: slideLoadState, isEnabled: isPanningEnabled, isRotating: isRotating } }, idle: { isIdle: isIdle, isEnabled: isIdleEnabled }, throttledClick: { callback: $component.onContentClicked.bind($component)}, automation: \'carousel\'" role=presentation>\x3c!--ko component: {\r\n name: $component.oneUpSlideTagName,\r\n params: {\r\n slide: $host,\r\n oneUp: $component.oneUp\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</div><div class=OneUp-detailsBar data-bind="css: { \'OneUp-detailsBar--hasCaption\': showEditCaption }, style: detailsBarStyle, childFocus: isDetailsFocused" role=presentation>\x3c!--ko if: showEditCaption--\x3e<div class=OneUp-caption-container>\x3c!--ko if: updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click: editCaption, css: { \'OneUp-caption--existing\': caption }"><span data-bind="text: caption() || addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot: updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text: caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: $component.toolbarProvider.contexts().length--\x3e<div class=OneUp-agent data-bind="component: { name: transclusionHostTagName, params: { provider: $component.toolbarProvider } }"></div>\x3c!--/ko--\x3e</div></div><div class=OneUp-paneHost data-bind="hideWhenInactive, template: { if: isInfoPaneExpanded, beforeRemove: $component.onExitInfoPane.bind($component) }" role=presentation><div class=OneUp-infoPane data-bind="control: infoPaneSpecification"></div></div>\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/oneUp/OneUp.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.OneUp-detailsBar{visibility:hidden;opacity:0}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:visibility 267ms linear,top 267ms linear}.lg .OneUp-commandBar,.xlg .OneUp-commandBar,.xxlg .OneUp-commandBar,.xxxlg .OneUp-commandBar,.xxxxlg .OneUp-commandBar{height:40px;top:-40px}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:#2b579a;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:#217346;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:#d24726;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Excel:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.CommandBar-center{text-align:center}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.lg .OneUp--hasCommandBar .OneUp-content,.lg .OneUp--hasCommandBar .OneUp-paneHost,.xlg .OneUp--hasCommandBar .OneUp-content,.xlg .OneUp--hasCommandBar .OneUp-paneHost,.xxlg .OneUp--hasCommandBar .OneUp-content,.xxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxlg .OneUp--hasCommandBar .OneUp-content,.xxxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxxlg .OneUp--hasCommandBar .OneUp-content,.xxxxlg .OneUp--hasCommandBar .OneUp-paneHost{top:40px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;background-color:rgba(255,255,255,.75)}.OneUp-caption{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-ms-flex:1 1 auto;flex:1 1 auto;max-width:600px;height:30px;border:0;padding:0;background:0 0;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}"}])});define("odsp-next/controls/oneUp/3d/OneUp3d",["require","exports","./OneUp3dViewModel","../../../bindings/component/ControlBinding","./OneUp3d.html","./OneUp3d.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-3d",name:e("module").id,template:e("./OneUp3d.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/3d/OneUp3dViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/resources/Resources","../../../bindings/component/ControlBinding","../../../bindings/element/ElementBinding","../OneUpContentViewModel","../../../resources/DataSourceResourceKeys","../ToolbarProvider.key","../OneUp.resx","../other/OneUpOther","../../loadingSpinner/LoadingSpinner","../../../utilities/browser/ResponsiveUI"],function(s,e,d,l,b,v,c,t,w,n,o,u,p,i,a,m,f,h,g,_){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n.default.addShims({spectre:{exports:"SPECTRE"}});var y=new o.ResourceKey({name:"spectre",loader:{load:function(){return t.loadModule({path:"spectre",getModule:function(){return new b.default(function(e,t){s(["spectre"],e,t)})}}).then(function(){return new o.ConstantResourceFactory(void 0)})}}});function x(e,t,n){var o=new Error(n);o.code=t;o.isExpected=e;return o}var r=function(r){d.__extends(e,r);function e(e,t){var n=r.call(this,e,t)||this,o=n.observables,i=e.slide;n.fallbackControl=u.toSpecification(h.default,d.__assign({},e,{slide:d.__assign({},i,{loadResult:o.createCallback(l.forSingleValue())})}));n.strings=f.strings;n.isPanningEnabled=e.slide.isPanningEnabled;n.toolbarProvider=t.toolbarProvider;n.has3dLoaded=o.create(!1);n.addBindingHandlers({control:u.default,element:p.default});n.isSlideCurrent=o.pureCompute(function(){return!n.slide.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});n.hasError=o.create(!1);n.loadingSpinnerTagName=g.default.tagName;n.loadingSpinnerParams=o.pureCompute(n._computeLoadingSpinnerParams,{deferEvaluation:!0});n.loadingContainerStyle={bottom:_.default.getScrollbarWidth()+"px"};n.container=o.create(null);i.loadState(1);o.backgroundCompute(n._computeIsFirstSlideOpened);o.backgroundCompute(n._computeSizeChanged);var a=o.create();e.slide.loadResult.register(a);n._graphDataSource=t.graphDataSource;o.backgroundCompute(function(){var e=n.container();if(e&&n.isSlideCurrent()){n._viewer||(n._viewer=n.scope.attach(new SPECTRE.Viewer(e,{unifiedConfiguration:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/fbx/remix3dsettings.json"):s("!file-loader!@ms/odsp-media/dist/media/fbx/remix3dsettings.json"),backgroundModel:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/fbx/backdrop_flat.cool"):s("!file-loader!@ms/odsp-media/dist/media/fbx/backdrop_flat.cool"),environmentMap:"undefined"==typeof __webpack_public_path__?s.toUrl("@ms/odsp-media/lib/fbx/envmap_1.2-256.env"):s("!file-loader!@ms/odsp-media/dist/media/fbx/envmap_1.2-256.env")})));var t=n.slide.item.peek();n.trackPromise(n.loadItem(t).then(function(){a({resultType:c.ResultTypeEnum.Success});n.slide.loadState(2);n.has3dLoaded(!0)},function(e){b.default.isCanceled(e)&&(e=x(!0,"Canceled","canceled"));a({resultType:e.isExpected?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure,resultCode:e.code||e.name,error:e.message||""+e});n.slide.loadState(2);console.error("Error loading Model: ",e);n.hasError(!0)}))}});return n}e.prototype.loadItem=function(h){var g=this;return b.default.resolve().then(function(){if(g.scope.isDisposed)throw x(!1,"Disposed","Viewer has already been destroyed");var t=g._graphDataSource,e=h.extension,n=h.model3d,o=h.name;if(!n)throw x(!0,"UnsupportedFormat","Missing 3D facet on file with extension: "+e);var i=e.toLowerCase(),a=o.slice(-e.length)===e?o:""+o+e,r=".gltf"===i,s=!!h.parent,d=s?t.getAuthenticationParams(h.parent):void 0,l=r&&s?t.getItemUrl(h.parent,{useDirectEndpoint:!0,isPath:!0})+"/":"",c=""+l+a,u=r&&s&&d.then(function(e){BABYLON.Tools.PreprocessUrl=function(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0?t:(0<=t.indexOf("/content?format=")?""+t:t+":/content?")+w.serializeQuery(e)}.bind(null,e)}),p=b.default.resolve().then(function(){if(n.canRenderNative)return r?d.then(function(e){return c+":/content?"+w.serializeQuery(e)}):t.getDownloadUrl(h,{useDirectEndpoint:!0});if(n.fbxConversionUrl)return n.fbxConversionUrl;if(n.canConvertToFbx)return d.then(function(e){return t.getItemUrl(h,{useDirectEndpoint:!0})+"/content?format=bxf&"+w.serializeQuery(e)});throw x(!0,"UnsupportedFormat","Invalid 3D facet on file with extension: "+e)}),m=new v.default,f=g._viewer;b.default.all([p,u]).then(function(e){var t=e[0],n={readyCallback:function(){},completeCallback:function(){m.complete()},progressCallback:function(){},errorCallback:function(e){var t=/Request failed:\s*(\d+)/.exec(e||""),n=e.replace(/token=[^&'"]+/g,"token=*"),o=t&&"406"===t[1],i=o?"UnsupportedFormat":t?"ServerError":"InvalidData";m.error(x(o,i,n))},path:r?l:void 0};r?f.loadGLTF(t,n):".glb"===i?f.loadGLB(t,n):f.load(t,n)}).catch(function(e){m.error(e)});return m.getPromise()})};e.prototype.onEnableViewerControls=function(e,t){this.isPanningEnabled(!1);t.stopPropagation();return!0};e.prototype._computeIsFirstSlideOpened=function(){this.isSlideCurrent()&&this.slide.isFirstSlideOpened()&&this.isPanningEnabled(!1)};e.prototype._computeLoadingSpinnerParams=function(){return{loadingText:this.slide.item().displayName}};e.prototype._computeSizeChanged=function(){this.oneUp.size();this._viewer&&this._viewer.resize()};e.dependencies=d.__assign({},i.default.dependencies,{graphDataSource:a.graph,toolbarProvider:m.resourceKey,spectre:y});return e}(i.default);e.default=r});define("odsp-next/controls/oneUp/3d/OneUp3d.html",[],function(){return'\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: hasError--\x3e<div class=OneUp-3d><div class=OneUp-3d-content><canvas class=OneUp-3d-app touch-action=none data-bind="element: container"></canvas>\x3c!--ko if: isSlideCurrent--\x3e\x3c!--ko component: {\r\n name: \'od-transclusion-content\',\r\n params: {\r\n provider: toolbarProvider\r\n }\r\n }--\x3e<div class=OneUp-3d-enableControls-toolbar data-bind="visible: isPanningEnabled"><div class=OneUp-3d-enableControls><div class=OneUp-3d-enableControls-icon><i class="ms-Icon ms-Icon--Fullscreen" data-bind="icon: true"></i></div><div class=OneUp-3d-enableControls-text data-bind="text: strings.enableViewerControls, click: onEnableViewerControls"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !has3dLoaded()--\x3e<div class=OneUp-3d-loadingContainer data-bind="style: loadingContainerStyle"><div class=OneUp-3d-loading><span class="ms-font-s OneUp-3d-loadingSpinner" data-bind="component: { name: loadingSpinnerTagName, params: loadingSpinnerParams }"></span></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/oneUp/3d/OneUp3d.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-3d-loadingContainer{position:absolute;width:100%}.OneUp-3d-loadingContainer .OneUp-3d-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-3d-loadingContainer .OneUp-3d-loading .OneUp-3d-loadingSpinner{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin-top:10px}.OneUp-3d-loadingContainer .OneUp-3d-loading .OneUp-3d-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-3d-loadingContainer .OneUp-3d-loading .OneUp-3d-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-3d-loadingContainer .OneUp-3d-loading .OneUp-3d-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}.OneUp-3d-content{position:absolute;top:0;left:0;right:0;bottom:0;-ms-touch-action:none;touch-action:none}.OneUp-3d-app{width:100%;height:100%}.OneUp-3d-enableControls-toolbar{position:absolute;width:100%;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:17px}.OneUp-3d-enableControls{margin:auto;background-color:rgba(0,0,0,.7);width:300px;height:40px;cursor:pointer}.OneUp-3d-enableControls-icon{font-size:28px}html[dir=ltr] .OneUp-3d-enableControls-icon{float:left}html[dir=rtl] .OneUp-3d-enableControls-icon{float:right}[dir=ltr] .OneUp-3d-enableControls-icon{margin-right:5px}[dir=rtl] .OneUp-3d-enableControls-icon{margin-left:5px}[dir=ltr] .OneUp-3d-enableControls-icon{padding-left:20px}[dir=rtl] .OneUp-3d-enableControls-icon{padding-right:20px}.OneUp-3d-enableControls-text{font-size:14px;padding:10px 0}"}])});define("odsp-next/controls/oneUp/panorama/OneUpPanorama",["require","exports","./OneUpPanoramaViewModel","../../../bindings/component/ControlBinding","./OneUpPanorama.html","../../panorama/Panorama"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-panorama",name:e("module").id,template:e("./OneUpPanorama.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/panorama/OneUpPanoramaViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../OneUpContentViewModel","../thumbnail/OneUpThumbnail"],function(e,t,n,o,s,d,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){n.__extends(e,r);function e(e,t){var n=r.call(this,e,t)||this;n.addBindingHandlers({control:d.default});var o=n.observables;e.slide.isEditCaptionEnabled(!0);n._isInteractive=o.create(!1);n.showPanorama=o.pureCompute(function(){return!e.slide.offset()});var i=o.create(!1),a=o.pureCompute(function(){return i()?{resultType:s.ResultTypeEnum.Success}:void 0});n.scope.attach(e.slide.loadResult.register(a));o.backgroundCompute(function(){i()&&e.slide.loadState(2)});n.panoramaParams={item:e.slide.item,isLoaded:i,isInteractive:n._isInteractive};n.thumbnailControl=d.toSpecification(l.default,e);n.createComputed(n._computeChangesOnInteractive);return n}e.prototype._computeChangesOnInteractive=function(){var e=this._isInteractive();if(!o.computedContext.isInitial()){this.oneUp.isInfoPaneExpanded(!1);this.oneUp.isCommandBarVisible(!e);this.slide.isPanningEnabled(!e);this.slide.isEditCaptionEnabled(!e)}};return e}(i.default);t.default=a});define("odsp-next/controls/oneUp/panorama/OneUpPanorama.html",[],function(){return"\x3c!--ko ifnot: showPanorama--\x3e\x3c!--ko control: thumbnailControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showPanorama--\x3e<div class=OneUp-panorama data-bind=\"component: { name: 'od-panorama', params: panoramaParams }\"></div>\x3c!--/ko--\x3e"});define("odsp-next/controls/panorama/Panorama",["require","exports","./PanoramaViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Panorama.html","./Panorama.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o.registerComponent({tagName:"od-panorama",template:e("./Panorama.html"),viewModel:n.default,synchronous:!0});t.default=i});define("odsp-next/controls/panorama/PanoramaViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","../../bindings/immersiveViewer/ImmersiveViewerBinding","./Panorama.resx"],function(o,e,t,i,n,a,r,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(n){t.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.enterInteractiveModeAria=s.strings.EnterInteractiveModeAria;t.exitInteractiveModeAria=s.strings.ExitInteractiveModeAria;t.addBindingHandlers({immersiveViewer:r.default});t.item=e.item;t._isLoaded=e.isLoaded;t._parentInteractive=e.isInteractive;t.interactiveButtonUrl="undefined"==typeof __webpack_public_path__?o.toUrl("odsp-media/images/panorama/interactivemodebuttonrest.png"):o("@ms/odsp-media/dist/media/images/panorama/InteractiveModeButtonRest.png");t.viewer=i.observable(null);t.worldConfiguration=i.observable(null);t.downloadUrl=i.observable(null);t.isInteractive=i.observable(t._parentInteractive());t._boundHandlePanning=t._handlePanning.bind(t);t._isGoingClockwise=!0;t.loadPanorama();t.createComputed(function(){t._onInteractiveChange()});return t}e.prototype.loadPanorama=function(){var t=this,e=this.viewer();if(e){e.dispose();this.viewer(null)}var n=i.utils.unwrapObservable(this.item);n&&this.resources.consumeAsync(a.download).then(function(e){return e.getDownloadUrl(n,{downloadType:2}).then(function(e){t.downloadUrl(e)})});this._isLoaded(!0)};e.prototype.onClickInteractiveButton=function(){this.isInteractive(!0)};e.prototype.onClickBackButton=function(e,t){t.stopPropagation();this.isInteractive(!1);return!0};e.prototype._onInteractiveChange=function(){var e=this.isInteractive(),t=this.viewer();if(e){this._parentInteractive(!0);if(t){this._stopAutoPan();t.setIsInteractive(!0);t.setFocus()}}else{if(t){this._resetView();this._startAutoPan();t.setIsInteractive(!1)}this._parentInteractive(!1)}};e.prototype._resetView=function(){var e=this.viewer(),t=this.worldConfiguration();if(e&&t){var n=t.source;e.setView(n?n.startingPitch:0,n?n.startingHeading:0,Math.PI);this._isGoingClockwise=!0}};e.prototype._startAutoPan=function(){var e=this.viewer();if(e){this._handlePanning();e.viewChangeEndEvent.addEventListener(this._boundHandlePanning)}};e.prototype._stopAutoPan=function(){var e=this.viewer();if(e){e.setView(e.getPitch(),e.getHeading(),e.getVerticalFov());e.viewChangeEndEvent.removeEventListener(this._boundHandlePanning)}};e.prototype._handlePanning=function(){var e=this,t=this.viewer();if(this.isInteractive())this._stopAutoPan();else{var n=t.getBounds(),o=n.right||Math.PI,i=n.left||-Math.PI,a=n.top||Math.PI/2,r=n.bottom||-Math.PI/2,s=o-i,d=a-r<=s,l=t.getHeading(),c=t.getPitch(),u=l,p=c;if(d)if(s===2*Math.PI)if(l===o||l===i){u=0;this._isGoingClockwise=!this._isGoingClockwise}else u=this._isGoingClockwise?o:i;else u=l<o?o:i;else p=c<a?a:r;var m=1e3*(Math.abs(u-l)+Math.abs(p-c))/.05;this.async.setTimeout(function(){e.isInteractive()||t.setView(p,u,t.getVerticalFov(),!0,m)},1e3)}};return e}(n.default);e.default=d});define("odsp-next/bindings/immersiveViewer/ImmersiveViewerBinding",["require","exports","knockout","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","../../controls/panorama/Panorama.resx","office-ui-fabric-react/lib/Styling"],function(c,e,u,p,m,f,h,g){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function b(e,t){return e+"?psid=1&zippath="+t}var t=function(){function e(){}e.init=function(n,e,t,o,i){var a,r,s=e(),d=s.downloadUrl.subscribe(function(t){if(t){var n=b(t,"formats/cubemap/cubemap.json");r=p.loadModule({path:"siv",getModule:function(){return new m.default(function(e,t){c(["siv"],e,t)})}}).then(function(){var e=new Microsoft.ImmersiveViewer.PhotosynthSivDataSource;(a=e).createFromJsonUri(n,l,function(){return b(t,"")},!0,!0)})}});function l(e,t){if(e){s.worldConfiguration(e);!function(){s.viewer(new Microsoft.ImmersiveViewer.SharedImmersiveViewer(n,{dataSources:[a],backgroundColor:null,width:n.offsetWidth,height:n.offsetHeight}));var e=document.getElementById("sivZoomInButton");e.textContent="";e.setAttribute("aria-label",h.strings.ZoomIn);f.default.toggleClass(e,g.getIconClassName("Add"),!0);f.default.toggleClass(e,"ms-Icon--m",!0);var t=document.getElementById("sivZoomOutButton");t.setAttribute("aria-label",h.strings.ZoomOut);f.default.toggleClass(t,g.getIconClassName("Remove"),!0);f.default.toggleClass(t,"ms-Icon--m",!0);t.textContent=""}()}}u.utils.domNodeDisposal.addDisposeCallback(n,function(){d.dispose();r&&r.cancel();var e=s.viewer();if(e){e.dispose();s.viewer(null)}s.worldConfiguration(null)})};return e}();e.default=t});define("odsp-next/controls/panorama/Panorama.html",[],function(){return"<div class=od-Panorama data-bind=\"css: {'od-Panorama--isInteractive': isInteractive}\"><div class=od-Panorama-sivContainer data-bind=\"{ immersiveViewer: { viewer: viewer, downloadUrl: downloadUrl, worldConfiguration: worldConfiguration} }\"></div><button class=od-Panorama-interactiveModeButton data-bind=\"click: onClickInteractiveButton, style: { backgroundImage: 'url(\\'' + interactiveButtonUrl + '\\')' }, attr: {'aria-label': enterInteractiveModeAria }\"></button> <button class=\"od-Panorama-backButton ms-Icon ms-Icon--Cancel ms-Icon--Circle ms-Icon--m\" data-bind=\"icon: true, click: onClickBackButton, attr: {'aria-label': exitInteractiveModeAria }\"></button></div>"});define("odsp-next/controls/panorama/Panorama.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Panorama-sivContainer{position:absolute;top:0;left:0;right:0;bottom:0}.od-Panorama-interactiveModeButton{position:absolute;top:50%;width:100px;height:100px;margin-top:-50px;background-repeat:no-repeat;background-color:transparent;border:none;z-index:1}[dir=ltr] .od-Panorama-interactiveModeButton{left:50%}[dir=rtl] .od-Panorama-interactiveModeButton{right:50%}[dir=ltr] .od-Panorama-interactiveModeButton{margin-left:-50px}[dir=rtl] .od-Panorama-interactiveModeButton{margin-right:-50px}.od-Panorama-interactiveModeButton:active,.od-Panorama-interactiveModeButton:hover{background-color:transparent}.od-Panorama--isInteractive .od-Panorama-interactiveModeButton{display:none}.od-Panorama .od-Panorama-backButton{display:none;position:absolute;top:20px;height:40px;width:40px;padding:0;z-index:1;cursor:pointer;background-color:#fff}[dir=ltr] .od-Panorama .od-Panorama-backButton{right:40px}[dir=rtl] .od-Panorama .od-Panorama-backButton{left:40px}.od-Panorama--isInteractive .od-Panorama-backButton{display:block}.od-Panorama .sivZoomInButton,.od-Panorama .sivZoomOutButton{display:none;right:auto;background-color:#fff;width:40px;height:40px;cursor:pointer;padding:0;top:auto}[dir=ltr] .od-Panorama .sivZoomInButton,[dir=ltr] .od-Panorama .sivZoomOutButton{right:50px}[dir=rtl] .od-Panorama .sivZoomInButton,[dir=rtl] .od-Panorama .sivZoomOutButton{left:50px}.od-Panorama--isInteractive .sivZoomInButton,.od-Panorama--isInteractive .sivZoomOutButton{display:block}.od-Panorama .od-Panorama-backButton:hover,.od-Panorama .sivZoomInButton:hover,.od-Panorama .sivZoomOutButton:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-Panorama .od-Panorama-backButton:active,.od-Panorama .sivZoomInButton:active,.od-Panorama .sivZoomOutButton:active{background-color:#000;color:#fff}.od-Panorama .sivZoomInButton{bottom:100px}.od-Panorama .sivZoomOutButton{bottom:50px}.od-Panorama .sivHeadingLeftButton,.od-Panorama .sivHeadingRightButton,.od-Panorama .sivPitchDownButton,.od-Panorama .sivPitchUpButton{display:none}"}])});define("odsp-next/controls/oneUp/pdf/OneUpPdf",["require","exports","./OneUpPdfViewModel","../../../bindings/component/ControlBinding","./OneUpPdf.html","./OneUpPdf.css","../thumbnail/OneUpThumbnail"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-pdf",name:e("module").id,template:e("./OneUpPdf.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/pdf/OneUpPdfViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../ToolbarProvider.key","../../pdfViewer/PdfViewer.key","../../../utilities/features/Features","../other/OneUpOther","../thumbnail/OneUpThumbnail","../../loadingSpinner/LoadingSpinner","../../../utilities/browser/ResponsiveUI","../../../resources/DataSourceResourceKeys","../OneUpContentViewModel","../../pdfViewer/resources/PdfViewerResourceKeys","../logging/OneUpDocumentStats.event"],function(e,t,l,c,o,n,i,u,a,p,m,f,h,r,g,s,b,v,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(d){l.__extends(e,d);function e(e,t){var n=d.call(this,e,t)||this;n.addBindingHandlers({control:u.default});var o=n,i=o.observables;o.resources.expose(v.controlPanelProvider,t.toolbarProvider);var a=t.platformDetection;n._isMobile=a.isMobile;n.isPdfViewerEnabled=m.isFeatureEnabled(m.UseWebPdfViewer);n.hasPdfLoaded=i.create(!1);var r=n._result=i.create();n.hasError=i.pureCompute(n._computeHasError);n._totalPages=i.create(0);n._pagesViewed=i.create(0);n.scope.attach(e.slide.loadResult.register(r));n._statsEventData={hasError:!1,fileSize:n.slide.item&&n.slide.item.peek()&&n.slide.item.peek().size,fileType:"pdf",pagesViewed:n._pagesViewed.peek(),totalPages:n._totalPages.peek(),timeToThumbnail:0,timeToDocumentLoaded:0};n.loadingContainerStyle={bottom:g.default.getScrollbarWidth()+"px"};var s={deferEvaluation:!0};n.isSlideCurrent=i.pureCompute(n._computeIsSlideCurrent,s).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});i.backgroundCompute(n._computeIsFirstSlideOpened);n.loadPdf=i.pureCompute(function(){return n.isSlideCurrent()},s);i.backgroundCompute(n._computeUpdateIsLoaded);i.backgroundCompute(n._computeUpdateStatsOnThumbnailLoad);i.backgroundCompute(n._computeUpdateStatsOnError);i.backgroundCompute(n._computeEnsureCommandBarVisible);n.isPdfViewerEnabled&&(n._pdfParams=n._getPdfParams(t));n._initializeComponents();return n}e.prototype.dispose=function(){if(this._viewStartTime&&this.isPdfViewerEnabled){this._statsEventData.pagesViewed=this._pagesViewed.peek();this._statsEventData.totalPages=this._totalPages.peek();this._statsEvent.end(this._statsEventData)}};e.prototype._getPdfParams=function(e){var t=this.slide.item.peek(),n=t.pdfConversion;return n?o.default.resolve(n.url):e.graphDataSource.getDownloadUrl(t,{useDirectEndpoint:!0})};e.prototype._initializeComponents=function(){var e=this.observables,t=this.slide,n=l.__assign({},t,{loadState:e.compute({read:function(){return t.loadState()},write:function(e){e>t.loadState.peek()&&t.loadState(1)}}),loadResult:e.createCallback(c.forSingleValue())});this.fallbackComponent=u.toSpecification(f.default,{slide:n,oneUp:this.oneUp});this.thumbnailComponent=u.toSpecification(h.default,{allowError:!1,slide:n,oneUp:this.oneUp});this.spinnerComponent=e.pureCompute(this._computeSpinnerComponent);var o=t.renderOptions||{},i=o.autofocus,a=void 0===i||i,r=o.page,s=o.zoom,d={autofocus:a,item:t.item,pdfParams:this._pdfParams,isLoaded:this.hasPdfLoaded,result:this._result,size:this.oneUp.size,hasHorizontalScrollbar:t.hasHorizontalScrollbar,hasVerticalScrollbar:t.hasVerticalScrollbar,isIdleEnabled:t.isIdleEnabled,isPanningEnabled:t.isPanningEnabled,initialPage:r,initialZoom:s,totalPages:this._totalPages,pagesViewed:this._pagesViewed};this.pdfViewerComponent=u.toSpecification(p.resourceKey,d)};e.prototype._computeSpinnerComponent=function(){var e={loadingText:this.slide.item().displayName};return{name:r.default.tagName,params:e}};e.prototype._computeIsSlideCurrent=function(){var e=!this.slide.offset();if(e){this._viewStartTime=Date.now();this._statsEvent=new w.OneUpDocumentStats}return e};e.prototype._computeEnsureCommandBarVisible=function(){!this.isSlideCurrent()||this.slide.isPanningEnabled()||this.oneUp.isCommandBarVisible()||this.oneUp.isCommandBarVisible(!0)};e.prototype._computeIsFirstSlideOpened=function(){var e=this.hasPdfLoaded();if(this.isSlideCurrent()&&(this.slide.isFirstSlideOpened()||this.oneUp.enableSlideControls.peek())){e&&this.oneUp.enableSlideControls(!0);this._isMobile;e&&this.slide.isPanningEnabled(!1)}};e.prototype._computeUpdateIsLoaded=function(){var e=this.hasPdfLoaded(),t=this._result();if((t&&t.resultType)===i.ResultTypeEnum.Success&&!this._statsEventData.timeToDocumentLoaded){this._statsEventData.timeToDocumentLoaded=Date.now()-this._viewStartTime;this._pagesViewed(1)}var n=this.slide.loadState;t?n(2):e&&n.peek()<1&&n(1)};e.prototype._computeUpdateStatsOnThumbnailLoad=function(){this.slide.loadState()&&!this._statsEventData.timeToThumbnail&&this._viewStartTime&&(this._statsEventData.timeToThumbnail=Date.now()-this._viewStartTime)};e.prototype._computeHasError=function(){var e=this._result(),t=e&&e.resultType;return t===i.ResultTypeEnum.Failure||t===i.ResultTypeEnum.ExpectedFailure};e.prototype._computeUpdateStatsOnError=function(){this._statsEventData.hasError=this.hasError()};e.dependencies=l.__assign({},b.default.dependencies,{graphDataSource:s.graph,platformDetection:n.platformDetection,toolbarProvider:a.resourceKey});return e}(b.default);t.default=d});define("odsp-next/controls/pdfViewer/PdfViewer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(n,e,t,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:n("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./PdfViewer",getModule:function(){return new t.default(function(e,t){n(["./PdfViewer"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/pdfViewer/resources/PdfViewerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.current=new n.ResourceKey("pdfviewer.current");t.controlPanelProvider=new n.ResourceKey("pdfviewer.controlPanelProvider")});define("odsp-next/controls/oneUp/logging/OneUpDocumentStats.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OneUpDocumentStats=n.createPairedEvent({eventName:"OneUpDocumentStats,",shortEventName:"OneUpDocumentStats"},{fileType:1,fileSize:2,hasError:3,pagesViewed:2,totalPages:2,timeToThumbnail:2,timeToDocumentLoaded:2});t.default=t.OneUpDocumentStats});define("odsp-next/controls/oneUp/pdf/OneUpPdf.html",[],function(){return'\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: hasError--\x3e<div class=OneUp-pdf data-bind="css: { \'OneUp-pdf--loaded\': hasPdfLoaded() && isSlideCurrent() }">\x3c!--ko if: loadPdf--\x3e<div class=od-OneUpPdf-content data-bind="control: pdfViewerComponent"></div>\x3c!--/ko--\x3e<div class=od-OneUpPdf-thumbnail data-bind="control: thumbnailComponent"></div>\x3c!--ko if: !hasPdfLoaded() && isPdfViewerEnabled--\x3e<div class=OneUp-pdf-loadingContainer data-bind="style: loadingContainerStyle"><div class=OneUp-pdf-loading><span class="ms-font-s OneUp-pdf-loadingSpinner" data-bind="component: spinnerComponent"></span></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/oneUp/pdf/OneUpPdf.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-pdf{position:absolute;top:0;bottom:0;left:0;right:0}.OneUp-pdf-loadingContainer{position:absolute;width:100%}.OneUp-pdf-loadingContainer .OneUp-pdf-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin-top:10px}.OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}.od-OneUpPdf-thumbnail{position:absolute;top:0;left:0;right:0;bottom:0;overflow-y:scroll;opacity:1;visibility:visible;transition:opacity 267ms linear 267ms,visibility 0s linear 534ms}.OneUp-pdf--loaded .od-OneUpPdf-thumbnail{opacity:0;visibility:hidden}.od-OneUpPdf-content{display:none;position:absolute;top:0;left:0;right:0;bottom:0}.OneUp-pdf--loaded .od-OneUpPdf-content{display:block}"}])});define("odsp-next/controls/oneUp/textFile/OneUpTextFile",["require","exports","./OneUpTextFileViewModel","../../../bindings/component/ControlBinding","./OneUpTextFile.html","./OneUpTextFile.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-textFile",name:e("module").id,template:e("./OneUpTextFile.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/textFile/OneUpTextFileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../../../bindings/monaco/MonacoBindingHelper","../thumbnail/OneUpThumbnail","../other/OneUpOther","../OneUpContentViewModel","../../../controls/textViewer/TextViewer","../../../controls/progressSpinnerFlat/ProgressSpinnerFlat","../../../models/item/FileContentHelper","../../../providers/encoding/EncodingProvider","../../../resources/DataSourceResourceKeys","../../../utilities/browser/ResponsiveUI","../../../utilities/mime/MimeHelper"],function(e,t,h,g,i,b,v,w,_,n,y,x,a,o,r,C,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(f){h.__extends(e,f);function e(e,t){var n=f.call(this,e,t)||this;n.addBindingHandlers({control:b.default});n._encodingProvider=t.encodingProvider;var o=e.slide,i=n.observables,a=g.forSingleValue();n.thumbnailControl=b.toSpecification(w.default,h.__assign({},e,{slide:h.__assign({},o,{loadState:i.compute({read:function(){return o.loadState()},write:function(e){1<=e&&e>o.loadState.peek()&&o.loadState(1)}}),loadResult:i.createCallback(a)}),allowError:!1}));n.fallbackControl=b.toSpecification(_.default,h.__assign({},e,{slide:h.__assign({},o,{loadResult:i.createCallback(a)})}));n.loadingSpinnerTagName=x.default.tagName;n._isSlideCurrent=i.pureCompute(n._computeIsSlideCurrent).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var r=n._loadResult=i.create();n.scope.attach(o.loadResult.register(r));n.loadThumbnail=i.create(!1);n.async.setTimeout(function(){n.loadThumbnail(!0)},200);n.loadTextEditor=n._isSlideCurrent;n.loadTextEditorFailed=i.create(!1);n.hasTextEditorLoaded=i.create(!1);var s=n.hasTextEditorDataLoaded=i.create(!1),d=n._editorState=i.create(v.EditorState.shouldLoad),l=n._isEditorFocused=i.create(!1);n._isFirstSlideOpened=i.pureCompute(n._computeIsFirstSlideOpened);n.editorTitle=i.pureCompute(n._computeEditorTitle);var c=n._itemContent=i.create(),u=t.responsiveUI,p=n.oneUp.size,m=n.isCompact=i.pureCompute(function(){var e=p()&&p().width||0;return u.compareSize(C.default.determineWindowSize(e),"Large")<=0});n.contentControl=b.toSpecification(y.default,{content:c,editorState:d,isCompact:m,isDataLoaded:s,isEditorFocused:l});n.slide.loadState(1);i.backgroundCompute(n._computeOnEditorStateChange);i.backgroundCompute(n._computeIsPanningEnabled);i.backgroundCompute(n._computeUpdateContent);return n}e.prototype._computeUpdateContent=function(){var n=this,t=this.slide.item(),o=s.getMimeTypeForExtension(t.extension),e=this.resources.consumeAsync(r.download).then(function(e){return e.getItemContents(t)});return this.trackPromise(e).then(function(e){if(e){var t=n._encodingProvider.getEncoding();return a.fullParse(e,o,t)}}).then(function(e){n._itemContent(e)}).catch(function(e){n._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:e.code||"ReadFile",error:e&&e.message||""+e});n.loadTextEditorFailed(!0)})};e.prototype._computeEditorTitle=function(){var e=this.slide.item();return e.displayName||e.name};e.prototype._computeIsSlideCurrent=function(){return!this.slide.offset()};e.prototype._computeIsFirstSlideOpened=function(){var e=this.hasTextEditorLoaded();return!this._isSlideCurrent()||this.slide.isFirstSlideOpened()||!e};e.prototype._computeOnEditorStateChange=function(){switch(this._editorState()){case v.EditorState.loaded:this.hasTextEditorLoaded(!0);this._loadResult({resultType:i.ResultTypeEnum.Success});this.slide.loadState(2);break;case v.EditorState.error:this._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:"Unknown"});this.loadTextEditorFailed(!0)}};e.prototype._computeIsPanningEnabled=function(){var e=this._isEditorFocused(),t=this._isFirstSlideOpened();this.slide.isPanningEnabled(!t&&!e)};e.dependencies=h.__assign({},n.default.dependencies,{encodingProvider:o.resourceKey,responsiveUI:C.resourceKey});return e}(n.default);t.default=d});define("odsp-next/bindings/monaco/MonacoBindingHelper",["require","exports","knockout","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,o,n,i,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d,l,c=new a.default,u=new r.default(window);!function(e){e[e.shouldLoad=0]="shouldLoad";e[e.loading=1]="loading";e[e.loaded=2]="loaded";e[e.error=3]="error"}(l=t.EditorState||(t.EditorState={}));t.initializeEnvironment=function(t){if(d)t&&t(l.loaded);else{t&&t(l.loading);s.default.addConfig({paths:{vs:"monaco-editor/vs"}});d=n.loadModule({path:"vs/editor/editor.main",getModule:function(){return new i.default(function(e,t){window.require(["vs/editor/editor.main"],e,t)})}}).then(function(){t&&t(l.loaded);var e=monaco.languages.typescript;e.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1});e.javascriptDefaults.setCompilerOptions({target:e.ScriptTarget.Latest,allowNonTsExtensions:!0})},function(e){t&&t(l.error);d=void 0;return i.default.wrapError(e)})}return d};t.addDispose=function(e,t){o.utils.domNodeDisposal.addDisposeCallback(e,function(){try{t&&t()}catch(e){}})};t.watchForResize=function(e,t){var n=c.throttle(function(){t.layout()},500);u.on(window,"resize",n);o.utils.domNodeDisposal.addDisposeCallback(e,function(){u.off(window,"resize",n)})}});define("odsp-next/controls/textViewer/TextViewer",["require","exports","./TextViewerViewModel","../../bindings/component/ControlBinding","./TextViewer.html","./TextViewer.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-text-viewer",template:e("./TextViewer.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/textViewer/TextViewerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../bindings/monaco/MonacoBinding","../../bindings/keyboard/KeyboardBinding"],function(e,t,n,o,i,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(s){n.__extends(e,s);function e(e,t){var n=s.call(this,e,t)||this;n.addBindingHandlers({keyboard:l.default,monaco:d.default});var o=n.observables;n._editorLoaded=!1;var i=n._editor=o.create();n.editorFocused=e.isEditorFocused||o.create(!1);var a=e.editorState;n._content=e.content;n.keyboardOptions=[{mappings:{Esc:function(){n.editorFocused(!0);return!0}}}];n._isDataLoaded=o.pureCompute(n._computeDataLoaded);e.isDataLoaded&&o.backgroundCompute(function(){return e.isDataLoaded(n._isDataLoaded())});o.compute(n._computeResize);o.compute(n._computeContent);var r=t.platformDetection;n.monacoOptions={editor:i,editorState:a,isCompact:e.isCompact,isMobile:r.isMobile,readOnly:!0};return n}e.prototype.setEditorFocused=function(e){this.editorFocused(e)};e.prototype._computeResize=function(){if(this._isDataLoaded()){var e=this._editor();e&&this.async.setTimeout(function(){e.layout()},0)}};e.prototype._loadEditor=function(e){var t=this;this._editorLoaded=!0;e.onDidFocusEditor(function(){t.editorFocused(!0)});e.onDidBlurEditor(function(){t.editorFocused(!1)})};e.prototype._computeContent=function(){var e=this._editor();if(e){this._editorLoaded||this._loadEditor(e);var t=this._content();if(t&&t.mimeType){var n=e.getModel(),o=this._previousContent;if(n&&o&&o.mimeType===t.mimeType){n.getValue()!==t.text&&n.setValue(t.text)}else{var i=monaco.editor.createModel(t.text,t.mimeType);e.setModel(i);this._disposeModel(n)}this._previousContent=t}}};e.prototype._computeDataLoaded=function(){return!!this._content()};e.prototype._disposeModel=function(e){e&&!e.isDisposed()&&e.dispose()};e.dependencies=n.__assign({},o.default.dependencies,{platformDetection:i.platformDetection});return e}(o.default);t.default=a});define("odsp-next/bindings/monaco/MonacoBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","./MonacoBindingHelper"],function(e,t,f,n,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(m){f.__extends(e,m);function e(e){var t,n,o=m.call(this,e)||this,i=o.valueAccessor(),a=o.element,r=!!i.readOnly,s=function(){var e=a.querySelector("textarea");e.readOnly!==r&&(e.readOnly=r)},d=o.observables,l={readOnly:r,scrollBeyondLastLine:!1,wordWrap:"on"},c={contextmenu:!i.isMobile},u=d.pureCompute(function(){var e=d.unwrap(i.isCompact);return{lineNumbersMinChars:e?3:5,minimap:{enabled:!e}}});d.backgroundCompute(function(){var e=i.editor();if(e){var t=u();e.updateOptions(t);e.layout()}});var p=h.initializeEnvironment(i.editorState).then(function(){t=monaco.editor.create(a,f.__assign({},l,c,u.peek()));h.watchForResize(a,t);n=new MutationObserver(s);s();n.observe(a,{childList:!0,subtree:!0});i.editor(t)},function(e){});h.addDispose(a,function(){p.cancel();n&&n.disconnect();if(t){var e=t.getModel();t.setModel(null);e&&e.dispose();t.dispose();t=null}});return o}return e}(n.default);t.default=o});define("odsp-next/controls/textViewer/TextViewer.html",[],function(){return'<div class=TextViewer-frame data-bind="attr: { tabindex: editorFocused() ? 0 : -1 }, monaco: monacoOptions, keyboard: keyboardOptions, hasFocus: setEditorFocused"></div>'});define("odsp-next/controls/textViewer/TextViewer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".TextViewer-frame{border:none;position:absolute;top:1px;left:1px;right:1px;bottom:1px}.TextViewer-frame:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}"}])});define("odsp-next/providers/encoding/EncodingProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../models/language/FileEncodings"],function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._encodingDataSource=t.encodingDataSource;this._languageDataSource=t.languageDataSource}e.prototype.getEncoding=function(){var e=this._encodingDataSource.getEncoding();if(!e){var t=this._languageDataSource.getCurrentLanguageCode().toLowerCase();e=i.encodingMap[t]}e||(e=i.defaultEncoding);return e};return e}();t.default=a;t.resourceKey=n.createResolvedResourceKey(e("module").id,a,{languageDataSource:o.language,encodingDataSource:o.encoding})});define("odsp-next/models/language/FileEncodings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultEncoding="windows-1252";t.encodingMap={ar:"windows-1256","ar-sa":"windows-1256","az-latn-az":"windows-1254",be:"windows-1251","be-by":"windows-1251",bg:"windows-1251","bg-bg":"windows-1251","bs-latn-ba":"windows-1250",cs:"windows-1250","cs-cz":"windows-1250",el:"windows-1253","el-gr":"windows-1253",et:"windows-1257","et-ee":"windows-1257",fa:"windows-1256","fa-ir":"windows-1256",he:"windows-1255","he-il":"windows-1255",hr:"windows-1250","hr-hr":"windows-1250",hu:"windows-1250","hu-hu":"windows-1250",ja:"Shift_JIS","ja-ja":"Shift_JIS","ja-jp":"Shift_JIS","ku-arab":"windows-1256","ku-arab-iq":"windows-1256",ky:"windows-1251","ky-kg":"windows-1251",lt:"windows-1257","lt-lt":"windows-1257",lv:"windows-1257","lv-lv":"windows-1257",mk:"windows-1251","mk-mk":"windows-1251",mn:"windows-1251","mn-mn":"windows-1251","pa-arab":"windows-1256","pa-arab-pk":"windows-1256",pl:"windows-1250","pl-pl":"windows-1250","prs-af":"windows-1256",ro:"windows-1250","ro-ro":"windows-1250",ru:"windows-1251","ru-ru":"windows-1251","sd-arab":"windows-1256","sd-arab-pk":"windows-1256",sk:"windows-1250","sk-sk":"windows-1250",sl:"windows-1250","sl-si":"windows-1250",sq:"windows-1250","sq-al":"windows-1250","sr-cyrl-ba":"windows-1251","sr-cyrl-cs":"windows-1251","sr-cyrl-rs":"windows-1251","sr-latn":"windows-1250","sr-latn-rs":"windows-1250","tg-cyrl":"windows-1251","tg-cyrl-tj":"windows-1251",th:"windows-874","th-th":"windows-874","tk-tm":"windows-1250",tr:"windows-1254","tr-tr":"windows-1254",tt:"windows-1251","tt-ru":"windows-1251","ug-cn":"windows-1256",uk:"windows-1251","uk-ua":"windows-1251",ur:"windows-1256","ur-pk":"windows-1256","uz-latn-uz":"windows-1254",vi:"windows-1258","vi-vn":"windows-1258"}});define("odsp-next/controls/oneUp/textFile/OneUpTextFile.html",[],function(){return'<div class=od-OneUpTextFile data-bind="css: { \'od-OneUpTextFile-thumbnail--load\': loadThumbnail, \'od-OneUpTextFile--compact\': isCompact, \'od-OneUpTextFile--loaded\': loadTextEditor() && hasTextEditorLoaded() && hasTextEditorDataLoaded() }">\x3c!--ko if: loadTextEditorFailed()--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !loadTextEditorFailed()--\x3e\x3c!--ko if: loadTextEditor()--\x3e<div class=od-OneUpTextFile-content><div class=od-OneUpTextFile-title data-bind="text: editorTitle"></div><div class="od-OneUpTextFile-editor od-TextFileEditor-content" data-bind="control: contentControl"></div></div>\x3c!--/ko--\x3e<div class=od-OneUpTextFile-loading data-bind="component: { name: loadingSpinnerTagName, params: {} }"></div><div class=od-OneUpTextFile-thumbnail data-bind="control: thumbnailControl"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/oneUp/textFile/OneUpTextFile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpTextFile-thumbnail{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden}.od-OneUpTextFile-thumbnail--load .od-OneUpTextFile-thumbnail{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile--loaded .od-OneUpTextFile-thumbnail{opacity:0;visibility:hidden}.od-OneUpTextFile-loading{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:1;visibility:inherit}.od-OneUpTextFile--loaded .od-OneUpTextFile-loading{opacity:0;visibility:hidden}.od-OneUpTextFile-content{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden;margin:20px 10%;box-shadow:0 0 7px 2px rgba(0,0,0,.15)}.od-OneUpTextFile--compact .od-OneUpTextFile-content{margin:0 0;box-shadow:0}.od-OneUpTextFile--loaded .od-OneUpTextFile-content{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile-content .od-OneUpTextFile-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .od-OneUpTextFile-content .od-OneUpTextFile-title{padding:6px 10px 0 0}.od-OneUpTextFile-content .od-OneUpTextFile-editor{position:absolute;top:30px;left:0;right:0;bottom:0}.od-OneUpTextFile-content .TextEditor{overflow:hidden}.od-OneUpTextFile-content .TextEditor .TextEditor-editorFrame{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";top:0;left:0;right:0;bottom:0}.od-OneUpTextFile-content .monaco-editor-background{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/dataSources/download/odc/DownloadDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/navigation/AddressParser","../../base/odc/DataRequest","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../resources/ODCResourceKeys"],function(e,t,g,n,o,b,a,r,i,v,s,d,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){g.__extends(e,i);function e(e,t){void 0===e&&(e={});var n=i.call(this,e,t)||this,o=window.FilesConfig;n._canary=o.canary;n._callBackIndex=0;n._graphDataSource=t.graphDataSource;n._navigation=t.navigation;n._urlDataSource=t.urlDataSource;n._userInfoDataSource=t.userInfoDataSource;n._platformDetection=t.platformDetection;return n}e.prototype.downloadItems=function(e){var t=e.items[0],n=this._urlDataSource;if(1===e.items.length&&t.type!==d.default.Folder){if(this._platformDetection.isMobile)this._navigation.navigateTo({url:n.getDownloadItemUrl(t,this._canary,!1),frameId:"_self"});else{var o=this._initIframe(n.getDownloadItemUrl(t,this._canary,!1));this.async.setTimeout(function(){window.document.body.removeChild(o)},2e4)}}else this._downloadAsZip(e.items);return a.default.wrap()};e.prototype.getDownloadUrl=function(e,t){if(e.video){var n=new s.default,o=this._urlDataSource.getDownloadUrl(e);return n.send({apiName:"GetDownloadUrl",url:o,useDefaultHeaders:!0}).then(function(e){return e.DownloadUrl?e.DownloadUrl:a.default.wrapError(e)})}return this._graphDataSource.getDownloadUrl(e,{useDirectEndpoint:!0})};e.prototype.getItemContents=function(e){return this.getDownloadUrl(e,{downloadType:2}).then(function(e){return(new s.default).send({apiName:"Download",url:e,returnRawXHR:!0,responseType:"blob"}).then(function(e){return e.response})})};e.prototype._initIframe=function(e){var t=document.createElement("iframe");t.src=e;t.style.display="none";window.document.body.appendChild(t);return t};e.prototype._downloadAsZip=function(e){for(var t,n=this,o=0,i={},a=this._urlDataSource.getDownloadAsZipPostUrl(e[0].ownerId),r=this._callBackIndex++,s=this._urlDataSource.getDownloadAsZipIframeUrl(this._canary),d=[],l=0;l<e.length;l++)if(e[l]){o+=(t=e[l]).size;i[t.extension]=(+i[t.extension]||0)+1;d.push(t.id)}var c={fileSize:o,itemCount:d.length,extensions:i,authed:"true"};if(!this._userInfoDataSource.isAuthenticated()&&2147483648<o){var u=this._urlDataSource.getForceLoginDownloadUrl(t);this._navigation.navigateTo(u)}else{var p=v.getUrlWithoutQueryString(s),m=b.deserializeQuery(v.getQueryStringFromUrl(s));s=p+"?"+b.serializeQuery(g.__assign({},m,{callbackIndex:r}));var f,h="downloadAsZipIframeReady_"+r;window[h]=function(){c.url=a;c.ids=d.join(":");var e=n._urlDataSource.getAuthKeyParamValue(),t=n._urlDataSource.getTicketParamValue();f.contentWindow.startDownloadAsZip(d.join(";"),n._canary,t,e,a);n.async.setTimeout(function(){window.document.body.removeChild(f);window[h]=null},6e4)};f=this._initIframe(s)}};e.dependencies=g.__assign({},n.default.dependencies,{graphDataSource:l.graph,navigation:o.navigation,platformDetection:r.platformDetection,urlDataSource:c.urlDataSource,userInfoDataSource:l.userInfo});return e}(n.default);t.default=u;t.resourceKey=i.createResolvedResourceKey(""+e("module").id,u)});define("odsp-next/controls/oneUp/other/commands/ItemActionBar",["require","exports","./ItemActionBarViewModel","../../../../bindings/component/ControlBinding","./ItemActionBar.html"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-item-action-bar",name:e("module").id,template:e("./ItemActionBar.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/oneUp/other/commands/ItemActionBarViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../buttonBar/ButtonBar","./OneUpOtherInlineCommandSet"],function(e,t,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){n.__extends(e,o);function e(e,t){var n=o.call(this,e,t)||this;n.component={name:i.default.tagName,params:{commandSet:new(n.child(a.default))({forceExternal:e.forceExternal,item:e.item,hideOpenCommand:e.hideOpenCommand})}};return n}return e}(o.default);t.default=r});define("odsp-next/controls/oneUp/other/commands/OneUpOtherInlineCommandSet",["require","exports","tslib","../../../commands/Command","../../../commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../commands/BaseCommandSet"],function(e,t,n,r,s,d,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(a){n.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._actionMap=t.resources.consume(d.actionMap);var n=t.observables,o=e.forceExternal,i=e.hideOpenCommand;o||t.commands.push(new(t.managed(r.CommandViewModel))({text:s.strings.Open,action:new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"OneUpOther.Open.Click",userInvokedItem:!0,item:e.item,hideIfDefaultIsDownload:!0}),isHidden:n.pureCompute(function(){return n.unwrap(i)})}));t.commands.push(new(t.managed(r.CommandViewModel))({text:s.strings.Download,action:new(t.managed(t._actionMap.DownloadAction))({item:e.item})}));return t}return e}(o.default);t.default=i});define("odsp-next/controls/oneUp/other/commands/ItemActionBar.html",[],function(){return"\x3c!--ko component: component--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/currentPage/CurrentPage",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CurrentPageViewModel","./CurrentPage.html","./CurrentPage.css"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-current-page-control",template:e("./CurrentPage.html"),viewModel:o.default,synchronous:!0});t.default=i});define("odsp-next/controls/currentPage/CurrentPageViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","./CurrentPage.resx","../pdfViewer/PdfViewer.resx","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/SelectOnFocusBinding"],function(e,t,o,i,n,a,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.addBindingHandlers({keyboard:s.default,selectOnFocus:d.default});t.focused=e.focused;t.pageCount=e.pageCount;t.inputFocused=e.inputFocused;t._currentPage=e.currentPage;t.currentPage=t.createObservable("1");t._changePage=e.changePage||function(e){t._currentPage(e)};t.ofPagesLabel=t.createPureComputed(t._computeOfPages);t.pageInfoLabel=t.createPureComputed(t._computeContainerLabel);t.pageInputLabel=t.createPureComputed(t._computeInputLabel);t.createBackgroundComputed(t._updateCurrentPage);return t}e.prototype.onEnter=function(){var e=this._validateInput(this.currentPage.peek());e!==this._currentPage.peek()?this._changePage(e):this.currentPage(this._currentPage.peek().toString())};e.prototype.onEscape=function(){this.focused(!0);this.currentPage(this._currentPage.peek().toString());return!1};e.prototype._computeOfPages=function(){return i.format(r.strings.ofPages,this.pageCount())};e.prototype._computeContainerLabel=function(){return i.format(a.strings.PageInfoAria,this.currentPage(),this.pageCount())};e.prototype._computeInputLabel=function(){return i.format(a.strings.PageInputAria,this.pageCount())};e.prototype._updateCurrentPage=function(){this.currentPage(this._currentPage().toString())};e.prototype._validateInput=function(e){var t=parseInt(e,10);if(isNaN(t))return this._currentPage.peek();var n=this.pageCount.peek();return n<t?n:t<1?1:t};return e}(n.default);t.default=l});define("odsp-next/controls/currentPage/CurrentPage.html",[],function(){return'<div class=od-CurrentPage role=menuitem data-bind="hasFocus: focused, attr: { \'aria-label\': pageInfoLabel, tabindex: focused() ? 0: -1 }"><div class=od-CurrentPage-inputContainer><input type=text class=od-CurrentPage-pageInput data-bind="selectOnFocus, hasFocus: inputFocused, textInput: currentPage, attr: { \'aria-label\': pageInputLabel, tabindex: inputFocused() ? 0: -1 }, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter, Esc: onEscape } }"></div><div class=od-CurrentPage-ofPagesLabel data-bind="text: ofPagesLabel"></div></div>'});define("odsp-next/controls/currentPage/CurrentPage.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-CurrentPage{display:inline-block;text-align:center}html[dir=ltr] .od-CurrentPage{margin-right:8px}html[dir=rtl] .od-CurrentPage{margin-left:8px}.od-CurrentPage-inputContainer{display:inline-block;height:100%;vertical-align:top}.od-CurrentPage-pageInput{width:34px;text-align:center;height:32px;margin-top:4px;outline:0}html[dir=ltr] .od-CurrentPage-pageInput{margin-right:4px}html[dir=rtl] .od-CurrentPage-pageInput{margin-left:4px}.lg .od-CurrentPage-pageInput,.xlg .od-CurrentPage-pageInput,.xxlg .od-CurrentPage-pageInput,.xxxlg .od-CurrentPage-pageInput,.xxxxlg .od-CurrentPage-pageInput{margin-top:2px}.od-CurrentPage-ofPagesLabel{margin-top:10px;display:inline-block;font-size:14px}html[dir=ltr] .od-CurrentPage-ofPagesLabel{margin-right:2px}html[dir=rtl] .od-CurrentPage-ofPagesLabel{margin-left:2px}"}])});