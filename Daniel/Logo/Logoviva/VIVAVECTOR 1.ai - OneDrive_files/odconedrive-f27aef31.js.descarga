define("odsp-next/ODCOneDrive",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odc-core/lib/Init","knockout","@ms/odsp-utilities/lib/resources/Resources","./resources/ModelResourceKeys","./resources/DataSourceResourceKeys","./resources/ODCResourceKeys","./resources/LoggingResourceKeys","./resources/ProviderResourceKeys","./models/store/UserSettingsStore","./models/store/UserInfoStore","./dataSources/settings/odc/SettingsDataSource","./dataSources/item/odc/ItemDataSource","./dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key","./dataSources/restore/odc/RestoreOperationDataSource.key","./dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key","./dataSources/search/odc/SearchDataSource.key","./dataSources/item/odc/RecycleBinDataSource","./dataSources/language/odc/LanguageDataSource","./dataSources/leftNav/odc/LeftNavDataSource","./dataSources/peoplePicker/odc/PeoplePickerDataSource","./dataSources/sharing/odc/SharingDataSource","./dataSources/sharing/odc/SharingDataDataSource","./dataSources/suiteNav/odc/SuiteNavDataSource","./utilities/logging/odc/Beacon","./dataSources/mobileAppPath/odc/IOSMobilePathDataSource","./dataSources/url/odc/UrlDataSource","./resources/UtilityResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation","./dataSources/download/odc/DownloadDataSource.key","./dataSources/identity/odc/IdentityDataSource","@ms/odsp-datasources/lib/Permissions","./dataSources/userInfo/odc/UserInfoDataSource","./dataSources/versionControl/VersionControlDataSource","./dataSources/versionHistory/odc/VersionHistoryDataSource","./dataSources/album/odc/AlbumDataSource","./dataSources/tag/odc/TagDataSource","./dataSources/photo/odc/PhotoDataSource","./resources/ControlResourceKeys","./providers/instrumentation/InstrumentationProvider","@ms/odsp-utilities/lib/logging/events/Nav.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","./dataSources/feedback/odc/FeedbackDataSource","./dataSources/sendFeedback/odc/SendFeedbackDataSource","./dataSources/userActivity/odc/UserActivityDataSource","./providers/userActivity/UserActivityProvider","./providers/feedback/FeedbackProvider","./providers/embed/EmbedProvider","./dataSources/embed/odc/EmbedDataSource","./providers/userInfo/UserInfoProvider","./providers/teachingBubble/TeachingBubbleProvider","./providers/ransomwareDetection/RansomwareDetectionProvider","./providers/tag/TagProvider","./providers/photo/PhotoProvider","./providers/storageInfo/StorageInfoProvider","./providers/storageOptions/StorageOptionsProvider","./providers/moveCopy/MoveCopyProvider","./providers/notification/NotificationProvider","./dataSources/application/odc/ApplicationDataSource","./dataSources/storageInfo/odc/StorageInfoDataSource","./providers/ticketRedeemer/TicketRedeemerProvider","./dataSources/storageOptions/odc/StorageOptionsDataSource","./providers/subscriptions/SubscriptionsProvider","./dataSources/subscriptions/vroom/SubscriptionsDataSource","./providers/thumbnail/ThumbnailProvider","./dataSources/instrumentation/odc/InstrumentationDataSource","./dataSources/encoding/odc/EncodingDataSource","./dataSources/videoItem/odc/VideoItemDataSource.key","./dataSources/item/odc/MoveCopyDataSource","./providers/bundleLoader/BundleLoaderProvider","./dataSources/upsell/odc/UpsellDataSource","./providers/upsell/UpsellProvider","./utilities/features/Features","./actions/odc/ActionMap","./dataSources/itemCommand/odc/ItemCommandDataSource","./dataSources/processFilters/odc/ProcessFiltersDataSource","./providers/processFilters/ProcessFiltersProvider","./utilities/optimizely/OptimizelyHelper","./utilities/purchaseLogging/AwaHelper","./controls/oneDriveApp/OneDriveApp","@ms/odsp-utilities/lib/require/RequireConfigInjector","./dataSources/bundle/odc/BundleDataSource","./roots/odc/OneDrivePrefetch","./utilities/experiment/ExperimentHelper","./utilities/attribution/AttributionHelper","./utilities/educationAndUpsells/EducationAndUpsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./dataSources/teachingBubble/odc/TeachingBubbleDataSource","./dataSources/recycleBin/odc/RecycleBinDataSource","./providers/recycleBin/RecycleBinProvider","./providers/dragAndDropRobot/DragAndDropRobotProvider","./providers/uploadTeachingBubble/UploadTeachingBubbleProvider","@ms/odsp-utilities/lib/modules/Modules","./controls/list/columns/ListColumns","./dataSources/pushChannel/odc/PushChannelDataSource.key","./providers/pushChannel/PushChannelProvider.key","./dataSources/rootItems/odc/RootItems.key","./dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key","./providers/itemAutoRefresh/ItemAutoRefreshProvider.key","./dataSources/inAppMessaging/odc/InAppMessagingDataSource.key","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider","./controls/shim/base/Base.css","./controls/FabricIconsDeferred","./utilities/TestHooks"],function(r,e,t,i,o,n,a,s,u,l,c,d,p,m,f,h,g,v,y,b,_,S,x,P,I,w,A,T,k,C,D,E,L,O,R,M,F,N,U,B,H,K,q,V,G,j,z,W,Q,$,X,J,Y,Z,ee,te,re,ie,oe,ne,ae,se,ue,le,ce,de,pe,me,fe,he,ge,ve,ye,be,_e,Se,xe,Pe,Ie,we,Ae,Te,ke,Ce,De,Ee,Le,Oe,Re,Me,Fe,Ne,Ue,Be,He,Ke,qe,Ve,Ge,je,ze,We){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i.default();var Qe=De.default.resources,$e=new D.default;Qe.expose(s.bundle,new(Qe.injected(Ce.default)));var Xe=new(Qe.injected(ve.default));Qe.expose(c.bundleLoader,Xe);Qe.expose(a.userSettingsStore,new d.default({defaultRootItemId:"root",viewerId:k.default.viewerId}));Qe.expose(a.userInfoStore,new p.default);Qe.expose(Re.navigation,$e);var Je=new(Qe.injected(R.default));Qe.expose(s.userInfo,Je);Qe.expose(c.userInfo,new(Qe.injected(J.default)));Qe.expose(C.experimentHelper,new(Qe.injected(Ee.default)));Qe.expose(Le.resourceKey,new(Qe.injected(Le.default)));var Ye=new(Qe.injected(k.default));q.Nav.logData({url:location.href,viewParams:$e.viewParams});$e.viewParams&&"1"===$e.viewParams.su?V.Engagement.logData({name:"SignUpCompletedODC"}):$e.viewParams&&"1"===$e.viewParams.gologin&&V.Engagement.logData({name:"SignInCompletedODC"});"/photos"===location.pathname&&$e.updateViewParams({v:"photos"},{ignoreHistory:!0,clearPath:!0});Qe.expose(s.url,Ye);Qe.expose(u.urlDataSource,Ye);Qe.exposeFactory(s.identity,new n.AliasResourceFactory(L.resourceKey));var Ze=Qe.consume(s.identity).getIdentity();ke.default.addPaths({optimizely:k.default.OPTIMIZELY_URL});var et=Ze.id||"UnAuth";we.OptimizelyHelper.init(et,window.$Config.mkt,Ze.type===O.IdentityType.anonymous);Xe.waitForPLT().then(function(){return Ae.default.init()});Qe.exposeFactory(s.subscriptions,new n.AliasResourceFactory(de.resourceKey));Qe.expose(c.subscriptions,new(Qe.injected(ce.default)));var tt=new(Qe.injected(f.default));Qe.expose(s.getItem,tt);Qe.expose(s.items,tt);Qe.expose(s.deleteRestore,tt);Qe.expose(s.schema,tt);Qe.expose(u.itemDataSource,tt);Qe.expose(s.storageInfo,new(Qe.injected(se.default)));Qe.expose(c.storageInfo,new(Qe.injected(re.default)));Qe.expose(s.storageOptions,new(Qe.injected(le.default)));Qe.expose(c.storageOptions,new(Qe.injected(ie.default)));Qe.expose(u.recycleBinDataSource,new(Qe.injected(b.default)));Qe.expose(H.useMobileList,!1);Qe.exposeFactory(s.search,new n.AliasResourceFactory(y.resourceKey));Qe.exposeFactory(s.ransomwareDetection,new n.AliasResourceFactory(h.resourceKey));Qe.exposeFactory(s.restore,new n.AliasResourceFactory(g.resourceKey));Qe.exposeFactory(s.restoreActivities,new n.AliasResourceFactory(v.resourceKey));Qe.expose(s.language,new(Qe.injected(_.default)));Qe.expose(s.settings,new m.default);Qe.expose(Oe.resourceKey,new(Qe.injected(Oe.default)));Qe.expose(H.isFirstRunExperienceVisible,o.observable(!1));Qe.expose(H.hasSeenPositioningThisSession,o.observable(!1));Qe.expose(H.mobileUpsellDismissedThisSession,o.observable(!1));Qe.exposeAsync(s.graphUrl,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./dataSources/graphUrl/GraphUrlDataSource",getModule:function(){return new t.default(function(e,t){r(["./dataSources/graphUrl/GraphUrlDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})}));Qe.exposeAsync(c.graphToken,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./providers/graphToken/GraphTokenProvider",getModule:function(){return new t.default(function(e,t){r(["./providers/graphToken/GraphTokenProvider"],e,t)})},getExport:function(e){return e.resourceKey}})}));Qe.exposeAsync(s.peopleService,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./dataSources/people/graph/PeopleDataSource",getModule:function(){return new t.default(function(e,t){r(["./dataSources/people/graph/PeopleDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})}));Qe.exposeFactory(s.rootItems,new n.AliasResourceFactory(Ge.resourceKey));Qe.expose(s.people,new(Qe.injected(x.default)));Qe.expose(s.suiteNav,new(Qe.injected(w.default))({}));Qe.expose(s.application,new(Qe.injected(ae.default)));Qe.expose(l.beacon,new A.default);Qe.expose(s.album,new(Qe.injected(N.default)));Qe.expose(s.tag,new(Qe.injected(U.default)));Qe.expose(s.iosMobileAppPath,new(Qe.injected(T.default)));Qe.exposeFactory(s.download,new n.AliasResourceFactory(E.resourceKey));Qe.expose(s.versionControl,new(Qe.injected(M.default)));Qe.expose(s.versionHistory,new(Qe.injected(F.default)));Qe.expose(s.instrumentation,new(Qe.injected(me.default)));Qe.expose(c.instrumentation,new(Qe.injected(K.default)));Qe.expose(s.sharing,new(Qe.injected(P.default)));Qe.expose(s.sharingData,new(Qe.injected(I.default)));Qe.expose(H.isDebugWindowVisible,o.observable(!0));Qe.expose(H.isItemSetRendered,o.observable(!1));Qe.expose(s.feedback,new(Qe.injected(G.default)));Qe.expose(c.feedback,new(Qe.injected(Q.default)));Qe.expose(s.sendFeedback,new(Qe.injected(j.default)));Qe.expose(s.embed,new(Qe.injected(X.default)));Qe.expose(c.embed,new(Qe.injected($.default)));Qe.expose(s.userActivity,new(Qe.injected(z.default)));Qe.expose(c.userActivity,new(Qe.injected(W.default)));Qe.expose(H.viewParams,o.observable({}));Qe.expose(s.copy,new(Qe.injected(ge.default)));Qe.expose(oe.resourceKey,new(Qe.resolved(oe.default))({}));Qe.expose(s.teachingBubble,new(Qe.injected(Me.default)));Qe.exposeFactory(c.teachingBubble,new n.AliasResourceFactory(Y.resourceKey));Qe.exposeFactory(c.ransomwareDetection,new n.AliasResourceFactory(Z.resourceKey));Qe.expose(s.photo,new(Qe.injected(B.default)));Qe.expose(c.photo,new(Qe.injected(te.default)));Qe.expose(s.processFilters,new(Qe.injected(Pe.default)));Qe.expose(c.processFilters,new(Qe.injected(Ie.default)));Qe.expose(c.tag,new(Qe.injected(ee.default)));Qe.expose(c.notification,new(Qe.injected(ne.default)));Qe.expose(c.thumbnail,new(Qe.injected(pe.default)));Qe.expose(c.ticketRedeemer,new(Qe.injected(ue.default)));Qe.expose(s.encoding,new(Qe.injected(fe.default)));Qe.exposeFactory(s.videoItem,new n.AliasResourceFactory(he.resourceKey));Qe.expose(s.bundle,new(Qe.injected(Ce.default)));Qe.expose(s.upsell,new(Qe.injected(ye.default))({}));Qe.expose(c.upsell,new(Qe.injected(be.default))({}));Qe.expose(H.actionMap,new(Qe.injected(Se.default)));Qe.expose(s.itemCommand,new(Qe.injected(xe.default)));Qe.expose(s.leftNav,new(Qe.injected(S.default)));Qe.expose(s.recycleBin,new(Qe.injected(Fe.default)));Qe.expose(c.recycleBin,new(Qe.injected(Ne.default)));Qe.expose(c.dragAndDropRobot,new(Qe.injected(Ue.default)));Qe.expose(c.uploadTeachingBubble,new(Qe.injected(Be.default)));Qe.expose(H.didUserUploadOrCreateFile,o.observable(!1));Qe.expose(H.didUserEnterPasswordForFile,o.observable(!1));Qe.exposeAsync(Ke.columnMenuHelperTypeResourceKey,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./controls/columnsHeader/SortColumnCommandHelper",getModule:function(){return new t.default(function(e,t){r(["./controls/columnsHeader/SortColumnCommandHelper"],e,t)})},getExport:function(e){return e.typeResourceKey.local}})}));Qe.exposeAsync(s.batchUploaderType,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./dataSources/upload/odc/BatchUploader",getModule:function(){return new t.default(function(e,t){r(["./dataSources/upload/odc/BatchUploader"],e,t)})},getExport:function(e){return e.typeResourceKey}})}));Qe.exposeAsync(s.vroomItemIdentityProcessor,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./dataSources/base/odc/vroom/ItemIdentityProcessor",getModule:function(){return new t.default(function(e,t){r(["./dataSources/base/odc/vroom/ItemIdentityProcessor"],e,t)})},getExport:function(e){return e.resourceKey}})}));Qe.exposeAsync(s.graph,new n.AliasResourceLoader(function(){return He.loadModuleExport({path:"./dataSources/graph/odc/GraphDataSource",getModule:function(){return new t.default(function(e,t){r(["./dataSources/graph/odc/GraphDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})}));if(_e.isFeatureEnabled(_e.QuotaBundleEnabled)){var rt=Xe.createDeferredContext(3);rt.expose(s.quota,"odsp-next/dataSources/quota/odc/QuotaDataSource",function(){return new t.default(function(e,t){r(["odsp-next/dataSources/quota/odc/QuotaDataSource"],e,t)})});rt.expose(c.quota,"odsp-next/providers/quota/UserStateProvider",function(){return new t.default(function(e,t){r(["odsp-next/providers/quota/UserStateProvider"],e,t)})})}var it=Xe.createDeferredContext(5);it.expose(s.firstRunExperience,"odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource",function(){return new t.default(function(e,t){r(["odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource"],e,t)})});it.expose(c.firstRunExperience,"odsp-next/providers/firstRunExperience/FirstRunExperienceProvider",function(){return new t.default(function(e,t){r(["odsp-next/providers/firstRunExperience/FirstRunExperienceProvider"],e,t)})});it.expose(s.guidedTour,"odsp-next/dataSources/guidedTour/odc/GuidedTourDataSource",function(){return new t.default(function(e,t){r(["odsp-next/dataSources/guidedTour/odc/GuidedTourDataSource"],e,t)})});it.expose(c.guidedTour,"odsp-next/providers/guidedTour/GuidedTourProvider",function(){return new t.default(function(e,t){r(["odsp-next/providers/guidedTour/GuidedTourProvider"],e,t)})});Xe.createDeferredContext(1);if(_e.isFeatureEnabled(_e.EnablePushChannel)){Qe.exposeFactory(s.pushChannel,new n.AliasResourceFactory(qe.resourceKey));Qe.exposeFactory(s.itemAutoRefresh,new n.AliasResourceFactory(je.resourceKey));Qe.consumeAsync(_e.isFeatureEnabled(_e.EnablePushChannelAutoRefresh)?ze.resourceKey:Ve.resourceKey)}_e.isFeatureEnabled(_e.UseInAppMessagingAPI)&&Qe.exposeFactory(s.inAppMessaging,new n.AliasResourceFactory(We.resourceKey));var ot=Xe.createDeferredContext(2);ot.expose(s.notifications,"odsp-next/dataSources/notifications/odc/NotificationsDataSource",function(){return new t.default(function(e,t){r(["odsp-next/dataSources/notifications/odc/NotificationsDataSource"],e,t)})});ot.expose(c.notificationManager,"odsp-next/providers/notificationManager/NotificationManager",function(){return new t.default(function(e,t){r(["odsp-next/providers/notificationManager/NotificationManager"],e,t)})});var nt=document.createElement("div");document.body.appendChild(nt);o.applyBindingsToNode(nt,{component:{name:Te.default.tagName,params:{resources:Qe}}});window.__ko=o});define("@ms/odc-core/lib/Init",["require","exports","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/PageInit","@ms/odsp-utilities/lib/aria/AriaLogger","./PageConfig","@ms/odsp-utilities/lib/logging/EventBase","@ms/odsp-utilities/lib/logging/ManagerExtended","@ms/odsp-utilities/lib/logging/UnhandledErrorHandler","@ms/odsp-utilities/lib/logging/RequireJSErrorHandler","@ms/odsp-shared/lib/utilities/logging/KnockoutErrorHandler","@ms/odsp-utilities/lib/logging/PromiseErrorHandler","@ms/odsp-utilities/lib/logging/ErrorUI","@ms/odsp-utilities/lib/logging/QOEHelper"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=2048,u=/authkey=[!a-zA-Z0-9]*/gi;0;r.Manager.cleanString=function(e){if(e){(e+="").length>s&&(e=e.substring(0,s));e=e.replace(u,"")}return e};i.default.init();var l="dev"!==window.Flight.version&&!!window.Flight.UserGroup&&("df"===window.Flight.UserGroup.toLowerCase()||"prod"===window.Flight.UserGroup.toLowerCase());o.default.Init(l?"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157":"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",{isAuthenticated:n.default.isAuthenticated(),market:n.default.getMarket(),session:window.Flight.session,version:window.Flight.version,manifest:window.Flight.manifest,userId:n.default.isAuthenticated()&&"0"!==window.Flight.cid?window.Flight.cid:window.Flight.xid,accountType:n.default.isAuthenticated()?a.AccountType.Consumer:a.AccountType.ConsumerAnonymous,environment:"ODC_"+window.Flight.UserGroup,workload:"ODC",disableCookies:!n.default.isAuthenticated()});t.default=function(){}});define("@ms/odsp-utilities/lib/logging/PageInit",["require","exports","./events/PageInit.event","./ManagerExtended"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(){}e.init=function(){i||(i=r.PageInit.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return i};return e}();t.default=o});define("@ms/odsp-utilities/lib/logging/events/PageInit.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PageInit=r.createSingleEvent({eventName:"PageInit,",shortEventName:"PageInit",requiresParent:!1},{screenWidth:2,screenHeight:2,availableScreenWidth:2,availableScreenHeight:2,renderWidth:2,renderHeight:2,browserWidth:2,browserHeight:2,devicePixelRatio:2,referrer:1});t.default=t.PageInit});define("@ms/odsp-utilities/lib/logging/ManagerExtended",["require","exports","@ms/telemetry-manager/lib/Manager","../features/Features","@ms/telemetry-manager/lib/ManagerExtended"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.Manager.addFeatureEnabler(function(e){return i.default.isFeatureEnabled(e)})});define("@ms/telemetry-manager/lib/ManagerExtended",["require","exports","./Manager","./EventBase","./events/ValidationError.event"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.Manager.addValidationErrorLogger(function(e,t){var r=o.ValidationErrorType[t];n.ValidationError.enabled()&&n.ValidationError.logData({message:"Validation error for "+e.shortEventName+" of type "+r,validatedEventName:e.shortEventName,validatedFullEventName:e.eventName,validationType:r,stack:i.Manager.getStack()||""},e)})});define("@ms/telemetry-manager/lib/events/ValidationError.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=r.createSingleEvent({eventName:"ValidationError,",shortEventName:"ValidationError",samplingFeature:{ODB:-1,ODC:"ValidationErrorSampling",Fallback:!1},critical:!0,requiresParent:!1},{message:1,validationType:1,validatedEventName:1,validatedFullEventName:1,stack:1})});define("@ms/odsp-utilities/lib/aria/AriaLogger",["require","exports","../features/Features","./AriaLoggerCore"],function(i,e,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=function(){function e(){}e.Init=function(t,r){(r.forceEnabled||o.default.isFeatureEnabled(this.EnableAriaLogging))&&i(["aria"],function(e){n.default.Init(t,r,e)})};Object.defineProperty(e,"logStartEvents",{get:function(){return n.default.logStartEvents},set:function(e){n.default.logStartEvents=e},enumerable:!0,configurable:!0});e.getAriaTimeZone=function(e){var t=Math.abs(e),r=t%60,i=Math.floor(t/60);return(0<e?"-":"+")+(10<=i?i:"0"+i)+":"+(10<=r?r:"0"+r)};e.EnableAriaLogging={ODB:588,ODC:"EnableAriaLogging",Fallback:!1};return e}();e.default=t});define("@ms/odsp-utilities/lib/aria/AriaLoggerCore",["require","exports","../logging/EventBase","../logging/Manager","../logging/events/Beacon.event","../logging/ErrorHelper","../browser/PlatformDetection","../logging/DataCompletenessInfo","../uri/SimpleUri","@ms/telemetry-addon-aria/lib/AriaTelemetryHandler","../async/Promise"],function(e,t,c,d,p,m,f,h,g,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b,_="AriaBeacon",S=!1,x={logStartEvents:!1,Init:function(e,t,r,i){void 0===i&&(i={});var o=i.platformDetection,n=void 0===o?new f.default:o;try{b=r;x.logStartEvents=!0;var a={AccountType:c.AccountType[t.accountType],BrowserIsMobile:n.isMobile,BrowserMajVer:n.browserMajor,BrowserMinVer:n.browserMinor,BrowserName:n.browserName,BrowserUserAgent:n.userAgent,Environment:t.environment,FarmLabel:t.farmLabel,IsAuthenticated:t.isAuthenticated?1:0,Market:t.market,Manifest:t.manifest,OSName:n.osName,OSVersion:n.osVersion,Session:t.session,SiteSubscriptionId:t.siteSubscriptionId||"",UserId:t.userId,Version:t.version,Workload:t.workload};t.farmLabel&&(a.FarmLabel=t.farmLabel);var s=new g.SimpleUri(t.completenessCallbackEndpoint),u={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,callbackEndpoint:s},l=new v.AriaTelemetryHandler({ariaLoader:function(){return y.CancelablePromise.resolve(b)},context:a,tenantToken:e,disableCookies:t.disableCookies,logStartEvents:x.logStartEvents,ariaQos:{isQosEvent:function(e){return p.Beacon.isTypeOf(e)&&!!e.data&&e.data.name===_},reportQos:function(e){var t=e.result,r=e.statusCode,i=e.events;new p.Beacon({name:_,retryCount:0,totalRetries:0,eventCount:i?i.length:0}).end({success:0===t,status:r+""});0;""!==s.authority&&new h.DataCompletenessInfo(u,t,r,(new Date).getTime(),i).send()}}});l.attach(d.Manager);S=!0}catch(e){e instanceof b.Exception&&(e=new Error("Aria error: "+e.toString()));m.default.log(e)}},isInitialized:function(e){return S}};t.default=x});define("@ms/odsp-utilities/lib/logging/events/Beacon.event",["require","exports","../PairedEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Beacon=r.createPairedEvent({eventName:"Beacon,",shortEventName:"Beacon",requiresParent:!1},{name:1,status:1,success:3,retryCount:2,totalRetries:2,eventCount:2});t.default=t.Beacon});define("@ms/odsp-utilities/lib/logging/DataCompletenessInfo",["require","exports","../xhr/XHR","./ErrorHelper"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r,i,o){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var n={};if(o)for(var a=0;a<o.length;++a)n[o[a].EventType]=n[o[a].EventType]+1||1;var s={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:r,EventCount:o?o.length:0,Timestamp:i,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:n,Workload:e.workload||"",FarmLabel:e.farmLabel||""};this._dataCompletenessJson=JSON.stringify(s)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!0,configurable:!0});e.prototype.send=function(){new r.default({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,r){0})};return e}();t.DataCompletenessInfo=o});define("@ms/odsp-utilities/lib/xhr/XHR",["require","exports","../async/Async","../logging/ErrorHelper","../object/ObjectUtil"],function(e,t,y,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.blocked=0]="blocked";e[e.exception=-1]="exception";e[e.timeout=-2]="timeout";e[e.abort=-3]="abort"}(t.XHRStatus||(t.XHRStatus={}));var r=function(){function v(e){this._async=new y.default(this);var t=e.url,r=e.requestTimeoutInMS,i=void 0===r?v.DEFAULT_TIMEOUT_MS:r,o=e.json,n=e.responseType,a=void 0===n?"":n,s=e.headers,u=void 0===s?{}:s,l=e.withCredentials,c=void 0!==l&&l,d=e.needsCors,p=void 0!==d&&d,m=e.onProgress,f=e.onUploadProgress,h=e.method,g=void 0===h?o?"POST":"GET":h;this._url=t;this._requestTimeoutInMS=i;this._postData=o;this._headers=u;this._method=g;this._withCredentials=c;this._needsCors=p;this._responseType=a;this._progressCallback=m;this._uploadProgressCallback=f}v.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};v.prototype.start=function(e,t){var r=this;this._successCallback=e;this._failureCallback=t;var i=this._method,o=this._headers;try{this._request=this._getRequest();var n=this._progressCallback,a=this._uploadProgressCallback,s=this._request,u=this._responseType;n&&(s.onprogress=function(e){try{n(e)}catch(e){c.default.logError(e)}});a&&(s.upload.onprogress=function(e){try{a(e)}catch(e){c.default.logError(e)}});this._async.setTimeout(function(){r._completed||r._timeoutCallback()},this._requestTimeoutInMS);s.onreadystatechange=function(){if(!r._completed){var e=4;try{e=s.DONE||4}catch(e){}s.readyState===e&&r._requestEndCallback()}};s.open(i,this._url,!0);"withCredentials"in s&&(s.withCredentials=this._withCredentials);s.responseType=u;for(var l in o)s.setRequestHeader(l,o[l]);s.send(this._postData)}catch(e){c.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:d.safeSerialize(o),method:i});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};v.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};v.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};v.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};v.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){c.default.log(e)}};v.prototype._callFailureCallback=function(e,t,r){try{this._failureCallback&&this._failureCallback(e,t,r)}catch(e){c.default.log(e)}};v.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var t=-1;try{this._async.dispose();try{t=this._request.status}catch(e){}}catch(e){t=-1;c.default.log(e)}t<400&&0<t?this._callSuccessCallback(this._request,t):this._callFailureCallback(this._request,t,!1)}};v.DEFAULT_TIMEOUT_MS=3e4;return v}();t.default=r});define("@ms/odsp-utilities/lib/uri/SimpleUri",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.absolute=0]="absolute";e[e.relative=1]="relative";e[e.serverRelative=2]="serverRelative"}(t.UriFormat||(t.UriFormat={}));var r=function(){function e(e){void 0===e&&(e="");this._value=e}Object.defineProperty(e.prototype,"format",{get:function(){return this._getFormat()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"authority",{get:function(){return this._getAuthority()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"domain",{get:function(){return this._getDomain()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"segments",{get:function(){return this._getSegments()},enumerable:!0,configurable:!0});e.prototype._getFormat=function(){var e;if(this._getAuthority())e=0;else{var t=this._getPath();e=0===t.indexOf("/")?2:1}this._getFormat=function(){return e};return e};e.prototype._getAuthority=function(){var e,t=this._getEndIndexOfRootDelimeter();if(-1<t){var r=this._value.indexOf("/",t);e=-1<r?this._value.substring(0,r):this._value}else e="";this._getAuthority=function(){return e};return e};e.prototype._getDomain=function(){var e,t=this._getAuthority();if(t){var r=this._getEndIndexOfRootDelimeter();e=t.substring(r)}else e="";this._getDomain=function(){return e};return e};e.prototype._getPath=function(){var e,t=this._getEndIndexOfRootDelimeter();if(-1<t){var r=this._value.indexOf("/",t);e=-1<r?this._value.substring(r):""}else e=this._value;this._getPath=function(){return e};return e};e.prototype._getSegments=function(){var e=this._getPath().split("/");this._getSegments=function(){return e};return e};e.prototype._getEndIndexOfRootDelimeter=function(){var e,t=this._value.indexOf("//"),r=this._value.indexOf("/");e=-1<t&&t<=r?t+"//".length:-1;this._getEndIndexOfRootDelimeter=function(){return e};return e};return e}();t.SimpleUri=r;t.default=r});define("@ms/telemetry-addon-aria/lib/AriaTelemetryHandler",["require","exports","tslib","@ms/telemetry-manager/lib/EventBase","./AriaEventBuilder","@ms/telemetry-manager/lib/ErrorHelper","@ms/utilities-strings/lib/index"],function(e,t,h,s,u,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=e.logStartEvents,r=void 0===t||t,i=e.context,o=void 0===i?{}:i;this._ariaLoader=e.ariaLoader;this._logStartEvents=r;this._disableCookies=e.disableCookies;this._tenantToken=e.tenantToken;this._ariaQosParams=e.ariaQos;this._ariaOfflineCacheParams=e.offlineCache;this._context=o}e.prototype.attach=function(t){var r,i=this,o=!1;this._getAria().then(function(e){if(!o){r=i._createLogHandler(e);t.addLogHandler(r).forEach(r)}});return function(){o=!0;r&&t.removeLogHandler(r)}};e.prototype._getAria=function(){var t=this,e=this._ariaLoader().then(function(e){t._initializeLogManager(e);return e});this._getAria=function(){return e};return e};e.prototype._createLogHandler=function(i){var o=this,n=this._createLogger(i),a=this._ariaQosParams;return function(e){try{if(e.enabled&&(e.eventType!==s.ClonedEventType.Start||o._logStartEvents)&&(!a||!a.isQosEvent(e))){var t=u.buildAriaEvent(i,e);n.logEvent(t)}}catch(e){var r=void 0;e instanceof i.Exception&&(r=new Error("Aria error: "+e.toString()));e&&e.handled||l.log(r||e)}}};e.prototype._initializeLogManager=function(t){var o=this,e=this._ariaOfflineCacheParams;if(!t.LogManager.isInitialized()){t.LogManager.initialize(this._tenantToken,h.__assign({disableCookies:this._disableCookies},e?{browserOverrides:{onGetData:e.getData,onSaveData:e.saveData}}:{}));"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(e){t.LogManager.flush()})}var n=this._ariaQosParams;n&&t.LogManager.addCallbackListener(function(e,t,r,i){r===o._tenantToken&&n.reportQos({result:e,statusCode:t,events:i})})};e.prototype._createLogger=function(e){var t=new e.Logger(this._tenantToken),r=this._context,i=r.Session,o=r.Version,n=r.OSName,a=r.OSVersion,s=r.Market,u=r.UserId,l=r.Manifest,c=h.__rest(r,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),d=t.getSemanticContext();if(d.contextMap){i&&(d.contextMap["AppInfo.Session"]=i);l&&(d.contextMap["AppInfo.Manifest"]=l)}o&&d.setAppVersion(o);d.setUserLanguage(s||"");u&&d.setUserId(u);n&&d.setDeviceOsName(n);a&&d.setDeviceOsVersion(a);for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var m=c[p];if(null==m)continue;var f=g.capitalize(p);t.setContext(f,c[p])}return t};return e}();t.AriaTelemetryHandler=r});define("@ms/telemetry-addon-aria/lib/AriaEventBuilder",["require","exports","@ms/telemetry-manager/lib/EventBase","@ms/utilities-strings/lib/index","@ms/telemetry-manager/lib/ErrorHelper"],function(e,t,h,g,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:h.ClonedEventType[e.eventType]};e.eventType===h.ClonedEventType.End&&(t.Duration=e.endTime-e.startTime);for(var r=e.eventName.split(","),i=0,o=r;i<o.length;i++){var n=o[i];n&&(t["WebLog_Type_"+n]=1)}var a=e.data,s=e.context;if(s)for(var u in s)if(Object.prototype.hasOwnProperty.call(s,u)){if(null==(c=s[u]))continue;t[p=g.capitalize(u)]=c}if(a)for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)){var c;if(null==(c=a[l]))continue;var d=e.metadata[l];if(d){var p=d.isPrefixingDisabled?g.capitalize(l):g.capitalize(d.definedInName)+"_"+l,m=d.type;if(4===m)for(var f in c)void 0!==c[f]&&(t[p+"_"+f.replace(".","_")]=c[f]);else t[p]=6===m?d.typeRef[c]:c}}return{name:e.isEventTypePrefixingDisabled?r[r.length-2]:"ev_"+r[r.length-2],values:t}}t.getAriaEventInfo=a;t.buildAriaEvent=function(e,t){var r=a(t),i=r.name,o=r.values,n=new e.EventProperties;n.name=i;!function(t,e,r){var i;try{for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o)){i=o;e.setProperty(o,r[o])}}catch(e){var n=void 0,a=void 0;if(e instanceof t.Exception){n=e.ErrorCode();a=new Error("Aria error: "+e.toString())}if(a){e.handled=!0;s.logError(a,{errorCode:n,propertyKey:i})}throw e}}(e,n,o);return n}});define("@ms/utilities-strings/lib/index",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=/\{(\d+)\}/g;function i(e){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return e.replace(u,function(e,t){var r=i[Number(t)];return null===r?"":""+r})}t.format=i;t.formatToArray=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i,o=[],n=0;i=u.exec(e);){var a=i[0],s=t[parseInt(a.replace(/\{|\}+/g,""),10)];i.index>n&&o.push(e.substring(n,i.index));n=u.lastIndex;o.push(s)}n!==e.length&&o.push(e.substring(n,e.length));return o};t.doesStringEndWith=function(e,t){return e.substr(e.length-t.length)===t};t.doesStringStartWith=function(e,t){return e.substr(0,t.length)===t};t.rightPad=function(e,t){for(var r=e.toString();r.length<t;)r+="0";return r};t.leftPad=function(e,t){for(var r=e.toString();r.length<t;)r="0"+r;return r};t.findOneOf=function(e,t){for(var r=0;r<e.length;r++)if(0<=t.indexOf(e[r]))return r;return-1};t.equalsCaseInsensitive=function(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t};t.capitalize=function(e){return e?e[0].toUpperCase()+e.substr(1):e};t.decapitalize=function(e){return e?e[0].toLowerCase()+e.substr(1):e};t.pluralSelect=function(e,t,r){return 1===e?t:r};function o(e,t,r){r=Number(r);if(void 0===e||void 0===t||void 0===r)return"";for(var i="",o=-1,n=t.split("||"),a=0,s=n.length;a<s;a++){var u=n[a];if(u){for(var l=0,c=u.split(",");l<c.length;l++){var d=c[l];if(d)if(isNaN(Number(d))){if(-1!==d.indexOf("-")){var p=d.split("-");if(2!==p.length)continue;var m=void 0;if(""===p[0])m=0;else{if(isNaN(Number(p[0])))continue;m=parseInt(p[0],10)}if(m<=r){if(""===p[1]){o=a;break}if(isNaN(Number(p[1])))continue;if(r<=parseInt(p[1],10)){o=a;break}}}else if(-1!==d.indexOf("*")){var f=d.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+f+"$").test(r.toString())){o=a;break}}}else{if(r===parseInt(d,10)){o=a;break}}}if(-1!==o)break}}if(-1!==o){var h=e.split("||");h[o]&&(i=h[o])}return i}t.getLocalizedCountValue=o;t.formatWithLocalizedCountValue=function(e,t,r){return i(o(e,t,r)||"",r.toString())}});define("@ms/odc-core/lib/PageConfig",["require","exports","cookies"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(){}n.getAnid=function(){var e=a.get(n.ANON_ID_COOKIE_KEY),t="";if(e)for(var r=e.split("&"),i=0;i<r.length;i++){var o=r[i];0===o.indexOf("A=")&&2<o.length&&(t=o.substr(2,o.length))}return t};n.getMarket=function(){return $Config.mkt};n.getLanguage=function(){return $Config.lang};n.isNewUser=function(){return 0===FilesConfig.freRenderIndex};n.isAuthenticated=function(){return $Config.isAuthenticated||window.FilesConfig&&!FilesConfig.si};n.ANON_ID_COOKIE_KEY="ANON";return n}();t.default=r});define("@ms/odsp-utilities/lib/logging/UnhandledErrorHandler",["require","exports","./events/UnhandledError.event"],function(e,u,l){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=10,a=50;u.MAXERRORS=100;var d=0;function p(e){var t;if(e){var r=e&&e.toString?e.toString():"InvalidMethod()",i=8===r.indexOf(" ")?9:0,o=r.indexOf(")")+1;if(0===(t=r.substring(i,o)).indexOf("function")||t.indexOf("(")<3){var n=o+a;t=function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e}(r=r.replace(/\s\s*/g," "),n)+(n<r.length?"}":"")}}return t}function m(e,t,r,i,o){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,r,i,o])}catch(e){}var n=o&&o.stack,a=function e(){var t,r=[];try{t=arguments.callee;for(;t===m||t===e;)t=t?t.caller:t}catch(e){t=null}var i=0;try{for(;t&&i<c;){r.push(p(t));t=t.caller;i++}}catch(e){}return r}().join("\n"),s={message:e,url:t,line:r,col:i,stack:n=n?n.replace(/[ \t]{2,}/g," "):"",builtStack:a=a.replace(/[ \t]{2,}/g," ")};d<u.MAXERRORS?l.UnhandledError.logData(s):d===u.MAXERRORS&&l.UnhandledError.logData({message:"Hit max error limit of "+u.MAXERRORS,url:"NA",line:0,col:0,stack:"",builtStack:""});d++}u.handleOnError=m;window.onerror=m});define("@ms/odsp-utilities/lib/logging/events/UnhandledError.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledError=r.createSingleEvent({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0,requiresParent:!1},{message:1,stack:1,builtStack:1,line:2,col:2,url:1});t.default=t.UnhandledError});define("@ms/odsp-shared/lib/utilities/logging/KnockoutErrorHandler",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper","knockout"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.onError=function(e){r.default.log(e)}});define("@ms/odsp-utilities/lib/logging/PromiseErrorHandler",["require","exports","./ErrorHelper","../async/Async","../async/Promise","../events/EventGroup","../object/ObjectUtil","../logging/events/UnhandledPromise.event"],function(e,t,n,r,a,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new(function(){function e(){this._outstandingPromiseErrors={};this._async=new r.default}e.prototype.log=function(e){var t=this,r=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[r];else{this._outstandingPromiseErrors[r]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var o=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(o).forEach(function(e){var t=o[e],r=t.exception?t.exception:t.error;r instanceof Error||r&&r.stack?a.default.isCanceled(t)||n.default.log(r):u.UnhandledPromise.logData({message:"Promise with no error callback",extraData:s.safeSerialize(r)});if(window.console&&console.log){var i="Promise with no error callback:"+t.id;console.warn?console.warn(i):console.log(i);console.log(t);r&&r.stack&&console.log(r.stack)}})},0)}};return e}());new i.default(o).on(a.default,"error",o.log)});define("@ms/odsp-utilities/lib/logging/events/UnhandledPromise.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledPromise=r.createSingleEvent({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise",samplingFeature:{ODB:!0,ODC:"UnhandledPromiseLogging",Fallback:!1},requiresParent:!1},{message:1,extraData:1});t.default=t.UnhandledPromise});define("@ms/odsp-utilities/lib/logging/ErrorUI",["require","exports","./Manager","./events/UnhandledError.event","./events/CaughtError.event","./events/QosError.event","./events/RequireJSError.event","./events/ValidationError.event","./EventBase"],function(e,t,r,i,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0});define("@ms/odsp-utilities/lib/logging/events/CaughtError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/CaughtError.event","@ms/telemetry-manager/lib/events/CaughtError.event"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);t.default=o.CaughtError});define("@ms/odsp-utilities/lib/logging/events/QosError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/QosError.event","@ms/telemetry-manager/lib/events/QosError.event"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);t.default=o.QosError});define("@ms/odsp-utilities/lib/logging/events/ValidationError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/ValidationError.event","@ms/telemetry-manager/lib/events/ValidationError.event"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);t.default=o.ValidationError});define("@ms/odsp-utilities/lib/logging/QOEHelper",["require","exports","./events/Qoe.event","./Manager","./events/Qos.event","./events/CaughtError.event","./events/RequireJSError.event","./events/UnhandledError.event","./events/PLT.event","./ErrorHelper"],function(e,t,r,i,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.AppLoad=0]="AppLoad";e[e.PLT=1]="PLT";e[e.SessionError=2]="SessionError"}(c=t.Stages||(t.Stages={}));var d=!1,p=!1,m=-1;function f(){m===c.SessionError-1&&y.markStage(c.SessionError)}function h(e){if(o.Qos.isTypeOf(e)){if(e.data.resultType===o.ResultTypeEnum.Failure){p=!0;f();d=!0}}else if(n.default.isTypeOf(e)||a.default.isTypeOf(e)||s.default.isTypeOf(e)){p=!0;f();d=!0}else if(u.default.isTypeOf(e)){y.markStage(c.PLT);d&&f()}}for(var g=0,v=i.Manager.addLogHandler(h);g<v.length;g++){h(v[g])}var y=function(){function e(){}e.markStage=function(e){if(e-1===m||e===c.AppLoad){r.default.logData({stage:c[e],errorBeforeStage:d,errorDuringStage:p});p=!1;m=e}else try{throw new Error("Stage "+c[e]+" - "+e+" came out of order - previous stage "+c[m]+" - "+m)}catch(e){l.default.log(e)}};e.reset=function(){p=d=!(m=-1)};return e}();(t.default=y).markStage(c.AppLoad)});define("@ms/odsp-utilities/lib/logging/events/Qoe.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Qoe=r.createSingleEvent({eventName:"Qoe,",shortEventName:"Qoe",requiresParent:!1},{stage:{isKey:!0,type:1},errorBeforeStage:3,errorDuringStage:3});t.default=t.Qoe});define("odsp-next/resources/ModelResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataStore=new r.ResourceKey("dataStore");t.userSettingsStore=new r.ResourceKey("userSettingsStore");t.userInfoStore=new r.ResourceKey("userInfoStore");t.smartFiltersStore=new r.ResourceKey("smartFiltersStore")});define("odsp-next/resources/LoggingResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.beacon=new r.ResourceKey("beacon");t.rumOneHelper=new r.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new r.ResourceKey("rumOneEmbedVideoHelper")});define("odsp-next/models/store/UserSettingsStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,"UserSettingsStore",o.default.local)||this;t._defaultRootItemId=e&&e.defaultRootItemId||"";t._viewerId=e&&e.viewerId||"";return t}e.prototype.setAllPhotosUserSettings=function(e){this.setValue(this._getLocalStorageKey(),e)};e.prototype.getAllPhotosUserSettings=function(){var e=this.getValue(this._getLocalStorageKey());if(!e){e={isAscending:!1,rootId:this._defaultRootItemId};this.setAllPhotosUserSettings(e);e=this.getValue(this._getLocalStorageKey())}return e};e.prototype._getLocalStorageKey=function(){return"allPhotosUserSettings&viewerId="+this._viewerId};return e}(r.default);t.default=n});define("odsp-next/models/store/UserInfoStore",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/models/store/BaseDataStore"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="userInfo",a=function(e){r.__extends(t,e);function t(){return e.call(this,"UserInfoStore")||this}t.prototype.getUserInfo=function(){var e=this.getValue(n);if(!e){e=i.observable(null);this.setValue(n,e)}return e};return t}(o.default);t.default=a});define("odsp-next/dataSources/settings/odc/SettingsDataSource",["require","exports","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=window.Flight,t=e&&e.Config,r=t&&t.odsp_media,i=r?"odsp-media/"+r+"/media":"odsp-media";o.default.addPaths({"@ms/odsp-media/lib":i});this.mediaBaseUrl=i};t.default=r});define("@ms/odsp-utilities/lib/require/RequireConfigInjector",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e}();t.default=r});define("odsp-next/dataSources/item/odc/ItemDataSource",["require","exports","tslib","./SkyApiItemDataSource","@ms/odsp-utilities/lib/async/Promise","../../url/QueryType","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(){return null!==o&&o.apply(this,arguments)||this}e.prototype.getItem=function(t){var e,r=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(r);t.qosName=t.qosName||"Odc."+a.default[i]+".ItemDataSource.getItem";switch(i){case a.default.SharedWithMe:e=this._getSharedDataSource().then(function(e){return e.getItem(t)});break;case a.default.Recent:e=this._getRecentDataSource().then(function(e){return e.getItem(t)});break;case a.default.RecycleBin:e=this._getRecycleBinDataSource().then(function(e){return e.getItem(t)});break;case a.default.Search:e=this._getSearchDataSource().then(function(e){return e.getItem(t)});break;default:e=o.prototype.getItem.call(this,t)}return e};e.prototype._getRecentDataSource=function(){var t=this,e=s.loadModule({path:"./RecentDataSource",getModule:function(){return new n.default(function(e,t){r(["./RecentDataSource"],e,t)})}}).then(function(e){return new(t.managed(e))});this._getRecentDataSource=function(){return e};return e};e.prototype._getSearchDataSource=function(){var t=this,e=s.loadModule({path:"./SearchDataSource",getModule:function(){return new n.default(function(e,t){r(["./SearchDataSource"],e,t)})}}).then(function(e){return new(t.managed(e))});this._getSearchDataSource=function(){return e};return e};e.prototype._getRecycleBinDataSource=function(){var t=this,e=s.loadModule({path:"./RecycleBinDataSource",getModule:function(){return new n.default(function(e,t){r(["./RecycleBinDataSource"],e,t)})}}).then(function(e){return new(t.managed(e))});this._getRecycleBinDataSource=function(){return e};return e};e.prototype._getSharedDataSource=function(){var t=this,e=s.loadModule({path:"./SharedDataSource",getModule:function(){return new n.default(function(e,t){r(["./SharedDataSource"],e,t)})}}).then(function(e){return new(t.managed(e))});this._getSharedDataSource=function(){return e};return e};return e}(i.default);e.default=o});define("odsp-next/dataSources/item/odc/SkyApiItemDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","../../../controls/leftPane/LeftPane.resx","../../item/odc/ODCDataSource.resx","../../base/odc/BatchRequest","../../base/odc/DataRequest","../../base/odc/ItemResultProcessor","knockout","../DeletionType","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","./ColumnsHelper","../../../models/store/ItemsStore","./SortDirectionMap","./SortFieldMap","../../url/odc/UrlDataSource","../../base/odc/ItemErrorProcessor","./ItemDataSourceHelper","../../../roots/odc/OneDrivePrefetch","@ms/odsp-utilities/lib/performance/PerformanceCollection","./MoveCopyDataSource","@ms/odsp-utilities/lib/async/Semaphore","../../base/odc/Config","../ItemTaskObserver"],function(e,t,T,r,p,i,o,n,a,m,s,u,c,d,k,f,h,g,C,v,y,b,_,S,x,D,E,P,I,w,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=0,l=function(t){T.__extends(l,t);function l(){var e=t.call(this)||this;e._itemDataSourceHelper=new(e.managed(x.default));e.isLargeRecycleBin=u.observable(!1);e._pendingGetItemRequests={};e._itemsStore=e.resources.consume(v.resourceKey);e._urlDataSource=e.resources.consume(h.urlDataSource);e._identity=e.resources.consume(g.identity);e._itemResultProcessor=new(e.managed(s.default))({getRootItemTitle:e.getRootItemTitle.bind(e),getItemKeyExtension:e._getItemKeyExtension.bind(e)});e._itemErrorProcessor=new(e.managed(S.default));e._rotationSemaphore=new I.default;return e}l.getServerDocumentType=function(e){var t;switch(e){case d.DocumentType.Word:t="w";break;case d.DocumentType.Excel:t="x";break;case d.DocumentType.PowerPoint:t="p";break;case d.DocumentType.OneNote:t="n";break;case d.DocumentType.ExcelSurvey:t="f"}return t};l.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),r=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(r,t,e)};l.prototype.getSpecifiedItems=function(e){return null};l.prototype.getColumns=function(e,t){void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer));return C.getColumns(e,this.resources,t)};l.prototype.deleteItems=function(t){var r=this,i=this._urlDataSource.getKeyParams(t.parentKey),e=t.items;e&&e[0].key&&!e[0].id&&(e=e.map(function(e){return r._itemsStore.getItem(e.key).peek()}));return a.default.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:e,getPostData:function(e){return{deletionType:t.deletionType?t.deletionType:c.default.Recycle,targetId:i.id,cid:_.default.viewerId,group:0,overrideLock:!!t.overrideLock,items:e.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,r=e;t<r.length;t++){r[t].eTag=""}}})};l.prototype.renameItem=function(e){var t=this,r=this._getUpdateItemsUrl(),i=e.item.name,o=e.newName+e.item.extension;if(e.nameHasExtension){var n=e.newName.lastIndexOf(".");if(0<n){var a=e.newName.substr(n+1);Array.isArray(w.Files.createTextDocumentExts)&&0<=w.Files.createTextDocumentExts.indexOf(a)&&(o=e.newName)}}var s=new m.default,u=this._urlDataSource.getKeyParams(e.parentKey),l=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:o,lid:u.id,rset:_.default.scenarioName,ownerId:e.ownerId});return s.send({apiName:"UpdateItem",url:r,requestType:"POST",postData:l,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return p.default.wrapError(t._itemErrorProcessor.getError(e,i).errorTitle)})};l.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new m.default).send({apiName:"GetOpenInClientDetails",url:t})};l.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),r=new m.default,i=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:_.default.viewerId});return r.sendPost("UpdateItem",t,i)};l.prototype.reportAbuse=function(e){var t=this,r=this._getReportAbuseUrl(),i=new m.default,o=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:_.default.viewerId,group:0,desc:e.desc,ref:window.location.href});return i.send({apiName:"ReportAbuse",url:r,requestType:"POST",postData:o,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return p.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};l.prototype.requestReview=function(e){var t=this,r=this._getRequestReviewUrl(),i=window.$Config,o=new m.default,n=JSON.stringify({email:i.email,ids:e.items.map(function(e){return e.id})});return o.send({apiName:"OwnerRequestReview",url:r,requestType:"POST",postData:n,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return p.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};l.prototype.updateBundle=function(e){var t=this,r=this._getUpdateBundleUrl(),i=new m.default,o=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return i.send({apiName:"UpdateBundle",url:r,requestType:"POST",postData:o,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return p.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};l.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),r=new m.default,i=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return r.sendPost("AbdicatePermissions",t,i)};l.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),r=new m.default,i=e.items.map(function(e){return e.id}),o=JSON.stringify({items:i,targetId:e.target.id,cid:_.default.viewerId,group:e.target.isGroup?1:0});return r.sendPost("AddFavorites",t,o)};l.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),r=new m.default,i=e.items.map(function(e){return e.id}),o=JSON.stringify({items:i,targetId:e.target.id,cid:_.default.viewerId,group:e.target.isGroup?1:0});return r.sendPost("RemoveFavorites",t,o)};l.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),r=new m.default,i=JSON.stringify({id:e.item.id,category:e.category,cid:_.default.viewerId});return r.sendPost("UpdateItem",t,i)};l.prototype.updateItemProperty=function(e){var t=this._getUpdateItemsUrl(),r=new m.default,i={id:e.item.id,lid:e.item.parent.id,overrideLock:(!!e.overrideLock).toString(),rset:_.default.scenarioName};i[e.propertyName]=e.propertyValue||"";return r.sendPost("UpdateItem",t,JSON.stringify(i))};l.prototype.createFolder=function(i){var o=this,e=this._getCreateFolderUrl(),t=this._urlDataSource.getKeyParams(i.parent.key),r=new m.default,n=[];if(i.selectedPeople&&0<i.selectedPeople.length)for(var a=0,s=i.selectedPeople;a<s.length;a++){var u=s[a];n.push({role:2,type:0,email:u.email})}var l={ownerCid:this._identity.getIdentity().id,message:i.sharingNote,requireSignIn:!0,entities:n},c=JSON.stringify({parentId:t.id,cid:t.cid,group:0,name:i.folderName,permissionsInfo:i.selectedPeople&&0<i.selectedPeople.length?l:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return r.send({apiName:"AddFolder",url:e,requestType:"POST",postData:c,isErrorExpectedCallback:this._isErrorExpected}).then(function(e){e=e.items||e.item;var t=new(o.resources.consume(L.resourceKey)),r=o._getItemResult({requestKey:i.parent.key,itemFromServer:e,queryType:f.default.Files,keyAlias:i.keyAlias,isPrimaryRequestedItem:!0,observer:t});t.flush();return r?t.getItem({key:r.item.key}):null},function(e){return p.default.wrapError(o._itemErrorProcessor.getError(e).errorTitle)})};l.prototype.createDocument=function(o,n,e){var a=this;if(n===d.DocumentType.Text)return p.default.wrap(this._createTextDocument(o));var t=this._getCreateDocumentUrl(),r=l.getServerDocumentType(n),i=new m.default,s=this._urlDataSource.getKeyParams(o),u=JSON.stringify({parentId:s.id,nameConflict:e?0:2,overrideLock:!1,cid:s.cid,group:0,name:e,docType:r});return i.send({apiName:"CreateDocument",url:t,requestType:"POST",postData:u,isErrorExpectedCallback:this._isErrorExpected}).then(function(e){var t="";if((e=e.items||e.item)&&0<e.length){var r=new(a.resources.consume(L.resourceKey)),i=a._getItemResult({requestKey:o,itemFromServer:e[0],queryType:f.default.Files,isPrimaryRequestedItem:!0,observer:r});r.flush();t=(t=r.getItem({key:i.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view","");n===d.DocumentType.OneNote&&(t+="&nd=1")}return t},function(e){return p.default.wrapError(a._itemErrorProcessor.getError(e).errorTitle)})};l.prototype.createCustomDocument=function(e,t,r){return null};l.prototype.createShortcut=function(e,t,r){return null};l.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(h.urlDataSource).getCreateTextDocumentUrl(t.id,t.cid)};l.prototype.createDocumentInTab=function(e,t,r){var i,o=l.getServerDocumentType(e);if(e===d.DocumentType.Text)i=this._createTextDocument(t.key);else{i=this.resources.consume(h.urlDataSource).getCreateDocumentInTabUrl(t,o,r)}return i};l.prototype.getFilterData=function(e,t,r){return null};l.prototype.restoreItems=function(r){var i=this._urlDataSource.getKeyParams(r.parentKey);return a.default.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:r.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(e){var t={targetId:i.id,cid:_.default.viewerId,group:0,items:e.map(function(e){return e.id}),recycleBinItems:e.map(function(e){return{deletedFromLocation:e.location===n.strings.ProductName?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:r.retainAcls||!1};r.nameConflict&&(t.nameConflict=r.nameConflict);return t}})};l.prototype.restoreAll=function(e){var r=this._getRestoreAllUrl(),i=new m.default;return new p.default(function(e,t){i.sendPost("RestoreAll",r,"").then(function(){e(!0)},t)})};l.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())};l.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())};l.prototype.removeFromRecent=function(e){for(var t,r=this._getRemoveFromRecentUrl(),i=new m.default,o=[],n=0;n<e.items.length;n++)o.push(e.items[n].id);t=JSON.stringify({items:o});return i.sendPost("RemoveFromMRU",r,t)};l.prototype.removeMountPoint=function(e){var t,r=this._getRemoveMountPointUrl(),i=new m.default;t=JSON.stringify({id:e.item.properties.ghostId||e.item.id});return i.sendPost("RemoveMountPoint",r,t)};l.prototype.createMountPoint=function(e){var t,i=this,r=this._getCreateMountPointUrl(),o=new m.default,n=this._urlDataSource.getAuthKeyParamValue();t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:n});return o.sendPost("MountFolder",r,t).then(function(e){var t=new(i.resources.consume(L.resourceKey)),r=e?i._getItemResult({requestKey:"",itemFromServer:e.item,queryType:f.default.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;t.flush();return r?t.getItem({key:r.key}):null},function(e){return p.default.wrapError(e)})};l.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),r=new m.default;return e.workItemIds?r.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):r.send({apiName:"GetWorkProgress",url:t})};l.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();(new m.default).sendPost("CancelWork",t,JSON.stringify(e));return p.default.wrap(!0)};l.prototype.getItemOcrTextContent=function(e){var t=new m.default,r=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",_.default.skyApiBaseUrl+"GetDownloadUrl",r).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return i.default.start({url:t,json:null}).then(function(e){var t=window.DOMParser,r=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return r&&r.textContent})})};l.prototype.updateItemOcrInfo=function(e,t,r){var i=this._getUpdateItemsUrl(),o=new m.default,n=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:r,lid:e.parent.id,rset:_.default.scenarioName});return o.sendPost("UpdateItem",i,n)};l.prototype.processReferral=function(e,t){var r=this._getProcessReferralUrl(),i=new m.default,o={inviterId:e};t&&""!==t&&(o.inviteSrc=t);return i.sendPost("ProcessReferral",r,JSON.stringify(o))};l.prototype.rotateItems=function(a){for(var s=this,u=new(this.resources.consume(L.resourceKey)),l=this._getRotateItemUrl(),c=[],e=function(o){var e=d.peekUnwrapObservable(d._itemsStore.getItem(o.key)),n=++A;if(e.thumbnail){var t=e.orientedThumbnail;t=t?T.__assign({},t,{rotation:t.rotation+a.rotation,version:n}):{rotation:a.rotation,thumbnail:T.__assign({},e.thumbnail),version:n};u.update([new L.Task(o.key).succeed({item:{key:o.key,orientedThumbnail:L.Graft.replace(t)}})])}var r=new m.default,i=JSON.stringify({targetId:o.id,numberOfClockwiseRotations:-a.rotation,cid:_.default.viewerId});c.push(d._rotationSemaphore.enqueue(function(){return r.sendPost("ChangeImageOrientation",l,i).then(function(e){var t=s.peekUnwrapObservable(s._itemsStore.getItem(o.key)),r=t.itemFromServer&&t.itemFromServer.commands;e.item.commands=r||e.item.commands;s._itemResultProcessor.processItemResult({observer:u,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:o.key});var i=t.orientedThumbnail;i&&i.version===n&&u.update([new L.Task(o.key).succeed({item:{key:o.key,orientedThumbnail:L.Graft.remove()}})]);return t},function(e){var t=s.peekUnwrapObservable(s._itemsStore.getItem(o.key)).orientedThumbnail;if(t){t=t.version===n?L.Graft.remove():{rotation:t.rotation-a.rotation};u.update([new L.Task(o.key).succeed({item:{key:o.key,orientedThumbnail:t}})])}var r=new Error(e.data.message);r.data={key:o.key,error:e.data};return p.default.wrapError(r)})}))},d=this,t=0,r=a.items;t<r.length;t++){e(r[t])}u.flush();return p.default.all(c).then(function(e){u.flush();return e.map(function(e){var t=s.peekUnwrapObservable(s._itemsStore.getItem(e.key));t&&t.parent&&s._itemDataSourceHelper.removeBrowserCacheResultVersion(t.ownerId,t.parent.key);return t})},function(t){u.flush();var e=new Error;e.data=Object.keys(t).map(function(e){return t[e].data});return p.default.wrapError(e)})};l.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),r=this._getRedeemPermissionTokenUrl(),i=new m.default,o={id:e.item.id,authKey:t};return i.sendPost("RedeemPermissionToken",r,JSON.stringify(o))};l.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==_.default.viewerId});return 0===t.length?p.default.wrap(null):a.default.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:_.default.viewerId,ids:e.map(function(e){return e.id})}}})};l.prototype.getRootItemTitle=function(e){return o.strings.Files};l.prototype._getRootFileId=function(){return"root"};l.prototype._getParentItemId=function(){return""};l.prototype._getItemKeyExtension=function(e,t){var r,i=this._urlDataSource.getKeyParams(t);return i.id===e.id?i:e.folder?((r={}).ft=i.ft,r.ext=i.ext,r):{}};l.prototype._handleMoveCopyApiRequest=function(e,t,r){for(var i=new m.default,o=t.items.map(function(e){return e.id}),n=P.convertMoveCopyContextToPostData(t),a=[],s=new I.default;o.length;){var u=o.splice(0,100);n.items=u;var l=s.enqueue(function(){return i.send({apiName:e,url:r,requestType:"POST",postData:JSON.stringify(n),isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:return!0;case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[T.__assign({},e,{error:e.data})]}})});a.push(l)}return p.default.all(a).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})};l.prototype._getItem=function(S,x,P){var e,I=this,w=String(Math.random()),t=((e={})["X-SkyApiOriginId"]=w,e),r=this._pendingGetItemRequests[S];if(!r){var i=D.default.prefetchDataRequest[S];if(i){w=D.default.prefetchDataRequestOrigin;delete D.default.prefetchDataRequest[S]}var o=!P.skipCache&&i||(new m.default).send({apiName:"GetItems",qosName:P.qosName,url:S,headers:t,isErrorExpectedCallback:this._itemDataSourceHelper.isExpectedGetItemsError}),A=!1;r=o.then(function(e){A=!0;E.default.mark("ItemsDataSource.GetItems.Normalizing");var t,r=e.originId,i=e.items||e.item&&[e.item]||[];if(i&&0<i.length){for(var o=new(I.resources.consume(L.resourceKey)),n=void 0,a=i.length-1;0<=a;a--){var s=0===a;if(!i[0].isBundle||s){var u=0<a,l=I._getItemResult({observer:o,requestKey:P.parentKey,itemFromServer:i[a],queryType:P.queryType,requestMetadata:{tokenNeedsRedeeming:e.tokenNeedsRedeeming,tokenType:e.tokenType,restoreAllWorkItemCount:e.restoreAllWorkItemCount||0,deleteAllWorkItemCount:e.deleteAllWorkItemCount||0},setItemKey:!u,skipSettingChildren:u,isPrimaryRequestedItem:s});s&&(n=l)}}o.flush();if(n&&n.item){var c=o.getItem({key:n.item.key}),d=i[0],p=I._getDefaultSortInformation(d);if(P.sortField){var m=p&&p.defaultSortField;p={sortField:P.sortField,defaultSortField:m,isAscending:P.isAscending,isSortEnabled:!I.isLargeRecycleBin.peek()}}var f=void 0;p&&(f=p.isAscending);var h=r!==w;h||c.type!==k.default.Folder||I._itemDataSourceHelper.persistResultVersion(P,x);var g=C.getColumns(c,I.resources,p),v=void 0;if(g&&p)for(var y=0,b=g;y<b.length;y++){var _=b[y];if(_.internalName===p.sortField){v=_.key;break}}t=T.__assign({},n,{schema:g,startIndex:d.folder?d.folder.startIndex:P.startIndex,isFromBrowserCache:h,sortField:v,isAscending:f})}}delete I._pendingGetItemRequests[S];return t},function(e){delete I._pendingGetItemRequests[S];var t=new(I.resources.consume(L.resourceKey)),r=I._itemErrorProcessor.processError({requestKey:P.parentKey,error:e,observer:t}).error;t.flush();return p.default.wrapError(r)});A||(this._pendingGetItemRequests[S]=r)}return r};l.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}};l.prototype._getDefaultSortInformation=function(e){var t;e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(b.default).length/2>e.folder.defaultSort&&(t={sortField:b.default[e.folder.defaultSort],defaultSortField:b.default[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===y.default.ascending.toString(),isSortEnabled:!0});return t};l.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)};l.prototype._getCreateDocumentUrl=function(){return _.default.skyApiBaseUrl+"CreateDocument"};l.prototype._getCreateFolderUrl=function(){return _.default.skyApiBaseUrl+"AddFolder?lct=1"};l.prototype._getDeleteItemsUrl=function(){return _.default.skyApiBaseUrl+"DeleteItems"};l.prototype._getUpdateViewCountUrl=function(){return _.default.skyApiBaseUrl+"UpdateViewCount"};l.prototype._getRestoreItemsUrl=function(){return _.default.skyApiBaseUrl+"RestoreItems"};l.prototype._getOpenInClientDetailsUrl=function(){return _.default.skyApiBaseUrl+"GetOpenInClientDetails"};l.prototype._getRequestReviewUrl=function(){return _.default.skyApiBaseUrl+"OwnerRequestReview"};l.prototype._getReportAbuseUrl=function(){return _.default.skyApiBaseUrl+"ReportAbuse"};l.prototype._getRemoveFromSharedListUrl=function(){return _.default.skyApiBaseUrl+"AbdicatePermissions"};l.prototype._getAddCoverPhotoUrl=function(){return _.default.skyApiBaseUrl+"AddFavorites"};l.prototype._getRemoveCoverPhotoUrl=function(){return _.default.skyApiBaseUrl+"RemoveFavorites"};l.prototype._getUpdateItemsUrl=function(){return _.default.skyApiBaseUrl+"UpdateItem?lct=1"};l.prototype._getUpdateBundleUrl=function(){return _.default.skyApiBaseUrl+"UpdateBundle"};l.prototype._getCopyItemsUrl=function(){return _.default.skyApiBaseUrl+"CopyItemsAsync"};l.prototype._getMoveItemsUrl=function(){return _.default.skyApiBaseUrl+"MoveItems"};l.prototype._getRemoveFromRecentUrl=function(){return _.default.skyApiBaseUrl+"RemoveFromMRU"};l.prototype._getRemoveMountPointUrl=function(){return _.default.skyApiBaseUrl+"RemoveMountPoint"};l.prototype._getCreateMountPointUrl=function(){return _.default.skyApiBaseUrl+"AddFolder"};l.prototype._getRestoreAllUrl=function(){return _.default.skyApiBaseUrl+"RestoreAll"};l.prototype._getWorkProgressUrl=function(e){return _.default.skyApiBaseUrl+"GetWorkProgress?type="+e.type};l.prototype._getRotateItemUrl=function(){return _.default.skyApiBaseUrl+"ChangeImageOrientation"};l.prototype._getCancelWorkUrl=function(){return _.default.skyApiBaseUrl+"CancelWork"};l.prototype._getProcessReferralUrl=function(){return _.default.skyApiBaseUrl+"ProcessReferral"};l.prototype._getRedeemPermissionTokenUrl=function(){return _.default.skyApiBaseUrl+"RedeemPermissionToken"};return l}(r.default);t.default=l});define("@ms/odsp-utilities/lib/xhr/XHRPromise",["require","exports","./XHR","../async/Promise"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.start=function(e){var r=new o.default(e);return new n.default(function(e,t){r.start(e,t)},function(){r.abort(!0)})};e.startAndPostProcess=function(e,i){var t=new o.default(e);return new n.default(function(r,e){t.start(function(e,t){r(i(e,t))},e)},function(){t.abort(!0)})};return e}();t.default=r});define("odsp-next/dataSources/base/odc/BatchRequest",["require","exports","@ms/odsp-utilities/lib/async/Signal","./DataRequest"],function(e,t,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.start=function(o){var n=new r.default(function(){for(var e=0,t=s;e<t.length;e++){var r=t[e];r.cancel()}}),a=o.items.slice(),e=o.parallelRequests||1,s=[];function u(e){var t=s.indexOf(e);0<=t&&s.splice(1,t)}function l(){var e=new c.default,t=a.splice(0,o.batchSize),r=JSON.stringify(o.getPostData(t)),i=e.send({apiName:o.apiName,url:o.url,requestType:"POST",postData:r,isErrorExpectedCallback:o.isErrorExpectedCallback}).then(function(){u(i);o.onBatchComplete&&o.onBatchComplete(t);a.length?l():n.complete()},function(e){u(i);t=e,n.error(t);var t});s.push(i)}for(var t=0;0<a.length&&t<e;t++)l();return n.getPromise()};return e}();t.default=i});define("odsp-next/dataSources/base/odc/ItemResultProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/VirtualItemType","../../../models/item/ItemType","../../../models/item/SharingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","../../../controls/photos/Photos.resx","../../item/ItemDataSource.resx","../../item/odc/ODCDataSource.resx","../../../controls/leftPane/LeftPane.resx","../../url/QueryType","../../url/odc/UrlDataSource","../../item/odc/SkyApiCommands","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/locale/Locale","./ThumbnailProcessor","../../../utilities/features/Features","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/dateTime/DateTime","../../album/odc/AlbumDataSource","../../../utilities/array/ArrayHelper","../../item/ItemTaskObserver","../../../utilities/mime/MimeHelper","@ms/odsp-microservice/lib/microService/helpers/BabylonSupport"],function(e,t,qe,r,Ve,Ge,o,je,ze,i,We,n,Qe,$e,Xe,Je,Ye,Ze,et,s,tt,u,l,rt,c,it,ot,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var nt={0:0,1:2,2:1,3:3,4:4,5:5},m=i.strings,f="1209427492",h="0000000048166624",a=function(a){qe.__extends(e,a);function e(e){void 0===e&&(e={});var t=a.call(this,e)||this,r=e.getRootItemTitle,i=void 0===r?t._getRootItemTitle:r,o=e.getItemKeyExtension,n=void 0===o?t._getItemKeyExtension:o;t._getRootItemTitle=i;t._getItemKeyExtension=n;t._urlDataSource=t.resources.consume(u.urlDataSource);t._identityDataSource=t.resources.consume(l.identity);t._thumbnailProcessor=new(t.managed(s.default));return t}e.prototype.processItemResult=function(e){var i=this,t=e.requestKey,r=e.itemFromServer,o=e.requestMetadata,n=e.setItemKey,a=e.skipSettingChildren,s=e.isPrimaryRequestedItem,u=e.isPlaceholder,l=e.observer,c=this._urlDataSource.getKeyParams(t),d=e.queryType,p=void 0===d?this._urlDataSource.getQueryType(c):d;if(r){var m=this.getItemKey({requestKey:t,itemFromServer:r}),f={key:m},h=r.itemStatus;f.itemStatus=h;var g="";r.locatedIn?g=r.locatedIn:r.deletedFromLocation?g="/"===r.deletedFromLocation[0]?r.deletedFromLocation.substr(1):r.deletedFromLocation:r.ownerCid&&r.ownerCid===$e.default.viewerId?g=We.strings.ProductName:r.ownerName&&(g=Je.format(We.strings.UsersOneDrive,r.ownerName));var v=r.internalPath;v&&(f.internalPath=v);var y=this._identityDataSource.getIdentity(),b=r.ownerCid||y.id,_=this._getNormalizedId(r);f.id=_;var S="root"===r.id?r.rootResourceId||"root":_,x=r.resourcePartitionCid||b;f.itemId=S;f.graph={itemId:S,driveId:x};f.statistics={views:r.visitorViews};f.eTag=r.eTag;f.isSharerFolder=r.isSharerFolder;f.parentKey=this._getParentKey(r,{requestKeyParams:c});var P=this._getVirtualItemType(r);f.virtualItemType=P;var I=this._isPhotosRoot(r,{requestKeyParams:c}),w=this._isPhotosSubRoot(r,{requestKeyParams:c,isPhotosRoot:I}),A=this._getIsRootFolder(r,{isPhotosSubRoot:w});f.isRootFolder=A;var T=r.name,k="";f.comments={count:r.commentCount||0};s||(f.isStub=r.isPlaceholder);var C=r.iconType?Ye.OfficeIconFileTypeMap[r.iconType.toLowerCase()]:"";f.appMap=C;var D=this._getItemType(r,C),E=r.extension||"";f.extension=E;f.size=Number(r.size);var L,O=r.sharingLevelValue;f.sharingType=O;f.isBundle=!!r.isBundle;f.locations=r.locations;f.creatorName=r.creatorName;f.caption=r.caption||"";((f.itemFromServer=r).photo||r.video||r.isAlbum)&&(L=r.tags||[]);f.tags=L;f.ocr=r.ocr;f.urls=r.urls;var R=r.userRole in nt?nt[r.userRole]:5;if("MountPoint"===r.groupFolderType){R=2;f.mountPoint={}}f.defaultSubText=this._getDefaultSubText(R,O,r.sharingLevel);f.location=g;f.ownerId=b;f.ownerName=r.ownerName||"";f.uploadOwnerId=x;f.specialFolderCanonicalName=r.specialFolderCanonicalName||"";f.isSpecialFolder=!!r.isSpecialFolder;var M={};if(A){if(f.ownerId!==$e.default.viewerId)T=We.strings.SharedRoot;else{T=this._getRootItemTitle(m);R=0}o&&(f.taskStatus={restoreAllCount:o.restoreAllWorkItemCount,deleteAllCount:o.deleteAllWorkItemCount})}if(o){f.tokenNeedsRedeeming=o.tokenNeedsRedeeming;f.tokenType=o.tokenType}if(r.settings){M.allPhotosFolderId=r.settings.allPhotosFolderId;M.allPhotosSortAscending=r.settings.allPhotosSortAscending}r.displayQuotaExceeded&&(M.quota={display:{exceeded:r.displayQuotaExceeded,remaining:r.displayQuotaRemaining,total:r.displayQuotaTotal,used:r.displayQuotaUsed,size:r.displaySize},exceeded:r.quotaExceeded,remaining:r.quotaRemaining,status:r.quotaStatus,total:r.quotaTotal});M.ghostId=r.ghostId;if(r.thumbnailSet){f.thumbnail=this._thumbnailProcessor.processThumbnailSet(r.thumbnailSet,r);var F=this._thumbnailProcessor.getProcessFiltersUrl(r.thumbnailSet,r);F&&(f.processFilters={thumbnailUrl:F})}var N=r.folder;if(N){var U=[];f.folder={childCount:N.childCount,documentCount:N.documentCount,folderCount:N.folderCount,photoCount:N.photoCount,totalCount:N.totalCount,covers:U};var B=N.covers;if(B)for(var H=0,K=B;H<K.length;H++){var q=K[H],V=this._thumbnailProcessor.processThumbnailSet(q,r);V&&U.push(V)}}var G,j=r.photo;j&&(G={width:j.width,height:j.height,cameraMake:j.cameraMake,cameraModel:j.cameraModel,exposureNumerator:j.exposureNumerator,exposureDenominator:j.exposureDenominator,focalLength:j.focalLength,focalRatio:j.focalRatio,iso:j.iso,originalUrl:r.urls[je.default[je.default.open]],displayDateTaken:j.displayDateTaken,dateTaken:j.dateTaken,quality:ot.Graft.optional(j.quality?{isBad:j.quality.isBad}:void 0)});f.photo=G;f.video=r.video;f.audio=r.audio;f.panorama=r.panorama;f.geoLocation=r.location;var z=r.textEditorMimeType;f.textEditorMimeType=z;var W=!!r.isAlbum;f.isAlbum=W;var Q,$=r.photo||r.video,X=rt.getDateFromDotNetTicks(r.dateModifiedOnClient),J=rt.getDateFromDotNetTicks(r.creationDate),Y=rt.getDateFromDotNetTicks(r.lastAccess),Z=rt.getDateFromDotNetTicks(r.dateShared),ee=rt.getDateFromDotNetTicks(r.dateDeleted),te=rt.getDateFromDotNetTicks(r.dateExpires),re=$&&$.dateTaken&&rt.getDateFromDotNetTicks($.dateTaken),ie=r.displayModifiedDate,oe=r.displayCreationDate,ne=r.displayLastAccess,ae=r.displayDateShared,se=r.displayDateDeleted,ue=r.displayExpiryDate,le=tt.isFeatureEnabled(tt.EnableUpdatedFilesListView)&&tt.isFeatureEnabled(tt.FlipOnNewGridAndListExperiment);try{X&&(ie=le?rt.getFriendlyDateTimeStringPast(X):rt.getShortDisplayDate(X));J&&(oe=rt.getShortDisplayDate(J));Y&&(ne=rt.getShortDisplayDate(Y));Z&&(ae=rt.getShortDisplayDate(Z));ee&&(se=rt.getShortDisplayDate(ee));te&&(ue=rt.getShortDisplayDate(te));re&&(Q=le?rt.getFriendlyDateTimeStringPast(re,!1,!1,!0):rt.getShortDisplayDate(re,!0))}catch(e){}f.dateModifiedValue=r.dateModifiedOnClient;f.dateModifiedTime=X;f.dateCreatedTime=J;f.dateAccessedTime=Y;f.dateSharedTime=Z;f.dateDeletedTime=ee;f.dateExpiresTime=te;f.dateModified=ie;f.dateCreated=oe;f.dateAccessed=ne;f.dateShared=ae;f.dateDeleted=se;f.dateExpires=ue;if($){f.dateTakenTime=re;f.dateTaken=Q}f.itemFromServer=r;f.lifeCycleStatus=ot.Graft.optional(this._getItemLifeCycleStatus(f));var ce={},de={};if(r.isAlbumRoot){de[Xe.download]=!0;de[Xe.share]=!0;de[Xe.rename]=!0}if(r.commands)for(var pe=r.commands.split(","),me=0;me<pe.length;me+=2){pe[me]in de||(ce[pe[me]]=pe[me+1])}else"root"===f.id&&p===Qe.default.Search&&(ce[Xe.defaultClick]="1");if(r.audio&&tt.isFeatureEnabled(tt.EnableAudioPlayer)){delete ce[Xe.playAudio];ce[Xe.defaultClick]="1"}var fe,he,ge,ve=!!ce[Xe.requestReview];f.isViolation=ve;f.queryType=p;f.displayType=N&&1===N.category?Qe.default.Photos:p;f.queryType===Qe.default.Recent&&A&&(ce[Xe.defaultClick]="1");if(D===Ge.default.Folder&&!f.isStub)switch(R){case 0:case 4:case 2:ge=f.queryType===Qe.default.Files||f.queryType===Qe.default.SharedWithMe&&!A;break;default:ge=!1}f.sharingRole=R;f.isDropEnabled=ge;f.iconName=Ze.getIconNameFromItem({type:D,extension:E,sharingType:O,textEditorMimeType:z});f.documentFormat=r.docFormat||0;P===Ve.default.AlbumRoot&&(T=ze.strings.albumsNavLink);v&&(k=et.default.isRightToLeft?v.slice(0).reverse().join(" < "):v.join(" > "));u||(f.isPlaceholder=!1);f.isDraggable=f.queryType===Qe.default.Files&&!f.mountPoint;if(N){f.childCount=r.estimatedResultCount||N.totalCount;f.category=N.category;fe=[];N.itemGroupings&&(he=N.itemGroupings.map(function(e){var t=e.itemGroups,r=qe.__rest(e,["itemGroups"]);return qe.__assign({},r,{itemGroups:t.map(function(e){return qe.__assign({},e,{state:i.observables.create({isCollapsed:!1})})})})}));var ye={};if(N.children&&!a)for(var be=0,_e=N.children;be<_e.length;be++){var Se=_e[be],xe=this.processItemResult({observer:l,requestKey:t,itemFromServer:Se,queryType:p,requestMetadata:o,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;fe.push(xe);ye[xe.key]={newTag:this.getNewTagIfExists(Se),autoAlbumTag:this.getAutoAlbumTagIfExists(Se)}}if(P===Ve.default.AlbumRoot){for(var Pe={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Ie=[],we=0,Ae=[],Te=Math.max(3,10-fe.length),ke=0,Ce=fe;ke<Ce.length;ke++){var De=Ce[ke],Ee=ye[De.key];if(Ee&&Ee.newTag&&Ee.autoAlbumTag)if(Te<++we){Ie.push(De);Pe.count++}else Ae.push(De);else Ae.push(De)}Pe.startIndex=Ae.length;fe=Ae.concat(Ie);var Le={name:"newAutoAlbumsGrouping",itemGroups:[Pe]};he.push(Le)}}else r.urls&&(r.urls.oneNoteWeb?f.openUrl=r.urls.oneNoteWeb:f.openUrl=r.urls.viewInBrowser);var Oe=E&&E.toLowerCase();if(".pdf"===Oe||".ai"===Oe&&ce[Xe.download]){ce[Xe.defaultClick]="1";f.openUrl=this._urlDataSource.getDownloadItemUrl({key:m,id:S,ownerId:b,extension:E},FilesConfig.canary,!0);tt.isFeatureEnabled(tt.UseWebPdfViewer)&&(D=Ge.default.Media)}var Re=this._get3dFacet(E);if(Re){D=Ge.default.Media;f.model3d=Re;ce[Xe.defaultClick]="1"}f.type=D;f.thumbnail&&"4"===ce[Xe.defaultClick]&&(ce[Xe.defaultClick]="1");!s&&r.isPlaceholder&&(ce[Xe.defaultClick]="1");if("allmyphotos"===c.qt&&f.id===c.id){ce[Xe.defaultClick]="1";T=""}var Me=N?N.childCount:0;f.name=T;f.displayName=k||""+T+E;r.estimatedResultCount&&(Me=fe.length+(r.folder&&r.folder.startIndex||0));if(r.isRecycled&&r.folder&&!Me){Me=fe.length;f.childCount=Me}M.newTag=this.getNewTagIfExists({tags:L});M.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:W,tags:L});var Fe=[m];n&&t&&Fe.push(t);e.keyAlias&&Fe.push(e.keyAlias);var Ne=!0;"allmyphotos"===c.qt&&f.id===c.id&&(Ne=!1);M.commandsSupported=ot.Graft.replace(ce);f.properties=M;for(var Ue=0,Be=it.removeDuplicates(Fe);Ue<Be.length;Ue++){var He=Be[Ue];l.update([new ot.Task(He).succeed({item:Ne?f:{key:m}})])}var Ke=r.hasMoreResults?""+r.estimatedResultCount:"";r.isRecycled&&r.folder&&r.folder.hasMoreRecycledItems&&(Ke=r.folder.pagingToken);return{item:{key:m},children:fe,groupings:he,totalChildren:Me,nextRequestToken:Ke}}};e.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var r=e.tags;if(r)for(var i=0,o=r;i<o.length;i++){var n=o[i];if(n.tag===c.AUTO_ALBUM_TAG){t=n;break}}return t};e.prototype.getNewTagIfExists=function(e){var t=e.tags,r=null;if(t)for(var i=0,o=t;i<o.length;i++){var n=o[i];if(n.tag===c.NEW_ALBUM_TAG){r=n;break}}return r};e.prototype.getItemKey=function(e){var t,r,i,o,n=e.itemFromServer,a=e.requestKey,s=this._urlDataSource.getKeyParams(a);if(n.isAlbumRoot)t=this._urlDataSource.getKey(((r={}).id="albums",r.tagFilter=s.tagFilter,r));else if(n.isTagsRoot)t=this._urlDataSource.getKey(((i={}).id="tags",i));else{var u=this._getItemKeyExtension(n,a),l=n.ownerCid,c=n.internalPath,d=void 0===c?[]:c,p=this._getNormalizedId(n);if(this._urlDataSource.isCurrentQuery(Qe.default.SharedWithMe,s)&&n.ownerDCid===f&&n.ownerCid===h){p=f;l=h}t=this._urlDataSource.getKey(qe.__assign({},u,((o={}).id=p,o.cid=l,o.internalPath=d.join(","),o)))}return t};e.prototype._get3dFacet=function(e){var t=p.canConvert(e),r=p.canRenderNative(e);if(t||r)return{canConvertToFbx:t,canRenderNative:r}};e.prototype._getDefaultSubText=function(e,t,r){var i;switch(e){case 0:i=t===o.default.Private?"":m.Owner;break;case 1:i=m.CanView;break;case 2:case 4:i=m.CanEdit;break;default:i=""}return i};e.prototype._getItemType=function(e,t){return e.isPlaceholder?Ge.default.Folder:17===e.itemType?Ge.default.OneNote:e.folder?Ge.default.Folder:e.video||e.photo||tt.isFeatureEnabled(tt.EnableAudioPlayer)&&e.audio?Ge.default.Media:t?Ge.default.File:this._isTextEditorFile(e)?Ge.default.File:e.thumbnailSet?Ge.default.Media:Ge.default.File};e.prototype._isTextEditorFile=function(e){return d.canOpenInMonaco(e.extension||"")};e.prototype._getItemKeyExtension=function(e,t){var r,i=this._urlDataSource.getKeyParams(t);return i.id===e.id?i:e.folder?((r={}).ft=i.ft,r.ext=i.ext,r):{}};e.prototype._getRootItemTitle=function(e){return n.strings.Files};e.prototype._getNormalizedId=function(e){return e.id&&0<=e.id.indexOf("!")?e.id.toUpperCase():e.id};e.prototype._getParentKey=function(e,t){var r,i,o=t.requestKeyParams;e.isRecycled&&"root"!==e.id?r=this._urlDataSource.getRootItemKey(Qe.default.RecycleBin):e.isSharerFolder?r=this._urlDataSource.getRootItemKey(Qe.default.SharedWithMe):e.isAlbumRoot?r=void 0:e.parentId&&(r=this._urlDataSource.getKey(((i={}).id=e.parentId,i.cid=e.ownerCid,i.ft=o.ft,i.ext=o.ext,i)));return r};e.prototype._getVirtualItemType=function(e){var t;e.isAlbumRoot?t=Ve.default.AlbumRoot:e.isAlbum?t=Ve.default.Album:e.isTagsRoot&&(t=Ve.default.TagsRoot);return t};e.prototype._getIsRootFolder=function(e,t){var r=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!r};e.prototype._isPhotosRoot=function(e,t){var r=t.requestKeyParams;return"allmyphotos"===r.qt&&e.id===r.id};e.prototype._isPhotosSubRoot=function(e,t){var r=t.requestKeyParams;return t.isPhotosRoot&&(!!r.tagFilter||!!r.locationFilter)};e.prototype._getItemLifeCycleStatus=function(e){var t={};this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0);return t};e.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),r=e&&e.valueOf();return!isNaN(r)&&t-r<1728e5};return e}(r.default);t.default=a});define("odsp-next/models/item/SharingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(r||(r={}));t.default=r});define("@ms/odsp-datasources/lib/interfaces/item/UrlType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl"}(r=t.UrlType||(t.UrlType={}));t.default=r});define("odsp-next/dataSources/item/odc/SkyApiCommands",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.abdicatePermissions="ab";t.addCoverPhoto="acp";t.applyOfficeLens="aol";t.addTag="at";t.addToAlbum="ata";t.addToSharedList="ats";t.changeExpiration="ce";t.comment="cm";t.copy="cp";t.createExcel="cxls";t.createExcelSurvey="cxlsf";t.createFolder="cf";t.createMountPoint="cmp";t.createOneNote="con";t.createPowerPoint="cppt";t.createWord="cdoc";t.defaultClick="defc";t.deleteCommand="de";t.download="dl";t.editSurvey="ef";t.embed="em";t.emptyRecycleBin="erb";t.modifyCaption="mc";t.move="mv";t.openInOffice="oo";t.openInTextEditor="openInTextEditor";t.openPdfInBrowser="openPdfInBrowser";t.playAudio="pl";t.rearrange="ar";t.removeCoverPhoto="rcp";t.removeFromAlbum="rfa";t.removeFromRecent="rmru";t.removeMountPoint="rmp";t.rename="rn";t.removeOfficeLens="rol";t.reportAbuse="ra";t.requestReview="orr";t.restore="rst";t.restoreAll="rai";t.rotate="rot";t.share="sh";t.shareSurvey="sf";t.upload="up";t.viewInBrowser="vb";t.viewOriginal="vo";t.viewSurvey="pf";t.viewVersions="vv"});define("odsp-next/dataSources/base/odc/ThumbnailProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./ISkyApiItem","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/interfaces/item/UrlType"],function(e,t,d,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=i.SkyApiThumbnailType[i.SkyApiThumbnailType.unRes],m=i.SkyApiThumbnailType[i.SkyApiThumbnailType.doc],a=function(t){d.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.processThumbnailSet=function(e,t){for(var r={},i={},o=0,n=e.thumbnails;o<n.length;o++){var a=n[o];if(0===(r[a.name]=a).name.indexOf("scaled")){i[a.name.substring("scaled".length).toLowerCase()]=a}}var s,u={thumbnailSet:e,thumbnailsByType:r,thumbnailsBySize:i,item:t},l=r[p],c=r[m];l?s=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(l,u):this._getUnResThumbnail(l,u):c?s=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(d.__assign({},c,{width:t.video.width,height:t.video.height}),u):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(d.__assign({},c,{width:t.photo.width,height:t.photo.height}),u):this._getDocThumbnail(c,u):Object.keys(i).length&&(s=this._getScaledThumbnail(u));return s};e.prototype.getProcessFiltersUrl=function(e,t){for(var r,i=0,o=e.thumbnails;i<o.length;i++){var n=o[i];"custom"===n.name&&(r=n)}return r?this._createSizedUrl(e.baseUrl,r.url,{width:r.width,height:r.height}):""};e.prototype._getOriginalThumbnail=function(e,r){var i=r.item.photo.originalUrl||r.item.urls&&r.item.urls[o.default[o.default.download]];return i?{width:r.item.photo.width,height:r.item.photo.height,url:this._createUrlPattern(r.thumbnailSet.baseUrl,e.url),getAligned:function(e,t){return{width:r.item.photo.width,height:r.item.photo.height,url:i}}}:this._getUnResThumbnail(e,r)};e.prototype._getUnResThumbnail=function(r,i){var o=this;return{width:r.width,height:r.height,url:this._createUrlPattern(i.thumbnailSet.baseUrl,r.url),getAligned:function(e,t){return{width:r.width,height:r.height,url:o._createSizedUrl(i.thumbnailSet.baseUrl,r.url,e)}}}};e.prototype._getDocThumbnail=function(r,i){var o=this;return{width:0,height:0,url:this._createUrlPattern(i.thumbnailSet.baseUrl,r.url),getAligned:function(e,t){return{width:0,height:0,url:o._createSizedUrl(i.thumbnailSet.baseUrl,r.url,{width:e.width,height:Math.max(e.height,2048)})}}}};e.prototype._getScaledThumbnail=function(s){var u,l=this,c=[];for(var e in s.thumbnailsBySize){var t=s.thumbnailsBySize[e];switch(e){case"largest":u=t;break;default:c.push(t)}}c.sort(function(e,t){return e.width*e.height-t.width*t.height});u=u||c[c.length-1];var d=s.item.photo||u;return{url:this._createUrl(s.thumbnailSet.baseUrl,u.url),width:d.width,height:d.height,getAligned:function(e,t){for(var r,i=e.width*e.height,o=0,n=c;o<n.length;o++){var a=n[o];if(a.width*a.height>.9*i){r=a.url;break}}return{width:d.width,height:d.height,url:l._createUrl(s.thumbnailSet.baseUrl,r||u.url)}}}};e.prototype._createSizedUrl=function(e,t,r){var i={width:Math.ceil(r.width),height:Math.ceil(r.height)};r.width===r.height&&(i.cropMode="center");return this._createUrl(e,t,i)};e.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})};e.prototype._createUrl=function(e,t,r){void 0===r&&(r={});var i=""+e+t,o=n.serializeQuery(r)?-1<i.indexOf("?")?"&":"?":"";return""+i+o+n.serializeQuery(r)};e.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,r=void 0===t?"":t,i=e.photo;return".gif"===r.toLowerCase()&&!!i};return e}(r.default);t.default=a});define("odsp-next/dataSources/base/odc/ISkyApiItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.unRes=0]="unRes";e[e.doc=1]="doc"}(t.SkyApiThumbnailType||(t.SkyApiThumbnailType={}))});define("@ms/odsp-utilities/lib/dateTime/DateTime",["require","exports","tslib","@ms/utilities-date-time/lib/DateTime.resx","../locale/Locale","../string/StringHelper"],function(e,t,r,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i,n,a,s,u,p,m,f,h,g=6e4,v=2*g,y=60*g,b=2*y,_=24*y,S=2*_,x=7*_,P=32*_;t.iso8601DateTimeToJsDate=function(e){var t=!1;e.toUpperCase().indexOf("Z")===e.length-1&&(t=!0);var r=e.split(/[^0-9]/);if(!(r.length<6))return t?new Date(Date.UTC(Number(r[0]),Number(r[1])-1,Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]))):new Date(Number(r[0]),Number(r[1])-1,Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]))};function I(e,t){void 0===t&&(t=!1);var r=Date.now()-e.getTime();if(r<-5*g)return e.toLocaleDateString(c.default.language);if(r<g)return t?l.default.RelativeDateTime_LessThanAMinute_StartWithLowerCase:l.default.RelativeDateTime_LessThanAMinute;if(r<v)return t?l.default.RelativeDateTime_AboutAMinute_StartWithLowerCase:l.default.RelativeDateTime_AboutAMinute;if(r<y){var i=Math.floor(r/g);return d.getLocalizedCountValue(l.default.RelativeDateTime_XMinutes,l.default.RelativeDateTime_XMinutesIntervals,i).replace("{0}",String(i))}if(r<b)return t?l.default.RelativeDateTime_AboutAnHour_StartWithLowerCase:l.default.RelativeDateTime_AboutAnHour;if(r<_){var o=Math.floor(r/y);return d.getLocalizedCountValue(l.default.RelativeDateTime_XHours,l.default.RelativeDateTime_XHoursIntervals,o).replace("{0}",String(o))}if(r<S)return t?l.default.RelativeDateTime_YesterdayAndTime_StartWithLowerCase.replace("{0}",e.toLocaleTimeString(c.default.language)):l.default.RelativeDateTime_YesterdayAndTime.replace("{0}",e.toLocaleTimeString(c.default.language));if(r<P){var n=Math.floor(r/_);return d.getLocalizedCountValue(l.default.RelativeDateTime_XDays,l.default.RelativeDateTime_XDaysIntervals,n).replace("{0}",String(n))}return e.toLocaleDateString(c.default.language)}t.getRelativeDateTimeStringPast=I;t.getFriendlyDateTimeStringPast=function(e,t,r,i){void 0===t&&(t=!1);void 0===r&&(r=!1);void 0===i&&(i=!1);var o=Date.now()-e.getTime(),n=function(e){var t=new Date(e);t.setHours(0,0,0,0);return t}(new Date),a=D(n,-1),s=D(n,-6);if(o<-5*g)return e.toLocaleDateString(c.default.language,L({month:"short",day:"numeric"},i));if(o<v)return r?l.default.FriendlyDateTime_JustNow_withinSentence:l.default.FriendlyDateTime_JustNow_asSentence;if(o<y)return E(o,l.default.FriendlyDateTime_minutesShort,g);if(w(n,e))return E(o,l.default.FriendlyDateTime_hoursShort,y);if(a<=e)return t?r?l.default.RelativeDateTime_Yesterday_StartWithLowerCase:l.default.RelativeDateTime_Yesterday:(r?l.default.RelativeDateTime_YesterdayAndTime_StartWithLowerCase:l.default.RelativeDateTime_YesterdayAndTime).replace("{0}",e.toLocaleTimeString(c.default.language,L({hour:"numeric",minute:"2-digit"},i)));if(s<=e){var u=e.toLocaleDateString(c.default.language,L({weekday:"short"},i));return t?u:l.default.RelativeDateTime_DayAndTime.replace("{0}",u).replace("{1}",e.toLocaleTimeString(c.default.language,L({hour:"numeric",minute:"2-digit"},i)))}return A(n,e)?c.default.language.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(c.default.language,L({month:"long",day:"numeric"},i)):e.toLocaleDateString(c.default.language,L({month:"short",day:"numeric"},i)):e.toLocaleDateString(c.default.language,L({month:"short",day:"numeric",year:"numeric"},i))};t.getRelativeDateTimeStringPastWithHourMinute=function(e){var t=Date.now()-e.getTime(),r=e.toLocaleDateString(c.default.language),i=e.toLocaleTimeString(c.default.language,{hour:"numeric",minute:"2-digit"});return t<_?I(e):t<S?d.format(l.default.RelativeDateTime_YesterdayAndTime,i):d.format(l.default.DateTime_DateAndTime,r,i)};function w(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<_}t.isSameDay=w;t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};function A(e,t){return e.getFullYear()===t.getFullYear()}t.isSameYear=A;t.isThisWeek=function(e,t){t=t||new Date;var r=new Date(t.getTime()-t.getDay()*_),i=new Date(r.getTime()+x-_);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.isLastWeek=function(e,t){t=t||new Date;var r=new Date(t.getTime()-t.getDay()*_-x),i=new Date(r.getTime()+x-_);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var r=null,i=null,o=e.split("|");if("0"===o[0])return e.substring(2);var n="1"===o[1],a=o[2],s=4<=o.length?o[3]:null,u=5<=o.length?o[4]:null;switch(a){case"1":r=n?t?l.default.RelativeDateTime_AFewSecondsFuture_StartWithLowerCase:l.default.RelativeDateTime_AFewSecondsFuture:t?l.default.RelativeDateTime_AFewSeconds_StartWithLowerCase:l.default.RelativeDateTime_AFewSeconds;break;case"2":r=n?t?l.default.RelativeDateTime_AboutAMinuteFuture_StartWithLowerCase:l.default.RelativeDateTime_AboutAMinuteFuture:t?l.default.RelativeDateTime_AboutAMinute_StartWithLowerCase:l.default.RelativeDateTime_AboutAMinute;break;case"3":i=d.getLocalizedCountValue(n?t?l.default.RelativeDateTime_XMinutesFuture_StartWithLowerCase:l.default.RelativeDateTime_XMinutesFuture:l.default.RelativeDateTime_XMinutes,n?l.default.RelativeDateTime_XMinutesFutureIntervals:l.default.RelativeDateTime_XMinutesIntervals,Number(s));break;case"4":r=n?t?l.default.RelativeDateTime_AboutAnHourFuture_StartWithLowerCase:l.default.RelativeDateTime_AboutAnHourFuture:t?l.default.RelativeDateTime_AboutAnHour_StartWithLowerCase:l.default.RelativeDateTime_AboutAnHour;break;case"5":null==s?r=n?t?l.default.RelativeDateTime_Tomorrow_StartWithLowerCase:l.default.RelativeDateTime_Tomorrow:t?l.default.RelativeDateTime_Yesterday_StartWithLowerCase:l.default.RelativeDateTime_Yesterday:i=n?t?l.default.RelativeDateTime_TomorrowAndTime_StartWithLowerCase:l.default.RelativeDateTime_TomorrowAndTime:t?l.default.RelativeDateTime_YesterdayAndTime_StartWithLowerCase:l.default.RelativeDateTime_YesterdayAndTime;break;case"6":i=d.getLocalizedCountValue(n?t?l.default.RelativeDateTime_XHoursFuture_StartWithLowerCase:l.default.RelativeDateTime_XHoursFuture:l.default.RelativeDateTime_XHours,n?l.default.RelativeDateTime_XHoursFutureIntervals:l.default.RelativeDateTime_XHoursIntervals,Number(s));break;case"7":null===u?r=s:i=l.default.RelativeDateTime_DayAndTime;break;case"8":i=d.getLocalizedCountValue(n?l.default.RelativeDateTime_XDaysFuture:l.default.RelativeDateTime_XDays,n?l.default.RelativeDateTime_XDaysFutureIntervals:l.default.RelativeDateTime_XDaysIntervals,Number(s));break;case"9":r=t?l.default.RelativeDateTime_Today_StartWithLowerCase:l.default.RelativeDateTime_Today}if(null!==i){r=i.replace("{0}",s);null!==u&&(r=r.replace("{1}",u))}return r};t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,o=r.getFullYear().toString(),n=C((r.getMonth()+1).toString(),2),a=C(r.getDate().toString(),2),s=C(r.getHours().toString(),2),u=C(r.getMinutes().toString(),2),l=C(r.getSeconds().toString(),2),c=(i?"+":"-")+C(i?Math.ceil(r.getTimezoneOffset()/60).toString().replace("-",""):Math.floor(r.getTimezoneOffset()/60).toString(),2)+C((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?o+"-"+n+"-"+a+"T"+s+":"+u+":"+l+c:o+n+a+"T"+s+u+l+c};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.getDateFromDotNetTicks=function(e){return e?new Date(e/1e4-621355968e5):null};function T(){var t=o(),e=k();if(window.Intl&&window.Intl.DateTimeFormat){var r={},i={hour:"2-digit",minute:"2-digit"};n=new Intl.DateTimeFormat(t,r);a=new Intl.DateTimeFormat(t,i);if(e){r.timeZone="UTC";i.timeZone="UTC"}s=new Intl.DateTimeFormat(t,r);u=new Intl.DateTimeFormat(t,i);p=n.format;m=a.format;f=s.format;h=u.format}else{p=f=function(e){return e.toLocaleDateString(t)};m=h=function(e){return e.toLocaleTimeString(t)}}}t.getShortDisplayDate=function(e,t){if(!e)return"";p||T();var r=w(new Date,e);return(t?r?h:f:r?m:p)(e)};t.getFullDisplayDate=function(e,t,r){p||T();var i=t?f(e):p(e),o=t?h(e):m(e);return d.format(l.default.DateAndTime,i,o)};o=function(){for(var e,t=0,r=[window.$Config&&window.$Config.mkt,c.default.language,navigator.language,"en"].filter(function(e){return!!e});t<r.length;t++){var i=r[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}o=function(){return e};return e};function k(){if(void 0===i)try{var e=o();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}function C(e,t){for(var r=e;r.length<t;)r="0"+r;return r}function D(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function E(e,t,r){var i=Math.round(e/r);return t.replace("{0}",String(i))}function L(e,t){return k()&&t&&e?r.__assign({},e,{timeZone:"UTC"}):e}});define("odsp-next/dataSources/album/odc/AlbumDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","../../base/odc/DataRequest","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/dataSources/upload/Upload","../../base/odc/ISkyApiErrorCodes"],function(e,t,i,r,s,o,u,n,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NEW_ALBUM_TAG="__New";t.AUTO_ALBUM_TAG="__Auto";t.WEEKEND_RECAP_ALBUM_TAG="__WeekendRecap";t.EVENT_RECAP_ALBUM_TAG="__EventRecap";var a=function(r){i.__extends(a,r);function a(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(o.urlDataSource);return t}a.prototype.addToAlbum=function(e,t){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(t),action:a.ADD_TO_ALBUM_ACTION};return this._handleRequest(t,r)};a.prototype.removeFromAlbum=function(e,t){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(t),action:a.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(t,r)};a.prototype.createAlbum=function(e,r){var i=this,o=this._getIdsFromKeyArray(r),n=o.slice(0,20),t={id:null,name:e,items:n,action:a.CREATE_ALBUM_ACTION};return(new u.default).send({requestType:"POST",postData:JSON.stringify(t),apiName:a.MODIFY_ALBUM_API_NAME,url:this._getModifyAlbumUrl()}).then(function(t){if(!r||r&&r.length<20)return t;n=o.slice(20);var e={id:t.id,items:n,action:a.ADD_TO_ALBUM_ACTION,name:null};return i._handleRequest(n,e).then(function(e){return t},function(e){var t={errorType:d.UploadErrorType.other,error:new Error(e.data.message)};return s.default.wrapError(t)})},function(e){var t=d.UploadErrorType.other;e.data.code===p.ISkyApiErrorCodes.nameCollision&&(t=d.UploadErrorType.conflict);var r={errorType:t,error:new Error(e.data.message)};return s.default.wrapError(r)})};a.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new u.default).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};a.prototype.createAlbumFromFolder=function(e){var t=this._getModifyAlbumUrl(),r=new u.default,i={id:null,name:e.folder.name,items:[e.folder.id],action:a.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:a.MODIFY_ALBUM_API_NAME,url:t,requestType:"POST",postData:JSON.stringify(i)})};a.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});var t,r=((t={}).id=a.ALBUMS_ID,t.cid=this._urlDataSource.getOwnerId(),t.tagFilter=e.tagFilter,t);return c.serializeQuery(r,void 0,!0)};a.prototype.setCoverPhoto=function(e,t){var r=this._getModifyAlbumUrl(),i=new u.default,o={id:e.id,items:[t.id],action:a.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:a.MODIFY_ALBUM_API_NAME,url:r,requestType:"POST",postData:JSON.stringify(o)}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return s.default.wrapError(t)})};a.prototype._handleRequest=function(e,t){var r=this._getModifyAlbumUrl();return l.default.start({apiName:a.MODIFY_ALBUM_API_NAME,url:r,batchSize:20,items:e,getPostData:function(e){return{id:t.id,name:t.name,items:e,action:t.action}}})};a.prototype._getModifyAlbumUrl=function(){return n.default.skyApiBaseUrl+a.MODIFY_ALBUM_API_NAME};a.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return c.deserializeQuery(e).id})};a.ADD_TO_ALBUM_ACTION="Add";a.CREATE_ALBUM_ACTION="Create";a.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";a.REMOVE_FROM_ALBUM_ACTION="Remove";a.SET_COVER_PHOTO_ACTION="SetCoverPhoto";a.MODIFY_ALBUM_API_NAME="ModifyAlbum";a.ALBUMS_ID="albums";return a}(r.default);t.default=a});define("@ms/odsp-datasources/lib/dataSources/upload/Upload",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"}(t.UploadState||(t.UploadState={}));!function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.invalidName=4]="invalidName";e[e.fileSize=5]="fileSize";e[e.emptyFileOrFolder=6]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib";e[e.overQuota=8]="overQuota";e[e.accessDenied=9]="accessDenied";e[e.lockMismatch=10]="lockMismatch";e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder";e[e.folderUploadNotSupported=12]="folderUploadNotSupported";e[e.versionMismatch=13]="versionMismatch";e[e.authFailure=14]="authFailure";e[e.targetFolderMissing=15]="targetFolderMissing";e[e.malwareDetected=16]="malwareDetected";e[e.throttled=17]="throttled";e[e.pathTooLong=18]="pathTooLong";e[e.disconnected=19]="disconnected";e[e.unlockRequired=20]="unlockRequired"}(t.UploadErrorType||(t.UploadErrorType={}))});define("odsp-next/dataSources/base/odc/ISkyApiErrorCodes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ISkyApiErrorCodes={nameCollision:1e3,fileSizeLimit:2e3,moveIntoMounted:2028,moveIntoOwn:2029}});define("odsp-next/utilities/array/ArrayHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeDuplicates=function(e){var t;t={};for(var r=[],i=0,o=e;i<o.length;i++){var n=o[i],a=""+n;if(!t[a]){t[a]=!0;r.push(n)}}return r}});define("odsp-next/dataSources/item/ItemTaskObserver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,b,r,i,_,a,S,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.Graft=o;var s=function(n){b.__extends(e,n);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=n.call(this,e,t)||this,i=t.itemsStore,o=void 0===i?r.resources.consume(a.resourceKey):i;r._itemsStore=o;r._itemUpdatesByKey={};return r}e.prototype.update=function(e,t){void 0===t&&(t=!1);for(var r=0,i=e;r<i.length;r++){var o=i[r];this._processTask(o)}};e.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,o=r;i<o.length;i++){var n=o[i],a=t[n],s=new _.default(n),u=this._getStoreItem(n);if(u){u.parent;var l=b.__rest(u,["parent"]);S.default(s,l)}S.default(s,{revision:0});for(var c=0,d=a.item;c<d.length;c++){var p=d[c];S.default(s,p)}e[n]=s}for(var m=0,f=r;m<f.length;m++){var h=(s=e[n=f[m]]).parentKey;if(h){var g=e[h]||this._getStoreItem(h)||new _.default(h);e[h]=g;s.parent=g}else delete s.parent}this._pushItemsToStore(e);for(var v=0,y=r;v<y.length;v++){n=y[v];delete(a=t[n]).item}};e.prototype.reset=function(){this._itemUpdatesByKey={}};e.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};e.prototype.getChildren=function(e){var t,r,i,o=e.parentKey,n=e.startIndex,a=e.endIndex,s=[],u=this._itemUpdatesByKey[o];if(u){var l=u.set;if(l)if(l.childrenByIndex){n=void 0===(r=(t={startIndex:n,endIndex:a}).startIndex)?l.startIndex:r,a=void 0===(i=t.endIndex)?l.endIndex:i;for(var c=n;c<a;c++){var d=l.childrenByIndex[c],p=this._getStoreItem(d);s.push(p)}}else if(l.childrenBySibling)for(var m={},f="";f=l.childrenBySibling[f];){if(m[f])throw new Error("Circular reference encountered enumerating the children of '"+o+"'.");m[f]=!0;p=this._getStoreItem(f);s.push(p)}}return s};e.prototype._processTask=function(e){var t=e.key,r=e.output,i=r.item,o=r.set,n=this._itemUpdatesByKey,a=n[t];a||(a=n[t]={});if(i){a.item||(a.item=[]);a.item.push(i)}if(o){var s=n[o.parent.key];s||(s=n[o.parent.key]={});s.set||(s.set={});var u=s.set;if(void 0!==o.index){u.childrenByIndex||(u.childrenByIndex=[]);void 0===u.startIndex?u.startIndex=o.index:u.startIndex=Math.min(u.startIndex,o.index);var l=u.childrenByIndex.length;u.childrenByIndex[o.index]=t;void 0===u.endIndex?u.endIndex=o.index+1:u.endIndex>o.index+1?u.endIndex+=u.childrenByIndex.length-l:u.endIndex=Math.max(u.endIndex,o.index+1)}else if(o.after){u.childrenBySibling||(u.childrenBySibling={});u.childrenBySibling[o.after.key]=t}}};e.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};e.prototype._pushItemsToStore=function(e){var t={};for(var r in e){(n=t[o=e[(u=e[r]).parentKey]&&u.parentKey||""]||(t[o]=[])).push(r)}for(var i=[""];i.length;){var o,n;if(n=t[o=i.shift()]){for(var a=0,s=n;a<s.length;a++){var u;if(!(u=e[r=s[a]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(u,r)}i.push.apply(i,n)}}};e.dependencies=b.__assign({},r.default.dependencies,{itemsStore:a.resourceKey});return e}(r.default);t.ItemTaskObserver=s;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.ResolvedResourceTypeFactory(s)});t.default=s});define("odsp-next/models/task/Task",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(e,t){if((r=e)&&"object"==typeof r){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}var r}i.prototype.succeed=function(e){var t=new i(this);t.output=e;t.status=1;delete t.error;return t};i.prototype.fail=function(e){var t=new i(this);t.error=e;t.status=2;return t};i.prototype.cancel=function(){var e=new i(this);delete e.error;e.status=3;return e};i.prototype.restart=function(){return new i(this.key,this.input)};i.prototype.changeInput=function(e){var t=e(this.input),r=new i(this.key,t);r.output=this.output;r.status=this.status;r.error=this.error;return r};i.prototype.changeOutput=function(e){var t=e(this.output),r=new i(this.key,this.input);r.output=t;r.status=this.status;r.error=this.error;return r};i.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return i}();t.default=r});define("odsp-next/models/item/OneDriveItem",["require","exports","../../dataSources/url/QueryType"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.default.Files;this.displayType=r.default.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.default=i});define("odsp-next/models/store/ItemsStore",["require","exports","tslib","../item/OneDriveItem","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../item/ItemType","../../utilities/array/ArrayHelper","@ms/odsp-utilities/lib/graft/Graft","../../utilities/features/Features"],function(e,t,r,i,o,n,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=p.isFeatureEnabled(p.ReadOnlyItemsStore),f="result=";function h(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,r=t.peek();r.groupings=null;r.items=[];t.valueHasMutated()}var v=function(t){r.__extends(e,t);function e(){var e=t.call(this,"ItemsStore")||this;e._itemSetsKeys={};e._observables=new n.default({owner:e});return window.odstore=e}e.prototype.dispose=function(){this._observables.dispose()};e.prototype.setItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._handleSetItem.apply(this,[e].concat(t))};e.prototype.getItem=function(e){return this.getValue("item="+e)};e.prototype.setItemSet=function(e,t){var r=f+e;this.setValue(r,t);this._itemSetsKeys[r]=1};e.prototype.getItemSetFromItemKey=function(e){var t;for(var r in this._itemSetsKeys){var i=(t=this.getValue(r)).content&&t.content.peek(),o=i&&i.items;if(o)for(var n=0,a=o;n<a.length;n++){var s=a[n];if(s&&s.peek().parentKey===e)return t}}};e.prototype.getItemSet=function(e){return this.getValue(f+e)};e.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(f.length));return e};e.prototype.setNextRequestToken=function(e,t,r){var i="token="+t;r?this.setValue(i,r):this.remove(i)};e.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};e.prototype.invalidateItem=function(e){return this._handleItemInvalidation(e,this.getItem(e))};e.prototype.invalidateItemSet=function(e){var t=this.getValue(f+e);t&&g(t)};e.prototype.emptyAllOtherSets=function(e){var t;for(var r in this._itemSetsKeys)(t=this.getValue(r)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};e.prototype.invalidateLocation=function(e){var t;for(var r in this._itemSetsKeys){var i=h(t=this.getValue(r));if(i){var o=s.deserializeQuery(i),n=o&&o.locationFilter;n&&0<=n.indexOf(e)&&(t.isExpired=!0)}}};e.prototype.invalidateTag=function(e){var t;for(var r in this._itemSetsKeys){var i=h(t=this.getValue(r));if(i){var o=s.deserializeQuery(i);o&&o.tagFilter===e&&(t.isExpired=!0)}}};e.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var r=(e=this.getValue(t)).item&&e.item.peek();if(r&&r.key&&0<=r.key.indexOf("allmyphotos")){e.isExpired=!0;this._invalidateItem(r)}}};e.prototype._handleItemInvalidation=function(e,t){if(t){var r=t.peek(),i=!1,o=[];if(r){o.push(r);switch(r.type){case l.default.Folder:case l.default.Media:i=!0}}for(var n in this._itemSetsKeys){var a=this.getValue(n),s=a.item&&a.item.peek(),u=s&&s.key;if(u&&(u===e||i&&-1<u.indexOf("allmyphotos"))){u===e?this.setNextRequestToken(e,a.key,""):o.push(s);a.isExpired=!0}}o.forEach(this._invalidateItem,this)}};e.prototype._invalidateItem=function(e){var t=new i.default(e.key);d.default(t,e);d.default(t,{revision:e.revision+1});this.setItem(t)};e.prototype._handleSetItem=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var a=[];m&&!Object.isFrozen(n)&&Object.freeze(n);for(var r=function(e){var t="item="+e,r=m?"item_write="+e:t,i=s.getValue(t),o=s.getValue(r);if(o)o(n);else{(o=s._observables.create(n)).equalityComparer=u.objectStrictEquality;s.setValue(r,o);i=m?s._observables.pureCompute(function(){return o()}):o;s.setValue(t,i)}a.push(i)},s=this,i=0,o=c.removeDuplicates([n.key].concat(e));i<o.length;i++){r(o[i])}return a[0]};return e}(o.default);t.ItemsStore=v;t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.SimpleResourceFactory(v)});t.default=v});define("@ms/odsp-utilities/lib/graft/Graft",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"}(t.GraftOperationType||(t.GraftOperationType={}));t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=function e(t,r){if(!f(t))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!f(r))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(r===t)return t;for(var i=0,o=Object.keys(r);i<o.length;i++){var n=o[i],a=r[n],s=t[n];if(a!==s){var u=a;if(f(m=u)&&m.graftOperationType)if(1===u.graftOperationType){s=void 0;a=l=u.value}else if(4===u.graftOperationType){var l=u.value;if(void 0!==t[n])continue;a=l}else{if(2!==u.graftOperationType){if(3===u.graftOperationType){delete t[n];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(l=u.value))continue;a=l}var c=void 0;if(a instanceof Date)c=new Date(a.getTime());else if(h(a)){var d=s;h(d)||(d=[]);d.splice.apply(d,[0,d.length].concat(a));c=d}else if(f(a)){var p=s;f(p)||(p={});e(p,a);c=p}else c=a;t[n]=c}}var m;return t};function f(e){return"object"==typeof e&&!!e}function h(e){return Array.isArray(e)}});define("@ms/odsp-microservice/lib/microService/helpers/BabylonSupport",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["glb","gltf"],i=["cool","fbx","obj","ply","stl","3mf"];function o(e,t){if(t)return 0<=e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())}t.canConvert=function(e){return o(i,e)};t.canRenderNative=function(e){return o(r,e)}});define("odsp-next/dataSources/item/DeletionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"}(r||(r={}));t.default=r});define("@ms/odsp-datasources/lib/interfaces/list/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio"}(r=t.DocumentType||(t.DocumentType={}));t.default=r});define("odsp-next/dataSources/item/odc/ColumnsHelper",["require","exports","tslib","knockout","../../../models/item/ItemType","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../../dataSources/url/QueryType","./ODCDataSource.resx","../../../controls/infoPane/InfoPane.resx","@ms/odsp-utilities/lib/locale/Locale","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../utilities/features/Features"],function(e,t,E,n,L,O,R,M,F,r,N,U,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getColumns=function(e,t,r){void 0===r&&(r={});var i,o,n,a,s,u,l,c,d,p,m,f,h,g,v,y,b,_,S,x,P,I,w,A,T,k,C;if(r){var D=(o=r.defaultSortField,s=(n=t).consume(U.platformDetection).isMobile&&!!n.consume(N.useMobileList.optional),u=E.__assign({},H("type","","FileTypeIcon",!1),{minWidth:s?48:16,width:s?48:16,isIcon:!0,fieldType:O.ColumnFieldType.FileIcon}),l=q(!0),c=j(!0),d=V(),p=K(!0),m=E.__assign({},H("_shareHeroCommand","","_shareHeroCommand",!1),{isIcon:!0,minWidth:16,width:16,fieldType:O.ColumnFieldType.ShareCommand}),f=q(!1),h=j(!1),g=K(!1),v=s?B(u,[[l],[c,p,d]],[l,c,p,d]):("userArranged"===o?[G()]:[]).concat([u,l],z()?[m]:[],[c,d,p]),y=E.__assign({},H("dateTaken",F.strings.informationDateTaken,"dateTaken",!0),{fieldType:O.ColumnFieldType.DateTime}),b=s?B(u,[[l],[c,p,d]],[l,c,y,p,d]):("userArranged"===o?[G()]:[]).concat([u,l],z()?[m]:[],[c,y,d,p]),_=E.__assign({},H("dateAccessed",M.strings.SchemaColumnLastOpened,"dateAccessed",!0),{fieldType:O.ColumnFieldType.DateTime}),S=E.__assign({},H("location",M.strings.SchemaColumnLocation,"",!1),{showTooltip:!0}),x=s?B(u,[[l],[_,p,d]],[l,_,p,d]):[u,l,_,c,S,p],P=V(),I=[u,l,P,p],w=[u,l,P,p],A=s?B(u,[[f],[h,g,d]],[f,h,g,d]):[u,f,d,h,S,g],T=E.__assign({},H("location",M.strings.SchemaColumnOriginalLocation,"location",!0),{width:300,showTooltip:!0}),k=E.__assign({},H("dateDeleted",M.strings.SchemaColumnDateDeleted,"dateDeleted",!0),{fieldType:O.ColumnFieldType.DateTime}),C=s?B(u,[[l],[p,k,T]],[l,k,p,T]):[u,l,T,k,p],(a={})[R.default.Files]=v,a[R.default.Photos]=b,a[R.default.Recent]=x,a[R.default.SharedWithMe]=I,a[R.default.DocsInCommon]=w,a[R.default.Search]=A,a[R.default.RecycleBin]=C,a);e.type===L.default.Folder&&(i=D[e.displayType]||D[R.default.Files]);i&&(i=i.map(function(e){return E.__assign({},e,r.isSortEnabled?(e.internalName||e.key)===r.sortField?{isSorted:!0,isAscending:r.isAscending}:{isSorted:!1}:{sortable:!1})}))}return i};function B(e,t,r){for(var i=[],o=0;o<t.length;o++)for(var n=0,a=t[o];n<a.length;n++){var s=a[n];i.push(E.__assign({},s,{customRowNumber:o}))}for(var u=[e,E.__assign({},H("","","",!1),{width:900,customFields:i})],l=0,c=r;l<c.length;l++){var d=c[l];u.push(E.__assign({},d,{isVisible:!1,isVisibleMobile:!1}))}return u}function H(e,t,r,i,o){return{key:e,name:t,internalName:r,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:i,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:O.ColumnFieldType.Text,filterable:!1,isFocused:n.observable(!1)}}function K(e){return E.__assign({},H("size",M.strings.SchemaColumnSize,"size",e),{isHtml:!0,fieldType:O.ColumnFieldType.FileSize,sortable:e})}function q(e){return E.__assign({},H("displayName",M.strings.SchemaColumnName,"displayName",e),{isCollapsable:!1,minWidth:220,width:440,fieldType:O.ColumnFieldType.Name,sortable:e,hasListItemMenu:!0})}function V(){return E.__assign({},H("defaultSubText",M.strings.SchemaColumnSharing,"",!1),{fieldType:O.ColumnFieldType.Shared})}function G(){return E.__assign({},H("",M.strings.SchemaColumnUserArranged,"userArranged",!0),{isVisible:!1,isVisibleMobile:!1})}function j(e){var t=z()?M.strings.SchemaColumnModified:M.strings.SchemaColumnDateModified;return E.__assign({},H("dateModified",t,"dateModified",e),{sortable:e,sortDescFirst:e,fieldType:O.ColumnFieldType.DateTime},"ml"===(""+r.default.language).toLowerCase()?{width:150}:{})}function z(){return i.isFeatureEnabled(i.EnableUpdatedFilesListView)&&i.isFeatureEnabled(i.FlipOnNewGridAndListExperiment)}});define("@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity";e[e.MruName=36]="MruName";e[e.ShareCommand=37]="ShareCommand";e[e.PinCommand=38]="PinCommand";e[e.Thumbnail=39]="Thumbnail";e[e.ImageSize=40]="ImageSize";e[e.Location=41]="Location"}(r=t.ColumnFieldType||(t.ColumnFieldType={}));t.default=r});define("odsp-next/dataSources/base/odc/ItemErrorProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/ItemType","../../item/ItemDataSource.resx","@ms/odsp-utilities/lib/string/StringHelper","../../item/ItemTaskObserver"],function(e,t,r,i,s,n,a,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.processError=function(e){var t,r=e.requestKey,i=e.error,o=e.itemName,n=e.observer;switch(i&&i.data&&i.data.code||0){case 101:case 102:case 103:case 152:t=1;break;case 200:t=4;break;case 201:t=5;break;case 202:t=3;break;case 3e3:case 10009:t=2;break;case 3403:t=6;break;case 9017:break;default:t=0}var a=this.getError(i,o);n.update([new u.Task(r).succeed({item:{key:r,type:s.default.Error,error:{type:t,data:a},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]);return{error:a,key:r}};e.prototype.getError=function(e,t){var r,i,o=e&&e.data&&e.data.code||0;switch(o){case 209:r=n.strings.ThrottledItemTitle;i=n.strings.ThrottledItemSubText;break;case 509:r=n.strings.StorageBandwidthLimitViewTitle;break;case 1e3:r=n.strings.DuplicateName;break;case 1006:r=n.strings.InvalidChar;break;case 2005:case 2006:r=n.strings.LengthExceeded;break;case 3e3:r=n.strings.ItemNotFoundTitle;i=n.strings.ItemNotFoundSubText;break;case 9001:r=a.format(n.strings.ItemInUse,t);break;case 9006:r=n.strings.SharingBlockedVisitorViewTitle;break;default:r=n.strings.DefaultTitle;i=n.strings.DefaultSubText}return{errorCode:o,errorTitle:r,errorDetailedText:i}};return e}(i.default);t.default=o});define("odsp-next/dataSources/item/odc/MoveCopyDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../url/odc/UrlDataSource"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){this._capabilities||(this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!0,supportsMoveCopyFilterParams:!1,supportsCopyCrossSite:!1,supportsMoveCrossSite:!1,supportsThrottling:!1,supportsProgressCaching:!1});return this._capabilities};t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())};t.prototype.hasMatchingId=function(e,t){return!0};t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var r=new o.default,i=s(e);return r.sendPost("CopyItemsAsync",t,JSON.stringify(i))};t.prototype._getCopyItemsAsyncUrl=function(){return n.default.skyApiBaseUrl+"CopyItemsAsync"};return t}(i.default);t.default=a;function s(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}t.convertMoveCopyContextToPostData=s});define("@ms/odsp-utilities/lib/async/Semaphore",["require","exports","./Promise","./Signal"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new o.default(function(){r.canceled=!0;i.default.is(r.result)&&r.result.cancel()});this._queue.push(r);t=r.signal.getPromise()}return i.default.resolve(t)};e.prototype._promiseComplete=function(){var t=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var r=this._queue.shift();r&&r.canceled;)r=this._queue.length?this._queue.shift():null;if(r){this._running++;r.result=r.callback();r.result.then(function(e){r.signal.complete(e);t._promiseComplete()},function(e){r.signal.error(e);t._promiseComplete()})}}};return e}();t.default=r});define("odsp-next/dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./RansomwareDetectionDataSource",getModule:function(){return new t.default(function(e,t){r(["./RansomwareDetectionDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/restore/odc/RestoreOperationDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./RestoreActivitiesDataSource",getModule:function(){return new t.default(function(e,t){r(["./RestoreOperationDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./RestoreActivitiesDataSource",getModule:function(){return new t.default(function(e,t){r(["./RestoreActivitiesDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/search/odc/SearchDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./SearchDataSource",getModule:function(){return new t.default(function(e,t){r(["./SearchDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/item/odc/RecycleBinDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/odc/UrlDataSource","../../url/QueryType","../DeletionType","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","../ItemTaskObserver"],function(e,t,r,i,o,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=u.default[u.default.RecycleBin].toLowerCase(),n=function(n){r.__extends(e,n);function e(){var e=n.call(this)||this,t=e._urlDataSource.getRootItemKey(u.default.RecycleBin),r=e.getRootItemTitle(t),i=new(e.resources.consume(p.resourceKey));i.update([new p.Task(t).succeed({item:{key:t,type:a.default.Folder,id:e._getRootFileId(),queryType:u.default.RecycleBin,displayType:u.default.RecycleBin,name:r,displayName:r}})]);i.flush();return e}e.prototype.getItem=function(t){var r=this;return n.prototype.getItem.call(this,t).then(function(e){return c.default.wrap(e)},function(e){if(9017===e.errorCode){r.isLargeRecycleBin(!0);return n.prototype.getItem.call(r,t)}return c.default.wrapError(e)})};e.prototype.emptyRecycleBin=function(e,t){t&&this.isLargeRecycleBin(!0);return this._deleteNextBatch(e,t)};e.prototype.emptyRecycleBinAsync=function(){return this._deleteAll()};e.prototype.getRootItemTitle=function(e){return i.strings.RecycleBin};e.prototype._getItemKeyExtension=function(e,t){return e.id!==this._getRootFileId()?((r={}).u=m,r):n.prototype._getItemKeyExtension.call(this,e,t);var r};e.prototype._deleteAll=function(){var e=s.default.skyApiBaseUrl+"DeleteAll";return(new d.default).sendPost("DeleteAll",e,"")};e.prototype._deleteNextBatch=function(t,r){var i=this,o=this._urlDataSource.getRootItemKey(u.default.RecycleBin);return n.prototype.getItem.call(this,{parentKey:o,startIndex:0,pageSize:100}).then(function(e){if(e.children&&e.children.length)return n.prototype.deleteItems.call(i,{parentKey:o,deletionType:l.default.PermanantDelete,items:e.children}).then(function(){if(e.nextRequestToken||r){t(t()+e.children.length);return i._deleteNextBatch(t,r)}})})};return e}(o.default);t.default=n});define("odsp-next/dataSources/language/odc/LanguageDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","../LanguageDataSource"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getCurrentLanguage=function(){return t.prototype.getCurrentLanguage.call(this)||$Config.lang};e.prototype.getCurrentLanguageCode=function(){return $Config.mkt};e.prototype.getLanguages=function(){var u=this;return o.default.startAndPostProcess({url:"/GetLanguageList",json:null},function(e,t){var r=JSON.parse(e.responseText),i=r.Canary,o=r.LanguageInfoList,n=[];for(var a in o)o.hasOwnProperty(a)&&n.push(o[a]);var s=u.getCurrentLanguage();return{languageList:n,canary:i,currentLanguage:s=s&&s.toLowerCase()}})};e.prototype.saveLanguage=function(e,t){var r;r="canary="+encodeURIComponent(t)+"&lang="+e;return o.default.startAndPostProcess({url:"/handlers/languagesave.mvc?"+r,json:r},function(e,t){return e.responseText})};e.prototype.getLocalizedString=function(e,t){return i.default.wrap(null)};return e}(n.default);t.default=a});define("odsp-next/dataSources/language/LanguageDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getCurrentLanguage=function(){return i.default.language};return e}(o.default);t.default=n});define("odsp-next/dataSources/leftNav/odc/LeftNavDataSource",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../utilities/features/Features","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-datasources/lib/Permissions","../../url/PageType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../controls/leftNav/LeftNav.resx","./ODCLeftNavDataSource.resx","../../../dataSources/base/odc/DataRequest","../../../controls/leftPane/LeftPane.resx","../../../resources/DataSourceResourceKeys","./NotificationLinks","../../../utilities/attribution/AttributionHelper"],function(e,t,i,o,r,n,a,s,u,l,c,d,p,m,f,h,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=p.strings,b="PROD_OneDrive-Web_LeftNav_AppDataLink",_=function(r){i.__extends(e,r);function e(){var e,t=r.call(this)||this;t.mapPageToLeftNavSections=((e={})[u.default.StorageInfo]=[4,3],e[u.default.StorageOptions]=[4,3],e[u.default.PhotoPreferences]=[4,3],e[u.default.Restore]=[4,3],e[u.default.AppData]=[4,3],e[u.default.Files]=[0,1,2],e[u.default.Photos]=[0,1,2],e[u.default.TextFileEditor]=[0,1,2],e);t._urlDataSource=t.resources.consume(c.urlDataSource);t._identity=t.resources.consume(h.identity).getIdentity();t._attributionHelper=t.resources.consume(v.resourceKey);t._linkGroups=o.observableArray([]);t._notificationLinks=new(t.managed(g.default));t.needsBottomPadding=t._notificationLinks.needsBottomPadding;return t}e.prototype.getLinkGroups=function(e){var t=this._urlDataSource.getPageType();if(!(t===this._previousPage||this._previousPage!==u.default.Files&&this._previousPage!==u.default.Photos||t!==u.default.Files&&t!==u.default.Photos)){this._previousPage=t;return this._linkGroups}this._previousPage=t;this._linkGroups.removeAll();if(this._isPartApplicable(0)){this._getNavLinks(e);this._linkGroups.push(this._navLinks)}this._isPartApplicable(1)&&this._identity.type===s.IdentityType.msa&&this._getDevices();if(this._isPartApplicable(3)){this._getOptions(e);this._linkGroups.push(this._optionsLinks)}return this._linkGroups};e.prototype.getNotificationLinks=function(){var e=this._notificationLinks.items;this._isPartApplicable(2)?this._notificationLinks.populateItems():this._notificationLinks.clearItems();return e};e.prototype._isPartApplicable=function(e){var t=this._urlDataSource.getPageType(),r=this.mapPageToLeftNavSections[t];return r&&-1!==r.indexOf(e)};e.prototype._getNavLinks=function(e){var t=this,r={text:"OneDrive",url:this._urlDataSource.getFilesQueryUrl(),isExpanded:o.observable(!0),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryFiles()}),isFocused:o.observable(!1),automationId:"LeftNav-OneDriveGrouping",links:o.observableArray([{text:f.strings.Files,automationId:"FilesPageLink",url:this._urlDataSource.getFilesQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryFiles()}),isFocused:o.observable(!1),altText:d.strings.filesAlt,engagementName:"Files"},{text:f.strings.Recent,url:this._urlDataSource.getRecentQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryRecent()}),isFocused:o.observable(!1),altText:d.strings.recentAlt,engagementName:"Recent"},{text:f.strings.Photos,automationId:"PhotosPageLink",url:this._urlDataSource.getAllMyPhotosQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQuery(l.default.Photos)}),isFocused:o.observable(!1),altText:d.strings.photosAlt,engagementName:"Photos"},{text:f.strings.Shared,url:this._urlDataSource.getSharedByQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQuerySharedByMe()}),isFocused:o.observable(!1),altText:d.strings.sharedAltOdc,engagementName:"Shared"},{text:f.strings.RecycleBin,url:this._urlDataSource.getRecycleBinQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryRecycleBin()}),isFocused:o.observable(!1),altText:d.strings.recycleBinAlt,engagementName:"RecycleBin"}])};this._navLinks=r};e.prototype._getOptions=function(e){var t=this,r=this._attributionHelper.getPurchaseAttribution({source:"LeftNavPageList",cta:"UpgradePage"});this._optionsLinks={text:y.Options,url:this._urlDataSource.getNewManageStorageUrl(),isExpanded:o.observable(!0),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===u.default.StorageInfo}),isFocused:o.observable(!1),automationId:"LeftNav-OptionsGrouping",links:o.observableArray([{text:f.strings.NewManageStorage,url:this._urlDataSource.getNewManageStorageUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===u.default.StorageInfo}),isFocused:o.observable(!1),altText:f.strings.NewManageStorage},{text:f.strings.PlansAndUpgrades,url:this._urlDataSource.getUpgradeOptionsUrl(r),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===u.default.StorageOptions}),isFocused:o.observable(!1),altText:f.strings.PlansAndUpgrades},{text:y.OfficeFileFormats,url:this._urlDataSource.getOfficeFileOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:o.observable(!1),altText:y.OfficeFileFormats},{text:y.Photos,url:this._urlDataSource.getPhotoPreferencesUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===u.default.PhotoPreferences}),isFocused:o.observable(!1),isHidden:!1,altText:y.Photos},{text:y.Tagging,url:this._urlDataSource.getPhotosOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:o.observable(!1),altText:y.Tagging},{text:y.Notifications,url:this._urlDataSource.getNotificationOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:o.observable(!1),altText:y.Notifications},{text:y.DeviceBackups,url:this._urlDataSource.getDeviceBackupsOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:o.observable(!1),altText:y.DeviceBackups},{text:y.Restore,url:this._urlDataSource.getNewRestoreOptionsUrl(b),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===u.default.Restore}),isFocused:o.observable(!1),isHidden:!n.isFeatureEnabled(n.PointInTimeRestore),altText:y.Restore},{text:y.AppData,url:this._urlDataSource.getNewAppDataOptionsUrl(b),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===u.default.AppData}),isFocused:o.observable(!1),isHidden:!n.isFeatureEnabled(n.EnableManageAppDataPage),altText:y.AppData},{text:y.Search,url:this._urlDataSource.getSearchOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:o.observable(!1),altText:y.Search}])}};e.prototype._getDevices=function(){var r=this,e=this._urlDataSource.getDevicesApiUrl();(new m.default).send({apiName:"GetDevices",url:e}).then(function(e){var t=e.devices;t&&r._isPartApplicable(1)&&t[0]&&r._navLinks.links.push({text:f.strings.Devices,url:r._urlDataSource.getDevicesPageUrl(),isActive:o.observable(!1),isFocused:o.observable(!1),openInNewTab:o.observable(!0)})},function(e){a.default.log(e,"GetDevices")})};return e}(r.default);t.default=_});define("odsp-next/dataSources/leftNav/odc/NotificationLinks",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../utilities/features/Features","../../../models/quota/QuotaStatus","../../../models/quota/QuotaEventSource","../../../actions/NavigationAction","../../../resources/ODCResourceKeys","../../../controls/leftPane/LeftPane.resx","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","../../../models/quota/QuotaEventDestination","../../../resources/ProviderResourceKeys","../../../utilities/optimizely/experiments/AppUpsell","../../../utilities/optimizely/OptimizelyHelper","../../../models/teachingBubble/TeachingBubbleCampaigns","./ODCLeftNavDataSource.resx","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../controls/leftNav/leftNavSublink/templates/LeftNavTemplates","../../../utilities/dateHelper/DateHelper","../../../utilities/optimizely/experiments/OfficeUpsell.key","../../../controls/leftNav/leftNavSublink/templates/Button.html"],function(r,e,i,m,t,o,f,h,n,a,s,u,l,c,d,p,g,v,y,b,_,S,x,P){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var I=function(e){i.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(s.urlDataSource);t._bundleLoader=t.resources.consume(p.bundleLoader);t._viewParams=t.resources.consume(l.viewParams);t._appsLink=t._getAppsLink();t._confidentialText=t._getConfidentialText();t.items=m.observableArray([]);t.needsBottomPadding=t.createObservable(!1);t._populate=t.createObservable(!1);t._isSearchPassThrough=t.createPureComputed(t._computeIsSearchPassThrough);t._quotaLoaded=t.createPureComputed(t._computeQuotaLoaded);t._items=t.createPureComputed(t._computeItems);t.createBackgroundComputed(t._updateItems);t._showUpsellBanner=t.createObservable(!1);t._wasUpsellDismissed=t.createObservable(!1);t._variationId=t.createObservable(0);t._experimentHelper=t.resources.consume(c.experimentHelper.optional);t._userInfoProvider=t.resources.consume(p.userInfo.optional);t._storageOptionsProvider=t.resources.consume(p.storageOptions);t.resources.consumeAsync(P.resourceKey).then(function(e){t._officeUpsellLogger=e});t._isPremiumEligible=t.createPureComputed(t._computeIsPremiumEligible);t._experimentHelper&&t._initOptimizely();t.createBackgroundComputed(t._computeBannerState);return t}t.prototype.populateItems=function(){this._populate(!0)};t.prototype.clearItems=function(){this._populate(!1)};t.prototype._initOptimizely=function(){var t=this;this._experimentHelper.activateExperimentBehindFeature(f.EnableEnhancedMobileUpsell,g.EXPERIMENT_ID,g.CONTROL_VARIATION).then(function(e){e===g.VARIATIONS[1]&&_.registerTemplate(S.BUTTON_TEMPLATE,r("../../../controls/leftNav/leftNavSublink/templates/Button.html"));t._variationId(e)})};t.prototype._getBannerInfo=function(){return this._userInfoProvider?this._userInfoProvider.getUserInfo(!1).then(function(e){if(e&&e.notifications)for(var t=0,r=e.notifications;t<r.length;t++){var i=r[t];if(i.id.toLowerCase()===g.DISMISS_KEY.toLowerCase())return i}return{}}):o.default.wrap({})};t.prototype._computeIsPremiumEligible=function(){return this._storageOptionsProvider.isReady()?this._storageOptionsProvider.isEligibleForPremium():null};t.prototype._computeBannerState=function(){var o=this;this._variationId()===g.VARIATIONS[3]&&this._userInfoProvider&&this._getBannerInfo().done(function(e){var t=!0,r=!!(e&&e.createdDate&&e.modifiedDate);if(r)try{var i=Date.parse(e.modifiedDate);t=Date.now()-i>g.REAPPEAR_TIMEOUT_MS}catch(e){}t&&r&&e.createdDate===e.modifiedDate&&v.OptimizelyHelper.trackEvent(g.EXPERIMENT_ID,g.EVENTS.bannerReappearAfter7Days);o._showUpsellBanner(t);o._wasUpsellDismissed(r)},function(){})};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(3).isLoaded()){if(!this._userStateProvider){this._userStateProvider=this.resources.consume(p.quota);this._quotaComponent=this._getQuotaComponent();this._quotaWarning=this._getQuotaWarning();this._premiumUpsellComponent=this._getPremiumUpsellComponent()}return!0}return!1};t.prototype._computeIsSearchPassThrough=function(){return this._urlDataSource.isSearchPassThrough(this._viewParams())};t.prototype._computeItems=function(){var e=this._computeBaseItems();window.FilesConfig&&(FilesConfig.df||FilesConfig.int)&&e.push(this._confidentialText);this._showUpsellBanner()&&this._quotaLoaded()&&0<=e.indexOf(this._appsLink)&&e.unshift(this._getAppUpsellComponent());return e};t.prototype._computeBaseItems=function(){var e=this._variationId();e===g.VARIATIONS[1]?this._appsLink=m.utils.extend(m.utils.extend({},this._appsLink),{renderAs:9}):e===g.VARIATIONS[2]&&(this._appsLink=m.utils.extend(m.utils.extend({},this._appsLink),{teachingBubble:y.ODC_MOBILE_APP_UPSELL}));if(!this._populate()){this.needsBottomPadding(!1);return[]}if(!this._quotaLoaded()){this.needsBottomPadding(!0);return[this._appsLink]}var t=this._userStateProvider.status(),r=this._userStateProvider.canUpgrade(),i=this._userStateProvider.accountState(),o=1===i,n=this._isSearchPassThrough(),a=t!==h.default.unknown&&t<h.default.critical&&(!r||this._isPremiumEligible()),s=[];o&&!n&&s.push(this._quotaComponent);var u=!1;if(f.isFeatureEnabled(f.EnableQuotaUxChanges)){var l=this._userStateProvider.lockdownDate();u=t===h.default.overQuota&&i.valueOf()===1..valueOf()&&x.default.getDaysFromToday(l)<=30}var c=!u&&!n&&t>=h.default.overQuota;if(o&&c){this.needsBottomPadding(!1);s.push(this._quotaWarning)}else this.needsBottomPadding(!0);if(!u&&r&&!a&&!c){var d=this._getUpgradeLink();(n||t===h.default.normal)&&(d.renderAs=this._appsLink.renderAs);s.push(d)}var p=t>=h.default.full||!r&&t===h.default.critical;u||n||!o||c||!p||s.push(this._getCleanUpLink());a&&s.push(this._premiumUpsellComponent);t<h.default.critical&&s.push(this._appsLink);return s};t.prototype._updateItems=function(){var e,t=this._items(),r=this.items.peek();t.length?(e=this.items).splice.apply(e,[0,r.length].concat(t)):this.items.removeAll()};t.prototype._getQuotaWarning=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-over-quota",params:{}}}};t.prototype._getQuotaComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-quota-bar",params:{}}}};t.prototype._getPremiumUpsellComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-premium-upsell-banner",params:{}}}};t.prototype._getUpgradeLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(n.default.leftNav,d.default.upgrade);return{text:u.strings.Upgrade,url:t,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),action:new(this.managed(a.default))({beforeNavigation:function(){e._userStateProvider.logEvent(n.default.leftNav,d.default.upgrade)},url:t}),renderAs:6}};t.prototype._getAppUpsellComponent=function(){var t=this;return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-app-upsell",params:{message:b.strings.AppUpsellMessage,buttonText:b.strings.AppUpsellButtonText,action:new(this.managed(a.default))({beforeNavigation:function(){v.OptimizelyHelper.trackEvent(g.EXPERIMENT_ID,t._wasUpsellDismissed.peek()?g.EVENTS.bannerReappearClick:g.EVENTS.downloadBanner)},url:"https://aka.ms/xhkpi9"}),onDismiss:function(){var e=t._wasUpsellDismissed.peek();t._showUpsellBanner(!1);t._userInfoProvider.setUserInfo(7,3,null,g.DISMISS_KEY);v.OptimizelyHelper.trackEvent(g.EXPERIMENT_ID,e?g.EVENTS.bannerReappearDismiss:g.EVENTS.dismissBanner)}}}}};t.prototype._getAppsLink=function(){var e=this,t=this._urlDataSource.getOneDriveAppsUrl();return{text:u.strings.GetOneDriveApps,url:t,action:new(this.managed(a.default))({beforeNavigation:function(){0!==e._variationId()&&v.OptimizelyHelper.trackEvent(g.EXPERIMENT_ID,g.EVENTS.downloadLink);e._officeUpsellLogger&&e._officeUpsellLogger.logOptimizelyEvent("installOneDriveApps")},url:t,target:"_blank"}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!0),renderAs:6,engagementName:"GetOneDriveApps"}};t.prototype._getCleanUpLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(n.default.leftNav,d.default.cleanUpFiles);return{text:u.strings.cleanUpFiles,url:t,action:new(this.managed(a.default))({beforeNavigation:function(){e._userStateProvider.logEvent(n.default.leftNav,d.default.cleanUpFiles)},url:t}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!1),renderAs:6}};t.prototype._getConfidentialText=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:2,text:"Microsoft Confidential"}};return t}(t.default);e.default=I});define("odsp-next/models/quota/QuotaStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.unknown=-1]="unknown";e[e.normal=0]="normal";e[e.critical=1]="critical";e[e.full=2]="full";e[e.outOfSpace=3]="outOfSpace";e[e.overQuota=4]="overQuota"}(r||(r={}));t.default=r});define("odsp-next/models/quota/QuotaEventSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.update=0]="update";e[e.leftNav=1]="leftNav";e[e.uploadBlock=2]="uploadBlock";e[e.frozenBlock=3]="frozenBlock";e[e.manageStorage=4]="manageStorage";e[e.lockedBlock=5]="lockedBlock";e[e.dragAndDrop=6]="dragAndDrop";e[e.premiumLeftNav=7]="premiumLeftNav";e[e.quotaBanner=8]="quotaBanner"}(r||(r={}));t.default=r});define("odsp-next/actions/NavigationAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,i,a,s,m,f,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(p){r.__extends(e,p);function e(e){var t=p.call(this,e)||this;t.name="Navigation";var r=e.url,i=e.viewParams,o=e.target,n=void 0===o?"_top":o,a=e.forceNavigation,s=void 0!==a&&a,u=e.ignoreHistory,l=e.beforeNavigation,c=e.afterNavigation,d=e.postProcessUrl;t._navigation=t.resources.consume(m.navigation);t._viewParams=t.resources.consume(f.viewParams);t._url=t.wrapObservable(r);t._inputViewParams=t.wrapObservable(i);t._target=t.wrapObservable(n);t._forceNavigation=s;t._ignoreHistory=u;t._beforeNavigation=l;t._afterNavigation=c;t._postProcessUrl=d;return t}e.prototype.onExecute=function(e,t){var r=this._url.peek(),i=this._inputViewParams.peek(),o=this._beforeNavigation;o&&o(this._navigation);var n=this._postProcessUrl?this._postProcessUrl(r):r;(this._forceNavigation||r)&&this._navigation.navigateTo({url:n,viewParams:i,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return a.default.wrap({resultType:s.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),r=this._viewParams(),i="#"+u.serializeQuery(r),o=t&&0===t.indexOf("#")?t.substring(1):"",n=o+(o?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(n){var a=u.deserializeQuery(n);return!l.deepCompare(r,a)}return e!==i};return e}(i.default);t.default=o});define("odsp-next/base/BaseAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-shared/lib/base/BaseModel","../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../dataSources/url/PageType","../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../providers/engagement/Engagement"],function(e,t,r,i,o,n,d,a,s,u,l,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(c){r.__extends(e,c);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=c.call(this,e,t)||this;r.name="BaseAction";var i=r,o=i.resources,n=i.observables,a=t.urlDataSource,s=void 0===a?o.consume(d.url.optional):a,u=t.instrumentationProvider,l=void 0===u?o.consume(m.instrumentation.optional):u;r._BaseAction_urlDataSource=s;r._BaseAction_instrumentationProvider=l;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=n.create(0);r.isAvailable=n.pureCompute(r._computeIsAvailable);r.isToggled=n.pureCompute(r._computeIsToggled);r.isExecuting=n.pureCompute(r._computeIsExecuting);return r}e.prototype.execute=function(t){var e,r,i=this,o=this.isQosLogged?this.onCreateQosEvent(t):null;try{if(!(e=this.onExecute(t,o)))throw new Error("Action did not return a promise")}catch(e){s.default.log(e);r=e}if(r){o&&o.end(this.onCreateErrorEventArg(t,r,!0));e=a.default.wrapError(r)}else{this._executingInstanceCount(this._executingInstanceCount.peek()+1);e.done(function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);if(o){i._logEngagementEvent(o.data.extraData);o.end(e)}},function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);e&&!a.default.isCanceled(e)&&s.default.log(e);if(o){i._logEngagementEvent(o.data.extraData);o.end(i.onCreateErrorEventArg(t,e,!1))}})}return e};e.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.Action({name:this.name,pageType:t&&u.default[t.getPageType()]||"",queryType:t&&l.default[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};e.prototype.onCreateErrorEventArg=function(e,t,r){return t&&a.default.isCanceled(t)?{resultType:p.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:p.ResultTypeEnum.Failure,resultCode:r?"NoPromiseReturned":"PromiseFailed"}};e.prototype.onExecute=function(e,t){var r={resultType:p.ResultTypeEnum.Failure};return a.default.wrap(r)};e.prototype.onIsAvailable=function(){return!0};e.prototype.onIsToggled=function(){return!1};e.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};e.prototype._computeIsToggled=function(){return!!this.onIsToggled()};e.prototype._computeIsExecuting=function(){return 0<this._executingInstanceCount()};e.prototype._logEngagementEvent=function(e){if(this.isQosLogged){var t=this._BaseAction_instrumentationProvider;this.resources.consume(f.resourceKey).logData({name:this.name,location:"NA",usageType:o.UsageType[o.UsageType.Click],currentPage:t&&t.currentPageName()||"NA",previousPage:t&&t.previousPageName()||"NA",extraData:r.__assign({},e||{},t&&t.getEngagementData()||{})})}};e.dependencies=r.__assign({},n.default.dependencies,{urlDataSource:d.url,instrumentationProvider:m.instrumentation.optional});return e}(n.default);t.default=c});define("@ms/odsp-shared/lib/utilities/logging/events/Action.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=o.ResultTypeEnum;t.Action=r.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.Qos);t.default=t.Action});define("@ms/odsp-utilities/lib/logging/events/UsageType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard"}(t.UsageType||(t.UsageType={}))});define("odsp-next/resources/UtilityResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.idle=new r.ResourceKey("idle");t.beforeUnload=new r.ResourceKey("beforeUnload");t.syncActiveXClient=new r.ResourceKey("syncActiveXClient");t.experimentHelper=new r.ResourceKey("experimentHelper");t.attributionHelper=new r.ResourceKey("attributionHelper");t.educationAndUpsells=new r.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new r.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new r.ResourceKey("clientSideExtensionHelper");t.needsAttentionViewHelper=new r.ResourceKey("needsAttentionViewHelper")});define("odsp-next/models/quota/QuotaEventDestination",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.unknown=0]="unknown";e[e.none=1]="none";e[e.learnMore=2]="learnMore";e[e.upgrade=3]="upgrade";e[e.cleanUpFiles=4]="cleanUpFiles";e[e.manageStorage=5]="manageStorage";e[e.wac=6]="wac";e[e.officePlans=7]="officePlans"}(r||(r={}));t.default=r});define("odsp-next/utilities/optimizely/experiments/AppUpsell",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=6510611637;t.VARIATIONS=[6507761696,6504811788,6499116090,6504533206];t.CONTROL_VARIATION=t.VARIATIONS[0];t.EVENTS={downloadLink:"WebDownloadLink",downloadBanner:"WebDownloadBanner",dismissBanner:"WebDismissBanner",dismissTeachingBubble:"WebDismissTeachingBubble",bannerReappearAfter7Days:"WebBannerReappearAfter7Days",bannerReappearClick:"WebReappearBannerClick",bannerReappearDismiss:"WebReappearBannerDismiss"};t.DISMISS_KEY="26C6F29F-016D-4309-8FA2-1C9B8151AFC9";t.REAPPEAR_TIMEOUT_MS=6048e5});define("odsp-next/utilities/optimizely/OptimizelyHelper",["require","exports","@ms/odsp-shared/lib/utilities/optimizely/OptimizelyHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function o(){}o.init=function(e,t,r){window.optimizely=window.optimizely||[];window.optimizely.push(["setCookieExpiration",365]);window.optimizely.push(["skipPageTracking"]);var i=window.location.href.replace(o.AUTHKEY_REGEX,"$1$2");window.optimizely.push(["trackEvent",i]);return n.default.init(e,t,r).then(function(){var e=window.location.search;e&&(0<e.indexOf("su=1")?o.trackEvent(o.SIGN_INUP_EXPERIMENT_ID,"SignUpCompletedODC"):0<e.indexOf("gologin=1")&&o.trackEvent(o.SIGN_INUP_EXPERIMENT_ID,"SignInCompletedODC"))},function(){})};o.trackEvent=function(e,t,r){void 0===r&&(r=!1);n.default.trackEvent(e,t,r)};o.activateExperiment=function(e){return n.default.activateExperiment(e)};o.SetDimensionValue=function(e,t){n.default.SetDimensionValue(e,t)};o.GetVariationIdsMapForExperiment=function(e){return n.default.GetVariationIdsMapForExperiment(e)};o.LogShareInvokedAction=function(e){var t="";if(2===e){o._anyShareExecutedCount++;o._linkExecutedCount++;t=o.EVENTS.getLinkClicked;10<=o._linkExecutedCount?t=o.EVENTS.getLinkClickedTenPlus:5<=o._linkExecutedCount?t=o.EVENTS.getLinkClickedFivePlus:2<=o._linkExecutedCount&&(t=o.EVENTS.getLinkClickedTwoPlus)}else if(1===e){o._anyShareExecutedCount++;o._inviteExecutedCount++;t=o.EVENTS.inviteClicked;10<=o._inviteExecutedCount?t=o.EVENTS.inviteClickedTenPlus:5<=o._inviteExecutedCount?t=o.EVENTS.inviteClickedFivePlus:2<=o._inviteExecutedCount&&(t=o.EVENTS.inviteClickedTwoPlus)}if(t){o.trackEvent(o.EXPERIMENTS.share,t);t=o.EVENTS.anyShareClicked;10<=o._anyShareExecutedCount?t=o.EVENTS.anyShareClickedTenPlus:5<=o._anyShareExecutedCount?t=o.EVENTS.anyShareClickedFivePlus:2<=o._anyShareExecutedCount&&(t=o.EVENTS.anyShareClickedTwoPlus);o.trackEvent(o.EXPERIMENTS.share,t)}};o.AUTHKEY_REGEX=/(\?|&)authkey=[^&]+&?(.*)?$/;o.LEFT_NAV_EXPERIMENT_ID=2623860133;o.LEFT_NAV_VARIATION_ID="2621120483";o.SIGN_INUP_EXPERIMENT_ID=5221551250;o.SEARCHBOX_GLYPH_EXPERIMENT_ID=3354310012;o.SEARCHBOX_GLYPH_VARIATION_NONE_ID=3319860271;o.SEARCHBOX_GLYPH_VARIATION_LEFT_ID=3330500084;o.SEARCHBOX_GLYPH_VARIATION_RIGHT_ID=3363121932;o.SHARE_EXPERIMENT_ID=3643121303;o.SHARE_VARIATION_LINK_ID=3657201057;o.SHARE_VARIATION_SHARE_LINK_ID=3668330022;o.SHARE_VARIATION_EMAIL_ID=3659890065;o.SHARE_VARIATION_INVITE_ID=3666460021;o.PHOTOSSEARCH_BUBBLE_EXPERIMENT_ID=5249240265;o.PHOTOSSEARCH_BUBBLE_VARIATION_OFF_ID=5238290484;o.PHOTOSSEARCH_BUBBLE_VARIATION_BLUE_ID=5240870725;o.PHOTOSSEARCH_BUBBLE_VARIATION_WHITE_ID=5323411530;o.STORAGEOPTIONS_EXPERIMENT_ID=5136502086;o.STORAGEOPTIONS_ORIGINAL=5139232409;o.STORAGEOPTIONS_VARIATION_BESTDEAL_NOTRIAL=5131802173;o.STORAGEOPTIONS_VARIATION_BESTDEAL_TRIAL=5138372118;o.STORAGEOPTIONS_VARIATION_1TB_NOTRIAL=5139232410;o.STORAGEOPTIONS_VARIATION_1TB_TRIAL=5131021992;o.EXPERIMENTS={searchBoxGlyph:o.SEARCHBOX_GLYPH_EXPERIMENT_ID,share:o.SHARE_EXPERIMENT_ID,photosSearchBubble:o.PHOTOSSEARCH_BUBBLE_EXPERIMENT_ID,storageOptions:o.STORAGEOPTIONS_EXPERIMENT_ID};o.EVENTS={UpsellClickCloseButton:"Upsell.ClickCloseButton",searchExecuted:"searchExecuted",searchExecutedTwice:"searchExecutedTwice",searchExecutedThreePlus:"searchExecutedThreePlus",searchBoxClicked:"searchboxClicked",inviteClicked:"shareClicked",inviteClickedTwoPlus:"inviteClickedTwoPlus",inviteClickedFivePlus:"inviteClickedFivePlus",inviteClickedTenPlus:"inviteClickedTenPlus",getLinkClicked:"getLinkClicked",getLinkClickedTwoPlus:"getLinkClickedTwoPlus",getLinkClickedFivePlus:"getLinkClickedFivePlus",getLinkClickedTenPlus:"getLinkClickedTenPlus",anyShareClicked:"anyShareClicked",anyShareClickedTwoPlus:"anyShareClickedTwoPlus",anyShareClickedFivePlus:"anyShareClickedFivePlus",anyShareClickedTenPlus:"anyShareClickedTenPlus",photosSearchExecuted1:"PhotoSearchExecutedOnce",photosSearchExecuted2:"PhotoSearchExecutedTwice",photosSearchExecuted3:"PhotoSearchExecutedThree",photosSearchExecuted4:"PhotoSearchExecutedThreePlus",photosSearchBoxClicked:"PhotoSearchboxClicked",selectedLeftNav:"selectedLeftNav"};o.EVENT_TO_API_ID={ClickGetTheApps:"SkyDriveWeb_ABTest_LeftNav_GetApps"};o.IS_OPTIMIZELY_ENABLED=o.IS_OPTIMIZELY_ENABLED;o._anyShareExecutedCount=0;o._inviteExecutedCount=0;o._linkExecutedCount=0;return o}();t.OptimizelyHelper=r});define("@ms/odsp-shared/lib/utilities/optimizely/OptimizelyHelper",["require","exports","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/FeatureOverrides","./Optimizely.event","./OptimizelyState.event","@ms/odsp-utilities/lib/modules/ModuleLoader"],function(e,t,r,i,o,a,l,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function u(){}u.init=function(e,s,t){e&&(u._id=e);if(u.requirePromise)return u.requirePromise;if(u.IS_OPTIMIZELY_ENABLED&&u._id&&!t){window.optimizely=window.optimizely||[];window.optimizely.push(["setCookieExpiration",365]);return u.requirePromise=n.loadModuleIdentity({path:"optimizely",require:window.require}).then(function(){if(window.optimizely&&optimizely.push){optimizely.push(["setDimensionValue","ODLocale",s]);optimizely.push(["setDimensionValue","ODCID",u._id]);optimizely.push(["setDimensionValue","webAuthState","UnAuth"!==u._id]);var e=optimizely.data&&optimizely.data.state;if(e&&e.activeExperiments&&e.activeExperiments.length){for(var t=[],r=[],i=0;i<e.activeExperiments.length;i++){var o=e.activeExperiments[i],n=e.variationIdsMap[o]||"0";t.push(o);r.push(n)}var a={experiments:t.join(","),variations:r.join(","),unid:u._id};l.OptimizelyState.logData(a)}}},function(){})}return u.requirePromise=i.default.resolve()};u.trackEvent=function(i,o,n){void 0===n&&(n=!1);u.init().done(function(){if(window.optimizely&&optimizely.push){n?optimizely.push(["trackEvent",o,{revenue:1}]):optimizely.push(["trackEvent",o]);var e=optimizely.data&&optimizely.data.state;if(e){var t=u._id,r={eventName:o,experimentId:i,variationId:e.variationIdsMap[i]&&e.variationIdsMap[i][0],unid:t};a.Optimizely.logData(r)}}})};u.activateExperiment=function(e){return u._activatedExperiments[e]?i.default.resolve(null):u.init().then(function(){if(window.optimizely&&optimizely.push){optimizely.push(["activate",e]);u._activatedExperiments[e]=!0}})};u.SetDimensionValue=function(e,t){u.init().done(function(){window.optimizely&&optimizely.push&&optimizely.push(["setDimensionValue",e,t])})};u.GetVariationIdsMapForExperiment=function(e){return u.init().then(function(){return window.optimizely&&optimizely.data&&optimizely.data.state&&optimizely.data.state.variationIdsMap&&optimizely.data.state.variationIdsMap[e]})};u.OptimizelyEnabled={ODB:803,ODC:"OptimizelyEnabled",Fallback:!1};u.IS_OPTIMIZELY_ENABLED=o.default.isFeatureEnabled(u.OptimizelyEnabled);u.async=new r.default;u._activatedExperiments={};return u}();t.default=s});define("@ms/odsp-shared/lib/utilities/optimizely/Optimizely.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Optimizely=r.createSingleEvent({eventName:"Optimizely,",shortEventName:"Optimizely"},{eventName:1,experimentId:1,variationId:1,unid:1});t.default=t.Optimizely});define("@ms/odsp-shared/lib/utilities/optimizely/OptimizelyState.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OptimizelyState=r.createSingleEvent({eventName:"OptimizelyState,",shortEventName:"OptimizelyState"},{experiments:1,variations:1,unid:1});t.default=t.OptimizelyState});define("odsp-next/controls/leftNav/leftNavSublink/templates/LeftNavTemplates",["require","exports","./Link.html","./IndentedLink.html","./Load.html","./Text.html","./WarningText.html","./GroupLink.html","./NotificationLink.html","./More.html","./BasicLink.html","./Component.html"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LINK_TEMPLATE="ms-left-nav-link";t.BUTTON_TEMPLATE="ms-left-nav-button";t.LOAD_TEMPLATE="ms-left-nav-load";t.TEXT_TEMPLATE="ms-left-nav-text";t.WARNING_TEXT_TEMPLATE="ms-left-nav-warning-text";t.GROUPLINK_TEMPLATE="ms-left-nav-groupLink";t.MORE_TEMPLATE="ms-left-nav-more";t.NOTIFICATION_TEMPLATE="ms-left-nav-notificationLink";t.INDENTED_TEMPLATE="ms-left-nav-indentedlink";t.BASIC_LINK_TEMPLATE="ms-left-nav-basicLink";t.COMPONENT_TEMPLATE="ms-left-nav-component"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Link.html",[],function(){return"\x3c!--ko if: !$data.isHidden--\x3e<a role=treeitem class=\"LeftNav-subLink ms-font-m\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isActive, 'aria-label': $data.altText }, teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $parent.onClick.bind($parent), automationType: 'Link'\">\x3c!--ko if: $data.icon--\x3e<i class=\"LeftNav-sublinks-icon ms-Icon\" data-bind=\"class: $data.icon.getClass()\">\x3c!--ko if: $data.iconOverlayImageUrl--\x3e<img onerror=\"this.style.display = 'none';\" data-bind=\"attr: { src: $data.iconOverlayImageUrl }\">\x3c!--/ko--\x3e</i>\x3c!--/ko--\x3e<span data-bind=\"css: { 'LeftNav-fadient': !$component.isFluentFlight }\"><span class=LeftNav-linkText data-bind=\"text: $data.text, attr: { 'id': $data.domId ? $data.domId : '', 'title': $data.text }\"></span></span></a>\x3c!--/ko--\x3e"});define("odsp-next/controls/leftNav/leftNavSublink/templates/IndentedLink.html",[],function(){return"<a role=treeitem class=\"LeftNav-subLink LeftNav-subLinkIndent\" data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isActive, 'aria-label': $data.altText }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick.bind($component), automationType: 'Link'\"><span><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Load.html",[],function(){return'<div class=LeftNav-loadingTemplate>\x3c!--ko component: { name: $component.loadingSpinnerTagName, params: { "loadingText": text } }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/Text.html",[],function(){return'<div class=LeftNav-subLinksAsText data-bind="html: $data.text"></div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/WarningText.html",[],function(){return'<div class=LeftNav-subLinkWarningText data-bind="html: $data.text"></div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/GroupLink.html",[],function(){return"<a role=treeitem tabindex=-1 class=\"LeftNav-groupLink ms-fontWeight-regular\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, 'aria-selected': isActive, title: $data.text }, hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': $data.isFocused, 'ms-font-s': !$component.isFluentFlight, 'ms-fontSize-14': $component.isFluentFlight }, click: $component.onClick.bind($component), automationType: 'Link'\"><span data-bind=\"css: { 'LeftNav-fadient': !$component.isFluentFlight }\"><span class=LeftNav-linkText><span class=od-LeftNav-sublink-siteIcon data-bind=\"component: { name: 'ms-site-icon', params: { iconUrl: $data.iconOverlayImageUrl, icon: $data.icon, acronym: $data.acronym, color: $data.color } }\"></span> <span data-bind=\"text: $data.text\"></span></span></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/NotificationLink.html",[],function(){return"<a class=LeftNav-notificationLink data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-selected': isActive, 'aria-label': $data.altText }, visible: !$data.show || $data.show(), hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick.bind($component), automation: $data.automationId, automationType: 'Link'\"><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/More.html",[],function(){return"<div class=LeftNav-subLinksAsText><a href=# data-bind=\"click: $parent.toggleMore.bind($parent), attr: { tabindex: isFocused() ? 0: -1, 'aria-selected': isActive }, text: $data.text, title: $data.text\"></a></div>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/BasicLink.html",[],function(){return"<a class=LeftNav-basicLink role=treeitem data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : '', tabindex: $data.isFocused() ? 0: -1, 'aria-selected': isActive, 'aria-label': $data.altText }, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, hasFocus: isFocused, automation: $data.automationId, click: $component.onClick.bind($component)\"><span data-bind=\"text: text\"></span> <span class=LeftNav-bubbleAnchor data-bind=\"teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }\"></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Component.html",[],function(){return'<div class=LeftNav-subLinksAsComponent data-bind="component: $data.component"></div>'});define("odsp-next/utilities/dateHelper/DateHelper",["require","exports","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.convertToLocaleDateString=function(e,t){void 0===t&&(t="en-us");try{var r=t.toLocaleLowerCase();return new Date(e).toLocaleDateString(r)}catch(e){return}};e.convertToDateString=function(e){var t=new RegExp(/(\d{4})\-(\d{1,2})\-(\d{1,2})/);if(e&&e.match(t))return e.replace(t,"$2/$3/$1")};e.convertToDayMonth=function(e,t){void 0===t&&(t="en-us");try{var r=t.toLocaleLowerCase(),i=new Date(e),o=i.toLocaleString(r,{month:"short"});return n.format("{0}. {1}",i.getDate(),o)}catch(e){return}};e.convertToMonthDayYear=function(e,t){void 0===t&&(t="en-us");try{var r=t.toLocaleLowerCase(),i=new Date(e),o=i.toLocaleString(r,{month:"long"});return n.format("{0} {1}, {2}",o,i.getDate(),i.getFullYear())}catch(e){return}};e.convertToLocaleString=function(e,t){void 0===t&&(t="en-us");try{var r=t.toLocaleLowerCase();return new Date(e).toLocaleString(r)}catch(e){return}};e.getDaysFromToday=function(e){var t=new Date(e).getTime()-(new Date).getTime();return Math.floor(t/864e5)};return e}();t.default=r});define("odsp-next/utilities/optimizely/experiments/OfficeUpsell.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./OfficeUpsell",getModule:function(){return new t.default(function(e,t){r(["./OfficeUpsell"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/leftNav/leftNavSublink/templates/Button.html",[],function(){return'<button class="LeftNav-Button od-Button" role=treeitem data-bind="attr: { tabindex: $component.isLeftNavVisible() ? 0: -1, \'aria-label\': text }, automation: $data.automationId, click: $component.onClick.bind($component)"><span class=od-Button-label data-bind="text: text"></span></button>'});define("odsp-next/utilities/attribution/AttributionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../models/quota/QuotaStatus","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/resources/Resources","../../utilities/purchaseLogging/AwaHelper"],function(e,t,r,i,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new u.ResourceKey("attributionHelper");var c=function(t){r.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.appendPurchaseAttributionAndLogAction=function(e,t){return this.appendPurchaseAttribution(e,t)};e.prototype.appendPurchaseAttribution=function(e,t){var r=new s.default(t);this._navigation=this.resources.consume(o.navigation);var i=this._navigation.viewParams["WT.mc_id"];i||(i=this.getPurchaseAttribution(e));r.setQueryParameter("WT.mc_id",i);return r.toString()};e.prototype.getPurchaseAttribution=function(e){var t=this._getUserState();return"PROD_OneDrive-"+(e.attributionEndpoint||"Web")+"_"+e.source+"_"+t+"_"+e.cta};e.prototype.logAttributionViaAWA=function(e){void 0===e&&(e={});l.default.logPagePurchaseAction(r.__assign({},e))};e.prototype._convertStatus=function(e){switch(e){case a.default.normal:return"Normal";case a.default.critical:return"Critical";case a.default.full:return"Full";case a.default.overQuota:case a.default.outOfSpace:return"OverLimit";default:case a.default.unknown:return"Unknown"}};e.prototype._getUserState=function(){return this._isUserStateProviderAvailable()&&this._userStateProvider.status?this._convertStatus(this._userStateProvider.status.peek()):"Unknown"};e.prototype._isUserStateProviderAvailable=function(){this._userStateProvider=this.resources.consume(n.quota.optional);this._bundleLoader=this.resources.consume(n.bundleLoader.optional);if(this._bundleLoader){return this._bundleLoader.getBundleInfo(3).isLoaded()}return!1};return e}(i.default);t.default=c});define("odsp-next/utilities/purchaseLogging/AwaHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/ModuleLoader","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=window.$Config&&window.$Config.mkt,l="AWALIB",r=function(){function r(){}r.init=function(){var e,t=new s.Qos({name:"LoadAwaLibrary"});a.default.addPaths(((e={})[l]="https://az725175.vo.msecnd.net/scripts/jsll-4",e));return n.loadModule({path:l,getModule:function(){return new o.default(function(e,t){window.require([l],e,t)})}}).then(function(){var e={coreData:{appId:"OneDrive",market:u}};window.awa.init(e);r.hasBeenInitialized=!0;t.end({resultType:s.ResultTypeEnum.Success})},function(e){t.end({resultType:s.ResultTypeEnum.Failure})})};r.logPagePurchaseAction=function(t){var e=function(){var e=i.__assign({},t,{behavior:awa.behavior.ADDTOCART});awa.ct.captureContentPageAction(e)};r.hasBeenInitialized?e():r.init().done(function(){e()})};r.hasBeenInitialized=!1;return r}();t.default=r});define("odsp-next/dataSources/peoplePicker/odc/PeoplePickerDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/EmailAddressParser","../../../resources/DataSourceResourceKeys"],function(e,t,r,i,u,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){return{supportsMruCaching:!1}};t.prototype.search=function(t,e){return this.resources.consumeAsync(n.peopleService).then(function(e){return e.getContacts(t)}).then(function(e){return e.map(function(e){var t="",r=e.emailAddresses;if(r&&0<r.length)for(var i=0,o=r;i<o.length;i++){var n=o[i];if(n&&n.address&&0<n.address.length){t=n.address;break}}return{userId:e.displayName,name:e.displayName,email:t}})})};t.prototype.resolve=function(i,o){var n,a=this,s=function(){if(n){n.cancel();n=void 0}};return new u.default(function(t,e){var r=function(e){s();t(e)};n=u.default.timeout(2e3).then(function(){r(a._getPersonFromQuery(i))});a.search(i,o).then(function(e){0===e.length?r(a._getPersonFromQuery(i)):r(e[0])},function(e){r(a._getPersonFromQuery(i))})},s)};t.prototype.getPersonaDetails=function(e){return null};t.prototype.subscribePresence=function(e,t){return{dispose:function(){}}};t.prototype.getPickerEntityInformation=function(e){return null};t.prototype._getPersonFromQuery=function(e){var t=new o.default(e),r={};if(t.getEmail()){r.name=t.getName()||"";r.image="";r.sharingInfo={type:0};r.isResolved=!0}r.email=t.getEmail()||e;return r};return t}(i.default);t.default=a});define("@ms/odsp-utilities/lib/string/EmailAddressParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function h(e){var t;if(this._raw=e){e=(e=e.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,o=new RegExp(h.EmailRegexPattern,"gi"),n=h.EmailMatchTypes.None,a=h.EmailMatchTypes.None;null!=(i=o.exec(e));){var s=i[0],u=s.charAt(0),l=s.charAt(s.length-1);if(n<(a="<"===u&&">"===l?h.EmailMatchTypes.Bracketed:'"'===u&&'"'===l?h.EmailMatchTypes.Quoted:h.EmailMatchTypes.Bare)){r=i;if((n=a)===h.EmailMatchTypes.Bracketed)break}}var c=e;if(r){t=r[0];var d=r.index,p=d+t.length,m=0<d?e.substr(0,d).trim():"",f=p<e.length?e.substr(p):"";if("'"===(t=h.StripBracketsAndQuotesRegex.exec(t)[1]).charAt(0)&&f&&"'"===f.charAt(0)){t=t.slice(1);f=f.slice(1).trim()}c=""===m?f:m;this._email=t.trim()}1<(c=c.replace(/^\s*"\s*/,"").trim()).length&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==t&&(this._name=c)}}h.isValidEmailSyntax=function(e,t){return!!e&&!!(t?h.ValidEmailRegex:h.EmailRegex).exec(e.trim())};h.parse=function(e){if(!e)return[];for(var t=h._splitAddresses(e),r=[],i=0,o=t.length;i<o;i++)r.push(new h(t[i]));return r};h.endsWithDelimiter=function(e){if(e){var t=e.split(h.DelimiterRegex);return!t[t.length-1].trim()}return!1};h._splitAddresses=function(e){for(var t=e.split(h.DelimiterRegex),r=t.length-1;0<=r;r--){t[r]=t[r].trim();0===t[r].length&&t.splice(r,1)}return t};h.prototype.getEmail=function(){return this._email};h.prototype.getName=function(){return this._name};h.prototype.getRaw=function(){return this._raw};h.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";h.EmailRegex=new RegExp(h.EmailRegexPattern,"i");h.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";h.ValidEmailRegex=new RegExp(h.ValidEmailRegexPattern,"i");h.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;h.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;h.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return h}();t.default=r});define("odsp-next/dataSources/sharing/odc/SharingDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../SharingDataSource.resx","../../../models/item/ItemHelper","../../base/odc/DataRequest","../../base/odc/SkyApiDataRequest","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./SharingDataHelper"],function(e,t,r,i,f,h,g,v,o,y,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(m,t);function m(){var e=t.call(this)||this;e._sharingDataHelper=new(e.managed(a.default));e._urlDataSource=e.resources.consume(n.urlDataSource);return e}m.prototype.manageSharingLinks=function(e,t){var r=this,i=t.name||t.link&&t.link.name,o=t.id||t.link&&t.link.id,n=t.link&&t.link.entityType||3,a=t.expiration,s=t.password,u=[t.person||{userId:o,name:void 0,email:void 0,sharingInfo:{item:e[0].item,role:t.role,type:n,userId:o}}],l={items:e.map(function(e){return e.item}),sendEmail:t.create,roleValue:this._sharingDataHelper.convertToSharingRole(t.create?t.role:5)},c={modifyPermissions:!t.create,link:{linkType:t.type,linkName:i}};a&&(c.link.expirationDateTime=a);void 0!==s&&(c.link.password=s);return this._setPermissions(u,l,c).then(function(e){return r._sharingDataHelper.getSharingLinks(e,{})},function(e){return e.people?r._sharingDataHelper.getSharingLinks([e],{}):f.default.wrapError(e)})};m.prototype.share=function(e,t){return this._setPermissions(e,t,{modifyPermissions:!1}).then(function(e){return{statusCode:0,errorMessage:"",people:e[0].people,itemId:e[0].item.id}},function(e){return e.people?e:f.default.wrapError(e)})};m.prototype.unshare=function(e){return this.updatePermissions(null,e,5)};m.prototype.updatePermissions=function(t,e,r,i){var o={items:[e],roleValue:this._sharingDataHelper.convertToSharingRole(r),sendEmail:!1,expiration:i};return this._setPermissions(t,o,{modifyPermissions:!0}).then(function(e){return{statusCode:0,errorMessage:"",people:5===r?t.map(function(e){e.sharingInfo.role=5;return e}):e[0].people}},function(e){return e.people?e:f.default.wrapError(e)})};m.prototype._setPermissions=function(e,t,r){var i=this,o={message:t.message,requireSignIn:t.requireSignIn,suppressNotification:!t.sendEmail,userAction:r.modifyPermissions?1:0,entities:[]},n=t.items;n&&n.length||(n=[]);if(1<n.length){var a=n.map(function(e){return i._urlDataSource.getKeyParams(e.key).id});o.ids=a;o.bundleName=this._getBundleName(n)}else{var s=n[0],u=this._urlDataSource.getKeyParams(s.key);o.id=u.id}for(var l=0;l<e.length;l++){var c=e[l],d={role:t.roleValue,type:0,email:c.email};t.expiration&&(d.expirationDateTime=t.expiration);t.password&&(d.password=t.password);if(r.link){d.type=c.sharingInfo&&c.sharingInfo.type||3;d.linkType=r.link.linkType;d.linkName=r.link.linkName;d.expirationDateTime=r.link.expirationDateTime;d.password=r.link.password;c.sharingInfo&&(d.id=c.sharingInfo.userId)}else if(!c.email&&c.sharingInfo){d.id=c.userId;d.type=c.sharingInfo.type}else c.sharingInfo&&c.sharingInfo.type&&(d.type=c.sharingInfo.type);if(3===c.entityType){d.clientId=c.userId;if(r.link){d.type=3;d.linkType=4}else{d.type=7;d.expiry=1}delete d.email}o.entities.push(d)}var p=JSON.stringify(o);return(new v.default).send({apiName:"SetPermissions",url:m._ShareUrl,requestType:"POST",postData:p,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1007:return!0;case 3006:case 3007:case 3009:case 3012:case 3033:case 3034:case 3035:case 3036:case 3037:return!0;default:return!1}}}).then(function(e){if(e.permissions&&e.permissions.permissionScopes)return e.permissions.permissionScopes.map(function(e){return i._sharingDataHelper.getSharingScope(n,e)});if(e.primaryError&&e.primaryError.code){var t=e.errorResult.entity;return f.default.wrapError({statusCode:e.primaryError.code,errorMessage:e.primaryError.message,people:[i._sharingDataHelper.transformEntity(t,{statusCode:0,role:i._sharingDataHelper.parseEntityRole(t),type:void 0,userId:t.id||t.clientId})]})}return f.default.wrapError(e)},function(e){return e.data?f.default.wrapError(e.data):f.default.wrapError(e)})};m.prototype._getBundleName=function(e){var t="";if(e&&e.length){for(var r,i=e[0].parent,o=h.strings.BundleNameShared,n=new Date,a=n.getMonth()+1,s=y.format(h.strings.BundleNameDate,a,n.getDate(),n.getFullYear()),u=!0,l=!0,c=0,d=e;c<d.length;c++){var p=d[c];if(p.photo&&!p.video)l=!1;else{if(!g.isOfficeDoc(p.extension)){l=u=!1;break}u=!1}}r=u?"Photos":l?"Documents":"Items";i&&!i.isRootFolder&&!i.isSpecialFolder&&i.name&&(o=y.format(h.strings.BundleNameFolderName,i.name,"{0}","{1}"));t=y.format(o,h.strings["BundleNameType"+r],s)}return t};m._ShareUrl=o.default.baseUrl+"/API/2/SetPermissions";return m}(i.default);t.default=s});define("odsp-next/models/item/ItemHelper",["require","exports","../../models/item/ItemType","./Item.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/interfaces/list/DocumentType"],function(e,t,s,r,u,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r.strings,o=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],n="Doc",a="One",c="Ppt",d="Xls",p="Vsd",m="Lib",f={WinDocuments:m,WinLibrary:m,WinMusic:m,WinPictures:m,WinPodcastLibrary:m,WinVideos:m,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:n,Docm:n,Docx:n,Dot:n,Dotm:n,Dotx:n,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:c,Ods:d,Odt:n,One:a,Onepkg:a,Onetoc2:a,Notebook:"OneNotebook",Pot:c,Potm:c,Potx:c,Ppa:c,Ppam:c,Pps:c,Ppsm:c,Ppsx:c,Ppt:c,Pptm:c,Pptx:c,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:p,Vsd:p,Vsdm:p,Vsdx:p,Vsl:p,Vss:p,Vssm:p,Vssx:p,Vst:p,Vstm:p,Vstx:p,Xaml:"Xaml",Xla:d,Xlam:d,Xll:d,Xls:d,Xlsb:d,Xlsm:d,Xlsx:d,Xlt:d,Xltm:d,Xltx:d,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};t.getFriendlyItemType=function(e,t,r){var i=e.extension,o=i&&i.slice("."===i[0]?1:0),n=o&&o.toUpperCase(),a=h(e.itemFromServer&&e.itemFromServer.iconType||o);return a||e.type!==s.default.Folder?r||(e.panorama?l.fileTypePanorama:e.photo&&!e.video?u.format(l.fileTypeImage,n||"").trim():a?l["fileType"+a]:n?u.format(l.fileTypeUnknown,n):t?l.listItemType:l.fileTypeNoExtension):l.fileTypeFolder};t.getShortcutFileType=function(e){var t=e.slice(e.lastIndexOf(".")+1);return u.format(l.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):l.fileTypeNoExtension)};t.getShortcutFileTypeFromExtension=function(e){var t=l.fileTypeNoExtension;if(!e)return t;var r=h(u.capitalize(e));if(r)return l["fileType"+r];var i=e.toUpperCase();return i?u.format(l.fileTypeUnknown,i):t};function h(e){return f[e]}t.getNormalizedExtension=h;t.isOfficeDoc=function(e){return e&&-1!==o.indexOf(e)};t.getItemRoot=function(e){for(var t=e;t&&!t.isRootFolder;)t=t.parent;return t};t.isAutoAlbum=function(e){return this.hasAutoAlbumTag(e)&&!!e.properties.newTag};t.hasAutoAlbumTag=function(e){return!!e.properties&&!!e.properties.autoAlbumTag};t.GetDocumentTypeFromExtension=function(e){if(!e)return i.DocumentType.Word;var t=h(u.capitalize(e.split(".").pop()));return t===a?i.DocumentType.OneNote:t===c?i.DocumentType.PowerPoint:t===d?i.DocumentType.Excel:t===p?i.DocumentType.Visio:i.DocumentType.Word}});define("odsp-next/dataSources/sharing/odc/SharingDataHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","../../base/odc/ItemResultProcessor","../../item/ItemTaskObserver"],function(e,t,c,r,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={0:1,1:2},s={"-1":0,0:5,1:1,2:2,3:3,4:4,5:0},u=function(t){c.__extends(e,t);function e(){var e=t.call(this)||this;e._urlDataSource=e.resources.consume(i.urlDataSource);e._itemResultProcessor=new(e.managed(o.default))({getRootItemTitle:function(){return""},getItemKeyExtension:function(e,t){return{}}});return e}e.prototype.getSharingLinks=function(e,t){for(var r=[],i=0,o=e;i<o.length;i++){var n=o[i];if(!t.filterScope||t.filterScope(n))for(var a=0,s=n.people;a<s.length;a++){var u=s[a].sharingInfo;if(3===u.type){var l=c.__assign({},u.link,{item:n.item});r.push(l)}}}return r};e.prototype.getSharingScope=function(e,t){var r=this,i=this._getShareItem(e,t),o=t.entities.map(function(e){var t=r.transformEntity(e,{statusCode:e.status,errorMessage:e.errorMessage,role:r.parseEntityRole(e),isChangeable:e.isChangeable,type:e.type,userId:e.id||e.clientId,link:r._getLinkFromEntity(i,e),email:e.email,name:e.name,expiration:e.expirationDateTime,hasPassword:e.hasPassword});1===t.sharingInfo.type&&(t.image=n.default.getProfileImage(t.userId||t.sharingInfo.userId));return t});return{id:t.id,refId:t.refId,canChange:t.canChange,item:i,people:o,hasPendingAccessRequests:!1}};e.prototype.parseEntityRole=function(e){var t=e.role,r=2===e.type;return this._parseRole(t,r)};e.prototype.convertToSharingRole=function(e){return s[e]};e.prototype.transformEntity=function(e,t){return{name:e.name,email:e.email,userId:e.id,sharingInfo:t}};e.prototype._getShareItem=function(e,t){var r,i,o=1<e.length,n=this._urlDataSource.getOwnerId(),a=!o&&this._findItem(e[0],t.id);if(!a){var s=new(this.resources.consume(l.resourceKey)),u=this._urlDataSource.getKey(((r={}).id=t.id,r.cid=n,r));this._itemResultProcessor.processItemResult({requestKey:this._urlDataSource.getKey((i={},i.id=t.id,i.cid=n,i)),isPlaceholder:!0,isPrimaryRequestedItem:!0,itemFromServer:{id:t.id,name:t.name,ownerCid:n,isBundle:o,commands:"sh,1"},observer:s});s.flush();a=s.getItem({key:u})}return a};e.prototype._parseRole=function(e,t){return(t?a[e]:s[e])||5};e.prototype._getLinkFromEntity=function(e,t){return t.link?{url:t.link,type:t.linkType,name:t.linkName,role:this.parseEntityRole(t),id:t.id||t.clientId,isActive:!0,item:e,entityType:t.type,expiration:t.expirationDateTime||"",supportsExpiration:!0,hasPassword:t.hasPassword}:null};e.prototype._findItem=function(e,t){for(var r=null;e;){if(e.id===t){r=e;break}e=e.parent}return r};return e}(r.default);t.default=u});define("odsp-next/dataSources/sharing/odc/SharingDataDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../SharingDataSource.resx","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../resources/ODCResourceKeys","../../../utilities/features/Features","./SharingDataHelper"],function(e,t,r,i,a,o,u,n,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){r.__extends(e,t);function e(){var e=t.call(this)||this;e._sharingDataHelper=new(e.managed(c.default));e._urlDataSource=e.resources.consume(s.urlDataSource);return e}e.prototype.getSettings=function(e){var r=this,i=e.item;return e.getPermissions().then(function(e){var t={itemId:i.id,itemName:i.name,pickerProperties:{AllowEmailAddresses:!0},canManagePermissions:!0,canManageLinks:!0,canSendLink:!0,canSendEmail:!0,anonymousLinksEnabled:!0,organizationLinksEnabled:!1,networkLinksEnabled:!0,showAdvanced:!1,advancedUrl:"",itemUrl:"",supportsSharingPropagation:!1,showAdditionalExternalWarning:!1,sharedWithMany:!1,sharingRoles:r._getSharingRolesForItem(i),requiredAnonymousLinkExpirationInDays:0,mailSettings:{defaultCharacterLimit:4e3},contactInviteLimit:20};t.sharedWith=e.length?e[0].people:null;return a.default.wrap(t)})};e.prototype.getPermissions=function(e){var a=this,s=e.item,t=this._urlDataSource.getPermissionsUrl(s);return(new n.default).send({apiName:"GetPermissions",url:t}).then(function(e){var t=[];if(0!==s.sharingRole){var r={item:s,canChange:!1,people:[{userId:e.ownerCid,name:e.ownerName,email:"",image:u.default.getProfileImage(e.ownerCid),sharingInfo:{type:1,item:s,role:0,isChangeable:!1}}],hasPendingAccessRequests:!1,canUnshare:!1};t.push(r)}for(var i=0,o=e.permissionScopes;i<o.length;i++){var n=o[i];t.push(a._sharingDataHelper.getSharingScope([s],n))}return t})};e.prototype.getBestSharingLink=function(e){var n=e.item;return e.getLinks().then(function(e){if(e){for(var t=null,r=0,i=e;r<i.length;r++){var o=i[r];if(n.id===o.item.id){if(6===o.type){t=o;break}5===o.type&&(t=o)}}return a.default.wrap(t)}return a.default.wrap(null)},function(e){return a.default.wrap(null)})};e.prototype.getLinks=function(e){var t=this;return e.getPermissions().then(function(e){return t._sharingDataHelper.getSharingLinks(e,{})})};e.prototype.doSharingScopesContainLinks=function(){return!0};e.prototype.getRawResponse=function(e){return a.default.wrap({})};e.prototype._getSharingRolesForItem=function(e){var t={name:o.strings.CanEdit,value:this._sharingDataHelper.convertToSharingRole(2)},r={name:o.strings.CanView,value:this._sharingDataHelper.convertToSharingRole(1)};return e.isAlbum&&!l.isFeatureEnabled(l.CollaborativeAlbumsEnabled)?[r]:[t,r]};return e}(i.default);t.default=d});define("odsp-next/dataSources/suiteNav/odc/SuiteNavDataSource",["require","exports","tslib","../../../resources/ODCResourceKeys","./ODCSuiteNav.resx","../../../models/suiteNav/SuiteNavData","../../../models/suiteNav/SuiteNavClientData","../../../models/suiteNav/SuiteNavLinkIds","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/require/RequireConfigInjector","../../url/odc/UrlDataSource","@ms/odsp-datasources/lib/Permissions","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/attribution/AttributionHelper","@ms/odsp-shared/lib/base/BaseModel","../../../actions/feedback/odc/FeedbackAction","../../../actions/odc/SignOutAction","../../../actions/NavigationAction","../../../actions/userActivity/odc/UserActivityAction","../../../actions/LanguagePickerAction","../../../actions/ToggleDebugWindowAction","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../dataSources/footer/odc/Footer.resx","../../../utilities/features/Features","../../../pages/accountChooser/odc/sections/disambiguateEmail/DisambiguateEmail.resx","../../../providers/suiteNav/O365ShellWrapper","../../../providers/engagement/Engagement"],function(e,t,o,n,s,u,l,c,d,p,m,a,f,h,g,v,r,y,b,_,S,x,P,I,w,A,T,k,C,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=FilesConfig&&FilesConfig.SuiteNavConfig,L="https://go.microsoft.com/fwlink/p/?LinkId=822563",i=function(r){o.__extends(i,r);function i(e){var t=r.call(this,e)||this;E&&(t._model={data:null,cssUrl:E.CssPath,requireConfig:t._getRequireConfig()});t._identity=t.resources.consume(h.identity).getIdentity();t._urlDataSource=t.resources.consume(n.urlDataSource);t._navigation=t.resources.consume(g.navigation);t._attributionHelper=t.resources.consume(v.resourceKey);t._engagement=t.resources.consume(D.resourceKey);return t}i.prototype.getCapabilities=function(){var e=!!(window.Flight&&window.Flight.Ramps&&window.Flight.Ramps.SuiteNavHeader),t=-1<window.location.search.indexOf("suitenav=1"),r=this._identity.type===f.IdentityType.aad;return{supportsCaching:!1,supportsRealSuiteNav:!("syncpremiumupsell"===this._navigation.viewParams.v)&&E&&E.JsPaths&&(e||t||r),showO365Text:!1}};i.prototype.getUserTileUrl=function(){return E&&E.UserTileUrl};i.prototype.getUserName=function(){return E&&E.UserDisplayName};i.prototype.getUserEmail=function(){return this._identity.email};i.prototype.loadData=function(e){var a=this;if(!e&&this._dataPromise)return this._dataPromise;this._dataPromise=new d.default(function(i,e){if(E){var o=function(e,t){a._model.data=new u.default(e,t);i(a._model)};if(a._identity.type===f.IdentityType.aad)I.default.start({url:a._urlDataSource.getSuiteNavConfigUrl()}).then(function(e){try{var t=JSON.parse(e.responseText);t.navBarData.HelpLink.Url=L;t.navBarData.CurrentWorkloadSettingsSubLinks=[{Id:c.default.CUSTOM_SETTINGS_1,Text:s.strings.Options,Url:a._urlDataSource.getOptionsUrl(),TargetWindow:"_top"}];a._model={data:t.navBarData,requireConfig:{paths:{shellcore:t.jsUrl.replace(/\.js$/,"")},shim:{shellcore:{exports:"O365"}}},cssUrl:t.cssUrl};a._model.data.ActionsMap={};a._model.data.ActionsMap[c.default.SIGN_OUT]=function(){new(a.managed(b.default))({url:E.Urls.SignOut}).execute(null);return!1};i(a._model)}catch(e){w.default.log(e);var r=a._getSuiteNavFallbackData();o(r.data,r.clientData)}},function(e){w.default.log(e);var t=a._getSuiteNavFallbackData();o(t.data,t.clientData)});else if(a.getCapabilities().supportsRealSuiteNav){m.default.addConfig(a._getRequireConfig());var r=!$Config.isINT&&T.isFeatureEnabled(T.EnableSkypeOnSuiteNavHeader),n=a._identity.type===f.IdentityType.anonymous;window.require(["shellconsumerdata"],function(){var e=ConsumerShellDataGenerator.GetConsumerData({UPN:n?"":a._identity.email,UserHexCID:$Config.hcid,UID:$Config.upsellUserId,Culture:$Config.mkt,WorkloadId:"ShellDocuments",Resources:{shelldefaultthemecss:E.JsPaths.shelldefaultthemecss,shellg2coreminthemecss:E.JsPaths.shellg2coreminthemecss,shellg2corecss:E.JsPaths.shellg2corecss,shellcoreprimeg2m:E.JsPaths.shellcoreprimeg2m+".js",shellg2pluscss:E.JsPaths.shellg2pluscss,shellplusg2m:E.JsPaths.shellplusg2m+".js",shellarialogger:E.JsPaths.shellarialogger+".js"}});e.UserDisplayName=E.UserDisplayName;var t=new l.default(e.ClientData);t.HasEXOLicense=T.isFeatureEnabled(T.EnableExchangeOnSuiteNavHeader);t.NewFlexPane=T.isFeatureEnabled(T.EnableNewFlexPaneOnSuiteNavHeader);t.MeFlexPaneEnabled=T.isFeatureEnabled(T.EnableMeFlexPaneOnSuiteNavHeader);t.LyncIntegrationDisabled=!r;t.IsRTL=p.default.isRightToLeft;e.CurrentWorkloadSettingsSubLinks=a._getSettingsLinks(a._urlDataSource,!1);e.CurrentWorkloadHelpSubLinks=[{Id:c.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:s.strings.Help,Url:L}];e.CurrentWorkloadHelpSubLinks=a._getHelpLinks();e.SignOutLink={Id:c.default.SIGN_OUT,Text:s.strings.SignOut,Url:"#"};e.ActionsMap={};e.ActionsMap[c.default.DIAGNOSTICS]=function(e){var t=new(e.injected(P.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[c.default.FEEDBACK]=function(e){(new C.default).FlexPane.CloseFlexPaneForProvider("NFD");a._engagement.logData({name:"SuiteNav.EmailOneDriveSupport.Click"});var t=new(e.injected(y.default))({});t.execute(null).done(function(){t.dispose()});return!1};e.ActionsMap[c.default.USER_ACTIVITY]=function(e){var t=new(e.injected(S.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[c.default.SIGN_OUT]=function(e){var t=new(e.injected(b.default))({url:E.Urls.SignOut});t.execute(null);t.dispose();return!1};e.ActionsMap[c.default.ONEDRIVE]=function(e){var t=new(e.injected(_.default))({url:a._urlDataSource.getFilesQueryUrl(),forceNavigation:!0});t.execute(null);t.dispose();return!1};e.ActionsMap[c.default.LANGUAGE]=function(e){var t=new(e.injected(x.default))({});t.execute(null).done(function(){t.dispose()});return!1};$Config.isINT&&a._updateINTLinks(e);if(n){e.CurrentWorkloadUserSubLinks=[];e.SignOutLink.Text=k.strings.title}o(e,t)})}else{var t=a._getSuiteNavFallbackData();o(t.data,t.clientData)}}else i(null)});return this._dataPromise};i.prototype._getSuiteNavFallbackData=function(){var e=this,t=this._identity.type===f.IdentityType.aad,r=E.Urls,i=s.strings,o=new l.default;o.IsFallbackShell=!0;o.IsRTL=p.default.isRightToLeft;var n={WorkloadLinks:[{Id:c.default.ONEDRIVE,Text:i.OneDrive,Url:"https://onedrive.live.com"}],CurrentWorkloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!t),CurrentWorkloadHelpSubLinks:this._getHelpLinks(),CurrentWorkloadUserSubLinks:t?[]:[{Id:c.default.ABOUT_ME,Text:i.EditProfile,Url:r.Profile},{Id:c.default.SETTINGS,Text:i.AccountSettings,Url:r.Account}],IsAuthenticated:E.IsAuthenticated,SignOutLink:{Id:c.default.SIGN_OUT,Text:i.SignOut,Url:r.SignOut},UserDisplayName:E.UserDisplayName,ActionsMap:{}};n.ActionsMap[c.default.SIGN_OUT]=function(){new(e.managed(b.default))({url:E.Urls.SignOut}).execute(null);return!1};return{data:n,clientData:o}};i.prototype._updateINTLinks=function(e){for(var t=0,r=e.CurrentWorkloadUserSubLinks;t<r.length;t++){(n=r[t]).Id===c.default.ABOUT_ME?n.Url="https://profile.live-int.com":n.Id===c.default.SETTINGS&&(n.Url="https://account.microsoft-int.com/")}for(var i=0,o=e.WorkloadLinks;i<o.length;i++){var n;switch((n=o[i]).Id){case c.default.MAIL:n.Url="https://mail.live-int.com";break;case c.default.CALENDAR:case c.default.PEOPLE:case c.default.ONEDRIVE:case c.default.TASKS:case c.default.WORD:case c.default.EXCEL:case c.default.POWERPOINT:n.Url=n.Url.replace("live.com","live-int.com")}}};i.prototype._getHelpLinks=function(){var e="_blank",t=[{Id:c.default.HELP,TargetWindow:e,Text:s.strings.Help,Url:L},{Id:c.default.FEEDBACK,Text:s.strings.Support,Url:E.Urls.Feedback},{Id:c.default.LEGAL,TargetWindow:e,Text:A.strings.Terms,Url:a.default.getTermsUrl()},{Id:c.default.PRIVACY,TargetWindow:e,Text:A.strings.Privacy,Url:a.default.getPrivacyUrl()},{Id:c.default.DEVELOPERS,TargetWindow:e,Text:A.strings.Developers,Url:"https://g.live.com/8seskydrive/dev"},{Id:c.default.ABUSE,TargetWindow:e,Text:A.strings.ReportAbuse,Url:"https://go.microsoft.com/fwlink/?LinkID=85433"}],r=a.default.getImpressumUrl();r&&t.push({Id:c.default.IMPRESSUM,TargetWindow:e,Text:i.impressumText,Url:r});p.default.language&&"en"===p.default.language.toLowerCase()&&t.splice(2,0,{Id:c.default.USERVOICE,TargetWindow:e,Text:s.strings.SuggestFeature,Url:"https://onedrive.uservoice.com"});return t};i.prototype._getSettingsLinks=function(e,t){var r=E.Urls,i=s.strings,o=[];o.push({Id:c.default.CUSTOM_SETTINGS_1,Text:i.Options,Url:e.getOptionsUrl(),TargetWindow:"_top"});var n=this._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"UpgradePage"});o.push({Id:c.default.CUSTOM_SETTINGS_2,Text:i.Upgrade,Url:e.getUpgradeOptionsUrl(n,!0),TargetWindow:"_top"});t&&o.push({Id:c.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:i.Help,Url:L});FilesConfig&&FilesConfig.df&&o.push({Id:c.default.DIAGNOSTICS,Text:i.Diagnostics,Url:r.Diagnostics});FilesConfig&&FilesConfig.df&&T.isFeatureEnabled(T.UserActivity)&&o.push({Id:c.default.USER_ACTIVITY,Text:"Activity",Url:r.Diagnostics});o.push({Id:c.default.LANGUAGE,Text:A.strings["langname_"+p.default.language],Url:"#"});return o};i.prototype._getRequireConfig=function(){if(E&&E.JsPaths){var e=E.JsPaths;e.shellcore=e.shellcoreming2m;delete e.shellcoreg2m;return{paths:e,shim:{msajax:{exports:"Type"},shellg2strings:{deps:["msajax"],exports:"_s1"},shellcore:{deps:["msajax","shellg2strings"],exports:"O365"},shellconsumerdata:{deps:["msajax","shellg2strings","shellcore"],exports:"ConsumerShellDataGenerator"}}}}return null};i.impressumText="Impressum";return i}(r.default);t.default=i});define("odsp-next/models/suiteNav/SuiteNavData",["require","exports","./SuiteNavLinkIds"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){for(var r in e)this[r]=e[r];this.ClientData=t.toString();void 0===this.CurrentMainLinkElementID&&(this.CurrentMainLinkElementID=i.default.ONEDRIVE)};t.default=r});define("odsp-next/models/suiteNav/SuiteNavLinkIds",["require","exports","@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=r.SUITE_NAV_LINK_IDS});define("@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile"};t.ISuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});define("odsp-next/models/suiteNav/SuiteNavClientData",["require","exports","knockout"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.IsRTL=!1;this.IsFallbackShell=!1;this.LyncIntegrationDisabled=!1;this.NewFlexPane=!1;this.MeFlexPaneEnabled=!1;this.LogUrl="";this.LogLevelSwitches=[!1,!1,!1,!1];e&&r.utils.extend(this,JSON.parse(e))}e.prototype.toString=function(){return JSON.stringify(this)};return e}();t.default=i});define("odsp-next/actions/feedback/odc/FeedbackAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(i,e,t,r,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Feedback";t._executorLoader=new(t.managed(n.default))({path:"odsp-next/actions/feedback/odc/FeedbackExecutor",getModule:function(){return new o.default(function(e,t){i(["odsp-next/actions/feedback/odc/FeedbackExecutor"],e,t)})},getExecutorParams:function(){return{}}});return t}e.prototype.onIsAvailable=function(){return!0};e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return e}(r.default);e.default=a});define("odsp-next/actions/base/ExecutorLoader",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ProviderResourceKeys"],function(e,t,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._getModule=e.getModule;t._path=e.path;t._getExecutorParams=e.getExecutorParams;t._bundleLoader=t.resources.consume(o.bundleLoader);t._bundleLoader.queueLoad(t._path,t._getModule).done();return t}e.prototype.execute=function(i,o){var n=this;return this._path?this._loadExecutorType().then(function(r){return"function"!=typeof r?a.default.wrapError(new Error("Cannot create action from "+r+": "+n._path)):a.default.as(n._getExecutorParams()).then(function(e){var t=new(n.resources.injected(r))(e);return a.default.as(t.execute(i,o))})}):a.default.wrapError(new Error("Cannot create action from nothing: "+this._path))};e.prototype._loadExecutorType=function(){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return e}(r.default);t.default=n});define("odsp-next/actions/odc/SignOutAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/identity/odc/IdentityDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SignOut";t.url=e.url;t.target=e.target||"_top";t._navigation=t.resources.consume(s.navigation);t._sessionProvider=t.resources.consume(a.resourceKey);return t}e.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target});return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};return e}(r.default);t.default=u});define("odsp-next/dataSources/identity/odc/IdentityDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/features/Features","cookies"],function(e,t,r,s,o,n,u,l,c,i,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.enableCooldownAfterAuthFlowResourceKey=new i.ResourceKey({name:e("module").id+".enableCooldownAfterAuthFlow",factory:new i.ConstantResourceFactory(d.isFeatureEnabled(d.EnableCooldownAfterAuthFlow))});t.enableTokenCacheResourceKey=new i.ResourceKey({name:e("module").id+".enableTokenCache",factory:new i.ConstantResourceFactory(d.isFeatureEnabled(d.UseTokenCacheForOAuth))});var a=function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var r=this._state[e];if(r&&r.expiration>t)return r};e.prototype.setValue=function(e,t){this._state[e]=t};return e}(),m=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._navigation=t.navigation;r._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow;t.enableTokenCache&&(r._tokenCache=new a);r._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0};r._authFrameAttempts={"msa_auth:":0,"graph_auth:":0};r._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0};if(r.getIdentity().type===s.IdentityType.msa){r._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname;r.events.on(window,"message",r._onMessageReceived)}return r}e.prototype.getIdentity=function(){var e=s.IdentityType.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?s.IdentityType.aad:s.IdentityType.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};e.prototype.getSignInUrl=function(){return FilesConfig.si};e.prototype.signOut=function(){var e=this.getIdentity();this._expireAuthCookie("msa_auth:",e);this._expireAuthCookie("graph_auth:",e)};e.prototype.getSessionToken=function(){return this._getToken("msa_auth:")};e.prototype.getGraphToken=function(){return this._getToken("graph_auth:")};e.prototype._getToken=function(e){if(this.getIdentity().type===s.IdentityType.aad)return u.default.reject("Unable to get a token for a business account");var t="graph_auth:"===e?"Graph":"MSA",r=new c.Qos({name:"IdentityDataSource.get"+t+"Token"}),i=this._getTokenFromCache(e),o=i.token,n=i.shouldRefresh,a=i.hadCookie;if((n||!o)&&!this._pendingSignals[e]){this._pendingSignals[e]=new l.default;this._setupSilentAuthIframe(e)}if(o){r.end({resultType:c.ResultTypeEnum.Success,resultCode:n?"withinExpiration":"cached",error:a?void 0:"noCookie"});return u.default.resolve({accessToken:o})}return this._pendingSignals[e].getPromise().then(function(e){r.end({resultType:c.ResultTypeEnum.Success,resultCode:"fullRefresh"});return e},function(e){r.end({resultType:c.ResultTypeEnum.Failure,error:e&&e.message});return u.default.reject(e)})};e.prototype._getAuthUrl=function(e,t){if(this.getIdentity().type===s.IdentityType.msa){var r=encodeURIComponent("https://p.sfx.ms/"+(t?"saroot.html":"sa.html")),i=t?"":"&display=none",o=void 0;switch(e){case"msa_auth:":o="onedrive_implicit.access";break;case"graph_auth:":o="contacts.read"}return"https://login.live.com/oauth20_authorize.srf?client_id=00000000481710A4&scope="+o+"&res=success&resuictx=selection&response_type=token&redirect_uri="+r+i}return $Config.silentAuth};e.prototype._writeTokenToCache=function(e,t,r){this._writeAuthCookie(e,t,r);var i=Date.now()+1e3*r;this._tokenCache&&this._tokenCache.setValue(e,{value:t,expiration:i})};e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var r=Date.now(),i=this._tokenCache.getValue(e,r);if(i)return{token:i.value,shouldRefresh:r+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}};e.prototype._writeAuthCookie=function(e,t,r){var i=this.getIdentity().id,o=Date.now()+1e3*r;p.set(e+i,t,{path:"/",secure:!0,expires:new Date(o).toUTCString()})};e.prototype._getTokenFromCookie=function(e){var t=this.getIdentity().id;return p.get(e+t)};e.prototype._expireAuthCookie=function(e,t){p.expire(e+t.id,{secure:!0,domain:document.location.hostname})};e.prototype._onMessageReceived=function(e){if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){var t=this._currentIFrameQosEvent,r="",i=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source){r=e.data.token;i=parseInt(e.data.expiresIn,10)}else{if("string"!=typeof e.data)return;var o=e.data.split(" ");if(2===o.length){r=o[0];i=parseInt(o[1],10)}else if(1===o.length){var n=o[0].split("&");t.end({resultType:c.ResultTypeEnum.Failure,resultCode:"error",error:n[0]});if(0===n[0].indexOf("error=access_denied")){var a=p.get("ANON");d.isFeatureEnabled(d.EnableMsaOauthErrorRedirect)&&a&&this._navigation.navigateTo({url:this._getAuthUrl(this._silentAuthIframeTokenType,!0)})}return}}if(!!r&&0<i){this._writeTokenToCache(this._silentAuthIframeTokenType,r,i);t.end({resultType:c.ResultTypeEnum.Success});var s=this._pendingSignals[this._silentAuthIframeTokenType];s&&s.complete({accessToken:r})}else t.end({resultType:c.ResultTypeEnum.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}};e.prototype._setupSilentAuthIframe=function(t){var r=this;if(!this._silentAuthIframe){this._authFrameAttempts[t]++;this._silentAuthIframeTokenType=t;var e=this._tokenRefreshCooldowns[t];u.default.resolve(e&&e.getPromise()).then(function(){var e=r._currentIFrameQosEvent=new c.Qos({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:t,attemptCount:r._authFrameAttempts[t]}});r._silentAuthIframe=document.createElement("iframe");r._silentAuthIframe.style.display="none";r._silentAuthIframe.src=r._getAuthUrl(t);document.body.appendChild(r._silentAuthIframe);r._silentAuthIframeTimeoutId=r.async.setTimeout(function(){r._silentAuthIframeTimeoutId=void 0;e.end({resultType:c.ResultTypeEnum.Failure,resultCode:"timeout"});if(r._authFrameAttempts[t]<5){r._removeSilentAuthIframe(t,!1);r._setupSilentAuthIframe(t)}else r._removeSilentAuthIframe(t,!0)},3e4)})}};e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0;if(this._silentAuthIframe){document.body.removeChild(this._silentAuthIframe);this._silentAuthIframe=void 0}if(void 0!==this._silentAuthIframeTimeoutId){this.async.clearTimeout(this._silentAuthIframeTimeoutId);this._silentAuthIframeTimeoutId=void 0}if(this._enableCooldownAfterAuthFlow){var r=this._tokenRefreshCooldowns[e]=new l.default;this.async.setTimeout(function(){r.complete()},3e4)}if(t){var i=this._pendingSignals[e];i&&i.error(new Error("Timed out acquiring OAuth token."));this._pendingSignals[e]=void 0;this._authFrameAttempts[e]=0;this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["graph_auth:"]&&this._setupSilentAuthIframe("graph_auth:")}};e.dependencies=r.__assign({},o.default.dependencies,{navigation:n.navigation,enableCooldownAfterAuthFlow:t.enableCooldownAfterAuthFlowResourceKey,enableTokenCache:t.enableTokenCacheResourceKey});return e}(o.default);t.default=m;t.resourceKey=i.createResolvedResourceKey(""+e("module").id,m)});define("odsp-next/actions/userActivity/odc/UserActivityAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(i,e,t,r,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="UserActivity";t._executorLoader=new(t.managed(n.default))({path:"odsp-next/actions/userActivity/odc/UserActivityExecutor",getModule:function(){return new o.default(function(e,t){i(["odsp-next/actions/userActivity/odc/UserActivityExecutor"],e,t)})},getExecutorParams:function(){return{}}});return t}e.prototype.onIsAvailable=function(){return!0};e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return e}(r.default);e.default=a});define("odsp-next/actions/LanguagePickerAction",["require","exports","tslib","../base/BaseAction","../resources/DataSourceResourceKeys","../controls/languagePicker/LanguagePicker","../controls/languagePicker/LanguagePicker.resx","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../utilities/icons/Icon","../providers/dialog/DialogProvider"],function(e,t,i,r,o,n,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="LanguagePicker";t._languagePickerDataSource=t.resources.consume(o.language);t._navigation=t.resources.consume(l.navigation);t._dialogProvider=t.resources.consume(d.resourceKey);t._lang=t.observables.create("");t._canary=t.observables.create("");return t}e.prototype.onExecute=function(e,t){var r=this;return this._dialogProvider.requestDialog({title:a.strings.language,automationId:"languagePicker",component:{name:n.default.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:a.strings.save,execute:function(){return r.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new c.default("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:u.ResultTypeEnum.Success}})};e.prototype.onIsAvailable=function(){return!0};e.prototype.onDialogExecute=function(){var t=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(e){t._navigation.navigateTo(s.replaceQuery(window.location.href,"mkt",e));return 2})};return e}(r.default);t.default=p});define("odsp-next/controls/languagePicker/LanguagePicker",["require","exports","./LanguagePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LanguagePicker.html","./LanguagePicker.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-language-picker",template:e("./LanguagePicker.html"),viewModel:r.default});t.default=o});define("odsp-next/controls/languagePicker/LanguagePickerViewModel",["require","exports","tslib","knockout","../../resources/DataSourceResourceKeys","./LanguagePicker.resx","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,r,i,n,a,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){r.__extends(e,t);function e(e){var o=t.call(this,e)||this;o.canary=e.canary;o.selectedLanguage=e.selectedLanguage;o.loadingText=a.strings.loading;o.isLoading=i.observable(!0);o.languages=i.observableArray([]);o.currentLanguage=i.observable("");o._dataSource=o.resources.consume(n.language);o._dataSource&&o._dataSource.getLanguages().then(function(e){o.canary(e.canary);o.currentLanguage(e.currentLanguage);for(var t=e.languageList,r=0;r<t.length;r++){var i=t[r];i.displayText=(s.default.isRightToLeft?"&rlm;":"&lrm;")+i.nativeName+" - "+i.name}o.languages(t);o.isLoading(!1)});return o}return e}(o.default);t.default=u});define("odsp-next/controls/languagePicker/LanguagePicker.html",[],function(){return'<form class=LanguagePicker>\x3c!--ko if: $data.isLoading--\x3e<div data-bind="text: loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: $data.isLoading--\x3e<select name=language data-bind="value: selectedLanguage, foreach: languages, automation: \'dropDown\'"><option data-bind="attr: {selected: isoValue === $parent.currentLanguage()}, value: isoValue, html: displayText"></option></select>\x3c!--/ko--\x3e</form>'});define("odsp-next/controls/languagePicker/LanguagePicker.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LanguagePicker select{width:100%}"}])});define("odsp-next/actions/ToggleDebugWindowAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../controls/debugWindow/DebugWindowInit","../resources/ControlResourceKeys"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="ToggleDebugWindow";return e}e.prototype.onIsAvailable=function(){return!0};e.prototype.onExecute=function(e,t){if(a.default.isInitialized()){var r=this.resources.consume(s.isDebugWindowVisible);r(!r())}else a.default.init(this.resources);return n.default.wrap({resultType:o.ResultTypeEnum.Success})};return e}(i.default);t.default=u});define("odsp-next/providers/suiteNav/O365ShellWrapper",["require","exports","./FlexPaneWrapper","./NavigationWrapper","@ms/odsp-utilities/lib/async/Signal"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.FlexPane=new r.default;this.Navigation=new i.default;this._PostRenderSignal=new o.default}e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var r=this;O365Shell.Render(e,function(){return r._SignalAction(t)})};e.prototype.RenderAsync=function(e,t,r){var i=this;O365Shell.RenderAsync(e,function(){return i._SignalAction(t)},function(){return i._SignalAction(r)})};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var r=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return r.OnHasMember(e,t)})};e.prototype._SignalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new o.default;t.complete()};return e}();t.default=n});define("odsp-next/providers/suiteNav/FlexPaneWrapper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){r.default.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){r.default.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){r.default.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};return e}();t.default=i});define("odsp-next/providers/suiteNav/NavigationWrapper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.OnLinkClick=function(e){return O365Shell.Navigation.OnLinkClick(e)};e.prototype.OnHamburgerButtonClick=function(e){return O365Shell.Navigation.OnHamburgerButtonClick(e)};return e}();t.default=r});define("odsp-next/utilities/logging/odc/Beacon",["require","exports","tslib","@ms/odsp-utilities/lib/logging/BeaconBase","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/EventBase","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,i,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){r.__extends(t,e);function t(){return e.call(this,"/log",100,[1e4,1e4,1e4,3e4],!1,1e4)||this}t.prototype._createBeaconRequest=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],o=i.endTime,n=i.startTime;i.eventType===u.ClonedEventType.Single?o=i.startTime-2:i.eventType===u.ClonedEventType.Start&&(o=i.startTime-1);t.push({id:i.id,data:i.data,endTime:o,startTime:n,parent:i.parentId,name:i.eventName})}var a=l.safeSerialize({experienceId:window.Flight&&window.Flight.xid||null,cid:window.Flight&&window.Flight.cid||0,sessionId:window.Flight&&window.Flight.session,name:window.Flight&&window.Flight.name,version:window.Flight&&window.Flight.version,manifest:window.Flight&&window.Flight.manifest,startTime:s.Manager.startDate.getTime(),data:t});window.Flight&&window.Flight.Ramps&&window.Flight.Ramps.EnableODCLogging&&this.sendBeacon(a,{},1e4)};t.prototype._onNewEvent=function(e){};return t}(i.default);t.default=o});define("@ms/odsp-utilities/lib/logging/BeaconBase",["require","exports","../logging/Manager","./EventBatchCache","../xhr/XHR","./events/Beacon.event"],function(e,t,c,d,r,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function l(e,t,r,i,o,n,a,s){var u=this;this._lastSendBeacon=0;this._endPointUrl=e;this._maxCriticalFlushInterval=o;this._totalRetries=void 0===n?l.DEFAULT_TOTAL_RETRIES:n;this._totalRetriesStartValue=this._totalRetries;this._resetTotalRetriesAfter=void 0===a?l.DEFAULT_RESET_TOTAL_RETRIES_AFTER:a;this._ignorePreviousEvents=void 0!==s&&s;this._eventBatchCache=new d.default(t,r,function(e){u._onNewEvent&&u._onNewEvent(e)},function(e){u._createBeaconRequest(e)},i);this.init()}l.prototype.sendBeacon=function(e,t,r){this._sendBeacon(e,t,r,0)};l.prototype._sendBeacon=function(i,o,n,a){var s=this;0===a&&(this._lastSendBeacon=c.Manager.getTime());var e=new r.default({url:this._endPointUrl,json:i,headers:o,requestTimeoutInMS:n}),u=new p.Beacon({retryCount:a,totalRetries:this._totalRetries});e.start(function(e,t){u.end({status:t+"",success:!0});if(++s._successfulLogRequests>=s._resetTotalRetriesAfter){s._successfulLogRequests=s._resetTotalRetriesAfter;s._totalRetries=s._totalRetriesStartValue}},function(e,t,r){s._successfulLogRequests=0;u.end({status:t+"",success:!1});if(-2===t&&0<s._totalRetries){s._totalRetries--;s._sendBeacon(i,o,n,a+1)}})};l.prototype.init=function(){var t=this,e=c.Manager.addLogHandler(function(e){t.addEvent(e)});if(!this._ignorePreviousEvents)for(var r=0;r<e.length;r++)this.addEvent(e[r])};l.prototype.addEvent=function(e){if(e.enabled){this._eventBatchCache.addEvent(e);e.critical&&(!this._lastSendBeacon||c.Manager.getTime()-this._lastSendBeacon>this._maxCriticalFlushInterval)&&this._eventBatchCache.flush()}};l.DEFAULT_TOTAL_RETRIES=3;l.DEFAULT_RESET_TOTAL_RETRIES_AFTER=3;return l}();t.default=i});define("@ms/odsp-utilities/lib/logging/EventBatchCache",["require","exports","./events/Beacon.event","../logging/ErrorHelper"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r,i,o){this._events=[];this._flushCount=0;this._maxSize=e;this._newEventHandler=r;this._flushHandler=i;this._maxFlushTimes=t;this._useSlidingWindow=o}e.prototype.addEvent=function(e){this._events.push(e);if(this._newEventHandler)try{this._newEventHandler(e)}catch(e){i.default.log(e)}r.Beacon.isTypeOf(e)||(this._events.length>=this._maxSize?this.flush():this._setFlushTimeout(!1))};e.prototype.flush=function(){this._setFlushTimeout(!0)};e.prototype._handleFlush=function(){this._clearFlushTimeout();if(this._events.length){this._flushHandler(this._events);this._events=[]}};e.prototype._clearFlushTimeout=function(){if(this._flushTimeoutId){window.clearTimeout(this._flushTimeoutId);this._flushTimeoutId=null}if(this._immediateflushTimeoutId){window.clearTimeout(this._immediateflushTimeoutId);this._immediateflushTimeoutId=null}};e.prototype._setFlushTimeout=function(e){var t=this;if(!this._immediateflushTimeoutId)if(this._useSlidingWindow){this._clearFlushTimeout();e?this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0):this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime())}else e?this._immediateflushTimeoutId||(this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0)):this._flushTimeoutId||(this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime()))};e.prototype._getFlushTime=function(){if(this._flushCount<this._maxFlushTimes.length){var e=this._flushCount;this._flushCount++;return this._maxFlushTimes[e]}return this._maxFlushTimes[this._maxFlushTimes.length-1]};return e}();t.default=o});define("odsp-next/dataSources/mobileAppPath/odc/IOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./ViewQueryEnum","../BaseIOSMobilePathDataSource","../../url/ExternalAliasEnum","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.PARAM_EQUALS_FORMAT="{0}={1}";t._queryParamDictionary={id:"resId",cid:"ownerCid",authkey:"authKey",accountId:"accountId",ticket:"ticket"};t._navigation=t.resources.consume(l.navigation);t._urlDataSource=t.resources.consume(n.urlDataSource);return t}e.prototype.getPath=function(){var e=this.getQueryStringParams(),t=this.getView(),r=o.format(s.default.APP_PATH_PRE_FIX+this.FIRST_PARM_FORMAT,t||"",e||"");e&&(r+="&");return r+=s.default.APP_PATH_POST_FIX};e.prototype.getStorePath=function(){return this._urlDataSource.getExternalUrl(u.default.iosappstore)};e.prototype.getView=function(){var e,t=this._navigation.viewParams.qt;if(t&&0<t.length){t=t.toLowerCase();switch(a.default[t]){case a.default.mru:e="recent";break;case a.default.shared:case a.default.sharedby:e="shared";break;case a.default.folders:e="files";break;default:e=t}}else e="files";return e};e.prototype.getQueryStringParams=function(){var e;for(var t in this._queryParamDictionary)if(this._queryParamDictionary.hasOwnProperty(t)){var r=this._navigation.viewParams[t];if("accountId"===t&&!r){var i=window.$Config;r=i&&i.hcid}if(r){if("root"===r)continue;e?e+="&":e="";e+=o.format(this.PARAM_EQUALS_FORMAT,this._queryParamDictionary[t],r)}}return e};return e}(s.default);t.default=r});define("odsp-next/dataSources/mobileAppPath/odc/ViewQueryEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.folders=0]="folders";e[e.shared=1]="shared";e[e.mru=2]="mru";e[e.search=3]="search";e[e.photos=4]="photos";e[e.recyclebin=5]="recyclebin";e[e.allmyphotos=6]="allmyphotos";e[e.sharedby=7]="sharedby"}(r||(r={}));t.default=r});define("odsp-next/dataSources/mobileAppPath/BaseIOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.FIRST_PARM_FORMAT="{0}?{1}";return e}e.prototype.getPath=function(){return i.format(this.FIRST_PARM_FORMAT,e.APP_PATH_PRE_FIX,e.APP_PATH_POST_FIX)};e.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"};e.APP_PATH_PRE_FIX="ms-onedrive://";e.APP_PATH_POST_FIX="from=web";return e}(o.default);t.default=n});define("@ms/odsp-shared/lib/utilities/navigation/Navigation",["require","exports","tslib","../../base/BaseModel","@ms/odsp-utilities/lib/beforeUnload/BeforeUnload","@ms/odsp-utilities/lib/logging/events/Nav.event","./NavigationHelper"],function(e,t,n,r,a,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window.history,o=window.applicationCache,f=i&&!!i.pushState&&(!o||o.status===o.UNCACHED),s=function(o){n.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t._viewParamsString="";t._dontBlockNextNav=!1;var r=e.disableHashConversion,i=void 0!==r&&r;t._performHashConversion=!i;t.viewParams={};t.beforeUnload=new a.default;t.addDisposable(t.beforeUnload);t.events.declare("change");t.events.on(window,"hashchange",t._updateUrlState);t.events.on(window,"popstate",t._updateUrlState);t._updateUrlState(null);return t}e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)},null)){var r="string"==typeof e?{url:e}:e,i=r.url,o=e.hasOwnProperty("viewParams")?e.viewParams:null,n=void 0,a=void 0;if(o&&"#"===o[0]){n=o.substr(1);a=i}else{n="#"===i[0]?i.substr(1):null;a=null}if(n)r.ignoreHistory?this._replaceState(n,!1,a):this._pushState(n,a);else{var s=void 0,u=!1;if(r&&r.frameId&&"_self"!==r.frameId)try{s=window.open("",r.frameId);"_blank"===r.frameId&&(s.opener=null);s.location.href=i;u=!0}catch(e){}if(!s&&!u)try{window.location.href=i}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?m.deserializeQuery(e):e,i=n.__assign({},t.clearOtherParams?{}:this.viewParams,r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,r=!1,i=window.document.location,o=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var n="";if(-1<i.href.indexOf("#")){n=i.hash.substr(1);o=!0}else i.search.length&&(n=i.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),s=m.deserializeQuery(n),u=m.deserializeQuery(a),l=u,c=a;for(var d in s)if(u[d]!==s[d]){l=s;c=n;break}if(c!==this._viewParamsString){this._viewParamsString=c||"";this.viewParams=l;r=!0}o&&this._performHashConversion&&f&&this._replaceState(c);if(r){p.Nav.logData({url:i.href,viewParams:this.viewParams});this.events.raise("change")}this._prevHash=i.hash}else{r=!1;e&&e.preventDefault()}return r};e.prototype._tryGetViewParamsBasedOnState=function(e){var t=null;if(e&&"popstate"===e.type&&e.state){var r=e.state,i=r.useViewParamsFromState,o=r.viewParams;i&&o&&(t=this._getViewParamsString(o))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(f)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var r=this._getViewParamsString(e);if(f)try{history.pushState({},null,this._getStateUrl(r))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState(null);t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,r){var i=this._getViewParamsString(e);if(f)try{history.replaceState({},null,this._getStateUrl(i,t))}catch(e){this._hashNav(i)}else this._hashNav(i);this._updateUrlState(null);r&&this._setMaskUrl(r)};e.prototype._setMaskUrl=function(e){if(e&&f){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,null,e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:m.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(0<e.length?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e}(r.default);t.Navigation=s;t.default=s});define("@ms/odsp-utilities/lib/beforeUnload/BeforeUnload",["require","exports","../logging/ErrorHelper","../async/Async"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function o(){this._localHandlers=[]}o.init=function(){var t=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(e){return t._handleBeforeUnload(e)}}};o.registerHandler=function(e){this._handlers.push(e)};o.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};o.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};o._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var r=0;r<this._handlers.length;r++)try{if(t=this._handlers[r](!0))break}catch(e){n.default.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){n.default.log(e)}}return t||void 0};o.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};o.prototype.allowHashNav=function(e,t){var r=void 0;if(!o._isDialogOpen&&!o._allowNavs){for(var i=0;i<o._handlers.length;i++)try{if(r=o._handlers[i](!1))break}catch(e){n.default.log(e)}if(r){o._isDialogOpen=!0;this._hashNavDialogCallback(r).then(function(){o._isDialogOpen=!1;o._allowNavs=!0;o._blockNavsAgainId||(o._blockNavsAgainId=o._async.setImmediate(function(){o._allowNavs=!1;o._blockNavsAgainId=null}));e&&e()},function(){o._isDialogOpen=!1;t&&t()})}}return!r&&!o._isDialogOpen};o.prototype.registerHandler=function(e){this._localHandlers.push(e);o.registerHandler(e)};o.prototype.unRegisterHandler=function(e){for(var t=0;t<this._localHandlers.length;t++)if(this._localHandlers[t]===e){this._localHandlers.splice(t,1);break}o.unRegisterHandler(e)};o.prototype.dispose=function(){for(var e=0,t=this._localHandlers;e<t.length;e++){var r=t[e];o.unRegisterHandler(r)}};o._handlers=[];o._async=new r.default;o._initialized=!1;return o}();(t.default=i).init()});define("@ms/odsp-utilities/lib/logging/events/Nav.event",["require","exports","../SingleEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Nav=r.createSingleEvent({eventName:"Nav,",shortEventName:"Nav"},{viewParams:4,url:1});t.default=t.Nav});define("odsp-next/dataSources/download/odc/DownloadDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./DownloadDataSource",getModule:function(){return new t.default(function(e,t){r(["./DownloadDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/userInfo/odc/UserInfoDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odc-core/lib/PageConfig","../../../models/upsell/AvailableUpsells","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/upsell/AvailableUpsells","../../../models/upsell/Upsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../GuidedTourDataHelper","../../../utilities/features/Features"],function(e,t,i,r,o,n,c,a,u,l,s,d,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=window.$Config&&window.$Config.isINT,g=1;f.isFeatureEnabled(f.EnableSecurityMomentLightbox)&&(g=2);var v=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._pendingRequests={};t._urlDataSource=t.resources.consume(o.urlDataSource);t._currentParamUpsells={};t._experimentMap={};t._wasInOriginalGuidedTourExperiment=!1;t._guidedTourDataHelper=new m.default;t._navigation=t.resources.consume(p.navigation);return t}e.prototype.canPersistUserInfo=function(){return!0};e.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells};e.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e};e.prototype.getAnid=function(){return a.default.getAnid()};e.prototype.getMarket=function(){return a.default.getMarket()};e.prototype.getLanguage=function(){return a.default.getLanguage()};e.prototype.isNewUser=function(){return a.default.isNewUser()};e.prototype.isAuthenticated=function(){return a.default.isAuthenticated()};e.prototype.getUserInfo=function(e){var u=this,l=this._urlDataSource.getUserInfoApiUrl(),t=e?l+"?v="+Math.random():l,r=new c.default;if(this._pendingRequests[l])return this._pendingRequests[l];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return n.default.wrap(this._cachedUserInfo);var i=r.send({apiName:"GetUserInfo",url:t}).then(function(e){delete u._pendingRequests[l];if((u._cachedUserInfo=e)&&e.notifications)for(var t=0,r=e.notifications;t<r.length;t++){var i=r[t];7===i.type&&i.param&&(u._currentParamUpsells=JSON.parse(i.param))}if(e&&e.info)for(var o=0,n=e.info;o<n.length;o++){var a=n[o];if(32===a.type&&a.param){var s=new Date(2017,4,3);Date.parse(a.createdDate)<s.getTime()&&(u._wasInOriginalGuidedTourExperiment=!0);u._guidedTourDataHelper.setGuidedTourData(JSON.parse(a.param))}else 24===a.type?u._positioningData=a:40===a.type&&a.param&&(u._experimentMap=JSON.parse(a.param))}return e},function(e){delete u._pendingRequests[l];return n.default.wrapError(e)});return this._pendingRequests[l]=i};e.prototype.setUserInfo=function(e){var t=this._urlDataSource.setUserInfoApiUrl();return(new c.default).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})};e.prototype.setUserInfoWithUserFacts=function(e,t,r,i,o){var n={type:e,action:t};r&&(n.param=r);o&&(n.data=o);i&&(n.id=i);r&&7===e&&(this._currentParamUpsells=JSON.parse(r));return this.setUserInfo(n)};e.prototype.sendShowUpsell=function(e,t,r){return this._sendUpsell(e,t,r,"SHOWED")};e.prototype.sendCloseUpsell=function(e,t,r){return this._sendUpsell(e,t,r,"CLOSE")};e.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))};e.prototype.handleUpdateUpsellData=function(e,t,r){var i=this.getUpsellVariationIfApplicable(e),o=this._currentParamUpsells[i.id];if(o){t&&(o.d=1);r&&o.v++}else this._currentParamUpsells[i.id]={d:t?1:0,v:r?1:0}};e.prototype.updateUpsellData=function(e,t,r){this.handleUpdateUpsellData(e,t,r);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};e.prototype.hasUserFact=function(i){var o=this;return this.getUserInfo(!1).then(function(e){var t=!1;if(!o._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");for(var r=0;r<o._cachedUserInfo.rewards.length;r++)o._cachedUserInfo.rewards[r].type===i&&o._cachedUserInfo.rewards[r].isSet&&(t=!0);return t})};e.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,r=0;r<t.length;r++)if(35===t[r].type)return!0;return!1})};e.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?n.default.wrap(t):this.checkThrottle(s.default[d.default.OneRmO365Upsell]).then(function(e){return e?s.default[d.default.OneRmO365Upsell]:null})};e.prototype.getUpsellViewCount=function(e){var r=this,i=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var t=0;r._currentParamUpsells[i.id]&&(t=r._currentParamUpsells[i.id].v);return t},function(e){return null})};e.prototype.getUpsellDismissed=function(e){var r=this,i=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var t=!1;r._currentParamUpsells[i.id]&&(t=!!r._currentParamUpsells[i.id].d);return t},function(e){return null})};e.prototype.checkThrottle=function(i){var o=this._navigation.viewParams,e=this.getUpsellDismissed(i),t=this.getUpsellViewCount(i);return n.default.all({didUserDismiss:e,viewCount:t}).then(function(e){var t=e.didUserDismiss,r=e.viewCount;return null!==t&&null!==r&&i.checkThrottle({viewCount:r,didUserDismiss:t,viewParams:o,market:$Config.mkt})})};e.prototype.getUpsellIframeSrc=function(t,r){var i=this;return this.getUserInfo(!1).then(function(e){if(t.getUpsellIframeUrl)return i.getIsPremium(!1).then(function(e){return t.getUpsellIframeUrl({anid:i.getAnid(),market:$Config.mkt,override:0,isNewUser:i.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:t.id,availableUpsells:s.default,isO365:e,bytesAvailable:i._getTotalQuotaInBytes(r),bytesUsed:i._getQuotaUsedInBytes(r)})})})};e.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?s.default[e.variation]:e};e.prototype.getUpsellDismissedById=function(e,t){return n.default.wrap(void 0)};e.prototype.getUpsellViewCountById=function(e,t){return n.default.wrap(void 0)};e.prototype.markUpsellAsSeen=function(e){return n.default.wrap(void 0)};e.prototype.markUpsellAsDismissed=function(e){return n.default.wrap(void 0)};e.prototype.getFirstRunExperienceDismissed=function(){var r=this;return this.getUserInfo(!1).then(function(e){var t=!1;r._currentParamUpsells[d.default.FirstRunExperienceDialog]&&(t=!!r._currentParamUpsells[d.default.FirstRunExperienceDialog].d);return t},function(e){return!0})};e.prototype.getFirstRunExperienceViewCount=function(){var i=this;return this.getUserInfo(!1).then(function(e){var t=0,r=i._currentParamUpsells[d.default.FirstRunExperienceDialog];r&&(t=r.v);return t})};e.prototype.updateFirstRunExperienceData=function(e,t){this.handleUpdateFirstRunExperienceData(e,t);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};e.prototype.handleUpdateFirstRunExperienceData=function(e,t){var r=this._currentParamUpsells[d.default.FirstRunExperienceDialog];if(r){e&&(r.d=1);t&&r.v++}else this._currentParamUpsells[d.default.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}};e.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})};e.prototype.datePositioningViewed=function(){var t=this;return this.getUserInfo(!1).then(function(){var e=t._positioningData;if(e)return new Date(e.createdDate+"z")})};e.prototype.getPremiumUpsellsViewed=function(){return n.default.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})};e.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var t=this;return this.getUserInfo(!1).then(function(){var e=t._positioningData;if(e){if(e.param){return JSON.parse(e.param).v>=g}return!1}return!0},function(e){return!0})};e.prototype.setPositioningUserFactWithParams=function(e){var t={v:0};this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param));e&&(t.v=g);return this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")};e.prototype.getGuidedTourCompleted=function(){var t=this;return this.getUserInfo(!1).then(function(){var e=t._navigation.viewParams;return!(!t._wasInOriginalGuidedTourExperiment||e.ignoreGTUserFactCreationDate)||t._guidedTourDataHelper.getGuidedTourCompleted()},function(e){return!0})};e.prototype.getGuidedTourViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getGuidedTourViewCount()})};e.prototype.updateGuidedTourData=function(e,t){this._guidedTourDataHelper.updateGuidedTourData(e,t);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};e.prototype.completeGuidedTourAction=function(e){this._guidedTourDataHelper.completeGuidedTourAction(e);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};e.prototype.getCompletedGuidedTourActions=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getCompletedGuidedTourActions()})};e.prototype.resetGuidedTourUserFact=function(){var t=this;return this.getUserInfo(!1).then(function(e){t._guidedTourDataHelper.resetGuidedTourUserFact();return t.setUserInfoWithUserFacts(32,3,JSON.stringify(t._guidedTourDataHelper.getGuidedTourData()))})};e.prototype.getExpiringSharingLinksSeen=function(){var r=this;return this.getUserInfo(!1).then(function(e){var t=r._currentParamUpsells[d.default.ExpiringSharingLinks];return t&&!!t.d},function(e){return!0})};e.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[d.default.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[d.default.ExpiringSharingLinks]={d:1,v:1};this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};e.prototype.getOptimizelyVariation=function(e){return this._getExperimentVariation(e)};e.prototype.setOptimizelyVariation=function(e,t){return this._setExperimentVariation(e,t)};e.prototype.getEXPExperimentVariation=function(e){return this._getExperimentVariation(e)};e.prototype.setEXPExperimentVariation=function(e,t){return this._setExperimentVariation(e,t)};e.prototype._getExperimentVariation=function(e){var t=this;return this.getUserInfo(!0).then(function(){return t._experimentMap&&t._experimentMap[e]?t._experimentMap[e]:0},function(e){return n.default.wrap(0)})};e.prototype._setExperimentVariation=function(e,t){var r=this;return this.getUserInfo(!0).then(function(){r._experimentMap[e]=t;return r.setUserInfoWithUserFacts(40,3,JSON.stringify(r._experimentMap))},function(e){return n.default.wrap(!1)})};e.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=e.upsell;if(t)return s.default[t];e.resetUpsells?this.resetUpsellUserFact():e.resetGuidedTour&&this.resetGuidedTourUserFact();return null};e.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total};e.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null};e.prototype._sendUpsell=function(e,t,r,i){var o=new c.default,n=h?u.intBaseUrl:u.baseUrl,a={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:r,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:i},s=n+"api/v1/messaging/web/useraction?"+l.serializeQuery(a);return o.sendPost("OneRM",s,"").then(function(e){return!0},function(e){return!1})};return e}(r.default);t.default=v});define("odsp-next/models/upsell/AvailableUpsells",["require","exports","./UpsellTypes","./Upsells","../../utilities/features/Features"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.$Config&&window.$Config.isINT;t.intBaseUrl="https://messaging-int.msonerm.com/";t.baseUrl="https://dynmsg.modpim.com/";var a,s=((a={})[i.default.NewBrandFRE]={id:i.default.NewBrandFRE,type:r.default.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return(n?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&Source=OneDriveFRE"},shouldSendMessageOnClose:!0,renderType:0},a[i.default.OneRmO365Upsell]={id:i.default.OneRmO365Upsell,type:r.default.ONEUNIT,ramp:o.OneRmO365UpsellEnabled,checkThrottle:function(e){return o.isFeatureEnabled(o.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return(n?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&data="+encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable}))+"&Source=OneDriveWebBanner"},shouldSendMessageOnClose:!0,renderType:1},a);t.default=s});define("odsp-next/models/upsell/UpsellTypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"}(r||(r={}));t.default=r});define("odsp-next/models/upsell/Upsells",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"}(r||(r={}));t.default=r});define("odsp-next/dataSources/userInfo/GuidedTourDataHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.resetGuidedTourUserFact()}e.prototype.getGuidedTourData=function(){return this._guidedTourData};e.prototype.setGuidedTourData=function(e){this._guidedTourData=e};e.prototype.getGuidedTourCompleted=function(){var e=this._guidedTourData;return!(!e||!e.c)};e.prototype.getGuidedTourViewCount=function(){var e=this._guidedTourData.v;return void 0===e?0:e};e.prototype.updateGuidedTourData=function(e,t){var r=this._guidedTourData;e&&(r.c=!0);t&&(r.v=(r.v||0)+1)};e.prototype.completeGuidedTourAction=function(e){var t=this._guidedTourData;switch(e){case 0:t.u=!0;break;case 1:t.m=!0;break;case 2:t.s=!0;break;case 3:t.sh=!0;break;case 4:t.f=!0;break;default:return}};e.prototype.getCompletedGuidedTourActions=function(){var e=this._guidedTourData,t=[];e.u&&t.push(0);e.m&&t.push(1);e.s&&t.push(2);e.sh&&t.push(3);e.f&&t.push(4);return t};e.prototype.resetGuidedTourUserFact=function(){this._guidedTourData={c:!1,v:0,u:!1,m:!1,s:!1,sh:!1,f:!1}};return e}();t.GuidedTourDataHelper=r;t.default=r});define("odsp-next/dataSources/versionControl/VersionControlDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.checkOutItem=function(e){return r.default.wrap()};e.prototype.undoCheckOutItem=function(e){return r.default.wrap()};e.prototype.checkInItem=function(e){return r.default.wrap()};e.prototype.getVersionHistoryUrl=function(e){return""};return e}();t.default=i});define("odsp-next/dataSources/versionHistory/odc/VersionHistoryDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/path/Path","../../base/vroom/VroomDataRequestor","../../../providers/sessionManagement/SessionManagementProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/xhr/XHRPromise"],function(e,t,i,r,o,s,n,a,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._sessionManagementProvider=t.resources.consume(a.resourceKey);t._urlDataSource=t.resources.consume(u.url);return t}e.prototype.getVersionHistoryInfo=function(i){var o=this;return this._sessionManagementProvider.getToken().then(function(r){return o._getVersionHistory(s.encodePath(i.id)).then(function(e){var t=o._parseVersionHistory(e,i,r);t[0].isCurrentVersion=!0;return t})})};e.prototype.restoreVersionByLabel=function(o,n){var a=this;return this._sessionManagementProvider.getToken().then(function(e){var t="/drive/items/"+s.encodePath(o.id)+"/versions/"+s.encodePath(n)+"/action.restoreVersion",r=a._getUrl(t,e),i={Accept:"application/json","Content-Type":"application/json","Content-Length":"0"};return c.default.start({url:r,headers:i,method:"POST"}).then(function(e){return 200<=e.status&&e.status<=299})})};e.prototype.deleteVersionByLabel=function(e,t){return o.default.wrap()};e.prototype.canRestoreVersions=function(){return!0};e.prototype.canDeleteVersions=function(){return!1};e.prototype.showVersionLabel=function(){return!1};e.prototype._parseVersionHistory=function(e,o,n){var a=this;return e.value.map(function(e,t){var r="/drive/items/"+s.encodePath(o.id)+"/versions/"+s.encodePath(e.id)+"/content",i=a._getUrl(r,n);return{created:e.lastModifiedDateTime,id:null,isCurrentVersion:0===t,size:e.size,url:i,versionLabel:e.id,appMap:o.appMap,createdBy:{Id:e.lastModifiedBy.user.id,Title:e.lastModifiedBy.user.displayName}}})};e.prototype._getVersionHistory=function(e){return this._getRequestor().send({apiName:"versions",path:"/drive/items/"+e+"/versions"})};e.prototype._getRequestor=function(){var e=this.resources.consume(n.resourceKey);this._getRequestor=function(){return e};return e};e.prototype._getUrl=function(e,t){var r,i=this._urlDataSource.getApiBaseUrl();t&&t.tokenUrl&&0===e.indexOf("/drive/")?r=new l.default(t.tokenUrl+"/"+e.substring(7)):(r=new l.default(e)).getScheme()||(r=new l.default(i+e));t&&t.accessToken&&r.setQueryParameter("access_token",t.accessToken);return r.toString()};return e}(r.default);t.default=d});define("@ms/odsp-utilities/lib/path/Path",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.splitFileName=function(e){var t=r(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t}};function r(e,t){void 0===t&&(t=!1);var r="";if(e){var i=e.lastIndexOf(".");0<=i&&(r=t?e.substr(i+1):e.substr(i))}return r}t.getFileExtension=r;t.encodePath=function(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}});define("odsp-next/dataSources/base/vroom/VroomDataRequestor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","../../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-graph/lib/Base"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,n.DataRequestor,{sessionManagementProvider:o.resourceKey,urlDataSource:i.url})});define("odsp-next/providers/sessionManagement/SessionManagementProvider",["require","exports","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(t){var e=this._identityDataSource.getIdentity().type;if(e===r.IdentityType.aad){if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(e){if(e)return t&&"v2.1"===t?{accessToken:e.authTokenV21,proofToken:e.proofTokenV21,tokenUrl:e.tokenUrlV21}:{accessToken:e.authToken,proofToken:e.proofToken,tokenUrl:e.tokenUrl}},function(e){return i.default.resolve()})}else if(e===r.IdentityType.msa)return this._identityDataSource.getSessionToken();return i.default.reject(new Error("Cannot request a token for an unauthenticated user."))};e.dependencies={identityDataSource:o.identity,microServiceDataSource:o.microService.optional};return e}();t.default=a;t.resourceKey=n.createResolvedResourceKey(e("module").id,a)});define("@ms/odsp-graph/lib/Base",["require","exports","tslib","./base/dataRequestor/DataRequestor","./base/urlHelper/UrlHelper"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);r.__exportStar(o,t)});define("@ms/odsp-graph/lib/base/dataRequestor/DataRequestor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/uri/Uri","../../models/error/Error"],function(e,t,I,w,A,T,k,C,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=t.sessionManagementProvider,i=t.urlDataSource;this._sessionManagementProvider=r;this._apiName=i&&"function"==typeof i.getApiName?i.getApiName():"Vroom";this._apiBaseUrl=i?"function"==typeof i.getApiBaseUrl?i.getApiBaseUrl():i.getVroomApiBaseUrl():void 0}e.prototype.send=function(n){var a=this,e=n.headers,s=void 0===e?{}:e,u=n.path,l=n.apiName,t=n.requestType,c=void 0===t?"GET":t,r=n.disableLogging,d=void 0!==r&&r,p=n.timeout,m=n.onProgress,f=n.onUploadProgress,S=n.qosExtraData,i=n.apiVersion,o=void 0===i?"v2.0":i,h=n.needsAuthorization,g=void 0===h||h,v=n.useAuthorizationHeaders,x=void 0!==v&&v,y=n.accessToken,P=n.postProcessQos,b=this._sessionManagementProvider,_=g&&(y||b&&b.getToken(o).catch(function(e){return w.default.reject(new D.GraphError(e,{status:0,response:{error:{code:"authFailure"}}}))}))||void 0;return w.default.resolve(_).then(function(y){var b,e=a._apiBaseUrl,t=I.__assign({Accept:"application/json"},n.postData?{"Content-Type":"application/json"}:{},s);if(y&&y.tokenUrl&&0===u.indexOf("/drive/"))b=new C.default(y.tokenUrl+"/"+u.substring(7));else{b=new C.default(u);e&&!b.getScheme()&&(b=new C.default(e+u))}var _,r=b.toString();if(y){var i=y.accessToken,o=y.proofToken;if(x){i&&(t=I.__assign({},t,{Authorization:"bearer "+i}));o&&(t=I.__assign({},t,{"X-PROOF_TOKEN":o}))}else{i&&b.setQueryParameter("access_token",i);o&&b.setQueryParameter("prooftoken",o)}}d||(_=new T.Api({url:r,name:a._apiName+"DataRequest."+l,extraData:S}));return A.default.start({url:b.toString(),headers:t,method:c,json:n.postData||"",requestTimeoutInMS:p,withCredentials:!1,onProgress:m,onUploadProgress:f}).then(function(e){_&&_.end({resultType:k.ResultTypeEnum.Success});return n.parseResponse?n.parseResponse(e):0===e.responseText.length?null:JSON.parse(e.responseText)},function(e){var t,r,i;if(e instanceof Error){var o=w.default.isCanceled(e)?k.ResultTypeEnum.ExpectedFailure:k.ResultTypeEnum.Failure;r={error:e.message,resultType:o};i=e}else{if(e.responseText)try{t=JSON.parse(e.responseText)}catch(i){}var n=e.status,a=e.statusText,s=(t||{}).error,u=void 0===s?{}:s,l=u.message,c=void 0===l?"":l,d=u.innererror,p=void 0===d?{}:d,m=p.stackTrace,f=void 0===m?"":m,h=p.debugMessage,g=void 0===h?"":h;i=new D.GraphError(new Error(c),{response:t,status:n,request:e});var v=D.getResultCodeFromError(i);r={resultType:k.ResultTypeEnum.Failure,error:c,resultCode:v,extraData:I.__assign({},S||{},D.getQosExtraDataFromError(i),{stack:f,httpStatus:n,httpStatusText:a,requestId:e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),debugMessage:g,accessTokenLength:y&&y.accessToken?y.accessToken.length:-1,urlLength:b.toString().length})}}P&&(r=P(r,i));_&&_.end(r);return w.default.reject(i)})})};return e}();t.DataRequestor=r;t.default=r});define("@ms/odsp-graph/lib/models/error/Error",["require","exports","tslib","@ms/utilities-error/lib/index"],function(e,t,f,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(m){f.__extends(e,m);function e(e,t){var r=this,i=f.__assign({innerError:e},t);r=m.call(this,i)||this;var o=t.response,n=(void 0===o?{}:o).error,a=(void 0===n?{}:n).innererror,s=(void 0===a?{}:a).stackTrace,u=void 0===s?"":s,l=t.response,c=t.request,d=t.status,p=e.message;r.name="GraphError";r.message=p;r.response=l;r.status=d;r.serverStack=u;r.request=c;r.error=e;return r}return e}(r.CustomError);t.GraphError=i;t.getQosExtraDataFromError=function(e){var t={};t.errorMessage=e.message;if(s(e)){t.vroomStatus=e.status;var r=e.response;if(r&&r.error){var i=r.error;t.vroomErrorCode=i.code;t.vroomErrorMessage=i.message;var o=i.innererror;if(o){t.vroomErrorInnerCode=o.code;t.vroomErrorInnerMessage=o.message;t.vroomErrorInnerDebugMessage=o.debugMessage;t.vroomErrorInnerStack=o.stackTrace}}}return t};function s(e){return e instanceof i}t.isGraphError=s;function o(e,t){if(s(e)){var r=e.response,i=e.status;if(r){for(var o=[],n=r.error;n;){o.push(n);n=n.innererror}for(;n=o.pop();){var a=t(n.code,e);if(void 0!==a)return a}}return t(i,e)}}t.getErrorResolution=o;t.getResultCodeFromError=function(e){return o(e,function(e){return""+e})||"unhandled"}});define("@ms/utilities-error/lib/index",["require","exports","tslib","./CustomError"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("@ms/utilities-error/lib/CustomError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e={});var t=new Error(e.message),r=Object.getPrototypeOf(this);this.message=e.message||t.message;Error.captureStackTrace&&Error.captureStackTrace(t,r);if(Object.setPrototypeOf){Object.setPrototypeOf(t,r);return t}};t.CustomError=r;if(Object.setPrototypeOf){r.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(r,Error)}});define("@ms/odsp-graph/lib/base/urlHelper/UrlHelper",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._getEndpoint()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getEndpoint=function(){var e,t=this._url.indexOf("/drives");-1<t&&0===(e=this._url.substring(0,t)).indexOf("https:")&&(e=e.replace(":443/","/"));this._getEndpoint=function(){return e};return e};e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(-1<t){var r=this._getPathSegments();e=r[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(-1<t){var r=this._getPathSegments(),i=(e=r[t+1])?e.indexOf("?"):-1;-1!==i&&(e=e.substring(0,i))}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new r.default(t).segments:[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e}();t.getUrlParts=function(e){return new i(e)}});define("odsp-next/dataSources/tag/odc/TagDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../models/tag/TagType","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","../../../resources/ODCResourceKeys"],function(e,t,i,r,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(l.urlDataSource);return t}e.prototype.updateTags=function(t){return u.default.start({apiName:"UpdateTags",url:this._getUpdateTagUrl(),batchSize:200,items:t.items,getPostData:function(e){return{tagsToDelete:t.tagsToDelete,tagsToAdd:t.tagsToAdd,ids:e.map(function(e){return e.id})}}})};e.prototype.getAllTags=function(e){var t;switch(e){case a.default.allTags:t=this._getAllTagsUrl();break;case a.default.allPlaces:t=this._getAllGeolocationTagsUrl();break;default:return n.default.wrap(null)}return(new o.default).send({apiName:"GetAllTags",url:t})};e.prototype.getParentKeyForTagType=function(e){var t,r;e===a.default.allTags?t="tags":e===a.default.allPlaces&&(t="places");return this._urlDataSource.getKey(((r={}).id=t,r))};e.prototype._getUpdateTagUrl=function(){return s.default.skyApiBaseUrl+"UpdateTags"};e.prototype._getAllTagsUrl=function(){return s.default.skyApiBaseUrl+"AllTags"};e.prototype._getAllGeolocationTagsUrl=function(){return s.default.skyApiBaseUrl+"AllTags?qt=Geolocation"};return e}(r.default);t.default=c});define("odsp-next/models/tag/TagType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.allTags=0]="allTags";e[e.allPlaces=1]="allPlaces";e[e.singleTag=2]="singleTag";e[e.singlePlace=3]="singlePlace"}(r||(r={}));t.default=r});define("odsp-next/dataSources/photo/odc/PhotoDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../models/store/ItemsStore","../../../resources/ModelResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./ISkyApiAllPhotosResponse","../../base/odc/ItemErrorProcessor","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../utilities/tag/GroupPacker","../../base/odc/ThumbnailProcessor","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../item/ItemTaskObserver","../../../models/task/Task","knockout","../../../controls/photos/Photos.resx"],function(e,t,i,r,u,l,c,o,n,a,d,s,p,m,f,h,g,v,y,b,_,S,x,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I,w=((T={})[s.GroupType[s.GroupType.Event]]=0,T[s.GroupType[s.GroupType.AlbumSuggestion]]=1,T[s.GroupType[s.GroupType.Highlights]]=2,T),A=["facesFolder","albumFolder","ascending","minRating","maxRating","favorites","highlights","etrmin","bmtsec","bhash","artmin","amtsec","ahashd","abadt","abadu","aminph","atagsout","aexpbph","wtrmin","wmtsec","whashd","wbadt","wbadu","wminph","wtagsout","wexpbph","wtaglist","wtagsother","wtagsnone","wphcount"];!function(e){e[e.ObjectDetectors=0]="ObjectDetectors";e[e.SystemDefined=1]="SystemDefined";e[e.OCR=2]="OCR";e[e.UserDefined=3]="UserDefined";e[e.LocationAndEventsApi=4]="LocationAndEventsApi"}(I=t.TagSource||(t.TagSource={}));var T,k=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._itemsStore=t.resources.consume(o.resourceKey);t._itemDataSource=t.resources.consume(a.getItem);t._urlDataSource=t.resources.consume(g.urlDataSource);t._itemErrorProcessor=new(t.managed(p.default));t._identityDataSource=t.resources.consume(a.identity);t._navigation=t.resources.consume(b.navigation);t._userSettingsStore=t.resources.consume(n.userSettingsStore);t._allPhotosUserSettings=x.observable(t._userSettingsStore&&t._userSettingsStore.getAllPhotosUserSettings());t._pendingRequests={};t._thumbnailProcessor=new(t.managed(y.default));return t}e.prototype.getAllPhotos=function(e){var i=this,t=new c.default,r={pagingToken:e.pagingToken,ascending:e.ascending?1:0,pageSize:e.pageSize,rootItemId:e.rootItemId||"root",tagFilter:e.tagFilter,locationFilter:e.locationFilter,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights,verbose:2};0;var o,n=this._urlDataSource.getKey(((o={}).id=e.rootItemId,o.qt="allmyphotos",o.locationFilter=e.locationFilter,o.tagFilter=e.tagFilter,o)),a=this._getAllPhotosUrl()+"?"+d.serializeQuery(r,null,!0),s=this._pendingRequests[a];s||(s=this._pendingRequests[a]=t.send({apiName:"AllPhotos",url:a}).then(function(e){delete i._pendingRequests[a];var t=new(i.resources.consume(_.resourceKey));t.update([new S.default(n).succeed({item:{key:n,isPlaceholder:!1,queryType:h.default.AllMyPhotos,type:f.default.Folder,name:P.strings.allPhotosNavLink,properties:{commandsSupported:{defc:"1"}},revision:0}})]);var r=i._processAllPhotosResponse(e,t);t.flush();return r},function(e){delete i._pendingRequests[a];var t=new(i.resources.consume(_.resourceKey));i._processError({requestKey:n,error:e,observer:t});t.flush();return u.default.wrapError(e)}));return s};e.prototype.setAllPhotosSettings=function(e){var t=this,r=new c.default,i=l.default.skyApiBaseUrl+"UpdateItem?lct=1",o=this._pendingRequests[i];o||(o=this._pendingRequests[i]=r.sendPost("UpdateItem",i,JSON.stringify(e)).then(function(e){delete t._pendingRequests[i];return e},function(e){delete t._pendingRequests[i];return u.default.wrapError(e)}));return o};e.prototype.getPhotoSetKey=function(e){var t=e.ascending,r=void 0!==t&&t,i=e.rootItemId,o=void 0===i?"root":i;return d.serializeQuery({parentKey:this.getItemKey(e),rootItemId:o,isAscending:r,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights},null,!0)};e.prototype.getItemKey=function(e){return this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t.onThisDay=e.onThisDay,t.u=e.uniqueName,t));var t};e.prototype.getAllPhotosSettings=function(e){var t,s=this,u=this._allPhotosUserSettings.peek(),r={parentKey:this._urlDataSource.getKey((t={},t.id="root",t.u="allphotossettings",t)),skipCache:!0,skipInMemoryCache:!!e,pageSize:0,itemSetKey:""};this._itemDataSource.getItem(r).done(function(e){if(e){var t=s.peekUnwrapObservable(s._itemsStore.getItem(e.item.key));if(t&&t.properties){var r=t.properties,i=r.allPhotosFolderId,o=void 0===i?u.rootId:i,n=r.allPhotosSortAscending,a={rootId:o,isAscending:void 0===n?u.isAscending:n};s._userSettingsStore.setAllPhotosUserSettings(a);s._allPhotosUserSettings(a)}}},function(e){});return this._allPhotosUserSettings};e.prototype.getMetadataContext=function(e){var t,r=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t)),i=this._urlDataSource.getKeyParams(r);return{avoidSeamSnapping:!0,parentKey:r,ownerId:this._urlDataSource.getOwnerId(),pageSize:0,filters:{tagFilter:i.tagFilter,locationFilter:i.locationFilter}}};e.prototype._processAllPhotosResponse=function(e,t){for(var r=[],i=[],o=0,n=e.items;o<n.length;o++){var a=n[o];r.push(this._processItem(a,t))}for(var s=0,u=e.itemGroupings;s<u.length;s++){var l=u[s],c=this._processGrouping(l);i.push(c)}return{futurePagingToken:e.futurePagingToken,pastPagingToken:e.pastPagingToken,items:r,itemGroupings:i}};e.prototype._processItem=function(e,t){var r=this._urlDataSource.getKey(((s={}).id=e.resId,s)),i={key:r,queryType:h.default.AllMyPhotos,name:e.name,displayName:e.name,extension:e.extension},o=e.thumbnailBaseUrl?this._createThumbnail(e):void 0;if(e.isVideo){i.video={height:e.height,width:e.width};i.iconName="video"}else{i.photo={height:e.height,width:e.width,quality:{isBad:e.isBad}};i.iconName="photo"}var n=e.resId,a=l.default.viewerId;i.id=n;i.itemId=n;i.ownerId=a;i.graph={itemId:n,driveId:a};i.properties={commandsSupported:{at:"1",ata:"1",de:"3",defc:"1",dl:"3",em:"3",mc:"1",rn:"1",rot:"1",sh:"1",vo:"1"}};i.sharingRole=0;i.type=f.default.Media;var s,u=[];e.tags&&(u=e.tags.filter(function(e){return!e.source||e.source.toLowerCase()!==I[I.OCR].toLowerCase()&&e.source.toLowerCase()!==I[I.LocationAndEventsApi].toLowerCase()}));if(e.location){i.geoLocation=x.utils.extend({},e.location);i.geoLocation.displayString=v.makePlaceName(i.geoLocation)}i.tags=u;i.isPlaceholder=!1;i.thumbnail=o;t.update([new S.default(r).succeed({item:i})]);return i};e.prototype._processGrouping=function(e){for(var t={},r={},i=[],o=0,n=e.groups;o<n.length;o++){for(var a=n[o],s=this._processGroup(a),u=0,l=(t[s.id]=s).keys;u<l.length;u++){r[l[u]]=s.id}i.push(s)}return{name:void 0,itemGroups:void 0,groupType:this._getGroupType(e.groupType),groups:i,groupMap:t,itemToGroupMap:r}};e.prototype._processGroup=function(e){for(var t=[],r=0,i=e.resIds;r<i.length;r++){var o=i[r],n=this._urlDataSource.getKey(((a={}).id=o,a));t.push(n)}var a,s=x.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.earliestPhotoTime.isoDate)},e.earliestPhotoTime),u=x.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.latestPhotoTime.isoDate)},e.latestPhotoTime);return{closedFuture:e.closedFuture,closedPast:e.closedPast,earliestPhotoTime:s,id:e.id,latestPhotoTime:u,location:e.location,keys:t,featuredKey:e.featuredResIds&&e.featuredResIds[0]}};e.prototype._extractUTCFullYearFromIsoDate=function(e){return new Date(e).getUTCFullYear().toString()};e.prototype._processError=function(e){var t=e.requestKey,r=e.error,i=e.observer;2===(r&&r.data&&r.data.code)&&this._identityDataSource.getIdentity().type===m.IdentityType.anonymous&&(r.data.code=152);this._itemErrorProcessor.processError({requestKey:t,error:r,observer:i})};e.prototype._getAllPhotosUrl=function(){return l.default.skyApiBaseUrl+"AllPhotos"};e.prototype._createThumbnail=function(e){return this._thumbnailProcessor.processThumbnailSet({baseUrl:"",thumbnails:[{name:"unRes",url:e.thumbnailBaseUrl+"?"+d.serializeQuery({psid:2}),width:e.width,height:e.height}]},{id:e.resId,ownerCid:l.default.viewerId,photo:{width:e.width,height:e.height}})};e.prototype._getGroupType=function(e){return w[e]||0};e.prototype._addDebugParamsToRequest=function(e){for(var t=this._navigation.viewParams,r=0,i=A;r<i.length;r++){var o=i[r];o in t&&(e[o]=t[o])}};return e}(r.default);t.default=k});define("odsp-next/dataSources/photo/odc/ISkyApiAllPhotosResponse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Event=0]="Event";e[e.AlbumSuggestion=1]="AlbumSuggestion";e[e.Highlights=2]="Highlights"}(t.GroupType||(t.GroupType={}))});define("odsp-next/utilities/tag/GroupPacker",["require","exports","knockout","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/string/StringHelper","../../models/item/OneDriveItem","../../dataSources/url/odc/UrlDataSource","../../models/item/ItemType","../../models/tag/TagType","../../dataSources/url/QueryType","../../dataSources/album/odc/AlbumDataSource","../../controls/allTagsHeader/AllTagsHeader.resx"],function(e,B,H,a,K,c,d,p,q,m,t,V){"use strict";Object.defineProperty(B,"__esModule",{value:!0});var b={"pokémon":!0},_={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},S=[t.NEW_ALBUM_TAG,t.AUTO_ALBUM_TAG,t.WEEKEND_RECAP_ALBUM_TAG,t.EVENT_RECAP_ALBUM_TAG];B.ALLPLACES_GEOLOCATION_DELIMITER=String.fromCharCode(9);B.ALLPLACES_GEOLOCATION_HARDCODED="%09";B.HEADER_GROUPINGID="tagHeader";var f=0;B.packAllTags=function(e,t,r,i,o){var n=e.length,a=0,s=[];if(1!==t){for(var u=0,l=e;u<l.length;u++){y=l[u];if(b[y.tag.toLowerCase()]||a<11&&_[y.tag.toLowerCase()]&&-1===S.indexOf(y.tag)){r.push(H.observable(G(q.default.allTags,y,null,o)));a++}}if(0<a){var c={groupingId:B.HEADER_GROUPINGID,startIndex:0,count:a,tagHeader:{title:V.strings.topTagsTitleText,countSubtitle:""}};s.push(c)}e.sort(function(e,t){var r=e.localizedTag||e.tag,i=t.localizedTag||t.tag;return r.localeCompare(i)});for(var d=0,p=e;d<p.length;d++){y=p[d];-1===S.indexOf(y.tag)?r.push(H.observable(G(q.default.allTags,y,null,o))):n--}if(0<n){var m=K.pluralSelect(n,V.strings.numberTagsSingularSubtitleText,K.format(V.strings.numberTagsPluralSubtitleText,n)),f={groupingId:B.HEADER_GROUPINGID,startIndex:a,count:n,tagHeader:{title:V.strings.allTagsTitleText,countSubtitle:m}};s.push(f)}var h={name:"tagGrouping",itemGroups:s};i.push(h)}else for(var g=0,v=e;g<v.length;g++){var y=v[g];-1===S.indexOf(y.tag)&&r.push(H.observable(G(q.default.allTags,y,null,o)))}};B.packAllPlaces=function(e,t,r,i,o,n){for(var a={},s=0,u=t;s<u.length;s++){var l=u[s];a[l.hierarchyIndex]=!0}e=e.filter(function(e){return a[e]});for(var c=[],d=[],p={name:V.strings.otherRegionsTitleText,places:[],totalPlaces:0},m=0,f=t;m<f.length;m++){var h=f[m],g=h.country;if(""===g){p.places.push(h);p.totalPlaces++}else if(d.indexOf(g)<0){c.push(j(g,h));d.push(g)}else z(g,h,c)}c.sort(function(e,t){return t.totalPlaces-e.totalPlaces});0<p.totalPlaces&&c.push(p);for(var v,y,b,_,S,x={},P=e.length,I=[],w=P,A=0,T=c;A<T.length;A++){var k=T[A],C=k.places;W(C);C.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var D=C.length,E=void 0,L=0,O=C;L<O.length;L++){var R=O[L];E=G(q.default.allPlaces,null,R,o);r.push(H.observable(E));-1<e.indexOf(R.hierarchyIndex)&&(x[R.hierarchyIndex]=Q(E))}I.push((v=w,y=D,b=k.name,_=n(k.name),S=K.pluralSelect(y,V.strings.numberPlacesSingularSubtitleText,K.format(V.strings.numberPlacesPluralSubtitleText,y)),{groupingId:B.HEADER_GROUPINGID,startIndex:v,count:y,tagHeader:{title:b,countSubtitle:S,regionUrl:_}}));w+=D}var M=t.length;if(0<P&&P<=M){for(var F=P-1;-1<F;F--)r.unshift(H.observable(x[e[F]]));var N={groupingId:B.HEADER_GROUPINGID,startIndex:0,count:P,tagHeader:{title:V.strings.recentPlacesTitleText,countSubtitle:""}};I.unshift(N)}var U={name:"tagGrouping",itemGroups:I};i.push(U)};function G(e,t,r,i){var o=((l={}).qt="allmyphotos",l.v="photos",l.id=i.rootItemId,l);switch(e){case q.default.allTags:var n=void 0;n=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag;o.tagFilter=n;break;case q.default.allPlaces:o.locationFilter=r.hierarchyIndex}o.u=""+f++;var a=d.default.getKey(o),s=new c.default(a);s.type=p.default.Folder;s.queryType=m.default.AllMyPhotos;var u={tagType:e};s.tagInfo=u;var l;s.folder={photoCount:0,covers:[]};switch(e){case q.default.allTags:s.name="#"+(t.localizedTag||t.tag);s.id=t.tag;s.folder.childCount=t.count;s.childCount=t.count;break;case q.default.allPlaces:s.name=r.displayString;s.id=r.hierarchyIndex;s.folder.childCount=r.count;s.childCount=r.count;break;default:return null}s.properties.commandsSupported={defc:"1"};s.isDraggable=!1;return s}B.createNewTagItem=G;function o(e){var t="";e.city&&(t+=e.city+", ");e.state&&(t+=e.state+", ");return 0===t.length?e.country||"":t.slice(0,-2)}B.makePlaceName=o;function j(e,t){var r=[];r.push(t);return{name:e,places:r,totalPlaces:1}}function z(e,t,r){for(var i,o=r.length,n=0;n<o;n++)if(e===(i=r[n]).name){i.places.push(t);i.totalPlaces++;break}}function W(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i.displayString=o(i)}}function Q(e){var t=a.deserializeQuery(e.key);t.u=f++;var r=d.default.getKey(t),i=new c.default(r);i.type=e.type;i.queryType=e.queryType;var o={tagType:e.tagInfo.tagType};i.tagInfo=o;i.name=e.name;i.id=e.id;var n={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};i.folder=n;i.properties.commandsSupported={defc:"1"};i.isDraggable=!1;return i}});define("odsp-next/providers/instrumentation/InstrumentationProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/images/ImagePromise","../../resources/DataSourceResourceKeys","../engagement/Engagement","./Page.event","../../dataSources/url/QueryType","../../models/search/SearchSession.key"],function(e,t,i,r,o,n,a,s,u,l,c,d,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},v=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.searchSessionStarted=!1;t._dataStore=new o.default("",n.default.session);t._instrumentationDataSource=t.resources.consume(d.instrumentation.optional);t._pageEvent=void 0;t._engagement=t.resources.consume(p.resourceKey);t._searchSession=t.resources.consume(h.resourceKey);return t}e.prototype.logStartSearchOnSubmit=function(){if(!this.searchSessionStarted){var e={name:"StartSearchSession",location:"NA",usageType:s.UsageType[s.UsageType.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(e)}};e.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};e.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};e.prototype.userViewPage=function(e){var t=e.name,r="(none)";if(this._pageEvent){r=this._pageEvent.data.currentName;this._pageEvent.end()}this._pageEvent=new m.Page({currentName:t,previousName:r});this._engagement.logData({name:"Page.View",location:"NA",usageType:s.UsageType[s.UsageType.Click],currentPage:t,previousPage:r,extraData:this._getExtraData(t)})};e.prototype.userSeeItem=function(e){};e.prototype.userClickItem=function(t){var e=a.default[a.default.bingClickInstrumentation];if(t.queryType===f.default.Search&&t.urls&&t.urls[e]){var r=new u.Qos({name:"SearchResultClickItem"});c.request(t.urls[e]).done(function(){r.end({resultType:l.ResultTypeEnum.Success})},function(){r.end({resultType:l.ResultTypeEnum.Failure,extraData:{url:t.urls[e]}})})}this._instrumentationDataSource?this._instrumentationDataSource.userClickItem(t):this.resources.isDefined(d.shadowCall)&&this.resources.consumeAsync(d.shadowCall).then(function(e){return e&&e.userClickItem(t)});this._logOfficeDocAge(t)};e.prototype.userClickSuggestion=function(e){if(e){var t=new u.Qos({name:"SearchSuggestionClickItem"});c.request(e).done(function(){t.end({resultType:l.ResultTypeEnum.Success})},function(){t.end({resultType:l.ResultTypeEnum.Failure,extraData:{url:e}})})}};e.prototype.getEngagementData=function(){return this._getExtraData()};e.prototype._getExtraData=function(e){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName()):null};e.prototype._startSearchSession=function(){this.searchSessionStarted=!0};e.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var r=this._engagement;r.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:t,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(g[t]){var i=new Date(e.dateModifiedValue),o=Math.ceil(((new Date).getTime()-i.getTime())/1e3);0<o&&r.logData({name:"OfficeDocument.Clicked",extraData:{extension:t,age:o,dateModified:e.dateModifiedValue}})}}}catch(e){}};return e}(r.BaseModel);t.default=v});define("@ms/odsp-utilities/lib/images/ImagePromise",["require","exports","../async/Signal"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.request=function(e){var t=new i.default,r=document.createElement("img");r.onload=function(){t.complete()};r.onerror=function(){t.error()};r.src=e;return t.getPromise()}});define("odsp-next/providers/instrumentation/Page.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Page=r.createPairedEvent({eventName:"Page,",shortEventName:"Page"},{previousName:1,currentName:1});t.default=t.Page});define("odsp-next/models/search/SearchSession.key",["require","exports","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(r.default.generate())})});define("@ms/odsp-utilities/lib/guid/Guid",["require","exports","@ms/utilities-guid/lib/Guid"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r;t.default=i});define("odsp-next/dataSources/feedback/odc/FeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,r,i,o,u,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=t.call(this)||this;e._urlDataSource=e.resources.consume(a.urlDataSource);return e}e.prototype.getFeedbackUrl=function(){var e=new o.default,t=this._urlDataSource.getFeedbackUrl();return e.send({apiName:"GetFeedbackUrl",url:t}).then(function(e){var t=window.Flight&&window.Flight.version,r=$Config.isINT,i=window.FilesConfig&&window.FilesConfig.df,o="https://"+(r?"onedrive.live-int.com":"onedrive.live.com")+("/handlers/clientstring.mvc?mkt="+$Config.mkt+"&group=Parature"),n={v:"dev"===t?$Config.build+"-DF":t+(i?"-DF":""),isRtl:u.default.isRightToLeft?1:0,localeUrl:o,isDf:i?1:0,curUrl:window.location.href.replace(/authkey=![^&]*/i,"authkey=!!!")},a=r?"&ACSIdx=4":"",s=l.serializeQuery(n);return e.feedbackUrl+encodeURIComponent(encodeURIComponent("&"+s))+a},function(e){return n.default.wrapError(e)})};e.prototype.getFeedbackEndpoints=function(){return["https://onedrive-feedback.ts.parature.com","https://onedrivesmoketest.azurewebsites.net"]};return e}(i.default);t.default=s});define("odsp-next/dataSources/sendFeedback/odc/SendFeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,r,i,f,h,g,o,v,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=t.call(this)||this;e._platform=e.resources.consume(a.platformDetection);e._urlDataSource=e.resources.consume(o.urlDataSource);return e}e.prototype.sendFeedback=function(e){var t=FilesConfig.SuiteNavConfig.UserDisplayName,r=$Config.email,i="\r\n",o=this._getBoundaryString(),n=window.FilesConfig&&window.FilesConfig.df,a=this._platform.osName+" "+this._platform.osVersion,s=$Config.pageContextInfo.pageType,u=v.format(g.default.feedbackBaseUrl,g.default.viewerId)+"/SendFeedback?mkt="+$Config.mkt,l=this._platform.browserName,c=this._platform.browserMajor,d=new f.default,p={};p["Content-Type"]="multipart/related; boundary="+o;var m="\r\n--"+o+i+"Content-ID: <Feedback>"+i+"Content-Type: application/json"+i+i+JSON.stringify({device:{platform:"Web",platformVersion:a,deviceModel:l,deviceVersion:c},appVersion:$Config.build,feedbackType:"Bug",app:"OneDrive",isDogfoodBuild:n?1:0,comment:e,backendVersion:s,user:{email:r,firstName:t,isBusiness:!1,authType:"MSA",authEnvironment:"Prod"}})+i+i+"--"+o+i;return d.send({headers:p,apiName:"SendFeedback",url:u,requestType:"POST",postData:m,returnRawXHR:!0,useDefaultHeaders:!0}).then(function(e){return h.default.wrap(e.statusText)},function(e){return h.default.wrapError(e)})};e.prototype._getBoundaryString=function(){return n.default.generate()};return e}(i.default);t.default=s});define("odsp-next/dataSources/userActivity/odc/UserActivityDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../../models/item/ItemType","../../url/odc/UrlDataSource","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys"],function(e,t,i,o,g,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v="system",y="anonymous";var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(a.urlDataSource);return t}e.prototype.getActivities=function(){var h=this,e=this._getActivityUrl();return(new o.default).send({apiName:"GetActivites",url:e,requestType:"GET"}).then(function(e){for(var t,r,i=[],o=0,n=e.activities;o<n.length;o++){for(var a=n[o],s=[],u=0,l=a.actors;u<l.length;u++){var c=l[u],d=h._getActorImageUrl(c);s.push({userId:c.id,name:c.displayName,email:"",image:d})}var p=void 0;switch(a.object.it){case 3:p=g.default.File;break;case 6:case 5:case 4:p=g.default.Media;break;case 2:p=g.default.Folder;break;default:p=g.default.Unknown}var m=a.object.rid,f=1===s.length&&((t=s[0]).userId!==v&&t.userId!==y)?s[0]:void 0;i.push({actors:s,item:{id:m,name:a.object.n,itemType:p},message:a.messageText,timestamp:new Date(a.timestamp),key:h._urlDataSource.getKey((r={},r.id=m,r.cid=f?f.userId:void 0,r))})}return{activities:i}})};e.prototype._getActivityUrl=function(){return n.default.activityApiBaseUrl+"Activities?$take=20"};e.prototype._getActorImageUrl=function(e){return e.id===v?"https://p.sfx.ms/Activity/v1/od_icon_96x96_square.png":e.id===y?null:n.default.getProfileImage(e.id)};return e}(r.default);t.default=s});define("odsp-next/providers/userActivity/UserActivityProvider",["require","exports","../../resources/DataSourceResourceKeys"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._dataSource=this.resources.consume(r.userActivity)}e.prototype.getActivities=function(){return this._dataSource.getActivities()};return e}();t.default=i});define("odsp-next/providers/feedback/FeedbackProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._feedbackDataSource=t.resources.consume(n.feedback);return t}e.prototype.getFeedbackUrl=function(){return this._feedbackDataSource.getFeedbackUrl().then(function(e){return e},function(e){return o.default.wrapError(e)})};e.prototype.getFeedbackEndpoints=function(){return this._feedbackDataSource.getFeedbackEndpoints()};return e}(r.default);t.default=a});define("odsp-next/providers/embed/EmbedProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._embedDataSource=t.resources.consume(o.embed);return t}e.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)};return e}(r.default);t.default=n});define("odsp-next/dataSources/embed/odc/EmbedDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=t.call(this)||this;e._urlDataSource=e.resources.consume(a.urlDataSource);return e}e.prototype.getEmbedInfo=function(e){var t=this,r=new o.default,i=this._urlDataSource.getEmbedInfoUrl(e);return r.send({apiName:"GetEmbedInfo",url:i,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return t._isExpected(e)?null:n.default.wrapError(e)})};e.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code};return e}(i.default);t.default=s});define("odsp-next/providers/userInfo/UserInfoProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/upsell/AvailableUpsells"],function(e,t,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.dataSource=t.resources.consume(o.userInfo);t.canPersistUserInfo=t.dataSource.canPersistUserInfo();return t}e.prototype.getAnid=function(){return this.dataSource.getAnid()};e.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};e.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){return t._cachedUserInfo=e},function(e){return n.default.wrapError(null)}):n.default.wrap(null):n.default.wrap(this._cachedUserInfo)};e.prototype.setUserInfo=function(e,t,r,i,o){return this.dataSource.setUserInfoWithUserFacts(e,t,r,i,o)};e.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};e.prototype.getBubbleUserFact=function(a,e){var s=this;return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(a,e):this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=0,r=e.info;t<r.length;t++){var i=r[t],o=s.peekUnwrapObservable(a),n=s.peekUnwrapObservable(o.campaignGuid);if(i.id&&i.id.toLowerCase()===n.toLowerCase())return JSON.parse(i.data)}return{d:!1,v:0}},function(e){return n.default.wrapError(null)})};e.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};e.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};e.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};e.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};e.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};e.prototype.updateUpsellData=function(e,t,r){return this.dataSource.updateUpsellData(e,t,r)};e.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};e.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};e.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};e.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};e.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};e.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};e.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?a.default[e.variation]:e};e.prototype.sendShowUpsell=function(e,t,r){return this.dataSource.sendShowUpsell(e,t,r)};e.prototype.sendCloseUpsell=function(e,t,r){return this.dataSource.sendCloseUpsell(e,t,r)};e.prototype.getMarket=function(){return this.dataSource.getMarket()};e.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};e.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};e.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};e.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};e.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};e.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};e.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};e.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};e.prototype.getGuidedTourCompleted=function(){return this.dataSource.getGuidedTourCompleted()};e.prototype.getGuidedTourViewCount=function(){return this.dataSource.getGuidedTourViewCount()};e.prototype.updateGuidedTourData=function(e,t){return this.dataSource.updateGuidedTourData(e,t)};e.prototype.completeGuidedTourAction=function(e){return this.dataSource.completeGuidedTourAction(e)};e.prototype.getCompletedGuidedTourActions=function(){return this.dataSource.getCompletedGuidedTourActions()};e.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};e.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};e.prototype.getOptimizelyVariation=function(e){return this.dataSource.getOptimizelyVariation(e)};e.prototype.setOptimizelyVariation=function(e,t){return this.dataSource.setOptimizelyVariation(e,t)};e.prototype.getEXPExperimentVariation=function(e){return this.dataSource.getEXPExperimentVariation(e)};e.prototype.setEXPExperimentVariation=function(e,t){return this.dataSource.setEXPExperimentVariation(e,t)};return e}(r.default);t.default=s});define("odsp-next/providers/ransomwareDetection/RansomwareDetectionProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../dataSources/url/PageType"],function(e,t,r,o,i,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r.pageType=t.pageType;r._urlDataSource=t.urlDataSource;r._navigation=t.navigation;r._ransomwareDetectionDataSource=t.ransomwareDataSource;r.activeAnomaly=r.observables.create();r.createBackgroundComputed(function(){r._redirectByAnomalyState(r.activeAnomaly()&&r.activeAnomaly().state)});return r}e.prototype.checkActiveAnomalies=function(){var t=this;this._ransomwareDetectionDataSource.getActiveAnomaly().then(function(e){t.activeAnomaly(e)})};e.prototype.updateActiveAnomalyState=function(e){var t=this.activeAnomaly();return t?this._ransomwareDetectionDataSource.updateAnomalyState(t.id,e):Promise.resolve(null)};e.prototype._redirectByAnomalyState=function(e){switch(e){case 0:case 1:this.pageType()!==l.default.RansomwareDetection&&this._navigation.updateViewParams({v:"RansomwareDetection"},{ignoreHistory:!0});break;case 2:this.pageType()!==l.default.Restore&&this._navigation.updateViewParams({v:"restore"},{ignoreHistory:!0});break;case 4:case 3:case 5:this.pageType()===l.default.RansomwareDetection&&this._navigation.navigateTo({url:this._urlDataSource.getCurrentPageBaseUrl()});break;default:return}};e.dependencies=r.__assign({},o.default.dependencies,{bundleLoaderProvider:a.bundleLoader,pageType:u.currentPage,urlDataSource:s.url,navigation:n.navigation,ransomwareDataSource:s.ransomwareDetection});return e}(o.default);t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});define("odsp-next/providers/tag/TagProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/tag/GroupPacker","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../models/itemSet/ItemSet","../item/ItemProvider","../../dataSources/item/ItemTaskObserver","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/tag/TagType","../../dataSources/url/QueryType","../../utilities/regex/Regex","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/Permissions","../../dataSources/base/odc/ItemErrorProcessor","../../models/item/ItemType","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Semaphore","knockout"],function(e,t,i,r,u,d,o,n,h,a,s,l,c,p,m,f,g,v,y,b,_,S,x,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._store=t.resources.consume(c.resourceKey);t._tagDataSource=t.resources.consume(o.tag);t._photoProvider=t.resources.consume(n.photo);t._identityDataSource=t.resources.consume(o.identity);t._urlDataSource=t.resources.consume(o.url);t._itemErrorProcessor=new(t.managed(b.default));return t}e.prototype.getAllTags=function(i){var o=this,n=this.getAllTagsSync(i,m.default.allTags);return n.isPlaceholder||n.isExpired?this._tagDataSource.getAllTags(m.default.allTags).then(function(e){o._clearPlaceholder(n.item.peek());var t=[],r=[];u.packAllTags(o._normalizeTags(e.tags),i.skipGrouping?1:0,t,r,i);n.isExpired=!1;n.isPlaceholder=!1;n.content({items:t,groupings:r});return n},function(e){o._processError(n.item.peek().key,e);return d.default.wrapError(e)}):0<n.content.peek().items.length?this._getThumbnails(n,i,m.default.allTags):d.default.wrap(n)};e.prototype.ensureHasThumbnails=function(e,t,r){for(var i=e.content.peek().items,o=0;o<i.length;o++)!i[o].peek().folder.covers.length&&o>=t.start&&o<=t.end&&this._fetchThumbnails(i[o],m.default.allTags,r)};e.prototype.getAllTagsForQuery=function(m,f){var e=this._photoProvider.getAllPhotosSettings().peek();return this.getAllTags({parentKey:null,startIndex:0,skipGrouping:!0,rootItemId:e.rootId}).then(function(e){for(var t=[],r=e.content.peek().items,i="#"===m[0]?m.substring(1):m,o=new RegExp("(^|\\s|/)"+g.default.escapeUserInput(i),"i"),n=new h.default,a="",s={},u=0,l=f;u<l.length;u++){s[l[u].toLocaleLowerCase()]=!0}for(var c=0,d=r;c<d.length;c++){var p=d[c];a=p.peek().name;m&&!o.test(a.substring(1))||s[a.toLocaleLowerCase()]||t.push(p)}n.item=e.item;n.content.peek().items=t;return n})};e.prototype.getAllPlaces=function(i){var o=this,n=this.getAllTagsSync(i,m.default.allPlaces);if(n.isPlaceholder||n.isExpired){var e=[],a=[],s=[];e.push(this._fetchRecentPlaces(a));e.push(this._fetchPlaceTags(n.item.peek().key,s));return d.default.all(e).then(function(){var e=[],t=[],r=o._urlDataSource.getAllPhotosForPlaceUrl.bind(o._urlDataSource);u.packAllPlaces(a,s,e,t,i,r);n.isPlaceholder=!1;o._clearPlaceholder(n.item.peek());n.content({items:e,groupings:t});return n},function(e){return d.default.wrapError(e)})}return this._getThumbnails(n,i,m.default.allPlaces)};e.prototype.getAllTagsSync=function(e,t){var r=this._getAllTagsSetKey(t,e),i=this._store.getItemSet(r);if(!i){var o=this._tagDataSource.getParentKeyForTagType(t),n=this._store.getItem(o);if(!n){var a=new p.default(o);a.type=_.default.Folder;a.virtualItemType=S.default.TagsRoot;a.queryType=f.default.AllMyPhotos;a.isRootFolder=!0;this._store.setItem(a);n=this._store.getItem(o)}(i=new l.default(r,e)).item=n;this._store.setItemSet(r,i)}return i};e.prototype.updateTags=function(s){var u=this,l=this.resources.consume(a.resourceKey);return this._tagDataSource.updateTags(s).then(function(e){for(var t,r=0,i=s.items.length;r<i;r++)(t=s.items[r]).parent&&l.invalidateItem(t.parent.key);s.parentKey&&l.invalidateItem(s.parentKey);u.invalidateAllTags("root");for(var o=0,n=[].concat(s.tagsToAdd).concat(s.tagsToDelete);o<n.length;o++){var a=n[o];a&&a.tag&&u._store.invalidateTag(a.tag)}return e},function(e){return d.default.wrapError(e)})};e.prototype.invalidateAllTags=function(e){var t={parentKey:null,skipGrouping:!1};this._store.invalidateItemSet(this._getAllTagsSetKey(m.default.allTags,t));t.skipGrouping=!0;this._store.invalidateItemSet(this._getAllTagsSetKey(m.default.allTags,t))};e.prototype._getThumbnails=function(e,t,r){for(var i=this,o=e.content.peek().items,n=[],a=Math.min(o.length,t.endIndex),s=new x.default(4),u=function(e,t,r){return function(){return i._fetchThumbnails(e,t,r)}},l=t.startIndex;l<a;l++){var c=o[l].peek();c&&!c.folder.covers.length&&n.push(s.enqueue(u(o[l],r,t)))}return d.default.all(n).then(function(){return e},function(e){return d.default.wrapError(e)})};e.prototype._fetchThumbnails=function(a,e,t){var s=this,r={parentKey:t.parentKey,rootItemId:t&&t.rootItemId,ascending:t&&t.ascending,pageSize:5,startIndex:0};switch(e){case m.default.allTags:r.tagFilter=a.peek().id;break;case m.default.allPlaces:r.locationFilter=a.peek().id;break;default:return d.default.wrap()}return this._photoProvider.getAllPhotos(r).then(function(e){for(var t=[],r=0,i=e;r<i.length;r++){var o=i[r];o.thumbnail&&t.push(o.thumbnail)}var n=new p.default(a.peek().key);P.utils.extend(n,a.peek());n.folder=P.utils.extend({},a.peek().folder);n.folder.covers=t;a(n);s._store.setItem(n);return d.default.wrap()},function(e){return d.default.wrapError(e)})};e.prototype._fetchRecentPlaces=function(n){var e={parentKey:void 0,startIndex:0,pageSize:100};return this._photoProvider.getAllPhotos(e).then(function(e){for(var t=e.length,r=0;n.length<5&&r<t;r++){var i=e[r].geoLocation,o=i&&i.hierarchyIndex;if(o){o=o.trim();n.indexOf(o)<0&&n.push(o)}}return d.default.wrap()},function(e){return d.default.wrapError(e)})};e.prototype._fetchPlaceTags=function(t,a){var r=this;return this._tagDataSource.getAllTags(m.default.allPlaces).then(function(e){for(var t=0,r=e.locations;t<r.length;t++){var i=r[t],o=i.hierarchyIndex&&i.hierarchyIndex.trim();if(o){i.hierarchyIndex=o;a.push(i);if(!i.country){var n=o.split("\t");i.country=n[0];!i.city&&1<n.length&&(i.city=n[n.length-1])}}}return d.default.wrap()},function(e){r._processError(t,e);return d.default.wrapError(e)})};e.prototype._processError=function(e,t){2===(t&&t.data&&t.data.code||0)&&this._identityDataSource.getIdentity().type===y.IdentityType.anonymous&&(t.data.code=152);var r=new(this.resources.consume(s.resourceKey));this._itemErrorProcessor.processError({requestKey:e,error:t,observer:r});r.flush()};e.prototype._getAllTagsSetKey=function(e,t){var r={tagType:m.default[e],grouped:t.skipGrouping?0:1};return v.serializeQuery(r,null,!0)};e.prototype._normalizeTags=function(e){for(var t={},r=[],i=0,o=e;i<o.length;i++){t[l=(u=o[i]).localizedTag||u.tag]?r.push(l):t[l]=!0}if(r.length){for(var n=[],a=0,s=e;a<s.length;a++){var u,l=(u=s[a]).localizedTag||u.tag,c=-1!==r.indexOf(l);(!c||c&&u.localizedTag!==u.tag)&&n.push(u)}return n}return e};e.prototype._clearPlaceholder=function(e){if(e.isPlaceholder){var t=new p.default(e.key);P.utils.extend(t,e);t.isPlaceholder=!1;t.queryType=f.default.AllMyPhotos;t.type=_.default.Folder;this._store.setItem(t)}};return e}(r.default);t.default=I});define("odsp-next/models/itemSet/ItemSet",["require","exports","./ItemSetContent","knockout","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r){this.key=e||"";this.content=o.observable(new i.default(r));this.content.equalityComparer=n.objectStrictEquality;this.schema=o.observableArray([]);this.schema.equalityComparer=n.arrayStrictEquality;this.context=o.utils.extend({},t);this.contentTypes=o.observableArray([]);this.isPlaceholder=!0;this.version=0};t.default=r});define("odsp-next/models/itemSet/ItemSetContent",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.default=r});define("odsp-next/providers/item/ItemProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../operation/OperationProvider","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ModelResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/operation/OperationError","../../models/itemSet/ItemSet","../ProviderHelpers","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","../../models/task/Task","@ms/odsp-utilities/lib/async/Signal","../quota/UserStateProvider.key","./ItemSetGrouper","../../utilities/features/Features","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,C,r,o,p,n,D,a,s,u,c,d,l,m,E,L,O,i,f,R,h,M,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){C.__extends(k,i);function k(e,t){var r=i.call(this,e,t)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=t.itemsStore;r._operationProvider=t.operationProvider;r._itemDataSource=t.itemDataSource;r._getItemDataSource=t.getItemDataSource;r._schemaDataSource=t.schemaDataSource;r._updateQuota=t.updateQuota;F.isFeatureEnabled(F.GroupThrottleSupport)&&(r._groupThrottle=t.groupThrottle);r._smartFiltersStore=t.smartFiltersStore;return r}k.prototype.getItem=function(e){return this._getItem(e)};k.prototype.getItemSetKey=function(e,t){var r="";r+="parentKey="+e.parentKey;function i(e,t){t&&(r+="&"+e+"="+t)}i("ownerId",e.ownerId);i("groupingType",e.groupingType);r+="&sortField="+(e.sortField||"");r+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var o=e.filters;if(o)for(var n in o)r+="&"+n+"="+o[n];i("groupBy",e.groupBy);i("viewId",e.baseViewId);i("viewXml",e.viewXml);i("additionalFiltersXml",e.additionalFiltersXml);var a=!t&&e.itemSetProjections;if(a){var s="";for(var u in a)s+=u+"_"+a[u];r+="&projection="+s}e.supportsNestedGroups&&(r+="&ng=1");return r};k.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._itemDataSource.getSpecifiedItems(e)};k.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),r=e.parentKey,i=this._store.getItem(r),o=this._getItemSet(t,e);if(!i){var n=new p.default(r);n.queryType=e.queryType;this._store.setItem(n);i=this._store.getItem(r)}if(!o){var a=i.peek(),s=a&&a.folder,u=s&&s.childCount||0;(o=new E.default(t,e,u)).item=i;var l=e.needSchema;if(void 0===l||l){var c=this._schemaDataSource,d=c&&c.getColumns(a);d&&0<d.length&&o.schema(d)}this._store.setItemSet(t,o)}return o};k.prototype.invalidateItem=function(e,t){var r=void 0===t?{}:t,i=r.triggerFetch,o=void 0!==i&&i,n=r.emptyAllOtherSets,a=void 0!==n&&n,s=r.refreshSchema,u=void 0!==s&&s,l=r.updateGrouping,c=void 0!==l&&l;a&&this._store.emptyAllOtherSets([e]);if(u){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e);this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(o){var d=this._store.getItemSetFromItemKey(e);this._getItem(C.__assign({parentKey:e},d&&d.context||{},{skipCache:!0,updateGrouping:c}))}};k.prototype.removeFromRecent=function(t){var r=this;return this._itemDataSource.removeFromRecent(t).then(function(e){e&&r.invalidateItem(t.parentKey);return e})};k.prototype.removeMountPoint=function(t){var r=this;return this._itemDataSource.removeMountPoint(t).then(function(e){e&&r.invalidateItem(t.parentKey);return e})};k.prototype.createMountPoint=function(e){return this._itemDataSource.createMountPoint(e).then(function(e){return e},function(e){return D.default.wrapError(e)})};k.prototype.createDocument=function(i,e,t,r,o){var n=this;return this._itemDataSource.createDocument(i,e,t,r).then(function(e){if(F.isFeatureEnabled(F.NewDocumentTemplates)&&o){var t=e.match(/{(.*)}/),r=t&&t[1];return n._itemDataSource.updateContentType(i,r,o).then(function(){n.invalidateItem(i);n._updateQuota(!0);return e})}n.invalidateItem(i);n._updateQuota(!0);return e})};k.prototype.createCustomDocument=function(e,t,r){var i=this;return this._itemDataSource.createCustomDocument(e,t,r).then(function(t){if(!t)return D.default.wrapError();i.invalidateItem(e);i._updateQuota(!0);return i.getItem({parentKey:e}).then(function(e){return i.peekUnwrapObservable(i._store.getItem(t))})})};k.prototype.updateBundle=function(r,i){var o=this,n=[new f.default(r.item.key,r.item)];i.update(n);return this._itemDataSource.updateBundle(r).then(function(){o.invalidateItem(r.item.parent?r.item.parent.key:r.item.key);n=n.map(function(e){return e.succeed()});i.update(n)},function(e){o.invalidateItem(r.item.parent?r.item.parent.key:r.item.key);var t=new Error(e);n=n.map(function(e){return e.fail(t)});i.update(n);return D.default.wrapError(t)})};k.prototype.removeFromSharedList=function(t){var r=this;return this._itemDataSource.removeFromSharedList(t).then(function(e){r.invalidateItem(t.parentKey);return e})};k.prototype.updateViewCount=function(e){return this._itemDataSource.updateViewCount(e)};k.prototype.reportAbuse=function(e){var t=new d.default,r=this._operationProvider.register({name:e.item.name,type:l.default.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),i=this._itemDataSource.reportAbuse(e);r.state(c.default.started);r.progress.maximum(1);return i.then(function(e){r.state(c.default.completed);r.progress.current(1);return e},function(e){r.state(c.default.failed);r.error(new m.default({message:e}));return D.default.wrapError(e)})};k.prototype.requestReview=function(o){for(var n=this,r=new d.default,a=o.items.map(function(e){var t=n._operationProvider.register({name:e.name,type:l.default.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:r});t.progress.maximum(1);t.progress.current(0);return t}),e=this._itemDataSource.requestReview(o),t=0,i=a;t<i.length;t++){i[t].state(c.default.started)}return e.then(function(e){for(var t=0,r=a;t<r.length;t++){var i=r[t];i.progress.current(1);i.state(c.default.completed)}n.invalidateItem(o.items[0].parent.key);return e},function(e){for(var t=0,r=a;t<r.length;t++){var i=r[t];i.error(new m.default({message:e}));i.state(c.default.failed)}return D.default.wrapError(e)})};k.prototype.saveSortOrder=function(e){return this._itemDataSource.saveSortOrder(e).then(function(e){return e},function(e){})};k.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,l.default.addCoverPhotos,this._addCoverPhotos)};k.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,l.default.removeCoverPhotos,this._removeCoverPhotos)};k.prototype.changeFolderType=function(t){var r=this;return this._itemDataSource.changeFolderType(t).then(function(e){r.invalidateItem(t.item.key,{triggerFetch:!0});return e})};k.prototype.updateItemProperty=function(t){var r=this;return this._itemDataSource.updateItemProperty(t).then(function(e){r.invalidateItem(t.item.key,{triggerFetch:!0});return e})};k.prototype.getOpenInClientDetails=function(e){return this._itemDataSource.getOpenInClientDetails(e).then(function(e){return e},function(e){})};k.prototype.getWorkProgress=function(e){return this._itemDataSource.getWorkProgress(e)};k.prototype.processReferral=function(e,t){return this._itemDataSource.processReferral(e,t)};k.prototype.getItemOcrTextContent=function(e){return this._itemDataSource.getItemOcrTextContent(e)};k.prototype.updateItemOcrInfo=function(t,e,r){var i=this;return this._itemDataSource.updateItemOcrInfo(t,e,r).then(function(e){i.invalidateItem(t.key,{triggerFetch:!0});return e},function(e){return e})};k.prototype.rotateItems=function(e,s){var u=this,l={},c=e.items.map(function(e){return l[e.key]=new f.default(e.key,e)});s.update(c);return this._itemDataSource.rotateItems(e).then(function(){c=c.map(function(e){return e.succeed()});s.update(c)},function(e){var t=e.data||[];c=[];for(var r=0,i=t;r<i.length;r++){var o=i[r],n=l[o.key];u._store.setItem(n.input);delete l[o.key];c.push(n.fail(o.error))}for(var a in l){n=l[a];delete l[a];c.push(n.succeed())}s.update(c)})};k.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};k.prototype.computeProjectedItemSet=function(e,t,r,i){var o=r.itemSetProjections,n=i?null:this._store.getItemSet(e);if(!n||n.isPlaceholder||n.isExpired||n.version!==t.version){if(!n){(n=new E.default(e,r)).item=t.item;n.isTokenBasedApi=t.isTokenBasedApi;n.isPlaceholder=t.isPlaceholder;n.isExpired=t.isExpired;n.version=t.version}for(var a in o){var s=this._registeredProjections[a];s&&s.projectItemSet(n,t,o[a])}i||this._store.setItemSet(e,n)}return n};k.prototype.redeemPermissionToken=function(e){return this._itemDataSource.redeemPermissionToken(e)};k.prototype._getItem=function(h){var g,v=this,y=O.deepCopy(h),b=this._store;if(h.keyAlias){g=this.getItemSync({parentKey:h.keyAlias}).item;h.parentKey=g.peek().key}else g=this.getItemSync(h).item;var e=h.skipCache,t=void 0!==e&&e,_=this.getItemSetKey(h),r=h.itemSetProjections?this.getItemSetKey(h,!0):_,i=this._getItemSet(_,h),o=i&&i.content.peek().items,S=h.isTokenBasedApi||i&&i.isTokenBasedApi,x=!t&&g&&!g.peek().revision&&i&&!i.isExpired&&!i.isPlaceholder&&(!h.requestAllChildren||L.resultSetHasData(o,{start:0,end:o.length})),n=h.startIndex,a=void 0===n?0:n,s=h.pageSize,u=void 0===s?100:s,l=h.endIndex||a+u;l=o&&0<o.length&&!S?Math.min(o.length,l):l;a=Math.max(0,Math.min(l,a));var c=b.getNextRequestToken(r);h.requestToken="end"===c?"":c;var P=new M.default(h,b,S,k.TOKEN_BASED_API_EXTRA_ITEMS);P.initialize(i,a);var d=!1,p=i&&i.content.peek();if(F.isFeatureEnabled(F.RenderLargeListPartialResult)&&p&&(1===p.partialResultStatus||2===p.partialResultStatus)){d=!0;1===p.partialResultStatus&&i.content({items:p.items,groupings:p.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(x&&!d&&P.isResultSetValid(o,{start:a,end:l}))return D.default.wrap(i);if(g&&g.peek().isStub){var m=h.startKey;if(m){if(b.getItem(m)){i.content.peek().items=[b.getItem(m)];i.isPlaceholder=!0;i.isExpired=!1;var f=this._schemaDataSource,I=f&&f.getColumns(g.peek());I&&0<I.length&&i.schema(I);i.content.valueHasMutated()}}return D.default.wrap(i)}var w=i&&!i.isExpired&&i.content.peek().groupings;w&&0<w.length&&(h.isGrouped=!0);this._normalizeContext(h,o,a,l,!x);var A=this._getRequestKey(h),T=this._pendingGetItemRequests[A];if(T)return h.itemSetProjections?T.getPromise().then(function(e){return v.computeProjectedItemSet(_,e,h)}):T.getPromise();S&&!c&&(h.startIndex=0);this._pendingGetItemRequests[A]=T=new R.default;this._getItemDataSource.getItem(C.__assign({},h,{itemSetKey:_})).then(function(e){if(y.updateContextBasedOnResult&&h.updateContextBasedOnResult){y.updateContextBasedOnResult(y,e);h.updateContextBasedOnResult(h,e);_=v.getItemSetKey(y)}var t=h.itemSetProjections?v.getItemSetKey(h,!0):_;g=b.getItem(h.parentKey);var r=b.getItemSet(t);x=!(!g||!r);var i=P.computeNewChildren(e,h,r,t,!!x),o=i.allChildren,n=i.hasNextRequestToken;n&&(S=n);if(e.item&&!h.ignoreChildren&&!h.skipStoreResults){if(!x){(r=new E.default(t,h)).item=b.getItem(h.parentKey);r.isTokenBasedApi=S;b.setItemSet(t,r)}var a=r.isExpired;r.sortField=e.sortField;r.isAscending=e.isAscending;r.isPlaceholder=!1;r.isExpired=!1;var s=h.needSchema;if(void 0===s||s){r.schema(e.schema&&(0<e.schema.length?e.schema:[]));e.customViewRenderer?r.customViewRenderer=v.observables.create(e.customViewRenderer):r.customViewRenderer=v.observables.create(null)}var u=e.groupings;S&&h.mergeGroupings&&(u=P.computeNewGroupings(r.content.peek().groupings,e.groupings,o,h,a));e.contentTypes&&r.contentTypes(e.contentTypes);var l=r.content.peek(),c=l.partialResultStatus,d=l.partialResultRequestCount,p=u&&u.length&&!!u[0];if(F.isFeatureEnabled(F.RenderLargeListPartialResult)&&!p){if(n&&(e.children&&e.children.length<30||!e.children)){var m=d+1;m<=5?d=m:c=1}else void 0===c||0===c||n?2===c&&e.children&&30===e.children.length&&(c=0):c=3}r.content({items:o,groupings:u,partialResultRequestCount:d,partialResultStatus:c});r.version++}delete v._pendingGetItemRequests[A];if(h.requestAllChildren&&!L.resultSetHasData(o,{start:0,end:e.totalChildren})){var f=O.deepCopy(h);f.startIndex+=100;return v._getItem(f)}if(e.isFromBrowserCache){y.skipCache=!0;return v._getItem(y)}h.itemSetProjections&&(r=v.computeProjectedItemSet(_,r,h));return r},function(e){delete v._pendingGetItemRequests[A];return D.default.wrapError(e)}).then(function(e){T.complete(e)},function(e){v._groupThrottle&&!v._groupThrottle()&&e&&e.errorCode===Number(-2147024860)?v._groupThrottle(!0):T.error(e)});return T.getPromise()};k.prototype._normalizeContext=function(e,t,r,i,o){var n=e.pageSize||100;if(!e.avoidSeamSnapping){if(!o&&!(r-r%n==i-i%n)&&t)for(;r<i&&t[r];)r++;e.startIndex=r-r%n}"number"!=typeof e.pageSize&&(e.pageSize=100);for(;i-e.startIndex>e.pageSize;)e.pageSize+=100};k.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};k.prototype._getItemSet=function(e,t){var r=this._store,i=r.getItemSet(e);if(t.itemSetProjections){var o=this.getItemSetKey(t,!0),n=r.getItemSet(o);n&&(i=this.computeProjectedItemSet(e,n,t))}return i};k.prototype._updateCoverPhotos=function(e,r,t){for(var o=this,i=new d.default,n=e.target,a=e.items.map(function(e){var t=o._operationProvider.register({name:e.name,type:r,payloads:{coverPhotos:{parent:n,item:e}},iconName:e.iconName,batch:i});t.progress.maximum(1);t.progress.current(0);return t}),s=t.call(this,e),u=0,l=a;u<l.length;u++){l[u].state(c.default.started)}return s.then(function(e){o.invalidateItem(n.key);for(var t=0,r=a;t<r.length;t++){var i=r[t];i.progress.current(1);i.state(c.default.completed)}return e},function(){for(var e=0,t=a;e<t.length;e++){t[e].state(c.default.failed)}})};k.prototype._addCoverPhotos=function(e){return this._itemDataSource.addCoverPhotos(e)};k.prototype._removeCoverPhotos=function(e){return this._itemDataSource.removeCoverPhotos(e)};k.dependencies={groupThrottle:a.groupThrottle.optional,itemDataSource:s.items,getItemDataSource:s.getItem,schemaDataSource:s.schema.optional,itemsStore:n.resourceKey,operationProvider:o.resourceKey,smartFiltersStore:u.smartFiltersStore.optional,updateQuota:h.resourceKey};k.TOKEN_BASED_API_EXTRA_ITEMS=F.isFeatureEnabled(F.RenderLargeListPartialResult)?2:5;return k}(r.default);t.default=g;t.resourceKey=i.createResolvedResourceKey(e("module").id,g)});define("odsp-next/models/operation/OperationError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.OperationError=r;t.default=r});define("odsp-next/providers/ProviderHelpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=function(e,t){for(var r=t.start,i=Math.min(t.end,e.length),o=r;o<i;o++)if(!e[o])return!1;return!0}});define("odsp-next/providers/quota/UserStateProvider.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposables:t}}}})});define("odsp-next/providers/item/ItemSetGrouper",["require","exports","knockout","../ProviderHelpers"],function(e,t,f,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="__next__",r=function(){function e(e,t,r,i){this._context=e;this._store=t;this._isTokenBaseApi=r;this._tokenBasedExtraItemCount=i}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var r=e&&e.content.peek().groupings,i=r&&r.length&&r[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,i)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==h&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===h;var o=e&&e.content.peek().groupings;this._isAllCollapsedQuery=o&&0<o.length&&o[0].isAllCollapsed&&o[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var r=this._skipDataFetch;r||(r=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&i.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return r};e.prototype.computeNewChildren=function(e,t,r,i,o){var n,a=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);n=o&&!r.isExpired?r.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&n.length>e.totalChildren&&(n[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,i,e.nextRequestToken);a=!0;r&&(r.isTokenBasedApi=a)}else this._store.setNextRequestToken(t.parentKey,i,"end");if(t.requestToken){t.startIndex=n.length-this._tokenBasedExtraItemCount;e.totalChildren+=n.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,u=e.startIndex+s;e.nextRequestToken&&(u+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(n.length,u))}if(e.item&&0<=e.totalChildren){this._isExpandingGroup||(0<n.length&&0===e.totalChildren?n=[]:n.length=e.totalChildren);var l=void 0;l=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var c=0,d=0;c<n.length;c++)if(l<=c&&d<e.children.length){n[c]=this._store.getItem(e.children[d].key);d++}}return{allChildren:n,hasNextRequestToken:a}};e.prototype.computeNewGroupings=function(e,t,r,i,o){var n=this._isExpandingGroup?i.group:null,a=i.itemsPerGroup,s=e&&0<e.length?e[0].itemGroups:null,u=null;s&&0<s.length&&s[s.length-1].isPlaceholder&&(u=s.pop());var l=this._mergeGroupings(e,t,o,r);if(n&&l){l[0].isAllCollapsed(!1);n.state({isCollapsed:!1})}if(r&&0<r.length&&!r[r.length-1]&&(s=l&&0<l.length?l[0].itemGroups:null)&&0<s.length){var c=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(c.hasMoreData=!0);var d=r[c.startIndex+(-1!==a?Math.min(c.count,a):c.count)-1]&&!(this._context.groupReplace&&c.count<a),p=l[0].isAllCollapsed.peek();if(d||this._isFetchingNextGroup||p){var m=c.startIndex+c.count;u?u.startIndex=m:u={groupingId:h,startIndex:m,count:1,isPlaceholder:!0,state:f.observable({isCollapsed:!1})};r.length<m&&(r.length=m+1);s.push(u)}}return l};e.prototype._mergeGroupings=function(e,t,r,i){var o=e;if(o&&0<o.length){if(t&&0<t.length)for(var n=0;n<t.length;n++){var a=o[n].isAllCollapsed.peek();o[n].itemGroups=r?this._retainItemGroupState(o[n].itemGroups,t[n].itemGroups):this._mergeItemGroups(o[n].itemGroups,t[n].itemGroups,a,null,i)}}else o=t;return o};e.prototype._mergeItemGroups=function(e,t,l,c,d){var p=e;if(e&&0<e.length){if(t&&0<t.length)for(var r=function(a){var s=!1;l&&a.state({isCollapsed:!0});for(var e=function(e){var t=p[e];if(a.groupingId===t.groupingId){if(m._context.noIndexBasedDataFetch||!m._context.isTokenBasedApi){if(m._context.groupReplace){t.count+=a.count;t.hasMoreData&&e<p.length-1&&(t.hasMoreData=!1)}else t.count=a.count;t.children=m._mergeItemGroups(t.children,a.children,l,t);if(0===e)t.startIndex=c?c.startIndex:0;else{var r=p[e-1],i=r.startIndex+r.count-t.startIndex;t.startIndex+=i;t.children&&t.children.forEach(function(e){e.startIndex+=i})}}else{var o=a.startIndex+m._context.startIndex,n=a.startIndex+m._context.startIndex+a.count;t.startIndex=Math.min(t.startIndex,o);t.count=Math.max(n,t.startIndex+t.count)-t.startIndex}s=!0;return"break"}},t=0;t<p.length;t++){if("break"===e(t))break}if(!s){var r=p[p.length-1],i=r.startIndex+r.count-a.startIndex;a.startIndex+=i;a.children&&a.children.forEach(function(e){e.startIndex+=i});var o=Math.min(a.count,30),n=0;if(d)for(var u=a.startIndex;u<a.startIndex+o;u++)d[u]||n++;n&&(a.emptyItemCount=n);p.push(a)}},m=this,i=0,o=t;i<o.length;i++){r(o[i])}}else p=t;return p};e.prototype._retainItemGroupState=function(e,t,r){var i=t;if(t&&0<t.length&&e&&0<e.length){for(var o={},n=0,a=e;n<a.length;n++){var s=a[n];o[s.groupingId]=s}for(var u=0,l=i;u<l.length;u++){var c=l[u],d=o[c.groupingId];if(d){c.state(d.state.peek());c.children=this._retainItemGroupState(d.children,c.children,d)}}}return i};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&0<t.length)for(var r=0;r<t.length;r++){var i=t[r];if(!(i&&i.startIndex<=e))break;var o=i.startIndex+i.count-1;if(i.children){if(e<=o)return this._getGroupStartingOnIndex(e,i.children)}else{if(i.startIndex===e)return i.state.peek().isCollapsed?null:i;if(e<=o){var n=r<t.length-1?t[r+1]:null;if(n&&!n.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e}();t.default=r});define("odsp-next/models/photo/AllPhotosSet",["require","exports","knockout","../itemSet/ItemSetContent","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.key=e||"";this.content=r.observable(new i.default);this.content.equalityComparer=o.objectStrictEquality;this.schema=r.observableArray([]);this.schema.equalityComparer=o.arrayStrictEquality;this.context=r.utils.extend({},t);this.isPlaceholder=!0};t.default=n});define("odsp-next/utilities/regex/Regex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.escapeUserInput=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};return e}();t.default=r});define("odsp-next/providers/photo/PhotoProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../ProviderHelpers","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/locale/Locale","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/item/ItemType","../../models/item/VirtualItemType","../../dataSources/url/QueryType","../item/ItemProvider","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/dateTime/DateTime","./logging/OnThisDay.event"],function(e,t,r,w,n,i,o,a,s,u,S,l,c,d,p,A,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,g=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._store=t.resources.consume(u.resourceKey);t._photoDataSource=t.resources.consume(o.photo);t._urlDataSource=t.resources.consume(o.url);t._itemProvider=t.resources.consume(p.resourceKey);t.pages={};t._photoSetIsUpdating={};t._indicesBeingRequested={};t._pendingMetadataRequests={};t._totalChildCount={};t._photoGroupingData={};t._photoKeyToIndexMap={};var r=function(){if(!h)for(var e=[window.$Config&&window.$Config.mkt,a.default.language,navigator.language,"en"],t=0,r=e;t<r.length;t++){var i=r[t];if(i)try{(new Date).toLocaleDateString(i);h=i;break}catch(e){}}return h}();t._formatDate=function(e){return e.toLocaleDateString(r)};if("Intl"in window&&"object"==typeof window.Intl)try{t._dateFormatter=new Intl.DateTimeFormat(r,{month:"long",day:"numeric"});t._formatDate=t._dateFormatter.format}catch(e){}return t}e.prototype.getAllPhotos=function(o){var n=this,a=this.getAllPhotosSync(o),s=a.content.peek().items;o.tagFilter&&(o.tagFilter=decodeURIComponent(o.tagFilter));return this._photoDataSource.getAllPhotos(o).then(function(e){a.isPlaceholder=!1;if(a.isExpired){var t=Math.max(n._getAllPhotosCount(a.key).peek(),0);s=new Array(t)}var r=e.items,i=o.tagFilter?[]:n._mergeGroupings(a,e);n._mergeItemSets(e,a,o,s);a.content({items:s,groupings:i});return r})};e.prototype.determineStartEndRange=function(e,t,r){if(0===r)return{start:0,end:0};if(t.isExpired)return this.determineStartEndRangeForExpiredSet(e);var i=e.startIndex,o=e.endIndex||i+(e.pageSize||200);o=0<r?Math.min(r,o):o;return{start:i=Math.max(0,Math.min(o,i)),end:o}};e.prototype.determineStartEndRangeForExpiredSet=function(e){var t=this.getPhotoSetKey(e),r=e.startIndex;r<0&&(r=0);var i=e.pageSize;if(r<i&&e.endIndex<i)return{start:0,end:i};var o=this.findMonthGroupingByIndex(t,r);if(!o)return{start:0,end:0};i=o.count;return{start:o.startIndex,end:o.startIndex+i}};e.prototype.hasAllItemsInRange=function(e,t,r,i,o){return!o&&!!t.length&&!e.isExpired&&(i<=0||n.resultSetHasData(t,{start:r,end:i}))||!e.isExpired&&this._areAllPhotosInSetBeingRequested(e.key,t,r,i)};e.prototype.getAllPhotosForPage=function(x){var e,P=this,I=this.getAllPhotosSync(x);switch(x.photoType){case 0:case 6:I.isPlaceholder&&this.getAllPhotosMetadata(x).done(function(e){P.virtualizeAllPhotosSet(I)})}if(I.isExpired){this._invalidatePhotoSet(I.key);e=this.getAllPhotosMetadata(x)}return w.default.wrap(e).then(function(e){var s=I.content.peek().items;0<x.endIndex&&!s[x.endIndex]&&(x.endIndex=x.endIndex+1);var t=P.determineStartEndRange(x,I,s.length),r=t.start,i=t.end,o=!!e&&s.length!==e.items.length&&0!==s.length;if(P.hasAllItemsInRange(I,s,r,i,o))return w.default.wrap(I);if(I.isExpired){var n=Math.max(P._getAllPhotosCount(I.key).peek(),0);s=new Array(n)}var u=[],l=P.getPageForIndex(I.key,r,i),a=P.getPastPageForIndex(I.key,r,i,x.pageSize),c=P.getFuturePageForIndex(I.key,r,i,x.pageSize),d=P.findMonthGroupingByIndex(I.key,r),p=P.determinePagingTypeForContext(r,i,a,c,d,x.pageSize),m=A.deepCopy(x);if(1===p){if(!a.pastPagingToken)return;m.pagingToken=a.pastPagingToken;m.startIndex=a.endIndex;m.endIndex=a.endIndex+x.pageSize}else if(2===p){if(!c.futurePagingToken)return;m.pagingToken=c.futurePagingToken;m.startIndex=c.startIndex-x.pageSize;m.endIndex=c.startIndex;m.ascending=!0}else if(3===p){var f=P._getStartDateForMonthGroup(d,!0),h=d.count>x.pageSize,g=h?x.pageSize:d.count,v=d.startIndex+d.count;if(!f)return w.default.wrap(I);m.startDate=f;m.startIndex=v-g;m.endIndex=v;m.pageSize=g;m.ascending=!0;if(h)for(var y=0,b=u=P.makeBatchedContextsForDateJumping(m,d,g);y<b.length;y++){var _=b[y];P._storePage(null,I,_)}}else if(0===p){m.startIndex=r;m.endIndex=x.pageSize}l=P._storePage(l,I,m);u.unshift(m);var S=function(a){return P._photoDataSource.getAllPhotos(a).then(function(e){I.isPlaceholder=!1;for(var t=a.startIndex;t<a.endIndex;t++){var r=t-a.startIndex,i=e.items[r];i&&(P._photoKeyToIndexMap[i.key]=t)}if(!(l=P.getPageForIndex(I.key,a.startIndex,a.endIndex))){l={startIndex:a.startIndex,endIndex:a.endIndex};P.insertPage(I.key,l)}if(!l.futurePagingToken&&!l.pastPagingToken){l.futurePagingToken=e.futurePagingToken;l.pastPagingToken=e.pastPagingToken}var o=a.tagFilter?[]:P._mergeGroupings(I,e);P._mergeItemSets(e,I,a,s);for(t=a.startIndex;t<=a.endIndex;t++)P._indicesBeingRequested[I.key][t]=!1;if(u&&u.length){var n=a.ascending?u.shift():u.pop();n.pagingToken=a.ascending?e.futurePagingToken:e.pastPagingToken;n.ascending=a.ascending;l=P.getPageForIndex(I.key,n.startIndex,n.endIndex);l=P._storePage(l,I,n);P._photoSetIsUpdating[I.key]=!0;return S(n)}I.isExpired=!1;I.content({items:s,groupings:o});P._photoSetIsUpdating[I.key]=!1;return I},function(e){for(var t=!0,r=0,i=s;r<i.length;r++){var o=i[r];if(o&&o.peek()){t=!1;break}}if(t)return w.default.wrapError(e)})};return 1===u.length?S(u.shift()):w.default.all([S(u.shift()),S(u.pop())])},function(e){})};e.prototype.makeBatchedContextsForDateJumping=function(e,t,r){for(var i=[],o=Math.ceil((t.count-e.pageSize)/e.pageSize),n=1;n<=o;n++){var a=A.deepCopy(e),s=r*n,u=e.startIndex-s;a.startIndex=u<0?0:u;a.endIndex=e.endIndex-s;if(n===o){a.ascending=!1;a.startDate=m.getLastDayOfMonth(this.getDateStringForAllPhotos(new Date(Date.parse(t.data.isoDate)),!0)).toISOString();a.startIndex=t.startIndex;a.pageSize=Math.abs(a.endIndex-a.startIndex)}else{a.ascending=!0;delete a.startDate}i.push(a)}return i};e.prototype.virtualizeAllPhotosSet=function(e){var t=e.content.peek(),r=t.items,i=!1,o=this._getAllPhotosCount(e.key).peek();if(-1!==o)if(r.length<o){for(var n=r.length;n<o;n++)r.push(null);i=!0}else if(r.length>o){var a=r.length-o;r.splice(-1*a);i=!0}i&&e.content({items:r,groupings:t.groupings})};e.prototype.determinePagingTypeForContext=function(e,t,r,i,o,n){var a=0;r&&e<=r.endIndex?a=1:i&&e<i.startIndex?a=2:e<n&&t<=n?a=0:o&&(a=3);return a};e.prototype.getItemSync=function(e){var t=this._photoDataSource.getItemKey(e),r=this._store.getItem(t);if(!r){var i=new S.default(t);i.properties.commandsSupported={defc:"1"};i.queryType=d.default.AllMyPhotos;i.displayType=d.default.AllMyPhotos;i.type=l.default.Folder;if(e.tagFilter){var o=e.tagFilter.split(";"),n=o[0],a=o[1];i.virtualItemType=c.default.Tag;i.name="#"+n;i.tags=[{source:null,type:null,tag:n,localizedTag:a}]}if(e.onThisDay){i.folder={childCount:0,photoCount:0,covers:[]};i.ownerId=this._urlDataSource.getOwnerId(t);var s=new Date(Date.parse(e.startDate));i.dateTakenTime=s;i.isAlbum=!0;i.virtualItemType=c.default.Album}e.tagFilter||e.locationFilter||(i.isRootFolder=!0);r=this._store.setItem(i)}return r};e.prototype.getAllPhotosSync=function(e){var t=this.getPhotoSetKey(e),r=this._store.getItemSet(t),i=this.getItemSync(e);if(!r){var o=e.ascending,n=void 0!==o&&o;(r=new s.default(t,e)).item=i;r.isAscending=n;this._store.setItemSet(t,r)}return r};e.prototype.getAllPhotosMetadata=function(e){var o=this,t=this._photoDataSource.getMetadataContext(e),n=this.getPhotoSetKey(e);if(this._pendingMetadataRequests[n])return this._pendingMetadataRequests[n];var a=!1,r=this._itemProvider.getItem(t).then(function(e){var t=e.content.peek(),r=o.getPhotoGroupingData(n);o._totalChildCount[n]?o._totalChildCount[n](t.items.length):o._totalChildCount[n]=o.createObservable(t.items.length);var i=o._getGroupingByKey(t.groupings,"Month");r.itemGroup(i.itemGroups);o._resolvePhotoSetGroupingData(n);a=!0;delete o._pendingMetadataRequests[n];return t},function(e){o._resolvePhotoSetGroupingData(n);delete o._pendingMetadataRequests[n];a=!0;return w.default.wrapError(e)});a||(this._pendingMetadataRequests[n]=r);return r};e.prototype.getPhotoGroupingData=function(e){this._photoGroupingData[e]||(this._photoGroupingData[e]={hasResolved:this.createObservable(!1),itemGroup:this.observables.createArray([])});return this._photoGroupingData[e]};e.prototype.getOnThisDayPhotos=function(g){var v,y=this,b=this.getAllPhotosSync(g),_=0===g.startIndex;_&&(v=new f.OnThisDay);return b.isPlaceholder||b.isExpired?this.getAllPhotosMetadata(g).then(function(e){for(var l=[],t=new Date(Date.parse(g.startDate)),r=y._getGroupingByKey(e.groupings,"Month"),i=t.getMonth(),o=t.getDate(),n=t.getFullYear(),a=new Date(n,i,o),s=new Date(n,i,o+1),u={},c=0,d=r.itemGroups;c<d.length;c++){var p=d[c],m=new Date(Date.parse(p.data.isoDate));if(!(m.getTime()>s.getTime())){var f=new Date(m.getTime());f.setUTCMonth(m.getUTCMonth()+1);for(;f.getTime()<=a.getTime()||a.getDate()!==o;){n--;a=new Date(n,i,o);s=new Date(n,i,o+1)}m.getTime()<s.getTime()&&f.getTime()>a.getTime()&&(u[a.toISOString()]=s.toISOString())}}for(var h in u)l.push({parentKey:void 0,startDate:h,endDate:u[h],highlights:g.highlights,pageSize:100,ascending:!0,rootItemId:g.rootItemId,startIndex:g.startIndex,endIndex:g.endIndex});return w.default.all(l.map(function(e){return y.getAllPhotos(e)})).then(function(e){var t,r=[].concat.apply([],e),i=[],o=null;if(r.length){o=l.map(function(e){return y.getAllPhotosSync(e)}).filter(function(e){return!!e.content.peek().items.length}).map(function(e){t||(t=new Date(Date.parse(e.context.startDate)));return e.content.peek().groupings[0]}).reduce(function(e,t){return{name:t.name,itemGroups:A.extend(e.itemGroups,t.itemGroups),groupMap:A.extend(e.groupMap,t.groupMap),groups:e.groups.concat(t.groups),groupType:2,itemToGroupMap:A.extend(e.itemToGroupMap,t.itemToGroupMap)}},{name:"",itemGroups:[],groupMap:{},groups:[],groupType:2,itemToGroupMap:{}});var n=0;o.groups=o.groups.map(function(e){e.startIndex=n;n+=e.keys.length;return e});i=r.map(function(e){return y._store.getItem(e.key)})}b.isPlaceholder=!1;b.isExpired=!1;var a=y.getItemSync(g).peek(),s={covers:r.map(function(e){return e.thumbnail}).filter(function(e){return!(!e||!e.url)}),photoCount:r.length},u=t?y._formatDate(t):"";b.item(A.extend(A.extend(new S.default(a.key),a),{childCount:r.length,folder:s,isPlaceholder:!1,name:u}));b.content({items:i,groupings:[o]});_&&v.end({itemsInFirstPage:i.length});return b},function(e){})}):w.default.wrap(b)};e.prototype.getPastPageForIndex=function(e,t,r,i){for(var o=0,n=this.pages[e]||(this.pages[e]=[]);o<n.length;o++){var a=n[o],s=a.endIndex+i,u=t<=a.endIndex&&t>=a.startIndex&&r<=s,l=t>=a.endIndex&&t<=s&&r<s,c=a.startIndex===t&&a.endIndex===r;if((u||l)&&!c)return a}return null};e.prototype.getFuturePageForIndex=function(e,t,r,i){for(var o=0,n=this.pages[e]||(this.pages[e]=[]);o<n.length;o++){var a=n[o],s=a.startIndex-i,u=r>=a.startIndex&&r<=a.endIndex&&s<=t,l=r>=a.startIndex&&r<=s&&t<=s,c=a.startIndex===t&&a.endIndex===r;if((u||l)&&!c)return a}return null};e.prototype.getPageForIndex=function(e,t,r){for(var i=0,o=this.pages[e]||(this.pages[e]=[]);i<o.length;i++){var n=o[i];if(t>=n.startIndex&&r<=n.endIndex)return n}return null};e.prototype.insertPage=function(e,t){for(var r=this.pages[e]||(this.pages[e]=[]),i=0;i<r.length;i++){var o=r[i];if(o.startIndex===t.startIndex&&o.endIndex===t.endIndex)return;if(t.endIndex<o.endIndex||t.endIndex===o.endIndex&&t.startIndex<o.startIndex){r.splice(i,0,t);return}}r.push(t)};e.prototype.findMonthGroupingByIndex=function(e,t){var r=this.getPhotoGroupingData(e),i=this.getPhotoGroupingData(e)&&r.itemGroup.peek();if(!i)return null;for(var o=0,n=i;o<n.length;o++){var a=n[o],s=a.startIndex+a.count;if(t>=a.startIndex&&t<s)return a}return null};e.prototype.getPhotoSetKey=function(e){return this._photoDataSource.getPhotoSetKey(e)};e.prototype.setAllPhotosSettings=function(e){return this._photoDataSource.setAllPhotosSettings(e)};e.prototype.getAllPhotosSettings=function(e){!e&&this._allPhotosSettings||(this._allPhotosSettings=this._photoDataSource.getAllPhotosSettings(e));return this._allPhotosSettings};e.prototype.getDateStringForAllPhotos=function(e,t){var r=new Date(e.getTime());r.setUTCDate(1);r.setUTCHours(0);r.setUTCMinutes(0);r.setUTCSeconds(0);r.setUTCMilliseconds(0);if(!t){var i=r.getUTCMonth();r.setUTCMonth(i+1)}return r};e.prototype._getGroupingByKey=function(e,t){for(var r=null,i=0,o=e;i<o.length;i++){var n=o[i];if(n&&n.name===t){r=n;break}}return r};e.prototype._mergeItemSets=function(e,t,r,i){var o=e.items,n=r.startIndex;if(r.ascending)for(var a=o.length-1;0<=a;a--,n++)i[n]=this._store.getItem(o[a].key);else for(a=0;a<o.length;a++,n++)i[n]=this._store.getItem(o[a].key);var s=this.getPhotoGroupingData(t.key),u=s&&0<s.itemGroup.peek().length,l=!e.futurePagingToken&&!e.pastPagingToken;(!r.locationFilter&&!r.tagFilter||r.pageSize!==o.length||l)&&(u||!s.hasResolved.peek()||l)||i.push(null)};e.prototype._getAllPhotosCount=function(e){var t=this._totalChildCount[e];t||(t=this._totalChildCount[e]=this.createObservable(-1));return t};e.prototype._storePage=function(e,t,r){if(!e){var i=t.key,o=r.startIndex,n=void 0===o?0:o,a=r.endIndex;e={startIndex:n,endIndex:void 0===a?r.pageSize:a};this.insertPage(i,e);var s=this._indicesBeingRequested[i];s||(s=this._indicesBeingRequested[i]={});for(var u=e.startIndex;u<e.endIndex;u++)s[u]=!0}return e};e.prototype._invalidatePhotoSet=function(e){delete this._photoGroupingData[e];delete this.pages[e];this._photoKeyToIndexMap={}};e.prototype._areAllPhotosInSetBeingRequested=function(e,t,r,i){var o=!0;if(!this._indicesBeingRequested[e])return!1;for(var n=r;n<i;n++)if(!this._indicesBeingRequested[e][n]){o=!1;break}return o};e.prototype._resolvePhotoSetGroupingData=function(e){this.getPhotoGroupingData(e).hasResolved(!0)};e.prototype._getStartDateForMonthGroup=function(e,t){var r,i;if(!e)return r;i=e.data.isoDate?new Date(Date.parse(e.data.isoDate)):this._getDateFromString(e.data.monthName,e.data.year);return(r=this.getDateStringForAllPhotos(i,t)).toISOString()};e.prototype._getDateFromString=function(e,t){var r=Date.parse(e+" 1, "+t);return isNaN(r)?null:new Date(r)};e.prototype._mergeGroupings=function(e,t){for(var r=!e.isExpired&&e.content.peek().groupings||t.itemGroupings,i=0;i<r.length;i++){var o=r[i],n=t.itemGroupings[i];this._createMapsFromGroups(o,n)}return r};e.prototype._createMapsFromGroups=function(e,t){if(t)for(var r=0,i=t.groups;r<i.length;r++){var o=i[r],n=o.id;if(e.groupMap[n]){for(var a={},s=0,u=e.groupMap[n].keys;s<u.length;s++){a[f=u[s]]=!0}for(var l=0,c=o.keys;l<c.length;l++){a[f=c[l]]=!0}e.groupMap[n].keys=Object.keys(a)}else{e.groupMap[n]=o;e.groups.push(o)}for(var d=void 0,p=0,m=o.keys;p<m.length;p++){var f=m[p];e.itemToGroupMap[f]=n;var h=this._photoKeyToIndexMap[f];(void 0===d||h<d)&&(d=h)}o.startIndex=d}};return e}(i.default);t.default=g});define("odsp-next/providers/photo/logging/OnThisDay.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OnThisDay=r.createPairedEvent({eventName:"OnThisDay,",shortEventName:"OnThisDay"},{itemsInFirstPage:2});t.default=t.OnThisDay});define("odsp-next/providers/storageInfo/StorageInfoProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._storageInfoDataSource=t.resources.consume(o.storageInfo);return t}e.prototype.getStorageInfo=function(){return this._storageInfoDataSource.getStorageInfo()};e.prototype.redeemCode=function(e){return this._storageInfoDataSource.redeemCode(e)};e.prototype.sendInvitation=function(e){return this._storageInfoDataSource.sendInvitation(e)};return e}(r.default);t.default=n});define("odsp-next/providers/storageOptions/StorageOptionsProvider",["require","exports","tslib","../../models/storageOptions/IStorageOptions","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","./StorageOptionsRequestor"],function(e,t,i,l,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._storageOptionsDataSource=t.resources.consume(o.storageOptions);t._storageOptionsRequestor=new(t.managed(n.default));t._storageOptionsRequestor.updateStorageOptions();t.isReady=t.createPureComputed(t._computeIsReady);t.isEligibleForPremium=t.createPureComputed(t._computeIsEligibleForPremium);t.hasOffice=t.createPureComputed(t._computeHasOffice);t._data=t.createPureComputed(function(){return t._storageOptionsRequestor.storageOptionsData()});return t}e.prototype.getStorageOptions=function(){return this._storageOptionsDataSource.getStorageOptions()};e.prototype.getPremiumPurchaseInformation=function(e){var o=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var t=o._parsePremiumPlans(e),r=t[0],i=t[1];return r&&r.pricePerMonth?o._getPurchaseInfo(r,!0,!0):i&&i.pricePerMonth?o._getPurchaseInfo(i,!0,!1):r&&r.pricePerYear?o._getPurchaseInfo(r,!1,!0):i&&i.pricePerYear?o._getPurchaseInfo(i,!1,!1):void 0})};e.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})};e.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,r=e.officePlans;t<r.length;t++){var i=r[t];if(l.PlanType[i.type]===l.PlanType.Home||l.PlanType[i.type]===l.PlanType.Personal||l.PlanType[i.type]===l.PlanType.Solo)for(var o=0,n=i.purchaseActions;o<n.length;o++){var a=n[o];if(1===a.durationInMonths||12===a.durationInMonths)return!0}}}return!1})};e.prototype._getPurchaseInfo=function(e,t,r){return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl,planName:e.type,planType:r?l.PlanType.Personal:l.PlanType.Home}};e.prototype._parsePremiumPlans=function(e){var t,r;if(e&&e.officePlans)for(var i=0,o=e.officePlans;i<o.length;i++){var n=o[i];if(l.PlanType[n.type]!==l.PlanType.Trial){for(var a=0,s=n.purchaseActions;a<s.length;a++){var u=s[a];if(1===u.durationInMonths){n.pricePerMonth=u.price;n.secondaryOfficePlanUrl=u.purchaseUrl}if(12===u.durationInMonths){n.pricePerYear=u.price;n.mainOfficePlanUrl=u.purchaseUrl}}l.PlanType[n.type]===l.PlanType.Home?t=n:r=n}}return[r,t]};e.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,r=e.officePlans;t<r.length;t++){var i=r[t];if(l.PlanType[i.type]===l.PlanType.Home||l.PlanType[i.type]===l.PlanType.Personal||l.PlanType[i.type]===l.PlanType.Solo)for(var o=0,n=i.purchaseActions;o<n.length;o++){var a=n[o];if(1===a.durationInMonths||12===a.durationInMonths)return!0}}return!1}};e.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan};e.prototype._computeIsReady=function(){return!!this._data()};return e}(r.default);t.default=a});define("odsp-next/models/storageOptions/IStorageOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Home=1]="Home";e[e.Personal=2]="Personal";e[e.Solo=3]="Solo";e[e.Trial=4]="Trial";e[e.Storage=5]="Storage"}(t.PlanType||(t.PlanType={}))});define("odsp-next/providers/storageOptions/StorageOptionsRequestor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.storageOptionsData=t.createObservable(null);t._storageOptionsDataSource=t.resources.consume(o.storageOptions);return t}e.prototype.updateStorageOptions=function(e){void 0===e&&(e=!1);if(!e&&this.storageOptionsData.peek())return a.default.wrap(this.storageOptionsData.peek());var t=new n.Qos({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)};e.prototype._storageOptionsHelper=function(t,r){var i=this;if(t<=7)return this._storageOptionsDataSource.getStorageOptions().then(function(e){r.end({resultType:n.ResultTypeEnum.Success,extraData:{retries:t}});i.storageOptionsData(e);return e},function(e){e.data&&159===e.data.code?i.async.setTimeout(function(){i._storageOptionsHelper(t+1,r)},1e3):r.end({resultType:n.ResultTypeEnum.Failure,extraData:{retries:t}})});r.end({resultType:n.ResultTypeEnum.Failure,extraData:{retries:t}})};return e}(r.default);t.default=s});define("odsp-next/providers/moveCopy/MoveCopyProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../item/ItemProvider","../quota/UserStateProvider.key","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemTaskObserver","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../providers/engagement/Engagement","../operation/OperationProvider","../../models/task/Task","../operation/MoveCopyItemsAsyncOperation","../../utilities/features/Features"],function(e,t,r,u,i,o,n,a,l,s,c,d,p,m,f,h,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._itemDataSource=t.itemDataSource;r._itemProvider=t.itemProvider;r._itemTaskObserver=r.scope.attach(new t.itemTaskObserverType);r._moveCopyHelper=new(r.managed(g.default))({moveCopyProvider:r});r._operationProvider=t.operationProvider;r._updateQuota=t.updateQuota;r._engagement=t.engagement;return r}e.prototype.copyItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};e.prototype.moveItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};e.prototype.copyItems=function(e){return this._handleMoveCopyItems(e)};e.prototype.moveItems=function(l){var c=this;return this._handleMoveCopyItems(l).then(function(e){for(var t=[],r={},i=0,o=e.items;i<o.length;i++){(s=o[i]).error||(r[s.id]=!0)}for(var n=0,a=l.items;n<a.length;n++){var s;r[(s=a[n]).id]&&t.push(new h.default(s.key).succeed({item:{key:s.key,parentKey:l.targetKey}}))}if(t.length){var u=c._itemTaskObserver;u.update(t);u.flush()}return e})};e.prototype.moveCopyOperationSuccess=function(e,t,r){for(var i=0,o=t.length;i<o;i++){var n=t[i],a=e.items[i],s=a&&a.error;if(s)this._moveCopyHelper.handleMoveCopyError(s,n);else{if(!e.items)throw new Error("No items returned from MoveCopy API");n.progress.current(1);n.state(c.default.completed)}}this._itemProvider.invalidateItem(r.parentKey);this._itemProvider.invalidateItem(r.targetKey);v.isFeatureEnabled(v.UseItemsScope)&&this.resources.consumeAsync(l.itemInvalidator).then(function(e){e.invalidateItems(r.parentKey)});r.isMove||this._updateQuota(!0);return e};e.prototype._getContext=function(e){return{parentKey:e.targetKey,ignoreListContext:!0,webId:e.webId,siteId:e.siteId}};e.prototype._handleMoveCopyItemsAsync=function(o){var n=this;return this._itemProvider.getItem(this._getContext(o)).then(function(e){var t=new d.default,r=e.item,i=o.items.map(function(e){return n._moveCopyHelper.registerOperation(e,o,r.peek(),null,t)});return n._moveCopyHelper.handleMoveCopyAsyncItems(o,i)})};e.prototype._handleMoveCopyItems=function(n){var a=this,s=this.observables;return this._itemProvider.getItem(this._getContext(n)).then(function(e){var i=new d.default,o=e.item,t=n.items.map(function(e){var t,r={items:[e],parentKey:n.parentKey,targetId:n.targetId,targetKey:n.targetKey,cid:n.cid,group:n.group,isMove:n.isMove,nameConflict:n.nameConflict,taskId:n.taskId,deleteSource:n.deleteSource,isAsync:n.isAsync,overrideLock:n.overrideLock};return t=a._operationProvider.register({name:e.name,type:n.isMove?p.default.moveItems:p.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:o.peek(),source:e.parent},copyItems:{item:e,destination:o.peek(),source:e.parent}},batch:i,actions:{rename:{isAvailable:s.create(!1),execute:function(){a._engagement.logData({name:"MoveCopyItems.Rename.Click"});r.nameConflict=2;t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return r.isAsync?a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t]):a._moveCopyItems(r,[t])}},overwrite:{isAvailable:s.create(!1),execute:function(){a._engagement.logData({name:"MoveCopyItems.Overwrite.Click"});r.nameConflict=1;t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return r.isAsync?a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t]):a._moveCopyItems(r,[t])}},cancel:{isAvailable:s.create(!1),execute:function(){t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.canceled);return u.default.wrap(null)}},moveAnyway:{isAvailable:s.create(!1),execute:function(){r.deleteSource=!0;r.isMove=!1;r.isAsync=!0;t.actions().moveAnyway.isAvailable(!1);t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t])}},moveLockedFile:{isAvailable:s.create(!1),execute:function(){r.overrideLock=!0;t.actions().moveLockedFile.isAvailable(!1);return a.moveItems(r)}}},progress:{minimum:0,maximum:1,current:0}})});a._moveCopyHelper.markAllOperationsAsStarted(t);return a._moveCopyItems(n,t)})};e.prototype._executeMoveCopy=function(e){var t=this._itemDataSource;return e.isMove?t.moveItems(e):t.copyItems(e)};e.prototype._moveCopyItems=function(t,r){var i=this;return this._executeMoveCopy(t).then(function(e){return i.moveCopyOperationSuccess(e,r,t)},function(e){return u.default.wrapError(i._moveCopyHelper.moveCopyOperationFailure(e,r,t))})};e.dependencies=r.__assign({},o.default.dependencies,{itemDataSource:l.items,itemProvider:n.resourceKey,itemTaskObserverType:s.resourceKey,operationProvider:f.resourceKey,updateQuota:a.resourceKey,engagement:m.resourceKey});return e}(o.default);t.default=y;t.resourceKey=new i.ResourceKey({name:e("module").id})});define("odsp-next/providers/operation/MoveCopyItemsAsyncOperation",["require","exports","tslib","../../models/operation/OperationType","../../models/operation/OperationState","../../models/operation/OperationBatch","../../dataSources/item/IGetWorkProgressContext","@ms/odsp-utilities/lib/async/Promise","./OperationProvider","../item/ItemProvider","../../providers/engagement/Engagement","../../models/operation/OperationError","../../controls/commands/Commands.resx","../../controls/operation/monitor/OperationMonitor.resx","../../models/item/ItemType","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-shared/lib/base/BaseModel","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../quota/UserStateProvider.key"],function(r,e,t,c,g,d,p,i,n,a,s,u,l,m,f,v,y,o,b,_,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var x=8,P="InsufficientSpaceAvailable",h=function(o){t.__extends(h,o);function h(e){var t=o.call(this,e)||this,r=t.resources;t._itemDataSource=r.consume(_.items);var i=t._moveCopyDataSource=r.consume(_.copy.optional);t._itemProvider=r.consume(a.resourceKey);t._moveCopyProvider=e.moveCopyProvider;t._operationProvider=r.consume(n.resourceKey);t._bundleLoader=t.resources.consume(b.bundleLoader);t._updateQuota=r.consume(S.resourceKey);t._engagement=t.resources.consume(s.resourceKey);t._pollsForProgressSinceCancel={};t._cancelPromises={};t._cachePromises={};i&&i.getCapabilities().supportsProgressCaching&&t._resumePendingProgress();return t}h.prototype.registerOperation=function(e,t,r,i,o){var n=this;o||(o=new d.default);var a={items:[e],parentKey:t.parentKey,targetId:t.targetId,targetKey:t.targetKey,cid:t.cid,group:t.group,isMove:t.isMove,nameConflict:t.nameConflict,taskId:t.taskId,deleteSource:t.deleteSource,isAsync:t.isAsync},s=this._getKey(t),u=this.observables,l=this._operationProvider.register({name:e.name,type:t.isMove?c.default.moveItems:c.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:r,source:e.parent},copyItems:{item:e,destination:r,source:e.parent,taskId:i}},batch:o,actions:{rename:{isAvailable:u.create(!1),execute:function(){a.nameConflict=2;l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return n.handleMoveCopyAsyncItems(a,[l],i)}},overwrite:{isAvailable:u.create(!1),execute:function(){a.nameConflict=1;l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return n.handleMoveCopyAsyncItems(a,[l],i)}},cancel:{isAvailable:u.create(!0),execute:function(){l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);var e=n._getKey(a),t=n._cachePromises[e]||n._cachePromises[s];return t?t.then(function(e){return n.cancelAsyncOperation(a,l,e.id)}):n.cancelAsyncOperation(a,l,i)}},moveAnyway:{isAvailable:u.create(!1),execute:function(){a.deleteSource=!0;a.isMove=!1;a.isAsync=!0;l.actions().moveAnyway.isAvailable(!1);l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return n.handleMoveCopyAsyncItems(a,[l],i)}},moveLockedFile:{isAvailable:u.create(!1),execute:function(){a.overrideLock=!0;l.actions().moveLockedFile.isAvailable(!1);return n._moveCopyProvider.moveItems(a)}},moveAnywaySchemaMismatch:{isAvailable:u.create(!1),execute:function(){n._engagement.logData({name:"MoveItemsAsync.MoveAnyway.Click"});a.allowSchemaMismatch=!0;l.actions().moveAnywaySchemaMismatch.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return n.handleMoveCopyAsyncItems(a,[l],i)}},moveAnywayVersionLimit:{isAvailable:u.create(!1),execute:function(){n._engagement.logData({name:"MoveItemsAsync.MoveAnywayVersionLimit.Click"});a.allowSmallerVersionLimit=!0;l.actions().moveAnywayVersionLimit.isAvailable(!1);l.actions().cancel.isAvailable(!1);l.state(g.default.started);return n.handleMoveCopyAsyncItems(a,[l],i)}}},progress:{minimum:0,maximum:1,current:0}});l.state(g.default.started);return l};h.prototype.moveCopyOperationFailure=function(e,t,r){if(t)for(var i=0,o=t;i<o.length;i++){var n=o[i];this.handleMoveCopyError(e,n)}return e};h.prototype.handleMoveCopyAsyncItems=function(e,t,r){var a=this;this.markAllOperationsAsStarted(t);return function(r,i,e){if(e){var t={id:e,progress:null,pageStats:null,targetId:null};r.taskId||(r.taskId=e);return a.pollForProgress(t,r,i)}h._activeAsyncTasks[a._getKey(r)]=null;var o,n=a._getKey(r);a._cachePromises[n]=(o=r,a._moveCopyDataSource.copyItemsAsync(o));return a._cachePromises[n].then(function(e){var t=r.items.map(function(e){return e.key});a._progressCache&&a._progressCache.saveJobState(e,t,r.targetKey,r.isMove);r.taskId=e.id;a.pollForProgress(e,r,i);return e},function(e){return a.moveCopyOperationFailure(e,i,r)})}(e,t,r)};h.prototype.pollForProgress=function(e,r,i,o,t){var n=this;if(!e)return null;var a={workItemIds:[e.id],jobInfo:e.jobInfo,type:p.IGetWorkProgressTypes.itemCopy,items:r.items,lastProcessedTime:t};this._progressCache&&(a.progressCache=this._progressCache);var s=function(t){n._itemDataSource.getWorkProgress(t).then(function(e){o&&o(i,e);n._handleGetWorkProgressSuccess(e,i,r,t,s)})};if(i)for(var u=0;u<i.length;u++){var l=i[u];!l.payloads.peek().copyItems.taskId&&e&&e.progress&&(e.progress[u]?l.payloads.peek().copyItems.taskId=e.progress[u]&&e.progress[u].id:l.payloads.peek().copyItems.taskId=e.progress[0]&&e.progress[0].id)}if(e.progress){o&&o(i,e);this._handleGetWorkProgressSuccess(e,i,r,a,s)}else{var c=this.async.setTimeout(function(){s(a)},2e3);h._activeAsyncTasks[this._getKey(r)]=c}};h.prototype.handleMoveCopyError=function(e,t){var r=e.code;t.actions().cancel.isAvailable(!1);t.payloads.peek().copyItems.taskId="";if(1e3===r){t.actions().rename.isAvailable(!0);var i=!0,o=t.payloads.peek();(o.moveItems&&o.moveItems.item||o.copyItems&&o.copyItems.item).type===f.default.Folder&&(i=!1);t.actions().overwrite.isAvailable(i);t.error(new u.default({message:i?m.strings.conflictUploadErrorText:m.strings.conflictUploadFolderWithRenameErrorText}))}else if(-2130575257===r)if(t.payloads().moveItems.item.parentKey===t.payloads().moveItems.destination.key)t.error(new u.default({message:m.strings.sameLocationMoveCopyErrorText}));else{this._engagement.logData({name:"MoveCopyItems.NameConflictError"});if(t.payloads().moveItems.item.type===f.default.Folder){t.actions().rename.isAvailable(!0);t.error(new u.default({message:m.strings.conflictUploadFolderWithRenameErrorText}))}else{t.actions().overwrite.isAvailable(!0);t.actions().rename.isAvailable(!0);t.error(new u.default({message:m.strings.conflictUploadErrorText}))}}else if(-2147213282===r){this._engagement.logData({name:"MoveItemsAsync.SchemaMismatchError"});t.actions().moveAnywaySchemaMismatch.isAvailable(!0);t.error(new u.default({message:m.strings.moveFileFolderSchemaMismatch}))}else if(-2147213278===r){this._engagement.logData({name:"MoveItemsAsync.VersionLimitError"});t.actions().moveAnywayVersionLimit.isAvailable(!0);t.error(new u.default({message:m.strings.moveFileFolderVersionLimit}))}else if(-2147018894===r)e.message&&t.error(new u.default({message:e.message}));else if(2028===r){t.actions().moveAnyway.isAvailable(!0);t.error(new u.default({message:l.strings.moveItemCannotMoveOwnItemIntoMountPointError}))}else if(2029===r){t.actions().moveAnyway.isAvailable(!0);t.error(new u.default({message:l.strings.moveItemCannotMoveSharedItemIntoOwnFolderError}))}else if(9001===r){t.actions().moveLockedFile.isAvailable(!0);t.error(new u.default({message:e.message}))}else if(-2130247142===r){var n=e.message;t.payloads().moveItems.item.type===f.default.Folder&&(t.payloads().moveItems.item.key===t.payloads().moveItems.destination.key?n=m.strings.moveFolderToSameLocationErrorText:0===t.payloads().moveItems.destination.key.indexOf(t.payloads().moveItems.item.key)&&(n=m.strings.moveFolderToOwnSubfolderErrorText));t.error(new u.default({message:n}))}else{var a=m.strings,s=void 0;switch(r){case 3e3:s=y.strings.ItemNotFoundSubText;break;case 1007:s=a.moveFolderToSameLocationErrorText;break;case x:s=a.overQuotaCreateItemErrorText;break;case-2147024816:s=a.conflictCopyFileErrorText;break;case-2147024713:s=a.conflictMoveFileFolderErrorText;break;case-2147213295:s=a.moveCopyIRMNotSupported;break;case-2147213288:s=a.moveCopyObjectsNotSameLevel;break;case-2147213287:s=a.moveCopyTargetIsSubfolder;break;case-2147213294:case-2147213293:s=a.moveFolderDeleteFail;break;case-2147213291:case-2147024684:case-2147213290:s=a.moveFileDeleteFail;break;case-2147213285:s=a.moveCopyPermissionsFail;break;case-2147213284:s=a.moveCopyNoScriptSourceFail;break;case-2147213283:s=a.moveCopyNoScriptTargetFail;break;case-2147213292:case-2147024809:s=a.moveCopyFatalErrorText;break;default:s=e.message}t.error(new u.default({message:"string"==typeof s?s:void 0}))}t.state(g.default.failed)};h.prototype.markAllOperationsAsStarted=function(e){if(e)for(var t=0,r=e;t<r.length;t++){r[t].state(g.default.started)}};h.prototype._handleGetWorkProgressSuccess=function(c,e,t,r,i){var d=!1,p=!1,m=t.taskId;void 0!==this._pollsForProgressSinceCancel[m]&&(this._pollsForProgressSinceCancel[m]+=1);if(e&&c&&c.progress)for(var o=function(e){for(var t=void 0,r=e.payloads.peek(),i=0,o=c.progress;i<o.length;i++){var n=o[i];if(r.copyItems&&n.id===e.payloads.peek().copyItems.taskId&&f._hasMatchingItemIds(e,n)&&e.state.peek()!==g.default.completed&&e.state.peek()!==g.default.failed){t=n;break}}var a=function(){e.progress.current(1);e.actions().cancel&&e.actions().cancel.isAvailable(!1);e.state(g.default.completed);p=!0};if(t){var s=t.error,u=v.ITaskStatuses[t.status];if(u===v.ITaskStatuses.Cancelled||3<=f._pollsForProgressSinceCancel[m]){e.actions().cancel.isAvailable(!1);e.state(g.default.canceled);p=!0}else if(s){t.errorCode===P&&(s.code=x);if(f._progressCache){e.progress.current(0);e.state()!==g.default.failed&&f.handleMoveCopyError(s,e)}else f.handleMoveCopyError(s,e)}else if(u===v.ITaskStatuses.Completed)a();else{var l=e.progress.current.peek();if(t.completedBytes>l){e.progress.current(t.completedBytes);e.progress.maximum(t.totalBytes)}d=!0}f._progressCache&&f._progressCache.updateJobState(m,e,t)}else e.state()!==g.default.failed&&a()},f=this,n=0,a=e;n<a.length;n++){o(a[n])}if(p){this._itemProvider.invalidateItem(t.parentKey);this._itemProvider.invalidateItem(t.targetKey);this._updateQuota()}if(d){var s=this.async.setTimeout(function(){i(r)},2e3);h._activeAsyncTasks[this._getKey(t)]=s}else if(this._progressCache){this._pollsForProgressSinceCancel={};this._progressCache.purgeJobState(m)}};h.prototype._hasMatchingItemIds=function(e,t){var r=e.payloads.peek().copyItems&&e.payloads.peek().copyItems.item;return!t.sourceResourceId||this._moveCopyDataSource.hasMatchingId(t.sourceResourceId,r)};h.prototype.cancelAsyncOperation=function(e,i,t){var o=this,n=t||e.taskId,a=h._activeAsyncTasks[this._getKey(e)];if(!this._cancelPromises[n]){var r={workItemIds:[n]};this._progressCache&&(r.progressCache=this._progressCache);this._cancelPromises[n]=this._itemDataSource.cancelWork(r)}return this._cancelPromises[n].then(function(e){if(o._progressCache){var t=o._progressCache.getCacheData(),r=t&&t[n];if(e||!r){i.state(g.default.canceled);o._progressCache.cancelJobs(n);a&&o.async.clearTimeout(a)}else o._pollsForProgressSinceCancel[n]=0}i.actions().cancel.isAvailable(!1);o._cancelPromises[n]=void 0},function(e){o._cancelPromises[n]=void 0})};h.prototype._getKey=function(e){return e.items.map(function(e){return e.key}).join(",")+e.targetKey};h.prototype._resumePendingProgress=function(){var t=this;this._bundleLoader.queueLoad("odsp-next/providers/operation/MoveCopyAsyncProgressCache",function(){return new i.default(function(e,t){r(["odsp-next/providers/operation/MoveCopyAsyncProgressCache"],e,t)})}).then(function(e){t._progressCache=new(t.managed(e))({moveCopyHelper:t});t._progressCache.resumePendingProgress()})};h._activeAsyncTasks={};return h}(o.default);e.default=h});define("odsp-next/dataSources/item/IGetWorkProgressContext",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IGetWorkProgressTypes={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}});define("odsp-next/dataSources/item/ITaskProgress",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotStarted=0]="NotStarted";e[e.InProgress=1]="InProgress";e[e.Completed=2]="Completed";e[e.Cancelled=3]="Cancelled";e[e.Failed=4]="Failed";e[e.Unknown=5]="Unknown"}(t.ITaskStatuses||(t.ITaskStatuses={}))});define("odsp-next/providers/notification/NotificationProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../models/notification/Notification","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){r.__extends(t,e);function t(){var t=e.call(this)||this;t.handledNotifications={};t._notifications=i.observableArray([]);t._platformDetection=t.resources.consume(a.platformDetection);t.currentNotification=t.createComputed(function(){var e=t._notifications();return e.length&&e[0]||null});return t}t.prototype.requestNotification=function(e){var t=this,r=new n.default(e);if(!this._platformDetection.isIE||9<this._platformDetection.browserMajor){this._notifications.push(r);var i=function(){t._notifications.remove(r)};r.wait().then(i,i)}return r};return t}(o.default);t.default=s});define("odsp-next/models/notification/Notification",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,{})||this;t.text=e.text||"";t.severity=e.severity||0;t.dismissalType=e.dismissalType||2;t.timeout=e.timeout||0;t.action=e.action;t.actionText=e.actionText||"";t.isOpen=t.createObservable(!0);t.state=t.createObservable(1);t.canImplicitDismiss=2===t.dismissalType||3===t.dismissalType;t.showCloseButton=4!==t.dismissalType;var r=new o.default;t.createComputed(function(){var e=t.state();1!==e&&(2===e?r.complete(2):r.cancel())});t._promise=r.getPromise();return t}e.prototype.complete=function(){this.isOpen(!1);this.state(2)};e.prototype.dismiss=function(){this.isOpen(!1);this.state(3)};e.prototype.wait=function(){return this._promise};return e}(i.default);t.default=n});define("odsp-next/dataSources/application/odc/ApplicationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../url/odc/UrlDataSource"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a.default.skyApiBaseUrl+"GetApplicationDetails",u=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getApplicationDetails=function(t){var r=this;return(new o.default).send({apiName:"GetApplicationDetails",url:s+"?"+n.serializeQuery({appId:t.clientId}),requestType:"GET"}).then(function(e){return{userId:r._convertClientIdToUserId(t.clientId),email:null,name:e.name,image:e.logoUrl,profilePage:e.appUrl,entityType:3}})};t.prototype._convertClientIdToUserId=function(e){return parseInt(e,16).toString(10)};return t}(i.default);t.default=u});define("odsp-next/dataSources/storageInfo/odc/StorageInfoDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../base/odc/SkyApiDataRequest","../../item/ItemDataSource.resx","../../../resources/ODCResourceKeys"],function(e,t,r,n,i,a,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o.strings,c=function(t){r.__extends(o,t);function o(){var e=t.call(this)||this;e._urlDataSource=e.resources.consume(u.urlDataSource);return e}o.prototype.getStorageInfo=function(){var t=this;return(new a.default).send({apiName:"GetStorageInfo",url:o._storageInfoUrl}).then(function(e){return e},function(e){return n.default.wrapError(t._getError(e.data.code))})};o.prototype.redeemCode=function(e){var t=new a.default,r=JSON.stringify({token:e.token,trackingGuid:e.trackingGuid});return t.sendPost("RedeemQuotaToken",o._redeemCodeUrl,r).then(function(e){return e=e.items||e.item},function(e){return n.default.wrapError(e.data.message)})};o.prototype.sendInvitation=function(e){var t=this,r=new a.default;if(!e)return null;var i=JSON.stringify({recipients:e.map(function(e){return{RecipientType:0,EmailAddress:e}})});return r.sendPost("SendInvitation",o._sendInvitationUrl,i).then(function(e){return e},function(e){return n.default.wrapError(t._getError(e.data.code).errorTitle)})};o.prototype._getError=function(e,t){var r={errorCode:e,errorDetailedText:"",errorTitle:""};switch(e){case 4102:r.errorTitle=l.InvalidCodeFailedToRedeem;break;default:r.errorTitle=l.DefaultTitle;r.errorDetailedText=l.DefaultSubText}return r};o._storageInfoUrl=s.default.baseUrl+"/API/2/GetStorageInfo?planDetails=true";o._redeemCodeUrl=s.default.baseUrl+"/API/2/RedeemQuotaToken";o._sendInvitationUrl=s.default.baseUrl+"/API/2/SendInvitation";return o}(i.default);t.default=c});define("odsp-next/providers/ticketRedeemer/TicketRedeemerProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,r,o,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.getTicketRedeemerManager=function(){var e=this._urlDataSource.getAppSubfolder(!0);return this._onRequire(e)};e.prototype._onRequire=function(r){return a.loadModule({path:"odsp-next/dataSources/ticketRedeemer/"+r+"/TicketRedeemerManager",getModule:function(){return new o.default(function(e,t){i(["odsp-next/dataSources/ticketRedeemer/"+r+"/TicketRedeemerManager"],e,t)})}})};return e}(r.default);e.default=s});define("odsp-next/dataSources/storageOptions/odc/StorageOptionsDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../base/odc/SkyApiDataRequest","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="GetUpgradeOptions",l=function(t){r.__extends(o,t);function o(){var e=t.call(this)||this;e._navigation=e.resources.consume(s.navigation);return e}o.prototype.getStorageOptions=function(){var e=new n.default,t=this._navigation.viewParams.ctpMkt,r=this._navigation.viewParams.accountid,i=new a.default(o._storageOptionsUrl);i.setQueryParameter("ctpMkt",t,!1);i.setQueryParameter("accountid",r,!1);return e.send({apiName:u,url:i.toString()})};o._storageOptionsUrl=i.default.baseUrl+"/API/2/"+u;return o}(o.default);t.default=l});define("odsp-next/providers/subscriptions/SubscriptionsProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getSubscriptions=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.getSubscriptions(t)})};e.prototype.updateSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.updateSubscription(t)})};e.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})};e.prototype.createRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.createRootSubscription(t)})};e.prototype.updateRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.updateRootSubscription(t)})};e.prototype.deleteRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.deleteRootSubscription(t)})};e.prototype._getSubscriptionsDataSource=function(){var t=this;if(this._subscriptionsDataSource)return i.default.wrap(this._subscriptionsDataSource);if(this.resources.isExposed(n.subscriptions)){this._subscriptionsDataSource=this.resources.consume(n.subscriptions);return i.default.wrap(this._subscriptionsDataSource)}return this.resources.consumeAsync(n.subscriptions).then(function(e){return t._subscriptionsDataSource=e})};return e}(o.default);t.default=a});define("odsp-next/dataSources/subscriptions/vroom/SubscriptionsDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor"],function(e,t,r,o,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._vroomDataRequestor=t.vroomDataRequestor;return r}e.prototype.getSubscriptions=function(e){var t=this;return e.itemId?this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/items/"+e.itemId+"/subscriptions"}).then(function(e){return e.value.map(function(e){return t._translateToSubscriptionModel(e)})}):o.default.wrap([])};e.prototype.updateSubscription=function(e){var t=this,r=new Date;r.setMonth(r.getMonth()+1);var i={notificationUrl:"ActivityService://activity",expirationDateTime:r.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drives/"+e.item.ownerId+"/items/"+e.item.itemId+"/subscriptions",requestType:"POST",postData:JSON.stringify(i)}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.getRootSubscriptions=function(){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(e){return e.value.map(function(e){return t._translateToSubscriptionModel(e)})})};e.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"deleteSubscription",requestType:"DELETE",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0})};e.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}});return t};e.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t};e.dependencies=r.__assign({},n.default.dependencies,{vroomDataRequestor:a.resourceKey});return e}(n.default);t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s)});define("odsp-next/providers/thumbnail/ThumbnailProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/base/vroom/VroomDataRequestor"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=999999,a=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getThumbnails=function(e,t,r){void 0===r&&(r=null);var i=t.map(s).join(",");return this.resources.consume(o.resourceKey).send({apiName:"thumbnails",path:"/drives/"+e.driveId+"/items/"+e.itemId+"/thumbnails?select="+i+(r?"&authkey="+r:""),needsAuthorization:!r})};e.prototype.getThumbnailForLargestDimension=function(e,t,r){return r?this.getThumbnailForSize(e,t,n):this.getThumbnailForSize(e,n,t)};e.prototype.getThumbnailForSize=function(e,t,r){var i="c"+t+"x"+r;return e.value[0][i]};return e}(i.default);t.default=a;function s(e){return"c"+(e.width||n)+"x"+(e.height||n)}});define("odsp-next/dataSources/instrumentation/odc/InstrumentationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../dataSources/url/PageType"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._navigation=t.resources.consume(o.navigation);return t}e.prototype.getEngagementData=function(e){if(e===n.default[n.default.StorageOptions])return{purchaseSource:this._navigation.viewParams["WT.mc_id"]}};e.prototype.userClickItem=function(e){};return e}(r.default);t.default=a});define("odsp-next/dataSources/encoding/odc/EncodingDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.getEncoding=function(){return"undefined"!=typeof FilesConfig&&FilesConfig&&FilesConfig.defaultCodePage?FilesConfig.defaultCodePage:null};return e}();t.default=r});define("odsp-next/dataSources/videoItem/odc/VideoItemDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./VideoItemDataSource",getModule:function(){return new t.default(function(e,t){r(["./VideoItemDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/providers/bundleLoader/BundleLoaderProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/BaseModel","./BundleQueue","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/performance/PerformanceCollection","./DeferredResourceContext","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../utilities/logging/AppQos"],function(e,t,r,o,n,i,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.isPageLoaded=t.observables.create(!1);t.isPageRenderingComplete=t.observables.create(!1);t._queue=new a.default;t._pltSignal=new n.default;t._renderingCompleteSignal=new n.default;if(t.resources.isExposed(s.bundle)){var r=t.resources.consume(s.bundle);t._bundles=r.getBundles()}else t._bundles={};return t}e.prototype.pageLoaded=function(e){var t=this;if(!this._queue.hasStarted){this._queue.start();if(e){u.default.plt(e);c.default.logData({name:"PageLoad",scenario:"PageLoad",currentPage:e})}d.logSuccess();this.isPageLoaded(!0);this.async.setImmediate(function(){return t._pltSignal.complete()})}};e.prototype.pageRenderingIsComplete=function(e){var t=this;if(e){u.default.plt(e);c.default.logData({name:"PageRenderingIsComplete",scenario:"PageRenderingIsComplete",currentPage:e})}this.isPageRenderingComplete(!0);this.async.setImmediate(function(){return t._renderingCompleteSignal.complete()})};e.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)};e.prototype.queueBundle=function(e,t){var r=this.getBundleInfo(e);this.queueLoad(r.path,t).then(function(){r.isLoaded(!0)})};e.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),r=new(this.managed(l.default))({});t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){r.finishedProcessing.then(function(){t.isLoaded(!0)});r.isLoaded(!0)});return r};e.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)};e.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)};e.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];if(!t){t={path:"",getModule:function(){return o.default.as(void 0)},isLoaded:this.createObservable(!1)};this._bundles[e]=t}return t}};e.prototype.waitForPLT=function(){return this._pltSignal.getPromise()};e.prototype.waitForPageRenderingComplete=function(){return this._renderingCompleteSignal.getPromise()};return e}(i.default);t.default=p});define("odsp-next/providers/bundleLoader/BundleQueue",["require","exports","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,r,i,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[1,0],s=new r.default,l=function(){function e(){this._started=!1;this._done=!1;this._bundleGroups={};this._queuedBundles=[]}Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!0,configurable:!0});e.prototype.start=function(){var e=this;if(!this._started){this._started=!0;s.setTimeout(function(){return e._next()},1e3)}};e.prototype.queueLoad=function(e,t,r){if("undefined"==typeof __webpack_public_path__){var i=this._getGroup(e,r),o=this._generateModuleRequest(i,e,t,r);this._queueBundle(i);return o.signal.getPromise()}return n.loadModule({path:e,getModule:r})};e.prototype.waitFor=function(e,t){if("undefined"==typeof __webpack_public_path__){var r=this._getGroup(e,t);return this._generateModuleRequest(r,e,0,t).signal.getPromise()}return n.loadModule({path:e,getModule:t})};e.prototype.loadNow=function(e,t){if("undefined"==typeof __webpack_public_path__){var r=this._getGroup(e,t),i=this._generateModuleRequest(r,e,0,t);r.isResolved||this._requestBundle(r).done();return i.signal.getPromise()}return n.loadModule({path:e,getModule:t})};e.prototype._getGroup=function(e,t){var r=window.require.toUrl(e),i=this._bundleGroups[r];if(!i){i=this._createGroup(e,r,t);this._bundleGroups[r]=i}return i};e.prototype._createGroup=function(e,t,r){var i=window.require.specified(t),o={bundleUrl:t,requestedPath:e,getModule:r,modules:i?null:{},isResolved:i,isQueued:!1};if(!i)for(var n=0,a=u;n<a.length;n++){var s=a[n];o.modules[s]=[]}return o};e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new i.default,isResolved:!1}};e.prototype._addNewModule=function(e,t,r,i){var o=this._createModuleRequest(t,i);e.modules[r].push(o);return o};e.prototype._generateModuleRequest=function(e,t,r,i){var o;if(e.isResolved){o=this._createModuleRequest(t,i);this._resolveModule(o)}else o=this._addNewModule(e,t,r,i);return o};e.prototype._queueBundle=function(e){if(!e.isQueued){this._queuedBundles.push(e);e.isQueued=!0;if(this._done){this._done=!1;this._next()}}};e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var r=this._requestBundle(t);r&&r.then(function(){s.setTimeout(function(){return e._next()},500)}).done()}}};e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0;return null};e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return a.default.wrap();for(var r=[],i=0,o=e.modules[t];i<o.length;i++){var n=o[i];this._resolveModule(n);r.push(n.signal.getPromise())}return a.default.all(r).then(function(e){return null},function(){return null})};e.prototype._processBundle=function(r){for(var i=this,e=function(e,t){return t.then(function(){return i._processBundlePriorityLevel(r,e)})},t=a.default.wrap(),o=0,n=u;o<n.length;o++){t=e(n[o],t)}return t.then(function(){r.isResolved=!0;r.modules=null})};e.prototype._requestBundle=function(t){var e=this,r=new o.Qos({name:"DeferredBundleLoad"});return n.loadModule({path:t.requestedPath,getModule:t.getModule}).then(function(){r.end({resultType:o.ResultTypeEnum.Success,extraData:{path:t.requestedPath,url:t.bundleUrl}});return e._processBundle(t)},function(e){r.end({resultType:o.ResultTypeEnum.Failure,error:e,extraData:{path:t.requestedPath,url:t.bundleUrl}})})};e.prototype._resolveModule=function(t){t.isResolved=!0;t.path&&n.loadModule({path:t.path,getModule:t.getModule}).then(function(e){t.signal.complete(e)})};return e}();t.default=l});define("odsp-next/providers/bundleLoader/DeferredResourceContext",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/modules/ModuleLoader"],function(e,t,i,o,n,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._resources=[];t._finished=new o.default;t.finishedProcessing=t._finished.getPromise();t.isLoaded=t.createObservable(!1);t.createBackgroundComputed(t._computeShouldProcess);return t}e.prototype.expose=function(e,t,r){this._resources.push({key:e,path:t,getModule:r});this.isLoaded.peek()&&this._processResources()};e.prototype._processResources=function(){for(var e=this,t=n.default.wrap(),r=0,i=this._resources;r<i.length;r++){var o=i[r];t=this._processResource(t,o)}t.then(function(){e._resources.length=0;e._finished.complete()})};e.prototype._processResource=function(e,r){var i=this;return e.then(function(){return s.loadModule({path:r.path,getModule:r.getModule}).then(function(t){try{var e=new(i.managed(t))({});i.resources.expose(r.key,e)}catch(e){a.default.logError(e,{rawResult:"("+typeof t+"): "+t,resourceKey:"("+r.key.id+"): "+r.key.name})}})})};e.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()};return e}(r.default);t.default=u});define("odsp-next/utilities/logging/AppQos",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;function o(e){if(!i){var t=e||{name:"App"};i=new r.Qos(t)}return i}t.init=o;t.restart=function(){i=void 0;return o()};t.reset=function(){i=void 0};t.logSuccess=function(e){i||o();i.end(e||{resultType:r.ResultTypeEnum.Success})};t.logUnexpectedFailure=function(e){i||o();i.end(e||{resultType:r.ResultTypeEnum.Failure})};t.logExpectedFailure=function(e){i||o();i.end(e||{resultType:r.ResultTypeEnum.ExpectedFailure})};t.logEndData=function(e){i||o();e&&i.end(e)}});define("odsp-next/dataSources/upsell/odc/UpsellDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getUpsellFromOneRm=function(e){var t=new n.default,r=new a.Qos({name:this.getMarketingRequestApiId()}),i={url:e,apiName:"OneRM",returnRawXHR:!0,useDefaultHeaders:!0};return t.send(i).then(function(e){var t;try{t=e&&e.response&&JSON.parse(e.response)}catch(e){}t?2===t.ContentType?r.end({resultType:s.ResultTypeEnum.ExpectedFailure}):0===t.ContentType?r.end({resultType:s.ResultTypeEnum.Success}):r.end({resultType:s.ResultTypeEnum.Failure}):r.end({resultType:s.ResultTypeEnum.Failure});return t},function(e){r.end({resultType:s.ResultTypeEnum.Failure});return o.default.wrapError(e)})};e.prototype.getMarketingRequestApiId=function(){return"SkyDriveWeb_Internal_Control_FirstRunView_MarketingRequest"};return e}(i.default);t.default=u});define("odsp-next/providers/upsell/UpsellProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._upsellDataSource=t.resources.consume(o.upsell);return t}e.prototype.getUpsellFromOneRm=function(e){return this._upsellDataSource.getUpsellFromOneRm(e)};e.prototype.getMarketingRequestApiId=function(){return this._upsellDataSource.getMarketingRequestApiId()};return e}(r.default);t.default=n});define("odsp-next/actions/odc/ActionMap",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../BaseActionMap","./AddCoverPhotoAction","../addToAlbum/odc/AddToAlbumAction","../ChangeFolderTypeAction","../ClearSelectionAction","./CreateDocumentAction","../createFolder/odc/CreateFolderAction","./CreateMountPointAction","./DefaultClickAction","../delete/odc/DeleteAction","../download/odc/DownloadAction","../editTags/odc/EditTagsAction","../embed/odc/EmbedAction","../emptyRecycleBin/odc/EmptyRecycleBinAction","../feedback/odc/FeedbackAction","../LanguagePickerAction","../navigateToItem/NavigateToItemAction","../NavigationAction","../sort/od/OneDriveSortAction","./OpenAction","../preview/PreviewAction","./OpenInOfficeClientAction","../OpenPdfInBrowserAction","./OpenInOfficeOnlineAction","../openInTextEditor/OpenInTextEditorAction","../orderPrints/odc/OrderPrintsAction","./PlayAudioAction","./PlaySlideShowAction","./StopSlideShowAction","./RemoveCoverPhotoAction","./RemoveFromRecentAction","./RemoveTagAction","../rename/odc/RenameAction","../restore/RestoreAction","../restoreAll/odc/RestoreAllAction","../rotate/RotateAction","./SaveSortOrderAction","../SetFocusAction","../shareByLink/odc/ShareByLinkAction","../showKeyboardMap/ShowKeyboardMapAction","../showOperations/ShowOperationsAction","../showPermissions/ShowPermissionsAction","../ShowPropertiesAction","../ShowSelectionAction","../sort/SortAction","../toggleListLayout/odc/ToggleListLayoutAction","../viewOriginal/ViewOriginalAction","./UploadAction","./UpdateCaptionAction","./SurveyAction","./AddToSharedListAction","../removeFromSharedList/odc/RemoveFromSharedListAction","../addToBundle/odc/AddToBundleAction","./RemoveFromBundleAction","../reportAbuse/odc/ReportAbuseAction","./RemoveMountPointAction","../requestReview/odc/RequestReviewAction","./ViewInFolderAction","./SignOutAction","../ToggleDebugWindowAction","./RemoveFromAlbumAction","../addPhotosToAlbum/AddPhotosToAlbumAction","../createAlbum/CreateAlbumAction","../SelectAction","../SelectAllAction","../FilterSearchAction","../RemoveTagFromItemAction","../setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction","../setPhotosRoot/odc/SetPhotosRootAction","../FilterSearchByDateAction","../launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction","./AutoExecuteAction","../toggleSelectionMode/ToggleSelectionModeAction","../redeemCode/odc/RedeemCodeAction","../save/odc/SaveAction","../redeem/odc/RedeemAction","../base/LazyLoadedAction","../switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction","../createAlbumFromFolder/odc/CreateAlbumFromFolderAction","./VersionHistoryAction","./RearrangeAction","../applyOfficeLens/odc/ApplyOfficeLensAction","../removeOfficeLens/odc/RemoveOfficeLensAction","../base/OverrideAction","../printPdf/odc/PrintPdfAction","../saveAutoAlbum/odc/SaveAutoAlbumAction","../discardAutoAlbum/odc/DiscardAutoAlbumAction","../saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction"],function(o,e,t,n,r,a,s,u,l,c,d,p,m,f,h,g,v,y,b,_,S,x,P,I,w,A,T,k,C,D,E,L,O,R,M,F,N,U,B,H,K,q,V,G,j,z,W,Q,$,X,J,Y,Z,ee,te,re,ie,oe,ne,ae,se,ue,le,ce,de,pe,me,fe,he,ge,ve,ye,be,_e,Se,xe,Pe,Ie,we,Ae,Te,ke,Ce,De,Ee,Le,Oe,Re,Me,Fe,Ne,Ue){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(i){t.__extends(e,i);function e(){var e=i.call(this)||this,t=Te.default.create("odsp-next/actions/uploadBlock/odc/UploadBlockAction",function(){return new n.default(function(e,t){o(["odsp-next/actions/uploadBlock/odc/UploadBlockAction"],e,t)})}),r=Te.default.create("odsp-next/actions/uploadBlock/odc/WacEditBlockAction",function(){return new n.default(function(e,t){o(["odsp-next/actions/uploadBlock/odc/WacEditBlockAction"],e,t)})});e.AddCoverPhotoAction=a.default;e.AddPhotosToAlbumAction=pe.default;e.AddToAlbumAction=s.default;e.AddToBundleAction=ie.default;e.AddToSharedListAction=te.default;e.ApplyOfficeLensAction=Le.default;e.AutoExecuteAction=xe.default;e.ChangeFolderTypeAction=u.default;e.ClearSelectionAction=l.default;e.CreateAlbumAction=me.default;e.CreateAlbumFromFolderAction=Ce.default;e.CreateDocumentAction=Re.default.create(c.default,t);e.CreateFolderAction=d.default;e.CreateNewFolderAction=Te.default.create("odsp-next/actions/createNewFolder/odc/CreateNewFolderAction",function(){return new n.default(function(e,t){o(["odsp-next/actions/createNewFolder/odc/CreateNewFolderAction"],e,t)})});e.CreateMountPointAction=p.default;e.DefaultClickAction=m.default;e.DeleteAction=f.default;e.DiscardAutoAlbumAction=Ne.default;e.DownloadAction=h.default;e.DownloadOfficeAction=Te.default.create("odsp-next/actions/downloadOffice/odc/DownloadOfficeAction",function(){return new n.default(function(e,t){o(["odsp-next/actions/downloadOffice/odc/DownloadOfficeAction"],e,t)})});e.EditTagsAction=g.default;e.EmbedAction=v.default;e.EmptyRecycleBinAction=y.default;e.FeedbackAction=b.default;e.FilterSearchAction=ge.default;e.FilterSearchByDateAction=_e.default;e.ImplicitSaveAutoAlbumAction=Ue.default;e.LanguagePickerAction=_.default;e.LaunchMoveCopyPanelAction=Se.default;e.MoveCopyAction=Te.default.create("odsp-next/actions/moveCopy/odc/MoveCopyAction",function(){return new n.default(function(e,t){o(["odsp-next/actions/moveCopy/odc/MoveCopyAction"],e,t)})});e.NavigateToItemAction=S.default;e.NavigationAction=x.default;e.OneDriveSortAction=P.default;e.OpenAction=I.default;e.PreviewAction=w.default;e.OpenInOfficeClientAction=A.default;e.OpenPdfInBrowserAction=T.default;e.OpenInOfficeOnlineAction=Re.default.create(k.default,r);e.OpenInTextEditorAction=C.default;e.OrderPrintsAction=D.default;e.PlayAudioAction=E.default;e.PlaySlideShowAction=L.default;e.PrintPdfAction=Me.default;e.RearrangeAction=Ee.default;e.RedeemAction=Ae.default;e.RedeemCodeAction=Ie.default;e.RemoveCoverPhotoAction=R.default;e.RemoveFromAlbumAction=de.default;e.RemoveFromBundleAction=oe.default;e.RemoveFromRecentAction=M.default;e.RemoveFromSharedListAction=re.default;e.RemoveMountPointAction=ae.default;e.RemoveOfficeLensAction=Oe.default;e.RemoveTagAction=F.default;e.RemoveTagFromItemAction=ve.default;e.RenameAction=N.default;e.ReportAbuseAction=ne.default;e.RequestReviewAction=se.default;e.RestoreAction=U.default;e.RestoreAllAction=B.default;e.RotateAction=H.default;e.SaveAction=we.default;e.SaveAutoAlbumAction=Fe.default;e.SaveSortOrderAction=K.default;e.SelectAction=fe.default;e.SelectAllAction=he.default;e.SetAlbumCoverPhotoAction=ye.default;e.SetFocusAction=q.default;e.SetPhotosRootAction=be.default;e.ShareByLinkAction=V.default;e.ShowKeyboardMapAction=G.default;e.ShowOperationsAction=j.default;e.ShowPermissionsAction=z.default;e.ShowPropertiesAction=W.default;e.ShowSelectionAction=Q.default;e.ShowVersionHistoryAction=De.default;e.SignOutAction=le.default;e.SortAction=$.default;e.StopSlideShowAction=O.default;e.SurveyAction=ee.default;e.SwitchPhotoFolderLayoutTypeAction=ke.default;e.ToggleDebugWindowAction=ce.default;e.ToggleListLayoutAction=X.default;e.ToggleSelectionModeAction=Pe.default;e.UpdateCaptionAction=Z.default;e.UploadAction=Re.default.create(Y.default,t);e.UploadBlockAction=t;e.ViewInFolderAction=ue.default;e.ViewOriginalAction=J.default;return e}return e}(r.default);e.default=i});define("odsp-next/actions/BaseActionMap",["require","exports","./UnsupportedAction"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){this.AddCoverPhotoAction=r.default;this.AddExistingAppViewAction=r.default;this.AddFlowAction=r.default;this.AddPhotosToAlbumAction=r.default;this.AddToAlbumAction=r.default;this.AddToBundleAction=r.default;this.AddToQuickLaunchAction=r.default;this.AddToSharedListAction=r.default;this.AddToSpotlightAction=r.default;this.AlertAction=r.default;this.ApplyOfficeLensAction=r.default;this.ApproveRejectAction=r.default;this.AuthenticationPolicyWarningAction=r.default;this.AutoExecuteAction=r.default;this.CancelEditAction=r.default;this.ChangeAppViewVisibilityAction=r.default;this.ChangeFolderTypeAction=r.default;this.CheckInAction=r.default;this.CheckOutAction=r.default;this.ClearFilterAction=r.default;this.ClearSelectionAction=r.default;this.ComplianceDetailsAction=r.default;this.ContentTypeNavigationAction=r.default;this.LaunchConfigureFlowsPanelAction=r.default;this.CopyFieldAction=r.default;this.CopyFormAction=r.default;this.CreateAlbumAction=r.default;this.CreateAlbumFromFolderAction=r.default;this.CreateAppViewAction=r.default;this.CreateColumnAction=r.default;this.CreateCustomDocumentAction=r.default;this.CreateDocumentAction=r.default;this.CreateFileRequestAction=r.default;this.CreateFolderAction=r.default;this.CreateItemAction=r.default;this.CreateMountPointAction=r.default;this.CreateNewFolderAction=r.default;this.CreateSitePageAction=r.default;this.CustomActionNavigationAction=r.default;this.CustomizeFormsNavigationAction=r.default;this.CustomizeViewAction=r.default;this.DefaultClickAction=r.default;this.DeleteAction=r.default;this.DeleteTemplateAction=r.default;this.DeleteAppAction=r.default;this.DeleteViewAction=r.default;this.DiscardAutoAlbumAction=r.default;this.DownloadAction=r.default;this.DownloadOfficeAction=r.default;this.DownloadZipContentsAction=r.default;this.EditAction=r.default;this.EditItemAction=r.default;this.EditItemCancelAction=r.default;this.EditItemSaveAction=r.default;this.EditNewAppViewAction=r.default;this.EditNewMenuAction=r.default;this.EditNewMenuPaneAction=r.default;this.EditRenditionsAction=r.default;this.EditTagsAction=r.default;this.EmbedAction=r.default;this.EmptyRecycleBinAction=r.default;this.ExportListAction=r.default;this.ExternalNavigateAction=r.default;this.FeedbackAction=r.default;this.FileHandlerOpenAction=r.default;this.FilterAction=r.default;this.FilterSearchAction=r.default;this.FilterSearchByDateAction=r.default;this.GetLinkAction=r.default;this.GroupItemsAction=r.default;this.ImplicitSaveAutoAlbumAction=r.default;this.InvokeFirstRunExperienceAction=r.default;this.LanguagePickerAction=r.default;this.LaunchChangeTheLookPanelAction=r.default;this.LaunchColumnManagementPanelAction=r.default;this.LaunchCreateAppViewPanelAction=r.default;this.LaunchCreateGroupPanelAction=r.default;this.LaunchCreateShortcutPanel=r.default;this.LaunchFilterPanelAction=r.default;this.LaunchFormatViewPaneAction=r.default;this.LaunchGroupMembershipPanelAction=r.default;this.LaunchListCreationPanelAction=r.default;this.LaunchListFormAction=r.default;this.LaunchMoveCopyPanelAction=r.default;this.LaunchSitePermissionsPanelAction=r.default;this.LaunchSiteSettingsPanelAction=r.default;this.MakeHomepageAction=r.default;this.ModifyColumnAction=r.default;this.ModifyShowInFiltersPaneAction=r.default;this.MoveCopyAction=r.default;this.MoveLeftSpotlightAction=r.default;this.MoveRightSpotlightAction=r.default;this.NavigateToItemAction=r.default;this.NavigateToSharePointHomeAction=r.default;this.NavigationAction=r.default;this.OneDriveSortAction=r.default;this.OpenAction=r.default;this.OpenAppAction=r.default;this.OpenHyperlinkAction=r.default;this.OpenInExplorerAction=r.default;this.OpenInfoPathAction=r.default;this.OpenInOfficeClientAction=r.default;this.OpenInOfficeOnlineAction=r.default;this.OpenInSharePointAction=r.default;this.OpenInTextEditorAction=r.default;this.OpenNavLinkAction=r.default;this.OpenNeedsAttentionViewAction=r.default;this.OpenPdfInBrowserAction=r.default;this.OpenInPowerBIAction=r.default;this.OpenShortcutAction=r.default;this.OpenSiteAction=r.default;this.OrderPrintsAction=r.default;this.PinToMruAction=r.default;this.PlayAudioAction=r.default;this.PlaySlideShowAction=r.default;this.PolicyTipAction=r.default;this.PreviewAction=r.default;this.PrintPdfAction=r.default;this.PublishAction=r.default;this.RearrangeAction=r.default;this.RedeemAction=r.default;this.RedeemCodeAction=r.default;this.RemoveCoverPhotoAction=r.default;this.RemoveFromAlbumAction=r.default;this.RemoveFromBundleAction=r.default;this.RemoveFromRecentAction=r.default;this.RemoveFromSharedListAction=r.default;this.RemoveFromSpotlightAction=r.default;this.RemoveMountPointAction=r.default;this.RemoveOfficeLensAction=r.default;this.RemoveTagAction=r.default;this.RemoveTagFromItemAction=r.default;this.RenameAction=r.default;this.RenameColumnAction=r.default;this.ReportAbuseAction=r.default;this.RequestReviewAction=r.default;this.RestoreAction=r.default;this.RestoreAllAction=r.default;this.RestoreFilesAction=r.default;this.RotateAction=r.default;this.SaveAction=r.default;this.SaveAutoAlbumAction=r.default;this.SaveSortOrderAction=r.default;this.SaveViewAction=r.default;this.SelectAction=r.default;this.SelectAllAction=r.default;this.SetAlbumCoverPhotoAction=r.default;this.SetDefaultViewAction=r.default;this.SetFocusAction=r.default;this.SetPhotosRootAction=r.default;this.SetUpApprovalFlowAction=r.default;this.SetUpReminderFlowAction=r.default;this.ShareAction=r.default;this.ShareByLinkAction=r.default;this.ShowExistingFlowsAction=r.default;this.ShowFiltersAction=r.default;this.ShowItemAnalyticsAction=r.default;this.ShowKeyboardMapAction=r.default;this.ShowMalwareDetectedAction=r.default;this.ShowOperationsAction=r.default;this.ShowPermissionsAction=r.default;this.ShowPropertiesAction=r.default;this.ShowSelectionAction=r.default;this.ShowVersionHistoryAction=r.default;this.SignOutAction=r.default;this.StopSlideShowAction=r.default;this.SurveyAction=r.default;this.SwitchPhotoFolderLayoutTypeAction=r.default;this.SwitchSharingLinkAction=r.default;this.SwitchViewAction=r.default;this.SyncAction=r.default;this.SynchronizeAppViewAction=r.default;this.LaunchTeamChannelAction=r.default;this.ToggleAction=r.default;this.ToggleDebugWindowAction=r.default;this.ToggleListLayoutAction=r.default;this.ToggleSelectionModeAction=r.default;this.TriggerFlowAction=r.default;this.TriggerFlowByIdAction=r.default;this.TriggerSignoffFlowAction=r.default;this.UndoCheckOutAction=r.default;this.UnPublishAction=r.default;this.UpdateCaptionAction=r.default;this.UpdatePermissionsAction=r.default;this.UploadAction=r.default;this.UploadTemplateAction=r.default;this.UploadBlockAction=r.default;this.ViewInFolderAction=r.default;this.ViewItemAction=r.default;this.ViewOriginalAction=r.default;this.WorkflowAction=r.default};t.default=i});define("odsp-next/actions/UnsupportedAction",["require","exports","tslib","../base/BaseAction"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="Unsupported";return e}e.prototype.onIsAvailable=function(){return!1};return e}(i.default);t.default=o});define("odsp-next/actions/odc/AddCoverPhotoAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/QueryType","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys","../base/ItemRedeemer","../../providers/item/ItemProvider"],function(e,t,i,r,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="AddCoverPhotoAction";t._itemReedemer=new(t.managed(u.default));t._itemCommandHelper=new(t.managed(a.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,s.addAsCoverPhoto)&&t.queryType!==n.default.Search&&t.queryType!==n.default.SharedWithMe};e.prototype.onSelectionExecute=function(r,e,t){var i=this;return this._itemReedemer.redeemItems(r,this).then(function(){var e=i.resources.consume(l.resourceKey),t=r[0].parent;return e.addCoverPhotos({items:r,target:t}).then(function(){return{resultType:o.ResultTypeEnum.Success}})})};return e}(r.default);t.default=c});define("odsp-next/base/BaseSelectionAction",["require","exports","tslib","./BaseItemAction","../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/selection/SelectionHelper"],function(e,t,r,i,u,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(s){r.__extends(e,s);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=s.call(this,e,t)||this;r.canFallbackToParent=!1;r.isSingleSelectAction=!1;if(!e||void 0===e.item){var i=t.itemSetSelectionModel,o=void 0===i?r.resources.consume(u.itemsSelection):i,n=t.selectionHelper,a=void 0===n?r.resources.consume(l.resourceKey):n;r.selectionModel=o;r._selectionHelper=a}return r}e.prototype.getCurrentSelection=function(){var e=this.selectionModel,t=e?e.selection():[];0===t.length&&(this.canFallbackToParent||this.isItemSpecified)&&(t=[this.item]);return t};e.prototype.onIsAvailable=function(){var e=this.getCurrentSelection(),t=this.isSingleSelectAction&&1===e.length||!this.isSingleSelectAction&&0<e.length;return s.prototype.onIsAvailable.call(this)&&t&&this._getIsAvailableFromSelection(e)};e.prototype.onSelectionIsAvailable=function(e,t){return!0};e.prototype.onExecute=function(t,r){var i=this;return(this.selectionModel?this._selectionHelper.resolveSelection():o.default.wrap([])).then(function(e){if(e){0===e.length&&(i.canFallbackToParent||i.isItemSpecified)&&(e=[i.item.peek()]);return i.onSelectionExecute(e,t,r)}})};e.prototype.onSelectionExecute=function(e,t,r){return o.default.wrap({resultType:n.ResultTypeEnum.Failure})};e.prototype._getIsAvailableFromSelection=function(e){for(var t=!0,r=0,i=e;r<i.length;r++){var o=i[r],n=this.unwrapObservable(o);if(!n)break;if(!this.onSelectionIsAvailable(e.length,n)){t=!1;break}}return t};e.resources=r.__assign({},i.default.dependencies,{itemSetSelectionModel:u.itemsSelection.optional,selectionHelper:l.resourceKey.optional});return e}(i.default);t.default=a});define("odsp-next/base/BaseItemAction",["require","exports","tslib","./BaseAction","../resources/ControlResourceKeys","../models/item/ItemParentHelper"],function(e,t,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=o.call(this,e,t)||this,i=e.item;r.isItemSpecified=!!i;r.item=i||t.currentItem||r.resources.consume(n.currentItem);r.itemParentHelper=t.itemParentHelper||r.resources.consume(a.resourceKey);return r}e.prototype.onIsAvailable=function(){return!!this.item()};e.prototype.getParent=function(e,t,r){var i=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return r?this.peekUnwrapObservable(i):this.unwrapObservable(i)};e.dependencies=r.__assign({},i.default.dependencies,{currentItem:n.currentItem.optional,itemParentHelper:a.resourceKey});return e}(i.default);t.default=o});define("odsp-next/models/item/ItemParentHelper",["require","exports","../store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getFacetedAncestorOrSelf=function(e,t){return this.getAncestorOrSelf(e,function(e){return!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var r;e;){var i=this._itemsStore.getItem(e.key),o=i&&i.peek();if(!o)break;if(t(o)){r=i;break}e=e.parent}return r};e.dependencies={itemsStore:r.resourceKey};return e}();t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});define("odsp-next/utilities/selection/SelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../controls/commands/Commands.resx","./SelectionHelper.resx","../../utilities/icons/Icon","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,o,n,a,s,u,l,c,d,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._dialogProvider=t.dialogProvider;r._promiseTracker=t.promiseTracker;r._itemSetSelectionModel=t.itemSetSelectionModel;return r}e.prototype.resolveSelection=function(){var t,e,r=this.createObservable(l.strings.resolveDescription),i=this.createObservable(!0),o=this.createObservable(!1),n=this._shouldShowDialog();if(this._itemSetSelectionModel){e=this._itemSetSelectionModel.resolveSelection().then(function(e){n=!1;t&&t.state(2);return e},function(e){if(t){r(l.strings.resolveError);i(!1);o(!0)}return s.default.wrapError(e)});n&&(t=this._createDialog(r,i,o)).wait().done(void 0,function(){e.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(e)}else e=s.default.wrap([]);return e};e.prototype._createDialog=function(e,t,r){return this._dialogProvider.requestDialog({title:l.strings.resolveTitle,isDismissable:!1,component:{name:a.default.tagName,params:{text:e}},actions:[{name:u.strings.cancelActionText,execute:function(){return s.default.wrap(3)},isVisible:t,icon:new c.default("Cancel"),isDefault:!0},{name:u.strings.ok,execute:function(){return s.default.wrap(3)},isVisible:r,icon:new c.default("Cancel"),isDefault:!0}]})};e.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var r=t[e];if(!this.peekUnwrapObservable(r))return!0}return!1};e.dependencies=r.__assign({},o.default.dependencies,{dialogProvider:n.resourceKey,promiseTracker:d.promiseTracker.optional,itemSetSelectionModel:d.itemsSelection});return e}(o.default);t.default=m;t.getSelectedItemApp=function(e){var t=e.selection();if(1===t.length)return i.unwrap(t[0]).appMap};t.resourceKey=p.createResolvedResourceKey(e("module").id,m)});define("odsp-next/actions/base/ItemCommandHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/itemCommand/ItemCommandProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){r.__extends(e,n);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=n.call(this,e,t)||this,i=t.itemCommandProvider,o=void 0===i?r.resources.consume(a.resourceKey):i;r._itemCommandProvider=o;return r}e.prototype.isCommandSupported=function(e,t){var r=this._itemCommandProvider;return!r||!!r.getCommand(e,t)};e.prototype.getCommandBehavior=function(e,t){var r=this._itemCommandProvider,i=r&&r.getCommand(e,t);return i&&i.behavior};e.dependencies=r.__assign({},i.default.dependencies,{itemCommandProvider:a.resourceKey});return e}(i.default);t.default=n;t.resourceKey=o.createResolvedResourceKey(e("module").id,n)});define("odsp-next/providers/itemCommand/ItemCommandProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e)||this;r._commandDataSource=t.itemCommandDataSource;return r}e.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};e.dependencies=r.__assign({},o.default.dependencies,{itemCommandDataSource:n.itemCommand});return e}(o.default);t.default=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});define("odsp-next/models/item/command/CustomizationItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromRecent=new r.default("removeFromRecent");t.rearrange=new r.default("rearrange");t.addAsCoverPhoto=new r.default("addCoverPhoto");t.removeAsCoverPhoto=new r.default("removeCoverPhoto")});define("odsp-next/models/item/command/ItemCommandKey",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(e){this.id=""+ ++t._lastId;this.name=e}t.prototype.matches=function(e){return e===this};t._lastId=0;return t}();t.default=r});define("odsp-next/actions/base/ItemRedeemer",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ProviderResourceKeys"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._ticketRedeemer=t.resources.consume(a.ticketRedeemer.optional);return t}e.prototype.redeemItem=function(e,t,r){return this.redeemItems([e],t,r)};e.prototype.redeemItems=function(e,t,r){return this._ticketRedeemer&&(this._doAnyItemsNeedRedemption(e)||r)?this._startTokenRedemption(t,e[0]):o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype._doAnyItemsNeedRedemption=function(e){if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.tokenNeedsRedeeming)return!0}return!1};e.prototype._startTokenRedemption=function(t,r){return this._ticketRedeemer.getTicketRedeemerManager().then(function(e){return e.startRedeem(t,r)},function(e){return o.default.wrapError({})})};return e}(r.default);t.default=s});define("odsp-next/actions/addToAlbum/odc/AddToAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/DataSourceResourceKeys","../../../providers/panel/PanelProvider","../../../models/item/command/PhotoItemCommandKeys"],function(i,e,t,o,r,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="AddToAlbum";t._panelProvider=t.resources.consume(a.resourceKey);t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor"],e,t)})}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,s.addToAlbum)};return e}(r.default);e.default=u});define("odsp-next/actions/base/templates/ExecutorAction",["require","exports","tslib","../ExecutorLoader","./SelectionAction"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._loader=new(t.managed(o.default))({path:t.getExecutorPath(),getModule:t.getModuleFactory(),getExecutorParams:function(){return t.selectionHelper.resolveSelection().then(function(e){return t.getExecutorParameters({selection:e})})}});return t}e.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return e}(r.default);t.default=n});define("odsp-next/actions/base/templates/SelectionAction",["require","exports","tslib","../../../base/BaseAction","../ItemCommandHelper","../ItemSelectionHelper"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.itemCommandHelper=new(t.managed(o.default));t.selectionHelper=new(t.managed(n.default))(i.__assign({},t.getSelectionOptions(),{overrideItem:e.item}));return t}e.prototype.getSelectionOptions=function(){return{}};return e}(r.default);t.default=a});define("odsp-next/actions/base/ItemSelectionHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../utilities/selection/SelectionHelper"],function(e,t,r,i,o,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(p){r.__extends(e,p);function e(e){void 0===e&&(e={});var t=p.call(this,e)||this,r=e.allowMultiSelect,i=void 0!==r&&r,o=e.canFallback,n=void 0!==o&&o,a=e.ignoreSelection,s=void 0!==a&&a,u=e.overrideItem,l=e.useCurrentSelectionGroup,c=void 0!==l&&l;t._canFallback=n;t._allowMultiSelect=i;t._overrideItem=u;t._ignoreSelection=s;t._useCurrentSelectionGroup=c;var d=t.resources;if(!u){t._selectionModel=d.consume(m.itemsSelection);t._selectionHelper=d.consume(f.resourceKey)}n&&(t._fallback=d.consume(m.currentItem));t.selection=t.createPureComputed(t._computeSelection);t.firstItem=t.createPureComputed(t._computeFirstItem);return t}Object.defineProperty(e.prototype,"currentItem",{get:function(){return this.resources.consume(m.currentItem)},enumerable:!0,configurable:!0});e.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var r=0,i=t;r<i.length;r++){var o=i[r],n=this.unwrapObservable(o);if(!n)return!0;if(!e(n))return!1}return!0};e.prototype.resolveSelection=function(){var r=this;return this._resolveSelection().then(function(e){if(e&&e.length)return e;if(r._canFallback){var t=r._fallback.peek();if(t)return[t]}})};e.prototype.resolveFirst=function(){var t=this;return this._resolveSelection().then(function(e){return e&&e.length?e[0]:t._canFallback?t._fallback.peek():void 0})};e.prototype.clearSelection=function(){this._selectionModel&&this._selectionModel.clear()};e.prototype.selectAll=function(){this._selectionModel&&this._selectionModel.selectAll()};e.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&1<e.length?[]:e||[]};e.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};e.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e=this._selectionModel;if(this._useCurrentSelectionGroup&&this._selectionModel.getSelectionModelGroup()){var t=this._selectionModel.getSelectionModelGroup().currentSelection();t&&(e=t)}var r=e.selection();(0===r.length||this._ignoreSelection)&&this._canFallback&&(r=[this._fallback]);return r};e.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.default.wrap([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});return this._ignoreSelection||!t.length?i.default.wrap([]):this._selectionHelper.resolveSelection()};return e}(o.default);t.default=n});define("odsp-next/providers/panel/PanelProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../models/panel/Panel"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r.currentPanels=r.observables.createArray();return r}e.prototype.requestPanel=function(e){var t=new n.default(e),r=this.currentPanels;r.push(t);var i=function(){return r.remove(t)};t.wait().then(i,i);return t};return e}(i.default);t.default=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("odsp-next/models/panel/Panel",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout"],function(e,t,C,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var r=this,t=e.noTitle,i=void 0!==t&&t,o=e.title,n=void 0===o?D.observable(""):o,a=e.elementDescribedBy,s=void 0===a?"":a,u=e.hasCommandBar,l=void 0!==u&&u,c=e.size,d=void 0===c?"Small":c,p=e.scrollMode,m=void 0===p?"auto":p,f=e.showCloseButton,h=void 0===f||f,g=e.includePadding,v=void 0===g||g,y=e.preserveLightDismiss,b=void 0!==y&&y,_=e.stickyCloseButton,S=void 0!==_&&_,x=e.component,P=void 0===x?null:x,I=e.maximizePanelContent,w=void 0!==I&&I,A=e.panelContentSize,T=void 0===A?D.observable({width:0,height:0}):A,k=e.isBlocking;this.size=d;this.title=D.isObservable(n)?n:D.observable(n);this.elementDescribedBy=s;this.maximizePanelContent=w;this.panelContentSize=T;this.noTitle=i;this.hasCommandBar=l;this.component=P;this.scrollMode=m;this.showCloseButton=h;this.includePadding=v;this.preserveLightDismiss=b;this.stickyCloseButton=S;this.isBlocking=k;this.state=D.observable(0);this._promise=new C.default(function(e){var t=D.computed(function(){if(1===r.state()){e(!0);t.dispose()}},r)})}e.prototype.wait=function(){return this._promise};return e}();t.default=r});define("odsp-next/models/item/command/PhotoItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.play=new r.default("play");t.rotate=new r.default("rotate");t.editCaption=new r.default("editCaption");t.editTags=new r.default("editTags");t.removeTags=new r.default("removeTags");t.viewOriginal=new r.default("viewOriginal");t.applyOfficeLens=new r.default("applyOfficeLens");t.removeOfficeLens=new r.default("removeOfficeLens");t.addToAlbum=new r.default("addToAlbum");t.removeFromAlbum=new r.default("removeFromAlbum");t.addPhotosToAlbum=new r.default("addPhotosToAlbum")});define("odsp-next/actions/ChangeFolderTypeAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../controls/infoPane/InfoPane.resx","../controls/folderTypeEditor/FolderTypeEditor","@ms/odsp-datasources/lib/utilities/permissions/Identity","../resources/DataSourceResourceKeys","../utilities/icons/Icon","../providers/item/ItemProvider","../providers/dialog/DialogProvider"],function(e,t,i,r,s,u,l,c,o,n,d,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ChangeFolderType";t.isSingleSelectAction=!0;t.canFallbackToParent=!0;t._identityDataSource=t.resources.consume(n.identity);t._itemProvider=t.resources.consume(a.resourceKey);t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.onSelectionExecute=function(e,t,r){var i=this,o=e[0],n=o.category,a=this.observables.create(n);return this.resources.consume(p.resourceKey).requestDialog({title:l.strings.informationChangeFolderTitle,component:{name:c.default.tagName,params:{category:a}},actions:[{name:l.strings.informationSave,execute:function(){return s.default.wrap(2)},isAvailable:this.createComputed(function(){return o.category!==a()}),isDefault:!0,icon:new d.default("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return i._itemProvider.changeFolderType({category:a(),item:o}).then(function(){return{resultType:u.ResultTypeEnum.Success}})})};e.prototype.onSelectionIsAvailable=function(e,t){var r=this._identityDataSource.getIdentity();return r&&r.type!==o.IdentityType.anonymous&&void 0!==t.category&&!this._urlDataSource.isRecycleBin(t.queryType)};return e}(r.default);t.default=m});define("odsp-next/controls/folderTypeEditor/FolderTypeEditor",["require","exports","./FolderTypeEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderTypeEditor.html","./FolderTypeEditor.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-folder-type-editor",template:e("./FolderTypeEditor.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/folderTypeEditor/FolderTypeEditorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../infoPane/InfoPane.resx","../../models/item/FolderCategory","knockout"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.infoPaneResx=o;t.category=e.category;t.typeDocuments=n.default[n.default.documents];t.typePhotos=n.default[n.default.photos];t.categoryText=a.observable(n.default[t.category()]);t.subscribe(t.categoryText,function(){t.category(n.default[t.categoryText()])});return t}return e}(r.default);t.default=s});define("odsp-next/models/item/FolderCategory",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"}(r||(r={}));t.default=r});define("odsp-next/controls/folderTypeEditor/FolderTypeEditor.html",[],function(){return'<div class=FolderTypeEditor><div class=FolderTypeEditor-option><div class=ms-RadioButton><input class=ms-RadioButton-input type=radio name=folderType id=folderTypeDocuments data-bind="attr: { value: typeDocuments }, checked: categoryText"> <label for=folderTypeDocuments class=ms-RadioButton-field><span class=ms-Label data-bind="text: infoPaneResx.strings.informationFolderTypeDocuments"></span></label></div></div><div class=FolderTypeEditor-option><div class=ms-RadioButton><input type=radio name=folderType id=folderTypePhotos value=photos data-bind="attr: { value: typePhotos }, checked: categoryText" class=ms-RadioButton-input> <label for=folderTypePhotos class=ms-RadioButton-field><span class=ms-Label data-bind="text: infoPaneResx.strings.informationFolderTypePhotos"></span></label></div></div></div>'});define("odsp-next/controls/folderTypeEditor/FolderTypeEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}])});define("odsp-next/actions/ClearSelectionAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ClearSelection";t._urlDataSource=t.resources.consume(a.url);return t}e.prototype.onSelectionIsAvailable=function(e,t){return 0<e};e.prototype.onIsAvailable=function(){return r.prototype.onIsAvailable.call(this)&&!this._urlDataSource.isRecycleBin(this.item().queryType)};e.prototype.onExecute=function(e,t){this.selectionModel.clear();return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(r.default);t.default=s});define("odsp-next/actions/odc/CreateDocumentAction",["require","exports","tslib","../CreateDocumentAction","cookies","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/odsp-utilities/lib/async/Promise","../../resources/ODCResourceKeys","../../controls/createDocumentForm/CreateDocumentForm","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./SkyApiHelper","../../dataSources/url/odc/UrlDataSource","../../providers/hiddenDom/HiddenDomProvider","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","../../models/item/command/WebItemCommandKeys","../base/ItemRedeemer","../../utilities/optimizely/ExperimentsCommon.key","../../resources/ControlResourceKeys","../../utilities/features/Features","../../utilities/optimizely/experiments/OfficeUpsell.key"],function(e,t,r,i,d,p,m,o,f,h,g,v,y,n,a,s,u,l,b,_,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(c){r.__extends(e,c);function e(e){var t=c.call(this,e)||this;t._itemDataSource=t.resources.consume(o.itemDataSource);t._hiddenDomProvider=t.resources.consume(n.resourceKey);t._itemCommandHelper=new(t.managed(a.default));t._itemReedemer=new(t.managed(l.default));t.askForFileName=!!e.autoInvokedItem;e.autoInvokedItem&&e.docType===p.DocumentType.Text&&(t.redirect=!1);t._itemCommandKey=t._getItemCommandKey(t.docType);t._didUserUploadOrCreateFile=t.resources.consume(_.didUserUploadOrCreateFile.optional);t.resources.consumeAsync(x.resourceKey).then(function(e){t._officeUpsellLogger=e});return t}e.prototype.onIsAvailable=function(){return!!this._itemCommandKey&&this._itemCommandHelper.isCommandSupported(this.item(),this._itemCommandKey)&&c.prototype.onIsAvailable.call(this)};e.prototype.onExecute=function(a,s){var u=this,l=this.item.peek();return this._itemReedemer.redeemItem(l,this).then(function(){var e,t=u._itemDataSource;if(u.askForFileName)return c.prototype.onExecute.call(u,a,s);S.isOneDrive&&u.trackPromise(u.resources.consumeAsync(b.resourceKey).then(function(e){e.fireUploadEvents()}));u._logOptimizelyEvents();u._didUserUploadOrCreateFile&&u._didUserUploadOrCreateFile(!0);if(u.docType===p.DocumentType.OneNote||2===u._itemCommandHelper.getCommandBehavior(l,u._itemCommandKey)){var r=u.navigation;e=t.createDocumentInTab(u.docType,l,!0);r.navigateTo({url:e,frameId:"_blank"});v.refreshItemWhenVisible(l,u.resources);return{resultType:g.ResultTypeEnum.Success}}var i=u._hiddenDomProvider;e=t.createDocumentInTab(u.docType,l,!1);var o=i.requestControl({name:f.default.tagName,params:{canary:FilesConfig.navCanary,formAction:e,resources:u.resources}}),n={FR:"SDX.Skydrive*Root",ST:(new Date).getTime()};d.set("BP",h.serializeQuery(n),{domain:y.default.getCookieDomain()});document.getElementById("create_form").submit();i.disposeControl(o);v.refreshItemWhenVisible(l,u.resources);return m.default.wrap({resultType:g.ResultTypeEnum.Success})})};e.prototype._getItemCommandKey=function(e){var t;switch(e){case p.DocumentType.Word:t=s.createWord;break;case p.DocumentType.Excel:t=s.createExcel;break;case p.DocumentType.PowerPoint:t=s.createPowerPoint;break;case p.DocumentType.ExcelSurvey:t=s.createSurvey;break;case p.DocumentType.OneNote:t=s.createOneNote;break;case p.DocumentType.Text:t=u.upload}return t};e.prototype._logOptimizelyEvents=function(){var e,t=((e={})[p.DocumentType.Word]="createdWordFile",e[p.DocumentType.Excel]="createdExcelFile",e[p.DocumentType.PowerPoint]="createdPowerPointFile",e[p.DocumentType.ExcelSurvey]="createdExcelForm",e[p.DocumentType.OneNote]="createdOneNote",e[p.DocumentType.Text]="createdTextDocument",e);this.docType&&t[this.docType]&&this._officeUpsellLogger&&this._officeUpsellLogger.logOptimizelyEvent(t[this.docType])};return e}(i.default);t.default=c});define("odsp-next/actions/CreateDocumentAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../controls/itemNameEditor/ItemNameEditor","@ms/odsp-utilities/lib/async/Promise","../controls/commands/Commands.resx","../dataSources/url/QueryType","../utilities/icons/Icon","../providers/item/ItemProvider","../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../utilities/optimizely/ExperimentsCommon.key","../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules","../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore"],function(r,t,i,e,o,d,p,m,s,f,n,h,a,u,l,c,g,v,y,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemOperatorAsyncTypeResourceKey=new b.ResourceKey({name:r("module").id+".createItemOperator",loader:new b.AliasResourceLoader(function(){return v.loadModuleExport({path:"../providers/operator/CreateItemOperator",getModule:function(){return new s.default(function(e,t){r(["../providers/operator/CreateItemOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var S=f.strings,x=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.docType=e.docType;t.templateUrl=e.templateUrl;t.name="Create"+(p.DocumentType[t.docType]||"")+"DocumentAction";t.navigation=t.resources.consume(o.navigation);t.itemProvider=t.resources.consume(a.resourceKey);t._dialogProvider=t.resources.consume(u.resourceKey);t.platformDetection=t.resources.consume(l.platformDetection);t.redirect=!0;t.openInNewTab=!1;t.askForFileName=t.docType===p.DocumentType.OneNote;t._didUserUploadCreateFile=t.resources.consume(y.didUserUploadOrCreateFile.optional);return t}e.prototype.createDocument=function(e,t){var r=this,i=this.navigation,o=this.itemProvider,n=null,a=o.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){e&&(n=e);return s.default.wrap({resultType:d.ResultTypeEnum.Success})});a.done(function(e){n&&!window._isRunningTABTest&&r.async.setImmediate(function(){return i.navigateTo({url:n,frameId:r.openInNewTab?"_blank":null})})});return a};e.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad)&&this.item().queryType===n.default.Files};e.prototype.isCommandSupported=function(){return!0};e.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():s.default.wrap({resultType:d.ResultTypeEnum.Success})};e.prototype.onExecuteCore=function(){if(!this._isCreatingFile){g.isOneDrive&&this.trackPromise(this.resources.consumeAsync(c.resourceKey).then(function(e){e.fireUploadEvents()}));this._didUserUploadCreateFile&&this._didUserUploadCreateFile(!0);var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}};e.prototype.createNewFile=function(r,e){var i=this;return this.resources.consumeAsync(t.createItemOperatorAsyncTypeResourceKey).then(function(e){var t=new e({fileName:r,parentItem:i.item.peek()});return i.trackPromise(t.start())})};e.prototype._createDocumentWithDialog=function(t){var r=this,e=this._dialogProvider,i=this.observables.create(""),o=this.observables.create(""),n=this.observables.create(!1),a=this.observables.create(!0),s=null,u=_.getDocExtension(this.docType);this._isCreatingFile=!0;var l=function(e){n(!0);a(!0);o(e);return 1},c=e.requestDialog({title:_.getDialogTitle(this.docType,S),isDismissable:this.docType!==p.DocumentType.Text,component:{name:m.default.tagName,params:{name:i,automationId:"createDocumentDialog",extension:u,status:o,hasError:n,isEnabled:a}},actions:[{name:S.CreateCommit,execute:function(){o(f.strings.Saving);a(!1);n(!1);return e=r.docType===p.DocumentType.OneNote||r.docType===p.DocumentType.ExcelSurvey||r.docType===p.DocumentType.ExcelForm?i.peek():i.peek()+u,r.redirect?r.itemProvider.createDocument(t.key,r.docType,e,r.templateUrl).then(function(e){s=e;return 2},l):r.createNewFile(e,t).then(function(){return 2},l);var e},isAvailable:this.observables.pureCompute(function(){return r._isCreateAvailable(a,i)}),isDefault:!0,icon:new h.default("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return{resultType:d.ResultTypeEnum.Success}},function(){return{resultType:d.ResultTypeEnum.ExpectedFailure}});c.done(function(){r._isCreatingFile=!1;if(s){var e=r.navigation;r.async.setImmediate(function(){return e.navigateTo({url:s,frameId:r.openInNewTab?"_blank":null})})}});return c};e.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var r=t();return!!r&&" "!==r[0]};return e}(e.default);t.default=x});define("odsp-next/controls/itemNameEditor/ItemNameEditor",["require","exports","./ItemNameEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemNameEditor.html","./ItemNameEditor.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-item-name-editor",template:e("./ItemNameEditor.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/itemNameEditor/ItemNameEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./ItemNameEditor.resx","../../bindings/focus/SelectOnFocusBinding"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.namePlaceholder=n.strings.NewNamePlaceholder;t.nameLabel=n.strings.NewNameLabel;t.name=e.name;t.extension=e.extension;t.status=e.status||o.observable("");t.hasError=e.hasError||o.observable(!1);t.isEnabled=e.isEnabled||o.observable(!0);t.hasFocus=e.hasFocus||o.observable(!0);t.addBindingHandlers({selectOnFocus:a.default});return t}return e}(r.default);t.default=s});define("odsp-next/bindings/focus/SelectOnFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){n.__extends(e,o);function e(e){var t=o.call(this,e)||this,r=t.valueAccessor();t._platform=t.resources.consume(a.platformDetection.optional);t._isPermanent="object"==typeof r&&r.isPermanent||!1;t._isReentrant="object"==typeof r&&r.isReentrant||!1;document.activeElement===t.element&&t._select();var i=n.__assign({focus:t._onFocus,focusin:t._onFocus,mouseup:t._onMouseUp},t._isReentrant?{focusout:t._onFocusOut}:{});t.events.onAll(t.element,i);return t}e.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}return this._hasSelected=!0}return!1};e.prototype._onFocus=function(e){this._select();return!0};e.prototype._onFocusOut=function(){return!(this._hasSelected=!1)};e.prototype._onMouseUp=function(e){if(this._select())return!1};return e}(r.default);t.default=i});define("odsp-next/controls/itemNameEditor/ItemNameEditor.html",[],function(){return"<div class=od-ItemNameEditor data-bind=\"css: { 'od-ItemNameEditor--noExtension': !extension, 'is-focused': hasFocus, 'is-error': hasError }\"><div class=od-TextField><label class=\"od-ItemNameEditor-nameLabel ms-Label\" for=ItemNameEditor-input data-bind=\"text: nameLabel\"></label> <span class=od-ItemNameEditor-input><input class=od-TextField-field id=ItemNameEditor-input type=text data-bind=\"textInput: name, hasFocus: hasFocus, selectOnFocus, attr: { placeholder: namePlaceholder }, css: { 'od-ItemNameEditor-input--error': hasError }, enable: isEnabled, automation: 'itemNameEditor-Input'\"></span> <span class=od-ItemNameEditor-extension data-bind=\"text: extension\"></span></div>\x3c!--ko if: hasError--\x3e<div class=od-ItemNameEditor-status aria-live=assertive role=status data-bind=\"text: status, css: { 'od-ItemNameEditor-status--error': hasError }\"></div>\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/itemNameEditor/ItemNameEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemNameEditor-nameLabel.ms-Label{display:none}.od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}"}])});define("odsp-next/utilities/optimizely/ExperimentsCommon.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./ExperimentsCommon",getModule:function(){return new t.default(function(e,t){r(["./ExperimentsCommon"],e,t)})},getExport:function(e){return e.resourceKey}})})});e.default=e.resourceKey});define("@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore",["require","exports","tslib","@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper",["require","exports","../../../operations/createDocument/DocumentType"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDocExtension=function(e){switch(e){case i.DocumentType.Word:return".docx";case i.DocumentType.Excel:case i.DocumentType.ExcelSurvey:case i.DocumentType.ExcelForm:return".xlsx";case i.DocumentType.PowerPoint:return".pptx";case i.DocumentType.OneNote:return"";case i.DocumentType.Text:return".txt";case i.DocumentType.Visio:return".vsdx"}};t.getDialogTitle=function(e,t){var r="";switch(e){case i.DocumentType.Word:r=t.CreateWord;break;case i.DocumentType.Excel:r=t.CreateExcel;break;case i.DocumentType.PowerPoint:r=t.CreatePowerPoint;break;case i.DocumentType.OneNote:r=t.CreateOneNote;break;case i.DocumentType.ExcelSurvey:r=t.CreateExcelSurvey;break;case i.DocumentType.Text:r=t.CreateText;break;case i.DocumentType.ExcelForm:r=t.CreateFormForExcel;break;case i.DocumentType.Visio:r=t.CreateVisio}return r}});define("@ms/items-view/lib/private/operations/createDocument/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio"}(t.DocumentType||(t.DocumentType={}))});define("odsp-next/controls/createDocumentForm/CreateDocumentForm",["require","exports","./CreateDocumentFormViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateDocumentForm.html"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-create-doc-form",template:e("./CreateDocumentForm.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/createDocumentForm/CreateDocumentFormViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._platform=t.resources.consume(o.platformDetection);t.formAction=e.formAction;t.canary=e.canary;t.target=t._platform.isMobile?"":"_blank";return t}return e}(r.default);t.default=n});define("odsp-next/controls/createDocumentForm/CreateDocumentForm.html",[],function(){return'<form class=CreateDocumentForm id=create_form name=create_form method=post data-bind="attr: { action: formAction, target: target }"><input name=canary type=hidden data-bind="value: canary"></form>'});define("odsp-next/actions/odc/SkyApiHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ProviderResourceKeys","./OfficeActionIdMap","./OfficeClient","@ms/odsp-utilities/lib/events/EventGroup","../../models/item/ItemType","../../providers/item/ItemProvider"],function(e,t,n,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var r;e&&e.properties&&e.properties.commandsSupported&&(r=e.properties.commandsSupported[t]);return r}t.getActionId=r;t.isCommandSupported=function(e,t){return void 0!==r(e,t)};t.tryAutoRedeemItem=function(e,t,r){return i([e],t,r)};function i(e,t,r){var i,o;return function(e){if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.tokenNeedsRedeeming)return!0}return!1}(e)||r?(i=t,o=e[0],i.resources.consume(s.ticketRedeemer).getTicketRedeemerManager().then(function(e){return e.startRedeem(i,o)},function(e){return n.default.wrapError({})})):n.default.wrap({resultType:a.ResultTypeEnum.Success})}t.tryAutoRedeemItems=i;t.openInClient=function(e,t,r,i,o){var n;e.type===d.default.OneNote&&(n=e.urls.oneNoteClient);var a={url:n,isDavUrl:!!n,fileName:e.name,iconType:e.iconName,appType:i,extension:i===u.default[2].toString()?".one":e.extension,item:e};return l.default.executeOpenInClient(a,o)};t.refreshWhenVisible=function(e){var t=m(),r=t?t+"Hidden":"hidden",i=t+"visibilitychange",o=new c.default(this),n=window.document;if(r){var a=function(){if(!n[r]){o.off(n,i,a);e(!0)}};o.on(n,i,a)}};t.refreshItemWhenVisible=function(e,t,r){var i=m(),o=i?i+"Hidden":"hidden",n=i+"visibilitychange",a=new c.default({}),s=window.document;if(o){var u=function(){if(!s[o]){a.off(s,n,u);t.consume(p.resourceKey).invalidateItem(e.key,{triggerFetch:r})}};a.on(s,n,u)}};function m(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}});define("odsp-next/actions/odc/OfficeActionIdMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Excel=1]="Excel";e[e.OneNote=2]="OneNote";e[e.PowerPoint=3]="PowerPoint";e[e.Word=4]="Word";e[e.Visio=5]="Visio";e[e.Project=6]="Project";e[e.Publisher=7]="Publisher"}(r||(r={}));t.default=r});define("odsp-next/actions/odc/OfficeClient",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./ClientUtils","./OfficeActionIdMap","../../providers/item/ItemProvider"],function(e,t,o,n,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(){}i.executeOpenInClient=function(e,t){i._item=e.item;i._provider=t.consume(r.resourceKey);if(e.isDavUrl){i._openInClient(e);return o.default.wrap({resultType:n.ResultTypeEnum.Success})}return i._getOpenInClientDetails(e)};i._getOpenInClientDetails=function(r){return i._provider.getOpenInClientDetails(i._item).then(function(e){if(e){var t=e.davUrl;r.url=t;r.isDavUrl=!0;i._openInClient(r)}return o.default.wrap({resultType:n.ResultTypeEnum.Success})})};i._openInClient=function(e){if(!e.useDirectInvoke){var t=a.default.OpenDocumentMode.WriteOnly;1===e.item.sharingRole&&(t=a.default.OpenDocumentMode.ReadOnly);e.appType===s.default[7].toString()&&(t=a.default.OpenDocumentMode.WriteOnly);var r=a.default.OpenDocumentOptions.None;e.Mode=t;e.Options=r;var i={DocumentUrl:e.url,Mode:t,Options:r,Application:a.default.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};a.default.EditDocumentInClient(i,null,null)}};return i}();t.default=i});define("odsp-next/actions/odc/ClientUtils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var a,s,m,f,u,e,t,r,i,l="SharePoint.OpenDocuments.5",c="SharePoint.OpenDocuments.4",d="SharePoint.OpenDocuments.3",p="SharePoint.OpenDocuments.2",o="application/x-sharepoint",n="application/x-sharepoint-webkit",h="application/x-sharepoint-protocolhandler",g="application/x-sharepoint-webkit-protocolhandler",v="application/officelive",y="npSharePointPlugin",b="IDBHO.IDBHOCtrl",_="OneNote.Notebook",S="ofv|",x="ofe|",P="u|",I="RoamingOfficeActiveX.RoamingOffice",w="application/x-vnd.officeondemand",A="office:",T="";var k={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},C={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},D={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},E={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},L={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function O(){return function(){!function(){if(e)return;e=!0;t=F("Windows NT")}();return 6.1<=t}()&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(q()||z()||j())}function R(){return 0<=window.navigator.userAgent.indexOf("Windows")}function M(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function F(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),r=-1;if(null!=t&&2<=t.length){r=parseFloat(t[1]);isNaN(r)&&(r=-1)}return r}function N(){!function(){if(!r){r=!0;i=F("Windows Phone")}}();return 8<=i}function U(){return"function"==typeof navigator.msLaunchUri&&!M()&&!K()}function B(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function H(){return 0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")}function K(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function q(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function V(){return!!q()&&8==window.document.documentMode}function G(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function j(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function z(){return 3<=function(){if(G())return Q("firefox/");return 0}()}function W(){return 3<=function(){if(0<=window.navigator.userAgent.indexOf(" AppleWebKit/"))return Q("version/");return 0}()}function Q(e){var t=window.navigator.userAgent.toLowerCase(),r=t.indexOf(e);if(0<=r){var i=r+e.length,o=t.length;return parseInt(t.substring(i,o))}return 0}function $(e,t,r){U()?navigator.msLaunchUri(e,t,r):!j()&&!H()||K()?function(e,t,r){var i=document.getElementById("OICFrame");if(null==i){(i=document.createElement("iframe")).className="ObjectInDialog";i.style.visibility="hidden";i.src="about:blank";document.body.appendChild(i);i.id="OICFrame"}try{i.contentWindow.location.href=e}catch(e){null!=r&&r();return}null!=t&&t()}(e,t,r):function(e,t,r){var i="OICLinkTag",o=document.getElementById(i);if(null==o){(o=document.createElement("a")).id=i;o.style.visibility="hidden";o.href="";o.target="_top";document.body.appendChild(o);null!=o.addEventListener&&o.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1)}try{o.href=e;o.click()}catch(e){null!=r&&r();return}null!=t&&t()}(e,t,r)}function X(e){return 0!=(e.Options&C.SkipProtocolHandler)||V()}function J(e){return!X(e)&&(t=e,!(!B()||t.Application!=L.OneNote&&!ce(h,!1)&&!ce(g,!1))||(!!U()||(!(Y()||"ActiveXObject"in window&&!M()||j())||15<=ve())));var t}function Y(){return B()&&(z()||W())||z()}function Z(e){return e===k.ReadOnly||e===k.ReadWrite}function ee(e,t,r,i){var o=function(e){if(e!=L.OneNote&&M()&&!N())return"office:";switch(e){case L.Excel:return"ms-excel:";case L.OneNote:return"onenote:";case L.PowerPoint:return"ms-powerpoint:";case L.Visio:return"ms-visio:";case L.Word:return"ms-word:";case L.Project:return"ms-project:";case L.Publisher:return"ms-publisher:";case L.Infopath:return"ms-infopath:";case L.Access:return"ms-access:";default:return""}}(e);if(null==o){ge(D.Unattempted,u.Application);return!1}e==L.Visio&&r==k.ReadWrite&&(r=k.WriteOnly);var n=o;if(!(i=i||M()&&!N())){var a="";Z(r)?a+=S:a+=x;n+=te(a+=P)}$(n+=te(t),re,ie);return!0}function te(e){if(B()&&j()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function re(){he(E.ProtocolHandler)}function ie(){u.Options|=C.SkipProtocolHandler;fe(u,a,s)}function oe(){if(U())return!0;if(j()){void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(!1);return!!navigator.mimeTypes[w]}if(G()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");t.initEvent("RoamingOfficeInstalled",!0,!1);e.dispatchEvent(t);return!!e.getAttribute("installed")}if(q())try{return new ActiveXObject(I).HrExists()}catch(e){}return!1}function ne(e,t,r,i,o,n){ae(e,t,function(e){switch(e){case L.Excel:return"root\\office15\\excel.exe";case L.PowerPoint:return"root\\office15\\powerpnt.exe";case L.Visio:return"root\\office15\\visio.exe";case L.Word:return"root\\office15\\winword.exe";case L.Project:return"root\\office15\\winproj.exe";case L.Publisher:return"root\\office15\\mspub.exe";case L.Infopath:return"root\\office15\\infopath.exe";case L.Access:return"root\\office15\\msaccess.exe";default:return null}}(r),i,"x86",T,o,n)}function ae(e,t,r,i,o,n,a,s){var u="";null!=i&&(u+=" "+i);null!=e&&(u+=' "'+e+'"');if(U()||j()){m=a;f=s;var l=A;l+=' "'+n+'"';l+=' "'+r+'"';l+=' "ROAMING"';l+=' "'+t+'"';l+=' "'+o+'"';$(l+=" "+u,se,ue)}else if(G()){var c=document.createElement("RoamingExtensionElement");c.setAttribute("cabUrl",n);c.setAttribute("app",r);c.setAttribute("licensingEntitlements",t);c.setAttribute("platform",o);c.setAttribute("args",u);document.documentElement.appendChild(c);var d=document.createEvent("Events");d.initEvent("RoamingOfficeLaunch",!0,!1);c.dispatchEvent(d);null!=a&&a(E.RoamingFFExtension)}else if(q()){var p=new ActiveXObject(I);if(null!=p)try{p.HrConfigureSingle(n,r,t,o,u);null!=a&&a(E.RoamingActiveX)}catch(e){}}else null!=s&&s(D.Failed)}function se(){null!=m&&m(E.RoamingProtocolHandler)}function ue(){null!=f&&f(D.ControlNeeded)}function le(){var e=document.getElementById(y);if(null==e){var t=o;B()&&W()&&de(n)&&(t=n);if(!de(t)){if(!B()||!de(v))return null;t=v}var r=document.createElement("object");r.id=y;r.type=t;r.style.width="0px";r.style.height="0px";r.style.setProperty("visibility","hidden","");document.body.appendChild(r);e=document.getElementById(y)}return e}function ce(e,t){var r=window.navigator.mimeTypes;if(null==r)return!1;var i=r[e];return!!i&&!(t&&!i.enabledPlugin)}function de(e){return ce(e,!0)}function pe(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function me(e){switch(e){case L.OneNote:return _;default:return""}}function fe(e,t,r){a=t;s=r;if((u=e).DocumentUrl){var i=e.DocumentUrl;try{i=decodeURIComponent(e.DocumentUrl)}catch(e){}e.Mode===k.ReadWrite&&C.CheckoutRequired===(e.Options&C.CheckoutRequired)&&(e.Mode=k.ForceCheckout);C.HostIsEditOnly===(e.Options&C.HostIsEditOnly)&&(e.Mode=k.WriteOnly);if(J(e))ee(e.Application,e.DocumentUrl,e.Mode,e.Application==L.OneNote);else if(V()&&function(e,t,r,i){try{var o=new ActiveXObject(l);if(o)return o.ViewDocument3(window.self,e,t,i)}catch(e){}return!1}(i,e.Mode,e.Options,me(e.Application)))he(E.O15ActiveX);else{var o,n;if(Y())o=function(e,t,r){var i=le();if(null==i)return D.Unattempted;var o=!1;try{o=i.ViewDocument3(window.self,e,t,r)}catch(e){}if(!o)try{o=Z(t)?i.ViewDocument2(window.self,e,r):i.EditDocument2(window.self,e,r)}catch(e){}if(o){he(E.NpapiPlugin);return D.None}return D.Failed}(i,e.Mode,me(e.Application));else{!function(){try{var e=new ActiveXObject(b);null!=e&&e.SaveSSOCreds()}catch(e){}}();o=function(e,t,r,i){var o;try{if(o=new ActiveXObject(c)){if(o.ViewDocument3(window.self,e,t,i)){he(E.O14ActiveX);return D.None}return D.Failed}}catch(e){}if(C.O14Only===(r&C.O14Only))return D.Unattempted;try{if(o=new ActiveXObject(d)){if(o.ViewDocument3(window.self,e,t,i)){he(E.O12ActiveX);return D.None}return D.Failed}}catch(e){}if(C.O12UpOnly===(r&C.O12UpOnly))return D.Unattempted;try{if(o=new ActiveXObject(p)){if(Z(t)?o.ViewDocument2(window.self,e,i):o.EditDocument2(window.self,e,i)){he(E.O11ActiveX);return D.None}return D.Failed}}catch(e){}return D.Unattempted}(i,e.Mode,e.Options,me(e.Application))}if(o!=D.None){if(e.CouldUseRoamingApps&&O()&&e.Application!=L.OneNote){if(!oe()){ge(D.ControlNeeded,u.Application);return}if(e.RoamingAppsLauncher){void 0!==(n=e).RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?ne(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,a,s):ae(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,a,s):ge(D.Unattempted,u.Application);return}if(!e.ContinueIfLauncherIsNull){ge(D.LauncherNeeded,u.Application);return}}if(!(C.NoProtocolHandlerFallback==(e.Options&C.NoProtocolHandlerFallback)||X(e)||q()||B()&&o!=D.Unattempted)){ee(e.Application,e.DocumentUrl,e.Mode,e.Application==L.OneNote);return}ge(o,u.Application)}}}else ge(D.Unattempted,u.Application)}function he(e){null!=a&&a(e)}function ge(e,t){void 0===t&&(t=null);null!=s&&s(e,t)}function ve(){var e=0;if(Y()||j()){var t=le();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else pe(l)?e=15:pe(c)?e=14:pe(d)?e=12:pe(p)&&(e=11);return e}function ye(){return B()&&(de(o)||de(n))}return{OpenDocumentMode:k,OpenDocumentOptions:C,OpenDocumentFailureType:D,OpenDocumentControl:E,OfficeApplication:L,EditDocumentInClient:fe,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=L.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl=""},OfficeVersionInstalled:ve,IsO14MacPluginInstalled:ye,OfferOfficeInDialog:function(){return R()&&ve()<=11},OfferOfficeNoIntrusive:function(){return R()&&ve()<15},OfferMacOffice:function(){return B()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ye()},CanUseRoamingControl:oe,InitUrls:function(e,t,r){T=e},LaunchRoamingApps:ne,LaunchRoamingApps2:ae,ShouldShowDialog:function(){return!M()}}}();t.default=r});define("odsp-next/providers/hiddenDom/HiddenDomProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this,i=r._controls=r.observables.createArray([]),o=document.createElement("div");o.style.display="none";var n=document.createElement("div");n.setAttribute("data-bind","component: $data");document.body.appendChild(o);s.applyBindingsToNode(o,{template:{nodes:[n],foreach:i}});return r}e.prototype.requestControl=function(e){this._controls.push(e);return e};e.prototype.disposeControl=function(e){var t=this._controls,r=t.indexOf(e);t.splice(r,1)};return e}(i.default);t.default=n;t.resourceKey=o.createResolvedResourceKey(e("module").id,n)});define("odsp-next/models/item/command/OfficeItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createExcel=new r.default("createExcel");t.createOneNote=new r.default("createOneNote");t.createPowerPoint=new r.default("createPowerPoint");t.createWord=new r.default("createWord");t.createSurvey=new r.default("createSurvey");t.viewSurvey=new r.default("viewSurvey");t.editSurvey=new r.default("editSurvey");t.publishSurvey=new r.default("publishSurvey");t.openOnline=new r.default("openOnline");t.openInClient=new r.default("openInClient");t.viewVersionHistory=new r.default("viewVersionHistory");t.openInPowerBI=new r.default("openInPowerBI")});define("odsp-next/models/item/command/WebItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.upload=new r.default("upload");t.download=new r.default("download");t.sync=new r.default("sync")});define("odsp-next/actions/createFolder/odc/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(r,e,i,o,n,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){i.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="CreateFolder";return e}e.prototype.getExecutorPath=function(){return"odsp-next/actions/createFolder/odc/CreateFolderExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["odsp-next/actions/createFolder/odc/CreateFolderExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{canFallback:!0}};e.prototype.getExecutorParameters=function(){var t=this;return this.selectionHelper.resolveFirst().then(function(e){return{actionName:t.name,item:e}})};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&e.queryType===n.default.Files&&this.itemCommandHelper.isCommandSupported(e,a.createFolder)};return e}(t.default);e.default=s});define("odsp-next/models/item/command/FileSystemItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolder=new r.default("createFolder");t.rename=new r.default("rename");t.moveFrom=new r.default("moveFrom");t.copyFrom=new r.default("copyFrom");t.moveTo=new r.default("moveTo");t.copyTo=new r.default("copyTo");t.deleteItem=new r.default("deleteItem");t.restoreItem=new r.default("restoreItem");t.deleteAllItems=new r.default("deleteAllItems");t.restoreAllItems=new r.default("restoreAllItems");t.createText=new r.default("createText");t.changeExpiration=new r.default("changeExpiration");t.open=new r.default("open");t.openInTextEditor=new r.default("openInTextEditor");t.openPdfInBrowser=new r.default("openPdfInBrowser");t.quickEdit=new r.default("quickEdit");t.editItem=new r.default("editItem");t.createShortcut=new r.default("createShortcut");t.pinToMru=new r.default("pinToMru");t.printPdf=new r.default("printPdf")});define("odsp-next/actions/odc/CreateMountPointAction",["require","exports","tslib","../../base/BaseSelectionAction","../../controls/commands/Commands.resx","../../controls/createMountPoint/CreateMountPoint","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/icons/Icon","../../resources/ControlResourceKeys","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../base/ItemRedeemer"],function(e,t,i,r,a,s,u,l,c,d,p,o,n,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.isSingleSelectAction=!0;t.canFallbackToParent=!0;t.name="CreateMountPoint";t._actionMap=t.resources.consume(o.actionMap);t._itemReedemer=new(t.managed(h.default));t._itemCommandHelper=new(t.managed(m.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,f.addAsMountPoint)};e.prototype.onSelectionExecute=function(e,t,r){var i=this,o=e[0],n=this.resources.consume(l.resourceKey);return this._itemReedemer.redeemItem(o,this).then(function(){i._isAddFolderAvailable=i.observables.create(!0);i._isLearnMoreAvailable=i.observables.create(!0);i._detailsText=i.observables.create(a.strings.CreateMountPointDetails);var e=d.format(a.strings.CreateMountPointTitle,o.name);return n.requestDialog({title:e,component:{name:s.default.tagName,params:{text:i._detailsText,isLearnMoreVisible:i._isAddFolderAvailable}},actions:[{name:a.strings.CreateMountPointConfirm,execute:function(){return i.onDialogExecute(o)},isAvailable:i._isAddFolderAvailable,isVisible:i._isAddFolderAvailable,icon:new p.default("OneDriveAdd"),isDefault:!0},{name:a.strings.Close,execute:function(){return u.default.wrap(2)},isAvailable:i.observables.create(!0),isVisible:i.createComputed(function(){return!i._isAddFolderAvailable()}),icon:new p.default("Cancel"),isDefault:!0}]}).wait().then(function(){i.selectionModel.clear();return{resultType:c.ResultTypeEnum.Success}})})};e.prototype.onDialogExecute=function(e){var t=this,r=this.resources.consume(n.resourceKey);this._isAddFolderAvailable(!1);this._isLearnMoreAvailable(!1);this._detailsText(a.strings.CreateMountPointWait);return r.createMountPoint({item:e}).then(function(e){new(t.managed(t._actionMap.OpenAction))({openRelation:2,item:t.createObservable(e)}).execute(null);return 2},function(e){if(e.data&&e.data.message){t._detailsText(e.data.message);return 1}})};return e}(r.default);t.default=g});define("odsp-next/controls/createMountPoint/CreateMountPoint",["require","exports","./CreateMountPointViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateMountPoint.html"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-create-mp",template:e("./CreateMountPoint.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/createMountPoint/CreateMountPointViewModel",["require","exports","tslib","../commands/Commands.resx","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){o.__extends(i,r);function i(e){var t=r.call(this,e)||this;t.text=e.text;t.isLearnMoreVisible=e.isLearnMoreVisible;t.learnMoreText=n.strings.CreateMountPointLearnMore;t.learnMoreUrl=i.LEARNMORE_URL;return t}i.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986";return i}(r.default);t.default=i});define("odsp-next/controls/createMountPoint/CreateMountPoint.html",[],function(){return'<div class=CreateMountPoint><span data-bind="text: text"></span> <a data-bind="attr: {href: learnMoreUrl}, text: learnMoreText, visible: isLearnMoreVisible"></a></div>'});define("odsp-next/models/item/command/SocialItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.share=new r.default("share");t.addToShared=new r.default("addToShared");t.embed=new r.default("embed");t.comment=new r.default("comment");t.removeFromShared=new r.default("removeFromShared");t.addAsMountPoint=new r.default("addAsMountPoint");t.removeAsMountPoint=new r.default("removeAsMountPoint");t.reportAbuse=new r.default("reportAbuse");t.requestReview=new r.default("requestReview");t.alertItem=new r.default("alertItem");t.addToSpotlight=new r.default("alertItem")});define("odsp-next/actions/odc/DefaultClickAction",["require","exports","tslib","../DefaultClickAction","../../resources/ODCResourceKeys","./ShowNotSharedAction","../../dataSources/url/AutoActionType","../base/ItemCommandHelper","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","../../models/item/command/CoreItemCommandKeys"],function(r,e,t,i,n,a,s,u,l,c,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this,r=e.sourceEngagement,i=void 0===r?"":r;t._odcUrlDataSource=t.resources.consume(n.urlDataSource);t._itemCommandHelper=new(t.managed(u.default));t._defaultClickBehavior=t.createPureComputed(t._computeDefaultClickBehavior);t._isFromPromotedPhotos=-1<i.indexOf("PromotedPhotosTile");return t}e.prototype.onIsAvailable=function(){var e=this.item(),t=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(e,d.defaultClick);return o.prototype.onIsAvailable.call(this)&&!t};e.prototype.onExecute=function(e){if(this._isFromPromotedPhotos){l.loadModule({path:"../../utilities/optimizely/OptimizelyHelper",getModule:function(){return new c.default(function(e,t){r(["../../utilities/optimizely/OptimizelyHelper"],e,t)})}}).done(function(t){l.loadModule({path:"../../utilities/optimizely/experiments/NewFeatureDiscovery",getModule:function(){return new c.default(function(e,t){r(["../../utilities/optimizely/experiments/NewFeatureDiscovery"],e,t)})}}).done(function(e){t.trackEvent(e.EXPERIMENT_ID,e.EVENTS.promotedPhotoClicked)})})}return o.prototype.onExecute.call(this,e)};e.prototype.onComputeAction=function(){var e,t=this;switch(this._defaultClickBehavior()){case 1:e=o.prototype.onComputeAction.call(this);break;case 2:case 3:e=new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 5:e=new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 7:e=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 8:e=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=t._odcUrlDataSource.qualifyUrl(t._odcUrlDataSource.getDefaultClickUrl(t.item(),{action:s.default.defaultClick,viewParams:t.viewParams()}));return t._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 9:e=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 10:e=new(this.managed(a.default))}return e};e.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),d.defaultClick)};return e}(i.default);e.default=o});define("odsp-next/actions/DefaultClickAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../models/item/ItemType","../dataSources/url/QueryType","../resources/DataSourceResourceKeys","../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../dataSources/url/PageType","./base/ItemSelectionHelper","../models/item/engagement/ItemEngagementParts","@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts","../models/engagement/Engagement","../providers/engagement/Engagement"],function(e,m,t,r,n,f,s,u,h,g,a,v,i,y,l,c,b,d){"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.openEngagementPart=new b.EngagementPart("Open",2);var o=function(p){t.__extends(e,p);function e(e){var t=p.call(this,e)||this;t.name="DefaultClick";t.isQosLogged=!1;var r=e.item,i=e.userInvokedItem,o=void 0!==i&&i,n=e.hideIfDefaultIsDownload,a=void 0!==n&&n,s=e.sourceEngagement,u=void 0===s?"":s,l=t,c=l.resources,d=l.observables;c.expose(b.engagementSourceResourceKey,c.consume(b.engagementSourceResourceKey).withPart(m.openEngagementPart));t._itemSelectionHelper=new(t.managed(y.default))({overrideItem:r,allowMultiSelect:!1,canFallback:!1});t.item=t._itemSelectionHelper.firstItem;t.sourceEngagement=u;t.userInvokedItem=o;t.hideIfDefaultIsDownload=a;t.actionMap=c.consume(f.actionMap);t.urlDataSource=c.consume(h.url);t.viewParams=c.consume(f.viewParams);t._isFilePickerPage=d.pureCompute(t._computeIsFilePickerPage);t._action=d.pureCompute(t._computeAction);t._action.equalityComparer=v.objectStrictEquality;t.userInvokedItem&&(t._instrumentationProvider=c.consume(g.instrumentation));return t}e.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};e.prototype.onExecute=function(e){var t=this.observables,r=t.peekUnwrap(this.item);this._logEngagement(r,e);if(r&&this.userInvokedItem){var i=this._instrumentationProvider;i&&r&&i.userClickItem(r)}var o=t.peekUnwrap(this._action);return o&&o.execute(e)||a.default.wrap({resultType:n.ResultTypeEnum.ExpectedFailure})};e.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};e.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===i.default.FilePicker};e.prototype._computeAction=function(){var e,t=this._lastAction;if(t){t.dispose();this._lastAction=void 0}this._isFilePickerPage()&&this.item().type!==s.default.Folder||(e=this.onComputeAction());return this._lastAction=e};e.prototype._logEngagement=function(e,t){var r,i=t?t.type:"unknown",o=this.sourceEngagement,n=this.urlDataSource,a=this.resources.consume(d.resourceKey).withPart(c.clickEngagementPart);o&&(r=e&&e.type===s.default.File?"FileOpen."+o:e&&e.type===s.default.Folder?"FolderOpen."+o:e&&e.type===s.default.App?"AppOpen."+o:e&&e.type===s.default.Subsite?"SubsiteOpen."+o:"Open."+o);a.withPart(l.itemEngagementPart,{item:e}).logData({name:r,extraData:{action:i}});e&&n.getQueryType(n.getKeyParams(e.key))===u.default.Search&&a.logData({name:"ListItem.Search.Click",isIntentional:!0,extraData:{listItemType:e.type,action:i}})};return e}(r.default);m.default=o});define("odsp-next/models/item/engagement/ItemEngagementParts",["require","exports","../../engagement/Engagement"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementPart=new r.EngagementPart("Item",1)});define("@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts",["require","exports","../EngagementPart"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clickEngagementPart=new r.EngagementPart("Click",4);t.keyPressEngagementPart=new r.EngagementPart("KeyPress",4);t.dropEngagementPart=new r.EngagementPart("Drop",4)});define("odsp-next/actions/odc/ShowNotSharedAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/textContainer/TextContainer.resx","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider"],function(e,t,r,i,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.strings,c=function(t){r.__extends(e,t);function e(){var e=t.call(this,{})||this;e.name="ShowNotShared";e._dialogProvider=e.resources.consume(u.resourceKey);return e}e.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:l.titleNotShared,component:{name:a.default.tagName,params:{text:l.textNotShared}},actions:[]}).wait().then(function(){return s.default.wrap({resultType:o.ResultTypeEnum.Success})})};return e}(i.default);t.default=c});define("odsp-next/models/item/command/CoreItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClick=new r.default("defaultClick")});define("odsp-next/actions/delete/odc/DeleteAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(i,e,t,o,n,r,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Delete";t.logStartEnd=!0;t._currentItem=t.resources.consume(a.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/delete/odc/DeleteExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/delete/odc/DeleteExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var i=this;return this._currentItem()&&this.selectionHelper.filterItems(function(e){var t=!!e.parent&&e.parent.isBundle,r=!!e.parent&&e.parent.isAlbum;return i.itemCommandHelper.isCommandSupported(e,s.deleteItem)&&e.queryType!==n.default.SharedWithMe&&e.queryType!==n.default.DocsInCommon&&!t&&!r})};return e}(r.default);e.default=u});define("odsp-next/actions/download/odc/DownloadAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../dataSources/url/QueryType","../../../models/item/command/WebItemCommandKeys","../../../actions/base/ItemCommandHelper"],function(i,e,t,o,r,n,a,s,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._itemCommandHelper=new(t.managed(u.default));t.name="Download";t.overrideItem=e.item;t._currentItem=t.resources.consume(n.currentItem);t._itemCommandHelper=new(t.managed(u.default));return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/download/odc/DownloadExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/download/odc/DownloadExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};e.prototype.onIsAvailable=function(){var t=this,e=this.selectionHelper.selection(),r=this._currentItem(),i=1<e.length&&r.queryType===a.default.SharedWithMe&&r.isRootFolder;return this._currentItem()&&this.selectionHelper.filterItems(function(e){return!i&&t._itemCommandHelper.isCommandSupported(e,s.download)})||this.overrideItem&&!!this.overrideItem()};return e}(r.default);e.default=l});define("odsp-next/actions/editTags/odc/EditTagsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys"],function(i,e,t,o,n,a,r,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="EditTagsAction";t._itemCommandHelper=new(t.managed(n.default));t._currentItem=t.resources.consume(s.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/editTags/odc/EditTagsExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/editTags/odc/EditTagsExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var t=this;return this.selectionHelper.filterItems(function(e){return e&&(!!e.photo||!!e.video)&&t._itemCommandHelper.isCommandSupported(e,a.editTags)})};return e}(r.default);e.default=u});define("odsp-next/actions/embed/odc/EmbedAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys"],function(i,e,t,o,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Embed";return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/embed/odc/EmbedExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/embed/odc/EmbedExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,n.embed)};return e}(r.default);e.default=a});define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/DataSourceResourceKeys","../../../controls/commands/Commands.resx","../../../models/item/command/FileSystemItemCommandKeys"],function(i,e,t,o,n,a,r,s,u,l,c,d,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var m=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="EmptyRecycleBin";t._urlDataSource=t.resources.consume(c.url);t._strings=d.strings;t._usePollGetItemsForDeletion=e.usePollGetItemsForDeletion;t._currentItem=t.resources.consume(s.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,p.deleteAllItems)&&this._urlDataSource.isRecycleBin(t.queryType)&&0<t.childCount&&0===e.length};e.prototype.onExecute=function(e){var t=this;return this._usePollGetItemsForDeletion?r.prototype.onExecute.call(this,e):this.resources.consume(l.resourceKey).requestDialog({title:this._strings.emptyRecycleBin,component:{name:u.default.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return o.default.wrap(2)},isAvailable:this.createObservable(!0),icon:new n.default("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return o.default.wrap(3)},isAvailable:this.createObservable(!0),icon:new n.default("Cancel"),isDefault:!0}]}).wait().then(function(){return r.prototype.onExecute.call(t,e)}).then(function(){return{resultType:a.ResultTypeEnum.Success}})};return e}(r.default);e.default=m});define("odsp-next/actions/navigateToItem/NavigateToItemAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../base/ItemSelectionHelper"],function(e,t,r,i,y,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(v){r.__extends(e,v);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=v.call(this,e)||this;r.name="NavigateToItem";r._urlDataSource=r.resources.consume(b.url);r._viewParams=r.resources.consume(y.viewParams);var i=e.item,o=e.itemSet,n=void 0===o?r.resources.consume(y.currentItemSet):o,a=e.forceAsFocusItem,s=void 0!==a&&a,u=e.isRedirect,l=void 0!==u&&u,c=e.forceInSameWindow,d=void 0!==c&&c,p=e.shouldPreserveAction,m=void 0!==p&&p;r._itemSet=n;r._forceAsFocusItem=r.wrapObservable(s);r._isRedirect=l;r._forceInSameWindow=r.wrapObservable(d);r._shouldPreserveAction=r.wrapObservable(m);var f=t.ItemSelectionHelper,h=void 0===f?_.default:f;r._itemSelectionHelper=new(r.managed(h))({overrideItem:i,allowMultiSelect:!1,canFallback:!0});r._url=r.createPureComputed(r._computeUrl);r._target=r.createPureComputed(r._computeTarget);var g=r.resources.consume(y.actionMap);r._navigationAction=new(r.managed(g.NavigationAction))({url:r._url,ignoreHistory:r._isRedirect,target:r._target});return r}e.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};e.prototype.onExecute=function(e){return this._navigationAction.execute(e)};e.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:this._forceAsFocusItem(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet(),viewParams:this._viewParams()})||""};e.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return e}(i.default);t.default=o});define("odsp-next/actions/sort/od/OneDriveSortAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./../SortAction","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","./SortActionMode"],function(e,t,i,r,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="Sort";t._sortManager=t.resources.consume(u.sortManager);t._currentItemSet=t.resources.consume(s.currentItemSet);t._mode=e.mode;t._column=e.column;t._ascending=e.ascending;return t}e.prototype.onExecute=function(e,t){var r=a.default.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=r);var i={sortMode:l.default[this._mode],sortAscending:"Ascending"};this._column&&(i.sortColumn=this._column.internalName||this._column.key);if(this._mode===l.default.Column)this.updateCurrentSort(this._column,r.isAscending);else if(this._mode===l.default.Order){if(this._currentItemSet&&this._currentItemSet().schema){i.sortAscending=this._ascending?"Ascending":"Descending";this.updateCurrentSort(r,this._ascending)}}else o.default.wrap({resultType:n.ResultTypeEnum.Failure});return o.default.wrap({resultType:n.ResultTypeEnum.Success,extraData:i})};e.prototype.onIsAvailable=function(){return!!this._currentItemSet&&!!a.default.getSortedColumn(this._currentItemSet().schema)};e.prototype.onIsToggled=function(){var e=!1;if(this._mode===l.default.Column&&this._column)e=this._column.isSorted;else if(this._mode===l.default.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=a.default.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return e};e.prototype.updateCurrentSort=function(e,t){if(e){var r=e.internalName||e.key;this._sortManager.updateSort(r,t)}};return e}(r.default);t.default=c});define("odsp-next/actions/sort/SortAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/PagesResourceKeys"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SortAction";t._sortManager=t.resources.consume(a.sortManager);t._column=e.column;t._ascending=e.ascending;return t}e.getSortedColumn=function(e){var t,r=e();if(r)for(var i=0;i<r.length;i++)if(r[i]&&r[i].isSorted){t=r[i];break}return t};e.prototype.onExecute=function(e,t){this._updateCurrentSort(this._column,this._ascending);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};e.prototype.onIsToggled=function(){var e=!1;this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending);return e};e.prototype._updateCurrentSort=function(e,t){if(e){var r=e.internalName||e.key,i=this.resources.consume(a.dataManager.optional);i&&i.currentView()&&i.setSortingParametersToDataStore(i.currentView.peek().id,{fieldName:r,isAscending:t});this._sortManager.updateSort(r,t)}};return e}(r.default);t.default=s});define("odsp-next/resources/PagesResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortManager=new r.ResourceKey("sortManager");t.dataManager=new r.ResourceKey("dataManager");t.listViewContextMenuCommandSet=new r.ResourceKey("listViewContextMenuCommandSet");t.topCommandSet=new r.ResourceKey("topCommandSet");t.listViewContextMenuHelper=new r.ResourceKey("listViewContextMenuHelper");t.fileContent=new r.ResourceKey("fileContent");t.contentRange=new r.ResourceKey("contentRange");t.error=new r.ResourceKey("error");!function(e){!function(e){e.isLeftNavPresent=new r.ResourceKey("base.leftNav.isLeftNavPresent");e.isLeftNavClosing=new r.ResourceKey("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new r.ResourceKey("base.leftNav.isLeftNavVisible");e.hideLeftNav=new r.ResourceKey("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new r.ResourceKey("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new r.ResourceKey("base.leftNav.toggleIsLeftNavUserExpanded")}(e.leftNav||(e.leftNav={}));!function(e){e.isTopBarVisible=new r.ResourceKey("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new r.ResourceKey("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new r.ResourceKey("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new r.ResourceKey("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new r.ResourceKey("base.suiteNav.isSuiteNavHidden")}(e.suiteNav||(e.suiteNav={}));!function(e){e.commandSet=new r.ResourceKey("base.commandBar.commandSet");e.isDarkTheme=new r.ResourceKey("base.commandBar.isDarkTheme");e.isSearchHidden=new r.ResourceKey("base.commandBar.isSearchHidden")}(e.commandBar||(e.commandBar={}));!function(e){e.isInfoPaneExpanded=new r.ResourceKey("base.infoPane.isInfoPaneExpanded");e.infoPane=new r.ResourceKey("base.infoPane.infoPane");e.isInfoPaneAvailable=new r.ResourceKey("base.infoPane.isInfoPaneAvailable");e.hidePreview=new r.ResourceKey("base.infoPane.hidePreview")}(e.infoPane||(e.infoPane={}));!function(e){e.isFiltersPaneExpanded=new r.ResourceKey("base.infoPane.isFiltersPaneExpanded");e.isFiltersPaneAvailable=new r.ResourceKey("base.infoPane.isFiltersPaneAvailable")}(e.filtersPane||(e.filtersPane={}));!function(e){e.isColumnCustomizationPaneExpanded=new r.ResourceKey("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new r.ResourceKey("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new r.ResourceKey("base.columnCustomizationPane.viewToFormat")}(e.columnCustomizationPane||(e.columnCustomizationPane={}));e.contextMenuHelper=new r.ResourceKey("base.contextMenuHelper");e.isRetrievingData=new r.ResourceKey("base.isRetrievingData");e.isSmartBannerVisible=new r.ResourceKey("base.isSmartBannerVisible")}(t.base||(t.base={}));!function(e){e.layoutType=new r.ResourceKey("files.layoutType");e.resx=new r.ResourceKey("files.resx");e.isArrangeControlVisible=new r.ResourceKey("files.isArrangeControlVisible")}(t.files||(t.files={}));(t.photos||(t.photos={})).layoutType=new r.ResourceKey("photos.layoutType");(t.storageInfo||(t.storageInfo={})).layoutType=new r.ResourceKey("storageInfo.layoutType");t.eventScope=new r.ResourceKey("eventScope")});define("odsp-next/actions/sort/od/SortActionMode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Column=0]="Column";e[e.Order=1]="Order"}(r||(r={}));t.default=r});define("odsp-next/actions/odc/OpenAction",["require","exports","tslib","../OpenAction","../base/ItemCommandHelper","../../models/item/command/CoreItemCommandKeys"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._itemCommandHelper=new(t.managed(o.default));return t}e.prototype.onIsAvailable=function(){var e=this.item();return r.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(e,n.defaultClick)};return e}(r.default);t.default=a});define("odsp-next/actions/OpenAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../models/item/ItemType","./base/ItemSelectionHelper","../utilities/optimizely/ExperimentsCommon.key","../utilities/features/Features","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,i,o,n,b,a,_,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(y){r.__extends(e,y);function e(e){void 0===e&&(e={});var t=y.call(this,e)||this;t.name="Open";var r=e.item,i=e.openRelation,o=void 0===i?0:i,n=e.ignoreHistory,a=void 0!==n&&n,s=e.itemSet,u=void 0===s?t.resources.consume(b.currentItemSet):s,l=e.openLocal,c=void 0!==l&&l,d=e.focusUrl,p=void 0!==d&&d,m=e.preserveAction,f=void 0!==m&&m,h=e.nonFoldersOnly,g=void 0!==h&&h;t._openRelation=o;t._nonFoldersOnly=g;t._focusUrl=t.wrapObservable(p);t._itemSelectionHelper=new(t.managed(_.default))({overrideItem:2===o?r:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});t.item=t.createComputed(t._computeItem,{deferEvaluation:!0,pure:!0});var v=t.resources.consume(b.actionMap);t._navigateToItemAction=new(t.managed(v.NavigateToItemAction))({item:t.item,itemSet:u,forceAsFocusItem:t.createPureComputed(t._computeForceAsFocusItem),forceInSameWindow:c,isRedirect:a,shouldPreserveAction:f});return t}e.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||e&&!e.folder)&&this._navigateToItemAction.isAvailable()};e.prototype.onExecute=function(e,t){var r=this.item.peek();r.type===a.default.Folder&&t&&t.data&&(t.data.folder=!0);t.data.extraData||(t.data.extraData={});l.extend(t.data.extraData,{uniqueId:r.properties?r.properties.uniqueId:void 0});u.isOneDrive&&this.trackPromise(this.resources.consumeAsync(s.resourceKey).then(function(e){e.fireReadEvent(r)}));return this._navigateToItemAction.execute(e).then(function(){var e={fileType:a.default[r.type],extension:r.extension||""};return o.default.wrap({resultType:n.ResultTypeEnum.Success,extraData:e})})};e.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e};e.prototype._computeForceAsFocusItem=function(){return this._focusUrl()};return e}(i.default);t.default=c});define("odsp-next/actions/preview/PreviewAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../base/ItemSelectionHelper","../../dataSources/url/QueryType","../../models/item/ItemParentHelper","../../utilities/features/Features"],function(e,t,r,i,o,n,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Preview";var r=t.resources.consume(o.actionMap);t._dataStore=new n.default("",a.default.local);t._itemSelectionHelper=new(t.managed(s.default))({allowMultiSelect:!1,overrideItem:e.item,canFallback:!1});t._openAction=new(t.managed(r.OpenAction))({focusUrl:t.observables.compute(t._computeFocusUrl),item:e.item,openRelation:e.item?2:void 0,nonFoldersOnly:!0});t._itemParentHelper=t.resources.consume(l.resourceKey);return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=null;e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")));return e&&!e.external&&this._openAction.isAvailable()&&(c.isFeatureEnabled(c.ODBVroomSharedWithMe)||e.queryType!==u.default.SharedWithMe)&&(!t||!t.list||t.list.isDocumentLibrary)};e.prototype.onExecute=function(e,t){var r=this._itemSelectionHelper.firstItem.peek();!r||"ms-word"!==r.appMap&&"ms-powerpoint"!==r.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date);return this._openAction.execute(e)};e.prototype._computeFocusUrl=function(){var e=this._itemSelectionHelper.firstItem(),t=this.resources.consume(o.isInNewRecentView.optional);return!(e&&e.queryType===u.default.Recent&&t&&t())};return e}(i.default);t.default=d});define("odsp-next/actions/odc/OpenInOfficeClientAction",["require","exports","tslib","../OpenInOfficeClientAction","./SkyApiHelper","../../dataSources/url/odc/UrlDataSource","./OfficeActionIdMap","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ODCResourceKeys","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","../base/ItemRedeemer","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,i,a,s,u,l,o,n,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m,f=((m={})[1]=u.default.Excel,m[2]=u.default.OneNote,m[3]=u.default.PowerPoint,m[4]=u.default.Word,m[5]=u.default.Visio,m[6]=u.default.Project,m[7]=u.default.Publisher,m),h=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(o.urlDataSource);t._itemReedemer=new(t.managed(d.default));t._itemCommandHelper=new(t.managed(n.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,c.openInClient)};e.prototype.onSelectionExecute=function(e,t,r){var o=this;i.prototype.onSelectionExecute.call(this,e,t,r);var n=e[0];r.data.extraData||(r.data.extraData={});p.extend(r.data.extraData,{fileType:n.extension?n.extension.toLowerCase():void 0});return this._itemReedemer.redeemItem(n,this).then(function(){if(o.platform.isMobile){var e=o.navigation,t=o._urlDataSource;e.navigateTo(t.getOpenInOfficeClientUrl(n,o.navigation.viewParams,s.default.viewerId));return{resultType:l.ResultTypeEnum.Success}}var r=o._itemCommandHelper.getCommandBehavior(n,c.openInClient),i=f[r];return a.openInClient(n,s.default.viewerId,n.isGroup,u.default[i],o.resources)})};return e}(i.default);t.default=h});define("odsp-next/actions/OpenInOfficeClientAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../utilities/optimizely/ExperimentsCommon.key","../utilities/features/Features"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="OpenInOfficeClient";t.isSingleSelectAction=!0;t.canFallbackToParent=!0;t.platform=t.resources.consume(a.platformDetection);t.navigation=t.resources.consume(n.navigation);return t}e.prototype.onIsAvailable=function(){return r.prototype.onIsAvailable.call(this)&&(this.platform.isMac||this.platform.isWindows||this.platform.isIOS||this.platform.isWinPhone||this.platform.isAndroid)};e.prototype.onSelectionIsAvailable=function(e,t){return!1};e.prototype.onSelectionExecute=function(e,t,r){u.isOneDrive&&this.trackPromise(this.resources.consumeAsync(s.resourceKey).then(function(e){e.fireOpenInOfficeClientEvent();e.fireReadEvent()}));return o.default.wrap(null)};return e}(r.default);t.default=l});define("odsp-next/actions/OpenPdfInBrowserAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./base/ItemCommandHelper","../models/item/command/FileSystemItemCommandKeys","../utilities/item/ListItemTypeConverter"],function(e,t,i,r,o,n,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="OpenPdfInBrowserAction";t.isSingleSelectAction=!0;t.urlDataSource=t.resources.consume(a.url);t.navigation=t.resources.consume(s.navigation);t._itemCommandHelper=t.resources.consume(u.resourceKey);return t}e.prototype.onSelectionIsAvailable=function(e,t){return c.canListItemBeOpened(t,this.urlDataSource)&&this._itemCommandHelper.isCommandSupported(t,l.openPdfInBrowser)&&".pdf"===t.extension.toLowerCase()};e.prototype.onSelectionExecute=function(e,t,r){var i=e[0];this.navigation.navigateTo({url:i.openUrl,frameId:"_blank"});return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(r.default);t.default=d});define("odsp-next/utilities/item/ListItemTypeConverter",["require","exports","@ms/odsp-datasources/lib/Permissions"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertToISPListItem=function(e){return e};t.convertToIOneDriveItem=function(e){return e};t.canListItemBeOpened=function(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus&&r.PermissionMask.hasItemPermission(e,r.PermissionMask.openItems)}});define("odsp-next/actions/odc/OpenInOfficeOnlineAction",["require","exports","tslib","cookies","../OpenInOfficeOnlineAction","./SkyApiHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/url/QueryType","../../dataSources/url/odc/UrlDataSource","../../models/item/command/OfficeItemCommandKeys","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,o,i,n,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});return i.call(this,e)||this}e.prototype.onIsAvailable=function(){var e=this.item();return!!e&&((e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,l.openOnline))&&e.queryType!==s.default.RecycleBin)};e.prototype.onExecute=function(e,t){var r=this.item.peek();r.queryType!==s.default.Search&&n.refreshItemWhenVisible(r.parent.isStub?r:r.parent,this.resources,!0);t.data.extraData||(t.data.extraData={});c.extend(t.data.extraData,{fileType:r.extension?r.extension.toLowerCase():void 0});o.set("BP",a.serializeQuery({FR:"SDX.Skydrive*Root",ST:(new Date).getTime()}),{domain:u.default.getCookieDomain()});return i.prototype.onExecute.call(this,e,t)};return e}(i.default);t.default=d});define("odsp-next/actions/OpenInOfficeOnlineAction",["require","exports","tslib","../base/BaseAction","../resources/DataSourceResourceKeys","../utilities/optimizely/ExperimentsCommon.key","./base/ItemCommandHelper","../models/item/command/OfficeItemCommandKeys","../utilities/features/Features","./base/ItemSelectionHelper","../resources/ControlResourceKeys","../utilities/browser/WebViewDetector","../utilities/killSwitch/KillSwitch"],function(e,t,r,i,d,o,p,n,a,m,f,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(c){r.__extends(e,c);function e(e){void 0===e&&(e={});var t=c.call(this,e)||this;t.name="OpenInOfficeOnline";var r=e.openLocal,i=void 0!==r&&r,o=e.forceReadOnly,n=void 0!==o&&o,a=e.useDefaultAction,s=void 0!==a&&a;t._forceReadOnly=n;t._useDefaultAction=s;t._urlDataSource=t.resources.consume(d.url);t._viewParams=t.resources.consume(f.viewParams);t._itemSelectionHelper=new(t.managed(m.default))({overrideItem:e.item});t._itemCommandHelper=t.resources.consume(p.resourceKey);t.item=t._itemSelectionHelper.firstItem;t._url=t.createPureComputed(t._computeUrl);t._webViewDetector=t.resources.consume(h.resourceKey);var u=!1;g.default.isActivated("faf037ab-8846-45b3-b211-9c64b0722d50","07/13/2018","SPD Open Office Online In-App")||(u=t._webViewDetector.isSharePointDesktopApp());var l=t.resources.consume(f.actionMap);t._navigationAction=new(t.managed(l.NavigationAction))({url:t._url,target:i||u?void 0:"_blank",postProcessUrl:function(e){return t._postProcessUrl(e)}});return t}e.prototype._postProcessUrl=function(e){return e};e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,n.openOnline)&&this._navigationAction.isAvailable()};e.prototype.onExecute=function(e,t){a.isOneDrive&&this.trackPromise(this.resources.consumeAsync(o.resourceKey).then(function(e){e.fireOpenInOfficeOnlineEvent()}));return this._navigationAction.execute(e)};e.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return e}(i.default);t.default=s});define("odsp-next/utilities/browser/WebViewDetector",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=location.search,o=function(){function e(){}e.prototype.isWebViewHosted=function(){var e=/[?&]env=WebView/.test(i)||this.isTeamsWebView()||this._isEmbedded();this.isWebViewHosted=function(){return e};return e};e.prototype.isOneDriveWinApp=function(){var e=/[?&]env=OneDriveWinApp/.test(i)&&-1!==navigator.userAgent.indexOf("WebView/3.0");this.isOneDriveWinApp=function(){return e};return e};e.prototype.isSharePointDesktopApp=function(){var e=-1!==navigator.userAgent.indexOf("SharePointDesktop")||/[?&]env=Desktop/.test(i);this.isSharePointDesktopApp=function(){return e};return e};e.prototype.isTeamsWebView=function(){var e=navigator.userAgent,t=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e);this.isTeamsWebView=function(){return t};return t};e.prototype._isEmbedded=function(){try{return!this.isSharePointDesktopApp()&&(window.parent&&window.parent!==window&&-1===navigator.userAgent.indexOf("PhantomJS/")||/[?&]env=Embedded/.test(i))}catch(e){return!1}};return e}();t.WebViewDetector=o;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.SimpleResourceFactory(o)})});define("odsp-next/actions/openInTextEditor/OpenInTextEditorAction",["require","exports","tslib","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/BaseAction","../../resources/DataSourceResourceKeys","../../utilities/mime/MimeHelper","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/FileSystemItemCommandKeys","../../resources/ControlResourceKeys","../../dataSources/url/QueryType","../../utilities/features/Features"],function(e,t,r,n,i,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.name="OpenInTextEditor";var r=t.resources;t._urlDataSource=r.consume(a.url);t._viewParams=r.consume(d.viewParams);t._currentItemSet=r.consume(d.currentItemSet);t._itemCommandHelper=r.consume(l.resourceKey);t._platformDetection=r.consume(n.platformDetection);t._url=t.createPureComputed(t._computeUrl);t._itemSelectionHelper=new(t.managed(u.default))({overrideItem:e.item});var i=r.consume(d.actionMap);t._navigationAction=new(t.managed(i.NavigationAction))({url:t._url,target:"_blank"});return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,c.openInTextEditor)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&e&&e.parent&&s.canOpenItemInMonaco(e)&&(m.isFeatureEnabled(m.ODBVroomSharedWithMe)||e.queryType!==p.default.SharedWithMe)&&!this._urlDataSource.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus};e.prototype.onExecute=function(e){return this._navigationAction.execute(e)};e.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.parent?this._urlDataSource.getTextEditorItemUrl(e,{itemSet:this._currentItemSet(),viewParams:this._viewParams()}):""};return e}(i.default);t.default=o});define("odsp-next/actions/orderPrints/odc/OrderPrintsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","@ms/odsp-datasources/lib/Permissions","../../../dataSources/url/QueryType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/templates/ExecutorAction"],function(i,e,t,o,n,a,s,u,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="OrderPrints";t._platformDetection=t.resources.consume(u.platformDetection);t._identity=t.resources.consume(n.identity).getIdentity();return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/orderPrints/odc/OrderPrintsExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/orderPrints/odc/OrderPrintsExecutor"],e,t)})}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.onIsAvailable=function(){if(this._identity.type===a.IdentityType.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,r=e&&e.queryType,i=r===s.default.Files||r===s.default.Photos||r===s.default.Search||r===s.default.AllMyPhotos||r===s.default.SharedWithMe;return!(!t||!i)&&(this._identity.type!==a.IdentityType.aad&&e.photo&&1<=t&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac)};return e}(r.default);e.default=l});define("odsp-next/actions/odc/PlayAudioAction",["require","exports","tslib","../base/ItemCommandHelper","../base/ItemSelectionHelper","../../base/BaseAction","../../dataSources/url/QueryType","../../models/item/command/PhotoItemCommandKeys","../../resources/ControlResourceKeys","../../utilities/features/Features"],function(e,t,r,a,s,i,o,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){r.__extends(e,n);function e(e){void 0===e&&(e={});var t=n.call(this,e)||this;t.name="PlayAudio";var r,i=t.resources.consume(l.actionMap),o=t.observables;t._item=new(t.managed(s.default))({overrideItem:e.item,allowMultiSelect:!1,canFallback:!1}).firstItem;r=c.isFeatureEnabled(c.EnableAudioPlayer)?new(t.managed(i.OpenAction))({focusUrl:o.pureCompute(t._computeFocusUrl),item:e.item,nonFoldersOnly:!0}):new(t.managed(i.NavigationAction))({url:o.pureCompute(t._computeGrooveUrl),target:"_blank"});t._action=r;t._itemCommandHelper=new(t.managed(a.default));return t}e.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()&&(c.isFeatureEnabled(c.EnableAudioPlayer)||this._itemCommandHelper.isCommandSupported(e,u.play))};e.prototype.onExecute=function(e,t){return this._action.execute(e)};e.prototype._computeFocusUrl=function(){var e=this._item(),t=this.resources.consume(l.isInNewRecentView.optional);return!(e&&e.queryType===o.default.Recent&&t&&t())};e.prototype._computeGrooveUrl=function(){var e=this._item();return e&&"https://music.microsoft.com/cloud/track/"+e.id};return e}(i.default);t.default=n});define("odsp-next/actions/odc/PlaySlideShowAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="PlaySlideShow";e.isSingleSelectAction=!0;e.canFallbackToParent=!0;return e}e.prototype.onSelectionIsAvailable=function(e,t){this._slideshowState=this.resources.consume(a.slideshowState);return!!t.photo&&this._slideshowState&&!this._slideshowState.isSlideShowModeEnabled()};e.prototype.onSelectionExecute=function(e,t,r){this._slideshowState.isSlideShowModeEnabled(!0);return this._slideshowState.enterSlideshowMode()?o.default.wrap({resultType:n.ResultTypeEnum.Success}):o.default.wrapError({resultType:n.ResultTypeEnum.Failure})};return e}(i.default);t.default=s});define("odsp-next/actions/odc/StopSlideShowAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="StopSlideShow";e.isSingleSelectAction=!0;e.canFallbackToParent=!0;return e}e.prototype.onSelectionIsAvailable=function(e,t){this._slideshowState=this.resources.consume(a.slideshowState);return this._slideshowState&&this._slideshowState.isSlideShowModeEnabled()};e.prototype.onSelectionExecute=function(e,t,r){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?o.default.wrap({resultType:n.ResultTypeEnum.Success}):o.default.wrapError({resultType:n.ResultTypeEnum.Failure})};return e}(i.default);t.default=s});define("odsp-next/actions/odc/RemoveCoverPhotoAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys","../base/ItemRedeemer","../../providers/item/ItemProvider","../../dataSources/url/QueryType"],function(e,t,i,r,o,n,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="RemoveCoverPhotoAction";t._itemReedemer=new(t.managed(s.default));t._itemCommandHelper=new(t.managed(n.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,a.removeAsCoverPhoto)&&t.queryType!==l.default.SharedWithMe};e.prototype.onSelectionExecute=function(r,e,t){var i=this;return this._itemReedemer.redeemItems(r,this).then(function(){var e=i.resources.consume(u.resourceKey),t=r[0].parent;return e.removeCoverPhotos({items:r,target:t}).then(function(){return{resultType:o.ResultTypeEnum.Success}})})};return e}(r.default);t.default=c});define("odsp-next/actions/odc/RemoveFromRecentAction",["require","exports","tslib","../RemoveFromRecentAction","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._itemCommandHelper=new(e.managed(o.default));return e}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,n.removeFromRecent)};return e}(i.default);t.default=a});define("odsp-next/actions/RemoveFromRecentAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/item/ItemProvider"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="RemoveFromRecent";return e}e.prototype.onSelectionIsAvailable=function(e,t){return this.item().queryType===o.default.Recent};e.prototype.onSelectionExecute=function(e,t,r){var i=this.item(),o=this.resources.consume(a.resourceKey);this.selectionModel.clear();return o.removeFromRecent({parentKey:i.key,items:e}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(i.default);t.default=s});define("odsp-next/actions/odc/RemoveTagAction",["require","exports","tslib","../RemoveTagAction","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys","../base/ItemRedeemer"],function(e,t,r,i,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._itemReedemer=new(t.managed(s.default));t._itemCommandHelper=new(t.managed(n.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,a.removeTags)};e.prototype.onSelectionExecute=function(e,t,r){var i=this;return this._itemReedemer.redeemItems(e,this).then(function(){return o.prototype.onSelectionExecute.call(i,e,t,r)})};return e}(i.default);t.default=o});define("odsp-next/actions/RemoveTagAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../base/BaseSelectionAction","../resources/ControlResourceKeys"],function(e,t,i,n,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="RemoveTag";t.itemSet=t.resources.consume(o.currentItemSet);t._tag=e.tag;t._tagProvider=t.resources.consume(a.tag);return t}e.prototype.onSelectionExecute=function(e,t,r){var i=this._tag.peek(),o=this.resources.consume(a.photo).getAllPhotosSettings().peek();return this._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[i],parentKey:this.itemSet.peek().key,rootItemId:o.rootId}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(r.default);t.default=s});define("odsp-next/actions/rename/odc/RenameAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(i,e,t,o,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="Rename";return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/rename/odc/RenameExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/rename/odc/RenameExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,n.rename)};return e}(r.default);e.default=a});define("odsp-next/actions/restore/RestoreAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../base/ItemCommandHelper","../../resources/DataSourceResourceKeys","../../models/item/command/FileSystemItemCommandKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,t,i,e,o,n,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restoreItemsOperatorTypeResourceKey=new c.ResourceKey({name:r("module").id+".restoreItemsOperator",loader:new c.AliasResourceLoader(function(){return d.loadModuleExport({path:"./RestoreItemsOperator",getModule:function(){return new a.default(function(e,t){r(["./RestoreItemsOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var p=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(u.url);t._itemSelectionHelper=new(t.managed(o.default))({allowMultiSelect:!0,overrideItem:e.item});t._itemCommandHelper=new(t.managed(s.default));return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),r=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(r))&&this._itemCommandHelper.isCommandSupported(e,l.restoreItem)};e.prototype.onExecute=function(e){var i=this,o=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(r){return i.resources.consumeAsync(t.restoreItemsOperatorTypeResourceKey).then(function(e){var t=new e({parentKey:o,items:r});i.trackPromise(t.start());return t.wait()})}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(e.default);t.RestoreAction=p;t.default=p});define("odsp-next/actions/restoreAll/odc/RestoreAllAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../resources/ControlResourceKeys"],function(i,e,t,o,r,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="RestoreAll";t._itemCommandHelper=new(t.managed(n.default));t._currentItem=t.resources.consume(s.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/restoreAll/odc/RestoreAllExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/restoreAll/odc/RestoreAllExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&0<t.childCount&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,a.restoreAllItems)};return e}(r.default);e.default=u});define("odsp-next/actions/rotate/RotateAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","../base/ItemCommandHelper","../base/ItemRedeemer","../../models/item/command/PhotoItemCommandKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared/lib/base/Rotation"],function(r,t,i,e,n,o,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rotateItemsOperatorTypeResourceKey=new c.ResourceKey({name:""+r("module").id,loader:new c.AliasResourceLoader(function(){return d.loadModuleExport({path:"./RotateItemsOperator",getModule:function(){return new l.default(function(e,t){r(["./RotateItemsOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var m=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._itemSelectionHelper=new(t.managed(o.default))({allowMultiSelect:!0,overrideItem:e.item});t._itemCommandHelper=new(t.managed(a.default));t._itemRedeemer=new(t.managed(s.default));return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,u.rotate)};e.prototype.onExecute=function(e){var i=this,o=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(r){return i._itemRedeemer.redeemItems(r,i).then(function(){return i.resources.consumeAsync(t.rotateItemsOperatorTypeResourceKey)}).then(function(e){var t=new e({items:r,parentKey:o,rotation:p.default.right});return i.trackPromise(t.start())})}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(e.default);t.RotateAction=m;t.default=m});define("@ms/odsp-shared/lib/base/Rotation",["require","exports","tslib","@ms/utilities-image/lib/Rotation","@ms/utilities-image/lib/Rotation"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);t.default=o.default});define("@ms/utilities-image/lib/Rotation",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"}(r=t.Rotation||(t.Rotation={}));t.default=r});define("odsp-next/actions/odc/SaveSortOrderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../sort/SortAction","../../dataSources/item/odc/SortFieldMap","../../dataSources/item/odc/SortDirectionMap","../../dataSources/url/QueryType","../../providers/item/ItemProvider"],function(e,t,i,r,a,s,o,u,l,c,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SaveSort";t._item=t.resources.consume(o.currentItem);t._currentItemSet=t.resources.consume(o.currentItemSet);return t}e.prototype.onExecute=function(e,t){var r=u.default.getSortedColumn(this._currentItemSet().schema);if(!r)return a.default.wrapError({resultType:s.ResultTypeEnum.Failure});var i=r.isAscending,o=l.default[r.internalName||r.key].toString(),n=null===i?c.default.defaultValue.toString():i?c.default.ascending.toString():c.default.descending.toString();return this.resources.consume(d.resourceKey).saveSortOrder({sortOrder:o,sortDirection:n,item:this._item()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};e.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return t===n.default.Files||t===n.default.Photos};return e}(r.default);t.default=p});define("odsp-next/actions/SetFocusAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SetFocus";t._selector=e.selector;t._shouldClick=e.shouldClick;return t}e.prototype.onExecute=function(e,t){var r=document.querySelector(this._selector);if(r){r.focus();this._shouldClick&&n.default.clickElement(r)}return o.default.wrap({resultType:a.ResultTypeEnum.Success})};return e}(r.default);t.default=s});define("odsp-next/actions/shareByLink/odc/ShareByLinkAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../base/templates/ExecutorAction","../../../dataSources/url/QueryType","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper"],function(i,e,t,o,n,r,a,s,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.sharingMethod=e&&e.sharingMethod?e.sharingMethod:null;t._alreadyRedeemed=e&&e.alreadyRedeemed?e.alreadyRedeemed:null;t.name="ShareByLink";t._urlDataSource=t.resources.consume(n.url);t._itemCommandHelper=new(t.managed(u.default));return t}e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,r=1<t&&e.queryType===a.default.SharedWithMe&&e.isRootFolder,i=1<t&&e.isAlbum,o=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,s.share)&&!r&&!i&&!o&&this._allItemsSupportShare()};e.prototype.getExecutorPath=function(){return"odsp-next/actions/shareByLink/odc/ShareByLinkExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/shareByLink/odc/ShareByLinkExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}};e.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i){var o=i();if(!o)return!0;if(!this._itemCommandHelper.isCommandSupported(o,s.share))return!1}}return!0};return e}(r.default);e.default=l});define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../base/ExecutorLoader"],function(i,e,t,r,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ShowKeymap";t._executorLoader=new(t.managed(n.default))({path:"odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor",getModule:function(){return new o.default(function(e,t){i(["odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor"],e,t)})},getExecutorParams:function(){return{}}});return t}e.prototype.onIsAvailable=function(){return!0};e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return e}(r.default);e.default=a});define("odsp-next/actions/showOperations/ShowOperationsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../../providers/operation/OperationProvider","../../models/operation/OperationState"],function(r,e,t,i,o,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._operationProvider=t.resources.consume(a.resourceKey);t.state=t.createPureComputed(t._computeState);return t}e.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==s.default.expired,isToggled:this._operationProvider.isLocked()}};return e}(o.default);e.ShowOperationsHandler=u;var l=n.create({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return new i.default(function(e,t){r(["./ShowOperationsExecutor"],e,t)})}}},handlerType:u});e.default=l});define("odsp-next/actions/base/ControlExecutorAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ControlExecutorLoader"],function(e,t,a,r,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(d){a.__extends(e,d);function e(e){var t=d.call(this,e)||this,r=e.name,i=e.source,o=e.handlerType,n=e.actionParams,a=e.useToggleBehavior,s=void 0!==a&&a;t.name=r;var u=o?new(t.managed(o))(n):void 0,l=u&&u.state||t.createObservable({isAvailable:!0}),c=u&&u.getParams?function(){return u.getParams()}:function(){};t._controlExecutorLoader=new(t.managed(p.default))({source:i,state:l,useToggleBehavior:s,getParams:c});return t}e.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};e.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};e.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return e}(r.default);t.ControlExecutorAction=s;t.create=function(e){var r=e.name,i=e.source,o=e.useToggleBehavior,n=e.handlerType;return function(t){a.__extends(e,t);function e(e){return t.call(this,{name:r,source:i,useToggleBehavior:o,actionParams:e,handlerType:n})||this}return e}(s)}});define("odsp-next/actions/base/ControlExecutorLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","../../providers/hiddenDom/HiddenDomProvider"],function(e,t,s,r,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(u){s.__extends(e,u);function e(e){var t=u.call(this,e)||this,r=e.state,i=e.source,o=e.useToggleBehavior,n=e.getParams;if(i.moduleDefinition){var a=i.moduleDefinition;t._getComponentDefinition=function(){return d.loadModule(a)}}else{var s=i.component;t._getComponentDefinition=function(){return l.default.wrap(s)}}t._useToggleBehavior=o;t._state=r;t._getParams=n;t._action=t.createObservable();t._hiddenDomProvider=t.resources.consume(p.resourceKey);t.isAvailable=t.createPureComputed(t._computeIsAvailable);t.isToggled=t.createPureComputed(t._computeIsToggled);return t}e.prototype.execute=function(r){var i,o=this;if(this._useToggleBehavior){var e=this._action.peek();if(e){e.cancel();return l.default.wrap()}}var n=new c.default,a={complete:function(){n.complete()},fail:function(e){n.error(e)},cancel:function(){n.cancel()}};this._useToggleBehavior&&this._action(a);return l.default.as(this._getParams()).then(function(t){return o._getComponentDefinition().then(function(e){i={name:e.tagName,params:s.__assign({action:a,event:r},t||{},{resources:o.resources})};o._hiddenDomProvider.requestControl(i);return n.getPromise()})}).then(function(){i&&o._hiddenDomProvider.disposeControl(i);o._action.peek()===a&&o._action(void 0)},function(e){i&&o._hiddenDomProvider.disposeControl(i);o._action.peek()===a&&o._action(void 0);return l.default.wrapError(e)})};e.prototype._computeIsAvailable=function(){return this._state().isAvailable};e.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return e}(r.default);t.default=i});define("odsp-next/actions/showPermissions/ShowPermissionsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../controls/infoPane/sections/sharing/SharingSection.css"],function(r,e,t,i,o,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.state=t.createPureComputed(t._computeState);t._itemSelectionHelper=new(t.managed(a.default))({allowMultiSelect:!1,canFallback:!1,overrideItem:e.item});t.engagementSource=e.engagementSource;return t}e.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}};e.prototype._computeState=function(){return{isAvailable:!!this._itemSelectionHelper.firstItem()}};return e}(o.default);e.ShowPermissionsHandler=s;var u=n.create({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return new i.default(function(e,t){r(["./ShowPermissionsExecutor"],e,t)})}}},handlerType:s});e.default=u});define("odsp-next/controls/infoPane/sections/sharing/SharingSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPane-sharing{margin-top:8px}.SharingSection-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:8px 0;font-size:12px}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:170px;padding:0}.SharingSection-addPeople{font-size:17px;font-weight:300;min-height:50px;margin-top:10px}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .SharingSection-addPeople-icon{margin-right:10px}[dir=rtl] .SharingSection-addPeople-icon{margin-left:10px}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.SharingSection-linksBox a{display:inline-block;margin-top:5px}.SharingSection-link,.od-PermissionsPanel-link{padding-top:8px}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:12px}.od-PermissionPile-FacePile{display:inline-block}.od-PermissionsPanel-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-PermissionsPanel-entity{padding:8px 0;font-size:12px}.od-PermissionsPanel-entity .od-Persona{white-space:nowrap}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:17px;font-weight:300;min-height:50px;padding-bottom:10px}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:10px}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:10px}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:5px}.od-PermissionsPanel-link{padding-top:8px}.od-PermissionsPanel-container{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:21px;font-weight:100}.od-PermissionsPanel-fileName{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:25px}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:40px}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:40px}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:3px;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:'';display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:'\\E76B'}.od-PermissionsPanel-titleBar{padding-top:15px;padding-bottom:10px;border-bottom:solid 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:40px}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:40px}.od-PermissionsPanel-content{padding-top:15px;width:300px;height:calc(100% - 110px)}[dir=ltr] .od-PermissionsPanel-content{padding-left:40px}[dir=rtl] .od-PermissionsPanel-content{padding-right:40px}.od-PermissionsPanel-linksBox{padding-bottom:10px}.od-SharingSection-PermissionsPile{width:320px;padding:16px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;margin-bottom:16px}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:10px;cursor:default}.od-SharingSection-PermissionsPile-personas{margin-bottom:4px}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:32px;height:32px;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:4px}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:4px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:1px solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:15px}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:17px}.od-SharingSection-PermissionsPile-numberText{font-size:10px;font-weight:600;padding-top:16px;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:4px;-ms-transform:translateX(-50%);transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:12px;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:10px;font-weight:600;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:4px;padding:2px}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:11px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";vertical-align:top;padding:3px}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-ShowPermissions-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}"}])});define("odsp-next/actions/ShowPropertiesAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","./base/ItemSelectionHelper","../resources/PagesResourceKeys","../resources/ControlResourceKeys","../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/events/EventGroup","../dataSources/url/QueryType"],function(e,t,r,i,o,l,c,d,p,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(u){r.__extends(e,u);function e(e){void 0===e&&(e={});var t=u.call(this,e)||this;t.name="ShowProperties";var r=e.useToggleBehavior,i=void 0!==r&&r,o=e.isSharingSectionExpanded,n=void 0!==o&&o,a=e.allowMultiSelect,s=void 0!==a&&a;t._isInfoPaneExpanded=t.resources.consume(c.base.infoPane.isInfoPaneExpanded);t._isSharingSectionExpanded=t.resources.consume(d.isSharingSectionExpanded.optional);t._isInfoPaneAvailable=t.resources.consume(c.base.infoPane.isInfoPaneAvailable.optional)||t.observables.create(!0);t._isFiltersPaneExpanded=t.resources.consume(c.base.filtersPane.isFiltersPaneExpanded.optional);t._isColumnCustomizationPaneExpanded=t.resources.consume(c.base.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional);t._rumOneHelper=t.resources.consume(p.rumOneHelper.optional);t._useToggleBehavior=i;t._allowMultiSelect=s;t._shouldExpandSharingSection=n;t._itemSelectionHelper=new(t.child(l.default))({allowMultiSelect:t._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});return t}e.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);this._isInfoPaneExpanded(!this._useToggleBehavior||!this._isInfoPaneExpanded.peek());a.default.raise(document.body,"resize",void 0,!0);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){if(!this._isInfoPaneAvailable())return!1;var e=this._itemSelectionHelper.firstItem;if(!e())return!1;var t=[e];this._allowMultiSelect&&(t=this._itemSelectionHelper.selection());for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o){var n=o();if(n&&(n.error||n.isPlaceholder&&n.queryType!==s.default.Search))return!1}}return!0};e.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};return e}(i.default);t.default=u});define("odsp-next/actions/ShowSelectionAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","../dataSources/url/PageType","../controls/list/react/SelectionManager"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ShowSelection";t._urlDataSource=t.resources.consume(a.url);t._isSelectionModal=t.resources.consume(u.isSelectionModalResourceKey);return t}e.prototype.onIsAvailable=function(){return(0<this.selectionModel.selection().length||this._isSelectionModal())&&this._urlDataSource.getPageType()!==s.default.TextFileEditor};e.prototype.onExecute=function(e,t){this.selectionModel.clear();this._isSelectionModal(!1);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(r.default);t.default=l});define("odsp-next/controls/list/react/SelectionManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/interfaces","office-ui-fabric-react/lib/utilities/selection/Selection","../../../models/store/ItemsStore","../../../resources/UtilityResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i,l,a,o,n,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){r.__extends(e,n);function e(e,t){void 0===e&&(e={});var r=n.call(this,e,t)||this,i=r.observables;r._selectionModel=t.itemSetSelectionModel;r._clientSideExtensionHelper=t.clientSideExtensionHelper;r._itemsStore=t.itemsStore;var o=r.selection=new a.Selection({selectionMode:1===r._selectionModel.mode?l.SelectionMode.single:l.SelectionMode.multiple,onSelectionChanged:r._onSelectionChange.bind(r),getKey:r.getKey.bind(r),canSelectItem:r._canSelectItem.bind(r)});r._isModal=i.create(!!o.isModal&&o.isModal());i.compute(r._computeUpdateItems);i.backgroundCompute(r._computeUpdateReactSelection);r.isModal=i.compute({read:function(){return r._isModal()},write:function(e){return o&&o.setModal(e)},pure:!0});return r}e.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem(""+e.key))||""+t};e.prototype._computeUpdateReactSelection=function(){var i=this,o=this._selectionModel,n=this.selection,a=o.selection();this.observables.ignore(function(){if(i._shouldUpdateSelection())if(0===o.mode&&(o.isAllSelected()&&!n.isAllSelected()||0===o.selectedCount()&&n.isAllSelected()))n.setAllSelected(o.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1);n.setAllSelected(!1);for(var e=0,t=a;e<t.length;e++){var r=t[e];n.setKeySelected(o.getItemKey(r),!0,!1)}n.setChangeEvents(!0)}})};e.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,r=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())r=!0;else if(!t.isAllSelected()||1===e.mode)for(var i=0,o=e.selection();i<o.length;i++){var n=o[i];if(!t.isKeySelected(e.getItemKey(n))){r=!0;break}}return r};e.prototype._onSelectionChange=function(){var u=this;this.observables.ignore(function(){var e=u._selectionModel,t=u.selection;u._isModal(!!t.isModal&&t.isModal());if(u._shouldUpdateSelection()){if(t.mode===l.SelectionMode.multiple&&(!e.isAllSelected()&&t.isAllSelected()||e.isAllSelected()&&0===t.count))!e.isAllSelected()&&t.isAllSelected()?e.selectAll():e.clear();else{for(var r=[],i=0,o=t.getSelection();i<o.length;i++){var n=o[i],a=u.getKey(n);r.push(a)}e.setSelectedKeys(r)}var s=u._clientSideExtensionHelper;s&&s.raiseListChangeEvent(t.getSelection())}})};e.prototype._computeUpdateItems=function(){var t=this,r=this._selectionModel.itemSet(),i=[];if(r)for(var e=0,o=r.content().items;e<o.length;e++){var n=o[e],a=this.observables.peekUnwrap(n);a?i.push(a):i.push(void 0)}this.observables.ignore(function(){var e=r&&t.observables.peekUnwrap(r.item);(r&&!r.isPlaceholder||e&&e.isStub)&&t.selection.setItems(i,!1)})};e.prototype._canSelectItem=function(e){return this._selectionModel.canSelectItem(this._itemsStore.getItem(e.key))};return e}(i.default);t.SelectionManager=c;t.selectionManagerResourceKey=new u.ResourceKey({name:e("module").id+".selectionManager",factory:new u.ResolvedResourceFactory(c,r.__assign({},i.default.dependencies,{itemSetSelectionModel:s.itemsSelection,clientSideExtensionHelper:n.clientSideExtensionHelper.optional,itemsStore:o.resourceKey}))});t.getKeyResourceKey=new u.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){var r=e.selectionManager;return{instance:function(e,t){return r.getKey(e,t)}}}}});t.selectionModeResourceKey=new u.ResourceKey({name:e("module").id+".selectionMode",factory:{dependencies:{itemSetSelectionModel:s.itemsSelection},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?l.SelectionMode.multiple:l.SelectionMode.single}}}});t.isSelectionModalResourceKey=new u.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.isModal}}}});t.resourceKey=new u.ResourceKey({name:""+e("module").id,factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.selection}}}});t.hasSelectionResourceKey=new u.ResourceKey({name:e("module").id+".hasSelection",factory:{dependencies:{itemSetSelectionModel:s.itemsSelection,isSelectionModal:t.isSelectionModalResourceKey,observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,r=e.itemSetSelectionModel,i=e.isSelectionModal;return{instance:t.pureCompute(function(){return i()||0<r.selectedCount()}),disposable:t}}}})});define("office-ui-fabric-react/lib/utilities/selection/interfaces",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CHANGE="change";!function(e){e[e.none=0]="none";e[e.single=1]="single";e[e.multiple=2]="multiple"}(t.SelectionMode||(t.SelectionMode={}));!function(e){e[e.horizontal=0]="horizontal";e[e.vertical=1]="vertical"}(t.SelectionDirection||(t.SelectionDirection={}))});define("office-ui-fabric-react/lib/utilities/selection/Selection",["require","exports","./interfaces","../../Utilities"],function(e,t,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){void 0===e&&(e={});var t=e.onSelectionChanged,r=e.getKey,i=e.canSelectItem,o=void 0===i?function(e){return!0}:i,n=e.selectionMode,a=void 0===n?s.SelectionMode.multiple:n;this.mode=a;this._getKey=r||u;this._changeEventSuppressionCount=0;this._exemptedCount=0;this._anchoredIndex=0;this._unselectableCount=0;this._onSelectionChanged=t;this._canSelectItem=o;this._isModal=!1;this.setItems([],!0)}e.prototype.canSelectItem=function(e){return this._canSelectItem(e)};e.prototype.getKey=function(e,t){var r=this._getKey(e,t);return"number"==typeof r||r?""+r:""};e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1;if(0===this._changeEventSuppressionCount&&this._hasChanged){this._hasChanged=!1;t||this._change()}};e.prototype.isModal=function(){return this._isModal};e.prototype.setModal=function(e){if(this._isModal!==e){this.setChangeEvents(!1);(this._isModal=e)||this.setAllSelected(!1);this._change();this.setChangeEvents(!0)}};e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var r={},i={},o=!1;this.setChangeEvents(!1);for(var n=this._unselectableCount=0;n<e.length;n++){if(l=e[n]){var a=this.getKey(l,n);a&&(r[a]=n)}i[n]=l&&!this.canSelectItem(l);i[n]&&this._unselectableCount++}t&&this.setAllSelected(!1);var s={};for(var u in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(u)){var l,c=Number(u),d=(l=this._items[c])?this.getKey(l,Number(c)):void 0,p=d?r[d]:c;if(void 0===p){this.setAllSelected(!1);break}s[p]=!0;o=o||p!==c}this._exemptedIndices=s;this._keyToIndexMap=r;this._unselectableIndices=i;this._items=e||[];this._selectedItems=null;o&&this._change();this.setChangeEvents(!0)};e.prototype.getItems=function(){return this._items};e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems};e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount};e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices};e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var r=e+t,i=e;i<r;i++)if(!this.isIndexSelected(i))return!1;return!0};e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;this.mode===s.SelectionMode.single&&(e=Math.min(e,1));return 0<this.count&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&0<e};e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)};e.prototype.isIndexSelected=function(e){return!!(0<this.count&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])};e.prototype.setAllSelected=function(e){if(!e||this.mode===s.SelectionMode.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1);if(0<t&&(0<this._exemptedCount||e!==this._isAllSelected)){this._exemptedIndices={};if(e!==this._isAllSelected||0<this._exemptedCount){this._exemptedCount=0;this._isAllSelected=e;this._change()}this._updateCount()}this.setChangeEvents(!0)}};e.prototype.setKeySelected=function(e,t,r){var i=this._keyToIndexMap[e];0<=i&&this.setIndexSelected(i,t,r)};e.prototype.setIndexSelected=function(e,t,r){if(this.mode!==s.SelectionMode.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var i=this._exemptedIndices[e];if(!this._unselectableIndices[e]){t&&this.mode===s.SelectionMode.single&&this.setAllSelected(!1);if(i&&(t&&this._isAllSelected||!t&&!this._isAllSelected)){delete this._exemptedIndices[e];this._exemptedCount--}if(!i&&(t&&!this._isAllSelected||!t&&this._isAllSelected)){this._exemptedIndices[e]=!0;this._exemptedCount++}r&&(this._anchoredIndex=e)}this._updateCount();this.setChangeEvents(!0)}};e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)};e.prototype.selectToIndex=function(e,t){if(this.mode!==s.SelectionMode.none)if(this.mode!==s.SelectionMode.single){var r=this._anchoredIndex||0,i=Math.min(e,r),o=Math.max(e,r);this.setChangeEvents(!1);t&&this.setAllSelected(!1);for(;i<=o;i++)this.setIndexSelected(i,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)};e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())};e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)};e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)};e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==s.SelectionMode.none){var r=this.isRangeSelected(e,t),i=e+t;if(!(this.mode===s.SelectionMode.single&&1<t)){this.setChangeEvents(!1);for(var o=e;o<i;o++)this.setIndexSelected(o,!r,!1);this.setChangeEvents(!0)}}};e.prototype._updateCount=function(){var e=this.getSelectedCount();if(e!==this.count){this.count=e;this._change()}this.count||this.setModal(!1)};e.prototype._change=function(){if(0===this._changeEventSuppressionCount){this._selectedItems=null;this._selectedIndices=void 0;r.EventGroup.raise(this,s.SELECTION_CHANGE);this._onSelectionChanged&&this._onSelectionChanged()}else this._hasChanged=!0};return e}();t.Selection=i;function u(e,t){return e&&e.key?e.key:""+t}});define("office-ui-fabric-react/lib/Utilities",["require","exports","tslib","@uifabric/utilities"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("odsp-next/actions/toggleListLayout/odc/ToggleListLayoutAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","../../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../ToggleListLayoutHelper","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil","../../../utilities/optimizely/experiments/NewFeatureDiscovery","../../../utilities/optimizely/OptimizelyHelper"],function(e,t,i,n,r,o,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ToggleListLayout";t._layoutType=a.getValidLayout(e.layoutType);t._shouldClearContextualFilter=void 0===e.clearContextualFilter||e.clearContextualFilter;t._currentItem=t.resources.consume(s.currentItem);t._viewParams=t.resources.consume(s.viewParams);t._actionMap=t.resources.consume(s.actionMap);t._urlDataSource=t.resources.consume(c.url);t._helper=new(t.managed(l.default));return t}e.prototype.onIsAvailable=function(){var e=this._currentItem(),t=e&&e.queryType,r=e.key!==this._urlDataSource.getRootItemKey(o.default.SharedWithMe)&&t!==o.default.DocsInCommon&&t!==o.default.AllMyPhotos,i=!0;this._layoutType===a.SingleAlbum&&(i=t===o.default.Files);return r&&i};e.prototype.onExecute=function(e,t){var r,i=this;this._layoutType===a.SingleAlbum&&m.OptimizelyHelper.trackEvent(p.EXPERIMENT_ID,p.EVENTS.photoViewClicked);if(this._shouldClearContextualFilter){var o=d.extend({},this._viewParams.peek());delete o.ft;r=new(this.managed(this._actionMap.NavigationAction))({url:"#"+u.serializeQuery(o)}).execute(e)}else r=n.default.wrap();return r.then(function(){return i._helper.changeLayout(i._layoutType)},function(){return i._helper.changeLayout(i._layoutType)})};e.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()};return e}(r.default);t.default=f});define("odsp-next/controls/list/layouts/LayoutType",["require","exports","../../../utilities/features/Features"],function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Albums="ms-albums-list";i.AllPhotos=t.isFeatureEnabled(t.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list";i.CustomGridList="ms-grid-customlist";i.CustomList="ms-details-customlist";i.Details="ms-details-list";i.CompactDetails="ms-compact-details-list";i.Grid=t.isFeatureEnabled(t.UseTilesList)?"od-tiles-list":"ms-grid-list";i.SingleAlbum="ms-single-album-list";i.TagGrid="od-tag-grid";i.TagsList="od-tags-list";i.DocumentCardsGrid="od-doccard-grid";i.SharedGrid="od-shared-grid-list";i.SitesGrid="od-sites-grid-list";i.Path=((r={})[i.Albums]="odsp-next/controls/list/AlbumsList",r[i.AllPhotos]=t.isFeatureEnabled(t.UseTilesListForAllPhotos)?"odsp-next/controls/list/TilesList":"odsp-next/controls/list/AllPhotosList",r[i.CustomGridList]="odsp-next/controls/list/CustomGridList",r[i.CustomList]="odsp-next/controls/list/CustomList",r[i.Details]="odsp-next/controls/list/DetailsList",r[i.CompactDetails]="odsp-next/controls/list/CompactDetailsList",r[i.Grid]=t.isFeatureEnabled(t.UseTilesList)?"odsp-next/controls/list/TilesList":"odsp-next/controls/list/GridList",r[i.SingleAlbum]="odsp-next/controls/list/SingleAlbumList",r[i.TagGrid]="odsp-next/controls/list/TagGrid",r[i.TagsList]="odsp-next/controls/list/TagsList",r[i.DocumentCardsGrid]="odsp-next/controls/list/DocumentCardsGridList",r[i.SharedGrid]="odsp-next/controls/list/SharedGridList",r[i.SitesGrid]="odsp-next/controls/list/SitesGridList",r);i.getValidLayout=function(e,t){var r=t&&t.isCustomList;switch(e){case i.Albums:return i.Albums;case i.AllPhotos:return i.AllPhotos;case i.CustomGridList:return r?i.CustomGridList:i.Grid;case i.CustomList:case i.Details:return r?i.CustomList:i.Details;case i.CompactDetails:return i.CompactDetails;case"ms-grid-list":case"od-tiles-list":case i.Grid:return r?i.CustomGridList:i.Grid;case i.SingleAlbum:return i.SingleAlbum;case i.TagGrid:return i.TagGrid;case i.TagsList:return i.TagsList;case i.DocumentCardsGrid:return i.DocumentCardsGrid;case i.SharedGrid:return i.SharedGrid;case i.SitesGrid:return i.SitesGrid;default:return i.Details}};var r});define("odsp-next/actions/toggleListLayout/ToggleListLayoutHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/list/layouts/LayoutType","../../resources/PagesResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/resources/Resources"],function(o,e,t,r,n,a,s,u,l,c,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._pageLayoutType=t.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new c.default);return r}e.prototype._getLayoutType=function(){var t=this,e=this.observables,i=e.create("");e.backgroundCompute(function(){var e=t._pageLayoutType(),r=s.Path[e];t._debouncer.debounce(r?n.loadModule({path:r,getModule:function(){return new l.default(function(e,t){if("undefined"==typeof __webpack_public_path__)window.require([r],e,t);else{e(o.context("odsp-next/controls/list",!0,/\.ts$/)("./"+o("path").relative("odsp-next/controls/list",r)+".ts"))}})}}).then(function(e){return e.tagName}):l.default.wrap("")).then(function(e){i(e)})});return i};e.dependencies=t.__assign({},r.default.dependencies,{pageLayoutType:u.files.layoutType});return e}(r.default);e.LayoutTypeResolver=d;e.layoutTypeResolverKey=new i.ResourceKey({name:o("module").id+".layoutTypeResolver",factory:new i.ResolvedResourceFactory(d)});e.resolvedLayoutTypeResourceKey=new i.ResourceKey({name:o("module").id+".resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:e.layoutTypeResolverKey},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}});var p=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.pageLayoutType=t.resources.consume(u.files.layoutType);return t}e.prototype.changeLayout=function(t){var r=this,i=s.Path[t];return n.loadModule({path:i,getModule:function(){return new l.default(function(e,t){if("undefined"==typeof __webpack_public_path__)window.require([i],e,t);else{e(o.context("odsp-next/controls/list",!0,/\.ts$/)("./"+o("path").relative("odsp-next/controls/list",i)+".ts"))}})}}).then(function(e){r.pageLayoutType(e.tagName);return l.default.wrap({resultType:a.ResultTypeEnum.Success,extraData:{layout:t}})})};return e}(r.default);e.default=p});define("odsp-next/utilities/optimizely/experiments/NewFeatureDiscovery",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=6777012925;t.VARIATIONS=[6783513060,6773715328,6788020464];t.NO_WHATS_NEW_VARIATION=t.VARIATIONS[0];t.PREOPEN_WHATS_NEW_VARIATION=t.VARIATIONS[1];t.PASSIVE_WHATS_NEW_VARIATION=t.VARIATIONS[2];t.EVENTS={officeLensClicked:"OfficeLensClicked",photoViewClicked:"PhotoViewClicked",promotedPhotoClicked:"PromotedPhotoClicked"}});define("odsp-next/actions/viewOriginal/ViewOriginalAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/BaseAction","../base/ItemCommandHelper","../base/ItemSelectionHelper","../NavigationAction","../../models/item/command/PhotoItemCommandKeys"],function(e,t,i,o,r,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ViewOriginal";t._itemCommandHelper=new(t.managed(n.default));t._selectionHelper=new(t.managed(a.default))({allowMultiSelect:!1,canFallback:!1,overrideItem:e.item});t._url=t.observables.pureCompute(function(){var e=t._selectionHelper.firstItem.peek();return e&&e.photo&&e.photo.originalUrl});t._navigationAction=new(t.managed(s.default))({url:t._url,target:"_blank"});return t}e.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,u.viewOriginal)};e.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):o.default.reject({})};return e}(r.default);t.default=l});define("odsp-next/actions/odc/UploadAction",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../models/item/ItemType","../base/ItemRedeemer","../UploadAction"],function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){r.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.logStartEnd=!0;t.name="Upload."+i.UploadProcessorType[t.uploadProcessorType];t._itemRedeemer=new(t.managed(a.default));return t}e.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var e=this.item();return o.prototype.onIsAvailable.call(this)&&e.type===n.default.Folder};e.prototype.onExecute=function(e,t){var r=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return o.prototype.onExecute.call(r,e,t)})};e.prototype._isPlatformSupported=function(){var e=!1;if(!(this.platform.isIPad&&this.platform.browserMajor<6))switch(this.uploadProcessorType){case i.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case i.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e};return e}(o.default);t.default=s});define("odsp-next/actions/UploadAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","../resources/ControlResourceKeys","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/operator/UploadOperator.key","../providers/engagement/Engagement","@ms/odsp-shared/lib/base/ActionInputType","./base/ItemCommandHelper","../models/item/command/WebItemCommandKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../utilities/optimizely/ExperimentsCommon.key","../utilities/features/Features","../utilities/killSwitch/KillSwitch"],function(e,t,i,r,o,n,a,s,u,l,c,d,p,m,f,h,g,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="Upload";t.platform=t.resources.consume(h.platformDetection);t.uploadProcessorType=e.uploadProcessorType;t._onDemandInput=!y.default.isActivated("D3F3420F-5034-4DFC-AC04-D8B19BA8DB85","07/08/2018","Revert back to old file input method for the upload actions");if(t._onDemandInput){t._resetInputElement();t.addDisposable({dispose:function(){if(t._inputElement){document.body.removeChild(t._inputElement);t._inputElement=void 0}}})}else t.inputType=t.createObservable(t._getInputType(t.uploadProcessorType));t._itemCommandHelper=t.resources.consume(m.resourceKey);t.skipInvalidation=!1;return t}e.prototype.onExecute=function(e,t){this.resources.consume(d.resourceKey).logData({name:"Upload.TopMenu.Click",isIntentional:!0});if(!this._onDemandInput){var r=e.target;return this._uploadFiles(r)}var i=new o.default;this._clickHiddenInput(i);return i.getPromise()};e.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this._itemCommandHelper.isCommandSupported(t,f.upload))return!1;switch(this.uploadProcessorType){case s.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case s.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===l.default.Files};e.prototype._resetInputElement=function(){var t=this,e=v.isFeatureEnabled(v.UseReactCommandBar);this._inputElement&&document.body.removeChild(this._inputElement);var r=document.createElement("input");(this._inputElement=r).style.display="none";r.type="file";var i=e?"commandFileInput":"CommandBarItem-fileInput";if(this.uploadProcessorType===s.UploadProcessorType.Folder){i=e?"commandFolderInput":"CommandBarItem-folderInput";r.webkitdirectory=!0}r.className=i;r.multiple=!0;r.onchange=function(e){t._uploadFiles(r).done(function(){t._resetInputElement()})};document.body.appendChild(r)};e.prototype._clickHiddenInput=function(t){var r=this,i=this._inputElement;i.onchange=function(e){r._uploadFiles(i).then(function(e){t.complete(e)},function(e){t.error(e)}).then(function(){r._resetInputElement()})};i.click()};e.prototype._uploadFiles=function(e){var r=this,i=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);v.isOneDrive&&this.trackPromise(this.resources.consumeAsync(g.resourceKey).then(function(e){e.fireUploadEvents()}));if(i){var o=this.resources.consume(a.currentItemSet);return this.resources.consumeAsync(c.asyncTypeResourceKey).then(function(e){var t=new e({files:i,parentItem:r.item.peek(),wasDragAndDropped:!1,type:r.uploadProcessorType,itemSet:o.peek(),skipInvalidation:r.skipInvalidation,isTemplate:r.isTemplate});r.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:u.ResultTypeEnum.Success}})}return n.default.wrap({resultType:u.ResultTypeEnum.ExpectedFailure})};e.prototype._getInputType=function(e){switch(e){case s.UploadProcessorType.Html5file:return p.default.htmlFileUpload;case s.UploadProcessorType.Folder:return p.default.folderUpload;default:return p.default.none}};return e}(r.default);t.default=b});define("odsp-next/providers/operator/UploadOperator.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.asyncTypeResourceKey=new o.ResourceKey({name:""+r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./UploadOperator",getModule:function(){return new t.default(function(e,t){r(["./UploadOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})})});define("@ms/odsp-shared/lib/base/ActionInputType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"}(r||(r={}));t.default=r});define("odsp-next/actions/odc/UpdateCaptionAction",["require","exports","tslib","../UpdateCaptionAction","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._itemCommandHelper=new(e.managed(o.default));return e}e.prototype.onIsAvailable=function(){return t.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(this.item(),n.editCaption)};return e}(i.default);t.default=a});define("odsp-next/actions/UpdateCaptionAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/item/ItemProvider"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="UpdateCaption";t.caption=e.caption;return t}e.prototype.onExecute=function(e,t){return this.resources.consume(n.resourceKey).updateItemProperty({item:this.item(),propertyName:"caption",propertyValue:this.caption(),overrideLock:!0}).then(function(){return{resultType:o.ResultTypeEnum.Success}})};return e}(r.default);t.default=a});define("odsp-next/actions/odc/SurveyAction",["require","exports","tslib","../../base/BaseSelectionAction","../../providers/dialog/DialogProvider","../NavigationAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/sharing/shareSurvey/ShareSurvey","../../controls/sharing/shareSurvey/ShareSurvey.resx","@ms/odsp-utilities/lib/string/StringHelper","../../dataSources/url/odc/UrlDataSource","../../utilities/icons/Icon","../../resources/ODCResourceKeys","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,o,d,n,a,s,u,p,m,l,f,h,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(c,r);function c(e){var t=r.call(this,e)||this;t.name="Survey";t.canFallbackToParent=!1;t.isSingleSelectAction=!0;t._dialogProvider=t.resources.consume(o.resourceKey);t._navigation=t.resources.consume(v.navigation);t._urlDataSource=t.resources.consume(f.urlDataSource);t._itemCommandHelper=new(t.managed(h.default));t.actionType=e.actionType;return t}c.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,this._getCommandKey())};c.prototype.onSelectionExecute=function(e,t,r){if(1===this.actionType){var i=e[0];return this.showShareDialog(i)}var o=this._navigation,n=this._urlDataSource.getAuthKeyParamValue(),a=this._urlDataSource.getTicketParamValue(),s=o.viewParams.qt,u=3===this.actionType?c.editFormAction:c.viewFormAction,l=p.format(c.officeSurveyUrlFormat,m.default.viewerId,e[0].id,s||"",u);n?l+="&authKey="+n:a&&(l+="&ticket="+a);return new(this.managed(d.default))({url:l,target:"_blank"}).execute(t)};c.prototype.showShareDialog=function(e){var t=p.format(u.strings.title,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:s.default.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:u.strings.done,execute:function(){return n.default.wrap(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new l.default("Cancel")}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};c.prototype._getCommandKey=function(){var e;switch(this.actionType){case 1:e=g.publishSurvey;break;case 2:e=g.viewSurvey;break;case 3:e=g.editSurvey}return e};c.officeSurveyUrlFormat="/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel";c.viewFormAction=2;c.editFormAction=3;return c}(r.default);t.default=c});define("odsp-next/controls/sharing/shareSurvey/ShareSurvey",["require","exports","./ShareSurveyViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShareSurvey.html","./ShareSurvey.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-share-survey",template:e("./ShareSurvey.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/sharing/shareSurvey/ShareSurveyViewModel",["require","exports","tslib","knockout","../../../providers/sharing/SharingProvider","../../../bindings/focus/SelectOnFocusBinding","./ShareSurvey.resx","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner"],function(e,t,i,o,n,a,s,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.loadingSpinnerTagName=u.default.tagName;t._item=e.item;t.previewSrc=e.previewSrc;t.isLoading=o.observable(!0);t.sharingLink=o.observable(null);t.hasError=o.observable(!1);t.instructionsText=s.strings.note;t.createText=s.strings.create;t.removeText=s.strings.remove;t.loadingText=s.strings.loading;t.errorText=s.strings.error;t._sharingProvider=t.resources.consume(n.resourceKey);t._getSharingInfo();t.addBindingHandlers({selectOnFocus:a.default});return t}e.prototype.onCreateClicked=function(){var t=this;this.isLoading(!0);this._sharingProvider.manageSharingLinks([this._item],{type:7,role:3,create:!0}).done(function(){t._getSharingInfo()},function(e){t.isLoading(!1);t.hasError(!0)})};e.prototype.onRemoveClicked=function(){var t=this;this.isLoading(!0);var e={id:this.sharingLink().id,type:7,role:5,create:!1};this._sharingProvider.manageSharingLinks([this._item],e).done(function(){t.isLoading(!1);t.sharingLink(null)},function(e){t.isLoading(!1);t.hasError(!0)})};e.prototype._getSharingInfo=function(){var o=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(e){o.isLoading(!1);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];7===i.type&&o.sharingLink(i)}})};return e}(r.default);t.default=l});define("odsp-next/providers/sharing/SharingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../item/ItemProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./ShareItemHelper","./SharingData"],function(e,t,r,o,i,n,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._dataSource=t.sharingDataSource;r._sharingDataDataSource=t.sharingDataDataSource;r._itemProvider=t.externallySharedItemProvider||t.itemProvider;r._shareDataCache={};r._shareItemHelper=t.shareItemHelper;return r}e.prototype.getSharingInformation=function(e,t){return this._dataSource.getSharingInformation(e,t)};e.prototype.shareLink=function(t){var r=this;return this._dataSource.shareLink(t).then(function(e){if(e.link){r._invalidateCachedItem(t.items[0]);r._invalidateItem(t.items[0])}return e})};e.prototype.unshareLink=function(t){var r=this;return this._dataSource.unshareLink(t).then(function(e){r._invalidateCachedItem(t.item);r._invalidateItem(t.item);return e})};e.prototype.updatePermissions2=function(e,t,r){var i=this;return this._dataSource.updatePermissions2(e,t,r).then(function(e){i._invalidateCachedItem(t);i._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,r,i,o){var n=this;return this._dataSource.updatePermissionsMultiple(e,t,r,i,o).then(function(e){n._invalidateCachedItem(t);n._invalidateItem(t);return e})};e.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,r){return this._dataSource.emailWithoutPermissioning(e,t,r)};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.getSharingData=function(e,t){var r=this._shareDataCache[e.id],i=r&&r.data;if(!i||e.eTag!==r.eTag||t){i=this.scope.attach(new c.default({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:i}}return i};e.prototype.share=function(e,t,r){var i=this;return this._shareItemHelper.share(e,t,r).then(function(e){i._invalidateCache();return e})};e.prototype.unshare=function(r){var i=this;return this._dataSource.unshare(r).then(function(e){i._invalidateCache();var t=i._itemProvider;if(t){t.invalidateItem(r.parent.key);t.invalidateItem(r.key)}return e})};e.prototype.updatePermissions=function(e,t,r,i){var o=this;return this._dataSource.updatePermissions(e,t,r,i).then(function(e){o._invalidateCache();o._itemProvider&&o._itemProvider.invalidateItem(t.parent.key);return e})};e.prototype.manageSharingLinks=function(r,e){var i=this;if(e&&e.link&&e.link.shareId&&!e.create){var t={item:r[0],kind:e.link.kind,shareId:e.link.shareId};return this._dataSource.unshareLink(t).then(function(e){i._invalidateCachedItem(t.item);i._invalidateItem(t.item);return[]})}var o=(r=r&&r.length?r:[]).map(function(e){return i.getSharingData(e)});return this._dataSource.manageSharingLinks(o,e).then(function(e){i._invalidateCache();var t=r[0]&&r[0].parent&&r[0].parent.key;t&&i._itemProvider.invalidateItem(t);return e})};e.prototype._invalidateCache=function(){this._shareDataCache={}};e.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};e.dependencies=r.__assign({},o.default.dependencies,{sharingDataSource:n.sharing,sharingDataDataSource:n.sharingData.optional,navigation:u.navigation,externallySharedItemProvider:a.externallySharedItem.optional,itemProvider:s.resourceKey.optional,shareItemHelper:l.resourceKey});return e}(o.default);t.default=d;t.resourceKey=i.createResolvedResourceKey(e("module").id,d)});define("odsp-next/providers/sharing/ShareItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../item/ItemProvider","../operation/OperationProvider","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../controls/sharing/shareByEmail/Sharing.resx","../../resources/SPOResourceKeys"],function(e,t,r,o,i,a,n,s,u,l,c,d,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._dataSource=t.sharingDataSource;r._itemProvider=t.itemProvider;r._operationProvider=t.operationProvider;r._navigation=t.navigation;r._urlDataSource=t.urlDataSource;r._sharingContextInformation=t.sharingContextInformation;return r}e.prototype.share=function(e,t,r){if(this._sharingContextInformation||r)return this._dataSource.share(e,t);var i=this._getShareOperation(t),o=this._dataSource.share(e,t);i.state(d.default.started);return o.then(this._onSuccess(t,i),this._onError(i))};e.prototype._getShareOperation=function(e){var t=this,r=this.observables,i=this._operationProvider.register({name:e.items[0].name,type:c.default.shareItem,payloads:{shareItem:{items:e.items}},iconName:e.items[0].iconName,actions:{hipCheck:{isAvailable:r.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getHipCheckUrl(),frameId:"_blank"});i.state(d.default.expired);return a.default.wrap()}},verifyAccount:{isAvailable:r.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getVerifyAccountUrl(),frameId:"_blank"});i.state(d.default.expired);return a.default.wrap()}}}});i.progress.maximum(1);i.progress.current(0);return i};e.prototype._onSuccess=function(r,i){var o=this;return function(e){r.items[0].parent&&o._itemProvider&&o._itemProvider.invalidateItem(r.items[0].parent.key);i.progress.current(1);0<=e.statusCode?i.state(d.default.completed):i.state(d.default.failed);var t=i.payloads.peek();t.shareItem.result=e.statusCode;i.payloads(t);return e}};e.prototype._onError=function(o){var n=this;return function(e){var t=o.payloads.peek();t.shareItem.result=e.statusCode||e.code;o.payloads(t);var r,i=e.code;if(3006===i&&n._urlDataSource.getHipCheckUrl()){o.actions.peek().hipCheck.isAvailable(!0);r=e&&e.message}else if(3009!==i&&3033!==i||!n._urlDataSource.getVerifyAccountUrl())3007!==i&&3034!==i&&3036!==i&&3037!==i&&1007!==i&&3035!==i||(r=e&&e.message);else{o.actions.peek().verifyAccount.isAvailable(!0);r=m.strings.VerifyAccount}r&&o.error(new l.default({message:r}));o.state(d.default.failed);return a.default.wrapError(e)}};e.dependencies=r.__assign({},o.default.dependencies,{sharingDataSource:n.sharing,itemProvider:s.resourceKey.optional,operationProvider:u.resourceKey,navigation:p.navigation,urlDataSource:n.url,sharingContextInformation:f.sharingContextInformation.optional});return e}(o.default);t.default=h;t.resourceKey=i.createResolvedResourceKey(e("module").id,h)});define("odsp-next/resources/SPOResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageContext=new r.ResourceKey("pageContext");t.listContext=new r.ResourceKey("listContext");t.listItems=new r.ResourceKey("listItems");t.inplaceEditorUrl=new r.ResourceKey("inplaceEditorUrl");t.inplaceEditorClosing=new r.ResourceKey("inplaceEditorClosing");t.appViewChangeInProgress=new r.ResourceKey("appViewChangeInProgress");t.appViewErrorMessage=new r.ResourceKey("appViewChangeInProgress");t.itemsPerGroup=new r.ResourceKey("itemsPerGroup");t.loggingContext=new r.ResourceKey("loggingContext");t.loggingContextBuckets=new r.ResourceKey("loggingContextBuckets");t.contentTypes=new r.ResourceKey("provider.contentTypes");t.onePageContext=new r.ResourceKey("onePageContext");t.sharingContextInformation=new r.ResourceKey("sharingContextInformation");t.searchBehavior=new r.ResourceKey("searchBehavior");t.newDocumentTemplates=new r.ResourceKey("newDocumentTemplates")});define("odsp-next/providers/sharing/SharingData",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var t=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(e){if(r.default.isCanceled(e)){t._settingsPromise=null;t._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var t=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(e){return t._linksData=e}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(t){var e=this._linksData;if(t&&e){var r=e.filter(function(e){return e&&e.role===t.role&&e.type===t.type});if(0===r.length)e.push(t);else{var i=r[0];i.url=t.url;i.expiration=t.expiration;i.isActive=t.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var t=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(e){r.default.isCanceled(e)&&(t._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e}();t.default=i});define("odsp-next/controls/loadingSpinner/LoadingSpinner",["require","exports","./LoadingSpinnerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LoadingSpinner.html","./LoadingSpinner.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-loadingSpinner",template:e("./LoadingSpinner.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/loadingSpinner/LoadingSpinnerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/imageLoader/ImageLoaderBinding","./LoadingSpinner.resx"],function(i,e,t,o,r,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;e&&void 0!==e.loadingText?t.loadingText=e.loadingText:t.loadingText=a.strings.LoadingText;t.addBindingHandlers({imageLoader:n.default});t.isVisible=o.observable(!0);t.isImageLoaded=o.observable(!1);t.loadingImageUrl="undefined"==typeof __webpack_public_path__?i.toUrl("odsp-media/images/loading/loadingspinner.gif"):i("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");return t}e.prototype.hideSpinner=function(){this.isVisible(!1)};return e}(r.default);e.default=s});define("odsp-next/bindings/imageLoader/ImageLoaderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/images/ImageLoader","../../utilities/images/logging/ImageLoad.event","../../utilities/images/ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/PromiseDebouncer"],function(e,t,r,i,f,o,n,a,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(m){r.__extends(e,m);function e(e,t){void 0===t&&(t={});var r=m.call(this,e)||this;r._debouncer=new h.default;r._imageLoader=r.resources.consume(f.resourceKey);var i=r.valueAccessor(),o=i.src,n=i.image,a=i.error,s=i.isLoaded,u=i.isError,l=i.actualSize,c=i.scenarioName;r._src=r.wrapObservable(o);r._image=r.wrapObservable(n);r._error=r.wrapObservable(a);r._scenarioName=c;var d=t.outputExtenders,p=void 0===d?{deferred:!0}:d;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();s&&s(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}n&&n(e)}).extend(p);r.createBackgroundComputed(function(){var e=r._error();a&&a(e);u&&u(!!e)}).extend(p);return r}e.prototype._computeLoadImage=function(){var t,r=this,e=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(t=new o.default({name:this._scenarioName,loadType:n.default.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:e,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(e){r._image(e);r._error(void 0);t&&t.end({resultType:a.ResultTypeEnum.Success})},function(e){r._error(e);t&&t.end({resultType:a.ResultTypeEnum.Failure})})};return e}(i.default);t.default=s});define("odsp-next/utilities/images/ImageLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/auth/DomainAuthenticator","@ms/odsp-utilities/lib/async/Semaphore","./logging/ImageLoad.event","./ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","./ThumbnailCache"],function(e,t,r,o,d,i,l,n,p,m,f,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._semaphore=new n.default(16);r._thumbnailCache=t.thumbnailCache;return r}e.prototype.loadImage=function(e){var t=this,r=e.url,i=e.imageElement,o=void 0===i?document.createElement("img"):i,n=e.scenarioName,a={url:r,width:0,height:0},s=this._thumbnailCache,u=function(){return l.default.authenticate(r).then(function(){return t._waitForImageLoad(o,r,n)}).then(function(e){s.record(a);if(o.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=o.naturalWidth||o.width,t=o.naturalHeight||o.height;return{url:r,width:e,height:t}})};return s.isLoaded(a)?u():this._semaphore.enqueue(u)};e.prototype._waitForImageLoad=function(r,e,t){var i,o,n,a=this.async,s=this.events,u=function(){n&&a.clearTimeout(n);s.off(r)},l=new d.default(function(){u();r.setAttribute("src","")}),c=e&&0<=e.indexOf("&encodeFailures=1");s.onAll(r,{load:function(){u();if(c&&1===r.naturalWidth&&6e4<r.naturalHeight){var e=r.naturalHeight-6e4;o&&o.end({resultType:f.ResultTypeEnum.ExpectedFailure,resultCode:""+e,error:"Encoded failure"});var t=new Error("Encoded failure");t.code=""+e;l.error(t)}else{o&&o.end({resultType:f.ResultTypeEnum.Success});l.complete(i)}},error:function(){u();o&&o.end({resultType:f.ResultTypeEnum.Failure});l.error(new Error("Image '"+e+"' failed to load"))}});n=a.setTimeout(function(){l.cancel()},3e4);t&&(o=new p.default({name:t,loadType:m.default.server}));r.setAttribute("src",e);i=!!r.complete;return this.trackPromise(l.getPromise())};e.prototype._waitForTimeout=function(e){var t,r=this.async,i=new d.default(function(){t&&r.clearTimeout(t)});t=r.setTimeout(function(){i.complete()},e);return i.getPromise()};e.dependencies=r.__assign({},o.default.dependencies,{thumbnailCache:a.resourceKey});return e}(o.default);t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s)});define("@ms/odsp-utilities/lib/auth/DomainAuthenticator",["require","exports","../async/Promise","../async/Signal"],function(e,t,u,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=[],r=function(){function n(e,t,r){this.complete=!1;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=r}n.initializeAuthenticators=function(e,t){if(t)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var r=t.s,i=t.r,o=0;r&&o<r.length;o++)l.push(new n(e[o],r[o],!i[o]));t.c=function(e){l[e].onAuthComplete()};n.authenticate("https://livefilestore.com/");n.authenticate("https://1drv.com/")}};n.authenticate=function(e){for(var t,r=0;r<l.length;r++){var i=l[r];if(i.requiresAuth(e)){t=i.authenticate(e);break}}for(var o=[t||u.default.wrap(!0)],n=0,a=this._cookieCheckers;n<a.length;n++){var s=a[n];s.isApplicable(e)&&o.push(s.check(e))}return u.default.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})};n.registerCookieChecker=function(e){this._cookieCheckers.push(e)};n.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};n.prototype.authenticate=function(e){var t=(new Date).getTime();if(6e5<t-this._lastAttempt){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new i.default;var r=document.createElement("IFRAME");r.src=this.iframeSrc;r.style.display="none";document.body.appendChild(r)}return this._authPromise.getPromise()};n.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};n._cookieCheckers=[];return n}();t.default=r});define("odsp-next/utilities/images/logging/ImageLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../ImageLoadType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImageLoadType=o.ImageLoadType;t.ResultTypeEnum=n.ResultTypeEnum;t.ImageLoad=r.createPairedEvent({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:o.ImageLoadType,type:6}},i.Qos);t.default=t.ImageLoad});define("odsp-next/utilities/images/ImageLoadType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"}(r=t.ImageLoadType||(t.ImageLoadType={}));t.default=r});define("odsp-next/utilities/images/ThumbnailCache",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){r.__extends(e,a);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=a.call(this,e,t)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var o=t.pruneThumbnailsExtenders,n=void 0===o?{rateLimit:{timeout:6e5}}:o;i.backgroundCompute(r._pruneThumbnails).extend(n);return r}e.prototype.getCoveragePercent=function(e,t){var r=s(e),i=s(t);return Math.sqrt(i/r)};e.prototype.register=function(e,t,r,i){void 0===r&&(r=t);void 0===i&&(i=!0);var o=this.lastAccessedDate;o(new Date);var n=h(this.getCoveragePercent(e,r)),a=f(e),s=f(t),u=this._recordsByThumbnailKey,l=this._bucketsByImageKey,c=u[a]||{lastAccessed:void 0,buckets:{}};c.lastAccessed=o.peek();var d=c.buckets[n];if(!d||1<this.getCoveragePercent(d.size,r)){d&&delete l[d.key];d=c.buckets[n]={key:s,size:r,image:t,isLoaded:i,lastAccessed:o.peek()}}l[s]=d;u[a]=c};e.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var r=f(e),i=this._bucketsByImageKey,o=i[r];o?o.isLoaded=!0:i[r]={key:r,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};e.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var r=f(e),i=this._bucketsByImageKey[r];i&&(i.lastAccessed=t.peek());return!!i&&i.isLoaded};e.prototype.retrieve=function(e,t,r){void 0===t&&(t=1);void 0===r&&(r=t);var i=f(e),o=this._recordsByThumbnailKey[i],n=this.lastAccessedDate;n(new Date);if(o){var a=o.buckets;o.lastAccessed=n.peek();var s=h(t),u=h(r),l=-1/0,c=!1;for(var d in a){var p=Number(d);if(p<=s&&u<=p&&a[p].isLoaded){l=Math.max(l,p);c=!0}}var m=c&&a[l];return m&&m.image}};e.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e);u(this._bucketsByImageKey,e)};return e}(i.default);t.default=n;t.resourceKey=o.createResolvedResourceKey(e("module").id,n);function f(e){var t=e.url,r=e.width,i=e.height;return JSON.stringify({url:t,width:r,height:i})}function h(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function s(e){return e.width*e.height}function u(e,t){for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];432e5<t-e[o].lastAccessed.getTime()&&delete e[o]}}});define("odsp-next/controls/loadingSpinner/LoadingSpinner.html",[],function(){return'<div class=od-LoadingSpinner data-automationid=ms-loadingSpinner><img class=od-LoadingSpinner-loadingGif data-bind="click: hideSpinner, visible: isVisible, attr: { text: loadingText, alt: loadingText }, imageLoader: { src: loadingImageUrl, isLoaded: isImageLoaded }"> <span class=od-LoadingSpinner-loadingText data-bind="text: loadingText"></span></div>'});define("odsp-next/controls/loadingSpinner/LoadingSpinner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}])});define("odsp-next/controls/sharing/shareSurvey/ShareSurvey.html",[],function(){return'<div class=ShareSurvey><div class=od-sharesurvey-preview><img data-bind="attr: {src: previewSrc}"></div><div class=od-sharesurvey-details>\x3c!--ko if: isLoading--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: loadingText } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<span class=od-sharesurvey-instructions data-bind="text: instructionsText"></span>\x3c!--ko if: !sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click: onCreateClicked"><span class=od-Button-label data-bind="text: createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: sharingLink()--\x3e<input type=text class=od-sharesurvey-textbox readonly data-bind="attr: {value: sharingLink().url}, selectOnFocus: { isPermanent: true }"><br><button class=od-Button data-bind="click: onRemoveClicked"><span class=od-Button-label data-bind="text: removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if: hasError()--\x3e<span class=od-sharesurvey-error data-bind="text: errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=ms-clearfix></div></div>'});define("odsp-next/controls/sharing/shareSurvey/ShareSurvey.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}])});define("odsp-next/actions/odc/AddToSharedListAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../base/ItemRedeemer","../../providers/item/ItemProvider"],function(e,t,i,r,n,o,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.isSingleSelectAction=!0;t.canFallbackToParent=!0;t.name="AddToSharedList";t._itemReedemer=new(t.managed(s.default));t._itemCommandHelper=new(t.managed(o.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,a.addToShared)};e.prototype.onSelectionExecute=function(e,t,r){var i=this,o=e[0];return this._itemReedemer.redeemItem(o,this,!0).then(function(){i.resources.consume(u.resourceKey).invalidateItem(o.key,{triggerFetch:!0});return{resultType:n.ResultTypeEnum.Success}})};return e}(r.default);t.default=l});define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper","../../../resources/ControlResourceKeys"],function(i,e,t,o,r,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="RemoveFromSharedList";t._itemCommandHelper=new(t.managed(a.default));t._currentItem=t.resources.consume(s.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,n.removeFromShared)};return e}(r.default);e.default=u});define("odsp-next/actions/addToBundle/odc/AddToBundleAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../dataSources/url/odc/UrlDataSource"],function(i,e,t,o,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="AddToBundleAction";return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/addToBundle/odc/AddToBundleExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/addToBundle/odc/AddToBundleExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&e.isBundle&&e.ownerId===n.default.viewerId};return e}(r.default);e.default=a});define("odsp-next/actions/odc/RemoveFromBundleAction",["require","exports","tslib","../../base/BaseSelectionAction","../../providers/operator/UpdateBundleOperator","../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="RemoveFromBundleAction";return t}e.prototype.onSelectionIsAvailable=function(e,t){return!!t.parent&&t.parent.isBundle&&t.parent.ownerId===n.default.viewerId};e.prototype.onSelectionExecute=function(r,e,t){var i=this;return this.resources.consumeAsync(o.typeResourceKey).then(function(e){var t=new e({items:r.map(function(e){return e.id}),bundleAction:1,item:r[0].parent});i.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:a.ResultTypeEnum.Success}})};return e}(r.default);t.default=s});define("odsp-next/providers/operator/UpdateBundleOperator",["require","exports","tslib","./BaseOperator","../../providers/item/ItemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,o,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._context=e;r._itemProvider=t.itemProvider;return r}e.prototype.getOperationDetails=function(e){var t=i.prototype.getOperationDetails.call(this,e),r=e.input;t.type=a.default.updateBundle;t.name=r.name;t.iconName=r.iconName;t.payloads.updateBundle={item:r,parent:r.parent};return t};e.prototype.onStart=function(e){var t=[new o.Task(this._context.item.key,this._context.item)];e.update(t);return this._itemProvider.updateBundle(this._context,e)};e.dependencies=r.__assign({},o.default.dependencies,{itemProvider:n.resourceKey});return e}(o.default);t.default=s;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/providers/operator/BaseOperator",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/task/TaskObserver","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../operation/OperationProvider","../../models/operation/OperationState","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationBatch"],function(e,t,r,i,o,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=o.default;t.TaskObserver=a.default;t.OperationType=p.default;var f="_BaseOperator_actionName",n=function(n){r.__extends(e,n);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=n.call(this,e,t)||this;r._actionsByName={};var i=t.operationProvider,o=void 0===i?r.resources.consume(l.resourceKey):i;r._operationProvider=o;r._operationBatch=new m.default;r._operationsByKey={};r._completionSignal=new u.default;r._completionSignal.getPromise().done(function(){r.dispose()},function(){r.dispose()});r._observer=r.addDisposable(new a.default(r._onTaskChanges.bind(r)));r._throttleExecuteAllActions=r.async.debounce(r._executeAllActions);r.registerActions({cancel:r.onCancel});r.addDisposable(r._operationProvider.groups.subscribe(r._onOperationProviderGroupsChanged,r,"arrayChange"));return r}e.prototype.dispose=function(){n.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._groupOperation=null;this._throttleExecuteAllActions=null};e.prototype.start=function(){var t=this;return this.onStart(this._observer).then(function(){t._completeIfNoGroupCreated()},function(e){t._completeIfNoGroupCreated();return s.default.wrapError(e)})};e.prototype.wait=function(){return this._completionSignal.getPromise()};e.prototype.onStart=function(e){return s.default.wrap()};e.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return s.default.wrap()};e.prototype.registerActions=function(e){for(var t in e){var r=e[t];if(r){r[f]=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new u.default}}else delete this._actionsByName[t]}};e.prototype.getOperationDetails=function(e){var t;t=1===e.status?c.default.completed:2===e.status?c.default.failed:3===e.status?c.default.canceled:c.default.started;return{type:p.default.multiple,name:"",iconName:null,error:e.error&&new d.default({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};e.prototype.onOperationFinished=function(e){};e.prototype._queueTaskForAction=function(e,t){var r=this._actionsByName[e];r.queue.push(t);this._throttleExecuteAllActions();return r.signal.getPromise()};e.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],r=t.signal;t.signal=new u.default;if(t.queue.length){var i=t.queue.splice(0,t.queue.length);t.callback(i,this._observer).done(h(r),g(r))}}};e.prototype._onTaskChanges=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._updateOperationForTask(i)}};e.prototype._updateOperationForTask=function(e){var t,r=e.current,i=this.getOperationDetails(r),o=this._operationsByKey[r.key];t={};for(var n=0,a=i.actions;n<a.length;n++){var s=a[n],u=s[f],l=this._actionsByName[u];l&&l.action===s&&(t[u]=!0)}if(!o){var c={};for(var u in this._actionsByName)c[u]={isAvailable:this.createObservable(u in t),execute:this._getActionExecutor(u,r)};var d={batch:this._operationBatch,type:i.type,name:i.name,iconName:i.iconName,payloads:i.payloads,progress:i.progress,visibility:i.visibility,actions:c};o=this._operationsByKey[r.key]=this._operationProvider.register(d)}if(o.name!==i.name){o.name=i.name;o.payloads(i.payloads)}o.progress.minimum(i.progress.minimum);o.progress.maximum(i.progress.maximum);o.progress.current(i.progress.current);o.type(i.type);o.error(i.error);o.state(i.state);for(var u in this._actionsByName)o.actions.peek()[u].isAvailable(u in t)};e.prototype._getActionExecutor=function(e,t){var r=this;return function(){return r._queueTaskForAction(e,t)}};e.prototype._createGroupOperationSubscription=function(t){var e=this,r=this.createPureComputed(function(){var e=t.state();return e===c.default.completed||e===c.default.canceled||e===c.default.failed||e===c.default.expired});this.createBackgroundComputed(function(){r()&&e.observables.ignore(function(){e.onOperationFinished(t)})})};e.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],o=i.value;if(o.batch===this._operationBatch)if("added"===i.status){if(!this._groupOperation){this._groupOperation=o;this._createGroupOperationSubscription(o)}}else"deleted"!==i.status||i.moved||this._completionSignal.complete()}};e.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};e.dependencies=r.__assign({},i.default.dependencies,{operationProvider:l.resourceKey});return e}(i.default);t.default=n;function h(e){return function(){return e.complete()}}function g(t){return function(e){return t.error(e)}}});define("odsp-next/models/task/TaskObserver",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(r,i){return{update:function(e,t){void 0===t&&(t=!1);r.update(e.map(function(e){return i(e)}),t)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var r,i,o;r={};for(var n in this._tasksByKey)r[n]=this._tasksByKey[n];o=[];for(var a=0,s=e;a<s.length;a++){var u=s[a],l=r[u.key],c=u.compare(l);c&&o.push(c);delete r[u.key];this._tasksByKey[u.key]=u}if(t)for(var n in r){i=r[n];delete this._tasksByKey[n];o.push({previous:i,current:null})}this.onChanges(o)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e}();t.default=r});define("odsp-next/actions/reportAbuse/odc/ReportAbuseAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../models/item/command/SocialItemCommandKeys","../../base/templates/ExecutorAction"],function(i,e,t,o,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="ReportAbuse";return t}e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorPath=function(){return"odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor"],e,t)})}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,n.reportAbuse)};return e}(r.default);e.default=a});define("odsp-next/actions/odc/RemoveMountPointAction",["require","exports","tslib","../../base/BaseSelectionAction","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/textContainer/TextContainer","../../resources/DataSourceResourceKeys","../../utilities/icons/Icon","../../providers/dialog/DialogProvider","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,u,l,c,d,p,o,m,n,a,s,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="RemoveMountPoint";t.isSingleSelectAction=!0;t.canFallbackToParent=!1;t._urlDataSource=t.resources.consume(o.url);t._dialogProvider=t.resources.consume(n.resourceKey);t._itemProvider=t.resources.consume(a.resourceKey);t._navigation=t.resources.consume(h.navigation);t._itemCommandHelper=new(t.managed(s.default));return t}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,f.removeAsMountPoint)};e.prototype.onSelectionExecute=function(e,t,r){var i=this,o=this.item(),n=e[0],a=this._dialogProvider,s=d.format(u.strings.RemoveMountPointDetails2,n.name);return a.requestDialog({title:u.strings.RemoveMountPointTitle,component:{name:p.default.tagName,params:{text:s}},actions:[{name:u.strings.RemoveMountPoint,execute:function(){return l.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new m.default("Cancel"),isDefault:!0}]}).wait().then(function(){var e=i._itemProvider;i.selectionModel.clear();return e.removeMountPoint({parentKey:o.key,item:n}).then(function(){var e=i._navigation;i._urlDataSource=i._urlDataSource;e.navigateTo(i._urlDataSource.getDefaultClickUrl(n.parent));return{resultType:c.ResultTypeEnum.Success}})})};return e}(r.default);t.default=g});define("odsp-next/actions/requestReview/odc/RequestReviewAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/SocialItemCommandKeys"],function(i,e,t,o,r,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="RequestReview";t._itemCommandHelper=new(t.managed(n.default));return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/requestReview/odc/RequestReviewExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/requestReview/odc/RequestReviewExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,a.requestReview)};return e}(r.default);e.default=s});define("odsp-next/actions/odc/ViewInFolderAction",["require","exports","tslib","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","../../dataSources/url/QueryType","../../resources/ODCResourceKeys","../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../base/ItemRedeemer","../../dataSources/url/PageType"],function(e,t,i,r,o,a,s,u,n,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.isSingleSelectAction=!0;t.name="ViewInFolderAction";t._navigation=t.resources.consume(c.navigation);t._urlDataSource=t.resources.consume(s.urlDataSource);t._itemReedemer=new(t.managed(d.default));return t}e.prototype.onSelectionExecute=function(e,t,r){var i=this;return this._itemReedemer.redeemItems(e,this).then(function(){if(!e[0])return o.default.wrap({resultType:n.ResultTypeEnum.Failure});i._navigation.navigateTo({url:i._urlDataSource.getItemUrl(e[0].parentKey,{page:p.default.Files})});return o.default.wrap({resultType:n.ResultTypeEnum.Success})})};e.prototype.onSelectionIsAvailable=function(e,t){var r=this.item(),i=this.resources.consume(s.urlDataSource),o=t&&t.parentKey&&r.queryType===a.default.Search,n=i.isCurrentQuery(a.default.Photos);return(o||n&&t.type===l.default.Media)&&t.ownerId===u.default.viewerId};return e}(r.default);t.default=m});define("odsp-next/actions/odc/RemoveFromAlbumAction",["require","exports","tslib","../RemoveFromAlbumAction","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._itemCommandHelper=new(e.managed(o.default));return e}e.prototype.onSelectionIsAvailable=function(e,t){return this.item().isAlbum&&this._itemCommandHelper.isCommandSupported(t,n.removeFromAlbum)};return e}(i.default);t.default=a});define("odsp-next/actions/RemoveFromAlbumAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/album/AlbumProvider.key"],function(e,t,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="RemoveFromAlbum";return e}e.prototype.onSelectionIsAvailable=function(e,t){return this.item().isAlbum};e.prototype.onSelectionExecute=function(e,t,r){var i=this.item();this.selectionModel.clear();var o={album:i,items:e};return this.resources.consumeAsync(a.resourceKey).then(function(e){return e.removeFromAlbum(o)}).then(function(){return{resultType:n.ResultTypeEnum.Success}},function(e){return{resultType:n.ResultTypeEnum.Failure}})};return e}(i.default);t.default=o});define("odsp-next/providers/album/AlbumProvider.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./AlbumProvider",getModule:function(){return new t.default(function(e,t){r(["./AlbumProvider"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Promise","../../dataSources/base/odc/Config"],function(r,e,t,i,o,n,a,s,u,l,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this,r=e.item;t._itemSelectionHelper=new(t.managed(n.default))({overrideItem:r,allowMultiSelect:!1,canFallback:!0});t._itemCommandHelper=new(t.managed(a.default));t.state=t.createPureComputed(t._computeState);return t}e.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};e.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!c.Config.hcid&&e.virtualItemType===u.default.Album&&this._itemCommandHelper.isCommandSupported(e,s.addPhotosToAlbum)}};return e}(i.default);e.AddPhotosToAlbumHandler=d;var p=o.create({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return new l.default(function(e,t){r(["./AddPhotosToAlbumExecutor"],e,t)})}}},handlerType:d});e.default=p});define("odsp-next/actions/createAlbum/CreateAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/VirtualItemType"],function(r,e,t,i,o,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._itemSelectionHelper=new(t.managed(a.default))({allowMultiSelect:!1,canFallback:!0});t.state=t.createPureComputed(t._computeState);return t}e.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===s.default.AlbumRoot}};return e}(o.default);e.CreateAlbumHandler=u;var l=n.create({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return new i.default(function(e,t){r(["./CreateAlbumExecutor"],e,t)})}}},handlerType:u});e.default=l});define("odsp-next/actions/SelectAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SelectAction";t._showProperties=!1;t._showProperties=e.showProperties;t._selectionModel=t.resources.consume(a.itemsSelection);t._actionMap=t.resources.consume(a.actionMap);t._selectItems=e.selectItems;return t}e.prototype.onIsAvailable=function(){return 1===this._selectionModel.mode};e.prototype.onSelectionIsAvailable=function(e,t){return t&&!t.isPlaceholder};e.prototype.onExecute=function(e,t){var r=this;if(this._selectionModel){if(this._selectItems){var i=this._selectItems.map(function(e){return r._selectionModel.getItemKey(e)});this._selectionModel.setSelectedKeys(i)}else{this._selectionModel.clear();this._selectionModel.setItemSelected(this.item,!0)}if(this._showProperties&&this._actionMap){(new(this.managed(this._actionMap.ShowPropertiesAction))).execute(null)}}return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(r.default);t.default=s});define("odsp-next/actions/SelectAllAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SelectAll";t._selectionModel=t.resources.consume(a.itemsSelection);return t}e.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};e.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(r.default);t.default=s});define("odsp-next/actions/FilterSearchAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/QueryType","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="FilterSearch";t._filter=e.filter;t._urlDataSource=t.resources.consume(a.url);t._viewParams=t.resources.consume(s.viewParams);t._showCurrentView=e.showCurrentView;t._url=t.createPureComputed(t._computeUrl);t._supportsSearchFiltering=t._getSupportsSearchFiltering();t._navigationAction=new(t.managed(n.default))({url:t._url,forceNavigation:!0});return t}e.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};e.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&this._urlDataSource.getQueryType()===o.default.Search&&this._navigationAction.isAvailable()};e.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.getQueryType()===o.default.Search&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==u.SearchFilterType.all);return e};e.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchFilterQueryUrl(this._filter)};e.prototype._getSupportsSearchFiltering=function(){var t=this.createObservable(!1);this.resources.consumeAsync(a.search).done(function(e){t(e.getCapabilities().supportsSearchFiltering)});return t};return e}(r.default);t.default=l});define("odsp-next/actions/RemoveTagFromItemAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../models/item/VirtualItemType"],function(e,t,r,i,c,d,p,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="RemoveTagFromItem";return e}e.prototype.onSelectionIsAvailable=function(e,t){var r=this.item();return r.virtualItemType===o.default.Tag&&r.tags&&0<r.tags.length};e.prototype.onSelectionExecute=function(e,t,r){for(var i,o=this.item(),n=this.resources.consume(p.tag),a=this.resources.consume(p.photo).getAllPhotosSettings().peek(),s=0,u=e[0].tags;s<u.length;s++){var l=u[s];if(l.tag===o.tags[0].tag){i=l;break}}this.selectionModel.clear();return i?n.updateTags({items:e,tagsToAdd:null,tagsToDelete:[i],parentKey:o.key,rootItemId:a.rootId}).then(function(){return{resultType:d.ResultTypeEnum.Success}}):c.default.wrap({resultType:d.ResultTypeEnum.Failure})};return e}(i.default);t.default=n});define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/VirtualItemType"],function(i,e,t,o,r,n,a,s,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SetAlbumCoverPhoto";t._currentItem=t.resources.consume(n.currentItem);t._itemCommandHelper=new(t.managed(a.default));return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}};e.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===u.default.Album&&this._itemCommandHelper.isCommandSupported(e,s.deleteItem)&&!!t&&!(!t.photo&&!t.video)};return e}(r.default);e.default=l});define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader","../../../providers/item/ItemProvider","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","../../../resources/ODCResourceKeys"],function(i,e,t,r,o,n,a,s,u,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SetPhotosRoot";t._rootId=e.rootId;t._photoProvider=t.resources.consume(s.photo);t._itemProvider=t.resources.consume(a.resourceKey);t._viewParams=t.resources.consume(u.viewParams);t._urlDataSource=t.resources.consume(l.urlDataSource);t._executorLoader=new(t.managed(n.default))({path:"odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor",getModule:function(){return new o.default(function(e,t){i(["odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor"],e,t)})},getExecutorParams:function(){return{photoProvider:t._photoProvider,itemProvider:t._itemProvider,urlDataSource:t._urlDataSource,rootId:t._rootId}}});return t}e.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;if(0===this._rootId)e="root"===t;else if(1===this._rootId){e=t===this._photoProvider.getAllPhotosSettings()().rootId&&"root"!==t}return e};e.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case 0:case 9:return!0;default:return!1}};e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return e}(r.default);e.default=c});define("odsp-next/actions/FilterSearchByDateAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/QueryType","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="FilterSearchByDateAction";t._filter=e.filter;t._urlDataSource=t.resources.consume(a.url);t._viewParams=t.resources.consume(s.viewParams);t._showCurrentView=e.showCurrentView;t._url=t.createPureComputed(t._computeUrl);t._supportsSearchFiltering=t._getSupportsSearchFiltering();t._navigationAction=new(t.managed(n.default))({url:t._url,forceNavigation:!0});return t}e.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};e.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&this._urlDataSource.getQueryType()===o.default.Search&&this._navigationAction.isAvailable()};e.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&this._urlDataSource.getQueryType()===o.default.Search&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==u.SearchFilterDateType.anyDate);return e};e.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)};e.prototype._getSupportsSearchFiltering=function(){var t=this.createObservable(!1);this.resources.consumeAsync(a.search).done(function(e){t(e.getCapabilities().supportsSearchFiltering)});return t};return e}(r.default);t.default=l});define("odsp-next/actions/launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(i,e,t,o,n,a,s,r,u,l,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._isMove=e.isMove;t.name="LaunchMoveCopyPanel";t._currentItem=t.resources.consume(u.currentItem);t._urlDataSource=t.resources.consume(s.urlDataSource);t._moveCopyDataSource=t.resources.consume(l.copy);t._capabilities=t._moveCopyDataSource.getCapabilities();return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var t=this;if(!this._capabilities.supportsMoveCopy)return!1;var e=this._currentItem();if(1<this.selectionHelper.selection().length&&e.queryType===a.default.SharedWithMe&&e.isRootFolder)return!1;if(!this._isMove&&this._urlDataSource.getAuthKeyParamValue())return!1;var r=this._isMove?c.moveFrom:c.copyFrom;return this._urlDataSource.getPageType()!==n.default.TextFileEditor&&this.selectionHelper.filterItems(function(e){return t.itemCommandHelper.isCommandSupported(e,r)})};return e}(r.default);e.default=d});define("odsp-next/actions/odc/AutoExecuteAction",["require","exports","tslib","../../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ODCResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../dataSources/url/AutoActionType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,s,u,o,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="AutoExecute";t._focusItem=e.focusItem;t._actionMap=t.resources.consume(n.actionMap);t._navigation=t.resources.consume(c.navigation);t._urlDataSource=t.resources.consume(o.urlDataSource);t._viewParams=t.resources.consume(n.viewParams);t._actionType=t.createPureComputed(t._computeAutoActionType,{deferEvaluation:!0});t._createAction=t.createPureComputed(t._computeCreateAction,{deferEvaluation:!0});t._action=t.createPureComputed(t._computeAction,{deferEvaluation:!0});return t}e.prototype.onExecute=function(e,t){var r,i=this._actionType.peek(),o=this._action.peek(),n=this.item.peek(),a=this._viewParams.peek();r=o&&o.isAvailable.peek()?o.execute(e):s.default.wrap({resultType:u.ResultTypeEnum.ExpectedFailure});i!==l.default.locate&&this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(n,{viewParams:a}));return r};e.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),r=this._focusItem(),i=!t.isPlaceholder,o=!r||!r().isPlaceholder;return!!e&&o&&i};e.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)};e.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case l.default.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case l.default.download:e=function(){return new(t.managed(t._actionMap.DownloadAction))({})};break;case l.default.share:case l.default.sharing:e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case l.default.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case l.default.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Text,autoInvokedItem:!0})};break;case l.default.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Word,autoInvokedItem:!0})};break;case l.default.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Excel,autoInvokedItem:!0})};break;case l.default.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.ExcelSurvey,autoInvokedItem:!0})};break;case l.default.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.PowerPoint,autoInvokedItem:!0})};break;case l.default.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.OneNote,autoInvokedItem:!0})};break;case l.default.openInExcel:case l.default.openInWord:case l.default.openInPowerPoint:case l.default.openInOneNote:case l.default.openInVisio:case l.default.openInProject:case l.default.openInPublisher:case l.default.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case l.default.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case l.default.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case l.default.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case l.default.editBrowser:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case l.default.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case l.default.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case l.default.locate:}return e};e.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose();e=null;var t=this._createAction();t&&(e=t());return e};return e}(r.default);t.default=d});define("odsp-next/actions/toggleSelectionMode/ToggleSelectionModeAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../controls/list/react/SelectionManager"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="ToggleSelectionModeAction";t._platformDetection=t.resources.consume(s.platformDetection);t._isSelectionModal=t.resources.consume(u.isSelectionModalResourceKey);t._selectionHelper=new(t.managed(o.default));return t}e.prototype.onIsAvailable=function(){return this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()};e.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();this._isSelectionModal(!t);return n.default.wrap({resultType:a.ResultTypeEnum.Success})};e.prototype.onIsToggled=function(){return this._isSelectionModal()};return e}(r.default);t.default=l});define("odsp-next/actions/redeemCode/odc/RedeemCodeAction",["require","exports","tslib","../../../base/BaseAction","../../base/ExecutorLoader","@ms/odsp-utilities/lib/async/Promise"],function(i,e,t,r,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="RedeemCode";t._executorLoader=new(t.managed(o.default))({path:"odsp-next/actions/redeemCode/odc/RedeemCodeExecutor",getModule:function(){return new n.default(function(e,t){i(["odsp-next/actions/redeemCode/odc/RedeemCodeExecutor"],e,t)})},getExecutorParams:function(){return{redeemSuccess:e.redeemSuccess,redeemCode:e.redeemCode,actionName:t.name}}});return t}e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};e.prototype.onIsAvailable=function(){return!0};return e}(r.default);e.default=a});define("odsp-next/actions/save/odc/SaveAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../SaveAction"],function(r,e,i,o,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getExecutorPath=function(){return"odsp-next/actions/save/SaveExecutor"};t.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["odsp-next/actions/save/SaveExecutor"],e,t)})}};return t}(t.default);e.default=n});define("odsp-next/actions/save/SaveAction",["require","exports","tslib","../../base/BaseAction","../base/ExecutorLoader","../base/ItemSelectionHelper","../../resources/ControlResourceKeys","../../providers/item/ItemContentProvider"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Save";t._itemContentsProvider=t.resources.consume(s.resourceKey);var r=t.resources.consume(a.currentItem);t._selectionHelper=new(t.managed(n.default))({overrideItem:e.item,allowMultiSelect:!1,canFallback:!1});t._loader=new(t.managed(o.default))({path:t.getExecutorPath(),getModule:t.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:t._selectionHelper,currentItem:r.peek()}}});return t}e.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&(!!t.memoryContent()&&(!t.hasConflict()&&(!t.hasPendingSave()&&t.hasChanges())))};e.prototype.onExecute=function(e){return this._loader.execute(e)};return e}(i.default);t.SaveAction=u;t.default=u});define("odsp-next/providers/item/ItemContentProvider",["require","exports","../../models/item/ItemContent","@ms/odsp-utilities/lib/disposable/Disposable","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._itemContents={}}e.prototype.getItemContent=function(e){var t=e.key,r=this._itemContents,i=r[t];if(!i){i=new o.default;n.hook(i,function(){delete r[t]});r[t]=i}return i};e.prototype.dispose=function(){this._itemContents={}};return e}();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{})});define("odsp-next/models/item/ItemContent",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.memoryContent=o.observable(null);t.serverContent=o.observable(null);t.outDated=o.observable(!1);t.isEditable=o.observable(!1);t.hasConflict=t.createPureComputed(t._computeHasConflict);t.hasPendingSave=t.createPureComputed(t._computeHasPendingSave);t.hasChanges=t.createPureComputed(t._computeHasChanges);t._lastSaved=o.observable(null);t._pendingSave=o.observable(null);return t}e.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)};e.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)};e.prototype.saveSucceded=function(){if(this.hasPendingSave.peek()){this.updateETag=!0;this._lastSaved(this._pendingSave.peek());this._pendingSave(null)}};e.prototype._computeHasPendingSave=function(){return!!this._pendingSave()};e.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();if(null===t){this._lastSaved(e.text);return!1}return e.text!==t};e.prototype._computeHasConflict=function(){return!!this.serverContent()};return e}(r.default);t.default=n});define("odsp-next/actions/redeem/odc/RedeemAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../base/ItemRedeemer","../../../dataSources/url/PageType","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemSelectionHelper","../../../resources/DataSourceResourceKeys"],function(e,t,i,n,r,o,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Redeem";t._itemProvider=t.resources.consume(s.resourceKey);t._urlDataSource=t.resources.consume(c.url);t._itemReedemer=new(t.managed(o.default));t._selectionHelper=new(t.managed(l.default))({overrideItem:e.item,allowMultiSelect:!0,canFallback:!1});return t}e.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===a.default.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})};e.prototype.onExecute=function(e){var o=this;return this._selectionHelper.resolveSelection().then(function(i){return o._itemReedemer.redeemItems(i,o).then(function(){for(var e=0,t=i;e<t.length;e++){var r=t[e];o._itemProvider.invalidateItem(r.key,{triggerFetch:!0})}return n.default.wrap({resultType:u.ResultTypeEnum.Success})})})};return e}(r.default);t.default=d});define("odsp-next/actions/base/LazyLoadedAction",["require","exports","tslib","@ms/odsp-shared/lib/base/ActionInputType","../../base/BaseAction","../UnsupportedAction","../../resources/ProviderResourceKeys"],function(e,t,r,n,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(o,i);function o(e){var r=i.call(this,e)||this;r.name="LazyLoadedAction";r.isQosLogged=!1;r._actionParams=e;r._action=r.createObservable(new(r.managed(a.default))({}));var t=r.resources.consume(s.bundleLoader);r._getActionPromise=r.trackPromise(t.waitFor(r.actionPath,r.getModule).then(function(e){var t=new(r.managed(e))(r._actionParams);r._action(t);return t}));r.inputType=r.createPureComputed(r._computeInputType);return r}o.create=function(r,i){var e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this.actionPath=r;this.getModule=i;o.apply(this,e)};e.prototype=o.prototype;return e};o.prototype.onIsAvailable=function(){return this._action().isAvailable()};o.prototype.onIsToggled=function(){return this._action().isToggled()};o.prototype.onExecute=function(t,e){return this._getActionPromise.then(function(e){return e.execute(t)})};o.prototype._computeInputType=function(){var e=this._action();return e.inputType?e.inputType():n.default.none};return o}(i.default);t.default=o});define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","../../../models/itemSet/ItemSetMonitor","../../base/templates/ExecutorAction"],function(i,e,t,o,n,a,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="SwitchPhotoFolderLayoutType";t._itemSetMonitor=t.resources.consume(a.resourceKey);return t}e.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!n.default.getKeyParams(e.key).ft};e.prototype.getExecutorPath=function(){return"odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name}};return e}(r.default);e.default=s});define("odsp-next/models/itemSet/ItemSetMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){r.__extends(e,o);function e(e,t){var r=o.call(this,e,t)||this,i=t.itemSet;r.itemSet=i;r.item=r.createPureComputed(r._computeItem);r.item.equalityComparer=n.objectStrictEquality;r.isEmpty=r.createPureComputed(r._computeIsEmpty);r.hasItems=r.createPureComputed(r._computeHasItems);r.hasName=r.createPureComputed(r._computeHasName);r.hasParent=r.createPureComputed(r._computeHasParent);r.name=r.createPureComputed(r._computeName);r.isPlaceholder=r.createPureComputed(r._computeIsPlaceholder);return r}e.prototype._computeItem=function(){return this.itemSet().item()};e.prototype._computeHasItems=function(){return 0<this.itemSet().content().items.length};e.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t};e.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)};e.prototype._computeHasParent=function(){return!!this.item().parent};e.prototype._computeName=function(){var e=this.item();return e.displayName||e.name};e.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder};e.dependencies=r.__assign({},i.default.dependencies,{itemSet:a.currentItemSet});return e}(i.default);t.ItemSetMonitor=s;t.resourceKey=o.createResolvedResourceKey(e("module").id,s);t.default=s});define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../../dataSources/url/QueryType","../../../models/item/ItemType","../../../dataSources/url/odc/UrlDataSource","../../../dataSources/url/PageType","../../base/templates/ExecutorAction","../../../resources/ODCResourceKeys","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemParentHelper"],function(i,e,t,o,n,a,s,u,l,r,c,d,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var m=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="CreateAlbumFromFolder";t._identity=t.resources.consume(n.identity);t._urlDataSource=t.resources.consume(c.urlDataSource);t._itemParentHelper=t.resources.consume(p.resourceKey);return t}e.prototype.isValidItem=function(e,t,r){var i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint"));return r!==l.default.TextFileEditor&&t&&t.type!==d.IdentityType.anonymous&&e.ownerId===u.default.viewerId&&!i&&e.type===s.default.Folder&&e.queryType===a.default.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum};e.prototype.getExecutorPath=function(){return"odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor"],e,t)})}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),r=this._urlDataSource.getPageType();return this.isValidItem(e,t,r)};return e}(r.default);e.default=m});define("odsp-next/actions/odc/VersionHistoryAction",["require","exports","tslib","../../base/BaseSelectionAction","../NavigationAction","../../dataSources/url/odc/UrlDataSource","../../resources/DataSourceResourceKeys","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","../showVersionHistoryAction/ShowReactVersionHistoryAction","../../models/item/ItemType","../../utilities/features/Features"],function(e,t,r,i,n,a,s,o,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="VersionHistory";e.isSingleSelectAction=!0;e._itemCommandHelper=new(e.managed(o.default));return e}e.prototype.onSelectionIsAvailable=function(e,t){return this._itemCommandHelper.isCommandSupported(t,u.viewVersionHistory)||(t.type===c.default.File||t.type===c.default.Media)&&null===t.dateDeletedTime&&d.isFeatureEnabled(d.VersionAllFiles)};e.prototype.onSelectionExecute=function(e,t,r){var i=e[0];if(!i)return null;if(this._itemCommandHelper.isCommandSupported(i,u.viewVersionHistory)){var o=this.resources.consume(s.url).getVersionHistoryUrl(a.default.viewerId,i.id);return new(this.managed(n.default))({url:o,target:"_blank"}).execute(t)}return(new(this.managed(l.default))).execute(t)};return e}(i.default);t.default=p});define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../odb/ActionHelper","@ms/odsp-datasources/lib/Permissions","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/ItemParentHelper","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../base/ItemCommandHelper","../../models/item/command/MetadataItemCommandKeys","../../controls/infoPane/sections/sharing/SharingSection.css"],function(r,e,t,i,o,n,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.state=t.createPureComputed(t._computeState);t._urlDataSource=t.resources.consume(c.url);t._itemParentHelper=t.resources.consume(l.resourceKey);t._itemCommandHelper=t.resources.consume(p.resourceKey);t._itemSelectionHelper=new(t.managed(u.default))({allowMultiSelect:!1,canFallback:!1});return t}e.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}};e.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),r=!n.default.isFolder(e,!0)&&a.PermissionMask.hasItemPermission(e,a.PermissionMask.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==d.default.TextFileEditor&&!!t&&(t.list.enableVersions||t.list.isModerated)&&this._itemCommandHelper.isCommandSupported(e,m.versionHistory)&&3!==e.itemStatus&&4!==e.itemStatus&&r}};return e}(o.default);e.ShowReactVersionHistoryHandler=f;var h=s.create({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return new i.default(function(e,t){r(["./ShowReactVersionHistoryExecutor"],e,t)})}}},handlerType:f});e.default=h});define("odsp-next/actions/odb/ActionHelper",["require","exports","./Actions.resx","../../controls/commands/Commands.resx","../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","../../controls/textContainer/TextContainer"],function(e,t,r,o,n,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(){}i.isFolder=function(e,t){return t?e&&(e.type===s.default.Folder||e.type===s.default.OneNote):e&&e.type===s.default.Folder};i.isCheckedOut=function(e){return c.isCheckedOut(e)};i.isCheckedOutByUser=function(e,t){return c.isCheckedOutByUser(e,t)};i.isCheckedOutByOther=function(e,t){return i.isCheckedOut(e)&&!i.isCheckedOutByUser(e,t)};i.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.strings.FileCheckedoutOrLockedWarningTitle,component:{name:d.default.tagName,params:{text:r.strings.FileCheckedoutOrLockedWarning}},actions:[{name:o.strings.cancelActionText,execute:function(){return l.default.wrap(2)},icon:new n.default("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};i.isPublished=function(e,t){return t.isModerated?e.properties[i.PublishProperty]&&"3"!==e.properties[i.PublishProperty]&&"1"!==e.properties[i.PublishProperty]:0===i.getVersionNoModeration(e,t).minor&&0!==i.getVersionNoModeration(e,t).major};i.isPublishingRelevant=function(e,t){return u.PermissionMask.hasItemPermission(e,u.PermissionMask.editListItems)&&t.enableMinorVersions&&!i.isCheckedOut(e)&&!i.isFolder(e,!0)};i.getVersionNoModeration=function(e,t){if(!t.isModerated&&e&&e.properties&&e.properties[i.VersionProperty]){var r=Number(e.properties[i.VersionProperty])%512;return{major:Math.floor(Number(e.properties[i.VersionProperty])/512),minor:r}}return{major:0,minor:0}};i.isApprovalRelevant=function(e,t){return t&&t.isModerated&&!i.isCheckedOut(e)&&u.PermissionMask.hasItemPermission(e,u.PermissionMask.editListItems)&&u.PermissionMask.hasItemPermission(e,u.PermissionMask.approveItems)};i.FileTypeProperty="FSObjType";i.PublishProperty="_ModerationStatus.";i.VersionProperty="_UIVersion";return i}();t.default=i});define("@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper",["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.CheckOutUserProperty="CheckedOutUserId";function r(e){return!!e.properties[i.CheckOutUserProperty]}i.isCheckedOut=r;function o(e,t){var r=Number(t);return!isNaN(r)&&Number(e.properties[i.CheckOutUserProperty])===r}i.isCheckedOutByUser=o;i.isCheckedOutByOther=function(e,t){return r(e)&&!o(e,t)}});define("odsp-next/models/item/command/MetadataItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkout=new r.default("checkout");t.quickEdit=new r.default("quickEdit");t.editItem=new r.default("editItem");t.viewItem=new r.default("viewItem");t.versionHistory=new r.default("versionHistory");t.exportList=new r.default("exportList")});define("odsp-next/actions/odc/RearrangeAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/ODCResourceKeys","../NavigationAction","../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,i,r,o,n,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Rearrange";t._platformDetection=t.resources.consume(u.platformDetection);t._odcUrlDataSource=t.resources.consume(n.urlDataSource);t._item=t.resources.consume(o.currentItem);t._itemCommandHelper=new(t.managed(l.default));t._navigationAction=new(t.managed(a.default))({url:t.createPureComputed(function(){return t._odcUrlDataSource.getArrangeViewUrl(s.default.viewerId,t._item().id)})});return t}e.prototype.onIsAvailable=function(){var e=this._item();return!this._platformDetection.isMobile&&!!e.folder&&(1<e.folder.photoCount||1<e.folder.documentCount)&&this._itemCommandHelper.isCommandSupported(e,c.rearrange)};e.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};return e}(r.default);t.default=d});define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/PhotoItemCommandKeys"],function(i,e,t,o,r,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="ApplyOfficeLens";t._item=t.resources.consume(n.currentItem);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,a.applyOfficeLens)};return e}(r.default);e.default=s});define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../base/ItemSelectionHelper","../../base/ExecutorLoader","../../../base/BaseAction","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys"],function(i,e,t,o,n,a,s,r,u,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="RemoveOfficeLens";t._selectionHelper=new(t.managed(a.default))({overrideItem:e.item,allowMultiSelect:!1,canFallback:!1});t._itemCommandHelper=new(t.managed(u.default));t._item=t.resources.consume(n.currentItem);t._loader=new(t.managed(s.default))({path:"odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor",getModule:function(){return new o.default(function(e,t){i(["odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor"],e,t)})},getExecutorParams:function(){return{actionName:t.name,selectionHelper:t._selectionHelper,item:t._item.peek()}}});return t}e.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,l.removeOfficeLens)};e.prototype.onExecute=function(e){return this._loader.execute(e)};return e}(r.default);e.default=c});define("odsp-next/actions/base/OverrideAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/base/ActionInputType"],function(e,t,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){o.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._primary=new(t.managed(e.primary))(e.actionParams);t._secondary=new(t.managed(e.secondary))(e.actionParams);t.name=t._primary.name;t.isAvailable=t._primary.isAvailable;t.isExecuting=t.createPureComputed(t._computeIsExecuting);t.isToggled=t.createPureComputed(t._computeIsToggled);t.inputType=t.createPureComputed(t._computeInputType);return t}e.create=function(r,i){return function(t){o.__extends(e,t);function e(e){return t.call(this,{primary:r,secondary:i,actionParams:e})||this}return e}(e)};e.prototype.execute=function(e){return this._getAction().execute(e)};e.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary};e.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()};e.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()};e.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():i.default.none};return e}(r.default);t.default=n});define("odsp-next/actions/printPdf/odc/PrintPdfAction",["require","exports","tslib","../../base/templates/ExecutorAction","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/features/Features","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/logging/events/UsageType","../../../resources/ProviderResourceKeys"],function(r,e,t,i,o,n,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="PrintPdf";t._urlDataSource=t.resources.consume(a.urlDataSource);t._instrumentationProvider=t.resources.consume(m.instrumentation);t._platform=t.resources.consume(o.platformDetection);t._navigation=t.resources.consume(n.navigation);t._supportsIframePrint=t._platform.isChrome||t._platform.isSafari;return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/printPdf/odc/PrintPdfExecutor"};e.prototype.getModuleFactory=function(){return function(){return new s.default(function(e,t){r(["odsp-next/actions/printPdf/odc/PrintPdfExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}};e.prototype.onExecute=function(e){var r=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=r._urlDataSource.getPrintPdfUrl(e);d.default.logData({name:c.UsageName[c.UsageName.PrintPdfNative],location:c.LocationName[c.LocationName.OneUp],usageType:p.UsageType[p.UsageType.Click],currentPage:r._instrumentationProvider.currentPageName(),previousPage:r._instrumentationProvider.previousPageName()});r._navigation.navigateTo({url:t,frameId:"_blank"});return s.default.wrap({resultType:u.ResultTypeEnum.Success})}):i.prototype.onExecute.call(this,e)};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&l.isFeatureEnabled(l.UseWebPdfViewer)};return e}(i.default);e.default=f});define("odsp-next/utilities/logging/odc/UsageNames",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly";e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual";e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly";e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual";e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly";e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual";e[e.OfficeTrial=7]="OfficeTrial";e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree";e[e.OfficeSolo=9]="OfficeSolo";e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore";e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore";e[e.ChangeCurrency=12]="ChangeCurrency";e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions";e[e.FeatureCardStorage=14]="FeatureCardStorage";e[e.FeatureCardProductivity=15]="FeatureCardProductivity";e[e.FeatureCardSecurity=16]="FeatureCardSecurity";e[e.FeatureCardSharing=17]="FeatureCardSharing";e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps";e[e.LaunchFeatureCard=19]="LaunchFeatureCard";e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures";e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle";e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider";e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider";e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider";e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider";e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown";e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick";e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace";e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly";e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly";e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption";e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption";e[e.PrintPdfNative=33]="PrintPdfNative";e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown";e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked";e[e.SharedViaFacebook=36]="SharedViaFacebook";e[e.SharedViaTwitter=37]="SharedViaTwitter";e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn";e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo";e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog";e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog";e[e.InterruptO365Clicked=42]="InterruptO365Clicked";e[e.InterruptOD50Clicked=43]="InterruptOD50Clicked";e[e.DownloadOfficeApps=44]="DownloadOfficeApps";e[e.QuotaUsageClick=45]="QuotaUsageClick"}(t.UsageName||(t.UsageName={}));!function(e){e[e.OfficePlansSection=1]="OfficePlansSection";e[e.StoragePlansSection=2]="StoragePlansSection";e[e.UpgradePage=3]="UpgradePage";e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar";e[e.EmbedPane=5]="EmbedPane";e[e.OneUp=6]="OneUp";e[e.SharingDialog=7]="SharingDialog"}(t.LocationName||(t.LocationName={}))});define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(i,e,t,o,r,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="SaveAutoAlbum";t._isHidden=e.isHidden||!1;return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return n.isFeatureEnabled(n.EnableEvokeAlignments)&&e&&e.virtualItemType===a.default.Album&&(s.isAutoAlbum(e)||n.isFeatureEnabled(n.EvokeDev))};return e}(r.default);e.default=u});define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(i,e,t,o,r,n,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="DiscardAutoAlbum";return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return n.isFeatureEnabled(n.EnableEvokeAlignments)&&e&&e.virtualItemType===a.default.Album&&s.isAutoAlbum(e)};return e}(r.default);e.default=u});define("odsp-next/actions/saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction",["require","exports","tslib","../../../base/BaseAction"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ImplicitSaveAutoAlbum";t._action=e.action;t._saveAutoAlbumAction=e.saveAutoAlbumAction;return t}e.prototype.onExecute=function(t,e){var r=this;return this._action.execute(t).then(function(e){r._saveAutoAlbumAction.isAvailable()&&r._saveAutoAlbumAction.execute(t);return e})};e.prototype.onIsAvailable=function(){return this._action.isAvailable()};return e}(r.default);t.default=o});define("odsp-next/dataSources/itemCommand/odc/ItemCommandDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/command/ItemCommand","../../item/odc/SkyApiCommands","../../../models/item/command/CoreItemCommandKeys","../../../models/item/command/SocialItemCommandKeys","../../../models/item/command/PhotoItemCommandKeys","../../../models/item/command/CustomizationItemCommandKeys","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/command/OfficeItemCommandKeys","../../../models/item/command/WebItemCommandKeys"],function(e,t,r,i,n,o,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){var t={};for(var r in e){var i=e[r];if(i instanceof Array)for(var o=0,n=i;o<n.length;o++)t[n[o].id]=r;else t[i.id]=r}return t}(((f={})[o.abdicatePermissions]=s.removeFromShared,f[o.addCoverPhoto]=l.addAsCoverPhoto,f[o.applyOfficeLens]=u.applyOfficeLens,f[o.addTag]=u.removeTags,f[o.addToAlbum]=[u.addToAlbum,u.editTags],f[o.addToSharedList]=s.addToShared,f[o.changeExpiration]=c.changeExpiration,f[o.comment]=s.comment,f[o.copy]=c.copyFrom,f[o.createExcel]=d.createExcel,f[o.createExcelSurvey]=d.createSurvey,f[o.createFolder]=c.createFolder,f[o.createMountPoint]=s.addAsMountPoint,f[o.createOneNote]=d.createOneNote,f[o.createPowerPoint]=d.createPowerPoint,f[o.createWord]=d.createWord,f[o.defaultClick]=a.defaultClick,f[o.deleteCommand]=c.deleteItem,f[o.download]=p.download,f[o.editSurvey]=d.editSurvey,f[o.embed]=s.embed,f[o.emptyRecycleBin]=c.deleteAllItems,f[o.modifyCaption]=u.editCaption,f[o.move]=c.moveFrom,f[o.openInOffice]=d.openInClient,f[o.openInTextEditor]=c.openInTextEditor,f[o.openPdfInBrowser]=c.openPdfInBrowser,f[o.playAudio]=u.play,f[o.rearrange]=l.rearrange,f[o.removeCoverPhoto]=l.removeAsCoverPhoto,f[o.removeFromAlbum]=u.removeFromAlbum,f[o.removeFromRecent]=l.removeFromRecent,f[o.removeMountPoint]=s.removeAsMountPoint,f[o.rename]=c.rename,f[o.removeOfficeLens]=u.removeOfficeLens,f[o.reportAbuse]=s.reportAbuse,f[o.requestReview]=s.requestReview,f[o.restore]=c.restoreItem,f[o.restoreAll]=c.restoreAllItems,f[o.rotate]=u.rotate,f[o.share]=[s.share,u.addPhotosToAlbum],f[o.shareSurvey]=d.publishSurvey,f[o.upload]=[p.upload,c.createText],f[o.viewInBrowser]=d.openOnline,f[o.viewOriginal]=u.viewOriginal,f[o.viewSurvey]=d.viewSurvey,f[o.viewVersions]=d.viewVersionHistory,f));var f,h,g={1:1,2:2,3:3,4:4,7:5,6:6,10:7,11:8,15:9,50:10},v={1:1,2:2,3:3,4:4,5:5,6:6,7:7},y={1:1,2:2},b=((h={})[o.openInTextEditor]=!0,h[o.openPdfInBrowser]=!0,h),_=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCommand=function(e,t){var r,i=this._getCommandName(t);if(i){var o=this._getActionId(e,i);if(o)switch(t){case a.defaultClick:r=this._createDefaultClickCommand(o);break;case d.openInClient:r=this._createOpenInClientCommand(o);break;case d.createWord:case d.createExcel:case d.createPowerPoint:case d.createOneNote:r=this._createCreateDocumentCommand(o);break;default:r=new n.default}else this._isGeneralSupportedCommand(i)&&(r=new n.default)}return r};t.prototype._getActionId=function(e,t){var r;e&&e.properties&&e.properties.commandsSupported&&(r=e.properties.commandsSupported[t]);return r};t.prototype._isGeneralSupportedCommand=function(e){return b[e]};t.prototype._getCommandName=function(e){return m[e.id]};t.prototype._createDefaultClickCommand=function(e){var t=g[e]||0;return new n.default({behavior:t})};t.prototype._createOpenInClientCommand=function(e){var t=v[e]||0;return new n.default({behavior:t})};t.prototype._createCreateDocumentCommand=function(e){var t=y[e]||0;return new n.default({behavior:t})};return t}(i.default);t.default=_});define("odsp-next/models/item/command/ItemCommand",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t};t.default=r});define("odsp-next/dataSources/processFilters/odc/ProcessFiltersDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/vroom/VroomDataRequestor"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a;(a=n||(n={}))[a.OfficeLens=0]="OfficeLens";var s=function(t){r.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.applyOfficeLens=function(e){var t=this.resources.consume(o.resourceKey),r={name:n[n.OfficeLens]};return t.send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses",requestType:"POST",postData:JSON.stringify(r)})};e.prototype.removeOfficeLens=function(e){return this.resources.consume(o.resourceKey).send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses/"+n[n.OfficeLens],requestType:"DELETE"})};return e}(i.default);t.default=s});define("odsp-next/providers/processFilters/ProcessFiltersProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../item/ItemProvider","../../models/task/Task"],function(e,t,i,n,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._processFiltersDataSource=t.resources.consume(o.processFilters);t._itemProvider=t.resources.consume(a.resourceKey);return t}e.prototype.applyOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.applyOfficeLens.bind(this))};e.prototype.removeOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.removeOfficeLens.bind(this))};e.prototype._updateOfficeLens=function(e,r,t){var i=this,o=[new s.default(e.item.key,e.item)];r.update(o);return t(e).then(function(){i._itemProvider.invalidateItem(e.parentKey);i._itemProvider.invalidateItem(e.item.key,{triggerFetch:!0});o=o.map(function(e){return e.succeed()});r.update(o)},function(t){o=o.map(function(e){return e.fail(t)});r.update(o);return n.default.wrapError(t)})};return e}(r.default);t.default=u});define("odsp-next/dataSources/bundle/odc/BundleDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel"],function(r,e,i,o,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBundles=function(){return(e={})[1]={path:"odsp-next/bundles/odc/DeferredControls",getModule:function(){return new o.default(function(e,t){r(["odsp-next/bundles/odc/DeferredControls"],e,t)})},isLoaded:this.createObservable(!1)},e[2]={path:"odsp-next/bundles/odc/Notifications",getModule:function(){return new o.default(function(e,t){r(["odsp-next/bundles/odc/Notifications"],e,t)})},isLoaded:this.createObservable(!1)},e[3]={path:"odsp-next/bundles/odc/Quota",getModule:function(){return new o.default(function(e,t){r(["odsp-next/bundles/odc/Quota"],e,t)})},isLoaded:this.createObservable(!1)},e[4]={path:"odsp-next/bundles/odc/PushChannel",getModule:function(){return new o.default(function(e,t){r(["odsp-next/bundles/odc/PushChannel"],e,t)})},isLoaded:this.createObservable(!1)},e[5]={path:"odsp-next/bundles/odc/FirstRun",getModule:function(){return new o.default(function(e,t){r(["odsp-next/bundles/odc/FirstRun"],e,t)})},isLoaded:this.createObservable(!1)},e;var e};return t}(t.default);e.default=n});define("odsp-next/utilities/experiment/ExperimentHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../features/Features","../optimizely/OptimizelyHelper","@ms/odsp-utilities/lib/logging/events/Experiment.event","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys"],function(e,t,i,l,c,n,d,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._navigation=t.resources.consume(o.navigation);t._userInfoProvider=t.resources.consume(a.userInfo);t._shouldSkipOptimizely=t.determineShouldSkipOptimizely();return t}e.prototype.activateExperimentBehindFeature=function(i,o,e){var t=this;return c.isFeatureEnabled(i)?this._shouldSkipOptimizely?l.default.wrap(0):n.OptimizelyHelper.activateExperiment(o).then(function(){return t.getVariationIdsMapForExperiment(o)}).then(function(e){if(e){var t=window.optimizely,r=t&&t.data;d.default.logData({name:i.ODC?String(i.ODC):String(i.ODB),isInRamp:!0,experiment:r&&r.experiments[o]&&r.experiments[o].name,variant:r&&r.variations[e]&&r.variations[e].name})}return e},function(e){return l.default.wrap(0)}):l.default.wrap(0)};e.prototype.activateSRMProneExperimentBehindFeature=function(t,r,i){var o=this;return c.isFeatureEnabled(t)?this._shouldSkipOptimizely?l.default.wrap(0):this._userInfoProvider.getOptimizelyVariation(r).then(function(e){if(e){if(!window.optimizely)return e;window.optimizely.push(["bucketVisitor",r,e])}return o.activateExperimentBehindFeature(t,r,i).then(function(e){o._userInfoProvider.setOptimizelyVariation(r,e);return e})}):l.default.wrap(0)};e.prototype.getVariationIdsMapForExperiment=function(e){return this._shouldSkipOptimizely?l.default.wrap(0):n.OptimizelyHelper.GetVariationIdsMapForExperiment(e).then(function(e){return e&&e.length?parseInt(e[0],10):0})};e.prototype.determineShouldSkipOptimizely=function(){for(var e=this._navigation.viewParams,t=!1,r=0,i=Object.keys(e);r<i.length;r++){if(i[r].match("optimizely_x")){t=!0;break}}return!t&&this.isInapplicableEnvironment()};e.prototype.isExperimentManualTest=function(e){return!!this._navigation.viewParams["EXPExperimentTest_e"+e]};e.prototype.isInapplicableEnvironment=function(){var e="edog"===(window._spPageContextInfo&&window._spPageContextInfo.env);return!(!window.$Config||!window.$Config.isINT)||e};e.prototype.startEXPExperimentBehindFeature=function(t,e){var r=this,i=e.experimentId,o=e.experimentName,n=e.variationMap,a=e.getVariationFunction;if(c.isFeatureEnabled(t)){if(this.isExperimentManualTest(i)){var s=this._navigation.viewParams["EXPExperimentTest_e"+i],u=Number(s);return isNaN(u)||!n[u]?l.default.wrap(0):l.default.wrap(u)}return this.getExperimentVariation(i,a).then(function(e){e&&!r.isInapplicableEnvironment()&&d.default.logData({name:t.ODC?String(t.ODC):String(t.ODB),isInRamp:!0,experiment:o,variant:n[e]&&n[e].name});return e})}return l.default.wrap(0)};e.prototype.getExperimentVariation=function(i,o){var n=this;return this._userInfoProvider.getEXPExperimentVariation(i).then(function(e){if(e)return l.default.wrap(e);var t=n.resources.consume(s.identity.optional).getIdentity().id,r=o(t);return n._userInfoProvider.setEXPExperimentVariation(i,r).then(function(e){return e?l.default.wrap(r):l.default.wrap(0)})})};return e}(r.default);t.default=u});define("odsp-next/utilities/educationAndUpsells/EducationAndUpsells",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/upsell/Upsells","../../models/upsell/AvailableUpsells","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","../features/Features","../../providers/inAppMessaging/InAppMessagingProvider.key","../../providers/engagement/Engagement"],function(e,t,r,i,o,n,a,s,u,l,c,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey("EducationAndUpsells");var f=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._userInfoProvider=t.resources.consume(u.userInfo);t._storageOptionsProvider=t.resources.consume(u.storageOptions);t._urlDataSource=t.resources.consume(l.url);t._iamProvider=t.resources.consumeAsync(p.resourceKey);t._engagement=t.resources.consume(m.resourceKey);var r=t.resources.consume(s.navigation);t._newUserOverride=r.viewParams.forceNewUser;return t}e.prototype.getExistingUserTypeOfPremiumUpsell=function(t,r,i){var o=this;void 0===i&&(i=!1);if(d.isFeatureEnabled(d.InAppMessagingExistingUserPositioning)){if(this._checkIsRootAndValid(t,r)&&this._storageOptionsProvider.isReady()){var n=!this.isEligibleForPremiumUpsell("existinguser")&&d.isFeatureEnabled(d.EnableSecurityMomentLightbox);return this._iamProvider.then(function(e){return e.getPremiumUpsellType(n)})}return c.default.wrap()}return this._checkIsRootAndValid(t,r)?d.isFeatureEnabled(d.InAppMessagingMLUpsellPositioning)?this._iamProvider.then(function(e){return e.isAnyMessageActive(301)?c.default.wrap(7):o._getExistingUserTypeOfPremiumUpsellLocal(t,r,i)}):this._getExistingUserTypeOfPremiumUpsellLocal(t,r,i):c.default.wrap()};e.prototype.getAreNoFilesAdded=function(e){if(this._newUserOverride)return!0;for(var t=0,r=0,i=0,o=e.content().items;i<o.length;i++){var n=o[i];if(void 0===n)return!1;if(n().folder){t++;if(0<n().childCount)return!1}else r++;if(2<t||1<r)return!1}return!0};e.prototype.getIsNewUser=function(r,i){var o=this;if(d.isFeatureEnabled(d.InAppMessagingFREControl))return this._checkIsRootAndValid(r,i)?this._iamProvider.then(function(e){return e.isAnyMessageActive(206)}):c.default.wrap(!1);var e=this._getIsNewUserLocal(r,i);d.isFeatureEnabled(d.UseInAppMessagingAPI)&&(e=e.then(function(t){if(o._checkIsRootAndValid(r,i)){var e=o._iamProvider.then(function(e){e.logNewUserTelemetryData(t);return t},function(){return t});if(d.isFeatureEnabled(d.InAppMessagingWaitOnAPI))return e}return t}));return e};e.prototype.isEligibleForPremiumUpsell=function(e){var t=this._storageOptionsProvider.isEligibleForPremium();e||(e="unknown");var r=!this._storageOptionsProvider.hasOffice(),i="";i=r===t?"match":r?"officeonly":"getupgradeonly";this._engagement.logData({name:"PremiumEligibility."+e+"."+i});return t};e.prototype._getExistingUserTypeOfPremiumUpsellLocal=function(e,t,r){var a=this;void 0===r&&(r=!1);return r||!this._determineIfNewlyCreatedAccount(!0,t)?this._userInfoProvider.getPremiumUpsellsViewed().then(function(e){var t=void 0,r="Nothing",i=!1;if(a._storageOptionsProvider.isReady()){if(a.isEligibleForPremiumUpsell("existinguser")){if(!e.hasPositioningViewed){t=1;r="PositioningStandard"}if(!e.hasNewFeaturesViewed){t=5;r="NewFeature"}}else{var o=d.isFeatureEnabled(d.EnableSecurityMomentLightbox);i=o;if(!e.hasPositioningViewed){t=3;r="PositioningExisting"}if(o&&!e.hasNewFeaturesViewed){t=6;r="NewFeaturePremium"}}var n=a._iamProvider.then(function(e){e.logPositioningTelemetryData(r,i);return t},function(){return t});if(d.isFeatureEnabled(d.InAppMessagingWaitOnAPI))return n}return t}):c.default.wrap()};e.prototype._getIsNewUserLocal=function(e,t){var r=this._userInfoProvider;return this._newUserOverride?r.getUserInfo(!1).then(function(){return!0}):this._checkIsRootAndValid(e,t)&&e.childCount<=3&&this.getAreNoFilesAdded(t)&&this._determineIfNewlyCreatedAccount(!1,t)?c.default.all([r.getUpsellViewCount(n.default[o.default.NewBrandFRE]),r.getFirstRunExperienceViewCount(),r.getGuidedTourViewCount()]).then(function(e){return e.every(function(e){return 0===e})}):c.default.wrap(!1)};e.prototype._determineIfNewlyCreatedAccount=function(e,t){if(this._newUserOverride)return!0;var r=t.content().items,i=Date.now();if(0===r.length)return e;for(var o=0,n=r;o<n.length;o++){var a=n[o];if(void 0===a)return e;var s=a().dateCreatedTime;if(!s)return e;if(864e5<i-s.getTime())return!1}return!0};e.prototype._checkIsRootAndValid=function(e,t){return e.key===this._urlDataSource.getRootItemKey()&&!t.isPlaceholder&&!t.isExpired};return e}(i.default);t.default=f});define("odsp-next/providers/inAppMessaging/InAppMessagingProvider.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./InAppMessagingProvider",getModule:function(){return new t.default(function(e,t){r(["./InAppMessagingProvider"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/teachingBubble/odc/TeachingBubbleDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMaxDisplayBubbleCount=function(){return 1};return t}(i.default);t.default=o});define("odsp-next/dataSources/recycleBin/odc/RecycleBinDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","../../../models/item/ItemType","../../../models/item/OneDriveItem","../../../dataSources/url/QueryType"],function(e,t,i,r,o,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(o.url);return t}e.prototype.getRecycleBinItem=function(e){var t=this._urlDataSource.getRootItemKey(u.default.RecycleBin),r=new s.default(t);n.default(r,{key:t,queryType:u.default.RecycleBin,properties:{commandsSupported:{defc:"1"}},type:a.default.Folder,isRootFolder:!0});return r};return e}(r.default);t.default=l});define("odsp-next/providers/recycleBin/RecycleBinProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataSource=t.resources.consume(o.recycleBin);return t}e.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)};return e}(r.default);t.default=n});define("odsp-next/providers/dragAndDropRobot/DragAndDropRobotProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../controls/dragAndDrop/dragAndDropHint/DragAndDropHint"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){r.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null};e.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)};e.prototype._getDragAndDropHintComponent=function(e,t){return{name:o.default.tagName,params:{isRobotVisible:t(),isGridView:e()}}};return e}(i.default);t.DragAndDropRobotProvider=n;t.default=n});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint",["require","exports","./DragAndDropHintViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DragAndDropHint.html","./DragAndDropHint.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-drag-and-drop-hint",template:e("./DragAndDropHint.html"),viewModel:r.default});t.default=o});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHintViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../DragAndDrop.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules","../../../resources/UtilityResourceKeys","../../../utilities/dragAndDropRobot/DragAndDropAnimationHelper.key","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys"],function(n,e,t,i,r,a,s,u,l,c,d,p,m,f,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._actionMap=t.resources.consume(f.actionMap);t._isItemSetRendered=t.resources.consume(f.isItemSetRendered);t._platformDetection=t.resources.consume(u.platformDetection);t._bundleLoader=t.resources.consume(h.bundleLoader);t._experimentHelper=t.resources.consume(p.experimentHelper.optional);var r=t.resources.consume(l.resourceKey),i=new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:a.UploadProcessorType.Html5file});t._isUploadAvailable=i.isAvailable;t._isFirstRunExperienceVisible=t.resources.consume(f.isFirstRunExperienceVisible);t.isGridView=e.isGridView;t.showDropHint=t.createPureComputed(t._computeShowDropHint);t.dropSuggestionText=t.isRobotVisible?s.strings.DragAndDropHintEmptyRobotText:s.strings.DragAndDropHintText;t.fileImageUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/odrobot/dragfilegrid.svg"):n("@ms/odsp-media/dist/media/images/odRobot/dragFileGrid.svg");t.isAnimationApplicable=!1;t.isAnimationClassApplicable=t.createObservable(!1);t.isReady=t.createObservable(!1);t.isRobotVisible=e.isRobotVisible;if(t.isRobotVisible){t.createBackgroundComputed(t._computeShowRobotAnimation);t.robotImageUrl=t.createPureComputed(t._computeRobotImageUrl)}else t.isReady(!0);t.createBackgroundComputed(function(){t.showDropHint()&&t.isRobotVisible&&r.logData({name:"DragAndDropRobot.Show",extraData:{isGridView:t.isGridView}})});return t}e.prototype._computeShowRobotAnimation=function(){var r=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded();this.resources.consumeAsync(m.resourceKey).then(function(t){d.loadModuleExport({path:"../../../utilities/optimizely/experiments/DragAndDropAnimation",getModule:function(){return new i.default(function(e,t){n(["../../../utilities/optimizely/experiments/DragAndDropAnimation"],e,t)})},getExport:function(e){return e}}).then(function(e){if(r._isBundleLoaded)if(t.getInitialized()||!r.isRobotVisible||r._isFirstRunExperienceVisible()){if(t.getInitialized()&&8249797602===t.getOptimizelyVariationId()()){r.isAnimationApplicable=!0;r.isReady(!0);r._setAnimationTimer()}}else r._experimentHelper.activateExperimentBehindFeature(c.DragAndDropRobotAnimation,e.ANIMATION_EXPERIMENT_ID).then(function(e){if(e){t.setOptimizelyVariationId(e);t.setIsInitialized(!0);t.setExperimentSeen();t.setIntializeTime();if(8249797602===e){r.isAnimationApplicable=!0;r._setAnimationTimer()}}r.isReady(!0)})})})};e.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&this._isItemSetRendered()&&this.isReady()};e.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};e.prototype._computeRobotImageUrl=function(){if(this.isReady()){return"url('"+("undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/odrobot/"+(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg")):n("@ms/odsp-media/dist/media/images/odRobot/"+(this.isAnimationApplicable?"RobotListV2.gif":"RobotListV2.svg")))+"')"}return""};return e}(r.default);e.default=o});define("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id+".dragAndDropAnimationHelper",loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./DragAndDropAnimationHelper",getModule:function(){return new t.default(function(e,t){r(["./DragAndDropAnimationHelper"],e,t)})},getExport:function(e){return e.resourceKey}})})});e.default=e.resourceKey});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.html",[],function(){return"\x3c!--ko if: showDropHint()--\x3e<div class=od-DragAndDropHint data-bind=\"css: { 'od-DragAndDropHint--grid': isGridView, 'ms-slideLeftIn40': isAnimationClassApplicable() && isGridView, 'ms-slideUpIn20': isAnimationClassApplicable() && !isGridView, 'is-animating': isReady() && (isAnimationApplicable && !isAnimationClassApplicable()) }\"><div class=od-DragAndDropHint-box data-bind=\"css: { 'od-DragAndDropHint-box--grid': isGridView, 'od-DragAndDropHint-box--robot': isRobotVisible }\">\x3c!--ko if: isGridView--\x3e<div class=od-DragAndDropHint-fileContainer><img class=od-DragAndDropHint-file data-bind=\"attr: { src: fileImageUrl }\"></div>\x3c!--/ko--\x3e<div class=od-DragAndDropHint-text data-bind=\"text: dropSuggestionText, css: { 'od-DragAndDropHint-text--grid': isGridView }\"></div></div>\x3c!--ko if: isRobotVisible--\x3e<div class=od-DragAndDropHint-robot data-bind=\"style: { 'background-image': robotImageUrl }, css: { 'od-DragAndDropHint-robot--grid': isGridView, 'od-DragAndDropHint-robotAnimation': isReady() && isAnimationApplicable }\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DragAndDropHint-box{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}])});define("odsp-next/providers/uploadTeachingBubble/UploadTeachingBubbleProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/teachingBubble/TeachingBubbleCampaigns","../../models/teachingBubble/TeachingBubble.resx","../../models/item/ItemType","../../models/teachingBubble/TeachingBubbleFileExtensions","@ms/odsp-utilities/lib/async/Promise","../../providers/item/ItemProvider"],function(e,t,n,r,a,s,u,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){n.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.isUserInUploadFRE=t.createObservable(!1);t._visibleItems={};t._isFolder=!1;t._isFileTraversingComplete=t.createObservable(!1);t._itemProvider=t.resources.consume(l.resourceKey);return t}e.prototype.addBubbleToItem=function(e,t,r){this._isFolder=e.type===u.default.Folder;var i=n.__assign({},a.TEACHING_BUBBLE_FIRST_UPLOAD,{bodyCopy:this._getBodyCopy(e,t,r)}),o={campaign:this.createObservable(i),isVisible:this.createObservable(!0)};if(t.key===e.parentKey||this._chosenItemForBubble)if(this._chosenItemForBubble){o.isVisible(!1);o.campaign=void 0;this._visibleItems[e.key]=this.createObservable(o)}else{this._chosenItemForBubble=e.key;this._visibleItems[this._chosenItemForBubble]=this.createObservable(o)}else{this._chosenItemForBubble=e.parentKey;this._visibleItems[this._chosenItemForBubble]&&this._visibleItems[this._chosenItemForBubble](o)}};e.prototype.updateActiveBubble=function(e,t,r){var i=this._visibleItems[this._chosenItemForBubble];i&&i.peek().campaign(n.__assign({},a.TEACHING_BUBBLE_FIRST_UPLOAD,{bodyCopy:this._getBodyCopy(e,t,r)}))};e.prototype.checkIfTeachingBubbleIsApplicable=function(e,t){var r=this,i=t.content().items;if(0<i.length&&i.length<=3&&!this._isFileTraversingComplete.peek()){this._isFileTraversingComplete(!0);this._traverseItemChildren(e).done(function(e){r.isUserInUploadFRE(e)})}};e.prototype.getTeachingBubbleForKey=function(e){return this._visibleItems[e]||(this._visibleItems[e]=this.createObservable({isVisible:!1}))};e.prototype._getBodyCopy=function(e,t,r){var i;if(this._isFolder)i=s.strings.freUploadConfirmationBodyFolder;else if(t.key!==e.parentKey)i=1<r?s.strings.freUploadConfirmationBodyMultipleFolderPlural:s.strings.freUploadConfirmationBodyFileFolder;else{var o=this._fileExtensionExists(e);i=1<r?o?s.strings.freUploadConfirmationMultipleFilesOpen:s.strings.freUploadConfirmationMultipleFiles:o?s.strings.freUploadConfirmationBodyOpen:s.strings.freUploadConfirmationBody}return i};e.prototype._traverseItemChildren=function(e){var t,r={parentKey:e};return!(t=this._itemProvider.getItemSync(r))||t.isPlaceholder||t.isExpired?this.trackPromise(this._itemProvider.getItem(r).then(function(e){return e.content.peek().items.length<=4})):o.default.wrap(t.content.peek().items.length<=4)};e.prototype._fileExtensionExists=function(e){return-1<i.TeachingBubbleFileExtensions.indexOf((e.extension||"").toLowerCase())};return e}(r.default);t.default=c});define("odsp-next/models/teachingBubble/TeachingBubbleFileExtensions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeachingBubbleFileExtensions=["doc","docx","odp","odt","pot","potm","potx","pps","ppsx","ppt","pptm","pptx","xls","xlsb","xlsm","xlsx","ods","arw","bmp","cr2","eps","erf","gif","jpg","mrw","nef","orf","pict","png","psd","jpeg"]});define("odsp-next/controls/list/columns/ListColumns",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.columnMenuHelperTypeResourceKey=new o.ResourceKey({name:r("module").id+".columnMenuHelperType",loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"../../columnsHeader/ColumnMenuHelper",getModule:function(){return new t.default(function(e,t){r(["../../columnsHeader/ColumnMenuHelper"],e,t)})},getExport:function(e){return e.typeResourceKey.local}})})});e.addColumnCommandHelperTypeResourceKey=new o.ResourceKey({name:r("module").id+".addColumnCommandHelperType",loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"../../columnsHeader/AddColumnCommandHelper",getModule:function(){return new t.default(function(e,t){r(["../../columnsHeader/AddColumnCommandHelper"],e,t)})},getExport:function(e){return e.typeResourceKey.local}})})})});define("odsp-next/dataSources/pushChannel/odc/PushChannelDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./PushChannelDataSource",getModule:function(){return new t.default(function(e,t){r(["./PushChannelDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/providers/pushChannel/PushChannelProvider.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./PushChannelProvider",getModule:function(){return new t.default(function(e,t){r(["./PushChannelProvider"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/rootItems/odc/RootItems.key",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../item/ItemTaskObserver","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../item/ItemTaskObserver","../../../models/store/ItemsStore",".././RootItemsTypeFilter.key","../../../controls/leftPane/LeftPane.resx"],function(e,t,l,r,i,c,d,p,o,n,a,s,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={itemTaskObserverType:n.resourceKey,itemsStore:a.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,rootItemsTypeFilter:s.resourceKey.optional,urlDataSource:o.url};t.resourceKey=new i.ResourceKey({name:e("module").id+".rootItems",factory:{dependencies:u,create:function(e){var t=e.itemsStore,r=e.rootItemsTypeFilter,i=e.urlDataSource,o=new e.observablesFactoryType,n=new e.itemTaskObserverType,a=i.getKey(l.__assign({},i.getKeyParams(i.getRootItemKey(p.default.Files)),i.saveItemTypeFilter(r))),s=i.getKey(l.__assign({},i.getKeyParams(i.getRootItemKey(p.default.Recent)),i.saveItemTypeFilter(r))),u=i.getKey(l.__assign({},i.getKeyParams(i.getRootItemKey(p.default.AllMyPhotos))));n.update([new c.Task(a).succeed({item:{key:a,name:c.Graft.backup(m.strings.Files),displayName:c.Graft.backup(m.strings.Files),type:c.Graft.backup(d.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new c.Task(s).succeed({item:{key:s,name:c.Graft.backup(m.strings.Recent),displayName:c.Graft.backup(m.strings.Recent),type:c.Graft.backup(d.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new c.Task(u).succeed({item:{key:u,name:c.Graft.backup(m.strings.Photos),displayName:c.Graft.backup(m.strings.Photos),type:c.Graft.backup(d.default.Folder),displayType:c.Graft.backup(p.default.AllMyPhotos),properties:{commandsSupported:{defc:"1"}}}})]);n.flush();return{instance:o.create({files:t.getItem(a),recent:t.getItem(s),photos:t.getItem(u)}),disposable:o}}}})});define("odsp-next/dataSources/rootItems/RootItemsTypeFilter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey(e("module").id)});define("odsp-next/dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./ItemAutoRefreshDataSource",getModule:function(){return new t.default(function(e,t){r(["./ItemAutoRefreshDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/providers/itemAutoRefresh/ItemAutoRefreshProvider.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./ItemAutoRefreshProvider",getModule:function(){return new t.default(function(e,t){r(["./ItemAutoRefreshProvider"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/dataSources/inAppMessaging/odc/InAppMessagingDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return i.loadModuleExport({path:"./InAppMessagingDataSource",getModule:function(){return new t.default(function(e,t){r(["./InAppMessagingDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function o(){this._originalProvider=new n.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}o.getInstance=function(){return o._instance};o.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};o.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var r=this._originalProvider.getBindings(e,t);return r&&this._remapKeys(r,t)}finally{this._bindingContexts.pop()}};o.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var r=this._originalProvider.getBindingAccessors(e,t);return r&&this._remapKeys(r,t)}finally{this._bindingContexts.pop()}};o.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var r=this._getLocalBindingHandlers(t);if(r){var i=r[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||n.bindingHandlers[e]};o.prototype.getUniqueKeyForBindingHandler=function(e,t){var r=o._BINDING_PROVIDER_UNIQUE_KEY,i=e[r]=e[r]||t+"-local-"+ ++o._lastUniqueKeyOrdinal;this._bindingHandlers[i]={init:e.init&&e.init.bind(e),update:e.update&&e.update.bind(e),options:e.options,preprocess:e.preprocess&&e.preprocess.bind(e)};this._bindingHandlers[i].after=e.after;e.supportsVirtualElements&&(n.virtualElements.allowedBindings[i]=!0);return i};o.prototype._remapKeys=function(e,t){var r=e,i=this._getLocalBindingHandlers(t);if(i){r={};for(var o in e){var n=i[o];r[n&&this.getUniqueKeyForBindingHandler(n,o)||o]=e[o]}}return r};o.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};o._instance=new o;o._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";o._lastUniqueKeyOrdinal=0;return o}(),i=r.getInstance();n.getBindingHandler=i.getBindingHandler.bind(i);n.bindingProvider.instance=i;t.default=r});define("odsp-next/controls/shim/base/Base.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".c_ic_hide{display:none}.c_clr{clear:both}.NotificationBase .t_sela,.NotificationBase.t_cbr{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.NotificationBase button,.NotificationBase input[type=button]{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";cursor:pointer;display:inline-block;height:30px;min-width:80px;outline:0;padding:4px 20px 6px 20px}.NotificationBase textarea{padding:4px 8px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.NotificationBase input{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.NotificationBase.UI_Dialog_ZoomTest{visibility:hidden}.NotificationBase.UI_Dialog_BG{height:100%;width:100%}.NotificationBase.ModalDialog{height:380px;width:860px;margin:auto}.NotificationBase.ModalDialog.UI_Dialog_BG{background-color:rgba(255,255,255,.5)!important;top:0;height:100%;width:100%}.NotificationBase.ModalDialog .OuterContainer{background-color:transparent}.NotificationBase.ModalDialog .InnerContainer{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:#fff;left:0!important;right:0!important;position:absolute!important;margin:auto!important}#sidebar{top:50px!important;z-index:298}#sidebar h1{font-size:17px;font-weight:300}#sidebar a.ContactTile,#sidebar a.FavoritesItem{overflow:visible}"}])});define("odsp-next/controls/FabricIconsDeferred",["require","exports","../utilities/icons/fabric/index"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.initializeIcons("undefined"==typeof __webpack_public_path__?e.toUrl("odsp-media/fonts/"):__webpack_public_path__,{disableWarnings:!0})});define("odsp-next/utilities/icons/fabric/index",["require","exports","./odsp-next-icons","./odsp-next-icons-0","./odsp-next-icons-1","./odsp-next-icons-2","./odsp-next-icons-3","./odsp-next-icons-4","./odsp-next-icons-5","./odsp-next-icons-6","./odsp-next-icons-7","./odsp-next-icons-8","./odsp-next-icons-9","./odsp-next-icons-10","./odsp-next-icons-11","./odsp-next-icons-12","./odsp-next-icons-13","./odsp-next-icons-14","./odsp-next-icons-15","./iconAliases"],function(e,t,i,o,n,a,s,u,l,c,d,p,m,f,h,g,v,y,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(t,r){void 0===t&&(t="https://spoprod-a.akamaihd.net/files/fabric/assets/icons/");[i.initializeIcons,o.initializeIcons,n.initializeIcons,a.initializeIcons,s.initializeIcons,u.initializeIcons,l.initializeIcons,c.initializeIcons,d.initializeIcons,p.initializeIcons,m.initializeIcons,f.initializeIcons,h.initializeIcons,g.initializeIcons,v.initializeIcons,y.initializeIcons,b.initializeIcons].forEach(function(e){return e(t,r)});_.registerIconAliases()}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-0",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"odsp-next-icons-0-37af5ade.woff') format('woff')"},icons:{InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",Phone:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",ContactInfo:"",Memo:"",Paste:"",WindowsLogo:"",GripperBarVertical:"",Unlock:"",Slideshow:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",RedEye:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-1",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"odsp-next-icons-1-b10a0732.woff') format('woff')"},icons:{TVMonitor:"",Speakers:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:"",Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-2",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"odsp-next-icons-2-cf12f11a.woff') format('woff')"},icons:{Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",Communications:"",Headset:"",Health:"",FrontCamera:"",ChevronUpSmall:"",ChevronDownSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-3",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"odsp-next-icons-3-8b008e59.woff') format('woff')"},icons:{BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:"",HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Devices3:"",Focus:"",VideoLightOff:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-4",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"odsp-next-icons-4-cbf12f44.woff') format('woff')"},icons:{StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:"",Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",MiracastLogoLarge:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-5",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"odsp-next-icons-5-3f7557a3.woff') format('woff')"},icons:{DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",POI:"",FacebookLogo:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",ChatInviteFriend:"",Brush:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:"",SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",BoxLogo:"",DelveLogoInverse:"",DropboxLogo:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",ParatureLogo:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-6",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"odsp-next-icons-6-15c41233.woff') format('woff')"},icons:{HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:"",SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",GoogleDriveLogo:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-7",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"odsp-next-icons-7-daf20730.woff') format('woff')"},icons:{DocumentSet:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:"",CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",EmptyRecycleBin:"",Hide2:"",iOSAppStoreLogo:"",AndroidLogo:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",EditContact:"",ConnectContacts:"",ActivateOrders:"",DeactivateOrders:"",DocumentManagement:"",CRMReport:"",Relationship:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-8",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"odsp-next-icons-8-f1eae0b2.woff') format('woff')"},icons:{PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",AddFavorite:"",AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",CannedChat:"",SkypeForBusinessLogo:"",PageCheckedin:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleOn:"",ToggleOff:"",TriangleShape:"",RectangleShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",UnknownMirrored:"",PublicContactCardMirrored:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-9",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"odsp-next-icons-9-ef8cdebb.woff') format('woff')"},icons:{GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:"",ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-10",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"odsp-next-icons-10-d89ca41d.woff') format('woff')"},icons:{RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:"",BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-11",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"odsp-next-icons-11-d19a3768.woff') format('woff')"},icons:{HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:"",FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",EgnyteLogo:"",GoogleDriveLogoLeftGreen:"",GoogleDriveLogoBottomBlue:"",GoogleDriveLogoRightYellow:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-12",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"odsp-next-icons-12-23b7328b.woff') format('woff')"},icons:{Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",UnSetColor:"",DeclineCall:"",RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",MTMLogo:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",NonprofitLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-13",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"odsp-next-icons-13-7d215e81.woff') format('woff')"},icons:{EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:"",Snooze:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",ChronosLogo:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",WaitlistConfirm:"",WaitlistConfirmMirrored:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-14",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"odsp-next-icons-14-41c1cfe5.woff') format('woff')"},icons:{LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:"",CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",ApacheIvyLogo32:"",BitbucketLogo32:"",LinuxLogo32:"",GradleLogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",AnalyticsView:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",GitLogo:"",GitHubLogo:"",ApacheMavenLogo:"",NPMLogo:"",GitFork:"",SVNLogo:"",JenkinsLogo:"",VersionControlPush:"",ExternalGit:"",WhiteBoardApp16:"",WhiteBoardApp32:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",TagSolid:"",OfficeChat:"",OfficeChatSolid:"",MailSchedule:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/odsp-next-icons-15",["require","exports","@uifabric/styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('"+e+"odsp-next-icons-15-33e34a0b.woff') format('woff')"},icons:{WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};i.registerIcons(r,t)}});define("odsp-next/utilities/icons/fabric/iconAliases",["require","exports","@uifabric/styling"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.registerIconAliases=function(){r.registerIconAlias("trash","delete");r.registerIconAlias("onedrive","onedrivelogo");r.registerIconAlias("alertsolid12","eventdatemissed12")};t.default=t.registerIconAliases});define("odsp-next/utilities/TestHooks",["require","exports","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.__loadTests=function(){return r.loadModuleExport({path:"odsp-next-test/functional/remote/execution/Initialization",require:window.require,getExport:function(e){return e.initialize}}).then(function(e){return e()})}});define("odsp-next/controls/leftNav/LeftNav",["require","exports","./LeftNavViewModel","../../bindings/component/ControlBinding","./LeftNav.html","./LeftNav.css","./leftNavSublink/LeftNavSublink"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav",name:e("module").id,template:e("./LeftNav.html"),viewModelType:r.default});t.default=t.resourceKey});define("odsp-next/controls/leftNav/LeftNavViewModel",["require","exports","tslib","knockout","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../bindings/selection/SelectionBinding","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","../../utilities/features/Features","@ms/odsp-utilities/lib/string/StringHelper","./LeftNav.resx","../../bindings/keyboard/KeyboardBinding","../siteIcon/SiteIcon","../../bindings/component/ControlBinding","./leftNavSublink/LeftNavSublink.key"],function(e,t,r,i,o,n,l,a,s,c,d,p,m,f,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(u){r.__extends(e,u);function e(e,t){var r=u.call(this,e,t)||this;r.siteIconTagName=f.default.tagName;r.addBindingHandlers({selection:l.default,keyboard:m.default,control:h.default});r._engagement=t.engagement;var i=r.observables,o=e.linkGroups,n=void 0===o?i.createArray():o,a=e.isLeftNavVisible,s=void 0===a?i.create(!0):a;r.linkGroups=n;r.isLeftNavVisible=s;r.leftNavLinkGroupAriaLabelEnabled=c.isFeatureEnabled(c.LeftNavLinkGroupAriaLabelEnabled);r.isFluentFlight=c.isFeatureEnabled(c.EnableFluentStyling);r.responsiveUI=t.responsiveUI;r._initializeSubSections();return r}e.prototype.toggleExpanded=function(e){var t=e.engagementName;if(t){t=t.replace(/\s/g,"");e.isExpanded()?t+="Collapse":t+="Expand";this._engagement.logData({name:t+".LeftNav.Click",isIntentional:!0})}e.isExpanded(!e.isExpanded());e.keepOpen=i.observable(!0);return!1};e.prototype.onClick=function(e,t){e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:{action:s.capitalizeFirstLetter(t.type)}});if(e.action){e.action.execute(t);return!1}return!0};e.prototype.getLinkGroupAriaLabel=function(e){var t=null;if(this.leftNavLinkGroupAriaLabelEnabled){switch(e.groupingName||""){case"SitesGrouping":t=d.format(p.strings.ariaLabelForLeftNavTeamSiteHeader,this.unwrapObservable(e.text));break;case"UserNameGrouping":t=d.format(p.strings.ariaLabelForLeftNavUserNameLinkGroupHeader,this.unwrapObservable(e.text));break;default:t=d.format(p.strings.ariaLabelForLeftNavLinkGroupHeader,this.unwrapObservable(e.text))}}return t};e.prototype._processGroups=function(e){for(var t=0;t<this.linkGroups().length;t++){var r=this.linkGroups()[t];r.notificationSublinkSpecification=h.toSpecification(g.default,{isLeftNavVisible:this.isLeftNavVisible,linkGroup:r});0<t&&!r.keepOpen&&r.isExpanded(e)}};e.prototype._initializeSubSections=function(){var e=this;this.createComputed(function(){switch(e.responsiveUI.formFactorSize()){case"Small":case"Medium":case"Large":e._processGroups(!1);return!1;default:e._processGroups(!0);return!0}})};e.dependencies=r.__assign({},n.default.dependencies,{responsiveUI:o.resourceKey,engagement:a.resourceKey});return e}(n.default);t.default=u});define("@ms/odsp-shared/lib/utilities/logging/LoggingHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ClickName="Click";t.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}});define("odsp-next/controls/siteIcon/SiteIcon",["require","exports","./SiteIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","./SiteIcon.html","./SiteIcon.css"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"ms-site-icon",template:e("./SiteIcon.html"),viewModel:r.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-site-icon",name:e("module").id,template:e("./SiteIcon.html"),viewModelType:r.default});t.default=n});define("odsp-next/controls/siteIcon/SiteIconViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/tile/ImageTile","../icon/glyph/IconGlyph","@ms/odsp-shared/lib/models/image/Alignments"],function(e,t,r,i,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(d){r.__extends(e,d);function e(e,t){void 0===t&&(t={});var r=d.call(this,e,t)||this;r.imageTileTagName=p.default.tagName;r.iconGlyphTagName=m.default.tagName;var i=e.acronym,o=e.color,n=e.icon,a=e.iconUrl,s=e.size,u=void 0===s?{width:28,height:28}:s,l=e.mode,c=void 0===l?"site":l;r._size=r.wrapObservable(u);r.iconUrl=r.wrapObservable(a);r.icon=r.wrapObservable(n);r.acronym=r.wrapObservable(i);r.color=r.wrapObservable(o);r.mode=c;r.acronymStyle=r.createPureComputed(r._computeAcronymStyle);r.isImageLoaded=r.createObservable(!1);r.imageTileParams={image:r.createPureComputed(r._computeImage),isLoaded:r.isImageLoaded,desiredSize:r._size,alignment:f.AlignmentType.fit};r.iconGlyphParams={icon:r.icon};return r}e.prototype._computeImage=function(){return{url:this.unwrapObservable(this.iconUrl),width:0,height:0}};e.prototype._computeAcronymStyle=function(){var e=.4*this._size().height,t=.72*e;return{height:Math.ceil(e)+"px","font-size":Math.ceil(t)+"px","line-height":Math.ceil(e)+"px"}};return e}(i.default);t.default=o});define("odsp-next/controls/image/tile/ImageTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageTileViewModel","./ImageTile.html","./ImageTile.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-image-tile",template:e("./ImageTile.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/image/tile/ImageTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","../../../bindings/imageLoader/ImageLoaderBinding","../../../bindings/imageRecycler/ImageRecyclerBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-shared/lib/models/image/Alignments","../../../utilities/images/ThumbnailCache","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,r,i,_,S,x,o,p,d,P,I,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(b){r.__extends(e,b);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=b.call(this,e,t)||this;r.addBindingHandlers({imageLoader:S.default,imageRecycler:x.default});var i=e.image,o=e.rotation,n=void 0===o?_.default.none:o,a=e.desiredSize,s=e.scale,u=void 0===s?1:s,l=e.isLoaded,c=void 0===l?r.createObservable(!1):l,d=e.position,p=e.loadedImage,m=e.error,f=e.loadImageScenarioName,h=t.thumbnailCache,g=void 0===h?r.resources.consume(I.resourceKey):h,v=t.outputExtenders,y=void 0===v?{deferred:!0}:v;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(n);r._scale=r.wrapObservable(u);r._desiredSize=r.wrapObservable(a);r._alignment=P.createAlignment(e.alignment);r._thumbnailCache=g;r._loadedImage=r.wrapObservable(p);r._error=r.wrapObservable(m);r.isRotating=r._getIsRotating();r.alignmentName=r.createPureComputed(r._computeAlignmentName);r.actualSize=r.createPureComputed(r._computeActualSize);r.actualSize.equalityComparer=w.deepCompare;r.isLoaded=r.createPureComputed(r._computeIsLoaded);r._imageUrl=r.createPureComputed(r._computeImageUrl);r._finalSize=r.createPureComputed(r._computeFinalSize);r._finalSize.equalityComparer=w.deepCompare;r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=w.deepCompare;r.imageElementStyle=r.createPureComputed(r._computeImageElementStyle);r.imageElementStyle.equalityComparer=w.deepCompare;r.imageBackgroundStyle=r.createPureComputed(r._computeImageBackgroundStyle);r.imageBackgroundStyle.equalityComparer=w.deepCompare;r.createBackgroundComputed(r._computeRecordImage);r.imageLoaderParams={src:r._imageUrl,image:r._loadedImage,error:r._error,scenarioName:f};d&&r.createBackgroundComputed(function(){return d(r._position())}).extend(y);c&&r.createBackgroundComputed(function(){return c(r.isLoaded())}).extend(y);return r}e.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&o.format(e.url,e.width,e.height)||""};e.prototype._computeFinalSize=function(){var e,t=this._image(),r=this._scale();if(t&&!t.width){var i=this.actualSize(),o=window.devicePixelRatio||1;e=i&&{width:i.width*r/o,height:i.height*r/o}}else e=t&&{width:t.width*r,height:t.height*r};return e};e.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),r=this._finalSize(),i=this._rotation();if(r){var o=void 0;o=t&&t.width&&t.height?t:r;var n=this._alignment.getTransform(r,o),a=n.translate.x/o.width,s=n.translate.y/o.height,u=n.scale*r.width/o.width,l=void 0;if(i){var c=void 0;if(i%2==1){var d={width:r.height,height:r.width};c=this._alignment.getTransform(d,o).multiply(n.invert())}else c=p.default.IDENTITY;l="rotate("+90*i+"deg) scale("+c.scale.toFixed(6)+")"}else l="";e={left:(100*a).toFixed(2)+"%",top:(100*s).toFixed(2)+"%",width:(100*u).toFixed(2)+"%","-webkit-transform":l,"-ms-transform":l,transform:l}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};e.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?e.width.toFixed(2)+"px":"","max-height":e?e.height.toFixed(2)+"px":"","background-image":'url("'+t+'")'}};e.prototype._getIsRotating=function(){var t,r=this,i=this.createObservable(this._rotation.peek()),e=this.createPureComputed(function(){var e=r._rotation();t&&r.async.clearTimeout(t);t=r.async.setTimeout(function(){return i(e)},300);return i()});return this.createPureComputed(function(){return r._rotation()!==e()})};e.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};e.prototype._computeIsLoaded=function(){return!!this._loadedImage()};e.prototype._computeActualSize=function(){var e,t=this._loadedImage();if(t){e={width:t.width,height:t.height}}return e};e.prototype._computePosition=function(){var e,t=this._desiredSize(),r=this._finalSize(),i=this._rotation();if(r){var o=void 0;o=t&&t.width&&t.height?t:r;var n=void 0;n=i%2==1?{width:r.height,height:r.width}:r;var a=this._alignment.getTransform(n,o),s=a.translate.x,u=a.translate.y,l=a.scale*n.width,c=a.scale*n.height;e=new d.default(s,u,l,c)}return e};e.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return e}(i.default);t.default=n});define("odsp-next/bindings/imageRecycler/ImageRecyclerBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../imageLoader/ImageLoaderBinding","../../utilities/images/ImageRecycler","knockout"],function(e,t,r,i,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(l){r.__extends(e,l);function e(e){var t=l.call(this,e)||this,r=t.resources.consume(d.resourceKey),i=t.valueAccessor(),o=r.checkOutImage(),n=t.bindingContext,a=i.style,s=i.css,u=i.class;a&&p.applyBindingsToNode(o,{style:a},n);s&&p.applyBindingsToNode(o,{css:s},n);u&&p.applyBindingsToNode(o,{class:u},n);new(t.managed(c.default))({element:o,allBindingsAccessor:t.allBindingsAccessor,valueAccessor:function(){return i.imageLoader},bindingContext:n});p.virtualElements.setDomNodeChildren(t.element,[o]);t.addDisposable({dispose:function(){if(o){p.cleanNode(o);r.checkInImage(o).done()}}});t.controlsDescendantBindings=!0;return t}e.supportsVirtualElements=!0;return e}(i.default);t.default=o});define("odsp-next/utilities/images/ImageRecycler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources"],function(e,n,t,r,a,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EMPTY_IMAGE="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var o=function(o){t.__extends(e,o);function e(e,t){var r=o.call(this,e,t)||this,i=r._images=[];r.async.setInterval(function(){300<i.length&&i.splice(300,1/0)},6e4);return r}e.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};e.prototype.checkInImage=function(e){var t=this,r=new a.default,i=this.async;i.setTimeout(function(){e.setAttribute("src",n.EMPTY_IMAGE);e.removeAttribute("style");e.removeAttribute("class");i.setTimeout(function(){e.removeAttribute("src");t._images.push(e);r.complete()},1e3)},0);return r.getPromise()};return e}(r.default);n.default=o;n.resourceKey=i.createResolvedResourceKey(e("module").id,o)});define("@ms/odsp-utilities/lib/math/Transform",["require","exports","./Point","./Rectangle"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(e,t){void 0===e&&(e=new o.default);void 0===t&&(t=1);this.translate=e;this.scale=t}i.areEqual=function(e,t,r){void 0===r&&(r=1e-6);return o.default.areEqual(e.translate,t.translate,r)&&Math.abs(Math.log(e.scale/t.scale))<r};i.zoom=function(e,t,r){return new i(e.subtract(t).scale(r-1),r)};i.centerWithinBounds=function(e,t,r){return new i(new n.default(o.default.ORIGIN,e).getCenter().subtract(o.default.getCenter([t,r])))};i.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};i.prototype.multiply=function(e){return new i(this.translate.add(e.translate.scale(this.scale)),this.scale*e.scale)};i.prototype.invert=function(){return new i(this.translate.scale(-1/this.scale),1/this.scale)};i.IDENTITY=new i;return i}();t.default=r});define("@ms/odsp-shared/lib/models/image/Alignments",["require","exports","tslib","@ms/utilities-image/lib/Alignments"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("@ms/utilities-image/lib/Alignments",["require","exports","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Point"],function(e,i,u,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitWidth=3]="fitWidth";e[e.fitHeight=4]="fitHeight";e[e.top=5]="top"}(n=i.AlignmentType||(i.AlignmentType={}));var t=function(e,t){this.name=e;this.getTransform=t};function r(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];return new t(s.map(function(e){return e.name}).join("-"),function(e,t){for(var r=u.default.IDENTITY,i=0,o=s;i<o.length;i++){var n=o[i],a={width:e.width*r.scale,height:e.height*r.scale};r=n.getTransform(a,t).multiply(r)}return r})}i.center=new t(n[n.center],function(e,t){var r=new o.default((t.width-e.width)/2,(t.height-e.height)/2);return new u.default(r)});i.top=new t(n[n.top],function(e,t){var r=new o.default((t.width-e.width)/2,0);return new u.default(r)});i.fitWidth=new t(n[n.fitWidth],function(e,t){var r=t.width/e.width;return new u.default(o.default.ORIGIN,Math.min(r,1))});i.fitHeight=new t(n[n.fitHeight],function(e,t){var r=t.height/e.height;return new u.default(o.default.ORIGIN,Math.min(r,1))});i.fit=new t(n[n.fit],function(e,t){var r=e.width/e.height;return(t.width/t.height<r?i.fitWidth:i.fitHeight).getTransform(e,t)});i.cover=new t(n[n.cover],function(e,t){var r=e.width/e.height;return(t.width/t.height<r?i.fitHeight:i.fitWidth).getTransform(e,t)});i.fitCenter=r(i.fit,i.center);i.coverCenter=r(i.cover,i.center);function a(e){var t,r;if("string"==typeof e)t=n[e];else{if("object"==typeof e)return e;t=e}switch(t){case n.top:r=i.top;break;case n.fitHeight:r=i.fitHeight;break;case n.fitWidth:r=i.fitWidth;break;case n.fit:r=i.fitCenter;break;case n.center:r=i.center;break;default:r=i.coverCenter}return r}i.getAlignment=a;i.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return r.apply(void 0,t.map(a))}});define("odsp-next/controls/image/tile/ImageTile.html",[],function(){return"<span class=od-ImageTile data-bind=\"css: { 'od-ImageTile--isLoaded': isLoaded, 'od-ImageTile--isDimensioned': !!actualSize(), 'od-ImageTile--isRotating': isRotating, 'od-ImageTile--isAligned': !!alignmentName(), 'od-ImageTile--isCustom': !alignmentName() }, class: (alignmentName() ? 'od-ImageTile--' + alignmentName() : '')\"><span class=od-ImageTile-background data-bind=\"style: imageBackgroundStyle\"></span>\x3c!--ko imageRecycler: {\r\n imageLoader: imageLoaderParams,\r\n class: 'od-ImageTile-image',\r\n style: imageElementStyle\r\n }--\x3e\x3c!--/ko--\x3e</span>"});define("odsp-next/controls/image/tile/ImageTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"}])});define("odsp-next/controls/icon/glyph/IconGlyph",["require","exports","./IconGlyphViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IconGlyph.html","./IconGlyph.css"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-icon-glyph",template:e("./IconGlyph.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/icon/glyph/IconGlyphViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.icon=o.isObservable(e.icon)?e.icon:o.observable(e.icon);t.badge=o.isObservable(e.badge)?e.badge:o.observable(e.badge);t.iconClasses=t.createComputed(function(){return t.icon()&&t.icon().getClass()||""});t.badgeClasses=t.createComputed(function(){return t.badge()&&t.badge().getClass()||""});return t}return e}(r.default);t.default=n});define("odsp-next/controls/icon/glyph/IconGlyph.html",[],function(){return"<i class=od-IconGlyph data-bind=\"class: iconClasses, attr: { 'data-icon-name': icon }, css: { 'od-IconGlyph--badged': badge, 'od-IconGlyph--visible': icon }, with: badge\"><i class=od-IconGlyph-badge data-bind=\"class: $component.badgeClasses, attr: { 'data-icon-name': $component.badge }\"></i></i>"});define("odsp-next/controls/icon/glyph/IconGlyph.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}])});define("odsp-next/controls/siteIcon/SiteIcon.html",[],function(){return"<span class=od-SiteIcon data-bind=\"css: { 'od-SiteIcon--hasIcon': !!icon, 'od-SiteIcon--hasAcronym': !!acronym, 'od-SiteIcon--hasImage': isImageLoaded }, class: 'od-SiteIcon--' + mode, style: { 'background-color': color }\">\x3c!--ko if: !!icon()--\x3e<span class=od-SiteIcon-icon data-bind=\"component: { name: iconGlyphTagName, params: iconGlyphParams }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!acronym()--\x3e<span class=od-SiteIcon-acronym data-bind=\"style: acronymStyle, text: acronym\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!iconUrl()--\x3e<span class=od-SiteIcon-image data-bind=\"component: { name: imageTileTagName, params: imageTileParams }\"></span>\x3c!--/ko--\x3e</span>"});define("odsp-next/controls/siteIcon/SiteIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SiteIcon{position:absolute;top:0;left:0;bottom:0;right:0;display:block;overflow:hidden;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SiteIcon--person{border-radius:50%}.isFluent .od-SiteIcon{border-radius:2px}.od-SiteIcon-icon{position:absolute;top:0;left:0;right:0;bottom:0}.od-SiteIcon-icon .od-IconGlyph.ms-Icon{position:absolute;margin:auto;top:0;left:0;bottom:0;right:0;width:100%}.od-SiteIcon-acronym{position:absolute;top:0;left:0;bottom:0;right:0;height:18px;margin:auto;text-align:center;white-space:nowrap;font-weight:100;font-size:13px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-SiteIcon-image{position:absolute;top:0;left:0;right:0;bottom:0;visibility:hidden}.od-SiteIcon--site .od-SiteIcon-image:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.od-SiteIcon--hasImage .od-SiteIcon-image{visibility:inherit;background-color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"./LeftNavSublink",getModule:function(){return new t.default(function(e,t){r(["./LeftNavSublink"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/leftNav/LeftNav.html",[],function(){return"<div class=LeftNav><div class=LeftNav-linkArea data-bind=\"foreach: linkGroups\">\x3c!--ko if: links && links().length > 0--\x3e<div class=LeftNav-linkGroupContainer role=tree><div class=LeftNav-linkGroup role=group data-bind=\"automation: automationId, css: { 'is-expanded': isExpanded }, selection: { data: links, mode: 'single', direction: 'vertical', properties: { focused: 'isFocused', href: 'url' } }, attr: { tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-label': $component.getLinkGroupAriaLabel($data) }\">\x3c!--ko if: !$data.hideGroupHeader--\x3e<div class=LeftNav-linkGroupHeader data-bind=\"attr: { 'title': text }, css: { 'LeftNav-linkGroupHeader--hasPlus': $data.plusIconProperties && $data.plusIconProperties(), 'LeftNav-linkGroupHeader--hasSubText': $data.subText, 'LeftNav-linkGroupHeader--hasIcon': $data.icon, 'ms-fontSize-14': $component.isFluentFlight, 'ms-font-s': !$component.isFluentFlight, 'ms-fontWeight-semibold': $component.isFluentFlight, 'ms-fontWeight-regular': !$component.isFluentFlight }\">\x3c!--ko if: $data.icon--\x3e<span class=od-LeftNav-linkGroupHeaderIcon data-bind=\"component: { name: $component.siteIconTagName, params: $data.icon }\"></span>\x3c!--/ko--\x3e<span class=od-LeftNav-linkGroupHeaderTitle data-bind=\"text: $data.text\"></span>\x3c!--ko if: $data.subText--\x3e<span class=od-LeftNav-linkGroupHeaderSubText data-bind=\"text: $data.subText\"></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko control: $data.notificationSublinkSpecification--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: !$data.hideGroupHeader && $data.plusIconProperties && $data.plusIconProperties()--\x3e<a class=LeftNav-linkGroup-plusWrapper role=button href=javascript:; data-bind=\"attr: { 'aria-label': $data.plusIconProperties().text, 'title': $data.plusIconProperties().text, tabindex: $component.isLeftNavVisible() ? 0: -1 }, click: function(context, event) { $component.onClick($data.plusIconProperties(), event); }\"><i class=\"LeftNav-linkGroup-plus ms-Icon ms-Icon--Add\" data-bind=\"icon: true\"></i></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>"});define("odsp-next/controls/leftNav/LeftNav.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LeftNav-expandButton.ms-Icon{position:absolute;height:40px;text-align:center;-ms-transform:rotate(0);transform:rotate(0);-ms-transform-origin:50% 50%;transform-origin:50% 50%;line-height:32px;height:32px}[dir=ltr] .LeftNav-expandButton.ms-Icon{left:17px}[dir=rtl] .LeftNav-expandButton.ms-Icon{right:17px}.isFluent .LeftNav-expandButton.ms-Icon{line-height:36px;height:36px}.lg .LeftNav-expandButton.ms-Icon,.md .LeftNav-expandButton.ms-Icon,.sm .LeftNav-expandButton.ms-Icon{height:40px;line-height:40px}.LeftNav-expandButton.is-link.ms-Icon{cursor:default}.LeftNav-linkGroup.is-expanded .LeftNav-expandButton{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.xlg .LeftNav-linkArea,.xxlg .LeftNav-linkArea,.xxxlg .LeftNav-linkArea,.xxxxlg .LeftNav-linkArea{padding-top:8px}.LeftNav-linkGroupContainer{position:relative;padding:8px 0 0 0}.LeftNav-linkGroupContainer .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-linkGroupContainer:first-child{padding:24px 0 0 0}.isFluent .LeftNav-linkGroupContainer:first-child{padding:8px 0 0 0}.LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:24px}.isFluent .LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-subLinksClip{overflow:hidden}.LeftNav-subLinks{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.LeftNav-subLinks:focus{outline:0}a.LeftNav-link{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}a.LeftNav-subLink{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.LeftNav-linkGroupHeader,a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{margin:0;display:block;padding:0 16px 0 16px;border:none;background:0 0;text-decoration:none;white-space:nowrap;overflow:hidden;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir=rtl] .LeftNav-linkGroupHeader,html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{padding:0 16px 0 16px}.isFluent .LeftNav-linkGroupHeader,.isFluent a.LeftNav-groupLink,.isFluent a.LeftNav-link,.isFluent a.LeftNav-subLink{color:#323130}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{height:32px;line-height:32px}.isFluent a.LeftNav-groupLink,.isFluent a.LeftNav-link,.isFluent a.LeftNav-subLink{height:36px;line-height:36px}.lg a.LeftNav-groupLink,.lg a.LeftNav-link,.lg a.LeftNav-subLink,.md a.LeftNav-groupLink,.md a.LeftNav-link,.md a.LeftNav-subLink,.sm a.LeftNav-groupLink,.sm a.LeftNav-link,.sm a.LeftNav-subLink{height:40px;line-height:40px}[dir=ltr] .LeftNav-linkGroupHeader--hasIcon{padding-left:56px}[dir=rtl] .LeftNav-linkGroupHeader--hasIcon{padding-right:56px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:32px;text-overflow:ellipsis;overflow:hidden}.isFluent .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:36px}.lg .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:40px}.LeftNav-linkGroupHeader--hasSubText{padding-top:4px;padding-bottom:8px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px;font-size:14px}.lg .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderSubText{line-height:15px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{display:block;position:absolute;width:32px;height:32px}[dir=ltr] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-left:-40px}[dir=rtl] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-right:-40px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderSubText{display:block;font-size:12px;text-overflow:ellipsis;overflow:hidden}.od-focus--enabled a.LeftNav-groupLink.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-link.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-subLink.LeftNav-is-focused:after{content:'';box-shadow:0 0 0 1px #666 inset;width:100%;position:absolute;height:100%;left:0;top:0}.isFluent.od-focus--enabled a.LeftNav-link.LeftNav-is-focused:after{box-shadow:0 0 0 1px #605e5c inset}.isFluent.od-focus--enabled a.LeftNav-subLink.LeftNav-is-focused:after{box-shadow:0 0 0 1px #605e5c inset}.isFluent.od-focus--enabled a.LeftNav-groupLink.LeftNav-is-focused:after{box-shadow:0 0 0 1px #605e5c inset}.od-focus--enabled .LeftNav-linkGroupHeader:focus{box-shadow:0 0 0 1px #666 inset;outline:1px solid transparent}a.LeftNav-groupLink:hover,a.LeftNav-link:hover,a.LeftNav-subLink:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.LeftNav-linkGroupHeader{cursor:default;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";outline:0}[dir=ltr] .LeftNav-linkGroupHeader--hasPlus{margin-right:20px}[dir=rtl] .LeftNav-linkGroupHeader--hasPlus{margin-left:20px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{cursor:pointer}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}a.LeftNav-groupLink:hover:not(.LeftNav-is-active),a.LeftNav-link:hover:not(.LeftNav-is-active),a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent a.LeftNav-groupLink:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-link:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:#edebe9}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:active){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText{-ms-transform:scale(.95);transform:scale(.95);display:inline-block}a.LeftNav-groupLink.LeftNav-is-active:hover,a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #37006e}}a.LeftNav-groupLink.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding-left:14px}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.isFluent a.LeftNav-groupLink.LeftNav-is-active,.isFluent a.LeftNav-link.LeftNav-is-active,.isFluent a.LeftNav-subLink.LeftNav-is-active{font-weight:600;color:#201f1e;background:#e1dfdd;padding-left:16px}html[dir=ltr] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-left:0 solid transparent}html[dir=rtl] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-right:0 solid transparent}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #37006e}}a.LeftNav-groupLink>.LeftNav-fadient:after,a.LeftNav-link>.LeftNav-fadient:after,a.LeftNav-subLink>.LeftNav-fadient:after{content:'';position:absolute;top:0;width:24px;height:32px;pointer-events:none}[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{right:0}[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{left:0}html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to right,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to left,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to right,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to left,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}a.LeftNav-subLink{font-weight:100;font-size:17px;text-overflow:ellipsis}.isFluent a.LeftNav-subLink{font-weight:400;font-size:14px}[dir=ltr] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-left:56px}[dir=rtl] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-right:56px}.LeftNav-loadingTemplate,.LeftNav-subLinksAsText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:8px 16px 8px 16px}html[dir=rtl] .LeftNav-loadingTemplate,html[dir=rtl] .LeftNav-subLinksAsText{padding:8px 16px 8px 16px}.lg .LeftNav-loadingTemplate,.lg .LeftNav-subLinksAsText,.md .LeftNav-loadingTemplate,.md .LeftNav-subLinksAsText,.sm .LeftNav-loadingTemplate,.sm .LeftNav-subLinksAsText{font-size:14px}.xlg .LeftNav-loadingTemplate,.xlg .LeftNav-subLinksAsText,.xxlg .LeftNav-loadingTemplate,.xxlg .LeftNav-subLinksAsText,.xxxlg .LeftNav-loadingTemplate,.xxxlg .LeftNav-subLinksAsText,.xxxxlg .LeftNav-loadingTemplate,.xxxxlg .LeftNav-subLinksAsText{font-size:12px}a.LeftNav-link.is-defaultCursor:hover{cursor:default}.LeftNav-link .ms-Icon--ChevronDown:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.LeftNav-linkGroup-plusWrapper{cursor:pointer;margin:auto;position:absolute;top:0;width:30px;height:32px;font-size:14px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .LeftNav-linkGroup-plusWrapper{right:8px}[dir=rtl] .LeftNav-linkGroup-plusWrapper{left:8px}.isFluent .LeftNav-linkGroup-plusWrapper{height:36px;width:36px;background:0 0}.LeftNav-linkGroup-plusWrapper:hover{background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent .LeftNav-linkGroup-plusWrapper:hover{background:0 0}.LeftNav-linkGroup-plusWrapper:active{-ms-transform:scale(.95);transform:scale(.95)}.LeftNav-linkGroup-plus{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";width:14px;height:14px;margin:auto;position:absolute;top:0;bottom:0;right:0;left:0}.isFluent .LeftNav-linkGroup-plus:hover{color:#004578}.LeftNav-sublinks-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .LeftNav-sublinks-icon{margin-right:10px}[dir=rtl] .LeftNav-sublinks-icon{margin-left:10px}.isFluent .LeftNav-sublinks-icon{font-size:16px;color:#605e5c;vertical-align:top}[dir=ltr] .isFluent .LeftNav-sublinks-icon{margin-right:16px}[dir=rtl] .isFluent .LeftNav-sublinks-icon{margin-left:16px}.LeftNav-sublinks-portrait.has-iconOverlayImage{background-color:transparent}.LeftNav-sublinks-portrait{overflow:hidden;width:28px;height:28px;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;font-size:28px;margin-top:2px;position:relative;display:inline-block}[dir=ltr] .LeftNav-sublinks-portrait{margin-right:8px}[dir=rtl] .LeftNav-sublinks-portrait{margin-left:8px}.lg .LeftNav-sublinks-portrait,.md .LeftNav-sublinks-portrait,.sm .LeftNav-sublinks-portrait{height:28px;width:28px;margin-top:6px}.LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:24px;display:inline-block;margin-top:7px;vertical-align:top;width:39px}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-6px}.lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,.md .LeftNav-sublinks-portrait.ms-Icon--Group:before,.sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:28px;margin-top:8px;vertical-align:top;width:46px}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-7px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-7px}.LeftNav-sublinks-portrait img{max-width:28px;max-height:28px;position:absolute;top:0}[dir=ltr] .LeftNav-sublinks-portrait img{left:0}[dir=rtl] .LeftNav-sublinks-portrait img{right:0}.lg .LeftNav-sublinks-portrait img,.md .LeftNav-sublinks-portrait img,.sm .LeftNav-sublinks-portrait img{width:28px;height:28px}.od-LeftNav-sublink-siteIcon{position:relative;display:inline-block;margin-top:2px;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-LeftNav-sublink-siteIcon{margin-right:4px}[dir=rtl] .od-LeftNav-sublink-siteIcon{margin-left:4px}.isFluent .od-LeftNav-sublink-siteIcon{width:24px;height:24px;margin-top:6px}.lg .od-LeftNav-sublink-siteIcon,.md .od-LeftNav-sublink-siteIcon,.sm .od-LeftNav-sublink-siteIcon{margin-top:4px;width:28px;height:28px}.od-Browser--edge .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:36px}.isFluent .od-Browser--edge .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:40px}.lg.od-Browser--edge .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:42px}.lg.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:43px}.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:32px}.isFluent .od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:40px}.LeftNav-notificationLink,.LeftNav-subLinkWarningText{position:relative;display:block;margin:0;padding:8px 20px;height:auto;font-size:12px;font-weight:400;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";line-height:14px;font-size:12px}.isFluent .LeftNav-notificationLink,.isFluent .LeftNav-subLinkWarningText{font-size:14px}.LeftNav-notificationLink.LeftNav-is-active,.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:#fed9cc}.LeftNav-Button{display:block;height:auto;padding:4px 2px 6px;margin:8px 20px;width:calc(100% - 40px)}.LeftNav-Button.od-Button+.od-Button{margin:4px 20px}.LeftNav-subLinkWarningText{color:#e81123;font-weight:700}.LeftNav-basicLink{display:block;margin:0;padding:8px 16px;position:relative;height:auto;font-size:12px}.isFluent .LeftNav-basicLink{font-size:14px}html[dir=ltr] .isFluent .LeftNav-basicLink{padding-left:48px}html[dir=rtl] .isFluent .LeftNav-basicLink{padding-right:48px}.LeftNav-bubbleAnchor{position:absolute;top:0;bottom:0}[dir=ltr] .LeftNav-bubbleAnchor{right:0}[dir=rtl] .LeftNav-bubbleAnchor{left:0}.LeftNav-teamifyBanner{box-sizing:border-box;padding:20px}"}])});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink",["require","exports","./LeftNavSublinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./templates/LeftNavTemplates","../../../bindings/component/ControlBinding","./LeftNavSublink.html","../LeftNav.css","../../loadingSpinner/LoadingSpinner","../../siteIcon/SiteIcon"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav-sublink",name:e("module").id,template:e("./LeftNavSublink.html"),viewModelType:r.default});i.registerTemplate(o.LINK_TEMPLATE,e("./templates/Link.html"));i.registerTemplate(o.INDENTED_TEMPLATE,e("./templates/IndentedLink.html"));i.registerTemplate(o.LOAD_TEMPLATE,e("./templates/Load.html"));i.registerTemplate(o.TEXT_TEMPLATE,e("./templates/Text.html"));i.registerTemplate(o.WARNING_TEXT_TEMPLATE,e("./templates/WarningText.html"));i.registerTemplate(o.GROUPLINK_TEMPLATE,e("./templates/GroupLink.html"));i.registerTemplate(o.MORE_TEMPLATE,e("./templates/More.html"));i.registerTemplate(o.NOTIFICATION_TEMPLATE,e("./templates/NotificationLink.html"));i.registerTemplate(o.BASIC_LINK_TEMPLATE,e("./templates/BasicLink.html"));i.registerTemplate(o.COMPONENT_TEMPLATE,e("./templates/Component.html"));t.default=t.resourceKey});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","../LeftNav.resx","./templates/LeftNavTemplates","../../../bindings/teachingBubble/TeachingBubbleBinding","../../loadingSpinner/LoadingSpinner","../../../providers/teachingBubble/TeachingBubbleProvider","../../../utilities/features/Features"],function(e,t,r,i,o,n,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this;r.loadingSpinnerTagName=c.default.tagName;r.addBindingHandlers({teachingBubble:l.default});var i=e.linkGroup,o=e.isLeftNavVisible,n=void 0===o?r.createObservable(!0):o;r._engagement=t.engagement;r._teachingBubbleProvider=t.teachingBubbleProvider;r.leftNavItems=i;r.isLeftNavVisible=n;r.isFluentFlight=p.isFeatureEnabled(p.EnableFluentStyling);r._linksTruncatedWithMore=r.createObservable(!1);void 0!==r.leftNavItems.hideLinksAfterFoldAfter&&r._linksTruncatedWithMore(!0);r.leftNavRenderedItems=r.createPureComputed(r._computeLeftNavRenderedItems);r.shouldMoreBeRendered=r.createPureComputed(function(){return r._linksTruncatedWithMore()&&r.leftNavItems.hideLinksAfterFoldAfter<r.leftNavItems.links().length});r.addDisposable(r.leftNavItems.links.filter(function(e){return!!e.action&&e.action.isAvailable()}));return r}e.prototype.onClick=function(e,t){e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:{action:n.capitalizeFirstLetter(t.type)}});if(e.teachingBubble&&this._teachingBubbleProvider){var r=this._teachingBubbleProvider.currentBubble.peek();if(r&&r.campaign&&e.teachingBubble.campaignGuid===r.campaign.campaignGuid){this._teachingBubbleProvider.clearCurrentBubble();this._teachingBubbleProvider.markBubbleAsDismissed(e.teachingBubble)}}e.isFocused(!1);if(e.action){e.action.isAvailable.peek()&&e.action.execute(t);return!1}return!0};e.prototype.toggleMore=function(){this._linksTruncatedWithMore(!1)};e.prototype.renderMode=function(e){var t=e.renderAs;switch(void 0===t?0:t){case 1:return u.TEXT_TEMPLATE;case 2:return u.WARNING_TEXT_TEMPLATE;case 3:return u.LOAD_TEMPLATE;case 4:return u.GROUPLINK_TEMPLATE;case 5:return u.MORE_TEMPLATE;case 6:return u.NOTIFICATION_TEMPLATE;case 7:return u.INDENTED_TEMPLATE;case 8:return u.BASIC_LINK_TEMPLATE;case 9:return u.BUTTON_TEMPLATE;case 10:return u.COMPONENT_TEMPLATE;default:case 0:return u.LINK_TEMPLATE}};e.prototype._computeLeftNavRenderedItems=function(){var e=this.leftNavItems.hideLinksAfterFoldAfter;if(this._linksTruncatedWithMore()&&void 0!==e&&e<this.leftNavItems.links().length){var t=this.leftNavItems.links().slice(0,this.leftNavItems.hideLinksAfterFoldAfter);t.push({text:s.strings.moreLabel,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:5});return t}return this.leftNavItems.links()};e.dependencies=r.__assign({},i.default.dependencies,{teachingBubbleProvider:d.resourceKey.optional,engagement:o.resourceKey});return e}(i.default);t.default=a});define("odsp-next/bindings/teachingBubble/TeachingBubbleBinding",["require","exports","tslib","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../resources/ControlResourceKeys"],function(e,t,r,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this,r=t.resources.consume(o.teachingBubble.optional);if(!r)return t;t.teachingBubbleProvider=r;t._value=t.valueAccessor();t._isFirstRunExperienceVisible=t.resources.consume(n.isFirstRunExperienceVisible.optional);t.createBackgroundComputed(t._computeAddTeachingBubble);return t}e.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign),r=this.wrapObservable(e.isVisible);if((!this._isFirstRunExperienceVisible||!this._isFirstRunExperienceVisible())&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.peek()&&this.teachingBubbleProvider.currentBubble.peek().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,isVisible:r,element:this.element})}}};return e}(i.default);t.default=a});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.html",[],function(){return"<div class=LeftNav-subLinksClip><div class=LeftNav-subLinks data-bind=\"style: { marginTop: 0 }, template: { name: renderMode, foreach: leftNavRenderedItems, as: 'linkItem' }\"></div></div>"});