define("odsp-next/bundles/ReactControls",["require","exports","module"],function(e,t,i){});define("odsp-next/controls/list/react/detailsList/ReactDetailsList",["require","exports","tslib","react","office-ui-fabric-react/lib/Fabric","office-ui-fabric-react/lib/utilities/selection/index","office-ui-fabric-react/lib/MarqueeSelection","office-ui-fabric-react/lib/components/GroupedList/GroupedList.types","office-ui-fabric-react/lib/components/DetailsList/DetailsList","office-ui-fabric-react/lib/components/DetailsList/DetailsList.types","office-ui-fabric-react/lib/Utilities","./ItemDetailsRow","../ReactBaseList","./ReactDetailsList.resx","./fields/FieldMap","./fields/CustomFormatterRenderer","./fields/LocationRenderer","./fields/SignoffFlowStatusRenderer","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","../../../../models/item/ItemType","../SelectionManager","../../../../resources/ControlResourceKeys","../../../../resources/SPOResourceKeys","../../../../resources/ProviderResourceKeys","../../../../models/store/ItemsStore","../../../../providers/teachingBubble/TeachingBubbleHelper.key","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/guid/Guid","../../../../utilities/killSwitch/KillSwitch","../../../../utilities/features/Features","../../../../actions/flow/utilities/FlowOutOfBoxTemplates","./ReactDetailsList.css"],function(C,e,x,w,S,k,R,D,T,I,F,l,t,P,r,d,n,s,B,c,i,L,u,M,a,p,m,h,E,A,N,f,g,b,_){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var y=b.isFeatureEnabled(b.SuiteNavPerfListThreshold)?30:60,v=b.isFeatureEnabled(b.CustomFormatter),H=b.isFeatureEnabled(b.ApprovalFlows),O=b.isFeatureEnabled(b.CustomRowRenderer),V=b.isFeatureEnabled(b.FilesThatNeedAttentionListView),o=function(o){x.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._viewFormatter={};t.state={items:[],groups:null,columns:[],setKey:null,teachingBubbleProps:null};t._itemsToUpdate=[];t._getKey=t.resources.consume(i.getKeyResourceKey);t._keyToSubscriptionHash={};t._itemsStore=t.resources.consume(a.resourceKey);t._canShowTeachingBubble=t.observables.create(!1);t.resources.consumeAsync(p.resourceKey).done(function(e){t.observables.backgroundCompute(function(){t._canShowTeachingBubble(e.canShowTeachingBubbles());t.async.setTimeout(t._computeEmptyListTeachingBubbleVisibility,500)})});t.enableResponsiveFilesList()&&t.observables.compute(t.computeColumnsOnWindowResize).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});t._forceUpdate=t.async.debounce(function(){t.setState(function(e){return{items:e.items.slice()}})},10,{leading:!1}).bind(t);E.default.mark("EUPL.ReactDetailsList.constructor");return t}e.prototype.render=function(){var t=this;E.default.mark("EUPL.ReactDetailsList.render");var e=this.props,i=e.isCompact,o=e.isFixedLayout,r=e.tooltip,n=e.initialFocusedIndex,s=this.state,a=s.items,l=s.groups,d=s.columns,c=s.setKey,u=s.isAllCollapsed,p=s.selectionMode,m=s.teachingBubbleProps,h={getGroupItemLimit:this.getGroupItemLimit,isAllGroupsCollapsed:u,onToggleCollapseAll:this.onToggleCollapseAll,headerProps:{isGroupLoading:this.isGroupLoading,loadingText:P.strings.LoadingText,onGroupHeaderClick:this.onShowAll,onToggleCollapse:this.onToggleCollapse,isCollapsedGroupSelectVisible:!1},showAllProps:{onToggleSummarize:this.onShowAll,showAllLinkText:P.strings.ShowAll},onRenderHeader:this.onRenderGroupHeader,onRenderFooter:this.onRenderGroupFooter},f=this.props.itemSet,g=this.isInNewRecentView(f.peek());g&&(h.collapseAllVisibility=D.CollapseAllVisibility.hidden);var b={load:function(e){return N.loadModuleExport({path:"office-ui-fabric-react/lib/TeachingBubble",getModule:function(){return new A.default(function(e,t){C(["office-ui-fabric-react/lib/TeachingBubble"],e,t)})},getExport:function(e){return e.TeachingBubble}})},parse:void 0},_=this.resources.consume(M.bundleLoader.optional),y=m?{modulePath:"office-ui-fabric-react/lib/TeachingBubble",moduleLoader:b,customWaiter:_&&_.waitForPLT(),props:m}:null;this.resources.consume(L.isItemSetRendered)(!0);this._viewFormatter=void 0;var v=g?"od-DetailsRow-cell--VerticallyCenter":"";return w.createElement(R.MarqueeSelection,{isEnabled:p===k.SelectionMode.multiple,selection:this.selection,onShouldStartSelection:this._onShouldStartMarquee},w.createElement(S.Fabric,{className:F.css("od-DetailsList")},w.createElement(T.DetailsList,{componentRef:function(e){return t._list=e},selectionZoneProps:{selection:this.selection,selectionMode:p,disableAutoSelectOnInputElements:!0},selection:this.selection,setKey:c,items:a,initialFocusedIndex:n||0,groups:l,groupProps:h,columns:d,layoutMode:o?I.DetailsListLayoutMode.fixedColumns:I.DetailsListLayoutMode.justified,constrainMode:I.ConstrainMode.unconstrained,onColumnResize:this.async.debounce(this.onColumnResize,200),onRenderRow:this._onRenderRow,onRenderMissingItem:this.onRenderMissingItem,onRowDidMount:this._onRowDidMount,onRowWillUnmount:this._onRowWillUnmount,onItemInvoked:this.onItemInvoked,rowElementEventMap:this.rowElementEventMap,dragDropEvents:this._dragDropEvents,getKey:this._getKey,ariaLabelForListHeader:P.strings.columnsHeaderAriaLabel,ariaLabelForSelectionColumn:P.strings.selectionColumnHeaderAriaLabel,ariaLabelForSelectAllCheckbox:P.strings.toggleSelectAllAriaLabel,isHeaderVisible:this._isHeaderVisible(!!o),checkboxVisibility:p===k.SelectionMode.none?I.CheckboxVisibility.hidden:this._isMobileView?I.CheckboxVisibility.always:I.CheckboxVisibility.onHover,checkboxCellClassName:v,onActiveItemChanged:this.onActiveItemChanged,getRowAriaLabel:this.getAriaLabel,ariaLabel:r,compact:i,usePageCache:!0,onShouldVirtualize:function(e){return!t._isGroupedList()&&t._onShouldVirtualize(e)},skipViewportMeasures:o,enterModalSelectionOnTouch:!0,columnReorderOptions:this._getColumnReorderOptions(),minimumPixelsForDrag:1}),y&&w.createElement(B.ReactDeferredComponent,x.__assign({},y),P.strings.addColumnTeachingBubble)))};e.prototype.onRenderGroupHeader=function(e,t){var i=this.props.itemSet;return this.isInNewRecentView(i.peek())?w.createElement("div",{className:"od-DetailsList-groupHeader"},e.group.name):o.prototype.onRenderGroupHeader.call(this,e,t)};e.prototype.getFieldRendererKey=function(e){var t=e.clientSideComponentId&&e.clientSideComponentId!==f.default.Empty.toString()&&e.clientSideColumnAdapter&&e.clientSideColumnAdapter.fieldCustomizerLoaded,i=this.resources.consume(L.viewParams).peek(),o=this.resources.consume(r.resourceKey);return e.fieldRendererKey?e.fieldRendererKey:i.needsAttentionView&&"FileDirRef"===e.internalName?n.resourceKey:v&&e.customFormatter&&"{}"!==e.customFormatter?d.resourceKey:e.customFields?o.Custom:t?o.ClientSideCustom:H&&_.outOfBoxSignoffTemplate.data.columnStaticName===e.staticName?s.resourceKey:o[m.ColumnFieldType[e.fieldType]||"Text"]};e.prototype._onShouldVirtualize=function(e){return!e||!e.items||e.items.length>y};e.prototype._isGroupedList=function(){var e=this.state.groups;return e&&0<e.length};e.prototype._onShouldStartMarquee=function(e){for(var t=e.target;t&&t!==document.body;){if(null!==t.getAttribute("data-selection-index"))return!1;t=t.parentElement}return!0};e.prototype._onItemUpdated=function(e){var t=e.item,i=e.index;this._itemsToUpdate.push({newItem:t,previousIndex:i});this._queueUpdateItems()};e.prototype._queueUpdateItems=function(){var e=this;this._updateItemsTimeoutId||(this._updateItemsTimeoutId=this.async.setTimeout(function(){e._updateItems()},100))};e.prototype._updateItems=function(){var e=this.state.items;this._updateItemsTimeoutId=void 0;for(var t=!1,i=0,o=this._itemsToUpdate.splice(0,1/0);i<o.length;i++){var r=o[i],n=r.newItem,s=r.previousIndex,a=-1;if(e[s]&&n.key===e[s].key)a=s;else for(var l=0;l<e.length;l++)if(e[l].key===n.key){a=l;break}if(0<=a&&n!==e[a]){e[a]=n;t=!0}}t&&this._list.forceUpdate()};e.prototype._onRowDidMount=function(e,t){var i=this;if(!b.isFeatureEnabled(b.SubscribeToItemPerRowInDetailsList)){var o=this.state.items,r=e?e.key:o[t].key;this._keyToSubscriptionHash[r]=this.observables.subscribe(this._itemsStore.getItem(r),function(e){i._itemsToUpdate.push({previousIndex:t,newItem:e});i._queueUpdateItems()})}};e.prototype._onRowWillUnmount=function(e,t){if(!b.isFeatureEnabled(b.SubscribeToItemPerRowInDetailsList)){var i=this.state.items,o=e?e.key:i[t].key,r=this._keyToSubscriptionHash[o];if(r){r.dispose();delete this._keyToSubscriptionHash[o]}}};e.prototype._onTeachingBubbleDismiss=function(){this.setState({teachingBubbleProps:null})};e.prototype._dismissTeachingBubbleEvents=function(){if(this._addColumnButtonElement&&this.state.teachingBubbleProps){this.events.on(this._addColumnButtonElement,"click",this._onTeachingBubbleDismiss);this.events.on(window,"resize",this._onTeachingBubbleDismiss,!0);this.events.on(window,"scroll",this._onTeachingBubbleDismiss,!0)}};e.prototype._computeEmptyListTeachingBubbleVisibility=function(){if(this.observables.peekUnwrap(this._canShowTeachingBubble)){var e,t=this.state,i=t.items,o=t.columns,r=this.props.itemSet().item().isRootFolder;2===o.length&&"Title"===o[0].key&&"__newColumnHeaderCommand"===o[1].key&&(e=!0);this._addColumnButtonElement=document.querySelector("div[data-item-key='__newColumnHeaderCommand']");if(this._addColumnButtonElement&&r&&0===i.length&&e){var n={calloutProps:{directionalHint:5},targetElement:this._addColumnButtonElement,onDismiss:this._onTeachingBubbleDismiss,hasCloseIcon:!0};this.setState({teachingBubbleProps:n})}this._dismissTeachingBubbleEvents()}};e.prototype._customFormatRenderWithSelection=function(e){var t=this._getCustomRowFormatter();return d.customFormatterRowRenderer(e.item,t,this.props.itemSet.peek(),this.resources)};e.prototype._onRenderRow=function(e,t){this._initViewFormatter();var i=this._viewFormatter&&this._viewFormatter.rowFormatter||null,o=this._viewFormatter&&this._viewFormatter.additionalRowClass||null;if(i&&this._viewFormatter.hideSelection)return d.customFormatterRowRenderer(e.item,i,this.props.itemSet.peek(),this.resources);var r=this.state.enableDeferredBehaviors;i&&!this._viewFormatter.hideSelection&&(e.rowFieldsAs=this._customFormatRenderWithSelection);var n=this.resources.consume(u.pageContext.optional),s=n&&Number(n.webTemplate)===h.default.mySite,a=V&&e.item.hasMissingMetadata&&e.item.type!==c.default.Folder&&!s;return w.createElement("div",{className:F.css({"od-DetailsRow-needsAttention":a})},w.createElement(l.ItemDetailsRow,{defaultClickActionManager:this._defaultClickActionManager,enableDeferredBehaviors:r,forceUpdate:this._forceUpdate,customFormatterClassExpression:o,isGroupedList:this._isGroupedList,itemSet:this.props.itemSet,onItemInvoked:this.onItemInvoked,onRender:t,resources:this.resources,rowProps:e,selection:this.selection,onItemUpdated:this._onItemUpdated}))};e.prototype._initViewFormatter=function(){var e=null,t=null;if(void 0===this._viewFormatter){if(this._isCustomRowRendererOn()){var i=void 0;try{this.props.itemSet.peek().customViewRenderer&&(i=(i=this.props.itemSet.peek().customViewRenderer.peek())&&i.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));i&&(t=JSON.parse(i))&&t.rowFormatter&&(e=JSON.stringify(t.rowFormatter))}catch(e){console.error("Failed to render custom view.")}}(this._viewFormatter=t)&&e&&(this._viewFormatter.rowFormatter=e)}};e.prototype._getCustomRowFormatter=function(){this._initViewFormatter();var e=this._viewFormatter;return e?e.rowFormatter:null};e.prototype._shouldHideHeader=function(){this._initViewFormatter();var e=this._viewFormatter;return!!e&&(e.hideListHeader||e.hideColumnHeader)};e.prototype._isHeaderVisible=function(e){var t=g.default.isActivated("421C26E6-CF38-4A60-90A7-760626CCDC28","10/20/2017","Selection updates for mobile details list.")||!this._isMobileView||!!e;this._shouldHideHeader()&&(t=!1);return t};e.prototype._isCustomRowRendererOn=function(){return O&&v};x.__decorate([F.autobind],e.prototype,"onRenderGroupHeader",null);x.__decorate([F.autobind],e.prototype,"_isGroupedList",null);x.__decorate([F.autobind],e.prototype,"_onShouldStartMarquee",null);x.__decorate([F.autobind],e.prototype,"_onItemUpdated",null);x.__decorate([F.autobind],e.prototype,"_onRowDidMount",null);x.__decorate([F.autobind],e.prototype,"_onRowWillUnmount",null);x.__decorate([F.autobind],e.prototype,"_onTeachingBubbleDismiss",null);x.__decorate([F.autobind],e.prototype,"_customFormatRenderWithSelection",null);x.__decorate([F.autobind],e.prototype,"_onRenderRow",null);return e}(t.default);e.ReactDetailsList=o;e.default=o});define("office-ui-fabric-react/lib/MarqueeSelection",["require","exports","tslib","./components/MarqueeSelection/MarqueeSelection","./utilities/selection/index"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection",["require","exports","../../Utilities","./MarqueeSelection.base","./MarqueeSelection.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MarqueeSelection=i.styled(o.MarqueeSelectionBase,r.getStyles,void 0,{scope:"MarqueeSelection"})});define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection.base",["require","exports","tslib","react","../../Utilities"],function(e,t,l,d,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.classNamesFunction(),i=function(t){l.__extends(e,t);function e(e){var r=t.call(this,e)||this;r._root=s.createRef();r._onMouseDown=function(e){var t=r.props,i=t.isEnabled,o=t.onShouldStartSelection;if(!r._isMouseEventOnScrollbar(e)&&!r._isInSelectionToggle(e)&&!r._isTouch&&i&&!r._isDragStartInSelection(e)&&(!o||o(e))&&r._scrollableSurface&&0===e.button&&r._root.current){r._selectedIndicies={};r._preservedIndicies=void 0;r._events.on(window,"mousemove",r._onAsyncMouseMove);r._events.on(r._scrollableParent,"scroll",r._onAsyncMouseMove);r._events.on(window,"click",r._onMouseUp,!0);r._autoScroll=new s.AutoScroll(r._root.current);r._scrollTop=r._scrollableSurface.scrollTop;r._rootRect=r._root.current.getBoundingClientRect();r._onMouseMove(e)}};r._onTouchStart=function(e){r._isTouch=!0;r._async.setTimeout(function(){r._isTouch=!1},0)};r._onPointerDown=function(e){if("touch"===e.pointerType){r._isTouch=!0;r._async.setTimeout(function(){r._isTouch=!1},0)}};r.state={dragRect:void 0};return r}e.prototype.componentDidMount=function(){this._scrollableParent=s.findScrollableParent(this._root.current);this._scrollableSurface=this._scrollableParent===window?document.body:this._scrollableParent;var e=this.props.isDraggingConstrainedToRoot?this._root.current:this._scrollableSurface;this._events.on(e,"mousedown",this._onMouseDown);this._events.on(e,"touchstart",this._onTouchStart,!0);this._events.on(e,"pointerdown",this._onPointerDown,!0)};e.prototype.componentWillUnmount=function(){this._autoScroll&&this._autoScroll.dispose()};e.prototype.render=function(){var e=this.props,t=e.rootProps,i=e.children,o=e.theme,r=e.className,n=e.styles,s=this.state.dragRect,a=c(n,{theme:o,className:r});return d.createElement("div",l.__assign({},t,{className:a.root,ref:this._root}),i,s&&d.createElement("div",{className:a.dragMask}),s&&d.createElement("div",{className:a.box,style:s},d.createElement("div",{className:a.boxFill})))};e.prototype._isMouseEventOnScrollbar=function(e){var t=e.target,i=t.offsetWidth-t.clientWidth;if(i){var o=t.getBoundingClientRect();if(s.getRTL()){if(e.clientX<o.left+i)return!0}else if(e.clientX>o.left+t.clientWidth)return!0;if(e.clientY>o.top+t.clientHeight)return!0}return!1};e.prototype._getRootRect=function(){return{left:this._rootRect.left,top:this._rootRect.top+(this._scrollTop-this._scrollableSurface.scrollTop),width:this._rootRect.width,height:this._rootRect.height}};e.prototype._onAsyncMouseMove=function(e){var t=this;this._async.requestAnimationFrame(function(){t._onMouseMove(e)});e.stopPropagation();e.preventDefault()};e.prototype._onMouseMove=function(e){if(this._autoScroll){void 0!==e.clientX&&(this._lastMouseEvent=e);var t=this._getRootRect(),i={x:e.clientX-t.left,y:e.clientY-t.top};this._dragOrigin||(this._dragOrigin=i);if(void 0!==e.buttons&&0===e.buttons)this._onMouseUp(e);else if(this.state.dragRect||5<s.getDistanceBetweenPoints(this._dragOrigin,i)){if(!this.state.dragRect){var o=this.props.selection;this._preservedIndicies=o&&o.getSelectedIndices&&o.getSelectedIndices()}var r=this.props.isDraggingConstrainedToRoot?{x:Math.max(0,Math.min(t.width,this._lastMouseEvent.clientX-t.left)),y:Math.max(0,Math.min(t.height,this._lastMouseEvent.clientY-t.top))}:{x:this._lastMouseEvent.clientX-t.left,y:this._lastMouseEvent.clientY-t.top},n={left:Math.min(this._dragOrigin.x,r.x),top:Math.min(this._dragOrigin.y,r.y),width:Math.abs(r.x-this._dragOrigin.x),height:Math.abs(r.y-this._dragOrigin.y)};this._evaluateSelection(n,t);this.setState({dragRect:n})}return!1}};e.prototype._onMouseUp=function(e){this._events.off(window);this._events.off(this._scrollableParent,"scroll");this._autoScroll&&this._autoScroll.dispose();this._autoScroll=this._dragOrigin=this._lastMouseEvent=this._selectedIndicies=this._itemRectCache=void 0;if(this.state.dragRect){this.setState({dragRect:void 0});e.preventDefault();e.stopPropagation()}};e.prototype._isPointInRectangle=function(e,t){return e.top<t.y&&e.bottom>t.y&&e.left<t.x&&e.right>t.x};e.prototype._isDragStartInSelection=function(e){var t=this.props.selection;if(!this._root.current||t&&0===t.getSelectedCount())return!1;for(var i=this._root.current.querySelectorAll("[data-selection-index]"),o=0;o<i.length;o++){var r=i[o],n=Number(r.getAttribute("data-selection-index"));if(t.isIndexSelected(n)){var s=r.getBoundingClientRect();if(this._isPointInRectangle(s,{x:e.x,y:e.y}))return!0}}return!1};e.prototype._isInSelectionToggle=function(e){for(var t=e.target;t&&t!==this._root.current;){if("true"===t.getAttribute("data-selection-toggle"))return!0;t=t.parentElement}return!1};e.prototype._evaluateSelection=function(e,t){if(e&&this._root.current){var i=this.props.selection,o=this._root.current.querySelectorAll("[data-selection-index]");this._itemRectCache||(this._itemRectCache={});i.setChangeEvents(!1);i.setAllSelected(!1);for(var r=0;r<o.length;r++){var n=o[r],s=n.getAttribute("data-selection-index"),a=this._itemRectCache[s];a||0<(a={left:(a=n.getBoundingClientRect()).left-t.left,top:a.top-t.top,width:a.width,height:a.height,right:a.left-t.left+a.width,bottom:a.top-t.top+a.height}).width&&0<a.height&&(this._itemRectCache[s]=a);a.top<e.top+e.height&&a.bottom>e.top&&a.left<e.left+e.width&&a.right>e.left?this._selectedIndicies[s]=!0:delete this._selectedIndicies[s]}for(var s in this._selectedIndicies)this._selectedIndicies.hasOwnProperty(s)&&i.setIndexSelected(Number(s),!0,!1);if(this._preservedIndicies)for(var l=0,d=this._preservedIndicies;l<d.length;l++){s=d[l];i.setIndexSelected(s,!0,!1)}i.setChangeEvents(!0)}};e.defaultProps={rootTagName:"div",rootProps:{},isEnabled:!0};return e}(s.BaseComponent);t.MarqueeSelectionBase=i});define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection.styles",["require","exports","../../Styling"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i,o,r=e.theme,n=e.className,s=r.palette;return{root:[n,{position:"relative",cursor:"default"}],dragMask:[{position:"absolute",background:"rgba(255, 0, 0, 0)",left:0,top:0,right:0,bottom:0,selectors:(t={},t[a.HighContrastSelector]={background:"none",backgroundColor:"transparent"},t)}],box:[{position:"absolute",boxSizing:"border-box",border:"1px solid "+s.themePrimary,pointerEvents:"none",zIndex:10,selectors:(i={},i[a.HighContrastSelector]={borderColor:"Highlight"},i)}],boxFill:[{position:"absolute",boxSizing:"border-box",backgroundColor:s.themePrimary,opacity:.1,left:0,top:0,right:0,bottom:0,selectors:(o={},o[a.HighContrastSelector]={background:"none",backgroundColor:"transparent"},o)}]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList",["require","exports","tslib","../../Utilities","./DetailsList.base","./DetailsList.styles","./DetailsList.base"],function(e,t,i,o,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsList=o.styled(r.DetailsListBase,n.getStyles,void 0,{scope:"DetailsList"});i.__exportStar(s,t)});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.base",["require","exports","tslib","react","../../Utilities","../DetailsList/DetailsList.types","../DetailsList/DetailsHeader","../DetailsList/DetailsHeader.types","../DetailsList/DetailsRow","../../FocusZone","../../utilities/selection/index","../../utilities/dragdrop/DragDropHelper","../../GroupedList","../../List","../../utilities/decorators/withViewport","../../utilities/groupedList/GroupedListUtility","./DetailsRow.styles"],function(e,t,ie,oe,s,re,i,ne,r,se,ae,n,le,de,o,ce,ue){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var pe=s.classNamesFunction(),me=new Array(10),a=function(t){ie.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._root=s.createRef();o._header=s.createRef();o._groupedList=s.createRef();o._list=s.createRef();o._focusZone=s.createRef();o._selectionZone=s.createRef();o._onRenderRow=function(e,t){return oe.createElement(r.DetailsRow,ie.__assign({},e))};o._onRenderDetailsHeader=function(e,t){return oe.createElement(i.DetailsHeader,ie.__assign({},e))};o._onRenderDetailsFooter=function(e,t){return null};o._onRenderListCell=function(i){return function(e,t){return o._onRenderCell(i,e,t)}};o._onScroll=function(e){var t=o.props.onScroll;t&&t(e)};o._activeRows={};o._columnOverrides={};o._onColumnIsSizingChanged=o._onColumnIsSizingChanged.bind(o);o._onColumnResized=o._onColumnResized.bind(o);o._onColumnAutoResized=o._onColumnAutoResized.bind(o);o._onRowDidMount=o._onRowDidMount.bind(o);o._onRowWillUnmount=o._onRowWillUnmount.bind(o);o._onToggleCollapse=o._onToggleCollapse.bind(o);o._onActiveRowChanged=o._onActiveRowChanged.bind(o);o._onBlur=o._onBlur.bind(o);o._onHeaderKeyDown=o._onHeaderKeyDown.bind(o);o._onContentKeyDown=o._onContentKeyDown.bind(o);o._onRenderCell=o._onRenderCell.bind(o);o._onGroupExpandStateChanged=o._onGroupExpandStateChanged.bind(o);o._onColumnDragEnd=o._onColumnDragEnd.bind(o);o.state={focusedItemIndex:-1,lastWidth:0,adjustedColumns:o._getAdjustedColumns(e),isSizing:!1,isDropping:!1,isCollapsed:e.groupProps&&e.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:e.groupProps&&!e.groupProps.isAllGroupsCollapsed};o._selection=e.selection||new ae.Selection({onSelectionChanged:void 0,getKey:e.getKey});o._selection.setItems(e.items,!1);o._dragDropHelper=e.dragDropEvents?new n.DragDropHelper({selection:o._selection,minimumPixelsForDrag:e.minimumPixelsForDrag}):null;o._initialFocusedIndex=e.initialFocusedIndex;return o}e.prototype.scrollToIndex=function(e,t,i){this._list.current&&this._list.current.scrollToIndex(e,t,i);this._groupedList.current&&this._groupedList.current.scrollToIndex(e,t,i)};e.prototype.focusIndex=function(e,t,i,o){void 0===t&&(t=!1);var r=this.props.items[e];if(r){this.scrollToIndex(e,i,o);var n=this._getItemKey(r,e),s=this._activeRows[n];s&&this._setFocusToRow(s,t)}};e.prototype.getStartItemIndexInView=function(){return this._list&&this._list.current?this._list.current.getStartItemIndexInView():this._groupedList&&this._groupedList.current?this._groupedList.current.getStartItemIndexInView():0};e.prototype.componentWillUnmount=function(){this.props.onScroll&&this._root.current&&this._root.current.removeEventListener("scroll",this._onScroll);this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.componentDidMount=function(){this.props.onScroll&&this._root.current&&this._root.current.addEventListener("scroll",this._onScroll)};e.prototype.componentDidUpdate=function(e,t){if(void 0!==this._initialFocusedIndex){if(n=this.props.items[this._initialFocusedIndex]){var i=this._getItemKey(n,this._initialFocusedIndex);(o=this._activeRows[i])&&this._setFocusToRowIfPending(o)}}if(this.props.items!==e.items&&0<this.props.items.length&&-1!==this.state.focusedItemIndex&&!s.elementContains(this._root.current,document.activeElement,!1)){var o,r=this.state.focusedItemIndex<this.props.items.length?this.state.focusedItemIndex:this.props.items.length-1,n=this.props.items[r];i=this._getItemKey(n,this.state.focusedItemIndex);(o=this._activeRows[i])?this._setFocusToRow(o):this._initialFocusedIndex=r}this.props.onDidUpdate&&this.props.onDidUpdate(this)};e.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.checkboxVisibility,o=t.items,r=t.setKey,n=t.selectionMode,s=t.columns,a=t.viewport,l=t.compact,d=e.setKey!==r||void 0===e.setKey,c=!1;e.layoutMode!==this.props.layoutMode&&(c=!0);if(d){this._initialFocusedIndex=e.initialFocusedIndex;this.setState({focusedItemIndex:void 0!==this._initialFocusedIndex?this._initialFocusedIndex:-1})}e.items!==o&&this._selection.setItems(e.items,d);e.checkboxVisibility===i&&e.columns===s&&e.viewport.width===a.width&&e.compact===l||(c=!0);this._adjustColumns(e,!0);e.selectionMode!==n&&(c=!0);c&&(this._pendingForceUpdate=!0)};e.prototype.componentWillUpdate=function(){this._pendingForceUpdate&&this._forceListUpdates()};e.prototype.render=function(){var e=this.props,t=e.ariaLabelForListHeader,i=e.ariaLabelForSelectAllCheckbox,o=e.ariaLabelForSelectionColumn,r=e.className,n=e.checkboxVisibility,s=e.compact,a=e.constrainMode,l=e.dragDropEvents,d=e.groups,c=e.groupProps,u=e.items,p=e.isHeaderVisible,m=e.layoutMode,h=e.onItemInvoked,f=e.onItemContextMenu,g=e.onColumnHeaderClick,b=e.onColumnHeaderContextMenu,_=e.selectionMode,y=e.selectionPreservedOnEmptyClick,v=e.selectionZoneProps,C=e.ariaLabel,x=e.ariaLabelForGrid,w=e.rowElementEventMap,S=e.shouldApplyApplicationRole,k=void 0!==S&&S,R=e.getKey,D=e.listProps,T=e.usePageCache,I=e.onShouldVirtualize,F=e.enableShimmer,P=e.viewport,B=e.minimumPixelsForDrag,L=e.getGroupHeight,M=e.styles,E=e.theme,A=this.state,N=A.adjustedColumns,H=A.isCollapsed,O=A.isSizing,V=A.isSomeGroupExpanded,U=this._selection,z=this._dragDropHelper,K=this._getGroupNestingDepth(),q=ie.__assign({renderedWindowsAhead:O?0:2,renderedWindowsBehind:O?0:2,getKey:R},D),j=ne.SelectAllVisibility.none;_===ae.SelectionMode.single&&(j=ne.SelectAllVisibility.hidden);if(_===ae.SelectionMode.multiple){var W=c&&c.headerProps&&c.headerProps.isCollapsedGroupSelectVisible;void 0===W&&(W=!0);j=W||!d||V?ne.SelectAllVisibility.visible:ne.SelectAllVisibility.hidden}n===re.CheckboxVisibility.hidden&&(j=ne.SelectAllVisibility.none);var G=this.props,X=G.onRenderDetailsHeader,Z=void 0===X?this._onRenderDetailsHeader:X,J=G.onRenderDetailsFooter,Y=void 0===J?this._onRenderDetailsFooter:J,$=this._getDetailsFooterProps(),Q=this._getColumnReorderProps(),ee=(p?1:0)+ce.GetGroupCount(d)+(u?u.length:0),te=pe(M,{theme:E,compact:s,isFixed:m===re.DetailsListLayoutMode.fixedColumns,isHorizontalConstrained:a===re.ConstrainMode.horizontalConstrained,className:r});return oe.createElement("div",ie.__assign({ref:this._root,className:te.root,"data-automationid":"DetailsList","data-is-scrollable":"false","aria-label":C},k?{role:"application"}:{}),oe.createElement("div",{role:"grid","aria-label":x,"aria-rowcount":ee,"aria-colcount":(j!==ne.SelectAllVisibility.none&&j!==ne.SelectAllVisibility.hidden?1:0)+(N?N.length:0),"aria-readonly":"true"},oe.createElement("div",{onKeyDown:this._onHeaderKeyDown,role:"presentation"},p&&Z({componentRef:this._header,selectionMode:_,layoutMode:m,selection:U,columns:N,onColumnClick:g,onColumnContextMenu:b,onColumnResized:this._onColumnResized,onColumnIsSizingChanged:this._onColumnIsSizingChanged,onColumnAutoResized:this._onColumnAutoResized,groupNestingDepth:K,isAllCollapsed:H,onToggleCollapseAll:this._onToggleCollapse,ariaLabel:t,ariaLabelForSelectAllCheckbox:i,ariaLabelForSelectionColumn:o,selectAllVisibility:j,collapseAllVisibility:c&&c.collapseAllVisibility,viewport:P,columnReorderProps:Q,minimumPixelsForDrag:B,cellStyleProps:ue.DEFAULT_CELL_STYLE_PROPS},this._onRenderDetailsHeader)),oe.createElement("div",{onKeyDown:this._onContentKeyDown,role:"presentation"},oe.createElement(se.FocusZone,{componentRef:this._focusZone,className:te.focusZone,direction:se.FocusZoneDirection.vertical,isInnerZoneKeystroke:he,onActiveElementChanged:this._onActiveRowChanged,onBlur:this._onBlur},oe.createElement(ae.SelectionZone,ie.__assign({ref:this._selectionZone,selection:U,selectionPreservedOnEmptyClick:y,selectionMode:_,onItemInvoked:h,onItemContextMenu:f,enterModalOnTouch:this.props.enterModalSelectionOnTouch},v||{}),d?oe.createElement(le.GroupedList,{componentRef:this._groupedList,groups:d,groupProps:c?this._getGroupProps(c):void 0,items:u,onRenderCell:this._onRenderCell,selection:U,selectionMode:_,dragDropEvents:l,dragDropHelper:z,eventsToRegister:w,listProps:q,onGroupExpandStateChanged:this._onGroupExpandStateChanged,usePageCache:T,onShouldVirtualize:I,getGroupHeight:L}):oe.createElement(de.List,ie.__assign({ref:this._list,role:"presentation",items:F&&!u.length?me:u,onRenderCell:this._onRenderListCell(0),usePageCache:T,onShouldVirtualize:I},q))))),Y(ie.__assign({},$),this._onRenderDetailsFooter)))};e.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this);this._forceListUpdates()};e.prototype._onRenderCell=function(e,t,i){var o=this.props,r=o.compact,n=o.dragDropEvents,s=o.rowElementEventMap,a=o.onRenderMissingItem,l=o.onRenderItemColumn,d=o.onRenderRow,c=void 0===d?this._onRenderRow:d,u=o.selectionMode,p=o.viewport,m=o.checkboxVisibility,h=o.getRowAriaLabel,f=o.getRowAriaDescribedBy,g=o.checkButtonAriaLabel,b=o.checkboxCellClassName,_=o.groupProps,y=o.useReducedRowRenderer,v=o.cellStyleProps,C=void 0===v?ue.DEFAULT_CELL_STYLE_PROPS:v,x=_&&_.collapseAllVisibility,w=this._selection,S=this._dragDropHelper,k={item:t,itemIndex:i,compact:r,columns:this.state.adjustedColumns,groupNestingDepth:e,selectionMode:u,selection:w,onDidMount:this._onRowDidMount,onWillUnmount:this._onRowWillUnmount,onRenderItemColumn:l,eventsToRegister:s,dragDropEvents:n,dragDropHelper:S,viewport:p,checkboxVisibility:m,collapseAllVisibility:x,getRowAriaLabel:h,getRowAriaDescribedBy:f,checkButtonAriaLabel:g,checkboxCellClassName:b,useReducedRowRenderer:y,cellStyleProps:C};return t?c(k,this._onRenderRow):a?a(i,k):null};e.prototype._onGroupExpandStateChanged=function(e){this.setState({isSomeGroupExpanded:e})};e.prototype._onColumnIsSizingChanged=function(e,t){this.setState({isSizing:t})};e.prototype._onHeaderKeyDown=function(e){if(40===e.which&&this._focusZone.current&&this._focusZone.current.focus()){e.preventDefault();e.stopPropagation()}};e.prototype._onContentKeyDown=function(e){if(38===e.which&&!e.altKey&&this._header.current&&this._header.current.focus()){e.preventDefault();e.stopPropagation()}};e.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.props.groups;t&&0<t.length;){e++;t=t[0].children}return e};e.prototype._onRowDidMount=function(e){var t=e.props,i=t.item,o=t.itemIndex,r=this._getItemKey(i,o);this._activeRows[r]=e;this._setFocusToRowIfPending(e);var n=this.props.onRowDidMount;n&&n(i,o)};e.prototype._setFocusToRowIfPending=function(e){var t=e.props.itemIndex;if(void 0!==this._initialFocusedIndex&&t===this._initialFocusedIndex){this._setFocusToRow(e);delete this._initialFocusedIndex}};e.prototype._setFocusToRow=function(e,t){void 0===t&&(t=!1);this._selectionZone.current&&this._selectionZone.current.ignoreNextFocus();this._async.setTimeout(function(){e.focus(t)},0)};e.prototype._onRowWillUnmount=function(e){var t=this.props.onRowWillUnmount,i=e.props,o=i.item,r=i.itemIndex,n=this._getItemKey(o,r);delete this._activeRows[n];t&&t(o,r)};e.prototype._onToggleCollapse=function(e){this.setState({isCollapsed:e});this._groupedList.current&&this._groupedList.current.toggleCollapseAll(e)};e.prototype._onColumnDragEnd=function(e,t){var i=this.props.columnReorderOptions,o=re.ColumnDragEndLocation.outside;if(i&&i.onDragEnd){if(e.dropLocation&&e.dropLocation!==re.ColumnDragEndLocation.header)o=e.dropLocation;else if(this._root.current){var r=this._root.current.getBoundingClientRect();t.clientX>r.left&&t.clientX<r.right&&t.clientY>r.top&&t.clientY<r.bottom&&(o=re.ColumnDragEndLocation.surface)}i.onDragEnd(o)}};e.prototype._forceListUpdates=function(){this._pendingForceUpdate=!1;this._groupedList.current&&this._groupedList.current.forceUpdate();this._list.current&&this._list.current.forceUpdate()};e.prototype._adjustColumns=function(e,t,i){var o=this._getAdjustedColumns(e,t,i),r=this.props.viewport.width;o&&this.setState({adjustedColumns:o,lastWidth:r})};e.prototype._getAdjustedColumns=function(e,t,i){var o,r=this,n=e.items,s=e.layoutMode,a=e.selectionMode,l=e.columns,d=e.viewport.width,c=this.props?this.props.columns:[],u=this.state?this.state.lastWidth:-1,p=this.state?this.state.lastSelectionMode:void 0;if(void 0!==d){if(!(t||u!==d||p!==a||c&&l!==c))return}else d=this.props.viewport.width;l=l||m(n,!0);s===re.DetailsListLayoutMode.fixedColumns?(o=this._getFixedColumns(l)).forEach(function(e){r._rememberCalculatedWidth(e,e.calculatedWidth)}):(o=void 0!==i?this._getJustifiedColumnsAfterResize(l,d,e,i):this._getJustifiedColumns(l,d,e,0)).forEach(function(e){r._getColumnOverride(e.key).currentWidth=e.calculatedWidth});return o};e.prototype._getFixedColumns=function(e){var i=this;return e.map(function(e){var t=s.assign({},e,i._columnOverrides[e.key]);t.calculatedWidth||(t.calculatedWidth=t.maxWidth||t.minWidth||100);return t})};e.prototype._getJustifiedColumnsAfterResize=function(e,t,o,i){var r=this,n=e.slice(0,i);n.forEach(function(e){return e.calculatedWidth=r._getColumnOverride(e.key).currentWidth});var s=n.reduce(function(e,t,i){return e+x(t,0===i,o)},0),a=e.slice(i),l=t-s;return n.concat(this._getJustifiedColumns(a,l,o,i))};e.prototype._getJustifiedColumns=function(e,t,o,r){for(var n=this,i=o.selectionMode,s=o.checkboxVisibility,a=o.groups,l=i!==ae.SelectionMode.none&&s!==re.CheckboxVisibility.hidden?40:0,d=0,c=t-(l+(a?36:0)),u=e.map(function(e,t){var i=ie.__assign({},e,{calculatedWidth:e.minWidth||100},n._columnOverrides[e.key]);d+=x(i,t+r===0,o);return i}),p=u.length-1;0<p&&c<d;){var m=(g=u[p]).minWidth||100,h=d-c;if(g.calculatedWidth-m>=h||!g.isCollapsable){g.calculatedWidth=Math.max(g.calculatedWidth-h,m);d=c}else{d-=x(g,!1,o);u.splice(p,1)}p--}for(var f=0;f<u.length&&d<c;f++){var g=u[f],b=f===u.length-1,_=this._columnOverrides[g.key];if(!_||!_.calculatedWidth||b){var y=c-d,v=void 0;if(b)v=y;else{var C=g.maxWidth;m=g.minWidth||C||100;v=C?Math.min(y,C-m):y}g.calculatedWidth=g.calculatedWidth+v;d+=v}}return u};e.prototype._onColumnResized=function(e,t,i){var o=Math.max(e.minWidth||100,t);this.props.onColumnResize&&this.props.onColumnResize(e,o,i);this._rememberCalculatedWidth(e,o);this._adjustColumns(this.props,!0,i);this._forceListUpdates()};e.prototype._rememberCalculatedWidth=function(e,t){var i=this._getColumnOverride(e.key);i.calculatedWidth=t;i.currentWidth=t};e.prototype._getColumnOverride=function(e){return this._columnOverrides[e]=this._columnOverrides[e]||{}};e.prototype._onColumnAutoResized=function(t,i){var o=this,r=0,n=0,s=Object.keys(this._activeRows).length;for(var e in this._activeRows)if(this._activeRows.hasOwnProperty(e)){this._activeRows[e].measureCell(i,function(e){r=Math.max(r,e);++n===s&&o._onColumnResized(t,r,i)})}};e.prototype._onActiveRowChanged=function(e,t){var i=this.props,o=i.items,r=i.onActiveItemChanged;if(e&&e.getAttribute("data-item-index")){var n=Number(e.getAttribute("data-item-index"));if(0<=n){r&&r(o[n],n,t);this.setState({focusedItemIndex:n})}}};e.prototype._onBlur=function(e){this.setState({focusedItemIndex:-1})};e.prototype._getItemKey=function(e,t){var i=this.props.getKey,o=void 0;e&&(o=e.key);i&&(o=i(e,t));o||(o=t);return o};e.prototype._getDetailsFooterProps=function(){var e={columns:this.state.adjustedColumns,groupNestingDepth:this._getGroupNestingDepth(),selection:this._selection};return ie.__assign({},e)};e.prototype._getColumnReorderProps=function(){var e=this.props.columnReorderOptions;if(e)return ie.__assign({},e,{onColumnDragEnd:this._onColumnDragEnd})};e.prototype._getGroupProps=function(e){var i=this,o=e.onRenderFooter,r=e.onRenderHeader,n=this.state.adjustedColumns,s=this._getGroupNestingDepth(),t=o?function(e,t){return o(ie.__assign({},e,{columns:n,groupNestingDepth:s,selection:i._selection}),t)}:void 0,a=r?function(e,t){return r(ie.__assign({},e,{columns:n,groupNestingDepth:s,selection:i._selection}),t)}:void 0,l=e;return ie.__assign({},l,{onRenderFooter:t,onRenderHeader:a})};e.defaultProps={layoutMode:re.DetailsListLayoutMode.justified,selectionMode:ae.SelectionMode.multiple,constrainMode:re.ConstrainMode.horizontalConstrained,checkboxVisibility:re.CheckboxVisibility.onHover,isHeaderVisible:!0,enableShimmer:!1};return e=ie.__decorate([o.withViewport],e)}(s.BaseComponent);t.DetailsListBase=a;function m(e,t,i,o,r,n,s){var a=[];if(e&&e.length){var l=e[0];for(var d in l)l.hasOwnProperty(d)&&a.push({key:d,name:d,fieldName:d,minWidth:100,maxWidth:300,isCollapsable:!!a.length,isMultiline:void 0!==s&&s,isSorted:o===d,isSortedDescending:!!r,isRowHeader:!1,columnActionsMode:re.ColumnActionsMode.clickable,isResizable:t,onColumnClick:i,isGrouped:n===d})}return a}t.buildColumns=m;function he(e){return e.which===s.getRTLSafeKeyCode(39)}function x(e,t,i){var o=i.cellStyleProps,r=void 0===o?ue.DEFAULT_CELL_STYLE_PROPS:o;return e.calculatedWidth+r.cellLeftPadding+r.cellRightPadding+(e.isPadded?r.cellExtraRightPadding:0)}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.disabled=0]="disabled";e[e.clickable=1]="clickable";e[e.hasDropdown=2]="hasDropdown"}(t.ColumnActionsMode||(t.ColumnActionsMode={}));!function(e){e[e.unconstrained=0]="unconstrained";e[e.horizontalConstrained=1]="horizontalConstrained"}(t.ConstrainMode||(t.ConstrainMode={}));!function(e){e[e.outside=0]="outside";e[e.surface=1]="surface";e[e.header=2]="header"}(t.ColumnDragEndLocation||(t.ColumnDragEndLocation={}));!function(e){e[e.fixedColumns=0]="fixedColumns";e[e.justified=1]="justified"}(t.DetailsListLayoutMode||(t.DetailsListLayoutMode={}));!function(e){e[e.onHover=0]="onHover";e[e.always=1]="always";e[e.hidden=2]="hidden"}(t.CheckboxVisibility||(t.CheckboxVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader",["require","exports","../../Utilities","./DetailsHeader.base","./DetailsHeader.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsHeader=i.styled(o.DetailsHeaderBase,r.getStyles,void 0,{scope:"DetailsHeader"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.base",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.types","../../FocusZone","../../Icon","../../Layer","../GroupedList/GroupSpacer","../../GroupedList","./DetailsRowCheck","../../utilities/selection/interfaces","../../utilities/dragdrop/index","../../components/DetailsList/DetailsColumn","./DetailsHeader.types","../../Utilities"],function(e,t,c,D,i,T,o,I,F,P,B,L,M,n,E,A,N,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=r.classNamesFunction(),s=function(t){c.__extends(e,t);function e(e){var m=t.call(this,e)||this;m._rootComponent=T.createRef();m._draggedColumnIndex=-1;m._dropHintDetails={};m._getDropHintPositions=function(){for(var e,t=m.props.columns,i=m._columnReorderProps,o=0,r=0,n=i&&i.frozenColumnCountFromStart?i.frozenColumnCountFromStart:0,s=i&&i.frozenColumnCountFromEnd?i.frozenColumnCountFromEnd:0,a=n;a<t.length-s+1;a++)if(m._rootElement){var l=m._rootElement.querySelectorAll("#columnDropHint_"+a)[0];if(l)if(a===n){o=l.offsetLeft;r=l.offsetLeft;e=l}else{var d=(l.offsetLeft+o)/2;m._dropHintDetails[a-1]={originX:o,startX:r,endX:d,dropHintElementRef:e};r=d;o=(e=l).offsetLeft;a===t.length-s&&(m._dropHintDetails[a]={originX:o,startX:r,endX:l.offsetLeft,dropHintElementRef:e})}}};m._computeDropHintToBeShown=function(e){if(m._rootElement){var t=e-m._rootElement.getBoundingClientRect().left,i=m._currentDropHintIndex;if(m._isValidCurrentDropHintIndex()&&t>=m._dropHintDetails[i].startX&&t<=m._dropHintDetails[i].endX)return;var o=m.props.columns,r=m._columnReorderProps,n=r&&r.frozenColumnCountFromStart?r.frozenColumnCountFromStart:0,s=r&&r.frozenColumnCountFromEnd?r.frozenColumnCountFromEnd:0,a=n,l=o.length-s,d=-1;t<=m._dropHintDetails[a].endX?d=a:t>=m._dropHintDetails[l].startX?d=l:m._isValidCurrentDropHintIndex()&&(m._dropHintDetails[i+1]&&t>=m._dropHintDetails[i+1].startX&&t<=m._dropHintDetails[i+1].endX?d=i+1:m._dropHintDetails[i-1]&&t>=m._dropHintDetails[i-1].startX&&t<=m._dropHintDetails[i-1].endX&&(d=i-1));if(-1===d)for(var c=n,u=l;c<u;){var p=Math.ceil((u+c)/2);if(t>=m._dropHintDetails[p].startX&&t<=m._dropHintDetails[p].endX){d=p;break}t<m._dropHintDetails[p].originX?u=p:t>m._dropHintDetails[p].originX&&(c=p)}if(d===m._draggedColumnIndex||d===m._draggedColumnIndex+1)m._isValidCurrentDropHintIndex()&&m._resetDropHints();else if(i!==d&&0<=d){m._resetDropHints();m._updateDropHintElement(m._dropHintDetails[d].dropHintElementRef,"visible");m._currentDropHintIndex=d}}};m._onRenderColumnHeaderTooltip=function(e,t){return D.createElement("span",{className:e.hostClassName},e.children)};m._onSelectAllClicked=function(){m.props.selection.toggleAllSelected()};m._onRootMouseDown=function(e){var t=e.target.getAttribute("data-sizer-index"),i=Number(t),o=m.props.columns;if(null!==t&&0===e.button){m.setState({columnResizeDetails:{columnIndex:i,columnMinWidth:o[i].calculatedWidth,originX:e.clientX}});e.preventDefault();e.stopPropagation()}};m._onRootMouseMove=function(e){var t=m.state,i=t.columnResizeDetails,o=t.isSizing;i&&!o&&e.clientX!==i.originX&&m.setState({isSizing:!0})};m._onRootRef=function(e){m._rootElement=e?i.findDOMNode(e):void 0};m._onRootKeyDown=function(e){var t=m.state,i=t.columnResizeDetails,o=t.isSizing,r=m.props,n=r.columns,s=r.onColumnResized,a=e.target.getAttribute("data-sizer-index");if(a&&!o){var l=Number(a);if(i){var d=void 0;if(13===e.which){m.setState({columnResizeDetails:void 0});e.preventDefault();e.stopPropagation()}else 37===e.which?d=T.getRTL()?1:-1:39===e.which&&(d=T.getRTL()?-1:1);if(d){e.shiftKey||(d*=10);m.setState({columnResizeDetails:c.__assign({},i,{columnMinWidth:i.columnMinWidth+d})});s&&s(n[l],i.columnMinWidth+d,l);e.preventDefault();e.stopPropagation()}}else if(13===e.which){m.setState({columnResizeDetails:{columnIndex:l,columnMinWidth:n[l].calculatedWidth}});e.preventDefault();e.stopPropagation()}}};m._onSizerMouseMove=function(e){var t=e.buttons,i=m.props,o=i.onColumnIsSizingChanged,r=i.onColumnResized,n=i.columns,s=m.state.columnResizeDetails;if(void 0===t||1===t){e.clientX!==s.originX&&o&&o(n[s.columnIndex],!0);if(r){var a=e.clientX-s.originX;T.getRTL()&&(a=-a);r(n[s.columnIndex],s.columnMinWidth+a,s.columnIndex)}}else m._onSizerMouseUp(e)};m._onSizerBlur=function(e){m.state.columnResizeDetails&&m.setState({columnResizeDetails:void 0,isSizing:!1})};m._onSizerMouseUp=function(e){var t=m.props,i=t.columns,o=t.onColumnIsSizingChanged,r=m.state.columnResizeDetails;m.setState({columnResizeDetails:void 0,isSizing:!1});o&&o(i[r.columnIndex],!1)};m._columnReorderProps=e.columnReorderProps||e.columnReorderOptions&&a(e.columnReorderOptions);m.state={columnResizeDetails:void 0,groupNestingDepth:m.props.groupNestingDepth,isAllCollapsed:m.props.isAllCollapsed};m._onToggleCollapseAll=m._onToggleCollapseAll.bind(m);m._onSelectAllClicked=m._onSelectAllClicked.bind(m);m._setDraggedItemIndex=m._setDraggedItemIndex.bind(m);m._updateDragInfo=m._updateDragInfo.bind(m);m._onDragOver=m._onDragOver.bind(m);m._onDrop=m._onDrop.bind(m);m._getHeaderDragDropOptions=m._getHeaderDragDropOptions.bind(m);m._updateDroppingState=m._updateDroppingState.bind(m);m._getDropHintPositions=m._getDropHintPositions.bind(m);m._computeDropHintToBeShown=m._computeDropHintToBeShown.bind(m);m._resetDropHints=m._resetDropHints.bind(m);m._isValidCurrentDropHintIndex=m._isValidCurrentDropHintIndex.bind(m);m._onRootRef=m._onRootRef.bind(m);m._isEventOnHeader=m._isEventOnHeader.bind(m);m._onDropIndexInfo={sourceIndex:Number.MIN_SAFE_INTEGER,targetIndex:Number.MIN_SAFE_INTEGER};m._id=T.getId("header");m._currentDropHintIndex=Number.MIN_SAFE_INTEGER;return m}e.prototype.componentDidMount=function(){var e=this.props.selection,t=this._columnReorderProps;this._events.on(e,n.SELECTION_CHANGE,this._onSelectionChanged);this._events.on(this._rootElement,"mousedown",this._onRootMouseDown);this._events.on(this._rootElement,"keydown",this._onRootKeyDown);t&&this._dragDropHelper&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()))};e.prototype.componentDidUpdate=function(e){this._columnReorderProps=this.props.columnReorderProps||this.props.columnReorderOptions&&a(this.props.columnReorderOptions);if(this._columnReorderProps)!this._subscriptionObject&&this._dragDropHelper&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()));else if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}this.props!==e&&0<=this._onDropIndexInfo.sourceIndex&&0<=this._onDropIndexInfo.targetIndex&&e.columns[this._onDropIndexInfo.sourceIndex].key===this.props.columns[this._onDropIndexInfo.targetIndex].key&&(this._onDropIndexInfo={sourceIndex:Number.MIN_SAFE_INTEGER,targetIndex:Number.MIN_SAFE_INTEGER})};e.prototype.componentWillReceiveProps=function(e){var t=this.state.groupNestingDepth;e.groupNestingDepth!==t&&this.setState({groupNestingDepth:e.groupNestingDepth})};e.prototype.componentWillUnmount=function(){if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}};e.prototype.render=function(){var o=this,e=this.props,r=e.columns,t=e.ariaLabel,i=e.ariaLabelForSelectAllCheckbox,n=e.selectAllVisibility,s=e.ariaLabelForSelectionColumn,a=e.indentWidth,l=e.viewport,d=e.onColumnClick,c=e.onColumnContextMenu,u=e.styles,p=e.theme,m=this._columnReorderProps,h=this.state,f=h.isAllSelected,g=h.columnResizeDetails,b=h.isSizing,_=h.groupNestingDepth,y=h.isAllCollapsed,v=n!==N.SelectAllVisibility.none,C=n===N.SelectAllVisibility.hidden,x=this.props.onRenderColumnHeaderTooltip,w=void 0===x?this._onRenderColumnHeaderTooltip:x;!this._dragDropHelper&&m&&(this._dragDropHelper=new E.DragDropHelper({selection:{getSelection:function(){}},minimumPixelsForDrag:this.props.minimumPixelsForDrag}));var S=m&&m.frozenColumnCountFromStart?m.frozenColumnCountFromStart:0,k=m&&m.frozenColumnCountFromEnd?m.frozenColumnCountFromEnd:0;this._classNames=H(u,{theme:p,isAllSelected:f,isSelectAllHidden:n===N.SelectAllVisibility.hidden,isResizingColumn:!!g&&b,isSizing:b,isAllCollapsed:y,isCheckboxHidden:C});var R=this._classNames;return D.createElement(I.FocusZone,{role:"row","aria-label":t,className:R.root,componentRef:this._rootComponent,ref:this._onRootRef,onMouseMove:this._onRootMouseMove,"data-automationid":"DetailsHeader",style:{minWidth:l?l.width:0},direction:I.FocusZoneDirection.horizontal},v?[D.createElement("div",{key:"__checkbox",className:R.cellIsCheck,"aria-labelledby":this._id+"-check",onClick:this._onSelectAllClicked,"aria-colindex":C?void 0:1,role:C?void 0:"columnheader"},w({hostClassName:T.css(R.checkTooltip),id:this._id+"-checkTooltip",setAriaDescribedBy:!1,content:i,children:D.createElement(M.DetailsRowCheck,{id:this._id+"-check","aria-label":s,"aria-describedby":this._id+"-checkTooltip","data-is-focusable":!C,isHeader:!0,selected:f,anySelected:!1,canSelect:!C,className:R.check})},this._onRenderColumnHeaderTooltip)),i&&!this.props.onRenderColumnHeaderTooltip?D.createElement("label",{key:"__checkboxLabel",id:this._id+"-checkTooltip",className:R.accessibleLabel},i):null]:null,0<_&&this.props.collapseAllVisibility===L.CollapseAllVisibility.visible?D.createElement("div",{className:R.cellIsGroupExpander,onClick:this._onToggleCollapseAll,"data-is-focusable":!0},D.createElement(F.Icon,{className:R.collapseButton,iconName:"ChevronDown"})):null,D.createElement(B.GroupSpacer,{indentWidth:a,count:_-1}),r.map(function(e,t){var i=!!m&&(S<=t&&t<r.length-k);return[m&&(i||t===r.length-k)&&o._renderDropHint(t),D.createElement(A.DetailsColumn,{column:e,key:e.key,columnIndex:(v?2:1)+t,parentId:o._id,isDraggable:i,updateDragInfo:o._updateDragInfo,dragDropHelper:o._dragDropHelper,onColumnClick:d,onColumnContextMenu:c,isDropped:o._onDropIndexInfo.targetIndex===t,cellStyleProps:o.props.cellStyleProps}),e.isResizable&&o._renderColumnSizer(t)]}),m&&0===k&&this._renderDropHint(r.length),b&&D.createElement(P.Layer,null,D.createElement("div",{className:R.sizingOverlay,onMouseMove:this._onSizerMouseMove,onMouseUp:this._onSizerMouseUp})))};e.prototype.focus=function(){return Boolean(this._rootComponent.current&&this._rootComponent.current.focus())};e.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}};e.prototype._updateDroppingState=function(e,t){0<=this._draggedColumnIndex&&"drop"!==t.type&&(e||this._resetDropHints())};e.prototype._isValidCurrentDropHintIndex=function(){return 0<=this._currentDropHintIndex};e.prototype._onDragOver=function(e,t){if(0<=this._draggedColumnIndex){t.stopPropagation();this._computeDropHintToBeShown(t.clientX)}};e.prototype._onDrop=function(e,t){var i=this._draggedColumnIndex,o=this._columnReorderProps;if(0<=this._draggedColumnIndex&&t&&t instanceof DragEvent){var r=i>this._currentDropHintIndex?this._currentDropHintIndex:this._currentDropHintIndex-1,n=!1;t.stopPropagation();if(this._isValidCurrentDropHintIndex()){n=!0;this._onDropIndexInfo.sourceIndex=i;this._onDropIndexInfo.targetIndex=r}this._resetDropHints();this._dropHintDetails={};this._draggedColumnIndex=-1;if(n)if(o&&o.onColumnDrop){var s={draggedIndex:i,targetIndex:r};o.onColumnDrop(s)}else o&&o.handleColumnReorder&&o.handleColumnReorder(i,r)}};e.prototype._setDraggedItemIndex=function(e){if(0<=e){this._draggedColumnIndex=this.props.selectionMode!==n.SelectionMode.none?e-2:e-1;this._getDropHintPositions()}else{this._resetDropHints();this._draggedColumnIndex=-1;this._dropHintDetails={}}};e.prototype._updateDragInfo=function(e,t){var i=this._columnReorderProps,o=e.itemIndex;if(0<=o){this._draggedColumnIndex=this.props.selectionMode!==n.SelectionMode.none?o-2:o-1;this._getDropHintPositions();i&&i.onColumnDragStart&&i.onColumnDragStart(!0)}else if(t&&0<=this._draggedColumnIndex){this._resetDropHints();this._draggedColumnIndex=-1;this._dropHintDetails={};if(i&&i.onColumnDragEnd){var r=this._isEventOnHeader(t);i.onColumnDragEnd({dropLocation:r},t)}}};e.prototype._resetDropHints=function(){if(0<=this._currentDropHintIndex){this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"hidden");this._currentDropHintIndex=Number.MIN_SAFE_INTEGER}};e.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.visibility=t;e.childNodes[0].style.visibility=t};e.prototype._isEventOnHeader=function(e){if(this._rootElement){var t=this._rootElement.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return o.ColumnDragEndLocation.header}};e.prototype._renderColumnSizer=function(e){var t,i=this.props.columns,o=this.props.columns[e],r=this.state.columnResizeDetails,n=this._classNames;return D.createElement("div",{key:o.key+"_sizer","aria-hidden":!0,role:"button","data-is-focusable":!1,onClick:l,"data-sizer-index":e,onBlur:this._onSizerBlur,className:T.css(n.cellSizer,e<i.length-1?n.cellSizerStart:n.cellSizerEnd,(t={},t[n.cellIsResizing]=r&&r.columnIndex===e,t)),onDoubleClick:this._onSizerDoubleClick.bind(this,e)})};e.prototype._renderDropHint=function(e){var t=this._classNames;return D.createElement("div",{key:"dropHintKey",className:t.dropHintStyle,id:"columnDropHint_"+e},D.createElement(F.Icon,{key:"dropHintCaretKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:t.dropHintCaretStyle,iconName:"CaretUpSolid8"}),D.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:t.dropHintLineStyle}))};e.prototype._onSizerDoubleClick=function(e,t){var i=this.props,o=i.onColumnAutoResized,r=i.columns;o&&o(r[e],e)};e.prototype._onSelectionChanged=function(){var e=this.props.selection.isAllSelected();this.state.isAllSelected!==e&&this.setState({isAllSelected:e})};e.prototype._onToggleCollapseAll=function(){var e=this.props.onToggleCollapseAll,t=!this.state.isAllCollapsed;this.setState({isAllCollapsed:t});e&&e(t)};e.defaultProps={selectAllVisibility:N.SelectAllVisibility.visible,collapseAllVisibility:L.CollapseAllVisibility.visible};return e}(T.BaseComponent);t.DetailsHeaderBase=s;function a(e){return c.__assign({},e,{onColumnDragEnd:void 0})}function l(e){e.stopPropagation()}});define("office-ui-fabric-react/lib/GroupedList",["require","exports","tslib","./components/GroupedList/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck",["require","exports","tslib","react","../../Utilities","../../Check","../Check/Check.styles","./DetailsRowCheck.styles","../../Utilities"],function(e,t,g,b,_,y,v,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=o.classNamesFunction(),x=o.classNamesFunction();t.DetailsRowCheck=_.styled(function(e){var t=e.canSelect,i=void 0!==t&&t,o=(e.isSelected,e.anySelected),r=void 0!==o&&o,n=(e.selected,e.isHeader),s=void 0!==n&&n,a=e.className,l=(e.checkClassName,e.styles),d=e.theme,c=e.compact,u=g.__rest(e,["canSelect","isSelected","anySelected","selected","isHeader","className","checkClassName","styles","theme","compact"]),p=e.isSelected||e.selected,m=v.getStyles({theme:d}),h=C(m,{theme:d}),f=x(l,{theme:d,canSelect:i,selected:p,anySelected:r,className:a,isHeader:s,compact:c});return b.createElement("div",g.__assign({},u,{role:"checkbox",className:_.css(f.root,f.check,h.checkHost),"aria-checked":p,"data-selection-toggle":!0,"data-automationid":"DetailsRowCheck"}),b.createElement(y.Check,{checked:p}))},i.getStyles,void 0,{scope:"DetailsRowCheck"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:"ms-DetailsRow-check",isDisabled:"ms-DetailsRow-check--isDisabled",isHeader:"ms-DetailsRow-check--isHeader"};t.getStyles=function(e){var t=e.theme,i=e.className,o=e.isHeader,r=e.selected,n=e.anySelected,s=e.canSelect,a=e.compact,l=c.getGlobalClassNames(u,t),d=r||n;return{root:[l.root,!s&&[l.isDisabled,{visibility:"hidden"}],o&&l.isHeader,d&&{opacity:1},i],check:[c.getFocusStyle(t),{display:"flex",alignItems:"center",justifyContent:"center",cursor:"default",boxSizing:"border-box",verticalAlign:"top",background:"none",backgroundColor:"transparent",border:"none",opacity:0,height:a||o?32:40,width:40,padding:0,margin:0,selectors:{"&:hover":{opacity:1}}},(r||n||d)&&{opacity:1}],isDisabled:[]}}});define("office-ui-fabric-react/lib/utilities/dragdrop/index",["require","exports","tslib","./DragDropHelper"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/utilities/dragdrop/DragDropHelper",["require","exports","react-dom","../../Utilities"],function(e,t,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._selection=e.selection;this._dragEnterCounts={};this._activeTargets={};this._lastId=0;this._events=new s.EventGroup(this);this._events.on(document.body,"mouseup",this._onMouseUp.bind(this),!0);this._events.on(document,"mouseup",this._onDocumentMouseUp.bind(this),!0)}e.prototype.dispose=function(){this._events.dispose()};e.prototype.subscribe=function(o,r,t){var n,s,a,l,d,c,u,p,m,h,f=this,e=t.key,g=void 0===e?""+ ++this._lastId:e,b=[];if(t&&o){var i=t.eventMap,_=t.context,y=t.updateDropState,v={root:o,options:t,key:g};p=this._isDraggable(v);m=this._isDroppable(v);if((p||m)&&i)for(var C=0,x=i;C<x.length;C++){var w=x[C],S={callback:w.callback.bind(null,_),eventName:w.eventName};b.push(S);this._events.on(o,S.eventName,S.callback)}if(m){s=function(e){if(!e.isHandled){e.isHandled=!0;f._dragEnterCounts[g]--;0===f._dragEnterCounts[g]&&y(!1,e)}};a=function(e){e.preventDefault();if(!e.isHandled){e.isHandled=!0;f._dragEnterCounts[g]++;1===f._dragEnterCounts[g]&&y(!0,e)}};l=function(e){f._dragEnterCounts[g]=0;y(!1,e)};d=function(e){f._dragEnterCounts[g]=0;y(!1,e);t.onDrop&&t.onDrop(t.context.data,e)};c=function(e){e.preventDefault();t.onDragOver&&t.onDragOver(t.context.data,e)};this._dragEnterCounts[g]=0;r.on(o,"dragenter",a);r.on(o,"dragleave",s);r.on(o,"dragend",l);r.on(o,"drop",d);r.on(o,"dragover",c)}if(p){u=this._onMouseDown.bind(this,v);l=this._onDragEnd.bind(this,v);n=function(e){var t=f._dragData.dragTarget.options;t&&t.onDragStart&&t.onDragStart(t.context.data,t.context.index,f._selection.getSelection(),e);f._isDragging=!0;e.dataTransfer.setData("id",o.id)};r.on(o,"dragstart",n);r.on(o,"mousedown",u);r.on(o,"dragend",l)}h={target:v,dispose:function(){f._activeTargets[g]===h&&delete f._activeTargets[g];if(o){for(var e=0,t=b;e<t.length;e++){var i=t[e];f._events.off(o,i.eventName,i.callback)}if(m){r.off(o,"dragenter",a);r.off(o,"dragleave",s);r.off(o,"dragend",l);r.off(o,"dragover",c);r.off(o,"drop",d)}if(p){r.off(o,"dragstart",n);r.off(o,"mousedown",u);r.off(o,"dragend",l)}}}};this._activeTargets[g]=h}return{key:g,dispose:function(){h&&h.dispose()}}};e.prototype.unsubscribe=function(e,t){var i=this._activeTargets[t];i&&i.dispose()};e.prototype._onDragEnd=function(e,t){var i=e.options;i.onDragEnd&&i.onDragEnd(i.context.data,t)};e.prototype._onMouseUp=function(e){this._isDragging=!1;if(this._dragData){for(var t=0,i=Object.keys(this._activeTargets);t<i.length;t++){var o=i[t],r=this._activeTargets[o];if(r.target.root){this._events.off(r.target.root,"mousemove");this._events.off(r.target.root,"mouseleave")}}if(this._dragData.dropTarget){s.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");s.EventGroup.raise(this._dragData.dropTarget.root,"drop")}}this._dragData=null};e.prototype._onDocumentMouseUp=function(e){e.target===document.documentElement&&this._onMouseUp(e)};e.prototype._onMouseMove=function(e,t){var i=t.buttons,o=void 0===i?1:i;if(this._dragData&&1!==o)this._onMouseUp(t);else{var r=e.root,n=e.key;if(this._isDragging&&this._isDroppable(e)&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key!==n&&!this._isChild(r,this._dragData.dropTarget.root)&&0<this._dragEnterCounts[this._dragData.dropTarget.key]){s.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");s.EventGroup.raise(r,"dragenter");this._dragData.dropTarget=e}}};e.prototype._onMouseLeave=function(e,t){if(this._isDragging&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key===e.key){s.EventGroup.raise(e.root,"dragleave");this._dragData.dropTarget=void 0}};e.prototype._onMouseDown=function(e,t){if(0===t.button)if(this._isDraggable(e)){this._dragData={clientX:t.clientX,clientY:t.clientY,eventTarget:t.target,dragTarget:e};for(var i=0,o=Object.keys(this._activeTargets);i<o.length;i++){var r=o[i],n=this._activeTargets[r];if(n.target.root){this._events.on(n.target.root,"mousemove",this._onMouseMove.bind(this,n.target));this._events.on(n.target.root,"mouseleave",this._onMouseLeave.bind(this,n.target))}}}else this._dragData=null};e.prototype._isChild=function(e,t){for(var i=r.findDOMNode(e),o=r.findDOMNode(t);o&&o.parentElement;){if(o.parentElement===i)return!0;o=o.parentElement}return!1};e.prototype._isDraggable=function(e){var t=e.options;return!(!t.canDrag||!t.canDrag(t.context.data))};e.prototype._isDroppable=function(e){var t=e.options,i=this._dragData&&this._dragData.dragTarget?this._dragData.dragTarget.options.context:void 0;return!(!t.canDrop||!t.canDrop(t.context,i))};return e}();t.DragDropHelper=i});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn",["require","exports","../../Utilities","./DetailsColumn.base","./DetailsColumn.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsColumn=i.styled(o.DetailsColumnBase,r.getStyles,void 0,{scope:"DetailsColumn"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn.base",["require","exports","tslib","react","../../Icon","../../Utilities","./DetailsList.types","./DetailsRow.styles"],function(e,t,o,p,m,r,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=r.classNamesFunction(),i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._onRenderColumnHeaderTooltip=function(e,t){return p.createElement("span",{className:e.hostClassName},e.children)};t._onRootMouseDown=function(e){t.props.isDraggable&&0===e.button&&e.stopPropagation()};t._root=r.createRef();t._onDragStart=t._onDragStart.bind(t);t._onDragEnd=t._onDragEnd.bind(t);t._onRootMouseDown=t._onRootMouseDown.bind(t);t._updateHeaderDragInfo=t._updateHeaderDragInfo.bind(t);return t}e.prototype.render=function(){var e=this.props,t=e.column,i=e.columnIndex,o=e.parentId,r=e.isDraggable,n=e.styles,s=e.theme,a=e.cellStyleProps,l=void 0===a?f.DEFAULT_CELL_STYLE_PROPS:a,d=this.props.onRenderColumnHeaderTooltip,c=void 0===d?this._onRenderColumnHeaderTooltip:d;this._classNames=g(n,{theme:s,headerClassName:t.headerClassName,iconClassName:t.iconClassName,isActionable:t.columnActionsMode!==h.ColumnActionsMode.disabled,isEmpty:!t.name,isIconVisible:t.isSorted||t.isGrouped||t.isFiltered,isPadded:t.isPadded,isIconOnly:t.isIconOnly,cellStyleProps:l});var u=this._classNames;return p.createElement(p.Fragment,null,p.createElement("div",{key:t.key,ref:this._root,role:"columnheader","aria-sort":t.isSorted?t.isSortedDescending?"descending":"ascending":"none","aria-colindex":i,className:u.root,"data-is-draggable":r,draggable:r,style:{width:t.calculatedWidth+l.cellLeftPadding+l.cellRightPadding+(t.isPadded?l.cellExtraRightPadding:0)},"data-automationid":"ColumnsHeaderColumn","data-item-key":t.key},r&&p.createElement(m.Icon,{iconName:"GripperBarVertical",className:u.gripperBarVerticalStyle}),c({hostClassName:u.cellTooltip,id:o+"-"+t.key+"-tooltip",setAriaDescribedBy:!1,content:t.columnActionsMode!==h.ColumnActionsMode.disabled?t.ariaLabel:"",children:p.createElement("span",{id:o+"-"+t.key,"aria-label":t.isIconOnly?t.name:void 0,"aria-labelledby":t.isIconOnly?void 0:o+"-"+t.key+"-name ",className:u.cellTitle,"data-is-focusable":t.columnActionsMode!==h.ColumnActionsMode.disabled,role:t.columnActionsMode!==h.ColumnActionsMode.disabled?"button":void 0,"aria-describedby":this.props.onRenderColumnHeaderTooltip||this._hasAccessibleLabel()?o+"-"+t.key+"-tooltip":void 0,onContextMenu:this._onColumnContextMenu.bind(this,t),onClick:this._onColumnClick.bind(this,t),"aria-haspopup":t.columnActionsMode===h.ColumnActionsMode.hasDropdown},p.createElement("span",{id:o+"-"+t.key+"-name",className:u.cellName},(t.iconName||t.iconClassName)&&p.createElement(m.Icon,{className:u.iconClassName,iconName:t.iconName}),t.isIconOnly?p.createElement("span",{className:u.accessibleLabel},t.name):t.name),t.isFiltered&&p.createElement(m.Icon,{className:u.nearIcon,iconName:"Filter"}),t.isSorted&&p.createElement(m.Icon,{className:u.sortIcon,iconName:t.isSortedDescending?"SortDown":"SortUp"}),t.isGrouped&&p.createElement(m.Icon,{className:u.nearIcon,iconName:"GroupedDescending"}),t.columnActionsMode===h.ColumnActionsMode.hasDropdown&&!t.isIconOnly&&p.createElement(m.Icon,{"aria-hidden":!0,className:u.filterChevron,iconName:"ChevronDown"}))},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:this._renderAccessibleLabel())};e.prototype.componentDidMount=function(){var e=this;if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}if(this.props.dragDropHelper&&this.props.isDraggable){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getColumnDragDropOptions());this._events.on(this._root.current,"mousedown",this._onRootMouseDown)}var t=this._classNames;if(this.props.isDropped){this._root.current&&this._root.current.classList.add(t.borderAfterDropping);setTimeout(function(){e._root.current&&e._root.current.classList.remove(t.borderAfterDropping)},1500)}};e.prototype.componentWillUnmount=function(){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}};e.prototype.componentDidUpdate=function(){if(!this._dragDropSubscription&&this.props.dragDropHelper&&this.props.isDraggable){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.value,this._events,this._getColumnDragDropOptions());this._events.on(this._root.current,"mousedown",this._onRootMouseDown)}if(this._dragDropSubscription&&!this.props.isDraggable){this._dragDropSubscription.dispose();this._events.off(this._root.current,"mousedown");delete this._dragDropSubscription}};e.prototype._onColumnClick=function(e,t){var i=this.props.onColumnClick;e.onColumnClick&&e.onColumnClick(t,e);i&&i(t,e)};e.prototype._getColumnDragDropOptions=function(){var e=this,t=this.props.columnIndex;return{selectionIndex:t,context:{data:t,index:t},canDrag:function(){return e.props.isDraggable},canDrop:function(){return!1},onDragStart:this._onDragStart,updateDropState:function(){},onDrop:function(){},onDragEnd:this._onDragEnd}};e.prototype._hasAccessibleLabel=function(){var e=this.props.column;return!!(e.ariaLabel||e.filterAriaLabel||e.sortAscendingAriaLabel||e.sortDescendingAriaLabel||e.groupAriaLabel)};e.prototype._renderAccessibleLabel=function(){var e=this.props,t=e.column,i=e.parentId,o=this._classNames;return this._hasAccessibleLabel()&&!this.props.onRenderColumnHeaderTooltip?p.createElement("label",{key:t.key+"_label",id:i+"-"+t.key+"-tooltip",className:o.accessibleLabel},t.ariaLabel,t.isFiltered&&t.filterAriaLabel||null,t.isSorted&&(t.isSortedDescending?t.sortDescendingAriaLabel:t.sortAscendingAriaLabel)||null,t.isGrouped&&t.groupAriaLabel||null):null};e.prototype._onDragStart=function(e,t,i,o){var r=this._classNames;if(t){this._updateHeaderDragInfo(t);this._root.current.classList.add(r.borderWhileDragging)}};e.prototype._onDragEnd=function(e,t){var i=this._classNames;this._root.current.classList.remove(i.borderWhileDragging)};e.prototype._updateHeaderDragInfo=function(e,t){this.props.setDraggedItemIndex&&this.props.setDraggedItemIndex(e);this.props.updateDragInfo&&this.props.updateDragInfo({itemIndex:e},t)};e.prototype._onColumnContextMenu=function(e,t){var i=this.props.onColumnContextMenu;if(e.onColumnContextMenu){e.onColumnContextMenu(e,t);t.preventDefault()}if(i){i(e,t);t.preventDefault()}};return e}(r.BaseComponent);t.DetailsColumnBase=i});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow.styles",["require","exports","tslib","../../Styling"],function(e,U,t,z){"use strict";Object.defineProperty(U,"__esModule",{value:!0});var K={root:"ms-DetailsRow",compact:"ms-DetailsList--Compact",cell:"ms-DetailsRow-cell",cellCheck:"ms-DetailsRow-cellCheck",cellMeasurer:"ms-DetailsRow-cellMeasurer",listCellFirstChild:"ms-List-cell:first-child",isFocusable:"[data-is-focusable='true']",isContentUnselectable:"is-contentUnselectable",isSelected:"is-selected",isCheckVisible:"is-check-visible",fields:"ms-DetailsRow-fields"};U.DEFAULT_CELL_STYLE_PROPS={cellLeftPadding:12,cellRightPadding:8,cellExtraRightPadding:24};var q={rowHeight:42,compactRowHeight:32,rowVerticalPadding:11,compactRowVerticalPadding:6,rowShimmerLineHeight:7,rowShimmerIconPlaceholderHeight:16,rowShimmerVerticalBorder:0,compactRowShimmerVerticalBorder:0};q=t.__assign({},q,{rowShimmerVerticalBorder:(q.rowHeight-q.rowShimmerLineHeight)/2,compactRowShimmerVerticalBorder:(q.compactRowHeight-q.rowShimmerLineHeight)/2});U.getStyles=function(e){var t,i,o,r,n,s,a,l,d,c=e.theme,u=e.isSelected,p=e.canSelect,m=e.droppingClassName,h=e.anySelected,f=e.isCheckVisible,g=e.checkboxCellClassName,b=e.compact,_=e.className,y=e.cellStyleProps,v=void 0===y?U.DEFAULT_CELL_STYLE_PROPS:y,C=c.palette,x=C.neutralPrimary,w=C.neutralSecondaryAlt,S=C.white,k=C.neutralSecondary,R=C.neutralLighter,D=C.neutralLight,T=C.neutralDark,I=C.neutralQuaternaryAlt,F=C.black,P=C.themePrimary,B=z.getGlobalClassNames(K,c),L={defaultHeaderTextColor:x,defaultMetaTextColor:w,defaultBackgroundColor:S,hoverTextColor:x,hoverMetaTextColor:k,hoverColorBackground:R,selectedTextColor:T,selectedMetaTextColor:x,selectedBackgroundColor:D,selectedHoverTextColor:F,selectedHoverMetaTextColor:T,selectedHoverBackgroundColor:I,focusHeaderTextColor:F,focusBackgroundColor:I,focusMetaTextColor:T},M=4*v.cellRightPadding+"px solid "+L.defaultBackgroundColor,E=v.cellLeftPadding+"px solid "+L.defaultBackgroundColor,A=[z.getFocusStyle(c,-1,void 0,void 0,P,S),B.isSelected,{color:L.selectedMetaTextColor,background:L.selectedBackgroundColor,borderBottom:"1px solid "+S,selectors:{"&:before":{position:"absolute",display:"block",top:-1,height:1,bottom:0,left:0,right:0,content:"",borderTop:"1px solid "+S},"&:hover":{background:L.selectedHoverBackgroundColor,selectors:{$cell:{color:L.selectedHoverMetaTextColor,selectors:(t={},t[z.HighContrastSelector]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},t["&.$isRowHeader"]={color:L.selectedHoverTextColor,selectors:(i={},i[z.HighContrastSelector]={color:"HighlightText"},i)},t)}}},"&:focus":{background:L.focusBackgroundColor,selectors:{$cell:(o={color:L.focusMetaTextColor},o[z.HighContrastSelector]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},o["&.$isRowHeader"]={color:L.focusHeaderTextColor,selectors:(r={},r[z.HighContrastSelector]={color:"HighlightText"},r)},o)}}}}],N=[B.isContentUnselectable,{userSelect:"none",cursor:"default"}],H={minHeight:q.compactRowHeight,border:0},O={minHeight:q.compactRowHeight,paddingTop:q.compactRowVerticalPadding,paddingBottom:q.compactRowVerticalPadding,paddingLeft:v.cellLeftPadding+"px",selectors:(n={},n["&$shimmer"]={padding:0,borderLeft:E,borderRight:M,borderTop:q.compactRowShimmerVerticalBorder+"px solid "+L.defaultBackgroundColor,borderBottom:q.compactRowShimmerVerticalBorder+"px solid "+L.defaultBackgroundColor},n["&$shimmerIconPlaceholder"]={borderRight:v.cellRightPadding+"px solid "+L.defaultBackgroundColor,borderBottom:(q.compactRowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+L.defaultBackgroundColor,borderTop:(q.compactRowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+L.defaultBackgroundColor},n)},V=[z.getFocusStyle(c,-1),B.cell,{display:"inline-block",position:"relative",boxSizing:"border-box",minHeight:q.rowHeight,verticalAlign:"top",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingTop:q.rowVerticalPadding,paddingBottom:q.rowVerticalPadding,paddingLeft:v.cellLeftPadding+"px",selectors:(s={"& > button":{maxWidth:"100%"}},s[B.isFocusable]=z.getFocusStyle(c,-1,void 0,void 0,k,S),s["&$shimmer"]={padding:0,borderLeft:E,borderRight:M,borderTop:q.rowShimmerVerticalBorder+"px solid "+L.defaultBackgroundColor,borderBottom:q.rowShimmerVerticalBorder+"px solid "+L.defaultBackgroundColor},s["&$shimmerIconPlaceholder"]={borderRight:v.cellRightPadding+"px solid "+L.defaultBackgroundColor,borderBottom:(q.rowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+L.defaultBackgroundColor,borderTop:(q.rowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+L.defaultBackgroundColor},s)},u&&{selectors:(a={"&.$isRowHeader":{color:L.selectedTextColor,selectors:(l={},l[z.HighContrastSelector]={color:"HighlightText"},l)}},a[z.HighContrastSelector]={background:"Highlight",color:"HighlightText","-ms-high-contrast-adjust":"none",selectors:{a:{color:"HighlightText"}}},a)},b&&O];return{root:[B.root,z.AnimationClassNames.fadeIn400,m,f&&B.isCheckVisible,z.getFocusStyle(c,0,void 0,void 0,u?k:P,S),{borderBottom:"1px solid "+R,background:L.defaultBackgroundColor,color:L.defaultMetaTextColor,display:"flex",minWidth:"100%",minHeight:q.rowHeight,whiteSpace:"nowrap",padding:0,boxSizing:"border-box",verticalAlign:"top",textAlign:"left",selectors:(d={},d[B.listCellFirstChild+" &:before"]={display:"none"},d["&:hover"]={background:L.hoverColorBackground,color:L.hoverMetaTextColor},d["&:hover $check"]={opacity:1},d)},u&&A,!p&&N,b&&H,_],cellUnpadded:[{paddingRight:v.cellRightPadding+"px"}],cellPadded:[{paddingRight:v.cellExtraRightPadding+v.cellRightPadding+"px",selectors:{"&.$checkCell":{paddingRight:0}}}],cell:V,cellMeasurer:[B.cellMeasurer,{overflow:"visible",whiteSpace:"nowrap"}],checkCell:[V,B.cellCheck,g,{padding:0,paddingTop:1,marginTop:-1,flexShrink:0}],checkCover:[{position:"absolute",top:-1,left:0,bottom:0,right:0,display:"none"},h&&{display:"block"}],fields:[B.fields,{display:"flex",alignItems:"stretch"}],isRowHeader:[{color:L.defaultHeaderTextColor,fontSize:z.FontSizes.medium}],isMultiline:[{whiteSpace:"normal",wordBreak:"break-word",textOverflow:"clip"}],shimmer:[],shimmerIconPlaceholder:[],shimmerLeftBorder:[{borderLeft:"40px solid "+L.defaultBackgroundColor}],shimmerBottomBorder:[{borderBottom:"1px solid "+L.defaultBackgroundColor}],check:[]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn.styles",["require","exports","../../Styling","./DetailsRow.styles","./DetailsHeader.styles"],function(e,t,b,_,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={isActionable:"is-actionable",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",isEmpty:"is-empty",isIconVisible:"is-icon-visible",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVerticalStyle:"ms-DetailsColumn-gripperBar"};t.getStyles=function(e){var t=e.theme,i=e.headerClassName,o=e.iconClassName,r=e.isActionable,n=e.isEmpty,s=e.isIconVisible,a=e.isPadded,l=e.isIconOnly,d=e.cellStyleProps,c=void 0===d?_.DEFAULT_CELL_STYLE_PROPS:d,u=t.semanticColors,p=t.palette,m=b.getGlobalClassNames(v,t),h={iconForegroundColor:u.bodySubtext,headerForegroundColor:u.bodyText,headerBackgroundColor:u.bodyBackground,dropdownChevronForegroundColor:p.neutralTertiary,resizerColor:p.neutralTertiaryAlt},f=b.keyframes({from:{borderColor:p.themePrimary},to:{borderColor:"transparent"}}),g={color:h.iconForegroundColor,opacity:1,paddingLeft:8};return{root:[y.getCellStyles(e),i,r&&[m.isActionable,{selectors:{":hover":{color:u.bodyText,background:u.listHeaderBackgroundHovered},":active":{background:u.listHeaderBackgroundPressed}}}],n&&[m.isEmpty,{textOverflow:"clip"}],s&&m.isIconVisible,a&&{paddingRight:c.cellExtraRightPadding+c.cellRightPadding},{selectors:{':hover i[data-icon-name="GripperBarVertical"]':{display:"block"}}}],gripperBarVerticalStyle:[{display:"none",position:"absolute",textAlign:"left",color:p.neutralTertiary,left:1}],nearIcon:g,sortIcon:[g,{paddingLeft:4,position:"relative",top:1}],iconClassName:[g,o],filterChevron:[m.filterChevron,{color:h.dropdownChevronForegroundColor,paddingLeft:4,verticalAlign:"middle"}],cellTitle:[m.cellTitle,b.getFocusStyle(t),{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",boxSizing:"border-box",overflow:"hidden",padding:"0 "+c.cellRightPadding+"px 0 "+c.cellLeftPadding+"px"}],cellName:[m.cellName,{flex:"0 1 auto",overflow:"hidden",textOverflow:"ellipsis"},l&&{selectors:{$nearIcon:{paddingLeft:0}}}],cellTooltip:[{display:"block",position:"absolute",top:0,left:0,bottom:0,right:0}],accessibleLabel:[b.hiddenContentStyle],borderAfterDropping:[{borderStyle:"solid",borderWidth:1,borderColor:p.themePrimary,left:-1,lineHeight:31,animation:f+" 1.5s forwards"}],borderWhileDragging:[{borderStyle:"solid",borderWidth:1,borderColor:p.themePrimary,animation:f+" 0.2s forwards"}]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.styles",["require","exports","../../Styling","../../Utilities","./DetailsRow.styles"],function(e,y,v,C,x){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var w={tooltipHost:"ms-TooltipHost",root:"ms-DetailsHeader",cell:"ms-DetailsHeader-cell",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintCaretStyle:"ms-DetailsHeader-dropHintCaretStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVertical:"ms-DetailsColumn-gripperBarVertical"},S=32;y.getCellStyles=function(e){var t=e.theme,i=e.cellStyleProps,o=void 0===i?x.DEFAULT_CELL_STYLE_PROPS:i,r=t.semanticColors;return[v.getGlobalClassNames(w,t).cell,v.getFocusStyle(t),v.FontClassNames.small,{color:r.bodyText,position:"relative",display:"inline-block;",boxSizing:"border-box",padding:"0 "+o.cellRightPadding+"px 0 "+o.cellLeftPadding+"px",border:"none",lineHeight:"inherit",margin:"0",height:S,verticalAlign:"top",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left"}]};y.getStyles=function(e){var t,i,o,r=e.theme,n=e.className,s=e.isSelectAllHidden,a=e.isAllSelected,l=e.isResizingColumn,d=e.isSizing,c=e.isAllCollapsed,u=e.cellStyleProps,p=void 0===u?x.DEFAULT_CELL_STYLE_PROPS:u,m=r.semanticColors,h=r.palette,f=v.getGlobalClassNames(w,r),g={iconForegroundColor:m.bodySubtext,headerForegroundColor:m.bodyText,headerBackgroundColor:m.bodyBackground,dropdownChevronForegroundColor:h.neutralTertiary,resizerColor:h.neutralTertiaryAlt},b={opacity:1,transition:"opacity 0.3s linear"},_=y.getCellStyles(e);return{root:[f.root,{display:"inline-block",background:g.headerBackgroundColor,position:"relative",minWidth:"100%",verticalAlign:"top",height:S,lineHeight:S,whiteSpace:"nowrap",boxSizing:"content-box",paddingBottom:"1px",borderBottom:"1px solid "+m.bodyDivider,cursor:"default",userSelect:"none",selectors:(t={"&:hover $check":{opacity:1}},t[f.tooltipHost+" $checkTooltip"]={display:"block"},t)},a&&f.isAllSelected,s&&{selectors:{$cell$cellIsCheck:{visibility:"hidden"}}},l&&f.isResizingColumn,n],check:[{height:32},{selectors:(i={},i["."+C.IsFocusVisibleClassName+" &:focus"]={opacity:1},i)}],cellWrapperPadded:[{paddingRight:p.cellExtraRightPadding+p.cellRightPadding}],cellIsCheck:[_,f.cellIsCheck,{position:"relative",padding:0,margin:0,display:"inline-flex",alignItems:"center"},a&&{opacity:1}],cellIsGroupExpander:[_,{paddingLeft:"8px",paddingRight:"8px",width:"36px"}],cellIsActionable:[{selectors:{":hover":{color:m.bodyText,background:m.listHeaderBackgroundHovered},":active":{background:m.listHeaderBackgroundPressed}}}],cellIsEmpty:[{textOverflow:"clip"}],cellSizer:[f.cellSizer,v.focusClear(),{display:"inline-block",position:"relative",cursor:"ew-resize",bottom:0,top:0,overflow:"hidden",height:"inherit",background:"transparent",zIndex:1,width:16,selectors:{":after":{content:'""',position:"absolute",top:0,bottom:0,width:1,background:g.resizerColor,opacity:0,left:"50%"},":focus:after":b,":hover:after":b,"&$cellIsResizing:after":[b,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)"}]}}],cellIsResizing:[f.isResizing],cellSizerStart:[{margin:"0 -8px"}],cellSizerEnd:[{margin:0,marginLeft:-16}],collapseButton:[f.collapseButton,{textAlign:"center",transform:"rotate(-180deg)",transformOrigin:"50% 50%",transition:"transform 0.1s linear",width:20,outline:0,paddingRight:0},c&&{transform:"rotate(0deg)"},c&&f.isCollapsed],checkTooltip:[],sizingOverlay:[d&&{position:"absolute",left:0,top:0,right:0,bottom:0,cursor:"ew-resize",background:"rgba(255, 255, 255, 0)",selectors:(o={},o[v.HighContrastSelector]={background:"transparent","-ms-high-contrast-adjust":"none"},o)}],accessibleLabel:[v.hiddenContentStyle],dropHintCircleStyle:[f.dropHintCircleStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,height:9,width:9,borderRadius:"50%",marginLeft:-5,top:34,overflow:"visible",zIndex:10,border:"1px solid "+h.themePrimary,background:h.white}],dropHintCaretStyle:[f.dropHintCaretStyle,{display:"inline-block",visibility:"hidden",position:"absolute",top:22,left:-7.5,fontSize:16,color:h.themePrimary,overflow:"visible",zIndex:10}],dropHintLineStyle:[f.dropHintLineStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,top:-3,overflow:"hidden",height:37,width:1,background:h.themePrimary,zIndex:10}],dropHintStyle:[{display:"inline-block",position:"absolute"}]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.hidden=1]="hidden";e[e.visible=2]="visible"}(t.SelectAllVisibility||(t.SelectAllVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow",["require","exports","../../Utilities","./DetailsRow.base","./DetailsRow.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsRow=i.styled(o.DetailsRowBase,r.getStyles,void 0,{scope:"DetailsRow"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow.base",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.types","./DetailsRowCheck","../GroupedList/GroupSpacer","./DetailsRowFields","../../FocusZone","../../utilities/selection/interfaces","../../GroupedList","../../Utilities"],function(e,t,K,q,o,j,W,r,G,X,Z,J,Y,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var $=i.classNamesFunction(),n=function(i){K.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._cellMeasurer=j.createRef();t._focusZone=j.createRef();t._onRootRef=function(e){t._root=e?o.findDOMNode(e):void 0};t.state={selectionState:t._getSelectionState(e),columnMeasureInfo:void 0,isDropping:!1,groupNestingDepth:e.groupNestingDepth};t._droppingClassNames="";t._updateDroppingState=t._updateDroppingState.bind(t);t._onToggleSelection=t._onToggleSelection.bind(t);return t}e.prototype.componentDidMount=function(){var e=this.props.dragDropHelper;e&&(this._dragDropSubscription=e.subscribe(this._root,this._events,this._getRowDragDropOptions()));this._events.on(this.props.selection,J.SELECTION_CHANGE,this._onSelectionChanged);if(this.props.onDidMount&&this.props.item){this._hasMounted=!0;this.props.onDidMount(this)}};e.prototype.componentDidUpdate=function(e){var t=this.state,i=this.props,o=i.item,r=i.onDidMount,n=t.columnMeasureInfo;if(this.props.itemIndex!==e.itemIndex||this.props.item!==e.item||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root,this._events,this._getRowDragDropOptions()))}if(n&&0<=n.index&&this._cellMeasurer.current){var s=this._cellMeasurer.current.getBoundingClientRect().width;n.onMeasureDone(s);this.setState({columnMeasureInfo:void 0})}if(o&&r&&!this._hasMounted){this._hasMounted=!0;r(this)}};e.prototype.componentWillUnmount=function(){var e=this.props,t=e.item,i=e.onWillUnmount;i&&t&&i(this);if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}};e.prototype.componentWillReceiveProps=function(e){this.setState({selectionState:this._getSelectionState(e),groupNestingDepth:e.groupNestingDepth})};e.prototype.shouldComponentUpdate=function(e,t){if(this.props.useReducedRowRenderer){if(this.state.selectionState){var i=this._getSelectionState(e);if(this.state.selectionState.isSelected!==i.isSelected)return!0}return j.shallowCompare(this.props,e)}return!0};e.prototype.render=function(){var e=this.props,t=e.className,i=e.columns,o=e.dragDropEvents,r=e.item,n=e.itemIndex,s=e.onRenderCheck,a=void 0===s?this._onRenderCheck:s,l=e.onRenderItemColumn,d=e.selectionMode,c=e.viewport,u=e.checkboxVisibility,p=e.getRowAriaLabel,m=e.getRowAriaDescribedBy,h=e.checkButtonAriaLabel,f=e.checkboxCellClassName,g=e.rowFieldsAs,b=void 0===g?X.DetailsRowFields:g,_=e.selection,y=e.indentWidth,v=e.shimmer,C=e.compact,x=e.theme,w=e.styles,S=this.state,k=S.columnMeasureInfo,R=S.isDropping,D=S.groupNestingDepth,T=this.state.selectionState,I=T.isSelected,F=void 0!==I&&I,P=T.isSelectionModal,B=void 0!==P&&P,L=Boolean(o&&o.canDrag&&o.canDrag(r)),M=R?this._droppingClassNames?this._droppingClassNames:"is-dropping":"",E=p?p(r):void 0,A=m?m(r):void 0,N=_.canSelectItem(r),H=d===J.SelectionMode.multiple,O=d!==J.SelectionMode.none&&u!==W.CheckboxVisibility.hidden,V=d===J.SelectionMode.none?void 0:F,U=$(w,{theme:x,isSelected:F,canSelect:!H,anySelected:B,isCheckVisible:u===W.CheckboxVisibility.always,checkboxCellClassName:f,droppingClassName:M,className:t,compact:C}),z=q.createElement(b,{rowClassNames:U,columns:i,item:r,itemIndex:n,columnStartIndex:O?1:0,onRenderItemColumn:l,shimmer:v});return v?q.createElement("div",{className:j.css(O&&U.shimmerLeftBorder,!C&&U.shimmerBottomBorder)},z):q.createElement(Z.FocusZone,K.__assign({},j.getNativeProps(this.props,j.divProperties),{direction:Z.FocusZoneDirection.horizontal,ref:this._onRootRef,componentRef:this._focusZone,role:"row","aria-label":E,ariaDescribedBy:A,className:j.css(U.root),"data-is-focusable":!0,"data-selection-index":n,"data-item-index":n,"aria-rowindex":n+1,"data-is-draggable":L,draggable:L,"data-automationid":"DetailsRow",style:{minWidth:c?c.width:0},"aria-selected":V,allowFocusRoot:!0}),O&&q.createElement("div",{role:"gridcell","aria-colindex":1,"data-selection-toggle":!0,className:U.checkCell},a({selected:F,anySelected:B,title:h,canSelect:N,compact:C,className:U.check,theme:x})),q.createElement(G.GroupSpacer,{indentWidth:y,count:D-(this.props.collapseAllVisibility===Y.CollapseAllVisibility.hidden?1:0)}),r&&z,k&&q.createElement("span",{role:"presentation",className:j.css(U.cellMeasurer,U.cell),ref:this._cellMeasurer},q.createElement(b,{rowClassNames:U,columns:[k.column],item:r,itemIndex:n,columnStartIndex:(O?1:0)+i.length,onRenderItemColumn:l})),q.createElement("span",{role:"checkbox",className:j.css(U.checkCover),"aria-checked":F,"data-selection-toggle":!0}))};e.prototype.measureCell=function(e,t){var i=j.assign({},this.props.columns[e]);i.minWidth=0;i.maxWidth=999999;delete i.calculatedWidth;this.setState({columnMeasureInfo:{index:e,column:i,onMeasureDone:t}})};e.prototype.focus=function(e){void 0===e&&(e=!1);return!!this._focusZone.current&&this._focusZone.current.focus(e)};e.prototype._onRenderCheck=function(e){return q.createElement(r.DetailsRowCheck,K.__assign({},e))};e.prototype._getSelectionState=function(e){var t=e.itemIndex,i=e.selection;return{isSelected:i.isIndexSelected(t),isSelectionModal:!!i.isModal&&i.isModal()}};e.prototype._onSelectionChanged=function(){var e=this._getSelectionState(this.props);j.shallowCompare(e,this.state.selectionState)||this.setState({selectionState:e})};e.prototype._onToggleSelection=function(){this.props.selection.toggleIndexSelected(this.props.itemIndex)};e.prototype._getRowDragDropOptions=function(){var e=this.props,t=e.item,i=e.itemIndex,o=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:i,context:{data:t,index:i},canDrag:o.canDrag,canDrop:o.canDrop,onDragStart:o.onDragStart,updateDropState:this._updateDroppingState,onDrop:o.onDrop,onDragEnd:o.onDragEnd}};e.prototype._updateDroppingState=function(e,t){var i=this.state,o=i.selectionState,r=i.isDropping,n=this.props,s=n.dragDropEvents,a=n.item;e?s.onDragEnter&&(this._droppingClassNames=s.onDragEnter(a,t)):s.onDragLeave&&s.onDragLeave(a,t);r!==e&&this.setState({selectionState:o,isDropping:e})};return e}(j.BaseComponent);t.DetailsRowBase=n});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowFields",["require","exports","tslib","react","../../Utilities","./DetailsRow.styles"],function(e,t,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state=t._getState(e);return t}e.prototype.componentWillReceiveProps=function(e){this.setState(this._getState(e))};e.prototype.render=function(){var e=this.props,t=e.columns,o=e.columnStartIndex,r=e.shimmer,n=e.rowClassNames,i=e.cellStyleProps,s=void 0===i?c.DEFAULT_CELL_STYLE_PROPS:i,a=this.state.cellContent;return l.createElement("div",{className:n.fields,"data-automationid":"DetailsRowFields",role:"presentation"},t.map(function(e,t){var i=void 0===e.calculatedWidth?"auto":e.calculatedWidth+s.cellLeftPadding+s.cellRightPadding+(e.isPadded?s.cellExtraRightPadding:0);return l.createElement("div",{key:t,role:e.isRowHeader?"rowheader":"gridcell","aria-colindex":t+o+1,className:d.css(e.className,e.isMultiline&&n.isMultiline,e.isRowHeader&&n.isRowHeader,e.isIconOnly&&r&&n.shimmerIconPlaceholder,r&&n.shimmer,n.cell,e.isPadded?n.cellPadded:n.cellUnpadded),style:{width:i},"data-automationid":"DetailsRowCell","data-automation-key":e.key},a[t])}))};e.prototype._getState=function(e){var o=this,r=e.item,n=e.itemIndex,s=e.onRenderItemColumn,a=e.shimmer;return{cellContent:e.columns.map(function(e){var t;try{var i=e.onRender||s;t=i&&!a?i(r,n,e):o._getCellText(r,e)}catch(e){}return t})}};e.prototype._getCellText=function(e,t){var i=e&&t&&t.fieldName?e[t.fieldName]:"";null==i&&(i="");return i};return e}(d.BaseComponent);t.DetailsRowFields=i});define("office-ui-fabric-react/lib/utilities/decorators/withViewport",["require","exports","tslib","react","./BaseDecorator","../../Utilities"],function(e,t,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withViewport=function(i){return function(t){o.__extends(e,t);function e(e){var s=t.call(this,e)||this;s._root=a.createRef();s._updateViewport=function(e){var t=s.state.viewport,i=s._root.current,o=a.findScrollableParent(i),r=a.getRect(o),n=a.getRect(i);if(((n&&n.width)!==t.width||(r&&r.height)!==t.height)&&s._resizeAttempts<3&&n&&r){s._resizeAttempts++;s.setState({viewport:{width:n.width,height:r.height}},function(){s._updateViewport(e)})}else{s._resizeAttempts=0;e&&s._composedComponentInstance&&s._composedComponentInstance.forceUpdate()}};s._resizeAttempts=0;s.state={viewport:{width:0,height:0}};return s}e.prototype.componentDidMount=function(){this._onAsyncResize=this._async.debounce(this._onAsyncResize,500,{leading:!1});var e=a.getWindow(),t=this._root.current;if(e&&e.ResizeObserver){this._viewportResizeObserver=new e.ResizeObserver(this._onAsyncResize);this._viewportResizeObserver.observe(t)}else this._events.on(e,"resize",this._onAsyncResize);this.props.skipViewportMeasures||this._updateViewport()};e.prototype.componentWillUnmount=function(){this._events.dispose();this._viewportResizeObserver&&this._viewportResizeObserver.disconnect()};e.prototype.render=function(){var e=this.state.viewport,t=this.props.skipViewportMeasures||0<e.width&&0<e.height;return r.createElement("div",{className:"ms-Viewport",ref:this._root,style:{minWidth:1,minHeight:1}},t&&r.createElement(i,o.__assign({ref:this._updateComposedComponentRef,viewport:e},this.props)))};e.prototype.forceUpdate=function(){this._updateViewport(!0)};e.prototype._onAsyncResize=function(){this._updateViewport()};return e}(n.BaseDecorator)}});define("office-ui-fabric-react/lib/utilities/groupedList/GroupedListUtility",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GetGroupCount=function(e){var t=0;if(e)for(var i=e.slice(),o=void 0;i&&0<i.length;){++t;(o=i.pop())&&o.children&&i.push.apply(i,o.children)}return t}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:"ms-DetailsList",compact:"ms-DetailsList--Compact",isFixed:"is-fixed",isHorizontalConstrained:"is-horizontalConstrained",listCell:"ms-List-cell"};t.getStyles=function(e){var t,i,o=e.theme,r=e.className,n=e.isHorizontalConstrained,s=e.compact,a=e.isFixed,l=o.semanticColors,d=c.getGlobalClassNames(u,o);return{root:[d.root,{position:"relative",fontSize:c.FontSizes.small,background:l.listBackground,color:l.listText,selectors:(t={},t["& ."+d.listCell]={minHeight:38,wordBreak:"break-word"},t)},a&&[d.isFixed],s&&[d.compact,{selectors:(i={},i["."+d.listCell]={minHeight:32},i)}],n&&[d.isHorizontalConstrained,{overflowX:"auto",overflowY:"visible",WebkitOverflowScrolling:"touch"}],r],focusZone:[{display:"inline-block",minWidth:"100%",minHeight:1}]}}});define("odsp-next/controls/list/react/detailsList/ItemDetailsRow",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../../../../models/item/ItemType","../../../../dataSources/itemAutoRefresh/IItemAutoRefreshDataSource","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/base/BaseModel","../../../../resources/ProviderResourceKeys","./fields/MissingRequiredRenderer.key","../../../../models/item/RefreshMessageHelper","./fields/FieldMap","../../../../models/store/ItemsStore","../../../../dataSources/list/odb/ListDataSource","@ms/odsp-utilities/lib/scope/Scope","../../../../utilities/killSwitch/KillSwitch","../../../../utilities/features/Features","./fields/CustomFormatterRenderer","./fields/BaseText","@ms/odsp-utilities/lib/string/StringHelper","./ReactDetailsList.resx"],function(e,t,p,m,r,h,n,a,l,d,c,u,f,g,b,_,i,o,y,v,C,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=i.default.isActivated("98E9F91D-317E-4809-87C9-E25FCE1DC643","10/25/2017","listperf"),S=o.isFeatureEnabled(o.FilesThatNeedAttentionListView),k=o.isFeatureEnabled(o.ItemScopeAnimations),s=function(s){p.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.rowProps.item;t._scope=new _.default;t._async=t._scope.attach(new(e.resources.consume(a.asyncTypeResourceKey))(t));var o=e.resources.consume(l.observablesFactoryTypeResourceKey);t._observables=t._scope.attach(new o({owner:t}));t._itemObservable=t._observables.create(i);t._itemsStore=e.resources.consume(g.resourceKey);t._instrumentationProvider=e.resources.consume(d.instrumentation.optional);t._missingRequiredRenderer=e.resources.consume(c.resourceKey.optional);t._refreshMessageHelper=e.resources.consume(u.resourceKey);var r=t._refreshMessageHelper.getItemRefreshMessage(i.itemId);if(k&&r&&!r.deleted){t._alertRowUpdated();t._refreshMessageHelper.clearRefreshMessages();var n=t._async.setTimeout(function(){t.setState({oldItemData:null,isItemNew:!1,refreshAnimationTimeout:null})},2e3);t.state={isAvailable:!0,isItemNew:!0,oldItemData:null,refreshAnimationTimeout:n}}else t.state={isAvailable:!0,isItemNew:!1,oldItemData:null,refreshAnimationTimeout:null};return t}e.prototype.componentWillMount=function(){this.props.enableDeferredBehaviors&&!this.props.isGroupedList()&&this._setupDefaultClickAction()};e.prototype.componentDidMount=function(){if(this.props.enableDeferredBehaviors){this._recordItemRender();this._subscribeToItem()}if(o.isFeatureEnabled(o.SubscribeToItemPerRowInDetailsList)){var e=this._itemsStore.getItem(this.props.rowProps.item.key);e&&(this._itemSubscription=this._observables.subscribe(e,this._onItemUpdated))}};e.prototype.componentWillReceiveProps=function(e){var t=this;!e.enableDeferredBehaviors||this.props.enableDeferredBehaviors||this.props.isGroupedList()||this._setupDefaultClickAction();if(e.rowProps.item!==this.props.rowProps.item){this._alertRowUpdated();if(k){if(this.state.refreshAnimationTimeout){this._refreshMessageHelper.clearRefreshMessages();this._async.clearTimeout(this.state.refreshAnimationTimeout)}this.setState({oldItemData:this.props.rowProps.item,refreshAnimationTimeout:this._async.setTimeout(function(){t.setState({oldItemData:null,isItemNew:!1,refreshAnimationTimeout:null})},2e3)})}this._defaultClickAction&&this._itemObservable(e.rowProps.item)}};e.prototype.componentWillUpdate=function(e,t){t.isAvailable!==this.state.isAvailable&&this.props.forceUpdate()};e.prototype.componentDidUpdate=function(e){if(!e.enableDeferredBehaviors&&this.props.enableDeferredBehaviors){this._recordItemRender();this._subscribeToItem()}if(o.isFeatureEnabled(o.SubscribeToItemPerRowInDetailsList)&&e.rowProps.item.key!==this.props.rowProps.item.key){this._itemSubscription&&this._itemSubscription.dispose();var t=this._itemsStore.getItem(this.props.rowProps.item.key);t&&(this._itemSubscription=this._observables.subscribe(t,this._onItemUpdated))}};e.prototype.componentWillUnmount=function(){this._alertRowUpdated();this._scope.dispose();this._async.dispose()};e.prototype.shouldComponentUpdate=function(e,t){var i=e.rowProps,o=i.item,r=i.columns,n=i.itemIndex,s=this.props.rowProps,a=s.item,l=s.columns,d=s.itemIndex,c=this.state;if(w)return!0;if(o!==a||t.isAvailable!==c.isAvailable)return!0;if(o.key!==a.key)return!0;if(n!==d)return!0;if(i.selectionMode!==s.selectionMode||i.checkboxVisibility!==s.checkboxVisibility)return!0;if(!r||!l)return!0;if(r.length!==l.length)return!0;if(null!==this.state.oldItemData&&null===t.oldItemData||this.state.isItemNew!==t.isItemNew)return!0;if(i.rowFieldsAs)return!0;if(this.getCustomFormatterAdditionalClass(this.props)!==this.getCustomFormatterAdditionalClass(e))return!0;for(var u=0;u<r.length;u++){var p=r[u],m=l[u],h=p.data||{},f=m.data||{};if(p.key!==m.key||p.calculatedWidth!==m.calculatedWidth||p.minWidth!==m.minWidth||p.maxWidth!==m.maxWidth||h.customFormatter!==f.customFormatter||h.reactFieldRenderer!==f.reactFieldRenderer)return!0}return!1};e.prototype.render=function(){var e=this.props,t=e.onRender,i=e.rowProps,o=this.getCustomFormatterAdditionalClass(this.props);performance&&performance.mark&&performance.mark("DetailsRowWithAction: "+i.item.name);return t(p.__assign({},i,{className:r.css("od--hasContextMenu",o,{"od-DetailsRow--fresh":k&&this.state.isItemNew}),"data-automationid":i.item.name,onRenderItemColumn:this._onRenderColumn}))};e.prototype._alertRowUpdated=function(){var e=this._itemObservable.peek(),t=this._refreshMessageHelper.getItemRefreshMessage(e.itemId);if(t){var i="";switch(t.type){case n.ItemAutoRefreshChangeType.Add:i=x.strings.itemAdded;break;case n.ItemAutoRefreshChangeType.Update:i=x.strings.itemUpdated;break;case n.ItemAutoRefreshChangeType.Remove:i=x.strings.itemDeleted;break;default:return}var o=document.createElement("div");o.className="od-DetailsRow-accessible";o.setAttribute("aria-live","polite");o.textContent=C.format(i,e.displayName);document.body.appendChild(o);this._async.setTimeout(function(){try{document.body.removeChild(o)}catch(e){}},15e3)}};e.prototype._setupDefaultClickAction=function(){var e=this.props.defaultClickActionManager.DefaultClickAction,t=this._defaultClickAction=this._scope.attach(new e({item:this._itemObservable,userInvokedItem:!0,sourceEngagement:"ItemRow"}));this.setState({isAvailable:t.isAvailable.peek()})};e.prototype._recordItemRender=function(){var e=this.props.rowProps.item;this._instrumentationProvider&&e&&!e.isPlaceholder&&this._instrumentationProvider.userSeeItem(e)};e.prototype._subscribeToItem=function(){var t=this;this._defaultClickAction&&this._scope.attach(this._defaultClickAction.isAvailable.subscribe(function(e){t.setState({isAvailable:e})}))};e.prototype._onItemUpdated=function(e){var t=this.props.onItemUpdated;t&&t({item:e,index:this.props.rowProps.itemIndex})};e.prototype._onRenderColumn=function(e,t,i){var o=this.state.isAvailable,r=i.data;if(r){var n=e[r.key]||e.properties[r.key],s=n&&(!Array.isArray(n)||0<n.length),a=r.requiredForContentTypes&&r.requiredForContentTypes[e.contentTypeId]&&!s,l=r.internalName==="missingInfo"+b.NeedsAttentionViewId,d=S&&e.type!==h.default.Folder&&(a||l)?this._missingRequiredRenderer:r.reactFieldRenderer;if(!d)return null;var c={index:t,column:r,onItemInvoked:o?this.props.onItemInvoked:void 0,isDisabled:!o&&!this.props.selection.canSelectItem(e),itemSet:this.props.itemSet.peek(),resources:this.props.resources,fieldMap:this.props.resources.consume(f.resourceKey)},u=this.state.oldItemData;return k&&v.isCellChanged(u,e,r)?m.createElement("div",{className:"od-DetailsColumn-Refreshed"},m.createElement("div",{className:"od-DetailsColumn-Previous","aria-hidden":"true"},m.createElement(d,p.__assign({},c,{item:u}))),m.createElement("div",{className:"od-DetailsColumn-Current","data-automationid":"DetailsColumn-Current"},m.createElement(d,p.__assign({},c,{item:e})))):d(p.__assign({},c,{item:e}))}return null};e.prototype.getCustomFormatterAdditionalClass=function(e){var t=e.customFormatterClassExpression;return t?y.evaluateRowClass(t,e.rowProps.item,e.itemSet.peek(),e.resources):""};p.__decorate([r.autobind],e.prototype,"_onRenderColumn",null);return e}(m.Component);t.ItemDetailsRow=s});define("odsp-next/dataSources/itemAutoRefresh/IItemAutoRefreshDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Add=0]="Add";e[e.Update=1]="Update";e[e.Remove=2]="Remove"}(t.ItemAutoRefreshChangeType||(t.ItemAutoRefreshChangeType={}))});define("odsp-next/controls/list/react/detailsList/fields/MissingRequiredRenderer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./MissingRequiredRenderer",getModule:function(){return new t.default(function(e,t){i(["./MissingRequiredRenderer"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/list/react/detailsList/fields/FieldMap",["require","exports","@ms/odsp-utilities/lib/resources/Resources","./DotDotDotRenderer","./FileTypeIconRenderer","./FileSizeRenderer","./ImageSizeRenderer","./NameRenderer","./NameAndPathRenderer.key","./PinRenderer","./TextRenderer","./SharedRenderer","./UserRenderer","./LikeRenderer","./AttachmentsRenderer","./UrlRenderer","./ImageRenderer","./LookupRenderer","./DataBarRenderer","./DateRenderer","./TitleRenderer","./RatingRenderer","./TaxonomyRenderer","./WorkflowRenderer","./SharedWithRenderer","./CustomRenderer","./ComplianceRecordFlagRenderer","./ActivityRenderer.key","./ClientSideCustomRenderer.key","./FileActivityRenderer.key","./ShareHeroCommandRenderer","./ThumbnailRenderer","./LocationFieldRenderer"],function(e,t,i,o,r,n,s,a,l,d,c,u,p,m,h,f,g,b,_,y,v,C,x,w,S,k,R,D,T,I,F,P,B){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L={Activity:D.resourceKey,Attachments:h.resourceKey,AverageRating:C.resourceKey,Boolean:c.resourceKey,Choice:c.resourceKey,ClientSideCustom:T.resourceKey,ComplianceRecordFlag:R.resourceKey,Computed:c.resourceKey,Counter:c.resourceKey,Currency:c.resourceKey,Custom:k.resourceKey,DateTime:y.resourceKey,DotDotDot:o.resourceKey,FileActivity:I.resourceKey,FileIcon:r.resourceKey,FileSize:n.resourceKey,ImageSize:s.resourceKey,Hashtag:c.resourceKey,Hyperlink:f.resourceKey,Image:g.resourceKey,LikedBy:m.resourceKey,Likes:m.resourceKey,Lookup:b.resourceKey,MruName:l.resourceKey,PinCommand:d.resourceKey,Name:a.resourceKey,Note:c.resourceKey,Number:c.resourceKey,ProgressBar:_.resourceKey,RatedBy:C.resourceKey,Ratings:C.resourceKey,Shared:u.resourceKey,SharedWith:S.resourceKey,Tag:c.resourceKey,Taxonomy:x.resourceKey,Text:c.resourceKey,Title:v.resourceKey,User:p.resourceKey,WorkflowStatus:w.resourceKey,ShareCommand:F.resourceKey,Thumbnail:P.resourceKey,Location:B.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(L)})});define("odsp-next/controls/list/react/detailsList/fields/FileTypeIconRenderer",["require","exports","react","knockout","@ms/odsp-utilities/lib/async/Promise","../../../../../utilities/icons/IconHelper","@ms/odsp-utilities/lib/icons/IconSelector","../../../../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/modules/Modules","../../../../../utilities/icons/OfficeFileNameHelper","../../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer","../../../../../dataSources/base/AriaHelper","@ms/odsp-utilities/lib/resources/Resources","../../../../../utilities/complianceTag/ComplianceTagUtilities","../../../../fileTypeIcon/FileTypeIcon.css","../ReactDetailsList.css"],function(v,e,C,x,w,S,k,R,D,T,I,F,P,B,t,L){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var M;!function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"}(M||(M={}));function n(e){var t=e.item,i=e.resources,o=e.size;if(!t)return null;var r,n,s,a,l,d=t.properties,c=4===t.state.upload.status?k.genericFile:(r=t).type===R.default.Folder?k.getIconNameFromItem({extension:r.extension,isDocSet:r.isDocSet,listItem:r,sharingType:r.sharingType,type:r.type}):r.iconName,u=t.extension,p=i.consume(F.resourceKey.optional),m=t.iconUrl||e.preferAppIcon&&function(e,t){var i=e.appMap;if((!e.extension||".pdf"!==e.extension.toLowerCase())&&i){var o=I.getAppName(i),r=48<=t?48:16;if(o)return"undefined"==typeof __webpack_public_path__?v.toUrl("@ms/odsp-media/lib/images/apps/"+o.toLowerCase()+"_"+r+"x1.svg"):v("@ms/odsp-media/dist/media/images/apps/"+o+"_"+r+"x1.svg")}return}(t,o)||(s=u,(n=p)&&n.getFileTypeIconUrl(s,!0))||S.getIconUrl(i,c,o),h=(l=u,(a=p)&&a.getFileTypeName(l,!0))||B.getIconFieldAriaLabelForItem(t),f=function(e){var t=M.none,i=e.policyTip;if(i){var o=2==(2&i),r=1==(1&i);o?t=M.block:r&&(t=M.notify)}else e.isViolation?t=M.block:e.properties.CheckedOutUserId?t=M.checkOut:4===e.state.upload.status?t=M.notify:L.complianceRecordFlagValue(e)&&(t=M.record);return t}(t),g=t.overlayUrl;g||f===M.none||(g="undefined"==typeof __webpack_public_path__?v.toUrl("@ms/odsp-media/lib/images/overlays/"+f.toLowerCase()):v("@ms/odsp-media/dist/media/images/overlays/"+f));var b=d.isDisabled||e.isDisabled,_=B.getTooltipText(t),y=!!(1&t.policyTip);return C.createElement(P.FileTypeIconRenderer,{iconName:c,width:o,iconUrl:m,iconTitle:h,overlayUrl:g,isDisabled:b,tooltipText:_,ariaLabel:h,isClickable:y,onClick:function(e){!function(i,o,r){if(1&i.policyTip){D.Engagement.logData({name:"PolicyTip.LaunchFromListView"});T.loadModule({path:"../../../../../actions/PolicyTipAction",getModule:function(){return new w.default(function(e,t){v(["../../../../../actions/PolicyTipAction"],e,t)})}}).then(function(e){var t=new(o.injected(e))({item:x.observable(i)});t.execute(r)})}}(t,i,e)}})}e.renderFileTypeIcon=n;e.fileTypeIconRenderer=function(e){var t=e.item,i=e.column,o=e.isDisabled,r=e.resources;return n({item:t,size:i.minWidth||i.width,resources:r,isDisabled:o})};e.resourceKey=new t.ResourceKey({name:v("module").id,factory:new t.ConstantResourceFactory(e.fileTypeIconRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/FileSizeRenderer",["require","exports","react","@ms/odsp-utilities/lib/string/DriveSpaceHelper","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FileSizeRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,o,r,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileSizeRenderer=function(e){var t=e.item,i=e.column;return o.createElement(s.FileSizeRenderer,{size:t.size,isDisabled:!1,ariaLabel:n.getAriaLabel(i,r.default.getDisplayString(t.size,{ignoreZero:!0}))})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.fileSizeRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/FileSizeRenderer",["require","exports","react","./BaseText","@ms/odsp-utilities/lib/string/DriveSpaceHelper","./FileSizeRenderer.scss"],function(e,t,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileSizeRenderer=function(e){var t=e.size,i=e.isDisabled,o=e.ariaLabel,r=a.default.getDisplayString(t,{ignoreZero:!0});o||(o=r);return n.createElement(s.BaseText,{text:r,isDisabled:i})}});define("@ms/odsp-list-utilities/lib/Renderers/FileSizeRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"}])});define("odsp-next/controls/list/react/detailsList/fields/ImageSizeRenderer",["require","exports","react","@ms/odsp-list-utilities/lib/Renderers/ImageSizeRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.imageSizeRenderer=function(e){var t=e.item;return i.createElement(o.ImageSizeRenderer,{width:t.properties.ImageWidth,height:t.properties.ImageHeight})};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.imageSizeRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/ImageSizeRenderer",["require","exports","react","./BaseText"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImageSizeRenderer=function(e){var t=e.width+" x "+e.height;return i.createElement(o.BaseText,{text:t})}});define("odsp-next/controls/list/react/detailsList/fields/NameAndPathRenderer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./NameAndPathRenderer",getModule:function(){return new t.default(function(e,t){i(["./NameAndPathRenderer"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/list/react/detailsList/fields/TextRenderer",["require","exports","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/TextRenderer","@ms/odsp-utilities/lib/encoding/Sanitize","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","@ms/odsp-utilities/lib/resources/Resources","../ReactDetailsList.css"],function(e,t,d,c,u,p,m,h,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.textRenderer=function(e){var t,i=e.item,o=e.column,r=e.isDisabled,n=o.isAutoHyperLink||o.isAppendOnly||(o.fieldType===h.ColumnFieldType.Number||o.fieldType===h.ColumnFieldType.Currency)&&!o.isCalculated||o.isNote,s=c.getCellText(i,o);if(!s)return null;o.isNote&&s&&(o.isAppendOnly||(s=(s=m.default.encodeText(s)).replace(/\n/g,"<br>")));if(n){var a="";s&&(a=p.default.getTextFromHtml(s));t=c.getAriaLabel(o,a)}else t=c.getAriaLabel(o,s);var l=!1;o.fieldType===h.ColumnFieldType.Note&&s&&(255<s.length||4<s.split(/\r|\r\n|\n|<br>/).length)&&(l=!0);return d.createElement(u.TextRenderer,{text:s,isSafeToInnerHTML:n,isDisabled:i.properties.isDisabled||r,ariaLabel:t,isTruncated:l})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.textRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/TextRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","./BaseText","./TextRenderer.scss"],function(e,t,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextRenderer=function(e){var t=e.text,i=e.isSafeToInnerHTML,o=e.isDisabled,r=e.ariaLabel,n=e.isTruncated;r=r||t;return i?s.createElement("div",{className:a.css("od-FieldRenderer-text",{"is-truncated":n,"od-FieldRenderer--disabled":o}),dangerouslySetInnerHTML:{__html:t}}):s.createElement(l.BaseText,{className:"od-FieldRenderer-text",text:t,isDisabled:o,ariaLabel:r})}});define("@ms/odsp-list-utilities/lib/Renderers/TextRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:'.od-FieldRenderer-text{position:relative;white-space:normal}.od-FieldRenderer-text.is-truncated{height:126px;overflow:hidden;position:relative;height:98px;display:inline-block;overflow:hidden}.od-FieldRenderer-text.is-truncated:after{content:"";position:absolute;bottom:0;right:0;width:100%;height:4em}.ms-DetailsRow .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(0, 0, 0, 0), '},{theme:"listBackground",defaultValue:"#fff"},{rawString:" 100%)}.ms-DetailsRow.is-selected .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(0, 0, 0, 0), "},{theme:"listItemBackgroundChecked",defaultValue:"#eaeaea"},{rawString:" 100%)}.ms-DetailsRow:hover .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(0, 0, 0, 0), "},{theme:"listItemBackgroundHovered",defaultValue:"#f8f8f8"},{rawString:" 100%)}.ms-DetailsRow.is-selected:focus .od-FieldRenderer-text.is-truncated:after,.ms-DetailsRow.is-selected:hover .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(0, 0, 0, 0), "},{theme:"listItemBackgroundCheckedHovered",defaultValue:"#d0d0d0"},{rawString:" 100%)}"}])});define("odsp-next/controls/list/react/detailsList/fields/LikeRenderer",["require","exports","tslib","react","react","../../../../../resources/DataSourceResourceKeys","../../../../../resources/SPOResourceKeys","./FieldsRender.resx","./Like","../../../../../providers/item/ItemProvider","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","@ms/odsp-utilities/lib/resources/Resources","./Like.css"],function(e,t,o,r,i,a,s,n,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReactHTMLElement=i;t.likeRenderer=function(e){var t=e.item,i=e.resources;return r.createElement(p,{item:t,resources:i})};var p=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state=t._generateState(e);t._onLikeClicked=t._onLikeClicked.bind(t);return t}e.prototype.componentWillReceiveProps=function(e){this.setState(this._generateState(e))};e.prototype.render=function(){var e=this.state;return r.createElement(l.default,{likeTitle:n.strings.LikesCountText,likeCount:e.likeCount,isLiked:e.isLiked,isEnabled:e.isEnabled,onLikeClicked:this._onLikeClicked})};e.prototype._generateState=function(e){var t=e.item,i=e.resources.consume(s.pageContext),o=t.reputationProperties.LikedBy,r=!!o&&o.some(function(e){return Number(e.id)===i.userId}),n=!c.isCheckedOutByOther(t,i.userId);return{likeCount:Number(t.properties.LikesCount)||0,isEnabled:n,isLiked:r}};e.prototype._onLikeClicked=function(e){var t=this.state.likeCount;this.setState({likeCount:e?t-1:t+1,isLiked:!e});this._setLike(!e)};e.prototype._setLike=function(e){var t=this.props,i=t.item,o=t.resources,r=o.consume(a.rating),n=o.consume(d.resourceKey),s={item:i,like:e};return r.setLike(s).then(function(e){return n.invalidateItem(i.parentKey,{triggerFetch:!0})})};return e}(r.Component);t.resourceKey=new u.ResourceKey({name:e("module").id,factory:new u.ConstantResourceFactory(t.likeRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/Like",["require","exports","tslib","react","office-ui-fabric-react/lib/Styling","office-ui-fabric-react/lib/Utilities"],function(e,t,i,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.likeCount,i=e.likeTitle,o=e.isLiked,r=e.isEnabled;return n.createElement("div",{className:"od-Like","data-is-focusable":r,onClick:r?this._onClick:void 0},n.createElement("div",{className:a.css(o&&"od-Like-heartFull "+s.getIconClassName("HeartFill"),!o&&"od-Like-heartEmpty "+s.getIconClassName("Heart"),r&&"od-Like-enabled")}),n.createElement("span",{className:"od-Like-count"},t),n.createElement("span",{className:"od-Like-text"},i))};t.prototype._onClick=function(e){var t=this.props;t.onLikeClicked(t.isLiked);e.stopPropagation();e.preventDefault()};i.__decorate([a.autobind],t.prototype,"_onClick",null);return t}(n.Component);t.default=o});define("odsp-next/controls/list/react/detailsList/fields/Like.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Like{height:0;line-height:0}"}])});define("odsp-next/controls/list/react/detailsList/fields/AttachmentsRenderer",["require","exports","react","./BaseText","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.attachmentsRenderer=function(e){var t=e.item,i=e.column,o=n.getCellText(t,i);return r.createElement(n.BaseText,{text:o,column:i,noTextRender:!0},"1"===o&&r.createElement("span",{className:s.getIconClassName("Attach")}))};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.attachmentsRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/UrlRenderer",["require","exports","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/UrlRenderer","../../../../../utilities/features/Features","./NameFieldAddOnHelper","@ms/odsp-utilities/lib/resources/Resources","./UrlRenderer.css"],function(e,t,d,c,u,p,m,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.urlRenderer=function(e){var t=e.item,i=e.column,o=e.onItemInvoked,r=t.properties[i.key]||t[i.key],n="1"===t.properties.FSObjType,s=null;if(!r&&n&&(i.linkToItem||i.isLink)){r=t.displayName;s=function(e){o?o(t,null,e):e.preventDefault()}}else n=!1;if(!r&&!n)return d.createElement(c.BaseText,{column:i});var a=t.properties[i.key+".desc"]||r,l=d.createElement(u.UrlRenderer,{url:r,urlDisplay:a,ariaLabel:c.getAriaLabel(i,a),onClick:s,isFolder:n});p.isFeatureEnabled(p.EnableUpdatedFilesListView)&&p.isFeatureEnabled(p.FlipOnNewGridAndListExperiment)&&i.hasListItemMenu&&(l=m.nameFieldBuildAddOn({addHeroCommands:!0,fieldRenderer:l,fieldRendererProps:e,optionalRendererClass:"od-FieldRender-truncate"}));return l};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.urlRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/UrlRenderer",["require","exports","@ms/items-view/lib/private/components/fields/url/UrlField"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UrlRenderer=i.UrlField});define("@ms/items-view/lib/private/components/fields/url/UrlField",["require","exports","react","office-ui-fabric-react/lib/Link","./UrlField.scss"],function(e,t,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UrlField=function(e){var t=e.url,i=e.urlDisplay,o=e.ariaLabel,r=e.isImageUrl,n=e.isFolder,s=e.onClick;o=o||i;i||(i=t);n&&s||(s=function(e){Boolean(e)&&Boolean(e.target)&&Boolean(t)&&window.open(t,"_blank")});return n?a.createElement(l.Link,{"data-automationid":"FieldRenderer-url",href:i,onDragStart:c,onClick:s,title:i},i):r?a.createElement("div",{"data-automationid":"FieldRenderer-url",className:""+d.image,"data-is-focusable":"true",onClick:s},a.createElement("img",{src:t,title:i,className:""+d.imageDisplay})):a.createElement(l.Link,{"data-automationid":"FieldRenderer-url",className:""+d.urlField,href:t,onDragStart:c,title:i,target:"_blank"},i)};function c(e){e.preventDefault()}});define("@ms/items-view/lib/private/components/fields/url/UrlField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-DetailsRow-cell .ms-Link,.ms-DetailsRow-cell a.urlField_59888322,.ms-DetailsRow-cell a.urlField_59888322:visited{cursor:pointer;text-decoration:none;font-size:12px}.ms-DetailsRow-cell .ms-Link:hover,.ms-DetailsRow-cell a.urlField_59888322:hover,.ms-DetailsRow-cell a.urlField_59888322:visited:hover{text-decoration:underline}.image_59888322{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.imageDisplay_59888322{cursor:pointer;max-width:100%;max-height:100%}\n"}]);t.urlField="urlField_59888322";t.image="image_59888322";t.imageDisplay="imageDisplay_59888322"});define("odsp-next/controls/list/react/detailsList/fields/UrlRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-DetailsRow-cell .ms-Link,.ms-DetailsRow-cell a.od-FieldRender-display,.ms-DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:12px}.ms-DetailsRow-cell .ms-Link:hover,.ms-DetailsRow-cell a.od-FieldRender-display:hover,.ms-DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-DetailsRow-cell .od-FieldRenderer-MruBreadcrumb:hover{text-decoration:underline;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}"}])});define("odsp-next/controls/list/react/detailsList/fields/ImageRenderer",["require","exports","react","./BaseText","@ms/odsp-utilities/lib/resources/Resources","./ImageRenderer.css"],function(e,t,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.imageRenderer=function(e){var t=e.item,i=e.column,o=t.properties[i.key];if(!o)return n.createElement(s.BaseText,{column:i});var r=t.properties[i.key+".desc"];r||(r=o);return n.createElement("div",{className:"od-FieldRender-image","data-is-focusable":"true",onClick:function(e){e&&e.target&&o&&window.open(o,"_blank")}},n.createElement("img",{src:o,title:r,className:"od-FieldRender-imageDisplay"}))};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.imageRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/ImageRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}"}])});define("odsp-next/controls/list/react/detailsList/fields/LookupRenderer",["require","exports","react","../../../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../../iFrameDialog/IFrameDialog.key","./BaseText","../../../../../bindings/component/ControlBinding","@ms/odsp-list-utilities/lib/Renderers/LookupRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,s,a,l,d,c,u,p,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.lookupRenderer=function(e){var t=e.item,i=e.column,o=e.resources,r=t.properties[i.key];if(!r||Array.isArray(r)&&0===r.length)return s.createElement(c.BaseText,{column:i});if("string"==typeof r)return s.createElement(c.BaseText,{column:i,item:t});var n=r.map(function(e){return{lookupId:e.lookupId,lookupValue:e.lookupValue,ariaLabel:c.getAriaLabel(i,e.lookupValue)}});return s.createElement(p.LookupRenderer,{lookup:n,dispFormUrl:i.dispFormUrl,launchDialog:function(e){return o.consume(a.resourceKey).requestDialog({title:"",size:"Large",control:u.toSpecification(d.default,{componentUrl:e,showInDialog:!0,heightOffset:.5})}).wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})}})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.lookupRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/LookupRenderer",["require","exports","react","office-ui-fabric-react/lib/Link","./LookupRenderer.scss"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LookupRenderer=function(e){var i=this,t=e.lookup,o=e.launchDialog,r=e.dispFormUrl;return n.createElement("div",null,t.map(function(e,t){return n.createElement(s.Link,{className:"od-FieldRender od-FieldRender-lookup",onClick:function(e,t){var i=r;i+="&ID=";i+=e;o(i+="&RootFolder=*&IsDlg=1")}.bind(i,e.lookupId),"aria-label":e.ariaLabel,key:t},e.lookupValue+" ")}))}});define("@ms/odsp-list-utilities/lib/Renderers/LookupRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-DetailsRow-cell .od-FieldRender-lookup{display:block;max-width:100%}"}])});define("odsp-next/controls/list/react/detailsList/fields/DataBarRenderer",["require","exports","react","@ms/odsp-utilities/lib/resources/Resources","./DataBarRenderer.css"],function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e.progress,i=e.ariaLabel,o=t.maximum.peek()-t.minimum.peek(),r=t.current.peek()-t.minimum.peek(),n={width:(0===o?0:r/o*100)+"%"};return s.createElement("div",{className:"od-DataBarField-track","aria-label":i,title:i},s.createElement("div",{className:"od-DataBarField-value",style:n}))}t.baseDataBarRenderer=o;t.dataBarRenderer=function(e){return o({progress:e.item.properties.progress})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.dataBarRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/DataBarRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DataBarField-track{height:100%}.od-DataBarField-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";transition:width 267ms cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/list/react/detailsList/fields/DateRenderer",["require","exports","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/DateRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,s,a,l,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="dateModified";t.dateRenderer=function(e){var t,i=e.item,o=e.column,r=e.isDisabled;t=o.getValue?o.getValue(i):a.getCellText(i,o);var n=o.key===d&&(String(i.dateModifiedValue)||i.dateDeleted)||"";return s.createElement(l.DateRenderer,{text:t,dateValue:n,indicatorEnabled:o.key===d,isDisabled:i.properties.isDisabled||r,ariaLabel:a.getAriaLabel(o,t)})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.dateRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/DateRenderer",["require","exports","@ms/items-view/lib/private/components/fields/date/DateField"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateRenderer=i.DateField});define("@ms/items-view/lib/private/components/fields/date/DateField",["require","exports","react","./DateField.scss","../baseText/BaseTextField"],function(e,t,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateField=function(e){var t=e.text,i=e.dateValue,o=e.indicatorEnabled,r=e.isDisabled,n=e.ariaLabel;n=n||t;var s=!1,a="string"==typeof i?new Date(i):"number"==typeof i?new Date(i):new Date("");!isNaN(a.getTime())&&o&&Math.abs(Date.now()-a.getTime())<=36e5&&(s=!0);t||isNaN(a.getTime())||(t=a.toLocaleString());return l.createElement(c.BaseText,{"data-automationid":"FieldRenderer-date",text:"",ariaLabel:n,isDisabled:r},s&&l.createElement("span",{className:""+d.newItem},""),t)}});define("@ms/items-view/lib/private/components/fields/date/DateField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".newItem_3847bb4c{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";margin-right:3px}\n"}]);t.newItem="newItem_3847bb4c"});define("odsp-next/controls/list/react/detailsList/fields/TitleRenderer",["require","exports","react","./NameRenderer","../../../../../resources/SPOResourceKeys","../../../../../models/item/ItemType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./BaseText","@ms/odsp-list-utilities/lib/Renderers/TitleRenderer","@ms/odsp-utilities/lib/encoding/Sanitize","../../../../../utilities/features/Features","./NameFieldAddOnHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,h,f,g,b,_,y,v,C,i,x,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=i.isFeatureEnabled(i.EnableUpdatedFilesListView),S=i.isFeatureEnabled(i.FlipOnNewGridAndListExperiment);t.titleRenderer=function(e){var t,i=e.item,o=e.itemSet,r=e.column,n=e.resources,s=e.isDisabled,a=e.onItemInvoked,l=n.consume(g.listContext),d=l.rawListSchema&&l.rawListSchema.Field&&l.rawListSchema.HasTitle,c="LinkTitle"===r.internalName||"LinkTitleNoMenu"===r.internalName,u="LinkIssueIDNoMenu"===r.internalName&&"IssueID"===r.realFieldName&&i.properties?i.properties.ID:y.getCellText(i,r),p=C.default.getTextFromHtml(u);t=i.type===b.default.Folder||"1"===i.properties.FSObjType?function(e){var t=f.getLinkUrl({item:i,itemSet:o,resources:n});if(t){n.consume(_.navigation).navigateTo(t);e.preventDefault();e.stopPropagation()}}:function(e){a&&a(i,null,e)};var m=h.createElement(v.TitleRenderer,{text:u,hasTitle:!!d,isLinkTitle:c,onClick:t,isDisabled:i.properties.isDisabled||s,ariaLabel:y.getAriaLabel(r,p)});w&&S&&r.hasListItemMenu&&(m=x.nameFieldBuildAddOn({addHeroCommands:!0,fieldRenderer:m,fieldRendererProps:e,optionalRendererClass:"od-FieldRender-truncate"}));return m};t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.ConstantResourceFactory(t.titleRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/TitleRenderer",["require","exports","@ms/items-view/lib/private/components/fields/title/TitleField"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TitleRenderer=i.TitleField});define("@ms/items-view/lib/private/components/fields/title/TitleField",["require","exports","react","office-ui-fabric-react/lib/Link","./TitleField.scss","../baseText/BaseTextField"],function(e,t,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TitleField=function(e){var t=e.text,i=e.hasTitle,o=e.isLinkTitle,r=e.onClick,n=e.isDisabled,s=e.ariaLabel;s=s||t;var a=!0;i&&!o&&(a=!1);return a?i?l.createElement("div",{"data-automationid":"FieldRenderer-title",className:""+c.titleField,"data-is-focusable":"true",role:"button","aria-label":s,onClick:r,title:t,dangerouslySetInnerHTML:{__html:t}}):l.createElement(d.Link,{"data-automationid":"FieldRenderer-title","data-selection-invoke":!0,className:""+c.titleField,"aria-label":s,onClick:r,onDragStart:p,title:t},t):l.createElement(u.BaseText,{"data-automationid":"FieldRenderer-title",className:""+c.titleField,text:t,isDisabled:n,ariaLabel:s})};function p(e){e.preventDefault()}});define("@ms/items-view/lib/private/components/fields/title/TitleField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".titleField_e76d347e{display:inline-block}\n"}]);t.titleField="titleField_e76d347e"});define("odsp-next/controls/list/react/detailsList/fields/RatingRenderer",["require","exports","tslib","react","react","../../../../../resources/DataSourceResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","./FieldsRender.resx","./Rating","../../../../../providers/item/ItemProvider","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","@ms/odsp-utilities/lib/resources/Resources","./Rating.css"],function(e,t,o,s,i,a,c,l,d,u,p,m,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReactHTMLElement=i;t.ratingRenderer=function(e){var t=e.item,i=e.resources;return s.createElement(n,{item:t,resources:i})};var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state=t._generateState(e);t._onRatingClicked=t._onRatingClicked.bind(t);return t}e.prototype.componentWillReceiveProps=function(e){this.setState(this._generateState(e))};e.prototype.render=function(){var t=this,e=this.state,i=e.averageRating,o=e.userRatingCount,r=e.isEnabled,n=[1,2,3,4,5];return s.createElement(u.default,{maxRating:5,starTitles:n.map(function(e){return t._getElementTitle(e)}),starAriaLabels:n.map(function(e){return t._getAriaLabel(e)}),averageRating:i,ratingCountTitle:l.format(d.strings.RatedByCountTitle,o),ratingCount:o,isEnabled:r,onRatingClicked:this._onRatingClicked})};e.prototype._generateState=function(e){var t=e.item,i=e.resources.consume(c.pageContext),o=t.reputationProperties,r=-1,n=o.Ratings;n&&","===n.slice(-1)&&(n=n.slice(0,-1));var s=n?n.split(",").map(Number):[],a=o.RatedBy,l=!!a&&a.some(function(e,t){if(Number(e.id)===i.userId){r=s[t];return!0}return!1}),d=!m.isCheckedOutByOther(t,i.userId);return{averageRating:parseFloat(o.AverageRating)||0,userRatingCount:a&&a.length||0,isEnabled:d,hasUserRated:l,userRating:r,allRatings:s}};e.prototype._onRatingClicked=function(e){var t=this.state,i=t.hasUserRated,o=t.allRatings;this.setState({averageRating:this._computeAverageRating(e),userRatingCount:i?o.length:o.length+1});this._setRating(e)};e.prototype._getElementTitle=function(e){var t=this.state,i=t.hasUserRated,o=t.userRating;return t.isEnabled?i?l.format(d.strings.ModifyRatingTitle,o):l.format(d.strings.ApplyRatingTitle,e):l.format(d.strings.YourRatingTitle,o)};e.prototype._getAriaLabel=function(e){var t=this.state,i=t.averageRating,o=t.hasUserRated,r=t.userRating,n=t.isEnabled,s=0<i?l.pluralSelect(i,l.format(d.strings.AverageRatingAriaLabel,i),l.format(d.strings.AverageRatingPluralAriaLabel,i)):"";s+=o?l.format(d.strings.YourRatingTitle,r):"";return s+=n?l.format(d.strings.ApplyRatingTitle,e):""};e.prototype._setRating=function(e){var t=this.props,i=t.item,o=t.resources,r=o.consume(a.rating),n=o.consume(p.resourceKey),s={item:i,rating:e};return r.setRating(s).then(function(e){return n.invalidateItem(i.parentKey,{triggerFetch:!0})})};e.prototype._computeAverageRating=function(e){var t=this.state,i=t.hasUserRated,o=t.userRating,r=t.allRatings,n=r.reduce(function(e,t){return Number(e)+Number(t)},0),s=r.length;i?n-=o:s++;return(n+=e)/s};return e}(s.Component);t.ItemRating=n;t.default=n;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.ratingRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/Rating",["require","exports","tslib","react","office-ui-fabric-react/lib/Styling","office-ui-fabric-react/lib/Utilities"],function(e,t,i,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.state={hoveredRating:-1};return i}e.prototype.render=function(){var e=this.props,t=e.maxRating,i=e.averageRating,o=e.ratingCount,r=e.ratingCountTitle,n=e.starTitles,s=e.starAriaLabels,a=e.isEnabled,l=this.state.hoveredRating,d=[];i=-1===l?i:l;for(var c=0;c<t;c++){var u=c+1;d.push(p.createElement("div",{key:c,title:n[c],"aria-label":s[c],className:h.css(m.getIconClassName("FavoriteStarFill"),{"od-Rating-starEmpty":i<u,"od-Rating-starHalf":i<u&&c<i,"od-Rating-starFull":Math.floor(i)>=u,"od-Rating-starHover":a&&-1!==l&&u<=l,"od-Rating-enabled":a}),"data-is-focusable":String(!!a),onClick:a?this._onClick.bind(this,u):void 0,onMouseOver:a?this._onMouseOver.bind(this,u):void 0,onMouseOut:a?this._onMouseOut:void 0}))}return p.createElement("div",null,p.createElement("div",{className:"od-Rating"},d),p.createElement("span",{title:r,className:"od-Rating-count"},o))};e.prototype._onClick=function(e,t){this.props.onRatingClicked(e);t.stopPropagation();t.preventDefault()};e.prototype._onMouseOver=function(e,t){this.setState({hoveredRating:e})};e.prototype._onMouseOut=function(e){this.setState({hoveredRating:-1})};i.__decorate([h.autobind],e.prototype,"_onMouseOut",null);return e}(p.Component);t.default=o});define("odsp-next/controls/list/react/detailsList/fields/Rating.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Rating{display:inline-block}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{margin-top:-6px;margin-bottom:-20px}.od-Rating-count{line-height:21px}.ms-DetailsRow-cell.od-DetailsRow-cell--AverageRating{padding:0}"}])});define("odsp-next/controls/list/react/detailsList/fields/TaxonomyRenderer",["require","exports","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/TaxonomyRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.taxonomyRenderer=function(e){var t=e.item,i=e.column,o=t.properties[i.key];if(!o||Array.isArray(o)&&0===o.length)return n.createElement(s.BaseText,{column:i});!o||o instanceof Array||""===o||(o=[{Label:o.Label,TermID:o.TermID}]);var r=o.map(function(e){return{label:e.Label,termId:e.TermID,ariaLabel:s.getAriaLabel(i,e.Label)}});return n.createElement(a.TaxonomyRenderer,{terms:r})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.taxonomyRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/TaxonomyRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TaxonomyRenderer=function(e){var t=e&&e.terms||[];return i.createElement("div",null,t.map(function(e,t){return i.createElement("div",{className:o.css("od-UserField","od-FieldRender-nofill"),"data-is-focusable":!0,"aria-label":e.ariaLabel,key:t,title:e.label},i.createElement("span",{className:o.css("ms-noWrap","ms-imnSpan","ms-displayInlineBlock")},e.label))}))}});define("odsp-next/controls/list/react/detailsList/fields/WorkflowRenderer",["require","exports","react","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./BaseText","@ms/odsp-utilities/lib/resources/Resources","./UrlRenderer.css","./WorkflowRenderer.css"],function(e,t,s,a,l,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.workflowRenderer=function(e){var t=e.item,i=e.column,r=e.resources,o=t.properties[i.key];if(!o)return s.createElement(l.BaseText,{column:i});var n=function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelector("a");return{url:i.href,display:i.innerHTML}}(o);return s.createElement("a",{className:"ms-workflowStatus--linkText od-FieldRender-display od-FieldRender-display--link",href:n.url,title:n.url,target:"_self",onClick:function(e){var t=r.consume(a.navigation);if(e&&e.target){var i=e.currentTarget,o=null;"A"===i.tagName?o=i.href:"IMG"===i.tagName&&(o=i.src);t.navigateTo(o)}},dangerouslySetInnerHTML:{__html:n.display}})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.workflowRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/WorkflowRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-workflowStatus--linkText>span{font-size:12px}"}])});define("odsp-next/controls/list/react/detailsList/fields/SharedWithRenderer",["require","exports","tslib","react","./FieldsRender.resx","@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer","./BaseText","../../../../../utilities/features/Features","../../../../../resources/ControlResourceKeys","../../../../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,c,u,p,m,h,i,f,g,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=i.isFeatureEnabled(i.EnableUpdatedFilesListView),_=i.isFeatureEnabled(i.FlipOnNewGridAndListExperiment);t.sharedWithRenderer=function(e){var t,i,o,r=e.item,n=e.column,s=e.resources;if(Number(r.properties.PrincipalCount)<1)if(b&&_)t=p.strings.SharedFieldPrivate_Short;else{i="Lock";o=p.strings.SharedWithNoneIcon;t=p.strings.SharedWithNone_Short}else{i="People";o=p.strings.SharedWithSomeIcon;t=p.strings.SharingHintShared_Short}var a=s.consume(f.actionMap),l=s.consume(g.resourceKey).getItem(r.key),d={iconName:i,sharingString:t,imageAlt:o,ariaLabel:h.getAriaLabel(n,t),onClick:function(e){new(s.injected(a.ShowPermissionsAction))({item:l}).execute(e.nativeEvent)}};return u.createElement(m.SharedWithRenderer,c.__assign({},d))};t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.ConstantResourceFactory(t.sharedWithRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/CustomRenderer",["require","exports","tslib","react","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","@uifabric/utilities/lib/css","@ms/odsp-utilities/lib/resources/Resources","./CustomRenderer.css"],function(e,t,s,a,l,d,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.customRenderer=function(r){var e=r.column,n=e.customFields.length-1,t=e.customFields.map(function(e,t){var i=r.fieldMap[l.ColumnFieldType[e.fieldType]||"Text"],o=r.resources.consume(i);return a.createElement("span",{key:"field_"+t,className:d.css("od-FieldRenderer-custom",{"is-last-row":t===n})},a.createElement(o,s.__assign({},r,{column:e})))});return a.createElement("span",null,t)};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.customRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/CustomRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRenderer-custom{font-size:12px;line-height:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=ltr] .od-FieldRenderer-custom{float:left}html[dir=rtl] .od-FieldRenderer-custom{float:right}[dir=ltr] .od-FieldRenderer-custom{margin-right:10px}[dir=rtl] .od-FieldRenderer-custom{margin-left:10px}.od-FieldRenderer-custom.is-last-row{clear:both}.od-FieldRenderer-custom .od-FieldRenderer-name{font-size:17px;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("odsp-next/controls/list/react/detailsList/fields/ComplianceRecordFlagRenderer",["require","exports","react","../../../../../utilities/complianceTag/ComplianceTagUtilities","./BaseText","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceRecordFlagRenderer=function(e){var t=e.item,i=e.column,o=n.complianceRecordFlagValueAsYesNoString(t);return r.createElement(s.BaseText,{column:i,text:o})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.complianceRecordFlagRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/ActivityRenderer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ActivityRenderer",getModule:function(){return new t.default(function(e,t){i(["./ActivityRenderer"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/list/react/detailsList/fields/ClientSideCustomRenderer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ClientSideCustomRenderer",getModule:function(){return new t.default(function(e,t){i(["./ClientSideCustomRenderer"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/list/react/detailsList/fields/FileActivityRenderer.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./FileActivityRenderer",getModule:function(){return new t.default(function(e,t){i(["./FileActivityRenderer"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/list/react/detailsList/fields/ThumbnailRenderer",["require","exports","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/ThumbnailRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,r,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailRenderer=function(e){var t=e.item,i=e.column,o=t.thumbnail.getAligned({width:128,height:128},null);return r.createElement(s.ThumbnailRenderer,{linkUrl:t.openUrl,srcUrl:o?o.url:"",ariaLabel:n.getAriaLabel(i,t.displayName)})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.thumbnailRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/ThumbnailRenderer",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Image","./ThumbnailRenderer.scss"],function(e,t,s,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ThumbnailRenderer=function(e){var t=e.linkUrl,i=e.ariaLabel,o=e.altText,r=e.srcUrl,n={alt:o=o||i,width:"auto",height:"100%",shouldFadeIn:!0,role:"presentation"};return a.createElement(l.Link,{title:i,href:t},a.createElement(d.Image,s.__assign({},n,{className:"od-FieldRender-thumbnail",src:r})))}});define("@ms/odsp-list-utilities/lib/Renderers/ThumbnailRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-FieldRender-thumbnail{max-width:128px;height:128px;overflow:hidden;display:block;margin:0 auto;border:none}"}])});define("odsp-next/controls/list/react/detailsList/fields/LocationFieldRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","./BaseText","@ms/odsp-list-utilities/lib/Renderers/LocationFieldRenderer","@ms/odsp-utilities/lib/resources/Resources","../../../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/utilities/location/parseLocationString","../../../../../utilities/features/Features","../../../../../utilities/killSwitch/KillSwitch","../../../../../controls/personaCard/EasyLpc"],function(e,t,p,m,h,f,i,g,b,o,_,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=o.isFeatureEnabled(o.PeopleCardsReactComponent),C=o.isFeatureEnabled(o.PeopleCardsOnLoki);t.locationFieldRenderer=function(e){var t,i=e.item,o=e.column,r=e.resources,n=e.isDisabled;if(!(t=o.getValue?o.getValue(i):h.getCellText(i,o)))return null;var s=b.parseLocationString(t),a=s&&(s.DisplayName||s.Address&&s.Address.Street||""),l=s?s.LocationUri:void 0,d=i.properties.isDisabled||n,c=m.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-location":C||v,"od-FieldRenderer--disabled":d}),u=h.getAriaLabel(o,a);return s&&r.isExposed(g.pageContext)&&!_.default.isActivated("3f3b9808-5ac4-446c-b8d3-7d61be3da609","2/20/2018","Use new LPC")&&r.consume(g.pageContext).isSPO?p.createElement(y.EasyLpc,{resourceScope:r,personaType:"Location",identifier:"",locationId:l,loggingData:{name:"LocationFieldRenderer.LPC.Click"},placeHolder:p.createElement("span",{className:c},p.createElement(f.LocationRenderer,{displayName:a,locationId:l}))},p.createElement("span",{className:c,"data-is-focusable":!0,role:"button","aria-label":u},p.createElement(f.LocationRenderer,{displayName:a,locationId:l}))):p.createElement(f.LocationRenderer,{displayName:a,locationId:l})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.locationFieldRenderer)})});define("@ms/odsp-list-utilities/lib/Renderers/LocationFieldRenderer",["require","exports","@ms/items-view/lib/private/components/fields/location/LocationField"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LocationRenderer=i.LocationField});define("@ms/items-view/lib/private/components/fields/location/LocationField",["require","exports","react","../text/TextField"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LocationField=function(e){return e.displayName?i.createElement(o.TextField,{text:e.displayName}):null}});define("@ms/items-view/lib/private/components/fields/text/TextField",["require","exports","react","office-ui-fabric-react/lib/Utilities","../baseText/BaseTextField","../Field.scss","./TextField.scss"],function(e,t,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextField=function(e){var t,i=e.text,o=e.isSafeToInnerHTML,r=e.isDisabled,n=e.ariaLabel,s=e.isTruncated;i=i||"";n=n||i;return o?a.createElement("div",{className:l.css("od-FieldRenderer-text",(t={"is-truncated":s||!1},t[""+c.disabledField]=r||!1,t)),dangerouslySetInnerHTML:{__html:i}}):a.createElement(d.BaseText,{className:"od-FieldRenderer-text",text:i,isDisabled:r,ariaLabel:n})}});define("@ms/items-view/lib/private/components/fields/text/TextField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:'.od-FieldRenderer-text{position:relative;white-space:normal}.od-FieldRenderer-text.is-truncated{height:126px;overflow:hidden;position:relative;height:98px;display:inline-block;overflow:hidden}.od-FieldRenderer-text.is-truncated:after{content:"";position:absolute;bottom:0;right:0;width:100%;height:4em}.ms-DetailsRow .od-FieldRenderer-text.is-truncated:after{background:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,0)), to('},{theme:"listBackground",defaultValue:"#ffffff"},{rawString:"));background:linear-gradient(to bottom, rgba(0,0,0,0), "},{theme:"listBackground",defaultValue:"#ffffff"},{rawString:" 100%)}.ms-DetailsRow.is-selected .od-FieldRenderer-text.is-truncated:after{background:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,0)), to("},{theme:"listItemBackgroundChecked",defaultValue:"#eaeaea"},{rawString:"));background:linear-gradient(to bottom, rgba(0,0,0,0), "},{theme:"listItemBackgroundChecked",defaultValue:"#eaeaea"},{rawString:" 100%)}.ms-DetailsRow:hover .od-FieldRenderer-text.is-truncated:after{background:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,0)), to("},{theme:"listItemBackgroundHovered",defaultValue:"#f8f8f8"},{rawString:"));background:linear-gradient(to bottom, rgba(0,0,0,0), "},{theme:"listItemBackgroundHovered",defaultValue:"#f8f8f8"},{rawString:" 100%)}.ms-DetailsRow.is-selected:hover .od-FieldRenderer-text.is-truncated:after,.ms-DetailsRow.is-selected:focus .od-FieldRenderer-text.is-truncated:after{background:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,0)), to("},{theme:"listItemBackgroundCheckedHovered",defaultValue:"#d0d0d0"},{rawString:"));background:linear-gradient(to bottom, rgba(0,0,0,0), "},{theme:"listItemBackgroundCheckedHovered",defaultValue:"#d0d0d0"},{rawString:" 100%)}\n"}])});define("@ms/odsp-datasources/lib/utilities/location/parseLocationString",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.parseLocationString=function(e){if(e){if("string"!=typeof e)return e;var t=JSON.parse(e);if(t&&0!==Object.getOwnPropertyNames(t).length)return t}}});define("odsp-next/dataSources/list/odb/ListDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-datasources/lib/models/view/View","../../base/odb/DataSource","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../url/odb/ApiUrlHelper","../../url/odb/ItemUrlHelper","../../url/odb/UrlQueryKeys","../../../models/list/ViewIdentifier","../../../utilities/features/Features","../../../utilities/list/ListFilterHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","../../../resources/SPOResourceKeys"],function(e,t,i,r,l,o,a,n,s,d,c,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NeedsAttentionViewId="f9ebc8b2-a976-48f0-a8fa-0846164c0466";var b=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(","),_=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,t.pageContext)||this;i._apiUrlHelper=t.apiUrlHelper;i._itemUrlHelper=t.itemUrlHelper;return i}e.prototype.getView=function(e,t){var i=this;return this.getData(function(){return i._getViewApiUrl(e,t).oDataParameter("$select",b).toString()},function(e){var t=JSON.parse(e);return i._viewFromServerView(t.d,!0)},"GetView",null,"GET")};e.prototype.getViews=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(e).segment("Views").oDataParameter("$select",b).toString()},function(e){return JSON.parse(e).d.results.map(function(e){return i._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},"GetViews",null,"GET")};e.prototype.createView=function(e,t){var i,o=this,r=e.viewParams,n=e.sourceView,s=r.useFiltersInViewXml?void 0:this._getFilterParams(r),a=!1,l=!1,d=!1,c=!1;return h.Qos.instrumentPromise({name:"ListDataSource.CreateView"},function(){return o._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");i=e;a=!0;if(s){c=!0;return o._saveLegacyFilters(i,s,t)}}).then(function(){l=!0;if(n.scope){c=!0;return o.modifyView({id:i.id,scope:n.scope},t)}}).then(function(){d=!0;return c?o.getView({id:i.id},t):i}).then(null,function(e){a&&s&&!l&&o.deleteView(i.id,t);return e})},null,function(e){return m.default.isCanceled(e)?{resultType:h.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:h.ResultTypeEnum.Failure,resultCode:a?l?d?c?"SecondGetView":"Unknown":"SaveScope":"SaveFilters":"CreateView",error:e}})};e.prototype.saveView=function(e,t,i){var o=this,r=e.sourceView,n=e.viewParams,s=e.updateViewXml,a=n.useFiltersInViewXml?void 0:this._getFilterParams(n),l=!1,d=!1;return h.Qos.instrumentPromise({name:"ListDataSource.SaveView"},function(){return o._setViewXml(e,t,i).then(function(){l=!0;if(a)return o._saveLegacyFilters(r,a,t)}).then(function(){d=!0;return s?o.getView({id:r.id},t):null}).then(function(e){s&&e&&(r.baseViewXml=e.baseViewXml);return{}})},null,function(e){return m.default.isCanceled(e)?{resultType:h.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:h.ResultTypeEnum.Failure,resultCode:l?d?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}}).then(function(){})};e.prototype.deleteView=function(e,t){var i=this;return this.getData(function(){return i._getViewApiUrl({id:e},t).toString()},function(){},"DeleteView",null,"POST",{"X-HTTP-Method":"DELETE"})};e.prototype.modifyView=function(e,t){var i=this,o={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};"number"==typeof e.scope&&(o.Scope=e.scope);return this.getData(function(){return i._getViewApiUrl({id:e.id},t).toString()},function(e){return e},"ModifyView",function(){return JSON.stringify(o)},"PATCH",{"X-HTTP-Method":"PATCH"})};e.prototype.createMappedView=function(e,t,i){var o=this,r={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.getData(function(){return o.getListApiUrl(i).segment("CreateMappedView").toString()},function(e){var t=JSON.parse(e);return o._viewFromServerView(t.d)},"CreateMappedView",function(){return JSON.stringify(r)},"POST")};e.prototype.getMappedApp=function(e,t,i){var o=this;return this.getData(function(){return o.getListApiUrl(i).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString()},function(e){return o.appSynchronizationResultFromMappedApps(e,!0)},"GetMappedApp",function(){return JSON.stringify({appId:e,visualizationAppTarget:t})},"POST")};e.prototype.getMappedApps=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString()},function(e){return i.appSynchronizationResultFromMappedApps(e,!1)},"GetMappedApps",function(){return JSON.stringify({visualizationAppTarget:e})},"POST")};e.prototype.publishMappedView=function(e,t,i){var o=this;return this.getData(function(){return o.getListApiUrl(i).segment("PublishMappedView").toString()},function(e){var t=JSON.parse(e);return o._viewFromServerView(t.d)},"PublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};e.prototype.unpublishMappedView=function(e,t,i){var o=this;return this.getData(function(){return o.getListApiUrl(i).segment("UnpublishMappedView").toString()},function(e){var t=JSON.parse(e);return o._viewFromServerView(t.d)},"UnpublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};e.prototype.getFlowTemplates=function(e,t){var i=this,o=t&&u.isFeatureEnabled(u.FlowTemplateVersioning)?function(){return JSON.stringify({category:t})}:null;return this.getData(function(){return i.getListApiUrl(e).segment("SyncFlowTemplates").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowTemplates",o,"POST",null,null,null,!0)};e.prototype.getFlowInstance=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(t).segment("SyncFlowInstance").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowInstance",function(){return JSON.stringify({flowID:e})},"POST",null,null,null,!0)};e.prototype.getFlowInstances=function(e){var t=this;return this.getData(function(){return t.getListApiUrl(e).segment("SyncFlowInstances").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowInstances",null,"POST",null,null,null,!0)};e.prototype.getFlowCallbackUrl=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowCallbackUrl",function(){return JSON.stringify({flowId:e})},"POST",null,null,null,!0)};e.prototype.modifyFieldProperties=function(e,t){var i=this,o=e.id,r={__metadata:{type:"SP.Field"},Title:e.displayName,SchemaXml:e.fieldDescription,ShowInFiltersPane:e.showInFiltersPane};return this.getData(function(){return i.getListApiUrl(t).method("Fields",o).toString()},function(e){return null},"ModifyFieldProperties",function(){return JSON.stringify(r)},"POST",{"X-HTTP-Method":"MERGE"})};e.prototype.setContentApproval=function(e,t){var i=this,o={__metadata:{type:"SP.List"},EnableModeration:e};return this.getData(function(){return i.getListApiUrl(t).toString()},function(e){return null},"SetContentApproval",function(){return JSON.stringify(o)},"POST",{"IF-MATCH":"*","X-HTTP-Method":"MERGE"})};e.prototype.appSynchronizationResultFromMappedApps=function(e,t){var i=this,o=JSON.parse(e),r=o&&o.d;if(!r)return null;var n=[];r.AppMappedViews&&r.AppMappedViews.results&&(n=r.AppMappedViews.results.map(function(e){return i._viewFromServerView(e)}));var s=null;try{s=JSON.parse(r.SynchronizationData);(t?s&&s.name&&s.properties:s&&s.value)||(s={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var a=t?[s]:s.value,l=0,d=a;l<d.length;l++){var c=d[l].properties;c.isPrivate=!c.permissions||!c.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:n,synchronizationData:o.d.SynchronizationData,synchronizationDataObject:s,synchronizationStatus:o.d.SynchronizationStatus}};e.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};e.prototype.getDataSourceName=function(){return"ListDataSource"};e.prototype._addView=function(e,t){var i=this,o=e.title,r=e.sourceView,n=e.viewParams,s=e.isPublic,a=this._combineViewParamsAndXml(r,n);a.prepareForSaving();return this.getData(function(){return i.getListApiUrl(t).segment("Views").segment("Add").toString()},function(e){var t=JSON.parse(e);return new l.default(t.d)},"AddView",function(){return JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:o,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:r.getEffectiveFieldNames()},Query:a.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!s,RowLimit:r.rowLimit}})})};e.prototype._combineViewParamsAndXml=function(e,t){var i=new l.default(e.getEffectiveViewXml());if(t){if(t.sortField){var o={fieldName:t.sortField,isAscending:"false"!==t.isAscending};i.updateSort(o,{overwriteAll:!0})}t.groupBy&&i.updateGroupBy({group1:{fieldName:t.groupBy,isAscending:!0}});if(u.isFeatureEnabled(u.SaveColumnResize)){var r=localStorage.getItem("SPColumnSize-Unsaved-"+e.id);if(r){i.updateColumnWidths(JSON.parse(r));localStorage.removeItem("SPColumnSize-Unsaved-"+e.id)}}if(u.isFeatureEnabled(u.FormatViewPane)){var n=e.customFormatter;i.updateCustomFormatter(n)}}return i};e.prototype._getFilterParams=function(e){for(var t={},i=!1,o=0,r=Object.keys(e||{});o<r.length;o++){var n=r[o];if(d.filterKeyRegex.test(n)){i=!0;t[n]=e[n]}}return i?t:void 0};e.prototype._saveLegacyFilters=function(e,t,i){var o=this;return this.getData(function(){return o.getListApiUrl(i).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:o._pageContext.webAbsoluteUrl+p.default.getInplviewHash(e.id,t)}).toString()},function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},"SaveViewFilters")};e.prototype._setViewXml=function(e,t,i){var o=this,r=e.sourceView,n=e.viewParams,s=this._combineViewParamsAndXml(r,n);s.prepareForSaving();return r.isDirty()||s.isDirty()?this.getData(function(){return o._getViewApiUrl({id:r.id},t,i).method("SetViewXml").toString()},function(){return null},"UpdateView",function(){return JSON.stringify({viewXml:s.getEffectiveViewXml()})}):m.default.wrap()};e.prototype._getViewApiUrl=function(e,t,i){return u.isFeatureEnabled(u.NewDocumentTemplates)&&i?this.getListApiUrl(t).segment("DefaultView"):c.isViewById(e)?this.getListApiUrl(t).method("Views",e.id):c.isViewByUrl(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};e.prototype._viewFromServerView=function(e,t,i){if(e.ViewType&&e.Id){var o=u.isFeatureEnabled(u.PowerApps)&&l.default.isAppView(e),r=e.Hidden&&!o,n=i===a.default.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!r&&!n){var s=new l.default(e);if(s.viewType)return s}}return null};e.dependencies=i.__assign({},r.default.dependencies,{pageContext:g.pageContext,apiUrlHelper:n.resourceKey,itemUrlHelper:s.resourceKey});return e}(o.default);t.default=_;t.resourceKey=f.createResolvedResourceKey(e("module").id,_)});define("@ms/odsp-datasources/lib/models/view/View",["require","exports","../../interfaces/view/IViewArrangeInfo","@ms/odsp-utilities/lib/guid/Guid","../../utilities/caml/CamlConstants","../../utilities/caml/CamlParsingBasic","../../utilities/caml/CamlUtilities","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/domUtils/DomUtils"],function(e,t,h,n,f,i,g,o,u,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;window.XMLSerializer&&(a=new XMLSerializer);var r=function(){function r(e){if("string"!=typeof e){var t=e;this.id=n.default.normalizeLower(t.Id,!1);this.title=t.Title;this.isDefault=t.DefaultView;this.isHidden=t.Hidden;this.isPersonal=!!t.PersonalView;this.isReadOnly=t.ReadOnlyView;this.modifiedInEditor=t.EditorModified;this.rowLimit=t.RowLimit;this.scope=t.Scope||0;this.serverRelativeUrl=t.ServerRelativeUrl;this.baseViewId=t.BaseViewId;this.baseViewXml=t.ListViewXml;this.customFormatter=t.CustomFormatter;var i=t.TabularView,o=void 0===i||i;this.tabularView=o;if(r.isAppView(t)){this.isHidden=!1;this.viewType=134217728;this.visualizationInfo=t.VisualizationInfo}else if(t.ViewType)switch(t.ViewType.toLowerCase()){case"html":this.viewType=1;break;case"grid":this.viewType=2048;break;case"calendar":this.viewType=524288;break;case"recurrence":this.viewType=8193;break;case"chart":this.viewType=131072;break;case"gantt":this.viewType=67108864}}else this.baseViewXml=e}r.isAppView=function(e){return!!(e&&e.Hidden&&e.VisualizationInfo&&2===e.VisualizationInfo.VisualizationType&&e.VisualizationInfo.VisualizationAppInfo&&e.VisualizationInfo.VisualizationAppInfo.Id)};r.prototype.canUserEdit=function(e){if(!e||this.isReadOnly)return!1;var t=e.managePersonalViews&&this.isPersonal;return e.manageLists||t};Object.defineProperty(r.prototype,"baseViewXml",{get:function(){return this._baseViewXml},set:function(e){this._baseViewXml=e;this.clearXmlOverrides()},enumerable:!0,configurable:!0});r.prototype.getEffectiveViewXml=function(){return this.isDirty()&&this._viewDom?a.serializeToString(this._viewDom.view):this._baseViewXml};r.prototype.getEffectiveQueryXml=function(e){this._ensureDom();if(this._viewDom){return this._viewDom.query?e?a.serializeToString(this._viewDom.query):(this._viewDom.where?a.serializeToString(this._viewDom.where):"")+(this._viewDom.orderBy?a.serializeToString(this._viewDom.orderBy):"")+(this._viewDom.groupBy?a.serializeToString(this._viewDom.groupBy):""):e?"<Query/>":""}};r.prototype.updateColumnWidths=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("ColumnWidth"),i=0<t.length;this._viewDom.columnWidth=i?t[0]:this._xmlDoc.createElement(f.CamlTags.columnWidth);for(var o in e){var r=e[o],n=this._viewDom.columnWidth.querySelector("[Name="+o+"]");if(n)n.setAttribute(f.CamlAttributes.width,r);else{var s=g.getFieldRefDom(this._xmlDoc,{fieldName:o});s.setAttribute(f.CamlAttributes.width,r);this._viewDom.columnWidth.appendChild(s)}}i?this._viewDom.view.replaceChild(this._viewDom.columnWidth,t[0]):this._viewDom.view.appendChild(this._viewDom.columnWidth);this.setIsDirty(!0,h.ArrangeInfoType.columnWidth)};r.prototype.updateCustomFormatter=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("CustomFormatter"),i=0<t.length;this._viewDom.customFormatter=i?t[0]:this._xmlDoc.createElement(f.CamlTags.customFormatter);this._viewDom.customFormatter.textContent=e;i?this._viewDom.view.replaceChild(this._viewDom.customFormatter,t[0]):this._viewDom.view.appendChild(this._viewDom.customFormatter);this.setIsDirty(!0,h.ArrangeInfoType.customFormatter)};r.prototype.updateNewDocumentTemplates=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName(f.CamlTags.newDocumentTemplates),i=0<t.length;this._viewDom.newDocumentTemplates=i?t[0]:this._xmlDoc.createElement(f.CamlTags.newDocumentTemplates);this._viewDom.newDocumentTemplates.textContent=e;i?this._viewDom.view.replaceChild(this._viewDom.newDocumentTemplates,t[0]):this._viewDom.view.appendChild(this._viewDom.newDocumentTemplates);this.setIsDirty(!0,h.ArrangeInfoType.newDocumentTemplates)};r.prototype.getEffectiveFieldNames=function(){this._ensureDom();return this._viewDom&&this._viewDom.viewFields?i.parseViewFields(this._viewDom.viewFields):void 0};r.prototype.isDirty=function(e){return"number"==typeof e?!!this._modificationTypes&&-1!==this._modificationTypes.indexOf(e):this._isDirty};r.prototype.setIsDirty=function(e,t){(this._isDirty=e)?"number"==typeof t&&-1===this._modificationTypes.indexOf(t)&&this._modificationTypes.push(t):this._modificationTypes=[]};r.prototype.hasParseError=function(){return this._hasParseError};r.prototype.getDomParts=function(){this._ensureDom();return this._viewDom};r.prototype.clearXmlOverrides=function(){this._hasParseError=!1;this._xmlDoc=void 0;this._viewDom=void 0;this.setIsDirty(!1)};r.prototype.prepareForSaving=function(){this._ensureDom();if(this._viewDom&&this._viewDom.where)for(var e=this._viewDom.where.querySelectorAll("[id]"),t=0;t<e.length;t++){e[t].removeAttribute("id");this._isDirty||(this._isDirty=!0)}};r.prototype.updateSort=function(e,t){void 0===t&&(t={});this._ensureDom();var i=t.removeSort,o=t.overwriteAll,r=t.prepend,n=!e&&o;if(this._viewDom&&(n||e)&&(!i||this._viewDom.orderBy)){var s=this._viewDom.orderBy;if(n){s&&this._viewDom.query.removeChild(s);this._viewDom.orderBy=void 0;this.setIsDirty(!0,h.ArrangeInfoType.sorts)}else{var a=!1;if(!s&&!n){s=this._viewDom.orderBy=this._xmlDoc.createElement(f.CamlTags.orderBy);this._viewDom.query.appendChild(s);a=!0}var l=s.querySelector(u.format(f.CamlConstants.fieldNameQuery,e.fieldName));if(i){if(l){s.removeChild(l);a=!0;if(!s.childElementCount){this._viewDom.query.removeChild(s);this._viewDom.orderBy=void 0}}}else{a=!0;l&&g.updateBooleanAttr(l,f.CamlAttributes.ascending,e.isAscending);var d=void 0;if(o){for(var c=s.lastChild;c;c=s.lastChild)s.removeChild(c);d=!0}else d=!l;if(d){l=l||g.getFieldRefDom(this._xmlDoc,e);r?s.insertBefore(l,s.firstChild):s.appendChild(l)}}a&&this.setIsDirty(!0,h.ArrangeInfoType.sorts)}}};r.prototype.updateGroupBy=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.query,i=this._viewDom.groupBy;if(e&&e.group1&&e.group1.fieldName){var o,r,n=e.isCollapsed,s=e.group1,a=e.group2;if(!i){this._viewDom.groupBy=i=this._xmlDoc.createElement(f.CamlTags.groupBy);t.appendChild(i)}g.updateBooleanAttr(i,f.CamlAttributes.collapse,n);0<i.childElementCount&&(r=(o=i.firstElementChild).nextElementSibling);g.replaceField(this._xmlDoc,s,o,i);a&&a.fieldName&&a.fieldName!==s.fieldName?g.replaceField(this._xmlDoc,a,r,i):r&&i.removeChild(r);this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}else if(i){t.removeChild(i);this._viewDom.groupBy=void 0;this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}}};r.prototype.updateGroupByCollapseAttribute=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.groupBy;t&&g.updateBooleanAttr(t,f.CamlAttributes.collapse,e);this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}};r.prototype.updateField=function(e,t){this._ensureDom();if(this._viewDom&&e){var i=!1,o=this._viewDom.viewFields,r=o.querySelector(u.format(f.CamlConstants.fieldNameQuery,e));if(r){i=!0;o.removeChild(r)}if("number"==typeof t){i=!0;r||(r=g.getFieldRefDom(this._xmlDoc,{fieldName:e}));t>=o.childElementCount?o.appendChild(r):0<=t&&s.default.insertAtIndex(o,r,t,f.CamlTags.fieldRef)}i&&this.setIsDirty(!0,h.ArrangeInfoType.fieldNames)}};r.prototype.replaceFields=function(e,t){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){for(var i={},o=0;o<e.length;o++){i[e[o]]={index:o};t&&"boolean"==typeof t[o]&&(i[e[o]].lookupId=t[o])}for(var r=this._viewDom.viewFields,n=r.firstElementChild;n;n=n.nextElementSibling){i[c=g.getAttr(n,f.CamlAttributes.name)]&&(i[c].elem=n)}var s=this._viewDom.viewFields=this._xmlDoc.createElement(f.CamlTags.viewFields);this._viewDom.view.replaceChild(s,r);for(var a=[],l=0,d=Object.keys(i);l<d.length;l++){var c,u=i[c=d[l]];(n=u.elem)||(n=g.getFieldRefDom(this._xmlDoc,{fieldName:c,lookupId:u.lookupId}));a[u.index]=n}for(var p=0,m=a;p<m.length;p++){n=m[p];s.appendChild(n)}this.setIsDirty(!0,h.ArrangeInfoType.fieldNames)}};r.prototype.clearFilters=function(){this._ensureDom();if(this._viewDom.where){this._viewDom.query.removeChild(this._viewDom.where);this._viewDom.where=void 0;this.setIsDirty(!0,h.ArrangeInfoType.filters)}};r.prototype.addFilters=function(e){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){var t,i=g.combineFilters(e,f.CamlTags.and);if(!i)throw new Error("Invalid filter: must be defined and have values");this.setIsDirty(!0,h.ArrangeInfoType.filters);try{t=g.xmlToDom(i).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}var o=this._viewDom.where;if(!o){o=this._viewDom.where=this._xmlDoc.createElement(f.CamlTags.where);this._viewDom.query.appendChild(o)}if(o.childElementCount){var r=o.firstElementChild,n=this._xmlDoc.createElement(f.CamlTags.and);n.appendChild(r);n.appendChild(t);o.appendChild(n)}else o.appendChild(t)}};r.prototype.updateRowLimit=function(e){this._ensureDom();if(this._viewDom&&e&&"number"==typeof e.rowLimit){this.rowLimit=e.rowLimit;var t=this._viewDom.rowLimit;if(!t){this._viewDom.rowLimit=t=this._xmlDoc.createElement(f.CamlTags.rowLimit);this._viewDom.view.appendChild(t)}if(t.firstChild)t.firstChild.nodeValue=String(e.rowLimit);else{var i=this._xmlDoc.createTextNode(String(e.rowLimit));t.appendChild(i)}"boolean"==typeof e.isPerPage&&g.updateBooleanAttr(t,f.CamlAttributes.paged,e.isPerPage);this.setIsDirty(!0,h.ArrangeInfoType.rowLimit)}};r.prototype.updateAll=function(e){var t=e.fieldNames,i=e.groupBy,o=e.sorts,r=e.filters;t&&t.length&&this.replaceFields(t);i&&this.updateGroupBy(i);if(o&&o.length){this.updateSort(o[0],{overwriteAll:!0});for(var n=0,s=o.slice(1);n<s.length;n++){var a=s[n];this.updateSort(a)}}if(r&&r.length&&"string"==typeof r[0]){this.clearFilters();this.addFilters(r)}};r.prototype.compareTo=function(e){if(!e)return 1;if(134217728===this.viewType&&134217728!==e.viewType)return 1;if(134217728!==this.viewType&&134217728===e.viewType)return-1;var t=(this.title||"").toLocaleLowerCase(),i=(e.title||"").toLocaleLowerCase();return t===i?0:t<i?-1:1};r.prototype._ensureDom=function(){if(this._baseViewXml&&!this._viewDom){this._isDirty=!1;this._hasParseError=!1;var t=new o.Qos({name:"View.Parse"});try{this._viewDom=i.getViewDomParts(this._baseViewXml);this._xmlDoc=this._viewDom.xmlDoc;t.end({resultType:o.ResultTypeEnum.Success})}catch(e){this._viewDom=void 0;this._xmlDoc=void 0;this._hasParseError=!0;t.end({resultType:o.ResultTypeEnum.Failure,error:e.message||JSON.stringify(e)})}}};return r}();t.default=r});define("@ms/odsp-datasources/lib/interfaces/view/IViewArrangeInfo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.filters=0]="filters";e[e.sorts=1]="sorts";e[e.groupBy=2]="groupBy";e[e.fieldNames=3]="fieldNames";e[e.rowLimit=4]="rowLimit";e[e.columnWidth=5]="columnWidth";e[e.customFormatter=6]="customFormatter";e[e.newDocumentTemplates=7]="newDocumentTemplates"}(t.ArrangeInfoType||(t.ArrangeInfoType={}))});define("odsp-next/dataSources/url/odb/UrlQueryKeys",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortGroupKeyRegex=/^(sortField|isAscending|groupBy)$/;t.filterKeyRegex=/^Filter(Field|Value|Type)(s?)([1-9]|10)$/});define("odsp-next/models/list/ViewIdentifier",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isViewById=function(e){return e&&!!e.id};t.isViewByUrl=function(e){return e&&!!e.url};t.isViewByTitle=function(e){return e&&!!e.title}});define("odsp-next/utilities/list/ListFilterHelper",["require","exports","./ListUtilities.resx","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}n.getFilterList=function(e,t,i,o){return a.default.getFilterList(e,t,i,o,r.strings.EmptyFilterValue)};n.clearFilterInfo=function(e,t){t=t||0;for(var i=n.getFilterList(e),o=t;o<i.length;o++){var r=i[o];e=a.default.addFilterInfo(e,r.fieldName,null,!0)}return e};n.getInplviewHash=function(e,i){var t="#InplviewHash"+(e=s.default.normalizeLower(e||"",!1))+"=";i&&(t+=Object.keys(i).map(function(e){var t=o.default.encodeURIComponent(i[e]);return o.default.encodeURIComponent((e+"="+t).replace(/-/g,"--"))}).join("-"));return t};return n}();t.default=i});define("@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities",["require","exports","@ms/odsp-utilities/lib/encoding/UriEncoding","../../dataSources/item/spListItemRetriever/ListItemDataHelpers","../../utilities/caml/CamlUtilities"],function(e,t,d,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(_){var C="FilterLookupId",i="FilterField",o="FilterValue",r="FilterType";function x(e,t){t=d.default.encodeURIComponent(t);var i=e.match(new RegExp("FilterField([0-9]+)="+t+"&"));Boolean(i)||(i=e.match(new RegExp("FilterFields([0-9]+)="+t+"&")));return i}_.getFilterFieldByName=x;_.getFilterValueByName=function(e,t){t=d.default.encodeURIComponent(t);var i=e.match(new RegExp("FilterField([0-9]+)="+t+"&FilterValue([0-9]+)=([^&]+)"));Boolean(i)||(i=e.match(new RegExp("FilterFields([0-9]+)="+t+"&FilterValues([0-9]+)=([^&]+)")));return i?decodeURIComponent(i[i.length-1]):void 0};function w(e,t){return n(i,e,t)}_.getFilterFieldByIndex=w;function S(e,t){return n(o,e,t)}_.getFilterValueByIndex=S;function k(e,t){return n(r,e,t)}_.getFilterTypeByIndex=k;function R(e,t){return n(C,e,t)}_.getFilterUseLookupIdByIndex=R;_.getFilterParams=function(e,t){var i,o,r,n="",s=0;do{i=w(e,++s);o=S(e,s);r=k(e,s);var a=o&&o.toString(),l=r&&r.toString();if(t&&l&&a){var d=String(l.substr(l.indexOf("=")+1)),c=String(a.substr(a.indexOf("=")+1));if("datetime"===(d&&d.toLowerCase())){var u=_.parseMultiColumnValue(c,";#",!0);if(u&&u.length&&v.isTodayString(u[0]))continue}}null!==i&&null!==o&&(n+="&"+i.toString()+"&"+a);null!==r&&(n+="&"+l)}while(null!=i);return n};_.isFiltered=function(e){var t=!1;for(var i in e)if(0===i.indexOf("FilterField")){t=!0;break}return t};_.updateFilterInfo=function(e,t,i,o,r){e=_.addFilterInfo(e,t,"",!0,o,r);if(i&&0<i.length){for(var n=0,s=[];s=w(e,++n),Boolean(s););""!==e&&(e+="&");e+=T(n,t,i,o,r)}return e};_.addMultipleFilterInfo=function(e,t,o,i){var r=e,n={};i&&i.forEach(function(e){n[e.Name]=e});t.forEach(function(e,t){var i=n&&n[e];r=i?s(r,e,o[t],!1,i.FieldType):s(r,e,o[t])});return r};function s(e,t,i,o,r,n){var s=x(e,t);if(Boolean(s)){var a=parseInt(s[1],10),l=S(e,a),d=k(e,a),c=R(e,a),u=s[0]+l[0];d&&(u+="&"+d[0]);c&&(u+="&"+c[0]);var p=u,m="";if(Boolean(o))p=new RegExp("(\\?|\\&)"+u);else{var h=[],f=!1,g=D(String(l[0].substr(l[0].indexOf("=")+1)),";#",!0);for(var b in g)if(b){if(g[b]===i){f=!0;continue}h.push(g[b])}f||h.push(i);0<h.length&&(m=T(s[1],t,h,r,n))}var _=e.replace(p,m);o&&_===e&&(_=e.replace(u,m));e=function(e,t){var i=t+1,o=e.match(new RegExp("FilterField"+String(i)+"=[^&]*")),r=!1;if(!Boolean(o)){o=e.match(new RegExp("FilterFields"+String(i)+"=[^&]*"));r=Boolean(o)}for(var n=t;Boolean(o);n++){var s=r?"FilterFields"+String(n):"FilterField"+String(n),a=r?"FilterFields"+String(i):"FilterField"+String(i);e=e.replace(a,s);s=r?"FilterValues"+String(n):"FilterValue"+String(n);a=r?"FilterValues"+String(i):"FilterValue"+String(i);e=e.replace(a,s);s=r?"FilterTypes"+String(n):"FilterType"+String(n);a=r?"FilterTypes"+String(i):"FilterType"+String(i);e=e.replace(a,s);s=C+String(n);a=C+String(i);e=e.replace(a,s);o=w(e,++i)}return e}(_,a)}else{for(var y=0,v=[];v=w(e,++y),Boolean(v););if(!Boolean(o)){""!==e&&(e+="&");e+=T(y,t,[i],r,n)}}return e}_.addFilterInfo=s;function D(e,t,i){var o=t.charAt(0),r=new RegExp(o+o,"g");i&&(e=decodeURIComponent(e));var n=e.split(t);return n=n.map(function(e){return e.replace(r,o)})}_.parseMultiColumnValue=D;_.isFieldValueInUrl=function(e,t,i,o){var r=x(e,t);if(Boolean(r)){var n=S(e,parseInt(r[1],10)),s=String(n[0].substr(n[0].indexOf("=")+1)),a=decodeURIComponent(s).split(";#");for(var l in a)if(a[l]===i||o&&a[l]===o)return!0}return!1};_.getText=function(e){return Boolean(e.innerText)?e.innerText.toString():Boolean(e.textContent)?e.textContent.toString():e.innerHTML.toString()};_.getFilterList=function(e,t,i,o,r){var n,s,a,l,d,c=[],u=0;do{u++;d="Eq";n=_.getFilterFieldByIndex(e,u);s=_.getFilterValueByIndex(e,u);a=_.getFilterTypeByIndex(e,u);l=_.getFilterUseLookupIdByIndex(e,u);if(null!==n&&null!==s){var p=String(n[0].substr(n[0].indexOf("=")+1)),m=String(s[0].substr(s[0].indexOf("=")+1)),h=decodeURIComponent(p),f=a&&a[0]?String(a[0].substr(a[0].indexOf("=")+1)):t?y.getFieldType(h,t):null,g=void 0;l&&l[0]&&"1"===l[0].substr(l[0].indexOf("=")+1)&&(g=!0);var b=_.parseMultiColumnValue(m,";#",!0).map(function(e){return i?e:e||r});f&&"datetime"===f.toLowerCase()&&b&&b.length&&v.isTodayString(b[0])&&(d="Geq");c.push({fieldName:h,values:b,operator:d,type:f,id:o?h:void 0,lookupId:g})}}while(n);return c};_.formatBreadcrumbFilterValues=function(e,t,i){return e.map(function(e){return"Boolean"===t?"0"===e?i.booleanFalse:"1"===e?i.booleanTrue:e:new RegExp("^\\d*\\.0+$").test(e)?parseFloat(e).toString():e}).join(", ")};function n(e,t,i){var o=t.match(new RegExp(e+String(i)+"=[^&#]*"));Boolean(o)||(o=t.match(new RegExp(e+"s"+String(i)+"=[^&#]*")));return o}function T(e,t,i,o,r){var n="FilterField",s="&FilterValue",a="&FilterType";if(1<i.length){n="FilterFields";s="&FilterValues";a="&FilterTypes"}var l=n+e+"="+t+s+e+"="+function(e,t){var i=t.charAt(0),o=i+i,r=new RegExp(i,"g");e=e.map(function(e){return e.replace(r,o)});return d.default.encodeURIComponent(e.join(t))}(i,";#");o&&(l+=a+e+"="+o);r&&(l+="&"+C+e+"=1");return l}}(i||(i={}));t.default=i});define("odsp-next/controls/list/react/detailsList/fields/CustomFormatterRenderer",["require","exports","tslib","react","knockout","../../../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../../../../resources/ControlResourceKeys","office-ui-fabric-react/lib/Utilities","../../../../../utilities/features/Features","../../../../../utilities/complianceTag/ComplianceTagUtilities","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/scope/Scope","../../../../sharing/share/commands/ShareCommandKeys","./CustomFormatterRenderer.css"],function(e,t,o,l,n,d,s,a,i,r,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="_IsRecord",f=r.isFeatureEnabled(r.CustomFormatter),g=function(r){o.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._actions=[];t._scope=new p.default;var i=t.props.resources;t._actionMap=i.consume(a.actionMap);var o=t._actionMap;t._cfActionMap={executeFlow:t._actionMap.TriggerFlowByIdAction,defaultClick:o.DefaultClickAction,share:o.ShowShareAction,delete:o.DeleteAction,editProps:o.EditItemAction};return t}e.prototype.render=function(){var t=this,e=this.props.item,i=this.props.itemSet,o=window.CustomFormatter,r=b(i),n={__html:""},s=this.props.forFieldRenderer?"od-FieldRenderer-customFormatter":null;if(o){var a=new o({fieldRendererFormat:this.props.customFormatterString,row:_(e,r),currentFieldName:this.props.currentField,rowSchema:r,errorStrings:null,pageContextInfo:this.props.resources.consume(d.pageContext)});n.__html=a.evaluate()}return l.createElement("div",{className:s,dangerouslySetInnerHTML:n,ref:function(e){return t._rootElm=e}})};e.prototype.componentDidMount=function(){f&&this.setupCustomFormatterActionCallbacks()};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype._getActionObj=function(e,t,i){var o=this.props.resources,r=this._cfActionMap[e];if(!r)return null;for(var n=this._actions,s=0;s<n.length;s++){var a=n[s];if(a&&a.id===e&&JSON.stringify(t)===JSON.stringify(a.additionalProps))return a.action}if(i){var l=this._scope.attach(new(o.injected(r))(i));this._actions.push({action:l,id:e,params:i,additionalProps:t});return l}return null};e.prototype._setupAction=function(e,t){var i=o.__assign({item:n.observable(this.props.item),userInvokedItem:!0,sourceEngagement:"customFormatter_"+e},t);this._getActionObj(e,t,i)};e.prototype._getAdditionalActionParams=function(e,t){var i={};if("executeFlow"===e)i.flow=JSON.parse(t);else if("share"===e){i.focusItemResourceKey=m.shareFocusItemResourceKey;i.overrideItem=this.props.item}return i};e.prototype._createActionFromBtn=function(e){var t=e.getAttribute("data-actionname"),i=e.getAttribute("data-actionparams");this._setupAction(t,this._getAdditionalActionParams(t,i))};e.prototype.setupCustomFormatterActionCallbacks=function(){var n=this,e=this._rootElm.querySelectorAll("button[data-iscustomformatter=true]");if(e&&e.length)for(var t=0;t<e.length;t++){var i=e[t];this._createActionFromBtn(i);this._events.on(i,"click",function(e){var t=e.currentTarget,i=t.getAttribute("data-actionname"),o=t.getAttribute("data-actionparams"),r=n._getActionObj(i,n._getAdditionalActionParams(i,o));r&&r.execute(e)})}};return e}(i.BaseComponent);t.customFormatterRenderer=function(e){var t=e.item,i=e.column,o=e.itemSet,r=e.resources;return l.createElement(g,{item:t,customFormatterString:i.customFormatter,currentField:i.realFieldName||i.internalName,itemSet:o,forFieldRenderer:!0,resources:r})};t.customFormatterRowRenderer=function(e,t,i,o){return l.createElement(g,{item:e,customFormatterString:t,currentField:"Title",itemSet:i,forFieldRenderer:!1,resources:o})};t.evaluateRowClass=function(e,t,i,o){var r=window.CustomFormatter,n=b(i);return new r({fieldRendererFormat:null,row:_(t,n),currentFieldName:"Title",rowSchema:n,errorStrings:null,pageContextInfo:o.consume(d.pageContext)}).evalExpression(e)};function b(e){for(var t={},i=0,o=e.schema.peek();i<o.length;i++){var r=o[i],n=r.realFieldName||r.internalName;r.key===h?t[n]=h:t[n]=s.ColumnFieldType[r.fieldType]}return t}function _(e,t){var i=e.properties;if(t[h]){i[h]=c.complianceRecordFlagValueAsYesNoString(e);i[h+"."]=c.complianceRecordFlagValue(e)}return i}t.resourceKey=new u.ResourceKey({name:e("module").id,factory:new u.ConstantResourceFactory(t.customFormatterRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/CustomFormatterRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRenderer-customFormatter{min-height:inherit;margin:-11px 0;white-space:normal}"}])});define("odsp-next/controls/list/react/ReactBaseList",["require","exports","tslib","react","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/index","office-ui-fabric-react/lib/components/DetailsList/DetailsList.types","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","./detailsList/ReactDetailsList.resx","../../../utilities/features/Features","../../../dataSources/url/QueryType","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../listGroupHeader/BaseListHeaderViewModel","./SelectionManager","../../dragAndDrop/DropHelper","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../columnsHeader/ColumnCommonUtilities","../../../bindings/contextMenu/ContextMenuBinding","@ms/odsp-utilities/lib/string/StringHelper","../../../providers/engagement/Engagement","../../../dataSources/base/AriaHelper","../../../bindings/contextMenu/ContextMenuHelper","@ms/odsp-utilities/lib/performance/PerformanceCollection","../../../utilities/selection/SelectionHelper","./DefaultClickActionManager","@ms/odsp-utilities/lib/scope/Scope","../../../utilities/killSwitch/KillSwitch","../columns/ListColumns","office-ui-fabric-react/lib/Styling","../../../utilities/browser/ResponsiveUI","../../../models/list/ListResponsiveConstants","../../../dataSources/schema/DetailsListSchemaDataSource.key","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Utilities"],function(e,t,_,i,r,n,y,s,a,v,C,l,x,d,c,u,w,p,m,h,f,g,b,S,k,R,D,T,I,F,P,B,L,M,E,A,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H="__newColumnHeaderCommand",o=function(o){_.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._columnSizesFromXml={};t._columnSizesUnsaved={};t._logPerf=!1;t._expandingGroup=!1;t.resources=e.hostViewModel.resources;t.scope=new I.default;t.observables=t.scope.attach(new(t.resources.consume(r.observablesFactoryTypeResourceKey))({owner:t}));t.async=t.scope.attach(new(t.resources.consume(r.asyncTypeResourceKey))(t));t.events=t.scope.attach(new(t.resources.consume(r.eventGroupTypeResourceKey))(t));t._missingIndex=-1;t.selection=t.resources.consume(c.resourceKey);if(!e.disableDrop){t._dragDropEvents={canDrop:t._canDrop.bind(t),canDrag:t._canDrag.bind(t),onDragStart:t._onDragStart.bind(t)};t.rowElementEventMap=[{eventName:"od-dragEnter",callback:t._onDragEnter.bind(t)},{eventName:"od-processDrop",callback:t._onProcessDrop.bind(t)}];t._dropHelper=t.resources.consume(u.resourceKey)}t.onItemInvoked=t.onItemInvoked.bind(t);t.onRenderMissingItem=t.onRenderMissingItem.bind(t);t.getAriaLabel=t.getAriaLabel.bind(t);t.getGroupItemLimit=t.getGroupItemLimit.bind(t);t.isGroupLoading=t.isGroupLoading.bind(t);t.onActiveItemChanged=t.onActiveItemChanged.bind(t);t.onShowAll=t.onShowAll.bind(t);t.onToggleCollapseAll=t.onToggleCollapseAll.bind(t);t.onToggleCollapse=t.onToggleCollapse.bind(t);t.onColumnResize=t.onColumnResize.bind(t);t._onColumnClick=t._onColumnClick.bind(t);t._isMenuOpen=t.observables.create(!1);t._viewRowLimit=30;t._dataManager=t.resources.consume(s.dataManager.optional);t._dataManager&&t._dataManager.itemsPerGroup(t._viewRowLimit);t._selectionHelper=t.resources.consume(D.resourceKey);t._defaultClickActionManager=t.resources.consume(T.resourceKey.local);var i=t.resources.consume(m.platformDetection);t._isMobileView=i.isMobile;t._isSelectionModal=t.resources.consume(c.isSelectionModalResourceKey);t._canModifySchema=t.resources.consume(w.canModifySchema.optional);t._viewParams=t.resources.consume(w.viewParams.optional);t._needsAttentionViewHelper=t.resources.consume(p.needsAttentionViewHelper.optional);t._detailsListSchemaDataSource=t.resources.consume(E.resourceKey);t._mayEnableDeferredBehaviors=t.observables.create(!1);t._responsiveUI=t.resources.consume(L.resourceKey);return t}e.prototype.componentWillMount=function(){var e=this,t={rateLimit:{timeout:0,method:"notifyWhenChangesStop"}};this.observables.compute(this._computeItems).extend(t);this.observables.compute(this._computeSelectionMode).extend(t);this.observables.compute(this._computeColumns).extend(t);var i=this.resources.consume(a.bundleLoader.optional);this.observables.backgroundCompute(function(){if((!i||i.isPageLoaded())&&e._mayEnableDeferredBehaviors()){R.default.mark("EUPL.ReactDetailsList.enableDeferredBehaviors");e.setState(function(e){return{items:e.items&&e.items.slice(),enableDeferredBehaviors:!0}})}})};e.prototype.componentDidUpdate=function(e,t){R.default.mark("EUPL.ReactDetailsList.componentDidUpdate");if(this._logPerf&&this.state.items&&0<this.state.items.length){this._logPerf=!1;this._markLayoutRenderComplete()}this.state.missingFieldRenderers&&this.state.enableDeferredBehaviors&&this._loadMissingFieldRenderers()};e.prototype.componentDidMount=function(){R.default.mark("EUPL.ReactDetailsList.componentDidMount");var e=this.props.isLoading;if(this._logPerf){this._logPerf=!1;this._markLayoutRenderComplete()}e&&e(!1);this.state.missingFieldRenderers&&this.state.enableDeferredBehaviors&&this._loadMissingFieldRenderers()};e.prototype.componentWillUnmount=function(){this.scope.dispose()};e.prototype.onItemInvoked=function(e,t,i){if(this._defaultClickActionManager.invokeItem(e,t,i)){i.stopPropagation();i.preventDefault()}};e.prototype.onRenderMissingItem=function(e){var t=this,i=this.props.itemSet.peek(),o=i&&i.content.peek(),r=o&&o.partialResultStatus;if(-1===this._missingIndex&&(void 0===r||0===r)){var n={start:this._missingIndex=e,end:this._expandingGroup?e+2:e+1},s=this.props.getRequiredRange?function(){return t.props.getRequiredRange(t._expandingGroup)}:this.props.requiredRange?function(){return t.props.requiredRange.peek()}:void 0;if(s){var a=s();a.start===n.start&&a.end===n.end&&n.end++}this.props.setRequiredRange?this.props.setRequiredRange(n,this._expandingGroup):this.props.requiredRange&&this.props.requiredRange(n);this._expandingGroup=void 0;this._missingIndexTimeoutId=this.async.setTimeout(function(){t._missingIndex=-1;t.forceUpdate()},5e3)}return null};e.prototype.getAriaLabel=function(e){return S.getRowAriaLabel(e)};e.prototype.onActiveItemChanged=function(e,t,i){var o=this.props.selectionModel;void 0!==t&&o.setIndexFocus(t)};e.prototype.isGroupLoading=function(e){var t=this.state.items;return e&&!e.children&&!t[e.startIndex]};e.prototype.getGroupItemLimit=function(e){var t=this.state.items;if(e){if(this.isGroupLoading(e))return Math.min(e.count,3);var i=e.data;return!e.isShowingAll&&i.emptyItemCount?Math.min(e.count-i.emptyItemCount,this._viewRowLimit):e.isShowingAll?e.count:Math.min(e.count,this._viewRowLimit)}return t.length};e.prototype.onColumnResize=function(e,t,i){if(C.isFeatureEnabled(C.SaveColumnResize)){var o=this.props.itemSet.peek();if(o&&o.context.baseViewId&&this._dataManager){var r=e.data&&e.data.internalName||e.key;this._dataManager.setColumnWidthsToLocalStorage(o.context.baseViewId,r,t);if(this._dataManager.currentView&&!this._dataManager.currentView.peek().isDirty()){this._dataManager.currentView.peek().setIsDirty(!0);this._dataManager.currentView.valueHasMutated()}}}};e.prototype._getColumnReorderOptions=function(){if(this._canModifySchema&&this._canModifySchema.peek()&&C.isFeatureEnabled(C.ColumnReorder)&&!F.default.isActivated("4D12C17F-DF78-4CD5-B841-9A1181F09161")){var e=this.state.columns,t=e.length;if(0<t){for(var i=0;i<t&&e[i].isIconOnly;)i++;return{frozenColumnCountFromStart:i,frozenColumnCountFromEnd:e[e.length-1].key===H?1:0,onColumnDrop:this._onColumnDrop,onColumnDragStart:this._onColumnDragStart,onDragEnd:this._onColumnDragEnd}}}};e.prototype._onColumnDrop=function(e){if(this._dataManager&&this._dataManager.currentView){var t=this.resources.consume(b.resourceKey),i=this.state.columns[e.draggedIndex].data.internalName,o=this.state.columns[e.targetIndex].data.internalName;t.logData({name:"ColumnDragDrop.ColumnsReordered",isIntentional:!0});this._dataManager.onColumnReorder(i,o)}};e.prototype._onColumnDragStart=function(e){if(this._dataManager&&this._dataManager.currentView){this.resources.consume(b.resourceKey).logData({name:"ColumnDragDrop.DragStarted",isIntentional:!0})}};e.prototype._onColumnDragEnd=function(e){if(this._dataManager&&this._dataManager.currentView){this.resources.consume(b.resourceKey).logData({name:"ColumnDragDrop.DragEndLocation: "+y.ColumnDragEndLocation[e],isIntentional:!0})}};e.prototype.onShowAll=function(e){var t=this;d.default.filterAndExpandGroup(this.resources,e.data,null,function(e){t.scope.attach(e)})};e.prototype.onToggleCollapse=function(e){var t=e.data;if(t&&t.state){var i=!t.state.peek().isCollapsed;if(!i){performance.mark("EUPL.ExpandingGroup.("+e.name+").start");this._missingIndex=-1;this._expandingGroup=!0}t.state({isCollapsed:i})}};e.prototype.onToggleCollapseAll=function(t){var e=this.props.itemSet.peek().content.peek().groupings,i=e&&0<e.length?e[0]:null;if(i){i.isAllCollapsed(t);i.itemGroups.forEach(function(e){e.state({isCollapsed:t})});this._dataManager&&this._dataManager.expandAll(!t)}};e.prototype.onRenderGroupHeader=function(e,t){return e.group.data.isPlaceholder?null:t(e)};e.prototype.onRenderGroupFooter=function(e,t){return e.group.data.isPlaceholder||e.group.data.hideFooter?null:t(e)};e.prototype.isInNewRecentView=function(e){var t=this.resources.consume(w.isInNewRecentView.optional);return e&&e.item.peek().queryType===l.default.Recent&&t&&t()};e.prototype.enableResponsiveFilesList=function(){var e=this.props.itemSet.peek();return this._enableUpdatedFilesListView()&&C.isFeatureEnabled(C.EnableResponsiveFilesListView)&&e&&e.item.peek().queryType===l.default.Files};e.prototype.computeColumnsOnWindowResize=function(){this._computeColumns()};e.prototype.getFieldRendererKey=function(e){};e.prototype._markLayoutRenderComplete=function(){var e=this,t=this.props.onLayoutRenderComplete;t&&t();this.async.setTimeout(function(){e._mayEnableDeferredBehaviors(!0)},0)};e.prototype._computeColumns=function(){var e,s=this,t=this.props,i=t.itemSet,a=t.columnActionModeAllowChevron,o=i(),l=C.isOneDrive&&this._enableUpdatedFilesListView(),r=this.resources.consume(w.disableCalloutInvoker.optional)||this._enableUpdatedFilesListView(),n=this._enableUpdatedFilesListView();if(o){var d=this._detailsListSchemaDataSource.postProcessSchema(o.item(),o.schema()),c=o.context.baseViewId;if(c&&this._dataManager){this._columnSizesFromXml=this._dataManager.getColumnWidthsFromLocalStorage(c);this._columnSizesUnsaved=this._dataManager.getColumnWidthsFromLocalStorage(c,!0);0!==Object.keys(this._columnSizesUnsaved).length&&this._dataManager.currentView.peek()&&this._dataManager.currentView.peek().setIsDirty(!0)}var u=this._viewParams&&this._viewParams.peek();if(u&&u.needsAttentionView&&this._needsAttentionViewHelper){d=this._needsAttentionViewHelper.getNeedsAttentionViewSchema(d);l=!0}var p=this._responsiveUI.formFactorSize();if(d&&!o.isPlaceholder){var m,h=this.isInNewRecentView(o),f=A.css(((e={})["od-DetailsRow-cell--VerticallyCenter"]=h,e)),g=this.enableResponsiveFilesList(),b=d.filter(function(e){var t=g&&M.shouldExcludeColumn(e.key,p);return e.isVisible&&!t&&("_calloutInvoker"!==e.key||!r)&&("_shareHeroCommand"!==e.key||!n)}).map(function(e){var t=s._computeColumnWidth(e,e.minWidth||e.width),i=s._computeColumnWidth(e,e.width,!0),o=s.getFieldRendererKey(e),r=o&&s.resources.consume(o.optional);if(!r&&o){m||(m={});m[e.key]=o}var n=_.__assign({},e,{minWidth:t,width:i,reactFieldRenderer:r});return{key:e.key,name:e.name,className:A.css("od-DetailsRow-cell--"+x.ColumnFieldType[e.fieldType],f),headerClassName:A.css("od-DetailsHeader-cell--"+x.ColumnFieldType[e.fieldType],"od-DetailsHeader-cell"),iconClassName:{type:B.getIconClassName("Page")+" od-DetailsListHeader-FileTypeIcon"}[e.key],isIconOnly:e.isIcon||"_calloutInvoker"===e.key,fieldName:e.key,minWidth:t,maxWidth:i,isCollapsable:e.isCollapsable,isResizable:void 0!==e.resizable?e.resizable:!!e.name,isSorted:e.isSorted,isSortedDescending:!e.isAscending,isFiltered:e.isFiltered&&e.isFiltered.peek(),isGrouped:e.isGrouped,isRowHeader:e.isRowHeader,ariaLabel:s._computeAriaLabel(e),data:n,columnActionsMode:O(a,e,l),onColumnClick:s._onColumnClick}});this._canModifySchema&&this._canModifySchema.peek()&&b.push({key:H,name:v.strings.addColumnText,headerClassName:A.css("od-DetailsHeader-addColumn","od-DetailsHeader-cell"),iconClassName:B.getIconClassName("Add")+" od-DetailsListHeader-AddNewField",fieldName:H,minWidth:90,onColumnClick:this._onColumnClick,isIconOnly:!1,columnActionsMode:y.ColumnActionsMode.clickable});R.default.mark("EUPL.ReactDetailsList._computeColumns.setState  : column count("+b.length+")");this.setState({columns:b,missingFieldRenderers:m})}}};e.prototype._loadMissingFieldRenderers=function(){var e=this;this.resources.load(this.state.missingFieldRenderers).then(function(){e.observables.ignore(function(){e._computeColumns()})})};e.prototype._computeColumnWidth=function(e,t,i){var o=this.props.isCompact,r=e.internalName,n=e.key,s=this._responsiveUI.formFactorSize.peek();if(this._enableUpdatedFilesListView()&&"type"===n&&("FSObjType"===r||"DocIcon"===r)||this._enableUpdatedFilesListView()&&"FileTypeIcon"===r){var a=this.enableResponsiveFilesList()?s:"XLarge";return o?M.COMPACT_FILE_TYPE_ICON_SIZE[a]:M.DETAILS_FILE_TYPE_ICON_SIZE[a]}return this.enableResponsiveFilesList()&&("name"===n&&"LinkFilename"===r||"displayName"===n)?this._computeResponsiveNameColumnWidth(e,s):i&&(parseInt(this._columnSizesUnsaved[e.internalName],10)||parseInt(this._columnSizesFromXml[e.internalName],10)||parseInt(this._columnSizesUnsaved[e.key],10)||parseInt(this._columnSizesFromXml[e.key],10))||t};e.prototype._computeResponsiveNameColumnWidth=function(e,t){return this._isSmallerThanLargeScreen()?void 0:e.width};e.prototype._isSmallerThanLargeScreen=function(){return 0<=this._responsiveUI.compareSize("Large",this._responsiveUI.formFactorSize.peek())};e.prototype._enableUpdatedFilesListView=function(){return C.isFeatureEnabled(C.EnableUpdatedFilesListView)&&C.isFeatureEnabled(C.FlipOnNewGridAndListExperiment)};e.prototype._computeItems=function(){var e=this.props.itemSet();if(e){var t=e.item.peek().key,i=e.content();if(i){this.props.isLoading&&this.props.isLoading(!0);this._missingIndex=-1;this.async.clearTimeout(this._missingIndexTimeoutId);var o=i.items.map(function(e){if(e){return e.peek()}return null}),r=i.groupings,n=!!(r&&0<r.length&&r[0].isAllCollapsed)&&r[0].isAllCollapsed.peek(),s=r&&0<r.length?this._getGroups(r[0].itemGroups,n):null;s&&this._updateViewItemLimit();if(t!==this._setKey||!e.isPlaceholder){this._setKey=t;R.default.mark("EUPL.ReactDetailsList._computeItems.setState : item count("+o.length+")");this._logPerf=!0;this.setState({items:o,groups:s,setKey:t,isAllCollapsed:n})}}}};e.prototype._updateViewItemLimit=function(){var e=this.resources.consume(w.currentView.optional),t=e&&e.peek();if(t&&t.rowLimit){this._viewRowLimit=t.rowLimit;this._dataManager&&this._dataManager.itemsPerGroup.peek()!==this._viewRowLimit&&this._dataManager.itemsPerGroup(this._viewRowLimit)}};e.prototype._computeSelectionMode=function(){var e=this.resources.consume(c.selectionModeResourceKey);this._isMobileView&&!F.default.isActivated("421C26E6-CF38-4A60-90A7-760626CCDC28","10/20/2017","Selection updates for mobile details list.")&&(e=this._isSelectionModal()?e:n.SelectionMode.none);var t=this.resources.consume(w.currentView.optional),i=t&&t();i&&!1===i.tabularView&&(e=n.SelectionMode.none);R.default.mark("EUPL.ReactDetailsList._computeSelectionMode.setState");this.setState({selectionMode:e})};e.prototype._computeAriaLabel=function(e){if(!e.name||O(this.props.columnActionModeAllowChevron,e)===y.ColumnActionsMode.disabled)return"";var t="",i="",o="",r="type"===e.key?v.strings.typeColumnHeaderLabel:e.name;e.isFiltered&&e.isFiltered()&&(i=g.format(v.strings.columnFilterAriaLabel,r,e.filterValues()));if(e.isSorted){var n=h.getSortMenuStrings(e),s=n.ascendingString,a=n.descendingString,l=e.isAscending?s:a;t=g.format(v.strings.columnSortAriaLabel,r,l)}e.isGrouped&&(o=g.format(v.strings.columnGroupAriaLabel,r));return g.format(v.strings.columnCellAriaLabel,r,i,t,o)};e.prototype._getGroups=function(e,r,t){var n=this,i=null,s=v.strings.NoGroupName;e&&0<e.length&&(e[0].name||e[0].fieldSchema)&&(i=e.map(function(e){var t=e.fieldSchema?(e.fieldSchema.DisplayName||e.fieldSchema.Name)+": "+(e.name||s):e.name||s,i=e.state?e.state.peek().isCollapsed:r,o={key:e.groupingId,name:t,startIndex:e.startIndex,count:e.count,level:e.level,isSelected:!1,isCollapsed:i,isShowingAll:!1,data:e,hasMoreData:e.hasMoreData,isDropEnabled:!n.props.disableDrop&&e.isDropEnabled,ariaLabel:n._computeGroupAriaLabel(t,e.count,i)};o.children=e.children?n._getGroups(e.children,r,o):null;return o}));return i};e.prototype._computeGroupAriaLabel=function(e,t,i){var o=g.pluralSelect(t,g.format(v.strings.itemsCountSingular,t),g.format(v.strings.itemCountMulti,t));return g.format(v.strings.groupHeaderAriaLabel,e,o,i?v.strings.collapsedText:v.strings.expandedText)};e.prototype._onDragEnter=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;i.dropTargetData||1!==i.dragData.type&&0!==i.dragData.type||(i.dropTargetData={targetName:e.data.name});return!0};e.prototype._onProcessDrop=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;var o=e.data,r=!1,n=!1;if(e.isGroup){i.dragData.metadata={group:e.data.data};i.dragData.itemSet=this.props.itemSet.peek();n=r=!0;this._dataManager&&(o=this._dataManager.item.peek())}if(!i.isHandled){if(this._dropHelper.processDrop(i.dragData,o,r,n))return!(i.isHandled=!0)}return!0};e.prototype._canDrop=function(e,t){var i=!1;if(e)if(e.isGroup){var o=e.data;if(o){var r=!1;if(t&&!t.isGroup){var n=t.index;r=n>=o.startIndex&&n<o.startIndex+o.count}i=o.isDropEnabled&&!r}}else{var s=e.data;i=s&&s.isDropEnabled}return i};e.prototype._canDrag=function(e){return!0};e.prototype._onDragStart=function(e,t,i,o){var r=this;o.dragData={type:1,itemSet:this.props.itemSet.peek(),item:e,itemIndex:t,selection:{length:this.props.selectionModel.selectedCount.peek(),resolve:function(){return r._selectionHelper.resolveSelection()},resources:this.props.selectionModel.resources}}};e.prototype._onColumnClick=function(e,t){var i=this,o=e.nativeEvent;if(this._isMenuOpen.peek())this._isMenuOpen(!1);else if(t.columnActionsMode!==y.ColumnActionsMode.disabled){var r,n=this.scope.attach(new I.default),s=this.resources.consume(b.resourceKey);if(t.key===H){s.logData({name:"OpenPlusMenu.ColumnHeader.Click",isIntentional:!0});r=this.resources.consumeAsync(P.addColumnCommandHelperTypeResourceKey.local).then(function(e){return new(n.attached(e))({engagementName:".ColumnHeader",includeColumnEditor:!0}).commands})}else{s.logData({name:"OpenContextMenu.ColumnHeader.Click",isIntentional:!0});r=this.resources.consumeAsync(P.columnMenuHelperTypeResourceKey.local).then(function(e){return new(n.attached(e))({column:t.data,engagementName:".ColumnHeader"}).commands})}r.done(function(e){var t=n.attach(new(i.resources.injected(k.default))({items:e,point:h.MENU_OFFSET,anchorElement:o.target,dismissOnClick:!0,isMenuOpen:i._isMenuOpen}));f.default.createContextMenu(o,t,i.props.hostViewModel);i._isMenuOpen(!0)});n.attach(this._isMenuOpen.subscribe(function(e){e||n.dispose()}))}};_.__decorate([N.autobind],e.prototype,"_onColumnDrop",null);_.__decorate([N.autobind],e.prototype,"_onColumnDragStart",null);_.__decorate([N.autobind],e.prototype,"_onColumnDragEnd",null);return e}(i.Component);t.ReactBaseList=o;function O(e,t,i){return t.fieldType===x.ColumnFieldType.DotDotDot||t.fieldType===x.ColumnFieldType.ShareCommand?y.ColumnActionsMode.disabled:i&&t.name?t.sortable||t.groupable||t.filterable?y.ColumnActionsMode.hasDropdown:y.ColumnActionsMode.disabled:e&&t.name?y.ColumnActionsMode.hasDropdown:t.sortable||t.groupable||t.filterable?y.ColumnActionsMode.clickable:y.ColumnActionsMode.disabled}t.default=o});define("odsp-next/controls/listGroupHeader/BaseListHeaderViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../../bindings/focus/DelayedHasFocusBinding","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/modules/Modules"],function(r,e,t,n,s,i,p,m,a,l,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){t.__extends(o,i);function o(e){var t=i.call(this,e)||this;t.group=e.group;t.selectionModel=t.resources.consume(p.itemsSelection);t.isSelected=s.observable(!1);t.isFocused=s.observable(!1);t.isFocused.subscribe(function(e){t.onFocusChange(e)});t.tabindex=t.createPureComputed(function(){return t.isFocused()?0:-1});t._updateSelectionSubscription(e.key);t.addBindingHandlers({keyboard:l.default,delayedHasFocus:a.default});return t}o.filterAndExpandGroup=function(s,a,l,d){var c=null;if(a.fieldSchema){var u=s.consume(m.dataManager);u.requiredGroup(null);u.expandAll(!0);h.loadModule({path:"@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper",getModule:function(){return new n.default(function(e,t){r(["@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper"],e,t)})}}).then(function(e){var t=s.consume(p.currentItemSet),i=t&&t.peek().content.peek().groupings,o=i&&i.length&&i[0].itemGroups,r=e.getFilterDetails(a,o),n=s.consume(p.actionMap);c=new(s.injected(n.FilterAction))({field:r.fields,value:r.values,isFilterOn:!0,clearExistingFilters:u.supportsNestedGroups&&u.supportsNestedGroups.peek()});d&&d(c);c.execute(l)})}if(l){l.stopPropagation();l.preventDefault()}return!1};o.prototype.filterByGroupAndExpand=function(t,e){return o.filterAndExpandGroup(t.resources,t.group,e,function(e){t.addDisposable(e)})};o.prototype.onFocusChange=function(e){};o.prototype.onInvoke=function(e){return!0};o.prototype.dispose=function(){i.prototype.dispose.call(this);this._updateSelectionSubscription(null)};o.prototype._updateSelectionSubscription=function(e){if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,this))};return o}(i.default);e.default=o});define("odsp-next/controls/list/react/DefaultClickActionManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/scope/Scope","../../../resources/ControlResourceKeys","../../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,d,n,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._defaultClickActionsByKey={};i._itemsStore=t.itemsStore;var o=i;i._defaultClickActionType=t.actionMap.DefaultClickAction;i.DefaultClickAction=function(){function e(e){var t=this._scope=new d.default,i=this._action=t.attach(new(o.resources.injected(o._defaultClickActionType,{injectChildResourceScope:!0}))(e));this.name=i.name;this.isAvailable=i.isAvailable;this.isExecuting=i.isExecuting;this.isToggled=i.isToggled;t.attach(o._updateDefaultClickActionsByKey(i,e.item))}e.prototype.execute=function(e){return this._action.execute(e)};e.prototype.dispose=function(){this._scope.dispose()};return e}();return i}e.prototype.invokeItem=function(e,t,i){var o=e?e.key:void 0;if(o){var r=(this._defaultClickActionsByKey[o]||[])[0];if(r){if(r.isAvailable.peek()){r.execute(i).done();return!0}}else{var n=new(this.resources.injected(this._defaultClickActionType))({item:this._itemsStore.getItem(o),userInvokedItem:!0,sourceEngagement:"ItemRow.Click"});if(n.isAvailable.peek()){n.execute(i).done(function(){n.dispose()},function(){n.dispose()});return!0}n.dispose()}}};e.prototype._updateDefaultClickActionsByKey=function(o,r){var n,s=this,a=this.observables,l=this._defaultClickActionsByKey,e=this.scope.attach(new d.default);e.attach(a.compute(function(){var e=a.unwrap(r),t=e?e.key:void 0;if(t!==n){n&&s._cleanup(o,n);if(t){var i=l[t]||(l[t]=[]);i.indexOf(o)<0&&i.push(o)}}n=t}));e.attach({dispose:function(){var e=a.peekUnwrap(r),t=e?e.key:void 0;t&&s._cleanup(o,t)}});return e};e.prototype._cleanup=function(e,t){var i=this._defaultClickActionsByKey,o=i[t];if(o){var r=o.indexOf(e);-1<r&&o.splice(r,1);o.length||delete i[t]}};e.dependencies=i.__assign({},o.default.dependencies,{actionMap:n.actionMap,itemsStore:s.resourceKey});return e}(o.default);t.default=a;t.resourceKey=r.createResolvedResourceKey(e("module").id,a)});define("odsp-next/models/list/ListResponsiveConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DETAILS_FILE_TYPE_ICON_SIZE={Small:40,Medium:40,Large:40,XLarge:20,XXLarge:20,XXXLarge:20,XXXXLarge:20};t.COMPACT_FILE_TYPE_ICON_SIZE={Small:32,Medium:32,Large:32,XLarge:16,XXLarge:16,XXXLarge:16,XXXXLarge:16};var i={size:!0},o={SharedWith:!0,defaultSubText:!0,size:!0,modified:!0,dateModified:!0,Editor:!0},r={Small:o,Medium:o,Large:o,XLarge:{SharedWith:!0,defaultSubText:!0,size:!0},XXLarge:i,XXXLarge:i,XXXXLarge:i};t.shouldExcludeColumn=function(e,t){return!!r[t][e]}});define("odsp-next/dataSources/schema/DetailsListSchemaDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory({postProcessSchema:function(e,t){return t}})})});define("odsp-next/controls/list/react/detailsList/fields/LocationRenderer",["require","exports","react","../../../../../resources/SPOResourceKeys","../../../../../models/item/ItemParentHelper","../../../../../dataSources/url/odb/ItemUrlHelper","@ms/odsp-list-utilities/lib/Renderers/TextRenderer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,p,m,h,f,g,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.locationRenderer=function(e){var t=e.item,i=e.column,o=e.resources,r=t.properties[i.key],n=o.consume(m.pageContext),s=o.consume(h.resourceKey.optional),a=o.consume(f.resourceKey.optional),l=s&&s.getFacetedAncestorOrSelf(t,"list"),d=l&&a&&a.getItemUrlParts(l.peek().key),c=l&&l.peek().displayName,u=d&&d.serverRelativeItemUrl;if(c&&u){(r=r&&r.replace(u,""))&&"/"!==r[0]&&(r="/"+r);r=c+r}else"/"===(r=r.replace(n.webServerRelativeUrl,""))[0]&&(r=r.slice(1,r.length));return p.createElement(g.TextRenderer,{text:r,isSafeToInnerHTML:!0})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.locationRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/SignoffFlowStatusRenderer",["require","exports","react","./BaseText","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.signoffFlowStatusRenderer=function(e){var t=e.item,i=e.column;return o.createElement(r.BaseText,{column:i,item:t})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.signoffFlowStatusRenderer)})});define("odsp-next/providers/teachingBubble/TeachingBubbleHelper.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new r.ResourceKey({name:i("module").id,loader:new r.AliasResourceLoader(function(){return o.loadModuleExport({path:"./TeachingBubbleHelper",getModule:function(){return new t.default(function(e,t){i(["./TeachingBubbleHelper"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("@ms/odsp-datasources/lib/dataSources/web/WebTemplateType",["require","exports","tslib","../../interfaces/WebTemplateType","../../interfaces/WebTemplateType"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.default});define("odsp-next/actions/flow/utilities/FlowOutOfBoxTemplates",["require","exports","../../../utilities/features/Features","./FlowTemplate.resx"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.outOfBoxSignoffTemplate={templateId:"0c4e00f8ad7b4a3f9a59717c0f504640",displayName:o.strings.RequestSignoffTemplateName,feature:i.ApprovalFlows,data:{columnStaticName:"_Flow_SignoffStatus",columnDisplayName:"$Resources:core,Signoff_Status;",columnInitialValue:"$Resources:core,SignoffStatusPending;",columnWidgetStringSet:{"parameters.sharepoint.approveString":"$Resources:core,SignoffStatusApproved;","parameters.sharepoint.rejectString":"$Resources:core,SignoffStatusRejected;","parameters.sharepoint.cancelString":"$Resources:core,SignoffStatusCancelled;"}}}});define("odsp-next/controls/list/react/tilesList/TilesList",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Fabric","@uifabric/experiments/lib/TilesList","office-ui-fabric-react/lib/Utilities","./ItemTileCell","../SelectionManager","office-ui-fabric-react/lib/MarqueeSelection","office-ui-fabric-react/lib/Selection","../DefaultClickActionManager","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/scope/Scope"],function(e,t,a,n,i,r,o,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b={small:{tileDefaultHeight:135,tileDefaultWidth:138,documentGroupTileMargin:12,photoGroupTileMargin:8,groupMargin:40},large:{tileDefaultHeight:171,tileDefaultWidth:176,documentGroupTileMargin:8,photoGroupTileMargin:8,groupMargin:40}},g=o.TilesList,_=function(o){a.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._scope=new f.default;i._observables=i._scope.attach(new i.context.dependencies.observablesFactoryType({owner:i}));i._onRenderItemTileDocumentCell=i._getOnRenderItemTileCell("document");i._onRenderItemTileMediaCell=i._getOnRenderItemTileCell("media");i.state={cells:i._getCells(i.props),requiredRange:{start:0,end:0}};i._requiredIndices={};i._onCalculateRequiredRange=i._async.debounce(i._onCalculateRequiredRange,50);return i}e.prototype.componentDidMount=function(){var e=this,t=this.props,i=t.onUpdateRequiredRange,o=t.onLayoutRenderComplete;i&&i(this.state.requiredRange);o&&this._async.setImmediate(function(){o()});this._async.setImmediate(function(){e._focusZone&&e._focusZone.focus()})};e.prototype.componentWillReceiveProps=function(e){var i=this;e.itemSetContent===this.props.itemSetContent&&e.tilesListSize===this.props.tilesListSize||this.setState(function(e,t){return{cells:i._getCells(t)}})};e.prototype.componentDidUpdate=function(e,t){var i=this.props,o=i.onUpdateRequiredRange,r=i.onLayoutRenderComplete;o&&t.requiredRange!==this.state.requiredRange&&o(this.state.requiredRange);r&&t.cells!==this.state.cells&&this._async.setImmediate(function(){r()});this.props.setKey!==e.setKey&&(this._needsFocus=!0)};e.prototype.render=function(){var e=this.context.dependencies.selection;return n.createElement(r.Fabric,null,n.createElement(c.MarqueeSelection,{selection:e,onShouldStartSelection:this._onShouldStartSelection},n.createElement(u.SelectionZone,{selection:e,selectionMode:this.context.dependencies.selectionMode,onItemInvoked:this._onItemInvoked,enterModalOnTouch:!0,disableAutoSelectOnInputElements:!0},n.createElement(g,{role:"list",focusZoneComponentRef:this._onFocusZoneComponentRef,items:this.state.cells}))))};e.prototype._getOnRenderItemTileCell=function(i){var o=this,r=this.context.dependencies.itemTileCellType;return function(e,t){return e.key?n.createElement(r,{itemKey:e.key,itemIndex:e.index,itemCount:e.count,itemTileType:i,contentSize:t,tileSize:e.tileSize,onDidMount:o._onCellDidMount}):n.createElement(v,{index:e.index,onMount:o._onPlaceholderMount,onUnmount:o._onPlaceholderUnmount})}};e.prototype._onCellDidMount=function(){var e=this;if(this._needsFocus){this._needsFocus=!1;this._async.setImmediate(function(){e._focusZone&&e._focusZone.focus()})}};e.prototype._onPlaceholderMount=function(e,t){this._requiredIndices[e]=t;this._onCalculateRequiredRange()};e.prototype._onPlaceholderUnmount=function(e){delete this._requiredIndices[e];this._onCalculateRequiredRange()};e.prototype._onFocusZoneComponentRef=function(e){this._focusZone=e};e.prototype._onCalculateRequiredRange=function(){var s=this;this.setState(function(e,t){var i=t.itemSetContent.items.length,o=0;for(var r in s._requiredIndices){var n=s._requiredIndices[r];i=Math.min(i,n);o=Math.max(o,n+1)}return a.__assign({},e,i<o?{requiredRange:{start:i,end:o}}:{})})};e.prototype._onItemInvoked=function(e,t,i){if(this.context.dependencies.defaultClickActionManager.invokeItem(e,t,i)){i.stopPropagation();i.preventDefault()}};e.prototype._getCells=function(e){for(var t=[],i=e.itemSetContent,o=e.tilesListSize,r=void 0===o?"large":o,n=i&&i.items||[],s=i&&i.groupings,a=s&&s[0].itemGroups||this._getDefaultGroup(n),l=b[r],d=0,c=0;c<a.length;c++){for(var u=a[c],p=[],m="photo"===u.groupingId?"media":"document";(d<u.startIndex+u.count||c===a.length-1)&&d<n.length;d++){var h=this._observables.peekUnwrap(n[d]),f=h?h.key:void 0,g="item-"+(f||d);p.push({key:g,content:{key:f,index:d,count:n.length,tileSize:r},desiredSize:this._getDesiredSize(h,r,m),onRender:"photo"===u.groupingId?this._onRenderItemTileMediaCell:this._onRenderItemTileDocumentCell})}t.push({key:"group-"+u.groupingId+"-"+u.name,mode:"photo"===u.groupingId?2:"large"===r?1:3,marginBottom:l.groupMargin,spacing:"photo"===u.groupingId?l.photoGroupTileMargin:l.documentGroupTileMargin,minRowHeight:l.tileDefaultHeight,items:p})}return t};e.prototype._getDefaultGroup=function(e){return[{groupingId:"document",startIndex:0,count:e.length}]};e.prototype._getDesiredSize=function(e,t,i){if(e){var o=e.thumbnail;if("media"===i&&o&&o.width)return{width:o.width,height:o.height}}var r=b[t];return{width:r.tileDefaultWidth,height:r.tileDefaultHeight}};e.prototype._onShouldStartSelection=function(e){for(var t=e.target;t&&t!==document.body;){if(null!==t.getAttribute("data-selection-index"))return!1;t=t.parentElement}return!0};e.contextTypes={dependencies:i.object.isRequired};a.__decorate([s.autobind],e.prototype,"_onCellDidMount",null);a.__decorate([s.autobind],e.prototype,"_onPlaceholderMount",null);a.__decorate([s.autobind],e.prototype,"_onPlaceholderUnmount",null);a.__decorate([s.autobind],e.prototype,"_onFocusZoneComponentRef",null);a.__decorate([s.autobind],e.prototype,"_onItemInvoked",null);a.__decorate([s.autobind],e.prototype,"_onShouldStartSelection",null);return e}(s.BaseComponent);t.TilesList=_;var y=0,v=function(i){a.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._key=""+ ++y;return t}e.prototype.componentDidMount=function(){this.props.onMount(this._key,this.props.index)};e.prototype.componentWillUnmount=function(){this.props.onUnmount(this._key)};e.prototype.render=function(){return null};return e}(n.Component);t.Placeholder=v;t.typeResourceKey=m.createResolvedComponentTypeResourceKey(e("module").id,_,{itemTileCellType:l.typeResourceKey.local,selection:d.resourceKey,selectionMode:d.selectionModeResourceKey,defaultClickActionManager:p.resourceKey.local,observablesFactoryType:h.observablesFactoryTypeResourceKey})});define("@uifabric/experiments/lib/TilesList",["require","exports","tslib","./components/TilesList/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@uifabric/experiments/lib/components/TilesList/index",["require","exports","tslib","./TilesList","./TilesList.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("@uifabric/experiments/lib/components/TilesList/TilesList",["require","exports","tslib","react","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Utilities","./TilesList.scss","../Shimmer/Shimmer"],function(e,t,C,x,a,l,S,i,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=i,o=function(i){C.__extends(e,i);function e(e,t){var w=i.call(this,e,t)||this;w._onRenderPage=function(e,t){for(var g,a,b=e.page,i=e.className,o=C.__rest(e,["page","className"]),r=b.items,_=b.data,y=r||[],l=[],d=w.state.cells[b.startIndex-1],c=w.state.cells[b.startIndex+b.itemCount],u=y.length,v=0,n=function(p){for(var m=y[p].grid,e=m.isPlaceholder,h=[],f=_.pageWidths[b.startIndex+p],t=function(){var i=y[p],o=b.startIndex+p,r=_.rows[o];r&&(g=r);var n=_.cellSizes[o];if(g){var e=g.scaleFactor,t=g.isLastRow,s=g.maxScaleFactor;if(s){var a=Math.min(s,m.maxScaleFactor);n={width:n.width*a,height:2===m.mode?n.height*a:m.minRowHeight}}else if((2===m.mode||3===m.mode)&&(!t||e<=m.maxScaleFactor)){a=Math.min(m.maxScaleFactor,e);n={width:n.width*a,height:2===m.mode?n.height*a:m.minRowHeight}}}var l=function(e){return x.createElement("div",{key:m.key+"-item-"+i.key+(e?"-"+e:""),"data-item-index":o,className:S.css("ms-List-cell",w._onGetCellClassName(),(t={},t["ms-TilesList-cell--firstInRow "+R.cellFirstInRow]=!!r,t)),style:C.__assign({},w._onGetCellStyle(i,g))},w._onRenderCell(i,n));var t};if(i.isPlaceholder&&0!==m.mode){var d=Math.floor(f/(m.spacing+n.width)),c=3*d;v=d*n.width+m.spacing*(d-1);for(var u=0;u<c;u++)h.push(l(u))}else{v=n.width/3;h.push(l())}};p<u&&y[p].grid===m;p++)t();var i,o=d&&d.grid===m,r=c&&c.grid===m,n=m.spacing/2,s=x.createElement("div",{key:m.key,className:S.css("ms-TilesList-grid",(i={},i[""+R.grid]=0!==m.mode,i[""+R.shimmeredList]=e,i)),style:{width:f+"px",margin:-n+"px",marginTop:o?"0":m.marginTop-n+"px",marginBottom:r?"0":m.marginBottom-n+"px"}},h);l.push(e?x.createElement(k.Shimmer,{key:p,customElementsGroup:s,widthInPixel:v}):s);a=p},s=0;s<u;){n(s);s=a}return x.createElement("div",C.__assign({},o,{className:S.css(i,w._onGetPageClassName())}),l)};w._getPageSpecification=function(e,t){w._pageSpecificationCache&&w._pageSpecificationCache.width!==t.width&&(w._pageSpecificationCache=void 0);w._pageSpecificationCache||(w._pageSpecificationCache={width:t.width,byIndex:{}});var i=w._pageSpecificationCache;if(i.byIndex[e])return i.byIndex[e];for(var o,r=w.state.cells,n=Math.min(r.length,e+100),s=0,a=0,l=e,d=!0,c={},u={},p={};l<n;){var m=r[l].grid;s=0;a=l;var h=t.width+m.spacing;p[l]=h;var f=c[l]={scaleFactor:1};if(0!==m.mode){for(;l<n&&r[l].grid===m;l++){var g=r[l].aspectRatio;if(h<s+(_=g*m.minRowHeight+m.spacing)){var b=m.spacing*(l-a);f.scaleFactor=(h-b)/(s-b)}s+=_;u[l]={width:g*m.minRowHeight,height:m.minRowHeight};if(h<s){s=_;f=c[a=l]={scaleFactor:1}}}r[l]&&r[l].grid===m?d=!1:f.isLastRow=!0;if(s<h){b=m.spacing*(l-a);f.scaleFactor=(h-b)/(s-b);if((2===m.mode||3===m.mode)&&f.isLastRow&&0<l-a)for(var _=(s-b)/(l-a)+m.spacing,y=s,v=l;;v++){if(h<y+_){var C=m.spacing*(v-a);f.maxScaleFactor=(h-C)/(y-C);break}y+=_}}!d&&f.scaleFactor>(2===m.mode||3===m.mode?m.maxScaleFactor:1)&&(o=r.slice(a,l))}else{d=!0;u[l]={width:t.width,height:0};l++}}var x={itemCount:l-(o?o.length:0)-e,data:{pageWidths:p,rows:c,extraCells:o,cellSizes:u}};return i.byIndex[e]=x};w._onGetCellClassName=function(){return R.listCell};w._onGetPageClassName=function(){return R.listPage};w._onGetCellStyle=function(e,t){var i=e.grid,o=i.mode,r=i.maxScaleFactor,n=e.grid;if(0===o)return{};var s=e.aspectRatio||1,a=n.spacing/2,l=2===o||3===o,d=s*n.minRowHeight;return{flex:l?s+" "+s+" "+d+"px":"0 0 "+d+"px",maxWidth:(t&&t.maxScaleFactor?d*Math.min(t.maxScaleFactor,r):l&&(!t||!t.isLastRow||t.scaleFactor<=r)?d*r:d)+"px",margin:e.isPlaceholder?0:a+"px",borderStyle:e.isPlaceholder?"solid":"none",borderWidth:e.isPlaceholder?a+"px":0}};w.state={cells:w._getCells(e.items)};return w}e.prototype.componentWillReceiveProps=function(e){e.items!==this.props.items&&this.setState({cells:this._getCells(e.items)})};e.prototype.componentWillUpdate=function(e,t){t.cells!==this.state.cells&&(this._pageSpecificationCache=void 0)};e.prototype.render=function(){var e=this.state.cells,t=this.props,i=t.className,o=(t.onActiveElementChanged,t.items,t.cellsPerPage,t.ref),r=t.role,n=t.focusZoneComponentRef,s=C.__rest(t,["className","onActiveElementChanged","items","cellsPerPage","ref","role","focusZoneComponentRef"]);return x.createElement(l.FocusZone,C.__assign({role:r},s,{ref:o,componentRef:n,className:S.css("ms-TilesList",i),direction:l.FocusZoneDirection.bidirectional,onActiveElementChanged:this.props.onActiveElementChanged}),x.createElement(a.List,{items:e,role:r?"presentation":void 0,getPageSpecification:this._getPageSpecification,onRenderPage:this._onRenderPage}))};e.prototype._onRenderCell=function(e,t){if(0===e.grid.mode)return x.createElement("div",{className:S.css(R.header)},e.onRender(e.content,{width:0,height:0}));var i=1/e.aspectRatio;return x.createElement("div",{role:"presentation",className:S.css(R.cell),style:3===e.grid.mode?{height:e.grid.minRowHeight+"px"}:{paddingTop:(100*i).toFixed(2)+"%"}},x.createElement("div",{role:"presentation",className:S.css(R.cellContent)},e.onRender(e.content,t)))};e.prototype._getCells=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i];if(r.items)for(var n=r.spacing,s=void 0===n?0:n,a=r.maxScaleFactor,l=void 0===a?1.5:a,d=r.marginBottom,c=void 0===d?0:d,u=r.marginTop,p=void 0===u?0:u,m=r.minAspectRatio,h=void 0===m?.5:m,f=r.maxAspectRatio,g=void 0===f?3:f,b={minRowHeight:r.minRowHeight,spacing:s,mode:r.mode,key:"grid-"+r.key,maxScaleFactor:l,marginTop:r.isPlaceholder?0:p,marginBottom:r.isPlaceholder?0:c,isPlaceholder:r.isPlaceholder},_=0,y=r.items;_<y.length;_++){var v=y[_],C=v.desiredSize,x=Math.min(g,Math.max(h,C&&C.width/C.height||1));t.push({aspectRatio:x,content:v.content,onRender:v.onRender,grid:b,key:v.key,isPlaceholder:v.isPlaceholder})}else t.push({aspectRatio:1,content:r.content,onRender:r.onRender,grid:{minRowHeight:0,spacing:0,mode:0,key:"grid-header-"+r.key,maxScaleFactor:1,marginBottom:0,marginTop:0,isPlaceholder:r.isPlaceholder},key:"header-"+r.key,isPlaceholder:r.isPlaceholder})}return t};return e}(x.Component);t.TilesList=o});define("@uifabric/experiments/lib/components/TilesList/TilesList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".listCell_4aa03851{display:block;margin:0;border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.listPage_4aa03851{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.cell_4aa03851{display:block;position:relative}.cellContent_4aa03851{position:absolute;top:0;left:0;bottom:0;right:0}.cellFirstInRow_4aa03851{display:block}.sizer_4aa03851{display:block;visibility:hidden}.grid_4aa03851{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-line-pack:start;align-content:flex-start}.shimmeredList_4aa03851::after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(30%, transparent), color-stop(65%, "},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"), to("},{theme:"white",defaultValue:"#ffffff"},{rawString:"));background-image:linear-gradient(to bottom, transparent 30%, "},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:" 65%, "},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}.none_4aa03851{display:block}\n"}]);t.listCell="listCell_4aa03851";t.listPage="listPage_4aa03851";t.cell="cell_4aa03851";t.cellContent="cellContent_4aa03851";t.cellFirstInRow="cellFirstInRow_4aa03851";t.sizer="sizer_4aa03851";t.grid="grid_4aa03851";t.shimmeredList="shimmeredList_4aa03851";t.none="none_4aa03851"});define("@uifabric/experiments/lib/components/TilesList/TilesList.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.stack=1]="stack";e[e.fill=2]="fill";e[e.fillHorizontal=3]="fillHorizontal"}(t.TilesGridMode||(t.TilesGridMode={}))});define("odsp-next/controls/list/react/tilesList/ItemTileCell",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/async/Promise","../../../../models/store/ItemsStore","../../../itemTile/react/ItemTile","@ms/odsp-utilities/lib/scope/Scope","../../../../resources/ControlResourceKeys","../../../../resources/DataSourceResourceKeys","../../../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/base/BaseModel","../SelectionManager","../DefaultClickActionManager","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","@ms/odsp-utilities/lib/modules/Modules","../../../fileHoverCard/react/FileHoverCardHelper","../ItemDragDrop","@ms/odsp-utilities/lib/resources/ResourceScope"],function(d,e,c,u,t,i,p,o,r,a,n,s,m,l,h,f,g,b,_,y,v,C,x){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.defaultClickActionTypeResourceKey=new b.ResourceKey({name:d("module").id+".defaultClickActionType",factory:{dependencies:{defaultClickActionManager:f.resourceKey.local},create:function(e){return{instance:e.defaultClickActionManager.DefaultClickAction}}}});var w=function(s){c.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,o=i.context.dependencies;i._scope=new a.default;i._observables=i._scope.attach(new o.observablesFactoryType({owner:i}));var r=o.itemsStore.getItem(i.props.itemKey),n=i._observables.peekUnwrap(r);i._defaultClickAction=i._scope.attach(new o.defaultClickActionType({item:r,userInvokedItem:!0,sourceEngagement:"ItemTile.Click"}));i.resources=o.resources;i.state={item:n,isAvailable:i._defaultClickAction.isAvailable.peek(),url:o.urlDataSource.getDefaultClickUrl(n,{viewParams:o.viewParams.peek()})};return i}e.prototype.componentDidMount=function(){var i=this,o=this.context.dependencies,e=this._scope,t=o.itemsStore.getItem(this.props.itemKey);e.attach(t.subscribe(function(e){i.setState({item:e})}));e.attach(this._defaultClickAction.isAvailable.subscribe(function(e){i.setState({isAvailable:e})}));e.attach(o.viewParams.subscribe(function(t){i.setState(function(e){return{url:o.urlDataSource.getDefaultClickUrl(e.item,{viewParams:t})}})}));this.props.onDidMount&&this.props.onDidMount()};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.render=function(){var i=this,o=this.state,r=this.context.dependencies.itemTileType,e=this.context.dependencies.itemDragDropType,n=this.context.dependencies.selection,t=u.createElement(e,{item:o.item,itemIndex:this.props.itemIndex},function(e){var t=e.isDropping;return u.createElement(r,{"data-is-draggable":!0,isDropping:t,tileSize:i.props.tileSize,contentSize:i.props.contentSize,itemTileType:i.props.itemTileType,href:o.url,invokeSelection:!0,role:"listitem","aria-setsize":i.props.itemCount,"aria-posinset":i.props.itemIndex+1,selection:n.canSelectItem(o.item)?i.context.dependencies.selection:void 0,selectionIndex:i.props.itemIndex,item:o.item})});if(v.shouldEnableFileHoverCard(o.item,this.resources)){var s={item:o.item,resources:this.resources,target:void 0},a=this.resources.consume(m.bundleLoader.optional),l={modulePath:"odsp-next/controls/fileHoverCard/react/FileHoverCard",moduleLoader:{load:function(e){return y.loadModuleExport({path:"odsp-next/controls/fileHoverCard/react/FileHoverCard",getModule:function(){return new p.default(function(e,t){d(["odsp-next/controls/fileHoverCard/react/FileHoverCard"],e,t)})},getExport:function(e){return e.default}})},parse:void 0},customWaiter:a&&a.waitForPLT(),props:s};t=u.createElement("div",{className:"FileHoverCardSection",ref:function(e){return s.target=e}},t,u.createElement(_.ReactDeferredComponent,c.__assign({},l)))}return t};e.contextTypes={dependencies:t.object.isRequired};return e}(i.BaseComponent);e.ItemTileCell=w;e.typeResourceKey=g.createResolvedComponentTypeResourceKey(d("module").id,w,{urlDataSource:s.url,viewParams:n.viewParams,itemsStore:o.resourceKey,defaultClickActionType:e.defaultClickActionTypeResourceKey.local,observablesFactoryType:l.observablesFactoryTypeResourceKey,selection:h.resourceKey,itemTileType:r.typeResourceKey,itemDragDropType:C.typeResourceKey,resources:x.resourceScopeKey})});define("odsp-next/controls/itemTile/react/ItemTile",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","@uifabric/experiments/lib/FolderCover","../../../models/item/SharingType","@uifabric/experiments/lib/components/signals/Signals","../../../dataSources/base/AriaHelper","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/string/TimeFormatter","office-ui-fabric-react/lib/Icon","./FileTypeIcon","../../image/react/ImageFrame","../../../models/item/LifeCycleStatus","office-ui-fabric-react/lib/Utilities","@ms/odsp-shared-react/lib/utilities/resources/Resources","../ItemTile.resx","../../itemActivityField/ItemActivityField","../../../models/itemActivityField/ItemActivityFieldFeature.key","./ItemTile.css"],function(e,t,b,_,y,v,i,r,C,n,s,a,o,l,d,x,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w={small:{iconSize:48},large:{iconSize:64}},h=function(o){b.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.state={isThumbnailFailed:!1,isThumbnailLoaded:!1,isThumbnailOverdue:!1};return i}e.prototype.render=function(){var e=this.props,t=e.item,i=e.tileSize,o=void 0===i?"large":i,r=e.itemTileType,n=void 0===r?"document":r,s=e.isDropping,a=void 0!==s&&s,l=b.__rest(e,["item","tileSize","itemTileType","isDropping"]),d=_.createElement(y.Tile,b.__assign({tileSize:o},l,{ariaLabel:C.getRowAriaLabel(t),onClick:S,"data-automationid":t.displayName||t.name,showForegroundFrame:"document"===n&&!t.folder,showBackgroundFrame:"media"===n,hideForeground:t.thumbnail&&!this.state.isThumbnailLoaded&&!this.state.isThumbnailFailed&&!this.state.isThumbnailOverdue,hideBackground:!t.thumbnail||!this.state.isThumbnailLoaded||this.state.isThumbnailFailed||this.state.isThumbnailOverdue,className:x.css("od-ItemTile2","od--hasContextMenu",{"od-ItemTile2--isSmall":"small"===o,"od-ItemTile2--isLarge":"large"===o,"od-ItemTile2--isDropping":a}),itemName:this._getItemName(),itemActivity:this._getItemActivity()})),c=y.getTileLayout(d),u=c.foregroundSize,p=void 0===u?{width:0,height:0}:u,m=c.backgroundSize,h=void 0===m?{width:0,height:0}:m,f=this._renderForeground(p),g=this._renderBackground(h);return y.renderTileWithLayout(d,{foreground:f,background:g})};e.prototype.componentDidMount=function(){var e=this;this._async.setTimeout(function(){e.setState(function(e){return e.isThumbnailLoaded||e.isThumbnailFailed?{}:{isThumbnailOverdue:!0}})},500)};e.prototype._getItemName=function(){var e=this.props.item,t=e.displayName||e.name,i=this._getLifeCycleSignal();if(t||i)return _.createElement(r.SignalField,{className:"od-ItemTile2-signalField",before:i},t)};e.prototype._getFolderCoverSignal=function(){var e=this.props.item;return e.folder&&!e.list&&e.sharingType!==i.default.Private?_.createElement(r.SharedSignal,null):null};e.prototype._getLifeCycleSignal=function(){var e=this.props.item,t=d.getStatusToDisplay(e.lifeCycleStatus);return e.hasMissingMetadata?_.createElement(r.MissingMetadataSignal,{key:"missingMetadata"}):e.itemStatus?_.createElement(r.BlockedSignal,{key:"blocked"}):3===t?_.createElement(r.TrendingSignal,{key:"trending"}):2===t?_.createElement(r.NewSignal,{key:"new",title:u.strings.lifeCycleSignalNewTooltip}):1===t?_.createElement(r.ExternalSignal,{key:"external"}):4===t?_.createElement(r.ATPSignal,{key:"malwareDetected"}):void 0};e.prototype._getItemActivity=function(){var e=this._getSocialSignal(),t=this.context.dependencies.isActivityFieldEnabled&&this.context.dependencies.isActivityFieldVisible()?p.getViewableItemActivity(this.props.item):void 0,i=this._getMetadata(),o=this._getAnnotation();return e||i||o?_.createElement(r.SignalField,{className:"od-ItemTile2-signalField",before:[o,e]},t?_.createElement(p.ItemActivityField,{activity:t,hideDate:!0}):i):null};e.prototype._getSocialSignal=function(){var e=this.props.item;return e.folder||e.list||e.sharingType===i.default.Private?null:_.createElement(r.SharedSignal,{key:"shared"})};e.prototype._getMetadata=function(){var e=this.props.item;return e.dateModified?e.dateModified:e.dateModifiedTime?n.getFriendlyDateTimeStringPast(e.dateModifiedTime):null};e.prototype._getAnnotation=function(){var e=this.props.item;if(e.video||e.audio){var t=(e.video||e.audio).duration;if(t)return[_.createElement(r.Signal,{key:"play"},_.createElement(a.Icon,{iconName:"Play"})),_.createElement("span",{key:"duration",className:"od-ItemTile2-duration"},s.formatTime(t))]}return null};e.prototype._renderForeground=function(e){var t=this.props,i=t.item,o=t.tileSize,r=void 0===o?"large":o,n=t.itemTileType,s=void 0===n?"document":n;if("media"===s&&i.thumbnail&&!this.state.isThumbnailFailed&&!this.state.isThumbnailOverdue)return null;if(i.folder){var a=i.folder,l=a.covers,d=(void 0===l?[]:l)[0],c=void 0===d?void 0:d,u=a.totalCount,p=void 0===u?i.childCount:u,m=_.createElement(v.FolderCover,{folderCoverSize:this.props.tileSize,folderCoverType:c?"media":"default",hideContent:c&&(this.state.isThumbnailFailed||!this.state.isThumbnailLoaded)||!c&&!p,metadata:p,signal:this._getFolderCoverSignal()}),h=v.getFolderCoverLayout(m).contentSize;return _.createElement("span",{className:"od-ItemTile2-folderCover"},v.renderFolderCoverWithLayout(m,{children:c?this._renderThumbnail({thumbnail:c,thumbnailSize:h,fit:"cover",onErrorChanged:this._onThumbnailErrorChanged,onIsLoadedChanged:this._onThumbnailIsLoadedChanged}):p?_.createElement("span",{className:"od-ItemTile2-blankCover",style:{width:h.width+"px",height:h.height+"px"}}):null}))}var f=this.context.dependencies.fileTypeIconType;if("media"!==s&&i.thumbnail&&!this.state.isThumbnailFailed){var g=this.state.isThumbnailOverdue;return[_.createElement("span",{key:"image",className:x.css("od-ItemTile2-image",{"od-ItemTile2-image--overdue":g})},this._renderThumbnail({thumbnail:(i.orientedThumbnail||i).thumbnail,rotation:i.orientedThumbnail&&i.orientedThumbnail.rotation||void 0,thumbnailSize:e,fit:"contain",onErrorChanged:this._onThumbnailErrorChanged,onIsLoadedChanged:this._onThumbnailIsLoadedChanged})),_.createElement("span",{key:"icon",className:x.css({"od-ItemTile2-icon":g,"od-ItemTile2-smallIcon":!g})},_.createElement(f,{item:i,isDisabled:!1,preferAppIcon:!g,size:g?w[r].iconSize:16}))]}return _.createElement("span",{key:"icon",className:"od-ItemTile2-icon"},_.createElement(f,{item:i,isDisabled:!1,size:w[r].iconSize}))};e.prototype._renderBackground=function(e){var t=this.props,i=t.item,o=t.itemTileType,r=void 0===o?"document":o;return i.thumbnail&&"media"===r?this._renderThumbnail({thumbnail:(i.orientedThumbnail||i).thumbnail,rotation:i.orientedThumbnail&&i.orientedThumbnail.rotation||void 0,thumbnailSize:e,fit:"cover",onErrorChanged:this._onThumbnailErrorChanged,onIsLoadedChanged:this._onThumbnailIsLoadedChanged}):null};e.prototype._renderThumbnail=function(e){if(!e.thumbnail)return null;var t=this.context.dependencies.imageFrameType;return _.createElement(t,{key:"thumbnail",image:e.thumbnail,rotation:e.rotation,desiredSize:e.thumbnailSize,fit:e.fit,onErrorChanged:e.onErrorChanged,onIsLoadedChanged:e.onIsLoadedChanged})};e.prototype._onThumbnailErrorChanged=function(e){this.setState({isThumbnailFailed:!0,isThumbnailOverdue:!1})};e.prototype._onThumbnailIsLoadedChanged=function(e){this.setState({isThumbnailLoaded:!0,isThumbnailOverdue:!1})};e.contextTypes=b.__assign({},c.RESOLVED_COMPONENT_CONTEXT_TYPES);b.__decorate([x.autobind],e.prototype,"_onThumbnailErrorChanged",null);b.__decorate([x.autobind],e.prototype,"_onThumbnailIsLoadedChanged",null);return e}(x.BaseComponent);t.ItemTile=h;function S(e){e.preventDefault()}t.typeResourceKey=c.createResolvedComponentTypeResourceKey(e("module").id,h,{fileTypeIconType:o.typeResourceKey,imageFrameType:l.typeResourceKey,isActivityFieldEnabled:m.isActivityFieldEnabledResourceKey,isActivityFieldVisible:m.isActivityFieldVisibleResourceKey.lazy})});define("@uifabric/experiments/lib/Tile",["require","exports","tslib","./components/Tile/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@uifabric/experiments/lib/components/Tile/index",["require","exports","tslib","./Tile","./ShimmerTile/ShimmerTile"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("@uifabric/experiments/lib/components/Tile/Tile",["require","exports","tslib","react","office-ui-fabric-react/lib/Check","office-ui-fabric-react/lib/Selection","../../Utilities","./Tile.scss","../signals/Signal.scss","office-ui-fabric-react/lib/components/Check/Check.scss"],function(e,m,M,E,r,o,A,N,t,i){"use strict";Object.defineProperty(m,"__esModule",{value:!0});var H=N,O=t,n=i;!function(e){e[e.nameplatePadding=12]="nameplatePadding";e[e.largeNameplateNameHeight=15]="largeNameplateNameHeight";e[e.smallNameplateNameHeight=12]="smallNameplateNameHeight";e[e.nameplateMargin=0]="nameplateMargin";e[e.largeNameplateActivityHeight=20]="largeNameplateActivityHeight";e[e.smallNameplateActivityHeight=20]="smallNameplateActivityHeight";e[e.foregroundMargin=16]="foregroundMargin"}(m.TileLayoutValues||(m.TileLayoutValues={}));m.TileLayoutSizes={small:{nameplatePadding:12,nameplateNameHeight:12,nameplateMargin:0,nameplateActivityHeight:20,foregroundMargin:16},large:{nameplatePadding:12,nameplateNameHeight:15,nameplateMargin:0,nameplateActivityHeight:20,foregroundMargin:16}};var s=function(l){M.__extends(e,l);function e(e,t){var s=l.call(this,e,t)||this;s._onSelectionChange=function(){var e=s.props,t=e.selection,i=e.selectionIndex,o=void 0===i?-1:i,r=-1<o&&!!t&&t.isIndexSelected(o),n=!!t&&!!t.isModal&&t.isModal();s.setState({isSelected:r,isModal:n})};s._nameId=A.getId("Tile-name");s._activityId=A.getId("Tile-activity");s._labelId=A.getId("Tile-label");s._descriptionId=A.getId("Tile-description");var i=e.selectionIndex,o=void 0===i?-1:i,r=e.selection,n=!!r&&-1<o&&r.isIndexSelected(o),a=!!r&&!!r.isModal&&r.isModal();s.state={isSelected:n,isModal:a};return s}e.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.selection,o=t.selectionIndex,r=e.selection,n=e.selectionIndex,s=void 0===n?-1:n;if(i!==r||o!==s){var a=!!r&&-1<s&&r.isIndexSelected(s),l=!!r&&r.isModal&&r.isModal();this.setState({isSelected:a,isModal:l})}};e.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events.on(e,o.SELECTION_CHANGE,this._onSelectionChange)};e.prototype.componentDidUpdate=function(e){var t=this.props.selection,i=e.selection;if(t!==i){i&&this._events.off(i);t&&this._events.on(t,o.SELECTION_CHANGE,this._onSelectionChange)}};e.prototype.render=function(){var e,t=this.props,i=(t.children,t.selectionIndex),o=void 0===i?-1:i,r=t.invokeSelection,n=void 0!==r&&r,s=t.selection,a=t.background,l=t.foreground,d=t.showBackgroundFrame,c=void 0!==d&&d,u=t.showForegroundFrame,p=void 0!==u&&u,m=t.hideBackground,h=void 0!==m&&m,f=t.hideForeground,g=void 0!==f&&f,b=t.itemName,_=t.itemActivity,y=(t.componentRef,t.className),v=t.tileSize,C=void 0===v?"large":v,x=(t.contentSize,t.ariaLabel),w=t.descriptionAriaLabel,S=t.href,k=t.onClick,R=M.__rest(t,["children","selectionIndex","invokeSelection","selection","background","foreground","showBackgroundFrame","showForegroundFrame","hideBackground","hideForeground","itemName","itemActivity","componentRef","className","tileSize","contentSize","ariaLabel","descriptionAriaLabel","href","onClick"]),D=this.state,T=D.isSelected,I=void 0!==T&&T,F=D.isModal,P=void 0!==F&&F,B=!!s&&-1<o,L=!(!S&&!k&&!n||P);return E.createElement("div",M.__assign({"aria-selected":I},R,{"aria-labelledby":x?this._labelId:this._nameId,"aria-describedby":w?this._descriptionId:this._activityId,className:A.css("ms-Tile",y,H.tile,(e={},e["ms-Tile--isSmall "+H.isSmall]="small"===C,e["ms-Tile--isLarge "+H.isLarge]="large"===C,e["ms-Tile--hasBackgroundFrame "+H.hasBackgroundFrame]=c,e["ms-Tile--hasForegroundFrame "+H.hasForegroundFrame]=p,e["ms-Tile--isSelected "+H.selected+" "+O.selected]=I,e["ms-Tile--isSelectable "+H.selectable]=B,e["ms-Tile--hasBackground "+H.hasBackground]=!!a,e[O.dark]=!!a&&!h,e["ms-Tile--showBackground "+H.showBackground]=!h,e["ms-Tile--invokable "+H.invokable]=L,e["ms-Tile--uninvokable "+H.uninvokable]=!L,e["ms-Tile--isDisabled "+H.disabled]=!B&&!L,e["ms-Tile--showCheck "+H.showCheck]=P,e)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-disable-click-on-enter":!0,"data-selection-index":-1<o?o:void 0}),E.createElement("a",{href:S,onClick:k,ref:this.props.linkRef,"data-selection-invoke":!!(L&&-1<o)||void 0,className:A.css("ms-Tile-link",H.link)},x?E.createElement("span",{id:this._labelId,className:A.css("ms-Tile-label",N.label)},x):null,a?this._onRenderBackground({background:a,hideBackground:h}):null,l?this._onRenderForeground({foreground:l,hideForeground:g}):null,b||_?this._onRenderNameplate({name:b,activity:_}):null),w?E.createElement("span",{id:this._descriptionId,className:A.css("ms-Tile-description",N.description)},w):null,B?this._onRenderCheck({isSelected:I}):null)};e.prototype._onRenderBackground=function(e){var t,i=e.background,o=e.hideBackground;return E.createElement("span",{className:A.css("ms-Tile-background",H.background,(t={},t["ms-Tile-background--hide "+H.backgroundHide]=o,t))},i)};e.prototype._onRenderForeground=function(e){var t,i=e.foreground,o=e.hideForeground;return E.createElement("span",{role:"presentation",className:A.css("ms-Tile-aboveNameplate",H.aboveNameplate)},E.createElement("span",{role:"presentation",className:A.css("ms-Tile-content",H.content)},E.createElement("span",{role:"presentation",className:A.css("ms-Tile-foreground",H.foreground,(t={},t["ms-Tile-foreground--hide "+H.foregroundHide]=o,t))},i)))};e.prototype._onRenderNameplate=function(e){var t=e.name,i=e.activity;return E.createElement("span",{className:A.css("ms-Tile-nameplate",H.nameplate)},t?E.createElement("span",{id:this._nameId,className:A.css("ms-Tile-name",H.name)},t):null,i?E.createElement("span",{id:this._activityId,className:A.css("ms-Tile-activity",H.activity)},i):null)};e.prototype._onRenderCheck=function(e){var t,i=e.isSelected,o=this.props.toggleSelectionAriaLabel;return E.createElement("span",{role:"checkbox","aria-label":o,className:A.css("ms-Tile-check",H.check,n.checkHost,(t={},t[n.hostShowCheck]=this.state.isModal,t)),"data-selection-toggle":!0,"aria-checked":i},E.createElement(r.Check,{checked:i}))};return e}(A.BaseComponent);m.Tile=s;m.getTileLayout=function(e){var t=e.props,i=t.contentSize,o=t.tileSize,r=void 0===o?"large":o;if(!i)return{};var n=i.width,s=m.TileLayoutSizes[r],a=s.nameplatePadding,l=s.nameplateMargin,d=s.nameplateActivityHeight,c=s.nameplateNameHeight,u=s.foregroundMargin,p=0;if(t.itemName||t.itemActivity){p+=2*a;t.itemName&&(p+=c);t.itemActivity&&(p+=d+l)}return{foregroundSize:{width:n-2*u,height:i.height-u-p},backgroundSize:i}};m.renderTileWithLayout=function(e,t){var i=e.type;return E.createElement(i,M.__assign({},e.props,t))}});define("office-ui-fabric-react/lib/Selection",["require","exports","tslib","./utilities/selection/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@uifabric/experiments/lib/components/Tile/Tile.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".tile_04bd1798{display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-transition:-webkit-transform 0.1s linear;transition:-webkit-transform 0.1s linear;transition:transform 0.1s linear;transition:transform 0.1s linear, -webkit-transform 0.1s linear;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tile_04bd1798::-moz-focus-inner{border:0}.tile_04bd1798{outline:transparent}.tile_04bd1798.selectable_04bd1798:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.tile_04bd1798.selectable_04bd1798:hover.selected_04bd1798{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.tile_04bd1798.selected_04bd1798{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798:focus{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798:focus.selected_04bd1798{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798:focus.selected_04bd1798{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.tile_04bd1798.hasBackgroundFrame_04bd1798{-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);box-shadow:0 1px 3px 1px rgba(1,1,0,0.05)}.tile_04bd1798.hasBackgroundFrame_04bd1798.selectable_04bd1798:hover{outline:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798.hasBackgroundFrame_04bd1798:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ms-Fabric--isFocusVisible .tile_04bd1798.hasBackgroundFrame_04bd1798:focus.selected_04bd1798{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.tile_04bd1798.hasBackgroundFrame_04bd1798:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.tile_04bd1798.invokable_04bd1798:active{-webkit-transform:scale(0.95);transform:scale(0.95)}.label_04bd1798{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.description_04bd1798{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.link_04bd1798{position:absolute;top:0;left:0;bottom:0;right:0;text-decoration:none;color:inherit;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-ms-flex-line-pack:stretch;align-content:stretch;text-decoration:none;pointer-events:none}.link_04bd1798::-moz-focus-inner{border:0}.link_04bd1798{outline:transparent}.foreground_04bd1798{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;overflow:hidden;max-width:100%;max-height:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.tile_04bd1798.invokable_04bd1798 .foreground_04bd1798{pointer-events:auto;cursor:pointer}.foreground_04bd1798.foregroundHide_04bd1798{opacity:0}.hasForegroundFrame_04bd1798 .foreground_04bd1798{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);min-width:32px;min-height:32px}.hasForegroundFrame_04bd1798 .foreground_04bd1798:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_04bd1798{display:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:none;background-color:transparent;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px}.check_04bd1798::-moz-focus-inner{border:0}.check_04bd1798{outline:transparent}.check_04bd1798{position:absolute}.ms-Fabric--isFocusVisible .check_04bd1798:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}html[dir='ltr'] .check_04bd1798{right:0}html[dir='rtl'] .check_04bd1798{left:0}.tile_04bd1798.uninvokable_04bd1798 .check_04bd1798{width:100%;height:100%}.tile_04bd1798.selectable_04bd1798 .check_04bd1798{display:-webkit-box;display:-ms-flexbox;display:flex}.tile_04bd1798.selected_04bd1798 .check_04bd1798,.tile_04bd1798:hover .check_04bd1798,.tile_04bd1798.showCheck_04bd1798 .check_04bd1798{opacity:1}.ms-Fabric--isFocusVisible .check_04bd1798:focus{opacity:1}.ms-Fabric--isFocusVisible .tile_04bd1798:focus .check_04bd1798{opacity:1}.background_04bd1798{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.tile_04bd1798.invokable_04bd1798 .background_04bd1798{cursor:pointer;pointer-events:auto}.background_04bd1798.backgroundHide_04bd1798{opacity:0}.aboveNameplate_04bd1798{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;margin:16px 16px 0 16px}.content_04bd1798{position:absolute;top:0;left:0;bottom:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.hasForegroundFrame_04bd1798 .content_04bd1798{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.nameplate_04bd1798{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;position:relative;margin:auto 0 0 0;padding:12px 8px;text-align:center;z-index:0}.nameplate_04bd1798 .name_04bd1798{-webkit-transition:color 0.2s linear;transition:color 0.2s linear}.tile_04bd1798.invokable_04bd1798 .nameplate_04bd1798 .name_04bd1798{pointer-events:auto;cursor:pointer}.link_04bd1798:hover .nameplate_04bd1798 .name_04bd1798{text-decoration:underline}.nameplate_04bd1798 .activity_04bd1798{-webkit-transition:color 0.2s linear;transition:color 0.2s linear}.tile_04bd1798.hasBackgroundFrame_04bd1798 .nameplate_04bd1798{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:12px 10px}.signal_04bd1798{display:inline-block}html[dir='ltr'] .signal_04bd1798.storageSignal_04bd1798{margin-left:4px}html[dir='rtl'] .signal_04bd1798.storageSignal_04bd1798{margin-right:4px}html[dir='ltr'] .signal_04bd1798.socialSignal_04bd1798{margin-right:4px}html[dir='rtl'] .signal_04bd1798.socialSignal_04bd1798{margin-left:4px}html[dir='ltr'] .signal_04bd1798.lifecycleSignal_04bd1798{margin-right:4px}html[dir='rtl'] .signal_04bd1798.lifecycleSignal_04bd1798{margin-left:4px}.name_04bd1798{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir='ltr'] .name_04bd1798{margin-left:-8px}html[dir='rtl'] .name_04bd1798{margin-right:-8px}html[dir='ltr'] .name_04bd1798{padding-left:8px}html[dir='rtl'] .name_04bd1798{padding-right:8px}.name_04bd1798,.isLarge_04bd1798 .name_04bd1798{font-size:14px;height:30px;margin-top:-7px;margin-bottom:-8px}.isSmall_04bd1798 .name_04bd1798{font-size:12px;height:24px;margin-top:-5px;margin-bottom:-7px}.activity_04bd1798{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;font-size:12px;color:#767676;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;height:24px;margin-bottom:-4px}html[dir='ltr'] .activity_04bd1798{margin-left:-8px}html[dir='rtl'] .activity_04bd1798{margin-right:-8px}html[dir='ltr'] .activity_04bd1798{padding-left:8px}html[dir='rtl'] .activity_04bd1798{padding-right:8px}.hasBackgroundFrame_04bd1798 .name_04bd1798{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.hasBackgroundFrame_04bd1798 .activity_04bd1798{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.hasBackground_04bd1798 .nameplate_04bd1798:before{position:absolute;content:'';display:block;top:-12px;bottom:0;left:0;right:0;background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(0,0,0,0.65)), color-stop(55%, rgba(0,0,0,0.5525)), color-stop(80%, rgba(0,0,0,0.195)), to(rgba(0,0,0,0)));background-image:linear-gradient(to top, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.5525) 55%, rgba(0,0,0,0.195) 80%, rgba(0,0,0,0) 100%);z-index:-1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear;opacity:0}.hasBackground_04bd1798.showBackground_04bd1798 .name_04bd1798{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-shadow:0.5px 0.5px 2px rgba(0,0,0,0.55)}.hasBackground_04bd1798.showBackground_04bd1798 .activity_04bd1798{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-shadow:0.5px 0.5px 2px rgba(0,0,0,0.55)}.hasBackground_04bd1798.showBackground_04bd1798 .nameplate_04bd1798:before{opacity:1}\n"}]);t.tile="tile_04bd1798";t.selectable="selectable_04bd1798";t.selected="selected_04bd1798";t.hasBackgroundFrame="hasBackgroundFrame_04bd1798";t.invokable="invokable_04bd1798";t.label="label_04bd1798";t.description="description_04bd1798";t.link="link_04bd1798";t.foreground="foreground_04bd1798";t.foregroundHide="foregroundHide_04bd1798";t.hasForegroundFrame="hasForegroundFrame_04bd1798";t.check="check_04bd1798";t.uninvokable="uninvokable_04bd1798";t.showCheck="showCheck_04bd1798";t.background="background_04bd1798";t.backgroundHide="backgroundHide_04bd1798";t.aboveNameplate="aboveNameplate_04bd1798";t.content="content_04bd1798";t.nameplate="nameplate_04bd1798";t.name="name_04bd1798";t.activity="activity_04bd1798";t.signal="signal_04bd1798";t.storageSignal="storageSignal_04bd1798";t.socialSignal="socialSignal_04bd1798";t.lifecycleSignal="lifecycleSignal_04bd1798";t.isLarge="isLarge_04bd1798";t.isSmall="isSmall_04bd1798";t.hasBackground="hasBackground_04bd1798";t.showBackground="showBackground_04bd1798"});define("office-ui-fabric-react/lib/components/Check/Check.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_904a6025{line-height:1;width:18px;height:18px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_904a6025:before{content:'';position:absolute;left:1px;right:1px;bottom:1px;top:1px;border-radius:50%;opacity:1;background:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:"}.root_904a6025.rootIsChecked_904a6025:before{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";opacity:1}@media screen and (-ms-high-contrast: active){.root_904a6025.rootIsChecked_904a6025:before{background:Window}}.root_904a6025 .check_904a6025{opacity:0}.checkHost_904a6025:hover .root_904a6025 .check_904a6025,.checkHost_904a6025:focus .root_904a6025 .check_904a6025,.root_904a6025:hover .check_904a6025,.root_904a6025:focus .check_904a6025,.root_904a6025.rootIsChecked_904a6025 .check_904a6025{opacity:1}.circle_904a6025,.check_904a6025{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle}.circle_904a6025{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast: active){.circle_904a6025{color:WindowText}}.rootIsChecked_904a6025 .circle_904a6025{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_904a6025{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:16px;left:.5px}@media screen and (-ms-high-contrast: active){.check_904a6025{-ms-high-contrast-adjust:none}}.rootIsChecked_904a6025 .check_904a6025{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:900}@media screen and (-ms-high-contrast: active){.rootIsChecked_904a6025 .check_904a6025{border:none;color:WindowText}}\n"}]);t.root="root_904a6025";t.rootIsChecked="rootIsChecked_904a6025";t.check="check_904a6025";t.checkHost="checkHost_904a6025";t.circle="circle_904a6025"});define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile",["require","exports","../../../Utilities","./ShimmerTile.base","./ShimmerTile.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerTile=i.styled(o.ShimmerTileBase,r.getStyles)});define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile.base",["require","exports","tslib","react","../../../Utilities","../Tile","../../Shimmer/ShimmerGap/ShimmerGap","../../Shimmer/ShimmerElementsGroup/ShimmerElementsGroup","../../Shimmer/Shimmer.types"],function(e,t,i,k,o,R,D,T,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.largeSquareWidth=96]="largeSquareWidth";e[e.largeSquareHeight=96]="largeSquareHeight";e[e.largeNameWidth=144]="largeNameWidth";e[e.largeNameHeight=7]="largeNameHeight";e[e.largeActivityWidth=96]="largeActivityWidth";e[e.largeActivityHeight=7]="largeActivityHeight";e[e.smallSquareWidth=62]="smallSquareWidth";e[e.smallSquareHeight=61]="smallSquareHeight";e[e.smallNameWidth=106]="smallNameWidth";e[e.smallNameHeight=5]="smallNameHeight";e[e.smallActivityWidth=62]="smallActivityWidth";e[e.smallActivityHeight=5]="smallActivityHeight"}(r||(r={}));var F={small:{squareWidth:62,squareHeight:61,nameWidth:106,nameHeight:5,activityWidth:62,activityHeight:5},large:{squareWidth:96,squareHeight:96,nameWidth:144,nameHeight:7,activityWidth:96,activityHeight:7}},P=o.classNamesFunction(),n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e=this.props,t=e.styles,i=e.contentSize,o=void 0===i?{width:176,height:171}:i,r=e.itemActivity,n=void 0===r||r,s=e.itemName,a=void 0===s||s,l=e.itemThumbnail,d=void 0===l||l,c=e.tileSize,u=void 0===c?"large":c,p=R.TileLayoutSizes[u],m=p.nameplatePadding,h=p.nameplateMargin,f=p.nameplateActivityHeight,g=p.nameplateNameHeight,b=F[u],_=b.squareWidth,y=b.squareHeight,v=b.nameWidth,C=b.nameHeight,x=b.activityWidth,w=b.activityHeight,S=0;if(a||n){S+=2*m;a&&(S+=g);n&&(S+=f+h)}this._classNames=P(t,{});return k.createElement("div",{className:this._classNames.root},k.createElement(D.ShimmerGap,{widthInPixel:o.width,height:o.height-y-S}),k.createElement(T.ShimmerElementsGroup,{shimmerElements:[{type:I.ShimmerElementType.gap,widthInPixel:(o.width-_)/2,height:y},d?{type:I.ShimmerElementType.line,widthInPixel:_,height:y}:{type:I.ShimmerElementType.gap,widthInPixel:_,height:y},{type:I.ShimmerElementType.gap,widthInPixel:(o.width-_)/2,height:y}]}),n||a?k.createElement("div",null,k.createElement(D.ShimmerGap,{widthInPixel:o.width,height:m}),a?k.createElement(T.ShimmerElementsGroup,{shimmerElements:[{type:I.ShimmerElementType.gap,widthInPixel:(o.width-v)/2,height:g},{type:I.ShimmerElementType.line,widthInPixel:v,height:C},{type:I.ShimmerElementType.gap,widthInPixel:(o.width-v)/2,height:g}]}):null,n?k.createElement(T.ShimmerElementsGroup,{shimmerElements:[{type:I.ShimmerElementType.gap,widthInPixel:(o.width-x)/2,height:f},{type:I.ShimmerElementType.line,widthInPixel:x,height:w},{type:I.ShimmerElementType.gap,widthInPixel:(o.width-x)/2,height:f}]}):null,k.createElement(D.ShimmerGap,{widthInPixel:o.width,height:m})):null)};return e}(o.BaseComponent);t.ShimmerTileBase=n});define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:["ms-ShimmerTile-root",{width:"100%",height:"100%",display:"flex",flexDirection:"column"}]}}});define("@uifabric/experiments/lib/FolderCover",["require","exports","tslib","./components/FolderCover/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@uifabric/experiments/lib/components/FolderCover/index",["require","exports","tslib","./FolderCover"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@uifabric/experiments/lib/components/FolderCover/FolderCover",["require","exports","tslib","react","../../Utilities","./FolderCover.scss","../signals/Signal.scss"],function(e,t,m,h,f,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,g=i,b=o;!function(e){e[e.smallWidth=72]="smallWidth";e[e.smallHeight=52]="smallHeight";e[e.largeWidth=112]="largeWidth";e[e.largeHeight=80]="largeHeight";e[e.contentPadding=4]="contentPadding"}(r||(r={}));var n="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets",s={small:{width:64,height:44},large:{width:104,height:72}},_={small:{default:{back:n+"/foldericons/folder-small_backplate.svg",front:n+"/foldericons/folder-small_frontplate_thumbnail.svg"},media:{back:n+"/foldericons/folder-small_backplate.svg",front:n+"/foldericons//folder-small_frontplate_nopreview.svg"}},large:{default:{back:n+"/foldericons/folder-large_backplate.svg",front:n+"/foldericons/folder-large_frontplate_nopreview.svg"},media:{back:n+"/foldericons/folder-large_backplate.svg",front:n+"/foldericons//folder-large_frontplate_thumbnail.svg"}}},a=function(e){m.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,i=t.folderCoverSize,o=void 0===i?"large":i,r=t.folderCoverType,n=void 0===r?"default":r,s=t.hideContent,a=void 0!==s&&s,l=(t.ref,t.metadata),d=t.signal,c=t.children,u=m.__rest(t,["folderCoverSize","folderCoverType","hideContent","ref","metadata","signal","children"]),p=_[o][n];return h.createElement("div",m.__assign({},u,{className:f.css(g.root,(e={},e["ms-FolderCover--isSmall "+g.isSmall]="small"===o,e["ms-FolderCover--isLarge "+g.isLarge]="large"===o,e["ms-FolderCover--isDefault "+g.isDefault]="default"===n,e["ms-FolderCover--isMedia "+g.isMedia]="media"===n,e["ms-FolderCover--hideContent "+g.hideContent]=a,e))}),h.createElement("img",{"aria-hidden":!0,className:f.css("ms-FolderCover-back",g.back),src:p.back}),c?h.createElement("span",{className:f.css("ms-FolderCover-content",g.content)},h.createElement("span",{className:f.css("ms-FolderCover-frame",g.frame)},c)):null,h.createElement("img",{"aria-hidden":!0,className:f.css("ms-FolderCover-front",g.front),src:p.front}),d?h.createElement("span",{className:f.css("ms-FolderCover-signal",g.signal,b.dark)},d):null,l?h.createElement("span",{className:f.css("ms-FolderCover-metadata",g.metadata)},l):null)};return t}(h.Component);t.FolderCover=a;t.getFolderCoverLayout=function(e){var t=e.props.folderCoverSize;return{contentSize:s[void 0===t?"large":t]}};t.renderFolderCoverWithLayout=function(e,t){var i=e.type;return h.createElement(i,m.__assign({},e.props,t))}});define("@uifabric/experiments/lib/components/FolderCover/FolderCover.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_88d29bd4{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.root_88d29bd4,.root_88d29bd4.isSmall_88d29bd4{width:72px;height:52px}.root_88d29bd4.isLarge_88d29bd4{width:112px;height:80px}.front_88d29bd4{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.back_88d29bd4{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.content_88d29bd4{position:absolute;left:4px;right:4px;bottom:4px;top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.hideContent_88d29bd4 .content_88d29bd4{opacity:0}.frame_88d29bd4{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;max-width:100%;max-height:100%;-webkit-box-shadow:0 1px 3px 2px rgba(1,1,0,0.2);box-shadow:0 1px 3px 2px rgba(1,1,0,0.2);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-width:32px;min-height:32px}.metadata_88d29bd4{display:block;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:400;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}html[dir='ltr'] .metadata_88d29bd4{margin-right:8px}html[dir='rtl'] .metadata_88d29bd4{margin-left:8px}html[dir='ltr'] .metadata_88d29bd4{text-align:right}html[dir='rtl'] .metadata_88d29bd4{text-align:left}.metadata_88d29bd4,.metadata_88d29bd4.isSmall_88d29bd4{font-size:12px;margin-bottom:3px}.isLarge_88d29bd4 .metadata_88d29bd4{font-size:14px;margin-bottom:3px}.signal_88d29bd4{display:block;position:relative;margin-bottom:8px}html[dir='ltr'] .signal_88d29bd4{margin-left:8px}html[dir='rtl'] .signal_88d29bd4{margin-right:8px}html[dir='ltr'] .signal_88d29bd4{margin-right:4px}html[dir='rtl'] .signal_88d29bd4{margin-left:4px}.signal_88d29bd4,.signal_88d29bd4.isSmall_88d29bd4{font-size:17px;margin-bottom:3px}.isLarge_88d29bd4 .signal_88d29bd4{font-size:21px;margin-bottom:3px}\n"}]);t.root="root_88d29bd4";t.isSmall="isSmall_88d29bd4";t.isLarge="isLarge_88d29bd4";t.front="front_88d29bd4";t.back="back_88d29bd4";t.content="content_88d29bd4";t.hideContent="hideContent_88d29bd4";t.frame="frame_88d29bd4";t.metadata="metadata_88d29bd4";t.signal="signal_88d29bd4"});define("odsp-next/controls/itemTile/react/FileTypeIcon",["require","exports","tslib","react","../../list/react/detailsList/fields/FileTypeIconRenderer","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/ResourceScope"],function(e,t,i,o,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props;return r.renderFileTypeIcon({item:e.item,size:e.size,resources:this.context.dependencies.resources,isDisabled:e.isDisabled,preferAppIcon:e.preferAppIcon})};t.contextTypes=i.__assign({},n.RESOLVED_COMPONENT_CONTEXT_TYPES);return t}(o.Component);t.FileTypeIcon=a;t.typeResourceKey=n.createResolvedComponentTypeResourceKey(e("module").id,a,{resources:s.resourceScopeKey})});define("odsp-next/controls/image/react/ImageFrame",["require","exports","tslib","react","knockout","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","office-ui-fabric-react/lib/Utilities","../frame/ImageFrame","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/ResourceScope","./ImageFrame.css"],function(e,t,l,d,i,r,c,n,u,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(o){l.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._scope=new s.default;var i=t._observables=t._scope.attach(new r.default({owner:t}));t._image=i.create(t.props.image);t._size=i.create(t.props.desiredSize);t._rotation=i.create(t.props.rotation);t._position=i.create();t._isLoaded=i.create(!1);t._error=i.create();t.state={size:t.props.desiredSize,offset:{width:0,height:0},isLoaded:!1,error:void 0};return t}e.prototype.render=function(){var e,t=this.props,i=t.desiredSize,o=(t.image,t.fit,t.className),r=(t.ref,t.rotation,t.onErrorChanged,t.onIsLoadedChanged,l.__rest(t,["desiredSize","image","fit","className","ref","rotation","onErrorChanged","onIsLoadedChanged"])),n=this.state,s=n.size,a=n.offset;return d.createElement("span",l.__assign({},r,{style:{width:Math.min(s.width,i.width)+"px",height:Math.min(s.height,i.height)+"px"},className:c.css("od-ImageFrame2",o)}),d.createElement("span",{className:c.css("od-ImageFrame2-image"),style:(e={width:i.width+"px",height:i.height+"px"},e[u.default.safeLeft]=Math.min(a.width,0)+"px",e.top=Math.min(a.height,0)+"px",e),ref:this._onRootRef}))};e.prototype.componentWillReceiveProps=function(e){this._image(e.image);this._size(e.desiredSize);this._rotation(e.rotation)};e.prototype.componentDidMount=function(){var t=this,e={desiredSize:this._size,image:this._image,rotation:this._rotation,position:this._position,isLoaded:this._isLoaded,error:this._error,alignment:"contain"===this.props.fit?"fit":"cover",resources:this.context.dependencies.resources};this._observables.subscribe(this._position,function(e){e&&t.setState({offset:{width:-e.x,height:-e.y},size:{width:e.width,height:e.height}})});this._observables.subscribe(this._isLoaded,function(e){t.setState({isLoaded:e})});this._observables.subscribe(this._error,function(e){t.setState({error:e})});i.applyBindingsToNode(this._root,{component:{name:n.default.tagName,params:e}})};e.prototype.componentDidUpdate=function(e,t){var i=this.props,o=i.onIsLoadedChanged,r=i.onErrorChanged,n=this.state,s=n.isLoaded,a=n.error;s!==t.isLoaded&&o&&o(s);a!==t.error&&r&&r(a)};e.prototype.componentWillUnmount=function(){this._scope.dispose();i.cleanNode(this._root)};e.prototype._onRootRef=function(e){e&&(this._root=e)};e.contextTypes=l.__assign({},a.RESOLVED_COMPONENT_CONTEXT_TYPES);l.__decorate([c.autobind],e.prototype,"_onRootRef",null);return e}(d.Component);t.ImageFrame=p;t.typeResourceKey=a.createResolvedComponentTypeResourceKey(e("module").id,p,{resources:o.resourceScopeKey})});define("odsp-next/controls/image/react/ImageFrame.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageFrame2{display:block;position:relative;overflow:hidden}.od-ImageFrame2-image{position:absolute;top:0;left:0;bottom:0;right:0}"}])});define("odsp-next/models/itemActivityField/ItemActivityFieldFeature.key",["require","exports","../../utilities/features/Features","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/logging/ABExperiment","../../utilities/killSwitch/KillSwitch"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isActivityFieldVisibleResourceKey=new o.ResourceKey({name:e("module").id+".isActivityFieldVisible",factory:{dependencies:{},create:function(){return n.default.isActivated("0EC7C282-ED90-4962-A9CF-5C8EFCCAF0C2","5/2/2018","Disable Item Activity field experiment.")?{instance:new r.ABExperiment({name:"ItemActivityColumnExperiment",startDate:"05/28/2018",targetType:r.TargetType.user}).IsExperimentOn()}:{instance:!0}}}});t.isActivityFieldEnabledResourceKey=new o.ResourceKey({name:e("module").id+".isActivityFieldEnabled",factory:new o.ConstantResourceFactory(i.isFeatureEnabled(i.ItemActivityColumn))})});define("odsp-next/controls/itemTile/react/ItemTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemTile2-icon{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-direction:row;flex-direction:row}.od-ItemTile2--isSmall .od-ItemTile2-icon,.od-ItemTile2-icon{width:62px;height:61px}.od-ItemTile2--isLarge .od-ItemTile2-icon{width:96px;height:96px}.od-ItemTile2-smallIcon{position:absolute;bottom:0;left:0;margin:6px}.od-ItemTile2-folderCover{display:inline-block;margin:3px}.od-ItemTile2-duration{display:inline-block}html[dir=ltr] .od-ItemTile2-duration{margin-right:8px}html[dir=rtl] .od-ItemTile2-duration{margin-left:8px}.od-ItemTile2-image{display:inline-block}.od-ItemTile2-image.od-ItemTile2-image--overdue{display:none}.od-ItemTile2-blankCover{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:inline-block}.od-ItemTile2--isDropping:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid rgba(0,0,0,.2)}.od-ItemTile2-signalField>span[class*=signalFieldValue]{-ms-flex:1 1 auto!important;flex:1 1 auto!important}"}])});define("odsp-next/controls/list/react/ItemDragDrop",["require","exports","tslib","react","react-dom","prop-types","../../../resources/ControlResourceKeys","../../dragAndDrop/DropHelper","office-ui-fabric-react/lib/utilities/dragdrop/DragDropHelper","./SelectionManager","../../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/Utilities","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/items-view/lib/private/utilities/components/Fragment","./ItemDragDrop.css"],function(e,t,o,n,r,s,i,a,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dragDropHelperResourceKey=new m.ResourceKey({name:e("module").id+".dragDropHelper",factory:{dependencies:{selection:d.resourceKey},create:function(e){var t=new l.DragDropHelper({selection:e.selection,minimumPixelsForDrag:5});return{instance:t,disposable:t}}}});var f=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._onRootRef=function(e){t._root=e};t._scope=new u.default;t._events=t._scope.attach(new p.EventGroup(t));t.state={dragDropOptions:t._getDragDropOptions(t.props),isDropping:!1};return t}e.prototype.render=function(){var e=this.props,t=e.layoutMode,i=void 0===t?"invisible":t,o=e.children,r="function"==typeof o?o({isDropping:this.state.isDropping,dragDropEvents:this.state.dragDropOptions}):n.createElement(h.Fragment,null,o);return"invisible"!==i?n.createElement("div",{"data-is-draggable":!0,role:"presentation",ref:this._onRootRef,className:p.css({"od-ItemDragDrop--absolute":"absolute"===i,"od-ItemDragDrop--inline":"inline"===i})},r):r};e.prototype.componentDidMount=function(){this._root||(this._root=r.findDOMNode(this));this._dragDropSubscription=this.context.dependencies.dragDropHelper.subscribe(this._root,this._events,this.state.dragDropOptions);this._events.on(this._root,"dragstart",function(e){return e.preventDefault()},!0)};e.prototype.componentWillReceiveProps=function(e){var i=this;e.item===this.props.item&&e.itemIndex===this.props.itemIndex||this.setState(function(e,t){return{dragDropOptions:i._getDragDropOptions(t)}})};e.prototype.componentDidUpdate=function(e,t){if(this.state.dragDropOptions!==t.dragDropOptions){this._dragDropSubscription.dispose();this._dragDropSubscription=this.context.dependencies.dragDropHelper.subscribe(this._root,this._events,this.state.dragDropOptions)}this.state.isDropping!==t.isDropping&&this.props.onIsDroppingChanged&&this.props.onIsDroppingChanged(this.state.isDropping)};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype._getDragDropOptions=function(e){return{eventMap:[{eventName:"od-dragEnter",callback:this._onDragEnter},{eventName:"od-processDrop",callback:this._onProcessDrop}],selectionIndex:e.itemIndex,context:{data:e.item,index:e.itemIndex},canDrag:this._canDrag,canDrop:this._canDrop,onDragStart:this._onDragStart,updateDropState:this._updateDropState}};e.prototype._canDrag=function(e){return-1<this.props.itemIndex&&e&&e.isDraggable};e.prototype._canDrop=function(e,t){if(e){if(e.isGroup){var i=e.data;if(i){var o=!1;if(t&&!t.isGroup){var r=t.index;o=r>=i.startIndex&&r<i.startIndex+i.count;return i.isDropEnabled&&!o}}}var n=e.data;return n&&n.isDropEnabled}return!1};e.prototype._onDragStart=function(e,t,i,o){var r=this,n=this.context.dependencies.itemSetSelectionModel;o.dragData={type:1,itemSet:n.itemSet.peek(),item:e,itemIndex:t,selection:{length:n.selectedCount.peek(),resolve:function(){return r.context.dependencies.selectionHelper.resolveSelection()},resources:n.resources}}};e.prototype._updateDropState=function(e,t){this.setState({isDropping:e})};e.prototype._onDragEnter=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;i.dropTargetData||1!==i.dragData.type&&0!==i.dragData.type||(i.dropTargetData={targetName:e.data.name});return!0};e.prototype._onProcessDrop=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;var o=e.data,r=!1,n=!1;if(e.isGroup){var s=this.context.dependencies.itemSetSelectionModel.itemSet;i.dragData.metadata={group:e.data.data};i.dragData.itemSet=s.peek();n=r=!0;o=s.peek().item.peek()}if(!i.isHandled){if(this.context.dependencies.dropHelper.processDrop(i.dragData,o,r,n))return!(i.isHandled=!0)}return!0};e.contextTypes={dependencies:s.object.isRequired};o.__decorate([p.autobind],e.prototype,"_canDrag",null);o.__decorate([p.autobind],e.prototype,"_canDrop",null);o.__decorate([p.autobind],e.prototype,"_onDragStart",null);o.__decorate([p.autobind],e.prototype,"_updateDropState",null);o.__decorate([p.autobind],e.prototype,"_onDragEnter",null);o.__decorate([p.autobind],e.prototype,"_onProcessDrop",null);return e}(n.Component);t.ItemDragDrop=f;t.typeResourceKey=m.createResolvedComponentTypeResourceKey(e("module").id,f,{dropHelper:a.resourceKey,itemSetSelectionModel:i.itemsSelection,selectionHelper:c.resourceKey,dragDropHelper:t.dragDropHelperResourceKey,selection:d.resourceKey})});define("@ms/items-view/lib/private/utilities/components/Fragment",["require","exports","tslib","react","prop-types","./Context","../objects"],function(e,n,s,a,t,i,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.DefaultFragment=function(e){return e.hidden?a.createElement("div",{style:{display:"none"}},e.children):1<a.Children.count(e.children)?a.Fragment?a.createElement(a.Fragment,null,e.children):a.createElement("div",null,e.children):a.Children.only(e.children)};var r={fragment:t.object};n.FragmentProvider=i.provideContext(r,function(e){return{fragment:{override:e.override}}});n.Fragment=o.assign(function(e,t){var i=t.fragment,o=(void 0===i?{}:i).override,r=void 0===o?n.DefaultFragment:o;return a.createElement(r,s.__assign({},e))},{contextTypes:r})});define("@ms/items-view/lib/private/utilities/components/Context",["require","exports","tslib","react","prop-types","../objects","../../models/Facet","./Fragment"],function(e,t,r,s,a,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createContext=function(e,t){var i,o=new l.Facet(e),r=((i={})[o.id]=t?a.any:a.any.isRequired,i),n=c(r,function(e){return{value:o.unpack(e)}})(function(e){return"function"==typeof e.children?e.children(e.value):s.createElement(d.Fragment,null,e.children)});return{Provider:u(r,function(e){return o.pack(e.value)}),Consumer:n}};function c(t,o){return function(e){var i=e;return n.assign(function(e,t){return s.createElement(i,r.__assign({},e,o(t,e)))},{contextTypes:t})}}t.connectToContext=c;function u(i,o){return function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return o(this.props)};t.prototype.render=function(){return s.createElement(d.Fragment,null,this.props.children)};t.childContextTypes=i;return t}(s.PureComponent)}t.provideContext=u});define("@ms/items-view/lib/private/utilities/objects",["require","exports","tslib","@ms/utilities-objects/lib/assign"],function(e,t,c,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assign=i.assign;t.mapObject=function(e,t,i){var o={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r],s=i?i(r,n):r;"string"==typeof s&&(o[s]=t(n,s))}return o};t.pickObject=function(e,t){var i=t instanceof Array?n(t,function(){return!0}):t,o=void 0;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))if(r in i);else{o||(o=c.__assign({},e));delete o[r]}return o||e};function n(e,t,i){var o,r,n={};try{for(var s=c.__values(e),a=s.next();!a.done;a=s.next()){var l=a.value;n[i?i(l):l]=t(l)}}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return n}t.makeObject=n;t.areShallowEqual=function(e,t,i){void 0===i&&(i=u);if(e===t)return!0;if(!!e!=!!t)return!1;var o,r,n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;try{for(var a=c.__values(n),l=a.next();!l.done;l=a.next()){var d=l.value;if(!(d in t&&i(e[d],t[d],d)))return!1}}catch(e){o={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return!0};function u(e,t){return e===t}});define("@ms/items-view/lib/private/models/Facet",["require","exports","tslib"],function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0,i=function(){function i(e){this.id=e+"_"+ ++o;i._facetsById[this.id]=this}i.get=function(e){if(!e)throw new Error("Unable to determine the Facet for an empty or undefined id.");var t=i._facetsById[e];if(!t)throw new Error("Unable to determine the Facet for id '"+e+"'. Only store objects into a facet collection that have been created using the pack function. This error will typically occur if multiple versions of the @ms/items-view package have been bundled into the application.");return t};i.prototype.unpack=function(e){return e[this.id]};i.prototype.pack=function(e){return(t={})[this.id]=e,t;var t};i._facetsById={};return i}();t.Facet=i;t.unpack=function(e,t){var i={};for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];i[o]=t[r.id]}return i};t.pack=function(e,t){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[e[o].id]=t[o]);return i};t.merge=function(e){var t,i,o={};try{for(var r=l.__values(e),n=r.next();!n.done;n=r.next()){var s=n.value;for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a])}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return o};t.createDynamicFacet=function(e){var t=new i(e);return function(e){return{id:t.id+"_"+e}}}});define("odsp-next/controls/list/react/ItemDragDrop.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemDragDrop--absolute{position:absolute;top:0;left:0;bottom:0;right:0}.od-ItemDragDrop--inline{display:block}"}])});define("odsp-next/controls/contextualMenu/react/ReactContextualMenu",["require","exports","tslib","react","knockout","office-ui-fabric-react/lib/ContextualMenu","../../../bindings/contextMenu/ContextMenuAlignment","./ReactUploader","@ms/odsp-shared/lib/base/ActionInputType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./ReactContextualMenu.css"],function(e,t,o,d,c,l,n,u,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._uploadInputClicked=!1;t.isOpen=e.isOpen||c.observable(!0);t._disposables=[t._async,t._events];t._platform=e.resources.consume(r.platformDetection);t._isIOSMobileSafari=t._platform.isIOS&&t._platform.isMobile&&t._platform.isSafari;t.state={items:t._convertItemsToReact(e.items),isBeakVisible:!e.isBeakVisible||e.isBeakVisible(),alignment:t._convertAlignmentToDirectionalHint(e.alignment)};return t}e.prototype.render=function(){var e,t=this.props,i=t.target,o=t.anchorElement,r=t.launchEvent,n=null;if(this.props.left&&this.props.top){var s=parseInt(c.utils.unwrapObservable(this.props.left),10),a=parseInt(c.utils.unwrapObservable(this.props.top),10);isNaN(s)||isNaN(a)||(n={x:s,y:a})}e=n&&!o&&r.clientX&&r.clientY?r:i;return d.createElement(l.ContextualMenu,{items:this.state.items,target:e,isBeakVisible:!!this.props.anchorElement&&this.state.isBeakVisible,directionalHint:this.state.alignment,onDismiss:this._onDismiss.bind(this),doNotLayer:!0,directionalHintFixed:this.props.hasExplicitAlignment})};e.prototype.componentWillUnmount=function(){this._disposables&&this._disposables.forEach(function(e){e&&e.dispose()})};e.prototype.componentDidMount=function(){var e=this;this.isOpen()||this.isOpen(!0);this._createComputed(function(){e.setState({items:e._convertItemsToReact(e.props.items),isBeakVisible:!e.props.isBeakVisible||e.props.isBeakVisible(),alignment:e._convertAlignmentToDirectionalHint(e.props.alignment)})});this._createComputed(function(){e.isOpen&&!c.utils.unwrapObservable(e.isOpen)&&e._onDismiss()})};e.prototype._convertItemsToReact=function(e,t){void 0===t&&(t=!1);for(var i=new Array,o=c.utils.unwrapObservable(e).filter(function(e){return e.isVisible()}),r=0;r<o.length;r++){var n=o[r];n.hasLineBreakBefore()&&1<i.length&&"-"!==i[i.length-1].name&&i.push({name:"-",key:"breakBefore"+r.toString(),itemType:l.ContextualMenuItemType.Divider});i.push(this._convertCommandItemToMenuItem(n,t,r));n.hasLineBreakAfter()&&o.length-1!==r&&i.push({name:"-",key:"breakAfter"+r.toString(),itemType:l.ContextualMenuItemType.Divider})}return i};e.prototype._convertCommandItemToMenuItem=function(i,e,t){var o=this,r=null,n=i.targetCommand(),s=n.inputType(),a=c.unwrap(n.children);s!==p.default.htmlFileUpload&&s!==p.default.folderUpload||(r=function(){return d.createElement(u.ReactUploader,{currentStateCallback:function(e){return o._uploadInputClicked=e},commandItem:i,key:t.toString()})});var l=a&&0<a.length?this._convertItemsToReact(a,!0):null;return{name:c.unwrap(i.label),key:t.toString(),iconProps:this._getIcon(i),onClick:function(e,t){return i.onClick(n,o.props.launchEvent||e)},subMenuProps:l&&{items:l,isSubMenu:e,onMenuOpened:i.callback?function(){return i.callback()}:null},onRender:r,"data-automationid":i.automationId,ariaLabel:c.unwrap(i.computedAccessibleLabel),canCheck:i.isToggleable,checked:i.isToggleable?c.unwrap(i.isToggled):null,title:c.unwrap(i.tooltip)}};e.prototype._getIcon=function(e){var t=void 0;this.props.hideIcons||(c.unwrap(e.icon)&&""!==e.getIcon("")?t={iconName:c.unwrap(e.icon).toString(),className:c.unwrap(e.icon).getExtraClasses()}:c.unwrap(e.iconUrl)&&(t={iconName:"CustomIcon",style:{backgroundImage:"url("+c.unwrap(e.iconUrl)+")",width:"16px",height:"16px",backgroundSize:"16px"}}));return t};e.prototype._convertAlignmentToDirectionalHint=function(e){var t,i=(t="string"==typeof e?n.default[e]:c.utils.unwrapObservable(e))&n.default.Right,o=t&n.default.Bottom,r=t&(n.default.Center|n.default.VerticalCenter);return i?o?2:6:r?o?1:5:o?0:4};e.prototype._createComputed=function(e){var t=c.computed;this._disposables.push(t(e.bind(this)).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}))};e.prototype._onDismiss=function(e){if(!e||this._shouldDismissUploader(e)){this.isOpen()&&this.isOpen(!1);this.props.close&&this.props.close()}};e.prototype._shouldDismissUploader=function(e){return!(this._isIOSMobileSafari&&this._uploadInputClicked&&("resize"===e.type||"scroll"===e.type))};return e}(d.Component);t.ReactContextualMenu=i;t.default=i});define("odsp-next/controls/contextualMenu/react/ReactUploader",["require","exports","tslib","@ms/odsp-shared/lib/base/ActionInputType","react","./ReactUploader.css"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.commandItem=e.commandItem;return t}e.prototype.componentDidMount=function(){this._inputElement&&this.props.commandItem.targetCommand().inputType()===r.default.folderUpload&&(this._inputElement.webkitdirectory=!0)};e.prototype.componentWillUnmount=function(){this.props.currentStateCallback&&this.props.currentStateCallback(!1)};e.prototype.render=function(){var t=this;return n.createElement("div",{className:"ms-ContextualMenu-uploader ContextualMenu-uploadInput-container"},n.createElement("div",{className:"ContextualMenu-uploadInput"},n.createElement("input",{type:"file",className:"ContextualMenu-fileInput",multiple:!0,onChange:this._onChange.bind(this),onClick:this._onInputClick.bind(this),ref:function(e){return t._inputElement=e},"data-is-focusable":!1})),n.createElement("button",{role:"menuitem",className:"ms-ContextualMenu-uploader",onClick:function(){return t._inputElement.click()}},n.createElement("span",{className:"ms-ContextualMenu-itemText ContextualMenu-uploadInput-Text"},this.commandItem.label())))};e.prototype._onInputClick=function(){this.props.currentStateCallback&&this.props.currentStateCallback(!0)};e.prototype._onChange=function(e){this.props.currentStateCallback&&this.props.currentStateCallback(!1);this.commandItem.onInputChange(e)};return e}(n.Component);t.ReactUploader=i});define("odsp-next/controls/contextualMenu/react/ReactUploader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-ContextualMenu-uploader{font:inherit;color:inherit;background:0 0;border:none;width:100%;height:36px;display:block;cursor:pointer}html[dir=ltr] .ms-ContextualMenu-uploader{text-align:left}html[dir=rtl] .ms-ContextualMenu-uploader{text-align:right}.ms-ContextualMenu-uploader:hover:not([disabled]){background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ms-ContextualMenu-uploader.is-disabled,.ms-ContextualMenu-uploader[disabled]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";cursor:default;pointer-events:none}.ms-ContextualMenu-uploader .ContextualMenu-uploadInput-Text{padding:0 6px}"}])});define("odsp-next/controls/contextualMenu/react/ReactContextualMenu.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-ContextualMenu-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:16px;width:16px}.ms-ContextualMenu-icon.ms-Icon--Info{margin-top:2px}.ms-ContextualMenu-icon[data-icon-name=ExcelLogo]{color:#217346}.ms-ContextualMenu-icon[data-icon-name=OneNoteLogo]{color:#5c2d91}.ms-ContextualMenu-icon[data-icon-name=PowerPointLogo]{color:#d24726}.ms-ContextualMenu-icon[data-icon-name=WordLogo]{color:#2b579a}.ms-ContextualMenu-icon[data-icon-name=VisioLogo]{color:#3854a2}.ms-ContextualMenu-icon.od-NeedsAttentionViewIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.ms-ContextualMenu-icon.ms-Icon--CustomIcon,.ms-ContextualMenu-icon.ms-Icon--custom{width:16px;height:36px;background-size:contain}.ContextualMenu-uploadInput{position:absolute;top:0;bottom:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:9999999}.ContextualMenu-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}[dir=ltr] .ContextualMenu-uploadInput input{right:0}[dir=rtl] .ContextualMenu-uploadInput input{left:0}.ContextualMenu-uploadInput-container{box-sizing:border-box;padding:0}.ContextualMenu-uploadInput-Text{display:block}"}])});define("odsp-next/controls/commandBar/react/CommandBar",["require","exports","./CommandBarWrapperViewModel","../../../bindings/component/ControlBinding","./CommandBarWrapper.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({name:e("module").id,template:e("./CommandBarWrapper.html"),automationName:"ms-command-bar-wrapper",viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/commandBar/react/CommandBarWrapperViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../../commands/Commands.resx","../../../utilities/browser/ResponsiveUI","../../../bindings/element/ElementBinding","../../../bindings/keyboard/KeyboardBinding","../../../bindings/react/ReactBinding","../../commands/react/ReactCommandManager"],function(n,e,p,s,t,m,h,i,a,l,d,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){p.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._responsiveUI=t.responsiveUI;i.addBindingHandlers({react:d.default,element:a.default,keyboard:l.default});i._reactCommandManager=i.scope.attach(new t.reactCommandManagerType({commandSet:e.commandSet}));i.rootElement=i.createObservable();i.keyboardOptions=[{target:document,mappings:{},allowButtonEvents:!0,eventFilter:i._getEventFilter()}];i._initializeKeyboardMappings();var o=i._getCommandBarProps();i.reactBindingParams={componentPath:"odsp-next/controls/commandBar/react/ReactCommandBar",getModule:function(){return new s.default(function(e,t){n(["odsp-next/controls/commandBar/react/ReactCommandBar"],e,t)})},props:o};return i}e.prototype._getCommandBarProps=function(){var u=this;return this.observables.pureCompute(function(){var e,t=u._reactCommandManager.commandBarItems(),i=t.items,o=t.farItems,r=i,n=t.overflowItems;if(r.length){var s=r[0];s=p.__assign({},s,{ariaLabel:m.format(h.strings.firstCommandAccessibleLabelFormat,s.ariaLabel)});if("Small"===u._responsiveUI.formFactorSize()){n=r.slice(1).concat(n);r=[s]}else r=[s].concat(r.slice(1))}for(var a=0,l=n=n.map(function(e){return p.__assign({},e,{renderedInOverflow:!0})});a<l.length;a++){var d=l[a].data,c=d.payload;if(c&&c.control()&&d.isOpen()&&(!d.action||!d.action.isToggled())){e=d;break}}return{mainCommands:r,farCommands:o,overFlowCommands:n,payloadCommand:e}}).extend({deferred:!0})};e.prototype._initializeKeyboardMappings=function(){var i=this,e=this._reactCommandManager.allCommands,t=function(e){var t={};!function s(a,e){var t=function(i){if(i.keys)for(var e=function(e,t){i.onClick(i,t);t.preventDefault()},t=0,o=i.keys;t<o.length;t++){var r=o[t];a[r]||(a[r]=[]);a[r].push(e)}var n=i.children.peek();n.length&&s(a,n)};for(var i=0,o=e;i<o.length;i++){var r=o[i];t(r)}}(t,e);i.keyboardOptions[0].mappings=t};t(e.peek());this.observables.subscribe(e,t)};e.prototype._getEventFilter=function(){var r=this;return function(e,t,i){if("Left"===e||"Right"===e){var o=r.rootElement.peek();if(i&&o.contains(i.target))return!1}return!0}};e.dependencies=p.__assign({},t.default.dependencies,{responsiveUI:i.resourceKey,reactCommandManagerType:o.typeResourceKey});return e}(t.default);e.default=r});define("odsp-next/controls/commands/react/ReactCommandManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/Icon","@ms/odsp-shared/lib/base/ActionInputType","react","../../commandBar/react/UploadCommand","../../commandBar/react/PayloadCommand","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Icon","@ms/odsp-shared/lib/utilities/knockout/Translators","@ms/odsp-utilities/lib/resources/Resources","./ReactCommandManager.css"],function(e,t,i,o,b,_,y,v,C,s,x,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){var g=r.call(this,e,t)||this;g._getCommands=function(){var e=g,t=e._convertCommand,i=e.scope,o=e.observables,r=e.allCommands,n=i.attach(r.filter(function(e){return 0!=(7&e.location)&&e.isVisible()})),s=i.attach(n.filter(d).map(t)),a=i.attach(r.filter(u).filter(function(e){return e.isVisible()}).map(t)),l=i.attach(n.filter(c).map(t));return o.pureCompute(function(){return{items:s(),farItems:l(),overflowItems:a()}}).extend({deferred:!0})};g._convertCommand=function(i){var e,t,o=i.targetCommand(),r=i.getKey(),n=i.commandClass(),s=i.label(),a=i.isLabelVisible()&&s,l=i.hidesMenuChevron||!i.isLabelVisible(),d=g._convertCommands(o.visibleChildren()),c=d&&d.length,u=o.inputType();u===_.default.htmlFileUpload||u===_.default.folderUpload?e=function(e,t){return y.createElement(v.default,{item:e,command:o,key:r,dismissMenu:t})}:i.payload&&(e=function(e){return y.createElement(C.default,{item:e,command:i,key:r})});i.appIconName&&(t=function(e,t){return y.createElement("span",{className:"ms-ReactCommandManager-iconContainer"},y.createElement(b.Icon,{iconName:i.appIconName.logoFill16,className:"ms-ReactCommandManager-logoFillIcon"}),y.createElement(b.Icon,{iconName:i.appIconName.logo16,className:"ms-ReactCommandManager-logoIcon"}))});var p=r+(a?"-label":""),m={textContainer:{whiteSpace:"noWrap"}};i.positionIconRight&&(m.flexContainer={flexDirection:"row-reverse"});var h=n?"od-Command--"+n:"";if(i.isCurrentView){h+=" is-pivot";i.isLastPivot&&(h+=" is-last-pivot");i.isCurrentView()&&(h+=" is-current-view")}i.isToggled()&&(h+=" is-toggled");a||(h+=" hide-label");var f=i.isDisabled();f&&(i.isInvisibleWhenDisabled?h+=" is-invisible":h+=" is-disabled");return{key:r,data:i,cacheKey:p,role:i.role,name:s,buttonStyles:m,onRender:e,onRenderIcon:t,ariaLabel:i.computedAccessibleLabel(),title:o.tooltip()||i.tooltip(),className:h,canCheck:i.isToggleable,isChecked:i.isToggled(),menuIconProps:l?w:void 0,subMenuProps:c?{items:d}:void 0,iconProps:function(e){var t=e.icon();if(t)return{iconName:t.toString()};var i=e.iconUrl();if(i)return{iconType:x.IconType.Image,imageProps:{src:i,width:"16px",height:"16px"},styles:{imageContainer:{width:"16px!important"}}};return w}(i),"data-is-focusable":!f,"data-automationid":i.automationId,onMenuClick:function(e){o.onClick(o,e)},onClick:function(e){e.persist();o.onClick(o,e)}}};g._convertCommands=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i],n=g._convertCommand(r);if(n){r.hasLineBreakBefore()&&t.push({key:n.key+"_before_divider",itemType:s.ContextualMenuItemType.Divider});t.push(n);r.hasLineBreakAfter()&&t.push({key:n.key+"_after_divider",itemType:s.ContextualMenuItemType.Divider})}}return t};var i=g.observables,o=g._commandSet=i.wrap(e.commandSet);g.allCommands=i.createArray();g._replicateCommandSet(o.peek());i.subscribe(o,function(e){g._replicateCommandSet(e)});g.commandBarItems=g._getCommands();return g}e.prototype._replicateCommandSet=function(e){if(this._replicationSubscription){this._replicationSubscription.dispose();this._replicationSubscription=void 0}if(e){this._replicationSubscription=n.replicateArray(e.commands,this.allCommands);this.scope.attach(this._replicationSubscription)}else this.allCommands([])};e.dependencies=i.__assign({},o.default.dependencies);return e}(o.default);t.ReactCommandManager=a;function d(e){return 3==(3&e.location)}function c(e){return 4==(4&e.location)}function u(e){return 2==(3&e.location)}var w={iconName:null,styles:{root:{display:"none!important"}}};t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,a)});define("odsp-next/controls/commandBar/react/UploadCommand",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","@ms/odsp-shared/lib/base/ActionInputType","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/components/ContextualMenu/ContextualMenu.classNames"],function(e,t,o,r,n,s,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isCalloutVisible:!1,payload:void 0,badge:void 0};return t}e.prototype.render=function(){var e=this.props.item;return this.props.command.parentCommand&&!this.props.command.parentCommand.isCollapsed.peek()||e.renderedInOverflow?this._getMenuItem():this._getCommandButton()};e.prototype.componentDidMount=function(){this._input&&this.props.command.inputType.peek()===l.default.folderUpload&&(this._input.webkitdirectory=!0)};e.prototype._getCommandButton=function(){var t=this,e=this.props.item,i=this.props.command.inputType.peek()===l.default.folderUpload?"commandFolderInput":"commandFileInput";return r.createElement(a.CommandBarButton,{className:e.className,text:e.name,role:e.role,ariaLabel:e.ariaLabel,checked:e.isChecked,title:e.title,iconProps:e.iconProps,menuIconProps:e.menuIconProps,styles:e.buttonStyles,onClick:function(){return t._input.click()}},r.createElement("input",{type:"file",className:i,multiple:!0,onChange:this._onChange.bind(this),ref:function(e){return t._input=e},"data-is-focusable":!1}))};e.prototype._getMenuItem=function(){var t=this,e=this.props.item,i=c.getItemClassNames(this.props.theme,e.disabled,!1,e.isChecked,!!e.href,"None"!==e.iconProps.iconName,e.className,e.itemType===d.ContextualMenuItemType.Divider?e.className:void 0,e.iconProps.className,e.submenuIconProps?e.submenuIconProps.className:"");return r.createElement("button",{role:e.role,title:e.title,className:i.root,"aria-label":e.ariaLabel,"aria-checked":e.isChecked,onClick:function(){return t._input.click()},"aria-posinset":e["aria-posinset"],"aria-setsize":e["aria-setsize"]},r.createElement("div",{className:i.linkContent},r.createElement(n.Icon,{className:i.icon,iconName:e.iconProps.iconName}),r.createElement("span",{className:"ms-ContextualMenu-itemText"},e.name)),r.createElement("input",{type:"file",className:"commandFileInput",multiple:!0,onChange:this._onChange.bind(this),ref:function(e){return t._input=e},"data-is-focusable":!1}))};e.prototype._onChange=function(e){this.props.command.onInputChange(e);this.props.dismissMenu()};return e=o.__decorate([s.customizable("UploadCommand",["theme"])],e)}(r.Component);t.default=i});define("odsp-next/controls/commandBar/react/PayloadCommand",["require","exports","tslib","react","react-dom","prop-types","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/components/ContextualMenu/ContextualMenu.classNames","./PayloadContainer"],function(e,t,i,r,n,s,a,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._scope=new a.default;var i=t.props.command.resources;t._observables=t._scope.attach(new(i.consume(p.observablesFactoryTypeResourceKey))({owner:t}));t.state={isCalloutVisible:!1,badge:void 0};return t}e.prototype.render=function(){return this.props.item.renderedInOverflow?this._getMenuItem():this._getCommandButton()};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.componentDidMount=function(){var t=this,i=this.props.command,o=this._observables.pureCompute(function(){return i.payload.control()&&i.isOpen()&&(!i.action||!i.action.isToggled())});this._observables.compute(function(){var e=i.iconBadge();t.setState({isCalloutVisible:o(),badge:e?e.toString():void 0})})};e.prototype._getCommandButton=function(){var i=this,t=this.props.item,e=this.state.badge?r.createElement(l.Icon,{className:"od-error-badge",iconName:this.state.badge}):void 0;return r.createElement(c.CommandBarButton,{ref:function(e){if(e){var t=n.findDOMNode(e);i._target=t}else i._target=void 0},className:t.className,text:t.name,role:t.role,ariaLabel:t.ariaLabel,checked:t.isChecked,title:t.title,iconProps:t.iconProps,menuIconProps:t.menuIconProps,styles:t.buttonStyles,onClick:function(e){return t.onClick(e)}},e,this._getCallout())};e.prototype._getMenuItem=function(){var t=this.props.item,e=m.getItemClassNames(this.props.theme,t.disabled,!1,t.isChecked,!!t.href,"None"!==t.iconProps.iconName,t.className,t.itemType===u.ContextualMenuItemType.Divider?t.className:void 0,t.iconProps.className,t.submenuIconProps?t.submenuIconProps.className:"");return r.createElement("button",{role:t.role,title:t.title,className:e.root,"aria-label":t.ariaLabel,"aria-checked":t.isChecked,onClick:function(e){return t.onClick(e)}},r.createElement("div",{className:e.linkContent},r.createElement(l.Icon,{className:e.icon,iconName:t.iconProps.iconName}),r.createElement("span",{className:"ms-ContextualMenu-itemText"},t.name)))};e.prototype._getCallout=function(){if(this.state.isCalloutVisible&&!this.context.isMeasured)return r.createElement(h.default,{command:this.props.command,target:this._target})};e.contextTypes={isMeasured:s.bool};return e=i.__decorate([d.customizable("PayloadCommand",["theme"])],e)}(r.Component);t.default=o});define("odsp-next/controls/commandBar/react/PayloadContainer",["require","exports","tslib","react","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/Callout","@ms/odsp-shared/lib/base/BaseModel","../../../utilities/features/Features","../../knockout/Knockout"],function(e,t,i,r,n,s,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._scope=new n.default;var i=t.props.command.resources;t._observables=t._scope.attach(new(i.consume(a.observablesFactoryTypeResourceKey))({owner:t}));t.state={payload:void 0};return t}e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.componentDidMount=function(){var e=this,t=this.props.command;this._observables.compute(function(){e.setState({payload:t.payload.control()})})};e.prototype.render=function(){var e=this,t=r.createElement(d.default,{specification:this.state.payload,resources:this.props.command.resources}),i=this.props.command.payload.announce?r.createElement("div",{role:"alert","aria-live":"assertive"},t):r.createElement("div",null,t);return r.createElement(s.Callout,{className:l.isFeatureEnabled(l.EnableFluentStyling)?"isFluent commandBarCallout":void 0,beakWidth:l.isFeatureEnabled(l.EnableFluentStyling)?0:void 0,gapSpace:0,doNotLayer:!1,target:this.props.target,setInitialFocus:!1,onDismiss:function(){e.props.command.isOpen(!1)}},i)};return e}(r.Component);t.PayloadContainer=o;t.default=o});define("odsp-next/controls/commands/react/ReactCommandManager.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-ReactCommandManager-iconContainer{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.ms-ReactCommandManager-logoFillIcon,.ms-ReactCommandManager-logoIcon{position:absolute;left:0;right:0}.ms-ReactCommandManager-logoFillIcon[data-icon-name=TeamsLogo16],.ms-ReactCommandManager-logoIcon[data-icon-name=TeamsLogo16]{color:#6264A7}.ms-ReactCommandManager-logoFillIcon{color:#FFF}"}])});define("odsp-next/controls/commandBar/react/CommandBarWrapper.html",[],function(){return'<div data-bind="element: rootElement, keyboard: keyboardOptions, react: reactBindingParams"></div>'});define("odsp-next/controls/commandBar/react/ReactCommandBar",["require","exports","tslib","react","office-ui-fabric-react/lib/CommandBar","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/base/BaseModel","./PayloadContainer","../../commands/Commands.resx","../../../utilities/killSwitch/KillSwitch","../../commandBar/react/CoachmarkCommand","../../commandBar/react/PayloadCommand","./CommandBar.css","../../contextualMenu/react/ReactContextualMenu.css"],function(e,t,r,n,i,s,a,l,o,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){r.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._buttonAs=function(e){if(e.data){var t=e.data,i=t.resources;o._observables=i&&o._scope.attach(new(i.consume(l.observablesFactoryTypeResourceKey))({owner:o}));if(t.payload)return n.createElement(p.default,{item:e,command:t,key:t.getKey()});if(!c.default.isActivated("C0F26B86-59A5-4902-947A-CE8F8920010F")&&t.teachingBubble&&o._observables&&o._observables.unwrap(t.teachingBubble).campaign()&&o._observables.unwrap(t.teachingBubble).campaign().isCoachmark)return n.createElement(u.default,{item:e,command:t,key:t.getKey()})}return n.createElement(s.CommandBarButton,r.__assign({},e))};o._scope=new a.default;return o}e.prototype.render=function(){return n.createElement("div",{style:{display:"flex"}},n.createElement("div",{style:{display:"block",width:"100%"}},n.createElement(i.CommandBar,{overflowButtonProps:{ariaLabel:d.strings.OverflowCommandTooltip},items:this.props.mainCommands,overflowItems:this.props.overFlowCommands,farItems:this.props.farCommands,buttonAs:this._buttonAs}),this.props.payloadCommand&&n.createElement(o.default,{command:this.props.payloadCommand})))};return e}(n.Component);t.ReactCommandBar=m;t.default=m});define("odsp-next/controls/commandBar/react/CoachmarkCommand",["require","exports","tslib","react","react-dom","prop-types","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ProviderResourceKeys","./CoachmarkContainer","office-ui-fabric-react/lib/Icon"],function(e,t,o,r,n,s,a,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._getCoachmark=function(){var e=!t.state.isCalloutVisible||t.context.isMeasured;return r.createElement("div",{ref:"containerDiv"},!e&&r.createElement(p.default,{command:t.props.command,target:t._target}))};t._scope=new a.default;t._resources=t.props.command.resources;t._teachingBubbleProvider=t._resources.consume(u.teachingBubble.optional);t._observables=t._scope.attach(new(t._resources.consume(c.observablesFactoryTypeResourceKey))({owner:t}));t._shouldShow=t._observables.create(!1);t.state={isCalloutVisible:!1,badge:void 0};return t}e.prototype.render=function(){this.props.item.renderedInOverflow&&console.error("Coachmark unsuported in overflow");return this._getCommandButton()};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.componentDidMount=function(){var t=this,i=this.props.command,e=n.findDOMNode(this.refs.containerDiv);this._target=e;this._observables.compute(function(){t._computeShowCoachmark();var e=i.iconBadge();t.setState({isCalloutVisible:t._shouldShow(),badge:e?e.toString():void 0})})};e.prototype._computeShowCoachmark=function(){var t=this,e=this.props.command,i=this._observables.unwrap(e.teachingBubble),o=this._observables.unwrap(i.isVisible),r=i.campaign();this._teachingBubbleProvider||(this._teachingBubbleProvider=this._resources.consume(u.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(r,!1).then(function(e){t._shouldShow(e&&o)})};e.prototype._getCommandButton=function(){var i=this,t=this.props.item,e=this.state.badge?r.createElement(m.Icon,{className:"od-error-badge",iconName:this.state.badge}):void 0;return r.createElement(r.Fragment,null,r.createElement(d.CommandBarButton,{ref:function(e){if(e){var t=n.findDOMNode(e);i._target=t}else i._target=void 0},className:t.className,text:t.name,role:t.role,ariaLabel:t.ariaLabel,checked:t.isChecked,title:t.title,disabled:t.disabled,iconProps:t.iconProps,menuIconProps:t.menuIconProps,menuProps:t.subMenuProps,styles:t.buttonStyles,onMenuClick:function(e){return t.onClick(e)},onClick:function(e){return t.onClick(e)}},e),this._getCoachmark())};e.contextTypes={isMeasured:s.bool};return e=o.__decorate([l.customizable("CoachmarkCommand",["theme"])],e)}(r.Component);t.default=i});define("odsp-next/controls/commandBar/react/CoachmarkContainer",["require","exports","tslib","react","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/Coachmark","@ms/odsp-shared/lib/base/BaseModel","../../../models/teachingBubble/TeachingBubble.resx","../../../resources/ProviderResourceKeys"],function(e,t,o,r,n,s,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.onDismiss=function(){t._observables.wrap(t._observables.unwrap(t.props.command.teachingBubble).isVisible)(!1)};t.markCoachmarkAsSeen=function(){t._teachingBubbleProvider.markBubbleAsSeen(t._observables.unwrap(t.props.command.teachingBubble).campaign())};t._scope=new n.default;t._resources=t.props.command.resources;t._observables=t._scope.attach(new(t._resources.consume(l.observablesFactoryTypeResourceKey))({owner:t}));t._teachingBubbleProvider=t._resources.consume(c.teachingBubble.optional);t.state={visible:!1};return t}e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.componentDidMount=function(){var e=this,t=this.props.command;this._observables.compute(function(){e.setState({visible:e._observables.unwrap(e._observables.unwrap(t.teachingBubble).isVisible)})})};e.prototype.render=function(){var e=this._observables.unwrap(this.props.command.teachingBubble).campaign();return r.createElement(a.Coachmark,{target:this.props.target,positioningContainerProps:{directionalHint:5},onAnimationOpenEnd:this.markCoachmarkAsSeen},r.createElement(s.TeachingBubbleContent,{headline:e.title,calloutProps:{doNotLayer:!0},hasCloseIcon:e.isDismissable,closeButtonAriaLabel:d.strings.closeButton,onDismiss:this.onDismiss},e.bodyCopy))};return e}(r.Component);t.CoachmarkContainer=i;t.default=i});define("odsp-next/controls/commandBar/react/CommandBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-TopBar-search{margin-right:0}[dir=rtl] .od-TopBar-search{margin-left:0}.od-TopBar-commandBar{padding:0!important}.isFluent .od-TopBar-commandBar .ms-CommandBar{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:43px}html[dir=ltr] .isFluent .od-TopBar-commandBar .ms-CommandBar{padding-left:23px}html[dir=rtl] .isFluent .od-TopBar-commandBar .ms-CommandBar{padding-right:23px}html[dir=ltr] .isFluent .od-TopBar-commandBar .ms-CommandBar{padding-right:9px}html[dir=rtl] .isFluent .od-TopBar-commandBar .ms-CommandBar{padding-left:9px}.isFluent .od-TopBar-commandBar .ms-CommandBar .ms-Button--commandBar{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:#323130}.isFluent .od-TopBar-commandBar .ms-CommandBar .ms-Button--commandBar:hover{background-color:#f3f2f1}.isFluent .od-TopBar-commandBar .ms-CommandBar .ms-Button--commandBar:active{background-color:#edebe9}.isFluent .od-TopBar-commandBar .ms-CommandBar .ms-Button--commandBar.is-expanded{background-color:#edebe9}.isFluent .od-TopBar-commandBar .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{background-color:#e1dfdd}.ms-Button--commandBar.hide-label .ms-Button-textContainer{display:none}.ms-CommandBar .od-Command--Word .ms-Button-icon,.ms-ContextualMenu .od-Command--Word .ms-Button-icon{color:#2b579a}.ms-CommandBar .od-Command--Excel .ms-Button-icon,.ms-ContextualMenu .od-Command--Excel .ms-Button-icon{color:#217346}.ms-CommandBar .od-Command--PowerPoint .ms-Button-icon,.ms-ContextualMenu .od-Command--PowerPoint .ms-Button-icon{color:#d24726}.ms-CommandBar .od-Command--Visio .ms-Button-icon,.ms-ContextualMenu .od-Command--Visio .ms-Button-icon{color:#3854a2}.ms-CommandBar .od-Command--Onenote .ms-Button-icon,.ms-ContextualMenu .od-Command--Onenote .ms-Button-icon{color:#5c2d91}.ms-CommandBar .od-Command--PDF .ms-Button-icon,.ms-ContextualMenu .od-Command--PDF .ms-Button-icon{color:#c90304}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word{background-color:#2b579a}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel{background-color:#217346}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint{background-color:#d24726}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio{background-color:#3854a2}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote{background-color:#5c2d91}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF{background-color:#c90304}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word.is-expanded,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word.is-expanded:hover,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Excel .ms-Button-menuIcon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Onenote .ms-Button-menuIcon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PDF .ms-Button-menuIcon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PowerPoint .ms-Button-menuIcon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Visio .ms-Button-menuIcon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word .ms-Button-icon,.OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--Word .ms-Button-menuIcon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ms-CommandBar button.is-pivot.is-current-view,.ms-CommandBar button.is-pivot.is-toggled,.ms-CommandBar button.is-pivot:active,.ms-CommandBar button.is-pivot:hover{border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-CommandBar button.is-pivot.is-current-view,.ms-CommandBar button.is-pivot.is-toggled{font-weight:600}[dir=ltr] .ms-CommandBar button.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .ms-CommandBar button.is-pivot.is-last-pivot{margin-left:24px}.ms-CommandBar button.is-toggled{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-CommandBar button .od-error-badge{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:12px;border-radius:50%;position:absolute;width:12px;height:12px;margin-top:-4px;left:18px}.ms-CommandBar button .commandFileInput,.ms-ContextualMenu button .commandFileInput{opacity:.0001;position:absolute;width:100%;top:0;bottom:0;left:0;right:0;z-index:-9999999;cursor:pointer;overflow:hidden}.md .ms-CommandBar .ms-Button--commandBar,.sm .ms-CommandBar .ms-Button--commandBar{height:44px}.md .ms-CommandBar .ms-Button--commandBar .ms-Button-icon,.sm .ms-CommandBar .ms-Button--commandBar .ms-Button-icon{font-size:20px}.ms-CommandBar .ms-Button--commandBar.is-disabled{cursor:default;background-color:inherit;color:inherit}.ms-CommandBar .ms-Button--commandBar.is-invisible{visibility:hidden}.lg .ms-CommandBar,.md .ms-CommandBar,.sm .ms-CommandBar{padding:0 4px}.md .ms-CommandBar,.sm .ms-CommandBar{height:44px}.od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar{background-color:#f3f2f1}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:#323130;background-color:#f3f2f1}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:#edebe9}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:active{background-color:#e1dfdd}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{background-color:#d2d0ce}.isFluent.od-focus--enabled .od-TopBar.od--hasSelection .ms-Button--commandBar:after{outline-color:#605e5c}.isFluent.commandBarCallout.ms-Callout{border-radius:0 0 2px 2px;box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108)}"}])});define("odsp-next/controls/reactPostPurchasePlansPage/PostPurchasePlansPage",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","../../providers/featureCards/FeatureCardsProvider","../planCard/PlanCard.resx","../../pages/storageOptions/odc/ODCStorageOptions.resx","../listGroupSeeMore/ListGroupSeeMore.resx","office-ui-fabric-react/lib/Utilities","./PostPurchasePlansPage.css"],function(a,e,t,c,o,r,u,p,m,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(s){t.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.headerImageUrl,o=e.headerImageAlt,r=e.planType,n=e.featureCardsProvider;t._headerImageUrl=i;t._headerImageAlt=o;t._featureListItems=n.getStandardFeatureListItemsForPostPurchasePlansPage(r);t._securityFeatureListItems=n.getSecurityFeatureListItems();t._officeAppsImageUrl="undefined"==typeof __webpack_public_path__?a.toUrl("odsp-media/images/premium/office_icons.svg"):a("@ms/odsp-media/dist/media/images/premium/office_icons.svg");return t}e.prototype.render=function(){var e=this.props,t=e.onClickSecurityMoreLink,i=e.onClickExclusiveFeaturesMoreLink,o=e.onClickDownloadOfficeApps,r=e.userHasStoragePlan,n=e.basicBadgeImageUrl,s=e.oneDriveIconAlt,a=e.secondaryPlanTitle,l=e.manageStorageUrl,d=e.plan;return c.createElement(c.Fragment,null,c.createElement("div",{className:"od-PlanCardTest od-PlanCardTest-SliderLayout"},c.createElement("div",{className:"od-PostPurchasePlansPage-headers"},c.createElement("h2",{className:"od-PlanCardTest-premiumHeader od-PlanCardTest-primaryHeader"},d.planName),c.createElement("hr",{className:"od-PlanCardTest-titleSeparator od-PostPurchasePlansPage-titleSeparator"}),this._headerImageUrl&&c.createElement("div",{className:"od-PlanCardTest-headerIconImage"},c.createElement("img",{src:this._headerImageUrl,alt:this._headerImageAlt,role:"presentation"})),c.createElement("p",{className:"od-PlanCardTest-premiumHeader od-PlanCardTest-secondaryHeader"},u.strings.PremiumTitle)),c.createElement("div",{className:"od-PostPurchasePlansPage-featuresSection"},[this._renderSecurityFeatureListBlock(),this._renderAppListBlock(),this._renderExclusiveFeatureListBlock()]),c.createElement("div",{className:"od-PostPurchasePlansPage-seeMoreLinks"},c.createElement("a",{className:"od-PostPurchasePlansPage-link",href:"javascript:;",onClick:t},u.strings.LearnMoreText),c.createElement("div",{className:"od-PostPurchasePlansPage-spacer"},c.createElement("button",{onClick:o,className:"od-Button od-Button--primary od-PostPurchasePlansPage-downloadAppsButton"},p.strings.downloadAppsButton)),c.createElement("a",{className:"od-PostPurchasePlansPage-link",href:"javascript:;",onClick:function(){return i(d)}},m.strings.SeeMoreText))),r&&c.createElement("div",{className:"od-PlanCardTest od-PlanCardTest-SliderLayout StorageOptions-secondaryStoragePlan"},c.createElement("div",{role:"presentation",className:"od-PlanCardTest-headerGleam"},c.createElement("img",{src:n,alt:s,role:"presentation"})),c.createElement("p",{className:"StorageOptions-secondaryStorageTitle"},a),c.createElement("a",{href:l},u.strings.ManagePlanLink)),c.createElement("div",{className:"od-PostPurchasePlansPage-smallBreakpointButtonContainer"},c.createElement("button",{onClick:o,className:"od-Button od-Button--primary od-PostPurchasePlansPage-downloadAppsButton od-PostPurchasePlansPage-downloadAppsButtonSmall"},p.strings.downloadAppsButton)))};e.prototype._renderSecurityFeatureListBlock=function(){return c.createElement("div",{className:"od-PostPurchasePlansPage-listBlock od-PlanCardTest-featureListBlock od-PlanCardTest-listBlock"},c.createElement("p",{className:"od-PostPurchasePlansPage-featureListHeader"},u.strings.SecurityBulletAlternate.toUpperCase()),c.createElement("ul",{className:"od-PlanCardTest-featureList od-PostPurchasePlansPage-featureList"},this._securityFeatureListItems.map(this._renderSecurityFeatureListItem)))};e.prototype._renderAppListBlock=function(){var e=this.props,t=e.onClickFeatureCardLink,i=e.plan;return c.createElement("div",{className:"od-PostPurchasePlansPage-appListBlockContainer"},c.createElement("p",{className:"od-PostPurchasePlansPage-featureListHeader"},u.strings.appListWinMacTitle.toUpperCase()),c.createElement("div",{className:"od-PostPurchasePlansPage-listBlock od-PlanCardTest-appListBlock od-PlanCardTest-listBlock od-PostPurchasePlansPage-appListBlock"},c.createElement("a",{href:"javascript:;",onClick:function(){return t(r.OFFICE_APPS_FEATURE_ITEM.indexInFeatureCardCarousel,i)},className:"od-PlanCardTest-appsIncluded od-PlanCardTest-appsIncludedLink od-PlanCardTest-textRow od-PlanCardTest-dimmable"},u.strings.OfficeAppList),c.createElement("div",{className:"od-PlanCardTest-iconRow od-PlanCardTest-dimmable"},c.createElement("img",{className:"od-PlanCardTest-officeAppIcon",src:this._officeAppsImageUrl,alt:u.strings.OfficeAppsImageAlt,role:"presentation"}))))};e.prototype._renderExclusiveFeatureListBlock=function(){return c.createElement("div",{className:"od-PostPurchasePlansPage-listBlock od-PlanCardTest-featureListBlock od-PlanCardTest-listBlock"},c.createElement("p",{className:"od-PostPurchasePlansPage-featureListHeader"},u.strings.featureListTitle.toUpperCase()),c.createElement("ul",{className:"od-PlanCardTest-featureList od-PostPurchasePlansPage-featureList"},this._featureListItems.map(this._renderExclusiveFeatureListItem)))};e.prototype._renderSecurityFeatureListItem=function(e){return this._renderFeatureListItem(e,this.props.onClickSecurityFeatureCardLink)};e.prototype._renderExclusiveFeatureListItem=function(e){return this._renderFeatureListItem(e,this.props.onClickFeatureCardLink)};e.prototype._renderFeatureListItem=function(e,t){var i=this.props.plan;return c.createElement("li",{className:"od-PlanCardTest-featureListItem od-PostPurchasePlansPage-featureListItem"},c.createElement("a",{href:"javascript:;",className:"od-PlanCardTest-feature featureCardLink",onClick:function(){return t(e.indexInFeatureCardCarousel,i)}},c.createElement("div",{className:"od-PlanCardTest-featureListItemFlex"},c.createElement(o.Icon,{iconName:"CheckMark",className:"ms-Icon--CheckMark od-PlanCardTest-featureListItemContent"}),c.createElement("p",{className:"od-PlanCardTest-featureListItemText od-PlanCardTest-featureListItemContent"},e.text))))};t.__decorate([i.autobind],e.prototype,"_renderSecurityFeatureListBlock",null);t.__decorate([i.autobind],e.prototype,"_renderAppListBlock",null);t.__decorate([i.autobind],e.prototype,"_renderExclusiveFeatureListBlock",null);t.__decorate([i.autobind],e.prototype,"_renderSecurityFeatureListItem",null);t.__decorate([i.autobind],e.prototype,"_renderExclusiveFeatureListItem",null);t.__decorate([i.autobind],e.prototype,"_renderFeatureListItem",null);return e}(c.Component);e.default=n});define("odsp-next/providers/featureCards/FeatureCardsProvider",["require","exports","tslib","./FeatureCards.resx","../../providers/featureCards/FeatureCards.resx","../../controls/firstRunExperience/FirstRunExperience.resx","../../controls/planCard/PlanCard.resx","../../pages/storageOptions/odc/ODCStorageOptions.resx","../../models/storageOptions/IStorageOptions","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/features/Features"],function(a,e,t,i,l,d,o,r,c,n,s,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=u.isFeatureEnabled(u.EnablePasswordProtectedLinks),m={text:o.strings.SecurityBulletAlternate,hasGleam:!0,indexInFeatureCardCarousel:1,category:1},h={text:o.strings.ProductivityToolsBullet,hasGleam:!0,indexInFeatureCardCarousel:u.isFeatureEnabled(u.EnableSecurityMomentLightbox)?5:3,category:2},f={text:d.strings.spaceListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},g={text:d.strings.spaceHomeListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},b={text:d.strings.space50ListItem,hasGleam:!1,indexInFeatureCardCarousel:0,category:0};e.OFFICE_APPS_FEATURE_ITEM={text:l.strings.officeFeatureNameTwo,hasGleam:!1,indexInFeatureCardCarousel:u.isFeatureEnabled(u.EnableSecurityMomentLightbox)?8:6,category:3};var _={text:l.strings.fileRecoveryFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:0,category:1},y={text:l.strings.emailProtectionFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},v={text:l.strings.privacyToolsFeatureHeadline,hasGleam:!1,indexInFeatureCardCarousel:2,category:1},C={text:l.strings.expiringLinksFeatureName,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},x={text:d.strings.offlineListItem,hasGleam:!1,indexInFeatureCardCarousel:5,category:2},w={text:l.strings.multiScanHeadline,hasGleam:!1,indexInFeatureCardCarousel:6,category:2},S={type:8,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/password-protected-links.svg"):a("@ms/odsp-media/dist/media/images/premium/password-protected-links.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.passwordProtectedLinksFeatureName,description:i.strings.passwordProtectedBody,comingSoon:!p},k={type:4,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-powered-productivity.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-powered-productivity.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:i.strings.multiScanHeadline,description:i.strings.scanFeatureBodyFallBackTwo,comingSoon:!1},R={type:3,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-expiring-links.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-expiring-links.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.expiringLinksFeatureName,description:i.strings.expiringLinksBody,comingSoon:!1},D={type:2,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-personal.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-personal.svg"),backgroundColor:"#30C6CC",featureName:i.strings.officePersonalCategory,headline:i.strings.officePersonalFeatureName,description:i.strings.officePersonalFeatureBodyFallback2,comingSoon:!1},T=t.__assign({},D,{featureName:i.strings.premiumFeaturesCategory}),I={type:1,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-home.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-home.svg"),backgroundColor:"#FDB813",featureName:i.strings.officeHomeCategory,headline:i.strings.officeHomeFeatureName,description:i.strings.officeHomeFeatureBodyFallBackThree,comingSoon:!1},F={type:0,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-storage-only.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-storage-only.svg"),backgroundColor:"#9C5096",featureName:o.strings.BasicCapacity,headline:i.strings.storageOnlyFeatureName,description:i.strings.storageOnlyFeatureBody,comingSoon:!1},P={type:7,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-sharing.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-sharing.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:i.strings.moreSharingHeadline,description:i.strings.shareFeatureBody,comingSoon:!1},B={type:6,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-office-apps.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-office-apps.svg"),backgroundColor:"#FDB813",featureName:i.strings.officeFeatureNameTwo,headline:i.strings.officeAppsFeatureName,description:i.strings.officeAppsFeatureBodyAlternate,comingSoon:!1},L=t.__assign({},B,{featureName:i.strings.premiumFeaturesCategory}),M={type:5,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-offline.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-offline.svg"),backgroundColor:"#9B4F95",featureName:o.strings.ProductivityToolsBullet,headline:d.strings.offlineListItem,description:i.strings.productivityBody,comingSoon:!1},E={type:10,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-files-restore.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.fileRecoveryFeatureHeadline,description:i.strings.fileRecoveryFeatureBody,comingSoon:!1},A={type:9,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-files-restore.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.filesRestoreFeatureHeadline,description:i.strings.filesRestoreFeatureBody,comingSoon:!1},N={type:14,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-virus-protection.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:o.strings.SecurityBulletAlternate,headline:i.strings.ransomwareDetectionFeatureHeadline,description:i.strings.ransomwareDetectionFeatureBody,comingSoon:!1},H={type:11,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-virus-protection.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.emailProtectionFeatureHeadline,description:i.strings.emailProtectionFeatureBody,comingSoon:!1},O={type:12,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-privacy-tools.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-privacy-tools.svg"),backgroundColor:"#1A9BF5",featureName:i.strings.officeAdvancedProtectionCategory,headline:i.strings.privacyToolsFeatureHeadline,description:i.strings.privacyToolsFeatureBody,comingSoon:!1},V={type:13,imageUrl:"undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/feature-card-outlook-premium.svg"):a("@ms/odsp-media/dist/media/images/premium/feature-card-outlook-premium.svg"),backgroundColor:"#0078D7",featureName:i.strings.premiumFeaturesCategory,headline:i.strings.outlookPremiumFeatureHeadline,description:i.strings.outlookPremiumFeatureBody,comingSoon:!1},U={type:2,title:i.strings.officePersonalFeatureName,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.oneTBStorageBody,comingSoon:!1},z={type:1,title:i.strings.officeHomeCategory,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.fiveTBStorageBody,comingSoon:!1},K={type:0,title:i.strings.storageOnlyFeatureName,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:i.strings.fiftyGBStorageBody,comingSoon:!1},q={type:4,title:i.strings.multiScanHeadline,icon:"Copy",bubbleColor:"rgba(92, 45, 145, 0.1)",iconColor:"rgb(92, 45, 145)",bodyText:i.strings.multiPageScanExtendedBody,comingSoon:!1},j={type:3,title:i.strings.expiringLinksExpandedFeatureName,icon:"AlarmClock",bubbleColor:"rgba(232, 17, 35, 0.1)",iconColor:"rgb(232, 17, 35)",bodyText:i.strings.expirationDateBody,comingSoon:!1},W={type:8,title:i.strings.passwordProtectedLinksFeatureName,icon:"Lock",bubbleColor:"rgba(180, 0, 158, 0.1)",iconColor:"rgb(180, 0, 158)",bodyText:i.strings.passwordProtectedBody,comingSoon:!p},G={type:7,title:i.strings.moreSharingExpandedFeatureName,icon:"Share",bubbleColor:"rgba(255, 185, 0, 0.1)",iconColor:"rgb(255, 185, 0)",bodyText:i.strings.sharingLimitBody,comingSoon:!1},X={type:6,title:o.strings.appListWinMacTitle,icon:"ThisPC",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:i.strings.officeAppsExtendedBody,comingSoon:!1},Z={type:6,title:i.strings.officeMobileFeatureName,icon:"CellPhone",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:i.strings.officeMobileBody,comingSoon:!1},J={type:5,title:d.strings.offlineListItem,icon:"CloudDownload",bubbleColor:"rgba(16, 124, 16, 0.1)",iconColor:"rgb(16, 124, 16)",bodyText:i.strings.offlineFoldersExtendedBody,comingSoon:!1},Y={type:0,features:[U],title:l.strings.storageCategoryName},$={type:1,features:[j,W],title:o.strings.SecurityBulletAlternate},Q={type:2,features:[J,q,G],title:o.strings.ProductivityToolsBullet},ee={type:3,features:[X,Z],title:l.strings.officeAppsCategoryName},te=function(){function e(){}e.prototype.getFeatureListItems=function(e,t){void 0===t&&(t="");var i=this._getSpaceFeatureListItem(e);e!==c.PlanType.Home&&e!==c.PlanType.Personal&&e!==c.PlanType.Solo&&0<t.length&&(i.text=t);return[i,m,h]};e.prototype.getStandardFeatureListItemsForPostPurchasePlansPage=function(e){return[this._getSpaceFeatureListItem(e),C,w,x]};e.prototype.getSecurityFeatureListItems=function(){return[_,y,v]};e.prototype.getFeatureCards=function(e){var t=this._getCarouselStorageFeatureCard(e);if(e===c.PlanType.Storage)return[t];var i=u.isFeatureEnabled(u.EnableSecurityMomentLightbox)?[N,A]:[];return[t,R,S].concat(i,[M,k,P,B])};e.prototype.getFeatureCardsForSecurityMomentLightbox=function(e){void 0===e&&(e=!1);return[E,H,O].concat(e?[]:[T,V,L])};e.prototype.getReactFeatureCards=function(e){return{categories:this._getCategories(e),headerFooter:this._getHeaderFooter(e)}};e.prototype._getCategories=function(e){var t=this._getReactStorageFeatureCard(e),i=Y;i.features=[t];return e===c.PlanType.Storage?[i]:[i,$,Q,ee]};e.prototype._getHeaderFooter=function(e){var t,i=e===c.PlanType.Storage?d.strings.fiftyGBListHeader:d.strings.featuresTitle,o=this._getSecondaryTitle(e),r=this._getImageAltText(e),n=l.strings.gotItButton,s=d.strings.closeButtonAriaLabel;switch(e){case c.PlanType.Home:t="undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/storageoptions/premium-home.svg"):a("@ms/odsp-media/dist/media/images/storageOptions/premium-home.svg");break;case c.PlanType.Storage:t="undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/storage-only-badge-large.svg"):a("@ms/odsp-media/dist/media/images/premium/storage-only-badge-large.svg");break;default:t="undefined"==typeof __webpack_public_path__?a.toUrl("@ms/odsp-media/lib/images/premium/premium-diamond-large.svg"):a("@ms/odsp-media/dist/media/images/premium/premium-diamond-large.svg")}return{image:t,imageAltText:r,mainTitle:i,secondaryTitle:o,buttonText:n,closeButtonAriaLabel:s}};e.prototype._getSecondaryTitle=function(e){void 0===e&&(e=c.PlanType.Personal);switch(e){case c.PlanType.Home:case c.PlanType.Trial:return o.strings.planHomeHeaderText;case c.PlanType.Storage:return d.strings.fiftyGBTitle;case c.PlanType.Solo:return s.format(d.strings.shortenedListHeader,r.strings.office365Solo);default:return o.strings.planPersonalHeaderText}};e.prototype._getImageAltText=function(e){void 0===e&&(e=c.PlanType.Personal);switch(e){case c.PlanType.Home:case c.PlanType.Trial:return d.strings.multiPremiumGleamAltText;case c.PlanType.Storage:return s.format(r.strings.iconAltText,r.strings.ListFiftyGBPlanDescription);default:return d.strings.premiumGleamAltText}};e.prototype._getSpaceFeatureListItem=function(e){void 0===e&&(e=c.PlanType.Personal);switch(e){case c.PlanType.Home:case c.PlanType.Trial:return g;case c.PlanType.Storage:return b;default:return f}};e.prototype._getCarouselStorageFeatureCard=function(e){void 0===e&&(e=c.PlanType.Personal);switch(e){case c.PlanType.Home:case c.PlanType.Trial:return I;case c.PlanType.Storage:return F;default:return D}};e.prototype._getReactStorageFeatureCard=function(e){void 0===e&&(e=c.PlanType.Personal);switch(e){case c.PlanType.Home:case c.PlanType.Trial:return z;case c.PlanType.Storage:return K;default:return U}};return e}();e.default=te;e.resourceKey=new n.ResourceKey({name:a("module").id,factory:new n.SimpleResourceFactory(te)})});define("odsp-next/controls/reactPostPurchasePlansPage/PostPurchasePlansPage.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PostPurchasePlansPage-downloadAppsButton{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-bottom:12px;display:none}.lg .od-PostPurchasePlansPage-downloadAppsButton,.xlg .od-PostPurchasePlansPage-downloadAppsButton,.xxlg .od-PostPurchasePlansPage-downloadAppsButton,.xxxlg .od-PostPurchasePlansPage-downloadAppsButton,.xxxxlg .od-PostPurchasePlansPage-downloadAppsButton{display:block}.od-PostPurchasePlansPage-downloadAppsButtonSmall{display:inline-block}.lg .od-PostPurchasePlansPage-downloadAppsButtonSmall,.xlg .od-PostPurchasePlansPage-downloadAppsButtonSmall,.xxlg .od-PostPurchasePlansPage-downloadAppsButtonSmall,.xxxlg .od-PostPurchasePlansPage-downloadAppsButtonSmall,.xxxxlg .od-PostPurchasePlansPage-downloadAppsButtonSmall{display:none}.od-PostPurchasePlansPage-smallBreakpointButtonContainer{text-align:center}.od-PostPurchasePlansPage-appListBlockContainer{display:inline-block}.od-PostPurchasePlansPage-seeMoreLinks{display:-ms-inline-flexbox;display:inline-flex}.od-PostPurchasePlansPage-link,.od-PostPurchasePlansPage-spacer{display:none}.lg .od-PostPurchasePlansPage-link,.lg .od-PostPurchasePlansPage-spacer,.xlg .od-PostPurchasePlansPage-link,.xlg .od-PostPurchasePlansPage-spacer,.xxlg .od-PostPurchasePlansPage-link,.xxlg .od-PostPurchasePlansPage-spacer,.xxxlg .od-PostPurchasePlansPage-link,.xxxlg .od-PostPurchasePlansPage-spacer,.xxxxlg .od-PostPurchasePlansPage-link,.xxxxlg .od-PostPurchasePlansPage-spacer{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:center;justify-content:center;-ms-flex-line-pack:start;align-content:flex-start;width:165px}.xlg .od-PostPurchasePlansPage-link,.xlg .od-PostPurchasePlansPage-spacer,.xxlg .od-PostPurchasePlansPage-link,.xxlg .od-PostPurchasePlansPage-spacer,.xxxlg .od-PostPurchasePlansPage-link,.xxxlg .od-PostPurchasePlansPage-spacer,.xxxxlg .od-PostPurchasePlansPage-link,.xxxxlg .od-PostPurchasePlansPage-spacer{width:220px}.od-PostPurchasePlansPage-spacer{width:185px}.xlg .od-PostPurchasePlansPage-spacer,.xxlg .od-PostPurchasePlansPage-spacer,.xxxlg .od-PostPurchasePlansPage-spacer,.xxxxlg .od-PostPurchasePlansPage-spacer{width:230px}.od-PostPurchasePlansPage-featureListHeader{text-align:center;padding:0 20px}.od-PostPurchasePlansPage-featureList{width:100%}"}])});