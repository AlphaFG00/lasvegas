define("odsp-next/controls/buttonBar/ButtonBar",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../commandBar/CommandBarViewModel","./ButtonBar.html","./ButtonBar.css","./command/ButtonBarCommand"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o.registerComponent({tagName:"od-button-bar",template:e("./ButtonBar.html"),viewModel:n.CommandBarViewModel,synchronous:!0});t.default=i});define("odsp-next/controls/commandBar/CommandBarViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../bindings/overflow/OverflowBinding","../../bindings/element/ElementBinding","@ms/odsp-shared/lib/utilities/knockout/Translators","../../utilities/browser/ResponsiveUI","@microsoft/load-themed-styles"],function(e,t,o,i,n,a,s,r,l,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){o.__extends(e,n);function e(e,t){void 0===t&&(t={});var o=n.call(this,e,t)||this;m.flush();o._allCommands=i.observableArray();o.overflowCommands=i.observableArray();o.focusedCommand=i.observable();o.fixedCommands=[];o._overflowCommandsSubscription=null;o._commandSetCommandsReplicationSubscription=null;o.responsiveUI=o.resources.consume(u.resourceKey);o.addBindingHandlers({selection:s.default,overflow:r.default,keyboard:a.default,element:l.default});o._mainCommandsFirstTimeRendered=i.observable(!1);o.keyboardOptions=[{mappings:{Down:o.onNavigateDown,Enter:o.onEnter}},{target:document,mappings:{},allowButtonEvents:!0}];o._initializeCommandsObservables();o._initializeFocusLogic(!!e.focusOnFirstCommand||!1);o._commandSet=o.wrapObservable(e.commandSet);o._initializeCommandSet(o._commandSet.peek());o.subscribe(o._commandSet,function(e){o._initializeCommandSet(e)});return o}e.prototype.getCommandBarItemParams=function(e,t){var o=this;return{command:e,index:4&e.location?this.observables.pureCompute(function(){return t()+o.mainCommands().length}):t}};e.prototype.onNavigateDown=function(e,t){var o=this.focusedCommand();o&&o.openMenu()&&t.preventDefault();return!1};e.prototype.onEnter=function(e,t){var o=this.focusedCommand();if(!o)return!0;var n=t.target.getElementsByTagName("input");if(!n||!n.length)return o.onClick(o,t);n[0].click();t.stopPropagation();t.preventDefault()};e.prototype.animateIn=function(e,t,o){if(o.hasAnimation&&1===e.nodeType){i.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0);this.async.setTimeout(function(){i.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3)}};e.prototype.animateOut=function(e,t,o){if(o.hasAnimation&&1===e.nodeType){i.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0);this.async.setTimeout(function(){i.removeNode(e)},1e3)}else i.removeNode(e)};e.prototype._updateCommandKeyboardShortcuts=function(e,t){for(var o=0;o<t.length;o++){var n=t[o];if(n.keys)for(var i=n.onClick.bind(n),a=0;a<n.keys.length;a++){var s=n.keys[a];e[s]||(e[s]=[]);e[s].push(i)}var r=n.children();r.length&&this._updateCommandKeyboardShortcuts(e,r)}};e.prototype._initializeCommandSet=function(t){var o=this;if(this._overflowCommandsSubscription){this._overflowCommandsSubscription.dispose();this._overflowCommandsSubscription=null}if(this._commandSetCommandsReplicationSubscription){this._commandSetCommandsReplicationSubscription.dispose();this._commandSetCommandsReplicationSubscription=null}this._allCommands([]);this.fixedCommands=[];this.keyboardOptions[1].mappings={};if(t){this._commandSetCommandsReplicationSubscription=d.replicateArray(t.commands,this._allCommands);this.addDisposable(this._commandSetCommandsReplicationSubscription);if(t.overflowHostCommand){this.fixedCommands.push(t.overflowHostCommand);this._overflowCommandsSubscription=this.createBackgroundComputed(function(){var e=o.overflowCommands().concat(o._overflowOnlyCommands());t.overflowHostCommand.children(e)})}this._mainCommandsFirstTimeRendered.peek()||this._mainCommandsFirstTimeRendered(!0)}};e.prototype._initializeCommandsObservables=function(){var o=this,e=this._allCommands,t=this._visibleCommands=this.addDisposable(e.filter(function(e){return e.isVisible()&&0!=(7&e.location)}));this.mainCommands=this.addDisposable(t.filter(p));this._overflowOnlyCommands=this.addDisposable(e.filter(f));this.sideCommands=this.addDisposable(t.filter(h));this.selectableCommands=this.addDisposable(t.filter(function(e){return!(f(e)||o._isOverflowEnabled()&&0<=o.overflowCommands.indexOf(e))&&!e.isDisabled()}));this.subscribe(e,function(e){var t={};o._updateCommandKeyboardShortcuts(t,e);o.keyboardOptions[1].mappings=t})};e.prototype._initializeFocusLogic=function(t){var o=this,e=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),n=this.createComputed(function(){return 0<e().length});this.createComputed(function(){n()||i.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!o.topTab.peek()||o.topTab.peek().focus()}).extend({rateLimit:0});this.topTab=i.observable(null);this.subscribe(this._mainCommandsFirstTimeRendered,function(e){o.async.setImmediate(function(){e&&t&&o._focusOnFirstCommand()})})};e.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand};e.prototype._focusOnFirstCommand=function(){if(this._visibleCommands()&&0<this._visibleCommands().length){var e=this._visibleCommands()[0];e.focused(!0);this.focusedCommand(e)}};return e}(n.default);t.CommandBarViewModel=c;function p(e){return 3==(3&e.location)}function h(e){return 4==(4&e.location)}function f(e){return 2==(3&e.location)}t.default=c});define("odsp-next/bindings/overflow/OverflowBinding",["require","exports","knockout","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,x,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function b(){}b.init=function(s,r,l){var d=x.observable();x.computed(function(){d();var e=x.utils.unwrapObservable(r()),t=l(),o=null;o=e.data?e.data:t.foreach&&t.foreach.data||t.foreach||t.template&&t.template.foreach;var n=e.responsiveUI.formFactorSize(),i=x.utils.unwrapObservable(o),a=x.utils.unwrapObservable(e.alwaysVisibleItems);b._calculateElementVisibility(s,e,i,a,n)},null,{disposeWhenNodeIsRemoved:s}).extend({throttle:1});var e=new o.default(s);x.utils.domNodeDisposal.addDisposeCallback(s,function(){e.dispose()});e.on(s,"layoutChange",function(e){d.notifySubscribers()});e.on(window,"resize",function(e){d.notifySubscribers()});e.on(document,"transitionend",function(e){d.notifySubscribers()})};b._calculateElementVisibility=function(e,t,o,n,i){if(o&&o.length){var a=e.getBoundingClientRect(),s=a.right-a.left,r=0,l=[],d=[];if(n&&o)for(var u=0,m=n.length;u<m;u++){var c=n[u],p=x.utils.arrayIndexOf(o,c);if(-1<p&&p<e.children.length){var h=e.children[p];s-=b._measureElement(h).width}}for(u=0,m=e.children.length;u<m;u++){h=e.children[u];var f="Small"===i&&0<u,C=void 0;o&&(C=o[u]);r+=b._measureElement(h).width;var _=n&&C&&-1<x.utils.arrayIndexOf(n,C),v=!_&&(s<r||f);C&&x.isObservable(C.isClipped)&&C.isClipped(v);if(!_){var g="none"!==h.style.display;v||g?v&&g&&(h.style.display="none"):h.style.display=""}if(v){l.push(h);C&&d.push(C)}}if(t){x.isObservable(t.overflowElements)&&t.overflowElements(l);x.isObservable(t.overflowItems)&&t.overflowItems(d)}}};b._measureElement=function(e){var t=e.style.display;e.style.display="";var o=e.getBoundingClientRect(),n=window.getComputedStyle(e),i=parseFloat(n.marginLeft),a=parseFloat(n.marginRight),s=parseFloat(n.marginTop),r=parseFloat(n.marginBottom);e.style.display=t;return{left:o.left-i,right:o.right+a,top:o.top-s,bottom:o.bottom+r,width:o.right-o.left+i+a,height:o.bottom-o.top+s+r}};return b}();t.default=n});define("@ms/odsp-shared/lib/utilities/knockout/Translators",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replicateArray=function(n,i){var e=function(e){var t=n.peek(),o=i.peek();i.valueWillMutate();o.splice.apply(o,[0,o.length].concat(t));i.valueHasMutated()},t=n.subscribe(e,null,"arrayChange");e();return t}});define("odsp-next/controls/buttonBar/ButtonBar.html",[],function(){return'<span class=od-ButtonBar data-bind="keyboard: keyboardOptions, element: topTab"><span class=od-ButtonBar-main data-bind="foreach: mainCommands">\x3c!--ko component: {\r\n name: \'od-button-bar-command\',\r\n params: {\r\n command: $data,\r\n index: $index\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</span> <span class=od-ButtonBar-side data-bind="foreach: sideCommands">\x3c!--ko component: {\r\n name: \'od-button-bar-command\',\r\n params: {\r\n command: $data,\r\n index: $index\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</span></span>'});define("odsp-next/controls/buttonBar/ButtonBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ButtonBar{display:block;height:30px}[dir=ltr] .od-ButtonBar .od-Button{margin-right:10px}[dir=rtl] .od-ButtonBar .od-Button{margin-left:10px}[dir=ltr] .od-ButtonBar .od-Button:last-child{margin-right:0}[dir=rtl] .od-ButtonBar .od-Button:last-child{margin-left:0}.od-ButtonBar-main{display:block;height:30px;white-space:nowrap}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px 20px}.od-ButtonBarCommand-icon{display:inline-block}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:#a80000}"}])});define("odsp-next/controls/buttonBar/command/ButtonBarCommand",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ButtonBarCommandViewModel","./templates/ButtonBarCommandTemplates","./ButtonBarCommand.html","./templates/ButtonBarCommandButton.html","./templates/ButtonBarCommandText.html"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.registerComponent({tagName:"od-button-bar-command",template:e("./ButtonBarCommand.html"),viewModel:n.default,synchronous:!0});o.registerTemplate(i.BUTTON,e("./templates/ButtonBarCommandButton.html"));o.registerTemplate(i.TEXT,e("./templates/ButtonBarCommandText.html"));t.default=a});define("odsp-next/controls/buttonBar/command/ButtonBarCommandViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./templates/ButtonBarCommandTemplates","../../commands/CommandState","knockout"],function(e,t,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){n.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._index=e.index;t.command=e.command;t.focused=s.observable(!1);t.selected=s.observable(!1);t.templateName=t.createPureComputed(t._computeTemplateName);t.isPrimary=t.createPureComputed(t._computeIsPrimary);t.state=t.createPureComputed(t._computeState);return t}e.prototype._computeTemplateName=function(){return!this.command.action||!this.unwrapObservable(this.command.isPermanent)&&this.command.isDisabled()?i.TEXT:i.BUTTON};e.prototype._computeIsPrimary=function(){return 0===this._index()};e.prototype._computeState=function(){return a.default[this.command.state()||a.default.initialized]};return e}(o.default);t.default=r});define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BUTTON="od-button-bar-command-button";t.TEXT="od-button-bar-command-text"});define("odsp-next/controls/buttonBar/command/ButtonBarCommand.html",[],function(){return"\x3c!--ko template: templateName--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandButton.html",[],function(){return'<button class="od-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr: { title: command.tooltip }, css: { \'is-disabled\': command.isDisabled, \'is-focused\': command.focused, \'od-Button--primary\': isPrimary }, hasFocus: command.isActive, disable: command.isDisabled, click: command.onClick.bind(command)">\x3c!--ko if: command.icon--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon" data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon: true, style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span>\x3c!--/ko--\x3e\x3c!--ko if: command.isLabelVisible--\x3e<span class="od-Button-label od-ButtonBarCommand-label" data-bind="text: command.label"></span>\x3c!--/ko--\x3e</button>'});define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandText.html",[],function(){return'<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="class: \'od-ButtonBarCommand--\' + state()">\x3c!--ko if: command.icon--\x3e<span class=od-ButtonBarCommand-icon data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon: true, style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span>\x3c!--/ko--\x3e\x3c!--ko if: command.isLabelVisible--\x3e<span class=od-ButtonBarCommand-label data-bind="text: command.label"></span>\x3c!--/ko--\x3e</span>'});define("@ms/odsp-shared/lib/utilities/knockout/Extenders",["require","exports","@ms/odsp-utilities/lib/disposable/Disposable"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.skipAnimationFrame=function(t,o){t.extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});var n,e=t.subscribe(function(e){o.cancelAnimationFrame(n);n=o.requestAnimationFrame(function(){n=o.requestAnimationFrame(function(){n=void 0;t()})})},null,"beforeChange");return t=i.hook(t,function(){e.dispose()})};t.withComparer=function(e,t){e.equalityComparer=t;return e}});define("@ms/odsp-shared/lib/utilities/navigation/InPlaceNavigation",["require","exports","tslib","../../base/BaseModel","./NavigationHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,a,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){a.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.beforeUnload=void 0;t.viewParamsObservable=t.createObservable({});t.viewParamsObservable.equalityComparer=n.deepCompare;t.events.declare("change");t.subscribe(t.viewParamsObservable,t._onViewParamsChanged);return t}e.prototype.navigateTo=function(e){var t=("string"==typeof e?{url:e}:e).url;if(0===t.indexOf("#")){var o=s.deserializeQuery(t.substring(1));this.viewParamsObservable(o)}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});"string"==typeof e&&(e=s.deserializeQuery(e));var o=t.clearOtherParams,n=void 0!==o&&o,i=a.__assign({},n?{}:this.viewParams,e);this.viewParamsObservable(s.deserializeQuery(s.serializeQuery(i)))};e.prototype.reload=function(){};e.prototype._onViewParamsChanged=function(e){this.viewParams=e;this.events.raise("change",e)};return e}(o.default);t.default=i});define("odsp-next/controls/carousel/Carousel",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CarouselViewModel","./Carousel.html","./Carousel.css"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o.registerComponent({tagName:"ms-carousel",template:e("./Carousel.html"),viewModel:n.default,synchronous:!0});t.default=i});define("odsp-next/controls/carousel/CarouselViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/knockout/Extenders","@ms/odsp-shared/lib/base/ViewModel","./CarouselSlideViewModel","../../bindings/pan/PanBinding","../../bindings/host/HostBinding"],function(e,t,o,n,d,u,h,i,a,l,f,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(p){o.__extends(e,p);function e(e,t){void 0===t&&(t={});var n=p.call(this,e,t)||this;n.addBindingHandlers({host:C.default,pan:f.default});var o=e.item,i=e.items,a=e.isEnabled,s=void 0===a||a,r=e.isRotating,l=void 0===r?n.createObservable(!1):r,d=e.loadState,u=void 0===d?n.createObservable(0):d,m=e.allocationRange,c=void 0===m?n.createObservable({start:0,end:0}):m;n.item=o;n._items=i;n._slideAllocationCount=n.createPureComputed(function(){return!e.canNavigate||e.canNavigate()?15:1});n._allocationRange=c;n.isEnabled=n.wrapObservable(s);n.isRotating=l;n.loadState=u;n._rotationThreshold=.3;n._velocityThreshold=1;n._index=n.createPureComputed(n._computeIndex);n._lastValidIndex=n.createPureComputed(n._computeLastValidIndex);n._itemsInSlides=n.observables.createArray();n._itemHistory=n.observables.createArray();n.createBackgroundComputed(n._computeUpdateItemHistory);n.createBackgroundComputed(n._computeCleanItemHistory).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}});n._elementsToRemove=n.observables.createArray();n._initializeSlides();n._initializeMotion();n.carouselTransform=n.createPureComputed(n._computeCarouselTransform);n.carouselTransform.equalityComparer=h.deepCompare;n._initializeDirection();n.createBackgroundComputed(n._computeSwitchItemsOnItemRemoval);n.createBackgroundComputed(n._computeAllocationRange);n.createBackgroundComputed(n._computeItemsInSlides);n.createBackgroundComputed(n._computeElementsToRemove).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}});n.platformStyle=n.createPureComputed(n._computePlatformStyle);n.panBindingParams={isActive:n.isPowered,isEnabled:n.isEnabled,transform:n.panTransform,mayStartPan:function(e,t,o){return n.isEnabled.peek()&&10<=Math.abs(e.translate.x)&&t<5&&o.length<2},allowedModes:7};return n}e.prototype.onSlideRemoved=function(e){n.utils.toggleDomNodeCssClass(e,"is-deleted",!0);n.utils.toggleDomNodeCssClass(e,"is-current",!1);this._elementsToRemove.push(e)};e.prototype._initializeMotion=function(){this.isFlipping=this.createObservable(!0);this.isPowered=this.createObservable(!1);this.isGliding=this.createObservable(!1);this.panTransform=this.createObservable(u.default.IDENTITY);this.panTransform.equalityComparer=h.deepCompare;this._initializeVelocity();this.createBackgroundComputed(this._computeStartPowered);this.createBackgroundComputed(this._computeRotateToSlide);i.skipAnimationFrame(this.createBackgroundComputed(this._computeStartGlide),this.async);this.createBackgroundComputed(this._computeEndGlide).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}});this.createBackgroundComputed(this._computeEndRotation)};e.prototype._computeStartPowered=function(){if(this.isPowered()){this.isRotating(!0);this.isGliding(!1);this.isFlipping(!1)}};e.prototype._computeStartGlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){this.panTransform(u.default.IDENTITY);this.isGliding(!0);this.isRotating(!0)}};e.prototype._computeEndGlide=function(){var e=this.isPowered.peek(),t=this.isGliding();if(!e&&t){this.isGliding(!1);this.isRotating(!1)}};e.prototype._computeEndRotation=function(){this.isRotating()||this.isFlipping(!0)};e.prototype._initializeDirection=function(){var t=this,o=this._index.peek();this.addDisposable(this.item.subscribe(function(){o=t._index.peek()},this,"beforeChange"));this.createBackgroundComputed(function(){t.isFlipping()&&(o=t._index.peek())});this.direction=this.createPureComputed(function(){var e=t._index();return t.isFlipping()&&-1<e&&-1<o?Math.max(-1,Math.min(1,e-o)):0})};e.prototype._initializeSlides=function(){var r=this,e=this.addDisposable(this._itemsInSlides.filter(function(e){return e&&(-1<r._items.indexOf(e)||e===r.item())}));this.slides=this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var t=r.createObservable(0),o=r.createPureComputed(function(){return r._items.indexOf(e)}),n=r.createPureComputed(function(){return o()-r._index()}),i=r.createComputed(function(){n()||r.loadState(t())}),a=r.createPureComputed(function(){return r._itemHistory.indexOf(e)+1}),s=new(r.resources.injected(l.default))({item:e,offset:n,loadState:t,order:a});return{mappedValue:s,dispose:function(){s.dispose();n.dispose();o.dispose();i.dispose();a.dispose()}}}}))};e.prototype._computeAllocationRange=function(){var e=this.item(),t=this._items,o=t().length,n=this._itemsInSlides.peek(),i=t.indexOf(e),a=n.indexOf(e),s=this._slideAllocationCount();if((-1===a||2<=i&&a<2||i<=o-1-2&&a>n.length-1-2||o<=s&&o!==n.length)&&-1<i)if(1<s){var r=i+this.direction.peek()*(.8*(Math.floor(s/2)-2)),l=Math.max(0,Math.min(o-s,r-Math.floor(s/2))),d=Math.min(o,l+s);this._allocationRange({start:l,end:d})}else this._allocationRange({start:i,end:i+1})};e.prototype._computeItemsInSlides=function(){var e,t,o=this._allocationRange();if(-1<this._index()&&0<o.end-o.start)e=this._items.slice(o.start,o.end);else{var n=this.item();e=n?[n]:[]}(t=this._itemsInSlides).splice.apply(t,[0,this._itemsInSlides.peek().length].concat(e))};e.prototype._computeSwitchItemsOnItemRemoval=function(){var e=this.item.peek(),t=this._items.indexOf(e),o=this._lastValidIndex();if(-1===t&&e&&-1<o){var n=this._items.peek(),i=Math.max(0,Math.min(n.length-1,o));n[i]&&this.item(n[i])}};e.prototype._computeUpdateItemHistory=function(){var e=this.item();this._itemHistory.unshift(e)};e.prototype._computeCleanItemHistory=function(){1<this._itemHistory().length&&this._itemHistory.splice(1,this._itemHistory().length)};e.prototype._computeElementsToRemove=function(){this.item();this._itemsInSlides();for(var e;e=this._elementsToRemove.shift();)n.removeNode(e)};e.prototype._initializeVelocity=function(){var n=this,i=this.panTransform.peek(),a=0;this.velocity=this.createPureComputed(function(){var e=n.panTransform(),t=(new Date).getTime(),o=e.translate.subtract(i.translate).scale(1e3/(t-a));a=t;i=e;return o});this.velocity.equalityComparer=h.deepCompare};e.prototype._computeRotateToSlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){var o=this.panTransform.peek().translate.negate(),n=this.velocity.peek().negate(),i=this._index.peek(),a=this._calculateFractionalIndexOffset(o,n)+o.x;this.item(this._items.peek()[Math.max(0,Math.min(this._items.peek().length-1,i+Math.round(a)))]);this.panTransform(new u.default(new d.default(this._index.peek(),0).subtract(new d.default(i,0).add(o))))}};e.prototype._calculateFractionalIndexOffset=function(e,t){var o=0;e.x>this._rotationThreshold&&e.x<.5?o+=.5:e.x<-this._rotationThreshold&&-.5<e.x&&(o-=.5);t.x>this._velocityThreshold&&e.x<.5?o+=.5:t.x<-this._velocityThreshold&&-.5<e.x&&(o-=.5);return o=Math.max(-1,Math.min(1,o))};e.prototype._computeCarouselTransform=function(){var e=this.panTransform().translate,t=this._items.peek().length,o=this._index.peek();if(-1===o){o=0;t=1}var n=-e.x,i=n,a=o+n;if(a<0||t-1<a){var s=0<n?Math.floor:Math.ceil,r=Math.max(0-o,Math.min(t-1-o,s(n))),l=Math.PI;i=Math.atan(l*(n-r))/l+r}return new u.default(new d.default(-i,e.y))};e.prototype._computeIndex=function(){return this._items.indexOf(this.item())};e.prototype._computeLastValidIndex=function(){var e=this._items.indexOf(this.item());if(e<0){var t=this._lastValidIndex.peek();if("number"==typeof t)return t}return e};e.prototype._computePlatformStyle=function(){var e="translate("+100*this.carouselTransform().translate.x+"%, 0)";return{"-ms-transform":e,"-webkit-transform":e,transform:e}};return e}(a.default);t.default=s});define("odsp-next/controls/carousel/CarouselSlideViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding"],function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){n.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.addBindingHandlers({host:i.default});t.item=e.item;t.offset=e.offset;t.loadState=e.loadState||t.observables.create(0);t.order=e.order||t.observables.create(1);t.direction=t.createComputed(t._computeDirection);return t}e.prototype._computeDirection=function(){var e=this.offset();return 0<e?1:e<0?-1:0};return e}(o.default);t.default=a});define("odsp-next/bindings/pan/PanBinding",["require","exports","tslib","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,o,u,m,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=10,a={0:function(e){return e},1:function(e){return 18*e},2:function(e){return.5*window.innerHeight}},s=window.navigator,l=s&&s.pointerEnabled,r=function(r){o.__extends(e,r);function e(e){var t=r.call(this,e)||this,o=e.valueAccessor(),n=t.observables,i=o.allowedModes,a=void 0===i?15:i;t._transformV=o.transform||n.create(m.default.IDENTITY);t._isActive=o.isActive||n.create(!1);t._isEnabled=o.isEnabled||n.create(!0);t._mayStartPan=o.mayStartPan||d;t._constrainScale=o.constrainScale||c;t._allowedModes=a;t._useNativePan=!!o.useNativePan;t._gestureMode=n.create(0);t._touchCount=0;t._pointers={};t._pointerCount=0;t._initialTransformV=n.create(m.default.IDENTITY);t._initialTransformV.equalityComparer=h;t._incrementTransformPx=n.create(m.default.IDENTITY);t._incrementTransformPx.equalityComparer=h;t._initialCenterPx=n.create();t._initialCenterPx.equalityComparer=p;t._initialRadius=n.create();t._incrementTransformV=n.compute(t._computeIncrementTransformV);t._incrementTransformV.equalityComparer=h;n.compute(t._computeResetTransform);n.compute(t._computeTransform);var s={};if(l&&7&a)s.pointerdown=t._onPointerDown;else{1&a&&(s.touchstart=t._onTouchStart);6&a&&(s.mousedown=t._onMouseDown)}if(8&a){t._isWheeling=n.compute(t._computeIsWheeling);n.compute(t._computeStopWheeling).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});n.compute(t._computeEndWheel);s.wheel=t._onWheel}s.contextmenu=function(e){if(t._isEnabled.peek())return 0!=(4&a)};t.events.onAll(t.element,s);return t}e.prototype._computeIncrementTransformV=function(){var e=this._size||u.default.ORIGIN,t=this._incrementTransformPx();return new m.default(new u.default(t.translate.x/e.x,t.translate.y/e.y),t.scale)};e.prototype._computeResetTransform=function(){if(!this._initialCenterPx()){this._initialTransformV(this._transformV());this._incrementTransformPx(m.default.IDENTITY)}};e.prototype._computeTransform=function(){this._isActive()&&this._transformV(this._incrementTransformV().multiply(this._initialTransformV.peek()))};e.prototype._computeIsWheeling=function(){return 8===this._gestureMode()};e.prototype._computeStopWheeling=function(){var e=this._isWheeling();this._transformV();e&&this._gestureMode(0)};e.prototype._computeEndWheel=function(){if(!this._isWheeling()){this._clearGesture();this._isActive(!1)}};e.prototype._onWheel=function(e){if(this._isEnabled.peek()){e.preventDefault();this._updateSize();var t=this._transformToElement(e),o=a[e.deltaMode](e.deltaY);this._handleWheel(t,o)}};e.prototype._handleWheel=function(e,t){var o=Math.pow(2,-t/300);if(!this._initialCenterPx.peek()){this._gestureMode(8);this._resetGesture([e.add(this._size.scale(-.5)),e.add(this._size.scale(.5))])}var n=m.default.zoom(e.subtract(this._initialCenterPx.peek()),e,o);8===this._gestureMode.peek()&&this._continueGesture(this._gesturePoints.map(function(e){return n.apply(e)}))};e.prototype._onMouseDown=function(e){if(this._isEnabled.peek()&&0===e.button){this._updateSize();var t=this._transformToElement(e);this._gestureMode(4);var o=e.ctrlKey?[this._size.subtract(t),t]:[t];this._resetGesture(o);this.events.off(this.element,"mousedown",this._onMouseDown);this.events.onAll(document,{mousedown:this._onMouseDown,mouseup:this._onMouseUp,click:this._onClick,mousemove:this._onMouseMove},!0)}};e.prototype._onMouseMove=function(e){e.preventDefault();this._updateSize(!1);var t=this._transformToElement(e),o=e.ctrlKey?[this._size.subtract(t),t]:[t];4===this._gestureMode.peek()&&this._continueGesture(o)};e.prototype._onClick=function(e){Date.now()-this._lastActiveMouseUp<100&&e.stopPropagation()};e.prototype._onMouseUp=function(e){if(0===e.button){if(this._isActive()){this._lastActiveMouseUp=Date.now();e.preventDefault()}this._updateSize(!1);if(4===this._gestureMode.peek()){this._clearGesture();this._gestureMode(0)}this._isActive(!1);this.events.off(document,"mousedown",this._onMouseDown,!0);this.events.off(document,"mouseup",this._onMouseUp,!0);this.events.off(document,"mousemove",this._onMouseMove,!0);this.events.on(this.element,"mousedown",this._onMouseDown)}};e.prototype._onTouchStart=function(e){if(this._isEnabled.peek()){this._isActive.peek()&&(!this._useNativePan||1<e.touches.length)&&e.preventDefault();this._updateSize(0===this._touchCount);var t=this._touchCount;this._touchCount+=e.changedTouches.length;if(!t&&this._touchCount){this._gestureMode(1);this.events.off(this.element,"touchstart",this._onTouchStart);this.events.onAll(document,{touchstart:this._onTouchStart,touchmove:this._onTouchMove,touchend:this._onTouchEnd,touchcancel:this._onTouchCancel},!0)}else 1===this._gestureMode.peek()&&this._clearGesture();1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))}};e.prototype._onTouchMove=function(e){(!this._useNativePan||1<e.touches.length)&&e.preventDefault();this._updateSize(!1);this._continueGesture(this._getPointsFromTouches(e.touches))};e.prototype._onTouchEnd=function(e){this._isActive.peek()&&e.preventDefault();this._updateSize(!1);this._removeTouches(e)};e.prototype._onTouchCancel=function(e){this._updateSize(!1);this._removeTouches(e)};e.prototype._removeTouches=function(e){var t=this._touchCount;this._touchCount-=e.changedTouches.length;1===this._gestureMode.peek()&&this._clearGesture();if(t&&!this._touchCount){1===this._gestureMode.peek()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"touchstart",this._onTouchStart,!0);this.events.off(document,"touchmove",this._onTouchMove,!0);this.events.off(document,"touchend",this._onTouchEnd,!0);this.events.off(document,"touchcancel",this._onTouchCancel,!0);this.events.on(this.element,"touchstart",this._onTouchStart)}else 1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))};e.prototype._onPointerDown=function(e){if(this._isEnabled.peek()){var t=this._allowedModes,o=e.pointerType,n="mouse"===o?4:"pen"===o?2:1;if(t&n&&!this._pointers[e.pointerId]){var i=0===this._pointerCount;!this._isActive.peek()||this._useNativePan&&i||e.preventDefault();this._updateSize(i);this._pointers[e.pointerId]=this._transformToElement(e);this._pointerCount++;if(i){this._gestureMode(n);this.events.off(this.element,"pointerdown",this._onPointerDown);this.events.onAll(document,{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointercancel:this._onPointerCancelOrLost,lostpointercapture:this._onPointerCancelOrLost},!0)}else this._isPointerGesture()&&this._clearGesture();this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}}};e.prototype._onPointerMove=function(e){if(this._pointers[e.pointerId]){(!this._useNativePan||1<this._pointerCount)&&e.preventDefault();this._updateSize(!1);this._pointers[e.pointerId]=this._transformToElement(e);this._isPointerGesture()&&this._continueGesture(this._getPointsFromPointers())}};e.prototype._onPointerUp=function(e){this._isActive()&&e.preventDefault();this._onPointerCancelOrLost(e)};e.prototype._onPointerCancelOrLost=function(e){this._updateSize(!1);this._removePointers(e)};e.prototype._removePointers=function(e){if(this._pointers[e.pointerId]){delete this._pointers[e.pointerId];this._pointerCount--;this._isPointerGesture()&&this._clearGesture();if(0===this._pointerCount){this._isPointerGesture()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"pointerdown",this._onPointerDown,!0);this.events.off(document,"pointermove",this._onPointerMove,!0);this.events.off(document,"pointerup",this._onPointerUp,!0);this.events.off(document,"pointercancel",this._onPointerCancelOrLost,!0);this.events.off(document,"lostpointercapture",this._onPointerCancelOrLost,!0);this.events.on(this.element,"pointerdown",this._onPointerDown)}else this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}};e.prototype._clearGesture=function(){this._gesturePoints=null;this._initialCenterPx(null)};e.prototype._continueGesture=function(e){this._gesturePoints=e;this._initialCenterPx.peek()||this._resetGesture(e);var t,o=u.default.getCenter(e),n=this._getRadius(e,o),i=this._initialRadius.peek();t=0!==n&&0!==i?n/i:1;var a=this._initialTransformV.peek().scale*t,s=this._constrainScale(a)/a,r=this._initialCenterPx.peek(),l=m.default.zoom(u.default.ORIGIN,r,t*s),d=new m.default(o.subtract(r));this._incrementTransformPx(d.multiply(l));!this._isActive.peek()&&this._mayStartPan(this._incrementTransformPx.peek(),n-i,e)&&this._isActive(!0)};e.prototype._resetGesture=function(e){this._gesturePoints=e;var t=u.default.getCenter(e),o=this._getRadius(e,t);this._initialCenterPx(t);this._initialRadius(o)};e.prototype._getRadius=function(e,t){for(var o=0,n=0,i=e;n<i.length;n++){o+=i[n].distance(t)}return o/e.length};e.prototype._getPointsFromTouches=function(e){for(var t=[],o=0;o<e.length;o++)t.push(this._transformToElement(e[o]));return t};e.prototype._getPointsFromPointers=function(){var e=[];for(var t in this._pointers)e.push(this._pointers[t]);return e};e.prototype._updateSize=function(e){void 0===e&&(e=!0);if(!this._size||e){var t=this.element.getBoundingClientRect();this._size=new u.default(t.width,t.height);this._clientToElementTransform=new m.default(new u.default(-t.left,-t.top))}};e.prototype._transformToElement=function(e){return this._clientToElementTransform.apply(new u.default(e.clientX,e.clientY))};e.prototype._isPointerGesture=function(){return 7&this._gestureMode.peek()};return e}(n.default);t.default=r;function d(e,t,o){return e.translate.abs()>=i||Math.abs(t)>=i}function c(e){return e}function p(e,t){return e===t||!(!e||!t)&&(e.x===t.x&&e.y===t.y)}t.arePointsEqual=p;function h(e,t){return e===t||!(!e||!t)&&(p(e.translate,t.translate)&&e.scale===t.scale)}t.areTransformsEqual=h});define("odsp-next/controls/carousel/Carousel.html",[],function(){return"<div class=Carousel><div class=Carousel-platform data-bind=\"template: { foreach: slides, beforeRemove: $component.onSlideRemoved.bind($component), dontLimitMoves: true }, pan: panBindingParams, style: platformStyle, css: { 'is-flipping': isFlipping, 'is-rotating': isRotating, 'is-enabled': isEnabled, 'is-powered': isPowered, 'is-gliding': isGliding, 'is-rotating-forward': direction() > 0, 'is-rotating-backward': direction() < 0 }\"><div class=Carousel-slide data-bind=\"host: {}, attr: { 'data-item-offset': offset, 'data-item-order': order, 'data-item-direction': direction }, css: { 'is-current': item && item === $component.item(), 'is-loaded': !!loadState() }\"></div></div></div>"});define("odsp-next/controls/carousel/Carousel.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.Carousel{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.Carousel-platform{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;-ms-transform-origin:0 0;transform-origin:0 0;-ms-touch-action:none;touch-action:none}.Carousel-platform.is-enabled{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-slide{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.Carousel-slide.is-current.is-loaded{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.Carousel-slide.is-current.is-deleted,.Carousel-slide.is-deleted{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-enabled .Carousel-slide{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-platform.is-flipping .Carousel-slide{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="1"]{z-index:10}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="1"].is-current.is-loaded{transition-duration:.3s,0s,.3s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="2"]{z-index:9}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="2"].is-loaded{transition-duration:.3s,0s,.3s;transition-delay:.3s,.6s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="3"]{z-index:8}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="4"]{z-index:7}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="5"]{z-index:6}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="6"]{z-index:5}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="7"]{z-index:4}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="8"]{z-index:3}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="1"]{-ms-transform:translate(2%,0);transform:translate(2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="1"]{-ms-transform:translate(-2%,0);transform:translate(-2%,0)}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="-1"]{-ms-transform:translate(-2%,0);transform:translate(-2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="-1"]{-ms-transform:translate(2%,0);transform:translate(2%,0)}.Carousel-platform.is-rotating .Carousel-slide{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="2"]{-ms-transform:translate(204%,0);transform:translate(204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="1"]{-ms-transform:translate(102%,0);transform:translate(102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-1"]{-ms-transform:translate(-102%,0);transform:translate(-102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-2"]{-ms-transform:translate(-204%,0);transform:translate(-204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="1"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-1"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-2"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="2"]{visibility:inherit;opacity:1}.Carousel-platform.is-gliding{transition:transform .3s ease-out}.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="1"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="-1"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="-2"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="2"]{transition-delay:.3s,.3s,0s}'}])});define("odsp-next/controls/componentCarousel/ComponentCarousel",["require","exports","./ComponentCarouselViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ComponentCarousel.html","./ComponentCarousel.css"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"ms-component-carousel",template:e("./ComponentCarousel.html"),viewModel:o.default,synchronous:!0});t.default=i});define("odsp-next/controls/componentCarousel/ComponentCarouselViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/clientRect/ClientRectBinding","./ComponentCarousel.resx","../../providers/engagement/Engagement","../carouselIndicator/CarouselIndicator","office-ui-fabric-react/lib/Styling"],function(e,t,o,_,n,v,g,b,x,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w;!function(e){e[e.arrowsBottom=0]="arrowsBottom";e[e.arrowsSide=1]="arrowsSide"}(w=t.PagerMode||(t.PagerMode={}));var i=function(C){o.__extends(e,C);function e(e){var t=C.call(this,e)||this;t.carouselIndicatorTagName=x.default.tagName;var o=e.tileWidth,n=e.tileHeight,i=e.components,a=e.pageSize,s=void 0===a?0:a,r=e.parentSize,l=e.useVirtualizedList,d=void 0!==l&&l,u=e.pagerMode,m=void 0===u?w.arrowsBottom:u,c=e.useCarouselIndicator,p=void 0!==c&&c,h=e.maxNumberOfPages,f=void 0===h?-1:h;t.chevronLeftIcon=y.getIconClassName("ChevronLeft");t.chevronRightIcon=y.getIconClassName("ChevronRight");t.tileWidth=o;t.tileHeight=n;t._allComponents=i;t._customPageSize=s;t.startIndex=_.observable(0);t._parentSize=r;t.useVirtualizedList=d;t.pagerMode=m;t.useCarouselIndicator=p;t.pagerModeEnum=w;t._maxNumberOfPages=t.wrapObservable(f);t._engagement=t.resources.consume(b.resourceKey);t.addBindingHandlers({clientRect:v.default});t.resx=g.strings;t.size=_.observable({width:0,height:0});t._numVisibleTiles=t.createPureComputed(t._computeNumVisibleTiles);t.pageSize=t.createPureComputed(t._computePageSize);t.endIndex=t.createPureComputed(t._computeEndIndex);t.showNav=t.createPureComputed(t._computeShowNav);t.enableNextNav=t.createPureComputed(t._computeEnableNextNav);t.enablePrevNav=t.createPureComputed(t._enablePrevNav);t._pagedComponents=t.createPureComputed(t._computePagedComponents).extend({rateLimit:1});t.visibleComponents=t.createPureComputed(t._computeVisibleComponents).extend({rateLimit:2});t.carouselIndicatorParams={pagedComponents:t._pagedComponents,pageSize:t.pageSize,startIndex:t.startIndex,endIndex:t.endIndex};t.createBackgroundComputed(t._computeResetStartIndex);return t}e.prototype.previous=function(){var e=this._numVisibleTiles(),t=this._pagedComponents.peek().length;if(e&&e<=t){var o=this.pageSize(),n=this.startIndex()-o;n<0&&(n=0);if(this.useCarouselIndicator){var i=Math.floor(n/o);n!==i*o&&(n=(i+1)*o)}this.startIndex(n);this._engagement.logData({name:"ComponentCarousel.Previous"})}};e.prototype.next=function(){var e=this._numVisibleTiles(),t=this._pagedComponents.peek().length;if(e&&e<=t){var o=this.pageSize(),n=this.startIndex()+o;t-e<n&&(n=t-e);this.startIndex(n);this._engagement.logData({name:"ComponentCarousel.Next"})}};e.prototype._computeVisibleComponents=function(){var e=this._pagedComponents();return this.useVirtualizedList?e.slice(this.startIndex(),this.endIndex()+1):e};e.prototype._computePagedComponents=function(){var e=this._allComponents();if(this.useVirtualizedList){var t=this._maxNumberOfPages(),o=this.pageSize(),n=-1===t?Math.ceil(e.length/o):Math.min(Math.ceil(e.length/o),t);0===n&&0<e.length&&(n=1);return e.slice(0,n*o)}return e};e.prototype._computeNumVisibleTiles=function(){var e=this._parentSize&&this._parentSize()||this.size(),t=Math.floor(e.width/this.tileWidth());return Math.max(t,1)};e.prototype._computeResetStartIndex=function(){this.showNav()||this.startIndex(0)};e.prototype._enablePrevNav=function(){return 0!==this.startIndex()&&this.showNav()};e.prototype._computeEnableNextNav=function(){var e=this._pagedComponents().length;return this.endIndex()!==e-1&&this.showNav()};e.prototype._computeShowNav=function(){return this._numVisibleTiles()<this._pagedComponents().length};e.prototype._computeEndIndex=function(){var e=this._pagedComponents().length,t=this.startIndex()+this._numVisibleTiles()-1;return t=e<=t?e-1:t};e.prototype._computePageSize=function(){var e=this._customPageSize,t=this._numVisibleTiles();if(t){(!e||t<e)&&(e=t);return e}return 1};return e}(n.default);t.default=i});define("odsp-next/controls/carouselIndicator/CarouselIndicator",["require","exports","./CarouselIndicatorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CarouselIndicator.html","./CarouselIndicator.css"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-carousel-indicator",template:e("./CarouselIndicator.html"),viewModel:o.default,synchronous:!0});t.default=i});define("odsp-next/controls/carouselIndicator/CarouselIndicatorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(s){o.__extends(e,s);function e(e){var t=s.call(this,e)||this,o=e.pagedComponents,n=e.pageSize,i=e.startIndex,a=e.endIndex;t._pagedComponents=o;t._pageSize=t.wrapObservable(n);t._startIndex=i;t._endIndex=a;t.pageMarkers=t.createPureComputed(t._computePageMarkers).extend({rateLimit:3});return t}e.prototype.determinePageMarkers=function(e,t,o,n,i){for(var a=this,s=[],r=0;r<t;r++){var l=r*o,d=(l=Math.min(l,e-o))+o-1;s.push({startIndex:l,endIndex:d,isActive:l<=n&&i<=d,onClick:function(e,t){a._startIndex(e.startIndex)}})}return s};e.prototype.determinePageMarkerCount=function(e,t){return Math.ceil(e/t)};e.prototype._computePageMarkers=function(){var e=this._pagedComponents().length,t=this._pageSize(),o=this.determinePageMarkerCount(e,t),n=this._startIndex(),i=this._endIndex();return this.determinePageMarkers(e,o,t,n,i)};return e}(n.default);t.default=i});define("odsp-next/controls/carouselIndicator/CarouselIndicator.html",[],function(){return"<div class=\"od-CarouselIndicator ms-font-xxl\">\x3c!--ko foreach: pageMarkers--\x3e<button class=od-CarouselIndicator-dot data-bind=\"css: { 'od-CarouselIndicator-dot--isActive': isActive }, disable: isActive, click: onClick, attr: { 'aria-pressed': isActive }\">•</button>\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/carouselIndicator/CarouselIndicator.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-CarouselIndicator{text-align:center}[dir=ltr] .od-CarouselIndicator-dot:not(:last-child){margin-right:20px}[dir=rtl] .od-CarouselIndicator-dot:not(:last-child){margin-left:20px}.od-CarouselIndicator-dot:not(:disabled){cursor:pointer}.od-CarouselIndicator-dot{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border:none;font-size:1em;background:0 0}.od-CarouselIndicator-dot.od-CarouselIndicator-dot--isActive{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("odsp-next/controls/componentCarousel/ComponentCarousel.html",[],function(){return"<div class=od-ComponentCarousel data-bind=\"clientRect: { size: size, allowHiddenSizeUpdates: true }, css: { 'od-ComponentCarousel--arrowsBottom': pagerMode === pagerModeEnum.arrowsBottom, 'od-ComponentCarousel--arrowsSide': pagerMode === pagerModeEnum.arrowsSide }\"><div class=od-ComponentCarousel-container><div class=od-ComponentCarousel-list data-bind=\"style: { height: tileHeight() + 'px' }\">\x3c!--ko foreach: visibleComponents()--\x3e<div class=od-ComponentCarousel-iconFadeInOut data-bind=\"component: { name: name, params: params }, visible: $parent.useVirtualizedList ? true : $parent.startIndex() <= $index() && $index() <= $parent.endIndex(), style: { width: $parent.tileWidth() + 'px', height: $parent.tileHeight() + 'px' }, css: { 'od-ComponentCarousel-margin': $parent.useVirtualizedList ? $index() !== ($parent.pageSize() - 1) : $index() !== $parent.endIndex() }\"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: showNav--\x3e<div class=\"od-ComponentCarousel-nav ms-font-xxl\"><button class=\"od-ComponentCarousel-navButton od-ComponentCarousel-navButton--prev ms-Icon\" data-bind=\"class: chevronLeftIcon, disable: !enablePrevNav(), click: previous.bind($data), attr: { 'aria-label': resx.PrevAria }, css: { 'ms-fontColor-themePrimary': enablePrevNav(), 'ms-fontColor-neutralTertiary': !enablePrevNav() }\"></button> <button class=\"od-ComponentCarousel-navButton od-ComponentCarousel-navButton--next ms-Icon\" data-bind=\"class: chevronRightIcon, disable: !enableNextNav(), click: next.bind($data), attr: { 'aria-label': resx.NextAria }, css: { 'ms-fontColor-themePrimary': enableNextNav(), 'ms-fontColor-neutralTertiary': !enableNextNav() }\"></button></div>\x3c!--/ko--\x3e\x3c!--ko if: useCarouselIndicator && showNav()--\x3e\x3c!--ko component: {\r\n name: carouselIndicatorTagName,\r\n params: carouselIndicatorParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>"});define("odsp-next/controls/componentCarousel/ComponentCarousel.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ComponentCarousel-container{display:inline-block;width:100%}.od-ComponentCarousel-list{display:inline-block;overflow:hidden}@keyframes fadeAndScale{from{opacity:.55;animation-timing-function:ease-in}to{opacity:1;animation-timing-function:ease-out}}.od-ComponentCarousel-iconFadeInOut{animation:fadeAndScale .85s;position:relative;display:inline-block;vertical-align:top}.od-ComponentCarousel-nav{margin-top:8px;text-align:center}.od-ComponentCarousel-navButton{background:0 0;border:none}.od-ComponentCarousel-navButton:not(:disabled){cursor:pointer}[dir=ltr] .od-ComponentCarousel-margin{margin-right:8px}[dir=rtl] .od-ComponentCarousel-margin{margin-left:8px}.md .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-nav,.sm .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-nav{display:none}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton{position:absolute;padding:0;top:0;bottom:0;margin-top:auto;margin-bottom:auto;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";height:40px;width:32px}.xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton,.xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton,.xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton{width:36px}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton:disabled{color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{left:-32px}[dir=rtl] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{right:-32px}[dir=ltr] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=ltr] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=ltr] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{left:-36px}[dir=rtl] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=rtl] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=rtl] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{right:-36px}[dir=ltr] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{right:-32px}[dir=rtl] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{left:-32px}[dir=ltr] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=ltr] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=ltr] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{right:-36px}[dir=rtl] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=rtl] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=rtl] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{left:-36px}"}])});define("odsp-next/controls/footer/Footer",["require","exports","./FooterViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Footer.html","./Footer.css"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"ms-footer",template:e("./Footer.html"),viewModel:o.default});t.default=i});define("odsp-next/controls/footer/FooterViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,i,a,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){n.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.links=i.observableArray([]);t._dataSource=t.resources.consume(s.footer);if(t._dataSource){t.showConfidentialText=t._dataSource.showConfidentialText();t.showLanguageLink=t._dataSource.showLanguageLink()}t.createComputed(t._computeUpdateFooterLinks);return t}e.prototype._computeUpdateFooterLinks=function(){var e,o=this;if(this._dataSource){var t=this._dataSource.getFooterLinks().slice();if(this.showLanguageLink){var n=this.resources.consume(a.actionMap),i={text:this._dataSource.getLanguageText(),url:"#",onClick:function(e,t){(new(o.managed(n.LanguagePickerAction))).execute(t)},automationId:"lp"};t.push(i)}(e=this.links).splice.apply(e,[0,this.links.peek().length].concat(t))}};return e}(o.default);t.default=r});define("odsp-next/controls/footer/Footer.html",[],function(){return'\x3c!--ko if: $data.links().length--\x3e<ul class=Footer>\x3c!--ko foreach: $data.links--\x3e<li data-bind="automation: $data.automationId">\x3c!--ko if: $data.url--\x3e\x3c!--ko if: $data.encodedText--\x3e<a class=Footer-item target=_blank data-bind="html: $data.encodedText, attr: { href: $data.url }, click: $data.onClick"></a>\x3c!--/ko--\x3e\x3c!--ko if: !$data.encodedText--\x3e<a class=Footer-item target=_blank data-bind="text: $data.text, attr: { href: $data.url }, click: $data.onClick"></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !$data.url--\x3e\x3c!--ko if: $data.encodedText--\x3e<span class="Footer-item is-disabled" data-bind="html: $data.encodedText"></span>\x3c!--/ko--\x3e\x3c!--ko if: !$data.encodedText--\x3e<span class="Footer-item is-disabled" data-bind="text: $data.text"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e\x3c!--ko if: $data.showConfidentialText--\x3e<li><span class="Footer-item Footer-msconf">Microsoft Confidential</span></li>\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e'});define("odsp-next/controls/footer/Footer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".Footer{display:block;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin:0;padding:0;padding-top:8px}.Footer li{list-style-type:none;margin:0;padding:5px 10px;display:inline}.Footer-item{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-decoration:none;white-space:nowrap;display:inline-block;height:32px}a.Footer-item:focus,a.Footer-item:hover{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.Footer-msconf{font-weight:700;color:#e81123}"}])});define("odsp-next/models/command/set/UnionCommandSet",["require","exports","tslib","../../../controls/commands/BaseCommandSet"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this,o=e.commandSets,n=void 0===o?[]:o;t._commandSets=t.wrapObservable(n);t.createComputed(t._computeUpdateCommandSet);return t}e.prototype._computeUpdateCommandSet=function(){for(var e=[],t=[],o=[],n=0,i=this._commandSets();n<i.length;n++){for(var a=i[n],s=[],r=0,l=a.commands();r<l.length;r++){var d=l[r];d===a.overflowHostCommand?o.push.apply(o,d.children()):4==(4&d.location)?s.push(d):e.push(d)}t.unshift.apply(t,s)}var u,m,c=this.overflowHostCommand.children.peek();(u=this.overflowHostCommand.children).splice.apply(u,[0,c.length].concat(o));e.push(this.overflowHostCommand);e.push.apply(e,t);(m=this.commands).splice.apply(m,[0,this.commands.peek().length].concat(e))};return e}(n.default);t.default=i});