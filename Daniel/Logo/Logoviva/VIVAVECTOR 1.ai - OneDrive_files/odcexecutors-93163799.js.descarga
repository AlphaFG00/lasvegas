define("odsp-next/actions/OdcExecutors",["require","exports","./createFolder/odc/CreateFolderExecutor","./delete/odc/DeleteExecutor","./download/odc/DownloadExecutor","./download/DownloadItemsOperator","./embed/odc/EmbedExecutor","./emptyRecycleBin/odc/EmptyRecycleBinExecutor","./launchMoveCopyPanel/LaunchMoveCopyPanelExecutor","./userActivity/odc/UserActivityExecutor","./rename/odc/RenameExecutor","./setPhotosRoot/odc/SetPhotosRootExecutor","./reportAbuse/odc/ReportAbuseExecutor","./removeFromSharedList/odc/RemoveFromSharedListExecutor","./requestReview/odc/RequestReviewExecutor","./restoreAll/odc/RestoreAllExecutor","./save/SaveExecutor","./setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor","./showOperations/ShowOperationsExecutor","./showPermissions/ShowPermissionsExecutor","./showVersionHistoryAction/ShowReactVersionHistoryExecutor","./switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor","./addToAlbum/odc/AddToAlbumExecutor","./applyOfficeLens/odc/ApplyOfficeLensExecutor","./removeOfficeLens/odc/RemoveOfficeLensExecutor","./addToBundle/odc/AddToBundleExecutor","./feedback/odc/FeedbackExecutor","./createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor","./orderPrints/odc/OrderPrintsExecutor","./showKeyboardMap/ShowKeyboardMapExecutor","./redeemCode/odc/RedeemCodeExecutor","./editTags/odc/EditTagsExecutor","./shareByLink/odc/ShareByLinkExecutor","./addPhotosToAlbum/AddPhotosToAlbumExecutor","./createAlbum/CreateAlbumExecutor","./printPdf/odc/PrintPdfExecutor","./saveAutoAlbum/odc/SaveAutoAlbumExecutor","./discardAutoAlbum/odc/DiscardAutoAlbumExecutor","./moveCopy/odc/MoveCopyAction","./createNewFolder/odc/CreateNewFolderAction"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("odsp-next/actions/createFolder/odc/CreateFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../CreateFolderHelper","../../../utilities/optimizely/experiments/OfficeUpsell.key"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._item=e.item;t.name=e.actionName;t._itemReedemer=new(t.managed(r.default));t._createFolderHelper=new(t.managed(n.default));t.resources.consumeAsync(a.resourceKey).then(function(e){t._officeUpsellLogger=e});return t}e.prototype.execute=function(){var e=this;this._officeUpsellLogger&&this._officeUpsellLogger.logOptimizelyEvent("newFolder");return this._itemReedemer.redeemItem(this._item,this).then(function(){return e._createFolderHelper.showDialog(255,!1)})};return e}(i.default);t.default=s});define("odsp-next/actions/createFolder/CreateFolderHelper",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../resources/ControlResourceKeys","../../controls/folderBuilder/FolderBuilder","./CreateFolderOperator","../../controls/folderBuilder/FolderBuilder.resx","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,o,p,u,i,h,m,g,r,n,f,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dialogProvider=t.resources.consume(r.resourceKey);t._currentItem=t.resources.consume(n.currentItem);return t}e.prototype.showDialog=function(e,t){var i=this,o=this.observables.create(""),r=this.observables.create(""),n=this.observables.create(!1),a=this.observables.create(!0),s=this.observables.create(!0),l=this.observables.create([]),d=this.observables.create(""),c=this.observables.create(!0);return this._dialogProvider.requestDialog({title:g.strings.CreateFolder,component:{name:f.default.tagName,params:{name:o,automationId:"createFolderDialog",status:r,hasError:n,isEnabled:a,maxNameLength:e,hasFocus:s,supportInlineSharing:t,selectedPeople:l,sharingNote:d,statusVisible:c}},actions:[{name:g.strings.CreateCommit,execute:function(){c(!1);var e={tasks:null};v.extend(e,p);e.tasks.runEarly();r(g.strings.CreateFolderCollapsed);c(!0);a(!1);n(!1);return i.resources.consumeAsync(b.typeResourceKey).then(function(e){var t=new e({parent:i._currentItem.peek(),folderName:o(),sharingNote:d(),selectedPeople:l().filter(function(e){return e.isResolved})});return i.trackPromise(t.start())}).then(function(){n(!1);a(!0);c(!1);var e=m.format(y.strings.CreateFolderSuccess,o());r(e);c(!0);return 2},function(e){n(!0);c(!1);i.async.setTimeout(function(){n(!0);a(!0);s(!0);r(e.message);c(!0)},200);return 1})},isAvailable:this.observables.pureCompute(function(){return!!o()&&a()}),isDefault:!0,icon:new u.default("Save"),automationId:"createFolderDialogCommit"}]}).wait().then(function(){return{resultType:h.ResultTypeEnum.Success}})};return e}(i.default);t.default=a});define("odsp-next/controls/folderBuilder/FolderBuilder",["require","exports","./FolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderBuilder.html","./FolderBuilder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-folder-builder",template:e("./FolderBuilder.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/folderBuilder/FolderBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./FolderBuilder.resx","../peoplePicker/PeoplePicker","knockout"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.namePlaceholder=r.strings.FolderNamePlaceholder;t.nameLabel=r.strings.FolderNameLabel;t.addEditors=r.strings.AddEditors;t.editorsLabel=r.strings.EditorsLabel;t.editorsDescription=r.strings.EditorsDescription;t.editorsNotePlaceholder=r.strings.EditorsNotePlaceholder;t.peoplePickerTagName=n.default.tagName;t.name=e.name;t.status=e.status||a.observable("");t.hasError=e.hasError||a.observable(!1);t.isEnabled=e.isEnabled||a.observable(!0);t.hasFocus=e.hasFocus||a.observable(!0);t.maxNameLength=e.maxNameLength;t.statusVisible=e.statusVisible||a.observable(!0);t.supportInlineSharing=e.supportInlineSharing;t.sharingNote=e.sharingNote;t.selectedPeople=e.selectedPeople;t.peoplePickerParams={selectedPeople:t.selectedPeople,peoplePickerQueryParams:void 0};t.areSharingFieldsVisible=a.observable(!1);return t}e.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)};return e}(i.default);t.default=s});define("odsp-next/controls/peoplePicker/PeoplePicker",["require","exports","knockout","./PeoplePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ViewModelFactory","./PeoplePicker.html","./PeoplePicker.css","../persona/Persona.css"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:"ms-people-picker",template:e("./PeoplePicker.html"),viewModel:r.createViewModelHelper(o.default)};i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("odsp-next/controls/peoplePicker/PeoplePickerViewModel",["require","exports","tslib","../../providers/engagement/Engagement","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../autoFillPopup/AutoFill","../autoFillPopup/AutoFillItem","../../resources/ControlResourceKeys","../../providers/peoplePicker/PeoplePickerProvider","../../bindings/keyboard/KeyboardBinding","../../bindings/tooltip/TooltipBinding","./PeoplePicker.resx","../progressSpinnerFlat/ProgressSpinnerFlat","../../bindings/scrollContainer/ScrollContainerBinding","../../bindings/scrollIntoView/ScrollIntoViewBinding","../../bindings/selection/SelectionBinding","../../models/selection/SelectionModel","@ms/odsp-shared/lib/base/ViewModel","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch"],function(e,t,i,n,a,o,s,l,d,c,p,u,h,m,g,f,b,y,r,v,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(r){i.__extends(e,r);function e(o){var i=r.call(this)||this;i.resolvedItems=i.observables.createArray([]);i.inputTitle=i.createObservable(h.strings.InputHint);i.inputText=i.createObservable("");i.error=i.createObservable("");i.autoFillPopupTagName=s.default.tagName;i.progressSpinnerFlatTagName=m.default.tagName;i.autoFillParams={clickedItem:i.createObservable(null),items:i.observables.createArray([]),inDataFetch:i.createObservable(!1),resultsTrimmed:i.createObservable(!1),isOpen:i.createObservable(!1)};i._engagement=i.resources.consume(n.resourceKey);i.selectionModel=new y.default;i.addBindingHandlers({selection:b.default,keyboard:p.default,tooltip:u.default,scrollContainer:g.default,scrollIntoView:f.default});i.focusedItem=i.createObservable(null);i.scrollDown=i.createObservable(!1);i.inputChange=function(e,t){i._inputChangeOuter(t)};i.selectedDescendantId=i.createComputed(function(){if(i.focusedItem())return i.focusedItem().id});i._pageContext=i.resources.consume(a.pageContext.optional);i._autoSelectFirstSuggestionOnEnter=o.autoSelectFirstSuggestionOnEnter;var e=o.peoplePickerQueryParams,t=void 0===e?{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:null,maximumEntitySuggestions:5,principalSource:null,principalType:13,required:null,urlZone:null,urlZoneSpecified:null}:e;i._peoplePickerQueryParams=i.wrapObservable(t);i._currentSharingLink=o.currentSharingLink||i.observables.create(null);i._lastSharingLink=i._currentSharingLink();i.blockViaPolicy=i.createPureComputed(i._computeBlockViaPolicy);i._dataProvider=i.resources.consume(c.resourceKey);i._useGenericErrors=o.useGenericErrors;i.describedById=o.describedById;o.hasUnresolvedText||(o.hasUnresolvedText=i.createObservable(!1));o.hasError||(o.hasError=i.createObservable(!1));i.subscribe(i.error,function(e){o.hasError(!!e)});i._contactInviteLimit=o.contactInviteLimit;i.resolvedSize=i.createObservable(2);if(o.selectedPeople){if(0<o.selectedPeople().length){i.resolvedItems(o.selectedPeople());i._reresolveUsers()}i.createComputed(function(){o.selectedPeople(i.resolvedItems())})}o.selectedPeopleContainsExternal&&i.createComputed(function(){if(0===o.selectedPeople().length)o.selectedPeopleContainsExternal(!1);else{for(var e=o.selectedPeople.peek(),t=!1,i=0;i<e.length;i++){if(e[i].isExternal){t=!0;break}}o.selectedPeopleContainsExternal(t)}});i.deleteTitle=i.createComputed(function(){return h.strings.RemoveHelp});i._inputBoxWasEmpty=!0;i.itemClicked=i.createComputed(function(){i.autoFillParams.clickedItem()&&i._onAutoFillPicked()});i.showPlaceholder=i.createObservable(!0);i.inputPlaceholder=i.createComputed(function(){return i.inputText()&&""!==i.inputText()||0!==i.resolvedItems().length?"":h.strings.InputPlaceholderText});i.menuOpenText=i.createComputed(function(){return i.autoFillParams.isOpen()?h.strings.SuggestionTip:""});i.personAddedText=i.createObservable("");i.inputSize=i.createComputed(function(){o.hasUnresolvedText(!!i.inputText()&&0!==i.inputText().length);return i.inputText()?i.inputText().length+1:0});i.peopleSuggestions=i.observables.createArray([]);i.peopleSuggestionsTrimmed=i.createComputed(function(){return i.peopleSuggestions().slice(0,i._peoplePickerQueryParams().maximumEntitySuggestions+i._dataProvider.MaxCacheSuggestions)});i.autoFillOpen=i.createComputed(function(){return i.autoFillParams.isOpen()});i.isSelected=o.isSelected||i.createObservable(!0);i._noMatchesError=h.strings.NoMatchesFound;i._multipleMatchesError=h.strings.MultipleMatchesFound;i._noExternalSharingError=i.createComputed(i._computeExternalSharingError);i._userBlockedOnODBError=h.strings.UserBlockedOnODB;i._resolveOccurring=!1;i.resources.expose(d.autoFillParams,i.autoFillParams);i.isProgressBarShown=i.autoFillParams.inDataFetch;i.createComputed(function(){if(i._currentSharingLink()!==i._lastSharingLink){i._lastSharingLink=i._currentSharingLink.peek();i._reresolveUsers()}});return i}e.prototype.resolveUsers=function(e,t){this._resolveInput();t.preventDefault()};e.prototype.formatRemoveString=function(e){return o.format(this.deleteTitle(),e.name)};e.prototype.removeItem=function(e){this._engagement.logData({name:"RemoveUser.PeoplePicker.Click",isIntentional:!0});this.resolvedItems.remove(e);this.isSelected(!0);this._cleanErrors()};e.prototype.personaClick=function(e){var t=this._engagement;if(e.isResolved)t.logData({name:"ResolvedUser.PeoplePicker.Click",isIntentional:!0});else if(e.multipleMatches&&0<e.multipleMatches.length){t.logData({name:"UnresolvedUser.Multiple.PeoplePicker.Click",isIntentional:!0});this._resolveOccurring=!0;this._personBeingResolved=e;this._processPeopleSuggestions(e.multipleMatches,[],!0)}else{t.logData({name:"UnresolvedUser.Invalid.PeoplePicker.Click",isIntentional:!0});this.inputText(e.name);this.removeItem(e)}};e.prototype.focus=function(){this.isSelected(!0);var e=this.inputText();e&&1<e.length&&!this.autoFillParams.isOpen()&&this.autoFillParams.isOpen(!0);this.showPlaceholder()&&this.inputText&&0<e.length&&this.showPlaceholder(!1)};e.prototype.inputFocus=function(){this.showPlaceholder()&&0<this.inputText().length&&this.showPlaceholder(!1)};e.prototype.inputBlur=function(){var e=this.inputText.peek();if(this.showPlaceholder()||0!==this.resolvedItems().length||e&&0!==e.length){if(e&&1<e.length&&(!this.autoFillOpen.peek()||this.autoFillParams.items.peek().length<1)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}else if(e&&1<e.length&&(!this.autoFillOpen.peek()||1===this.autoFillParams.items.peek().length)&&this._isValidEmail(e)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}}else this.showPlaceholder(!0)};e.prototype.inputPaste=function(e,t){this._engagement.logData({name:"InputPaste.PeoplePicker",isIntentional:!0});this.async.setTimeout(function(){var e=document.getElementById("PeoplePicker-textBox");this._resolveOccurring=!0;this._resolveUser(e.value,!0);e.value=""},0);return!0};e.prototype.onEnter=function(e,t){var i=this.selectionModel.selection.peek();if(i&&1===i.length)this.autoFillParams.clickedItem(i[0]);else if(this._autoSelectFirstSuggestionOnEnter){var o=this.peopleSuggestions.peek();o&&0<o.length&&this.autoFillParams.clickedItem(o[0])}return!1};e.prototype.getTitle=function(e){return e.isResolved?e.providerName?e.email+"\n"+e.providerName:e.email:e.multipleMatches&&0<e.multipleMatches.length?this._multipleMatchesError:this._isValidEmail(e.userId)&&!this._useGenericErrors?this._noExternalSharingError.peek():this._noMatchesError};e.prototype._computeBlockViaPolicy=function(){return this._peoplePickerQueryParams().blockViaPolicy&&v.isFeatureEnabled(v.PolicyTipPanel)};e.prototype._parseUserKeyPaste=function(e){var t=e.indexOf("<"),i=e.indexOf("@",t),o=e.indexOf(">",i);return-1!==t&&-1!==i&&-1!==o?e.substring(t+1,o):e};e.prototype._replacePerson=function(e){this.resolvedItems.replace(this._personBeingResolved,e);this.isSelected(!0);this._cleanErrors()};e.prototype._cleanErrors=function(){for(var e=this.resolvedItems&&this.resolvedItems().length-1;0<=e;e--){var t=this.resolvedItems()[e];if(!t.isResolved){t.multipleMatches&&0<t.multipleMatches.length?this._setError(this._multipleMatchesError):this._isValidEmail(t.userId)&&!this._useGenericErrors?this._setError(this._noExternalSharingError.peek()):this._setError(this._noMatchesError);if(!x.default.isActivated("9b587ad5-6161-4bc7-ab29-066666d06bd3","03/20/2018","Check if user is not resolved due to tenant admin ODB policy")){var i=t.rawPersonData;i&&i.EntityData&&i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()&&this._setError(this._userBlockedOnODBError)}return}}this.error("")};e.prototype._inputChangeOuter=function(e){var t=this;this._timer&&this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};e.prototype._add=function(e){var t=this;if(this.resolvedItems().length>=this._contactInviteLimit)this._setError(o.format(h.strings.contactLimitReached,this._contactInviteLimit));else{e.name||(e.name=e.email);e.isExternal=e.entityType&&1===e.entityType;if(null!=this._peoplePickerQueryParams.peek().allowMultipleEntities&&!1===this._peoplePickerQueryParams.peek().allowMultipleEntities&&1<=this.resolvedItems().length){this.resolvedItems([e]);e.isResolved&&this._cleanErrors()}else{this.resolvedItems.push(e);if(e.isResolved){this.personAddedText(o.format(h.strings.AddedPersonHint,e.name));this.async.setTimeout(function(){t.personAddedText("")},100)}}this.async.setTimeout(function(){this.scrollDown(!0);this.scrollDown(!1)},0)}};e.prototype._inputChange=function(e){var t=e.keyCode;if(38!==t&&40!==t)if(27===t&&this.autoFillParams.isOpen()){this.autoFillParams.isOpen(!1);e.cancelBubble=!0;e.stopPropagation()}else{var i=this.inputText().length;if(0===i){if(!this._resolveOccurring){this._abortSearch(!0);this._destroyAutoFill()}if((8===t||46===t)&&this._inputBoxWasEmpty){this.resolvedItems.pop();this._cleanErrors();this._destroyAutoFill()}this._inputBoxWasEmpty=!0}else if(1===i){this._abortSearch(!0);this._destroyAutoFill();this._inputBoxWasEmpty=!1}else if(59===t||186===t){this._abortSearch(!0);this._destroyAutoFill();this._resolveInput()}else{this._inputBoxWasEmpty=!1;this._getPeopleSuggestions()}}};e.prototype._resolveInput=function(){this._resolveUser(this.inputText())};e.prototype._abortSearch=function(e){if(this.autoFillParams.inDataFetch.peek()){this._peoplePickerSearchPromise&&this._peoplePickerSearchPromise.cancel();e&&this.autoFillParams.inDataFetch(!1)}};e.prototype._getPeopleSuggestions=function(){var t=this;this._abortSearch(!1);this.autoFillParams.inDataFetch(!0);this._cleanErrors();var i=[],e=this._dataProvider.search(this.inputText.peek().trim(),this._peoplePickerQueryParams.peek());e.cached&&this._processPeopleSuggestions(e.cached,i,!1);this._peoplePickerSearchPromise=e.promise;this.isSearchDone=this._peoplePickerSearchPromise.then(function(e){if(t.autoFillParams.inDataFetch.peek()){t.autoFillParams.inDataFetch(!1);t._processPeopleSuggestions(e,i,!0)}},function(e){t.autoFillParams.inDataFetch(!1);if(!e||"Canceled"!==e.name){t._setError(h.strings.ServerError);t._destroyAutoFill()}})};e.prototype._processPeopleSuggestions=function(e,t,i){if(e&&0<e.length)for(var o=e,r=0;r<o.length;r++)t.push(new l.default(o[r],{hasSeparator:r===o.length-1}));(0<t.length||i)&&this._populateAutoFill(t)};e.prototype._reresolveUsers=function(){var e=[],t=this.resolvedItems.peek();if(0!==t.length){for(var i=0;i<t.length;i++){var o=t[i];e.push(o.email||o.name)}var r=e.join(";");this.resolvedItems([]);this._cleanErrors();this._resolveUser(r,!0)}};e.prototype._resolveUser=function(e,t){var i=this,o=e.split(";"),r=o[o.length-1];this.autoFillParams.inDataFetch(!0);for(var n=0;n<o.length;n++){var a=this._parseUserKeyPaste(o[n]);""===a||a===r&&!t||(this.isResolveDone=this._dataProvider.resolve(a,this._peoplePickerQueryParams.peek()).then(function(e){i.autoFillParams.inDataFetch(!1);i._inputBoxWasEmpty=!0;i._destroyAutoFill();i._add(e);e.isResolved||i._cleanErrors()},function(e){i.autoFillParams.inDataFetch(!1);i._setError(h.strings.ServerError)}))}t?this.inputText(""):this.inputText(r)};e.prototype._onAutoFillPicked=function(){this._abortSearch(!0);var e=this.autoFillParams.clickedItem().data();if(this._resolveOccurring){if(this._personBeingResolved){this._replacePerson(e);this._resolveOccurring=!1}}else{this.inputText("");this._inputBoxWasEmpty=!0;if(e.multipleMatches&&0<e.multipleMatches.length&&e.isResolved)for(var t=0,i=e.multipleMatches;t<i.length;t++){var o=i[t];this._add(o)}else{e.isResolved=!0;this._add(e)}}this._destroyAutoFill();this._dataProvider.addToMruCache(e);this.autoFillParams.clickedItem(null);this.peopleSuggestions([]);this.autoFillParams.items([]);this.focus()};e.prototype._destroyAutoFill=function(){this._resolveOccurring=!1;this.autoFillParams.items([]);this.autoFillParams.isOpen(!1);this.peopleSuggestions([])};e.prototype._populateAutoFill=function(e){this.autoFillParams.isOpen()||this.autoFillParams.isOpen(!0);this.peopleSuggestions(e);this.autoFillParams.items(this.peopleSuggestionsTrimmed());this.autoFillParams.resultsTrimmed(this.peopleSuggestionsTrimmed().length>=this._peoplePickerQueryParams.peek().maximumEntitySuggestions)};e.prototype._setError=function(e){var t=this;this.async.setTimeout(function(){t.error(e)},50)};e.prototype._computeExternalSharingError=function(){var e=this._currentSharingLink();return this._pageContext&&!this._pageContext.isSPO?h.strings.NoExternalSharingOnPrem:e&&9===e.type?h.strings.NoExternalSharingCsl:h.strings.NoExternalSharingCloud};e.prototype._isValidEmail=function(e){return/\S+@\S+\.\S+/.test(e)};return e}(r.default);t.default=_});define("odsp-next/controls/autoFillPopup/AutoFill",["require","exports","./AutoFillViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AutoFillPopup.html","./AutoFill.css","../persona/Persona"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-auto-fill",template:e("./AutoFillPopup.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/autoFillPopup/AutoFillViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","knockout","./AutoFill.resx","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/dismiss/DismissBinding","../../bindings/scrollIntoView/ScrollIntoViewBinding","../../bindings/scrollContainer/ScrollContainerBinding","../../bindings/uniqueId/UniqueIdBinding"],function(e,t,i,o,r,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.addBindingHandlers({dismiss:d.default,scrollContainer:p.default,scrollIntoView:c.default,uniqueId:u.default});e.params=e.resources.consume(r.autoFillParams);e.menuLabel=a.strings.SuggestedPeopleMenu;e._isOpenObservable=e.params.isOpen||n.observable(!1);if(!e.params){e.params.clickedItem=n.observable(null);e.params.items=n.observableArray([]);e.params.inDataFetch=n.observable(!1);e.params.resultsTrimmed=n.observable(!1)}e.summaryText=e.createComputed(function(){return e.params.resultsTrimmed()?l.format(a.strings.ResultsCapped,e.params.items().length):0===e.params.items().length?a.strings.NoResults:""});e.isOpen=e.createComputed(function(){return e._isOpenObservable()});e.summaryVisible=e.createComputed(function(){return 0<e.summaryText().length});return e}e.prototype.onItemClicked=function(e){this.resources.consume(s.resourceKey).logData({name:"SuggestedUser.AutoFill.PeoplePicker.Click",isIntentional:!0});this.params.clickedItem(e)};e.prototype.closeMenu=function(){this._isOpenObservable(!1)};return e}(o.default);t.default=h});define("odsp-next/bindings/scrollIntoView/ScrollIntoViewBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout","../scrollContainer/ScrollContainerBinding"],function(e,t,i,o,h,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(e){var c=t.call(this,e)||this,p=n.getScrollContainer(c.element),u=c.element;c.createBackgroundComputed(function(){var e=h.unwrap(c.valueAccessor());if(e.isSelected()){var t=e.top,i=e.containerToTop,o=e.smooth,r=p.scrollTop,n=r+p.offsetHeight,a=p.scrollHeight-p.clientHeight,s=u.offsetTop,l=s+u.offsetHeight,d=r;i?d=0:s<r||t?d=s:n<l&&(d=l-p.offsetHeight);if((d=Math.min(d,a))===r)return;o?c.smoothScroll(p,d,r):p.scrollTop=d}});return c}e.prototype.smoothScroll=function(e,t,i,o){var r=this;void 0===o&&(o=0);if(!(100<o)){var n=1*o/100,a=0;a=n<=.5?2*n*n:1-2*(n=1-n)*n;e.scrollTop=i+a*(t-i);this.async.setTimeout(function(){r.smoothScroll(e,t,i,o+1)},5)}};return e}(o.default);t.default=r;t.viewElementInScrollContainer=function(e,t){var i=e.offsetParent;if(i){for(var o=n.getScrollContainer(e),r=e.offsetTop+e.clientTop;o!==i;){r+=i.offsetTop;if(!(i=i.offsetParent))return}i.scrollTop=r+t}}});define("odsp-next/bindings/uniqueId/UniqueIdBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function r(){}r.init=function(e,t){var i=n.utils.unwrapObservable(t());if(i.data){var o=i.idPrefix+ ++r.counter;i.data.id=o;e.id=o}};r.counter=0;return r}();t.default=i});define("odsp-next/controls/autoFillPopup/AutoFillPopup.html",[],function(){return"<div class=AutoFill role=menu data-bind=\"scrollContainer: {}, attr: {'aria-label': menuLabel }, dismiss: isOpen() && closeMenu\">\x3c!--ko foreach: params.items--\x3e<div class=AutoFill-item role=menuitem data-bind=\"uniqueId: {data: $data, idPrefix: 'AFPU'}, click: $parent.onItemClicked.bind($parent), css: {'AutoFill-focused': $data.focused, 'AutoFill-separator': $data.hasSeparator }, scrollIntoView: { isSelected: $data.focused}\"><a class=AutoFill-link href=javascript:><div data-bind=\"component: { name: 'od-persona', params: { person: data(), size: 'small'} }\"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if:summaryVisible--\x3e<div class=AutoFill-trimmed data-bind=\"text: summaryText\"></div>\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/autoFillPopup/AutoFill.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".AutoFill{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;position:absolute;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";max-height:300px;min-width:300px;max-width:400px;z-index:401}.AutoFill-item{box-sizing:border-box;overflow:hidden;width:100%;line-height:0}.AutoFill-item.AutoFill-focused{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";outline:1px solid transparent}.AutoFill-item:not(.AutoFill-focused):hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.AutoFill-item.AutoFill-separator{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.AutoFill-link{text-decoration:none;display:inline-block;width:100%}.AutoFill-link,.AutoFill-trimmed{padding:5px 5px 5px 20px;font-size:14px;font-weight:400}html[dir=rtl] .AutoFill-link,html[dir=rtl] .AutoFill-trimmed{padding:5px 20px 5px 5px}"}])});define("odsp-next/controls/persona/Persona",["require","exports","./PersonaViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Persona.html","./Persona.css","../presence/Presence","../personaImage/PersonaImage"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-persona",template:e("./Persona.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/persona/PersonaViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../commands/CommandViewModel","../../bindings/contextMenu/ContextMenuBinding","../../bindings/contextMenu/ContextMenuHelper","../../providers/engagement/Engagement","../loadingSpinner/LoadingSpinner","knockout","./Persona.resx","../../actions/UpdatePermissionsAction","../../bindings/tooltip/TooltipBinding","../../utilities/features/Features","../personaImage/PersonaImage","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding","../../bindings/element/ElementBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/dateTime/DateTime"],function(e,t,o,i,n,r,a,s,l,d,c,p,u,h,m,g,f,b,y,v,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(i){o.__extends(e,i);function e(e){var o=i.call(this,e)||this;o.loadingSpinnerTagName=l.default.tagName;o.personaImageTagName=m.default.tagName;o.addBindingHandlers({tooltip:u.default,keyboard:b.default,element:y.default});o.updateSharingRole=function(e){if(5===e.sharingInfo.role)o._removePerson(o.person());else{var t=o.person();t.sharingInfo=e.sharingInfo;o.person(t);o.updatingPermissions(!1)}};o._item=e.item;o.openContextMenu=e.openContextMenu||o.observables.create(!1);o.inputEvent=e.inputEvent||o.observables.create(null);o.sharingRoleElement=o.createObservable();o.disableTab=o.createObservable(e.disableTab);o.showEmail=h.isFeatureEnabled(h.ShowEmailInPeoplePicker);o.person=d.isObservable(e.person)?e.person:d.observable(e.person);o.updatingPermissions=d.observable(!1);o.nameEmail=o.person().email?v.format(c.strings.NameAndEmail,o.person().name,o.person().email):o.person().name;o._removePerson=e.removePerson||function(e){};o.showName=void 0===e.showName||!!e.showName;o.showProfileLink=!!e.profileLinkOn;o.showPresence=!!e.showPresence;o._includeComma=!!e.includeComma;o._sharingRoleMenuRootElementClass=e.sharingRoleMenuRootElementClass||"od-Dialog-main";o._urlDataSource=o.resources.consume(g.url);e.personaSize?o.personaSize=d.isObservable(e.personaSize)?e.personaSize:d.observable(e.personaSize):o.personaSize=d.observable(3);o.personaImageParams={person:o.person,disablePictrueAlt:e.disablePictrueAlt,iconType:e.iconType};o.createComputed(function(){if(o.openContextMenu()&&o.canChangePermissions()&&o.canManagePermissions()){var e=o._createContextMenuCommands(),t=o._createContextMenuHelper(e),i=o.inputEvent.peek();r.default.createContextMenu(i,t,o);13===i.keyCode&&i.preventDefault();o.openContextMenu(!1)}});o.personaClass=o.createComputed(function(){var e=void 0===o.person().isResolved||o.person().isResolved?"":"od-Persona-unresolved ";o._includeComma&&(e+="od-Persona--comma ");e+="od-Persona";switch(o.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";default:return e}});o.hasSharingInfo=o.createComputed(function(){return!!o.person().sharingInfo});var t=o.resources.isExposed(f.viewParams)?o.resources.consume(f.viewParams):null;o.personIsCurrentUser=o.createPureComputed(function(){return t&&o.person().userId&&o._urlDataSource.getOwnerId("",t()).toLowerCase()===o.person().userId.toLowerCase()},{deferEvaluation:!0});o.canChangePermissions=o.createPureComputed(function(){return!!o.person().sharingInfo&&0!==o.person().sharingInfo.role&&!o.personIsCurrentUser()});o.canManagePermissions=o.createObservable(e.canManagePermissions);o.presenceVisible=o.createComputed(function(){return o.showPresence&&!!o.person().sip});o.tooltip=o.person().email;o.updatingText=c.strings.UpdatingText;o.person().providerName&&(o.tooltip+="\n"+o.person().providerName);return o}e.prototype.getSharingRole=function(e){if(e&&this._item){var t=e.expiration?x.getShortDisplayDate(new Date(e.expiration)):null;switch(e.role){case 1:return t?v.format(c.strings.ViewExpiration,t):c.strings.View;case 2:return t?v.format(c.strings.EditExpiration,t):c.strings.Edit;case 6:return c.strings.Review;case 4:return c.strings.CoOwner;case 0:return c.strings.Owner;case 7:return e.customRole}}return""};e.prototype.onSharingRoleClick=function(e,t){this.resources.consume(s.resourceKey).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var i=this._createContextMenuCommands(),o=this._createContextMenuHelper(i,t);r.default.createContextMenu(t,o,this);return i};e.prototype._createContextMenuCommands=function(){var e,t=[],i="";if(h.isFeatureEnabled(h.ReviewPermissionUI)&&this._item.appMap&&"ms-word"===this._item.appMap){var o,r="";if(1===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2;r=c.strings.ReviewOnly;o=6}else if(6===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2;r=c.strings.ViewOnly;o=1}else if(2===this.person().sharingInfo.role){i=c.strings.ReviewOnly;e=6;r=c.strings.ViewOnly;o=1}t[0]=new n.default({text:i,isToggleable:!1,action:new(this.managed(p.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new n.default({text:r,isToggleable:!1,action:new(this.managed(p.default))({person:this.person(),role:o,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[2]=new n.default({text:c.strings.StopSharing,isToggleable:!1,action:new(this.managed(p.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else{if(1===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2}else{i=c.strings.ViewOnly;e=1}t[0]=new n.default({text:i,isToggleable:!1,action:new(this.managed(p.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new n.default({text:c.strings.StopSharing,isToggleable:!1,action:new(this.managed(p.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}return t};e.prototype._createContextMenuHelper=function(e,t){return new a.default({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})};return e}(i.default);t.default=_});define("odsp-next/actions/UpdatePermissionsAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/sharing/SharingProvider.key"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="UpdatePermissions";t._item=e.item;t._person=e.person;t._role=e.role;t._isExecuting=e.isExecuting;t._callback=e.callback;t._expiration=e.expiration;return t}e.prototype.onExecute=function(e,t){var i=this;this._isExecuting&&this._isExecuting(!0);return this.resources.consumeAsync(n.resourceKey).then(function(e){return e.updatePermissions([i._person],i._item,i._role,i._expiration)}).then(function(e){i._callback(e.people[0]);i._isExecuting(!1);return{resultType:r.ResultTypeEnum.Success}},function(e){i._isExecuting(!1);return{resultType:r.ResultTypeEnum.Failure}})};return e}(i.default);t.default=a});define("odsp-next/providers/sharing/SharingProvider.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/AsyncResources"],function(i,e,t,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=o.createResolvedAliasResourceKey(i("module").id,"./SharingProvider",function(){return new t.default(function(e,t){i(["./SharingProvider"],e,t)})})});define("@ms/odsp-utilities/lib/resources/AsyncResources",["require","exports","../modules/Modules","./Resources"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return e.resourceKey}t.getResourceKeyExport=n;t.createDefaultAliasResourceKey=function(e,t){return new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return o.loadModuleExport({require:e,path:t,getExport:n})})})};t.createResolvedAliasResourceKey=function(e,t,i){return new r.ResourceKey({name:e,loader:new r.AliasResourceLoader(function(){return o.loadModuleExport({path:t,getExport:n,getModule:i})})})}});define("odsp-next/controls/personaImage/PersonaImage",["require","exports","./PersonaImageViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PersonaImage.html","./PersonaImage.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-persona-image",template:e("./PersonaImage.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/personaImage/PersonaImageViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../persona/Persona.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/imageLoader/ImageLoaderBinding"],function(e,t,o,r,i,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.isImageLoaded=r.observable(!1);t.addBindingHandlers({imageLoader:s.default});t.person=r.isObservable(e.person)?e.person:r.observable(e.person);t.disablePictrueAlt=e.disablePictrueAlt;t.pictureAlt=t.createComputed(t._computePictureAlt);t._iconType=e.iconType;return t}e.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}};e.prototype._computePictureAlt=function(){var e=a.format(n.strings.PictureAlt,r.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e};return e}(i.default);t.default=l});define("odsp-next/controls/personaImage/PersonaImage.html",[],function(){return"<div class=\"od-Persona-image ms-Icon\" data-bind=\"icon: true, class: 'ms-Icon--' + getIconType(person().sharingInfo), css: { 'od-Persona-image--isLoaded': isImageLoaded }\">\x3c!--ko if: person().image--\x3e<img data-bind=\"imageLoader: { src: person().image, isLoaded: isImageLoaded, scenarioName: 'personaImage' }, attr: { alt: pictureAlt }\">\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/personaImage/PersonaImage.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Persona-image{display:inline-block;width:50px;height:50px;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font-size:21px;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:50px}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}"}])});define("odsp-next/controls/persona/Persona.html",[],function(){return'<div data-bind="tooltip:{ content: nameEmail, \'aria-label\': person().name}, css: personaClass"><div class=od-Persona-imageArea><div class=od-Persona-imageCircle>\x3c!--ko component: {\r\n name: personaImageTagName,\r\n params: personaImageParams\r\n }--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: presenceVisible--\x3e\x3c!--ko component: {\r\n name: \'ms-presence\',\r\n params: { sip: person().sip }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-Persona-details>\x3c!--ko if: showProfileLink--\x3e\x3c!--ko if: person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target=_blank data-bind="attr: {href: person().profilePage}, text: person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text: person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !showProfileLink && showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text: person().name"></div>\x3c!--/ko--\x3e<div class=od-Persona-secondaryText data-bind="visible: !!person().job, text: person().job"></div><div class=od-Persona-tertiaryText data-bind="visible: !!person().department, text: person().department"></div><div class=od-Persona-optionalText data-bind="visible: !!person().office, text: person().office"></div><div class=od-Persona-emailText data-bind="visible: showEmail, text: person().email"></div>\x3c!--ko if: canChangePermissions() && canManagePermissions()--\x3e<div class=od-Persona-sharingContainer data-bind="visible: !updatingPermissions() && getSharingRole(person().sharingInfo) && personaSize() > 3"><button class=od-Persona-sharingRole aria-haspopup=true data-bind="click: onSharingRoleClick, keyboard: { Space: onSharingRoleClick }, attr: { \'aria-label\': getSharingRole(person().sharingInfo), tabindex: !disableTab ?" 0" : "-1" }, element: sharingroleelement "><div class=od-Persona-sharingRole-Text><span data-bind="text: getSharingRole(person().sharingInfo)"></span> <span class=od-Persona-sharingRole-Chevron data-bind="visible: !personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i></span></div></button></div>\x3c!--ko if: updatingPermissions()--\x3e<div class=od-Persona-sharingSpinner data-bind="component: {name: loadingSpinnerTagName, params : {loadingText: updatingText} }, visible: updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: hasSharingInfo && (!canChangePermissions() || !canManagePermissions())--\x3e<div class=od-Persona-sharingRole-Text data-bind="text: getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/persona/Persona.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:48px;height:48px;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:8px}.od-Persona .od-Persona-imageCircle{width:48px;height:48px;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';position:absolute;font-size:47px;top:7px}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:48px;height:48px;line-height:48px}.od-Persona .od-Persona-image[src=""]{display:none}.od-Persona .od-Persona-presence{position:absolute;height:12px;width:12px;border-radius:50%;top:auto;bottom:-6px;border:2px solid '},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona .od-Persona-presence{left:-2px}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:4px}.od-Persona .od-persona-link{display:inline-block;padding-bottom:3px}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:400;font-size:17px;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:3px}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:400;font-size:12px;padding-bottom:3px;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:2px 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;background:0 0;border:none;padding:0}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:2px}.od-Persona.od-Persona--mini{width:24px;height:24px;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:24px;height:24px;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:14px;margin-top:0;line-height:14px;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:15px}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:15px}.od-Persona.od-Persona--tiny .od-Persona-presence{height:10px;width:10px;top:10px;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:400;font-size:12px;padding-top:2px}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:','}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:32px;height:32px}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:8px}.od-Persona.od-Persona--xs .od-Persona-image{line-height:32px}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:28px;top:4px}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:4px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:4px}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:14px;padding-top:3px}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:40px;height:40px}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:4px}.od-Persona.od-Persona--sm .od-Persona-image{line-height:40px}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:38px;top:5px}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-1px;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-1px}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:14px;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:5px}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:72px;height:72px}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:78px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:12px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:12px}.od-Persona.od-Persona--lg .od-Persona-image{line-height:72px;font-size:28px}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:6px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:10px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:10px}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:68px;top:10px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-5px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-5px}.od-Persona.od-Persona--lg .od-Persona-presence{height:20px;width:20px;bottom:4px;border-width:3px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-2px}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-weight:400;line-height:12px}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:12px;margin-top:8px;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:100px;height:100px}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:20px}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:20px}.od-Persona.od-Persona--xl .od-Persona-image{line-height:100px;font-size:28px}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:95px;top:12px}.od-Persona.od-Persona--xl .od-Persona-presence{height:28px;width:28px;border-width:4px}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:21px;font-weight:300;margin-top:2px}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:7px}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:8px;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("odsp-next/controls/presence/Presence",["require","exports","./PresenceViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Presence.html","./Presence.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-presence",template:e("./Presence.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/presence/PresenceViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../../providers/peoplePicker/PeoplePickerProvider","./Presence.resx","office-ui-fabric-react/lib/Styling"],function(e,t,o,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){o.__extends(e,i);function e(e){var t=i.call(this)||this;t.strings=a.strings;t.sip=r.isObservable(e.sip)?e.sip:r.observable(e.sip||"");t.presenceType=r.observable(0);t._dataProvider=t.resources.consume(n.resourceKey);t.registerPresence(t.sip());t.isVisible=!!t._presenceDisposable;t._sipSubscriptionOld=t.sip.subscribe(function(e){t.unRegisterPresence(e)},t,"beforeChange");t._sipSubscriptionNew=t.sip.subscribe(function(e){t.registerPresence(e)},t);t.presenceClass=t.createComputed(t._computePresenceClass);t.presenceTypeText=t.createComputed(t._computePresenceTypeText);return t}e.prototype.dispose=function(){i.prototype.dispose.call(this);this.unRegisterPresence(this.sip());this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose();this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()};e.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))};e.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()};e.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)};e.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e};e.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online "+s.getIconClassName("SkypeCheck");break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb "+s.getIconClassName("SkypeMinus");break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away "+s.getIconClassName("SkypeClock");break;case 6:e="ms-Presence--Offline";break;case 7:case 0:e="ms-Presence--Hidden";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e};return e}(i.default);t.default=l});define("odsp-next/providers/peoplePicker/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../models/store/PeopleStore","../../utilities/features/Features"],function(e,t,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var i=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;i&&(this._mruCache=new a.default);this.MaxCacheSuggestions=i?5:0}e.prototype.search=function(e,o){var r,n,a=this,t={cached:null,promise:null};!this._mruCache||o.groupID||s.isFeatureEnabled(s.PeoplePickerGraph)&&o.useGraph||0<(n=this.searchMruCache(e,o&&o.filterExternalUsers)).length&&(t.cached=n);t.promise=new i.default(function(i,t){r=a._dataSource.search(e,o).then(function(e){if(e)if(n){0<n.length&&(n=a._removeStaleCacheResults(n,e));var t=n.map(function(e){return e.userId});i(e.filter(function(e){return t.indexOf(e.userId)<0}))}else i(e)},function(e){t(e)})},function(){r&&r.cancel()});return t};e.prototype.resolve=function(e,t){var i=this;return this._dataSource.resolve(e,t).then(function(e){i._mruCache&&e.isResolved&&i.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.searchMruCache=function(e,t){var i=[],o=this._mruCache;if(o){i=o.getItems(e,t);var r=this.MaxCacheSuggestions;i.length>r&&(i=i.splice(0,r))}return i};e.prototype._removeStaleCacheResults=function(o,e){var r=o.map(function(e){return e.userId}),n=[];e.forEach(function(e){var t=r.indexOf(e.userId);if(-1<t){var i=o[t];a.default.isCacheEntryFresh(i,e)&&n.push(i)}});return n};return e}();t.default=n;t.resourceKey=o.createResolvedResourceKey(e("module").id,n,{dataSource:r.people})});define("odsp-next/models/store/PeopleStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(r,o);function r(){var e=o.call(this,r._Key,r._DataStoreCachingType)||this;e._MaxItems=200;e._Version=7;var t=window._sharingContextInfo;t&&(r._StorageKey=""+r._StorageKey+t.webAbsoluteUrl);e._buffer=e.getValue(r._StorageKey);e._buffer&&e._buffer.version===e._Version||e.initializeBuffer();e._data={};for(var i=0;i<e._buffer.dataArray.length;i++)e._data[e._buffer.dataArray[i].email]=e._buffer.dataArray[i];return e}r.clear=function(){new n.default(r._Key,r._DataStoreCachingType).remove(r._StorageKey)};r.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};r.prototype.setItem=function(e){var t=this._data[e.email];if(t){if(r.isCacheEntryFresh(t,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var o=this._buffer.dataArray[this._buffer.index];delete this._data[o.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(r._StorageKey,this._buffer)};r.prototype.getItems=function(e,t){for(var i=[],o=0;o<this._buffer.dataArray.length;o++){var r=(this._buffer.index-o+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[r].email&&0<=this._buffer.dataArray[r].email.toLowerCase().indexOf(e.toLowerCase())||this._buffer.dataArray[r].name&&0<=this._buffer.dataArray[r].name.toLowerCase().indexOf(e.toLowerCase()))||t&&1===this._buffer.dataArray[r].entityType||i.push(this._buffer.dataArray[r])}return i};r.prototype.containsItem=function(e){return!!this._data[e.email]};r.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};r._Key="ClientPeoplePicker";r._StorageKey="MRU";r._DataStoreCachingType=a.default.local;return r}(n.default);t.default=o});define("odsp-next/controls/presence/Presence.html",[],function(){return"<a data-bind=\"css: presenceClass, visible: isVisible, attr: {title: presenceTypeText, 'aria-label': presenceTypeText}\" class=od-Persona-presence></a>"});define("odsp-next/controls/presence/Presence.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Presence{display:inline-block;width:12px;height:12px;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1AEBFF}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006E}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";line-height:12px;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px #1AEBFF inset;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px #37006E inset;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:20px;height:20px;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:20px;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:28px;height:28px;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:28px;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";content:'';border-radius:50%}"}])});define("odsp-next/controls/autoFillPopup/AutoFillItem",["require","exports","knockout"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){this.selected=i.observable(!1);this.focused=i.observable(!1);this.hasSeparator=i.observable(!1);this.data=i.observable();t&&i.utils.extend(this,t);this.data(e);this.id=""};t.default=o});define("@ms/odsp-shared/lib/utilities/knockout/ViewModelFactory",["require","exports","knockout","./ResourceComponentLoader"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(n){return function(i,e){var o=new(i.resources.injected(n))(i),t=a.computed(function(){if(i.model){var e=a.utils.unwrapObservable(i.model);for(var t in e)e.hasOwnProperty(t)&&o[t]&&(a.isObservable(o[t])?o[t](a.utils.unwrapObservable(e[t])):o[t]=a.utils.unwrapObservable(e[t]))}},o),r=o.dispose;o.dispose=function(){r&&r.call(o);t.dispose()};return o}}t.createViewModelFactory=i;t.createViewModelHelper=function(e){return{createViewModel:i(e)}}});define("odsp-next/controls/peoplePicker/PeoplePicker.html",[],function(){return'<div class=PeoplePicker id=PeoplePicker data-bind="scrollContainer: {}, click: function() {focus()}, tooltip: { content: inputTitle }, css: {\'is-active\': isSelected}"><div class=PeoplePicker-container>\x3c!--ko foreach: resolvedItems--\x3e<div class=PeoplePicker-resolvedItem data-bind="css: { \'PeoplePicker-resolvedItem-unresolved\': !$data.isResolved || ($parent.blockViaPolicy && $parent.blockViaPolicy() && $data.isExternal) }"><a class=PeoplePicker-resolvedItem-name href=javascript; data-bind="attr: { \'aria-describedby\': $parent.describedById }, tooltip: { content: $parent.getTitle($data) }, click: $parent.personaClick.bind($parent), keyboard: { Enter: $parent.personaClick.bind($parent) }"><div class=PeoplePicker-resolvedItem-persona data-bind="component: { name: \'od-persona\', params: { person: $data, personaSize: $parent.resolvedSize } }"></div></a> <button class=PeoplePicker-removeItem data-bind="tooltip: { content: $parent.formatRemoveString($data) }, attr: { \'aria-label\': $parent.formatRemoveString($data) }, click: $parent.removeItem.bind($parent), keyboard: { Enter: $parent.removeItem.bind($parent)}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e<input class="PeoplePicker-textBox od-TextField-field" id=PeoplePicker-textBox type=email autocomplete=off autocapitalize=off autocorrect=off aria-haspopup=true aria-owns=PeoplePicker-autoFill data-bind="value: inputText, valueUpdate: \'keyup\', attr:{ \'aria-busy\': autoFillParams.inDataFetch(), size: inputSize, \'aria-activedescendant\': selectedDescendantId(), \'aria-expanded\': autoFillOpen().toString(), \'aria-describedby\': describedById, placeholder: inputPlaceholder }, event:{keyup: inputChange, focus: inputFocus, blur: inputBlur, paste: inputPaste}, hasFocus: isSelected, selection: { data: peopleSuggestionsTrimmed, focused: focusedItem, mode: \'single\', direction: \'vertical\', selectionModel: selectionModel, allowInputEvents: true }, keyboard: { mappings: { Enter: onEnter, \'CtrlK\': resolveUsers }, context: $data, allowInputEvents: true }"> <span class=ms-accessible role=status aria-live=polite data-bind="text: menuOpenText"></span> <span class=ms-accessible role=status aria-live=polite data-bind="text: personAddedText"></span></div><div class=PeoplePicker-progressBoxContainer data-bind="scrollIntoView: { isSelected: scrollDown }"><div class=PeoplePicker-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: autoFillParams.inDataFetch()"></div></div></div>\x3c!--ko if:autoFillOpen()--\x3e<div id=PeoplePicker-autoFill data-bind="component: {name: autoFillPopupTagName }"></div>\x3c!--/ko--\x3e<div aria-live=assertive role=status class=PeoplePicker-error data-bind="text: error"></div>'});define("odsp-next/controls/peoplePicker/PeoplePicker.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".PeoplePicker{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:78px;position:relative}.PeoplePicker .od-Persona.od-Persona--xs{height:24px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-details{width:auto;margin-top:2px;height:24px;margin-top:0}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-image,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageArea,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageCircle{width:20px;height:20px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-primaryText{padding-top:0;line-height:24px;max-width:250px}.PeoplePicker-container{display:inline-block;width:100%}.PeoplePicker-ghostText{position:absolute;top:5px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";white-space:nowrap}[dir=ltr] .PeoplePicker-ghostText{left:5px}[dir=rtl] .PeoplePicker-ghostText{right:5px}.PeoplePicker-progressBoxContainer{width:100%}.PeoplePicker-progressBoxContainer .PeoplePicker-progressBox{margin-top:-6px}.PeoplePicker-resolvedItem{margin:2px;white-space:nowrap;display:inline-block;font-size:12px;background-color:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";border:1px solid "},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";height:24px}html[dir=ltr] .PeoplePicker-resolvedItem{float:left}html[dir=rtl] .PeoplePicker-resolvedItem{float:right}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved{background-color:transparent;border-color:#e81123}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-removeItem:hover,.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-resolvedItem-name:hover{background-color:#fde7e9}.PeoplePicker-resolvedItem .od-Persona .od-Persona-image{line-height:20px;font-size:14px}.PeoplePicker-resolvedItem-name{display:inline-block;overflow:hidden;height:24px}.PeoplePicker-resolvedItem-name:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-resolvedItem-persona{display:inline-block}.sm .PeoplePicker-resolvedItem-persona .od-Persona-details{max-width:85px}.PeoplePicker-resolvedItem-image{max-height:20px;max-width:20px;display:inline-block;vertical-align:top}[dir=ltr] .PeoplePicker-resolvedItem-image{padding-right:5px}[dir=rtl] .PeoplePicker-resolvedItem-image{padding-left:5px}.PeoplePicker-resolvedItem-txt{display:inline-block}.PeoplePicker-textBox.od-TextField-field{border:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";width:100%}.PeoplePicker-textBox{vertical-align:inherit;background-color:transparent;vertical-align:top;outline:0}html[dir=ltr] .PeoplePicker-textBox{float:left}html[dir=rtl] .PeoplePicker-textBox{float:right}.PeoplePicker-textBox::-ms-clear{display:none}.PeoplePicker-textBox:focus{outline-color:transparent}.PeoplePicker-removeItem{width:24px;font-size:10px;vertical-align:top;line-height:24px;height:24px;background:0 0;border:none}.PeoplePicker-removeItem:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-error{color:#a80000}"}])});define("odsp-next/controls/folderBuilder/FolderBuilder.html",[],function(){return'<div class=od-FolderBuilder><div class=od-TextField><input class="od-FolderBuilder-nameInput od-TextField-field" type=text data-bind="value: name, textInput: name, hasFocus: hasFocus, attr: { placeholder: namePlaceholder, maxlength: maxNameLength, \'aria-invalid\': hasError, \'aria-label\': nameLabel }, automation: automationId, css: { \'od-FolderBuilder-nameInput--error\': hasError }, enable: isEnabled">\x3c!--ko if: supportInlineSharing--\x3e<button class="od-FolderBuilder-addEditorsButton od-Button" data-bind="visible: !areSharingFieldsVisible(), click: onAddEditorsClicked, text: addEditors"></button><div class=od-FolderBuilder-sharingFields data-bind="visible: areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel ms-Label" data-bind="text: editorsLabel"></label><div class=od-FolderBuilder-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div><div><textarea class=od-FolderBuilder-noteInput data-bind="value: sharingNote, attr: { placeholder: editorsNotePlaceholder, maxlength: 4000 }">\r\n                </textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text: editorsDescription"></div>\x3c!--/ko--\x3e</div><div class=od-FolderBuilder-status role=alert aria-live=polite aria-relevant=text data-bind="visible: statusVisible, text: status, css: { \'od-FolderBuilder-status--error\': hasError }"></div></div>'});define("odsp-next/controls/folderBuilder/FolderBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderBuilder-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FolderBuilder-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";word-wrap:break-word}.od-FolderBuilder-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-addEditorsButton.od-Button{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .od-Persona-emailText{display:none}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}"}])});define("odsp-next/actions/createFolder/CreateFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._context=e;i._fileSystemProvider=t.fileSystemProvider;i._payloads={createFolder:{parent:e.parent,createdFolder:i.createObservable(null)}};return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input,o=this._context.parent;t.type=a.default.createFolder;t.name=i;t.iconName=o.iconName;t.payloads=this._payloads;t.visibility=2;e.output&&this._payloads.createFolder.createdFolder(e.output);return t};e.prototype.onStart=function(e){return this._fileSystemProvider.createFolder(this._context,e)};e.dependencies=i.__assign({},o.default.dependencies,{fileSystemProvider:n.resourceKey});return e}(o.default);t.default=s;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/providers/fileSystem/FileSystemProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/item/DeletionType","../../dataSources/item/ItemTaskObserver","../../models/store/ItemsStore","../item/ItemProvider","../quota/UserStateProvider.key","../../models/task/Task","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,i,o,n,s,r,a,l,d,u,c,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota}e.prototype.createFolder=function(e,t){var i=this,o=e.parent.key,r=e.folderName,n=new u.default(o+"&cf="+r,r);return this._performOperation([o],t,n,function(){return i._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var i=this,o=e.item,r=o.key,n=new u.default(r,o);return this._performOperation([e.parentKey,r],t,n,function(){return i._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(r){var n=this,a=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(r).then(function(e){var t;r.deletionType===s.default.Recycle&&(t={triggerFetch:!1,emptyAllOtherSets:!0});a.invalidateItem(r.parentKey,t);var i=r.items.map(function(e){return new u.default(e.key).succeed({item:{key:e.key,parentKey:h.remove()}})}),o=n._itemTaskObserver;o.update(i);o.flush();return e})};e.prototype._handleRestore=function(t){var i=this;return this._deleteRestoreDataSource.restoreItems(t).then(function(e){i._itemProvider.invalidateItem(t.parentKey,{emptyAllOtherSets:!0});return e})};e.prototype._handleDeleteOrRestore=function(s,l,e){var r=this,d={},c=s.items.map(function(e){return d[e.id]=new u.default(e.key,e)}),p=this._itemProvider;l.update(c);return e.call(this,s).then(function(e){for(var t=0,i=s.items;t<i.length;t++){var o=i[t];r._invalidatePhoto(o)}r._store.invalidateAllPhotos();r._invalidateAllTags();c=c.map(function(e){return e.succeed()});l.update(c)},function(e){p.invalidateItem(s.parentKey);var t=e.data&&e.data.items||[];c=[];for(var i=0,o=t;i<o.length;i++){var r=o[i],n=d[r.id];delete d[r.id];c.push(r.error?n.fail(r.error):n.succeed())}for(var a in d){n=d[a];c.push(n.cancel())}l.update(c)}).then(function(){r._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=n.deserializeQuery(e.key);delete t.qt;this._store.invalidateItem(n.serializeQuery(t));if(e.tags)for(var i=0,o=e.tags;i<o.length;i++){var r=o[i];this._store.invalidateLocation(r.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var i=e.getAllPhotosSettings().peek();t.invalidateAllTags(i.rootId)}};e.prototype._performOperation=function(r,n,a,e){var s=this;n.update([a]);return e().then(function(e){for(var t=0,i=r;t<i.length;t++){var o=i[t];s._itemProvider.invalidateItem(o)}n.update([a.succeed(e)])},function(e){var t=new Error(e);n.update([a.fail(t)]);return i.default.wrapError(t)})};e.dependencies={itemDataSource:c.items,deleteRestoreDataSource:c.deleteRestore,itemProvider:l.resourceKey,itemsStore:a.resourceKey,itemTaskObserverType:r.resourceKey,photoProvider:p.photo.optional,tagProvider:p.tag.optional,updateQuota:d.resourceKey};return e}();t.default=m;t.resourceKey=o.createResolvedResourceKey(e("module").id,m)});define("odsp-next/actions/delete/odc/DeleteExecutor",["require","exports","tslib","../../base/ItemRedeemer","../../../dataSources/item/DeletionType","../DeleteExecutor","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/DataSourceResourceKeys"],function(e,t,o,r,n,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._itemReedemer=new(t.managed(r.default));t._urlDataSource=t.resources.consume(l.url);return t}e.prototype.getDeleteExecutionInfo=function(e){var t,i,o=this.currentItem.queryType,r=n.default.Recycle;if(this._urlDataSource.isRecycleBin(o)){r=n.default.PermanantDelete;t=this._getRecycleBinDialogText(e);i=a.strings.recycleBinDeleteConfirmTitle}else if(0!==e[0].sharingRole)if(1===e.length){t=a.strings.deleteSharedSingleItem;i=a.strings.deleteSharedSingleItemPromptTitle}else{t=a.strings.deleteSharedMultipleItems;i=a.strings.deleteSharedMultipleItemPromptTitle}return{text:t,title:i,type:r,allowUndo:!0,emptyRecycleBin:!1}};e.prototype.executeDelete=function(e){var t=this;return this._itemReedemer.redeemItems(e,this).then(function(){return i.prototype.executeDelete.call(t,e)})};e.prototype._getRecycleBinDialogText=function(e){return 1===e.length?s.format(a.strings.recycleBinDeleteConfirmTextSingleSelection,e[0].name):a.strings.recycleBinDeleteConfirmTextMultiSelection};return e}(i.default);t.default=d});define("odsp-next/actions/delete/DeleteExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","../../utilities/optimizely/ExperimentsCommon.key","../../utilities/features/Features","./DeleteItemsOperator"],function(e,t,o,r,n,i,a,s,l,d,c,p,u,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.selectionHelper=e.selectionHelper;t.currentItem=e.currentItem;t.dialogProvider=t.resources.consume(c.resourceKey);return t}e.prototype.execute=function(e){var t=this;if(!this.currentItem)return r.default.wrap(this._getFailedQosData());h.isOneDrive&&this.trackPromise(this.resources.consumeAsync(u.resourceKey).then(function(e){e.fireEditEvent();e.fireDeleteEvent()}));return this.selectionHelper.resolveSelection().then(function(e){return e?t.executeDelete(e):t._getFailedQosData()})};e.prototype.getDeleteExecutionInfo=function(e){return null};e.prototype.executeDelete=function(e){var t=this,i=this.getDeleteExecutionInfo(e);return(i.title?this._getConfirmationDialog(i):r.default.wrap()).then(function(){return t._executeDelete(e,i)})};e.prototype._getFailedQosData=function(){return{resultType:l.ResultTypeEnum.Failure,extraMetrics:{count:0}}};e.prototype._executeDelete=function(i,o){var r=this;this.selectionHelper.clearSelection();return this.resources.consumeAsync(m.typeResourceKey).then(function(e){var t=new e({items:i,deletionType:o.type,allowUndo:o.allowUndo,emptyRecycleBin:o.emptyRecycleBin,parentKey:r.currentItem.key});r.trackPromise(t.start());return t.wait()}).then(function(){var e={deletionType:s.default[o.type]},t={count:i.length};if(1===i.length){e.fileType=a.default[i[0].type];e.extension=i[0].extension||""}return{resultType:l.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})};e.prototype._getConfirmationDialog=function(e){return this.dialogProvider.requestDialog({title:e.title,component:{name:p.default.tagName,params:{text:e.text}},actions:[{name:d.strings.DeleteItem,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new n.default("Delete"),isDefault:!1},{name:d.strings.cancelActionText,execute:function(){return r.default.wrap(3)},isAvailable:this.observables.create(!0),icon:new n.default("Cancel"),isDefault:!0}],focusOnPrimaryAction:!0}).wait()};return e}(i.default);t.default=g});define("odsp-next/actions/delete/DeleteItemsOperator",["require","exports","tslib","../../models/task/Task","../../models/task/TaskObserver","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/fileSystem/FileSystemProvider","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,{},t)||this;i._fileSystemProvider=t.fileSystemProvider;i._context=e;i.registerActions({undo:i._onUndo,deleteLocked:i._onDeleteLocked});return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input.item;t.name=i.name;t.iconName=i.iconName;t.type=2===e.input.type?a.default.restoreItems:a.default.deleteItems;t.payloads.deleteItems={item:i,parent:i.parent};t.payloads.restoreItems={item:i};this._context.allowUndo&&this._canUndoItem(i)&&0===e.input.type&&1===e.status&&t.actions.push(this._onUndo);2===e.status&&e.error&&9001===e.error.code&&t.actions.push(this._onDeleteLocked);return t};e.prototype.onStart=function(e){var t=this._context.deletionType===l.default.PermanantDelete?1:0,i=this._context.overrideLock,o=this._context.items.map(function(e){return new r.default(e.key,{item:e,type:t,isOverride:i})});e.update(o);return this._fileSystemProvider.deleteItems({items:this._context.items,deletionType:this._context.deletionType,overrideLock:i,parentKey:this._context.parentKey,emptyRecycleBin:this._context.emptyRecycleBin},p(e,t,i))};e.prototype._canUndoItem=function(e){return!e.isAlbum};e.prototype._onDeleteLocked=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:e.type,isOverride:!0}})});t.update(e);var i=e[0].input,o=i.type,r=i.isOverride;return this._fileSystemProvider.deleteItems({items:e.map(function(e){return e.input.item}),deletionType:this._context.deletionType,overrideLock:!0,parentKey:this._context.parentKey},p(t,o,r))};e.prototype._onUndo=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:2,isOverride:!1}})});t.update(e);var i=e[0].input,o=i.type,r=i.isOverride;return this._fileSystemProvider.restoreItems({items:e.map(function(e){return e.input.item}),parentKey:this._context.parentKey,retainAcls:!0},p(t,o,r))};e.dependencies=i.__assign({},n.default.dependencies,{fileSystemProvider:s.resourceKey});return e}(n.default);t.default=c;function p(e,t,i){return o.default.map(e,function(e){return e.changeInput(function(e){return{item:e,type:t,isOverride:i}})})}t.typeResourceKey=d.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/actions/download/odc/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../DownloadExecutor","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer","../../../utilities/features/Features","../../../actions/odc/DownloadAction.resx","../../../resources/ODCResourceKeys","../../../models/item/ItemType","@ms/odsp-utilities/lib/object/ObjectUtil","../../../controls/downloadAsZip/DownloadAsZip"],function(e,t,i,n,o,a,s,h,l,r,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=window.FilesConfig&&window.FilesConfig.df?"s":"p",d=function(u){i.__extends(e,u);function e(e){var t=u.call(this,e)||this;t._urlDataSource=t.resources.consume(r.urlDataSource);return t}e.prototype.execute=function(d,c){var p=this;return this.selectionHelper.resolveSelection().then(function(e){if(e){var o=p._urlDataSource.getAuthKeyParamValue(),t=1<e.length||e[0].type===m.default.Folder;c.data.extraData||(c.data.extraData={});if(t&&h.isFeatureEnabled(h.DownloadAsZip)){var r="",n=0,a=0,i=e.filter(function(e){return e}).map(function(e){if(e){var t=e.type===m.default.Folder;t&&a++;e.type===m.default.OneNote&&n++;var i=p._getDownloadUrl(e,t,o);r+=i;return{name:e.name+e.extension,size:e.size,docId:i,isFolder:t}}});g.extend(c.data.extraData,{oneNotesCount:n,filesCount:e.length-a,foldersCount:a});if(!i)return;var s="https://southcentralus1-media"+f+".svc.ms​​​/transform/zip?cs=V2VifE9EQw==";return u.prototype.executeVroomDownload.call(p,i,r,s,"url","POST",c)}if(t||!h.isFeatureEnabled(h.VroomSingleFileDownload))return u.prototype.execute.call(p,d,c);var l=p._getDownloadUrl(e[0],!1,o);return u.prototype.executeVroomDownload.call(p,null,l,l,"","Get",c)}})};e.prototype.onPreDownloadItems=function(e){if(1===e.length&&e[0].type!==m.default.Folder)return n.default.wrap(!0);for(var t=107374182400,i=0,o=0,r=e.length;o<r&&i<t;o++)e[o]&&(i+=e[o].size);if(t<=i){this.resources.consume(a.resourceKey).requestDialog({title:l.strings.NewSizeLimitError,component:{name:s.default.tagName,params:{text:""}}});return n.default.wrap(!1)}return n.default.wrap(!0)};e.prototype._getDownloadUrl=function(e,t,i){var o=this._urlDataSource.getApiBaseUrl(),r=o+"/drive/items",n=o+"/shares",a="";if(FilesConfig.SuiteNavConfig&&FilesConfig.SuiteNavConfig.IsAuthenticated&&!i)a=r+"/"+e.id;else{var s="https://onedrive.live.com/redir?resid="+e.id;s+=i?"&authKey="+i:"";a=n+"/u!"+(a=window.btoa(s).replace("=","").replace("+","-").replace("/","_"))+"/root"}return a+(t?"":"/content")};return e}(o.default);t.default=d});define("odsp-next/actions/download/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/dialog/DialogProvider","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../providers/hiddenDom/HiddenDomProvider","../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/optimizely/ExperimentsCommon.key","../../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/guid/Guid","../../providers/pushChannel/PushChannelProvider.key","../../providers/oAuthToken/OAuthTokenProvider","../../dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key"],function(i,b,e,n,t,a,y,o,s,r,d,c,p,u,v,l,h,x,_,m,g){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var S="od-download-tab";b.downloadItemsOperatorTypeResourceKey=new h.ResourceKey({name:""+i("module").id,loader:new h.AliasResourceLoader(function(){return l.loadModuleExport({path:"./DownloadItemsOperator",getModule:function(){return new n.default(function(e,t){i(["./DownloadItemsOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var f=function(i){e.__extends(l,i);function l(e){var t=i.call(this,e)||this;t._sessionManagementProvider=t.resources.consume(c.resourceKey.optional);t._platform=t.resources.consume(r.platformDetection);t._oAuthTokenProvider=t.resources.consume(m.resourceKey.optional);t._navigation=t.resources.consume(p.navigation);t._hiddenDomProvider=t.resources.consume(d.resourceKey);t.selectionHelper=e.selectionHelper;t.currentItem=e.currentItem;t.dialogProvider=t.resources.consume(o.resourceKey);return t}l.prototype.execute=function(e,t){var i,o=this,r=this.selectionHelper.selection;i={items:r.peek().map(function(e){return e.peek()})};v.isOneDrive&&this.trackPromise(this.resources.consumeAsync(u.resourceKey).then(function(e){var t=i.items&&0<i.items.length&&i.items[0];e.fireDownloadEvent(t)}));return this.onPreDownloadItems(i.items).then(function(e){return e?o.resources.consumeAsync(s.download).then(function(e){return e.downloadItems(i).then(function(){var e={},t={count:i.items.length};if(1===i.items.length){e.fileType=a.default[i.items[0].type];e.extension=i.items[0].extension||""}return{resultType:y.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})}):n.default.wrap({resultType:y.ResultTypeEnum.ExpectedFailure})})};l.prototype.executeVroomDownload=function(t,i,o,r,e,n){var a=this;void 0===e&&(e="");if(!(l.doc_ids===i&&Date.now()-l.last_download<5e3)){l.last_download=Date.now();l.doc_ids=i;var s=function(){return a._doDownload(t,i,o,r,null)};if(t&&-1!==t[0].docId.indexOf("access_token")||"spo"===r&&this._oAuthTokenProvider)try{return this.resources.consumeAsync(g.resourceKey).then(function(e){return e.getMicroServiceEndPoints("media")}).then(function(e){return a._oAuthTokenProvider.getToken(e,!0)}).then(function(e){return a._doDownload(t,i,o,r,null,e)},s)}catch(e){return s()}return this._sessionManagementProvider.getToken().then(function(e){return a._doDownload(t,i,o,r,e)},function(e){if(e.message&&0===e.message.indexOf("Cannot request a token for an unauthenticated user."))return s()})}};l.prototype.onPreDownloadItems=function(e){return n.default.wrap(!0)};l.prototype._doDownload=function(e,t,i,o,r,n){return e?this._completeDownloadasZip(e,i,o,r,n):this._completeDownloadFile(i,r)};l.prototype._completeDownloadFile=function(e,t){e+=t?"?access_token="+t.accessToken:"";if(this._platform.isMobile){this._navigation.navigateTo({url:e,frameId:"_self"});return n.default.wrap({resultType:y.ResultTypeEnum.Success})}if(this._platform.isIE){this._downloadForIE(S,e);return n.default.wrap({resultType:y.ResultTypeEnum.Success})}var i=Math.random(),o=this._getDownloadIframe(i);document.body.appendChild(o);o.src=e;this.async.setTimeout(function(){o.remove()},2e4);return n.default.wrap({resultType:y.ResultTypeEnum.Success})};l.prototype._completeDownloadasZip=function(d,c,p,u,h){var m=this;l.zip_count++;var g=x.default.generate(),f="OneDrive_"+l.zip_count+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";d&&1===d.length&&(f=d[0].name+".zip");return this.resources.consumeAsync(_.resourceKey.optional).then(function(e){var t,i=e&&e.getNotificationUrl()||"";i&&v.isFeatureEnabled(v.DownloadNotifications)&&m.resources.consumeAsync(b.downloadItemsOperatorTypeResourceKey).then(function(e){var t=new e({items:[],guid:g,zipFileName:f});m.trackPromise(t.start());t.wait()});var o=2e4;if(m._platform.isIE){t=m._downloadForIE(S);o=5e3}var r=Math.random(),n=m._getDownloadIframe(r),a=m._hiddenDomProvider.requestControl({name:"od-downloadaszip",params:{filesValue:JSON.stringify({items:d}),notificationUrlValue:i,guid:g,formAction:c,providerValue:p,id:r,zipFileName:f,target:m._platform.isIE?S:n.id,oAuthToken:h,accessToken:u&&u.accessToken||"",resources:m.resources}}),s=document.getElementById("form_download_as_zip"+r);s.parentNode.appendChild(n);s.submit();var l=m.addDisposable({dispose:function(){m._hiddenDomProvider.disposeControl(a)}});m.async.setTimeout(function(){l.dispose();t&&t.close()},o);return{resultType:y.ResultTypeEnum.Success}})};l.prototype._getDownloadIframe=function(e){var t=document.createElement("iframe");t.id="od-download-iframe"+e;t.name=t.id;t.hidden=!0;return t};l.prototype._downloadForIE=function(e,t){void 0===t&&(t="");var i;i=window.open(t,e);this.async.setTimeout(function(){i.close()},5e3);return i};l.zip_count=0;return l}(t.default);b.default=f});define("odsp-next/providers/oAuthToken/OAuthTokenProvider",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","whatwg-fetch"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(s,t);t.oAuthTokenDataSourceKey=new r.ResourceKey({name:e("module").id+".dataSource",factory:{dependencies:{pageContext:o.pageContext},create:function(e){var t=new a.default(e.pageContext);return{instance:t,disposable:t}}}});t.resourceKey=r.createResolvedResourceKey(e("module").id,n.default,{oAuthTokenDataSource:t.oAuthTokenDataSourceKey})});define("@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event","whatwg-fetch"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(i=t.TokenFetchServerErrorCodes||(t.TokenFetchServerErrorCodes={}))[i.InteractionRequired=10013]="InteractionRequired";var r=function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var i=new o.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){i.end({resultType:o.ResultTypeEnum.Success});return e},function(){i.end({resultType:o.ResultTypeEnum.Failure})})};return e}();t.default=r});define("whatwg-fetch",["require","exports","module"],function(e,t,i){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,i="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{new Blob;return!0}catch(e){return!1}}(),o="FormData"in e,r="ArrayBuffer"in e;if(r)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&-1<n.indexOf(Object.prototype.toString.call(e))};m.prototype.append=function(e,t){e=p(e);t=u(t);var i=this.map[e];this.map[e]=i?i+","+t:t};m.prototype.delete=function(e){delete this.map[p(e)]};m.prototype.get=function(e){e=p(e);return this.has(e)?this.map[e]:null};m.prototype.has=function(e){return this.map.hasOwnProperty(p(e))};m.prototype.set=function(e,t){this.map[p(e)]=u(t)};m.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)};m.prototype.keys=function(){var i=[];this.forEach(function(e,t){i.push(t)});return h(i)};m.prototype.values=function(){var t=[];this.forEach(function(e){t.push(e)});return h(t)};m.prototype.entries=function(){var i=[];this.forEach(function(e,t){i.push([t,e])});return h(i)};i&&(m.prototype[Symbol.iterator]=m.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];x.prototype.clone=function(){return new x(this,{body:this._bodyInit})};v.call(x.prototype);v.call(S.prototype);S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})};S.error=function(){var e=new S(null,{status:0,statusText:""});e.type="error";return e};var c=[301,302,303,307,308];S.redirect=function(e,t){if(-1===c.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})};e.Headers=m;e.Request=x;e.Response=S;e.fetch=function(r,n){return new Promise(function(i,e){var t=new x(r,n),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:function(e){var r=new m;e.split(/\r?\n/).forEach(function(e){var t=e.split(":"),i=t.shift().trim();if(i){var o=t.join(":").trim();r.append(i,o)}});return r}(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;i(new S(t,e))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(t.method,t.url,!0);"include"===t.credentials&&(o.withCredentials=!0);"responseType"in o&&a&&(o.responseType="blob");t.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===t._bodyInit?null:t._bodyInit)})};e.fetch.polyfill=!0}function p(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){"string"!=typeof e&&(e=String(e));return e}function h(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};i&&(e[Symbol.iterator]=function(){return e});return e}function m(t){this.map={};t instanceof m?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(i){return new Promise(function(e,t){i.onload=function(){e(i.result)};i.onerror=function(){t(i.error)}})}function b(e){var t=new FileReader,i=f(t);t.readAsArrayBuffer(e);return i}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function v(){this.bodyUsed=!1;this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(o&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(r&&a&&s(e)){this._bodyArrayBuffer=y(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!r||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(a){this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}}this.text=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,i=f(t);t.readAsText(e);return i}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=String.fromCharCode(t[o]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};o&&(this.formData=function(){return this.text().then(_)});this.json=function(){return this.text().then(JSON.parse)};return this}function x(e,t){var i,o,r=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new m(e.headers));this.method=e.method;this.mode=e.mode;if(!r&&null!=e._bodyInit){r=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new m(t.headers));this.method=(i=t.method||this.method||"GET",o=i.toUpperCase(),-1<d.indexOf(o)?o:i);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function _(e){var r=new FormData;e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),i=t.shift().replace(/\+/g," "),o=t.join("=").replace(/\+/g," ");r.append(decodeURIComponent(i),decodeURIComponent(o))}});return r}function S(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=200<=this.status&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new m(t.headers);this.url=t.url||"";this._initBody(e)}}("undefined"!=typeof self?self:this)});define("@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource",["require","exports","tslib","@ms/sp-client-shared/lib/tokenUtility/OAuthUtility","../base/DataSource","@ms/odsp-utilities/lib/async/Promise","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this._qos=new s.default({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:s.ResultTypeEnum.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:s.ResultTypeEnum.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:s.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})};return e}(),d=function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e}(),c=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,{},{pageContext:e})||this;i.logger=new d;if(t){t.logger&&(i.logger=t.logger);t.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=t.useAbsoluteUrlForOAuth)}i._oAuthUtility=new r.default(i);return i}e.prototype.qosMonitor=function(){return new l};Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:a.getSafeWebServerRelativeUrl(this._pageContext)},enumerable:!0,configurable:!0});e.prototype.fetchWithDigest=function(i){var o=this;return i.text().then(function(e){var t=i.headers.get("Content-Type");i.headers.delete("Content-Type");return o._odspPromiseToEs6Promise(o.getData(function(){return i.url},function(e){return e},"DelegationTokenDataSource",function(){return e},"POST",o._getHeadersDictionary(i),t).then(function(e){return new Response(e,{status:200})},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};e.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};e.prototype._getHeadersDictionary=function(e){var t=e.headers,i={};t.forEach(function(e,t){i[t]=e});return i};e.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,i){e.then(function(e){t(e)},function(e){i(e)})})};e.prototype._es6PromiseToOdspPromise=function(e){return new n.default(function(t,i){e.then(function(e){t(e)},function(e){i(e)})})};return e}(o.default);t.default=c});define("@ms/sp-client-shared/lib/tokenUtility/OAuthUtility",["require","exports","./Constants","./OAuthUtilityError"],function(e,t,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function d(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()}}d._getCorrelationId=function(e){return e.headers.get("sprequestguid")};d._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};d.prototype.getOAuthToken=function(t,e){var i=this;this._receiveMediaServiceFlushedToken();var o=this._getCachedTokenData(t);return o&&!this._isExpiring(o)?Promise.resolve({token:o.accessToken,isGuest:!1}):this._retriableFetchWithDigest(t,n.default.retries,e).then(function(e){i._storeTokenData(t,e);return{token:e.accessToken,isGuest:!1}})};d.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var i=this._resourceKeys.indexOf(t);!isNaN(i)&&-1<i&&this._resourceKeys.splice(i)};Object.defineProperty(d.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});d.prototype._retriableFetchWithDigest=function(r,n,a){var s=this,l=this._context.qosMonitor();return this._context.fetchWithDigest(this._buildTokenRequest(r,a)).then(function(e){if(200!==e.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+e.statusText);var t=new c.default(c.OAuthUtilityErrorType.unknownError,{httpResponseStatus:e.status,message:e.statusText,correlationId:d._getCorrelationId(e)});if(400!==e.status){l.writeUnexpectedFailure("UnknownError",t);return Promise.reject(t)}return e.json().then(function(e){var t=d._extractRealError(e),i=s._getErrorCodeFromResponseCode(t);if(!s._isRetriableError(i)||0===n){var o=s._buildErrorFromResponse(t);l.writeUnexpectedFailure("SharepointServerError",o);return Promise.reject(o)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(r,n-1,a)})}return s._instrumentedParseResponseData(e,l)})};d.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};d.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};d.prototype._getCacheKey=function(e){var t=["sp-client-shared",n.default.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};d.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<n.default.aboutToExpireIntervalSeconds};d.prototype._isRetriableError=function(e){return-1!==n.default.retriableErrorCodes.indexOf(e)};d.prototype._buildTokenRequest=function(e,t){var i=new Headers;i.append("Content-Type","application/json; charset=utf-8");i.append("Odata-Version","4.0");i.append("Accept","application/json;odata.metadata=minimal");var o={method:"POST",headers:i,body:JSON.stringify(this._buildRequestBody(e))},r=t;r&&r.lastIndexOf("/")===r.length-1&&(r=r.substr(0,r.length-1));return new Request(r+n.default.apiUrl,o)};d.prototype._buildRequestBody=function(e){return{resource:e}};d.prototype._buildErrorFromResponse=function(e){var t,i,o=this._getErrorCodeFromResponseCode(e);if(void 0===o)return new c.default(c.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:400,message:n.default.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;i=e.message.lang}var r="error.redirectUrl";return new c.default(c.OAuthUtilityErrorType.serverError,{httpResponseStatus:400,message:t,cultureName:i,serverErrorCode:o,correlationId:e.correlationId,redirectUrl:e[r]||e["@"+r]})};d.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,i=Number(t);if(isNaN(i)&&"string"==typeof e.message){var o=t.indexOf(",");-1!==o&&(i=Number(t.substr(0,o)))}return i};d.prototype._instrumentedParseResponseData=function(t,i){try{return t.json().then(function(e){i.writeSuccess();return{accessToken:e.access_token,expiresOn:Number(e.expires_on),notBefore:Number(e.not_before),resource:e.resource,tokenType:e.token_type}})}catch(e){i.writeUnexpectedFailure("ResponseParseError",e);return Promise.reject(new c.default(c.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:200,message:n.default.unexpectedTokenMessageFormat,correlationId:d._getCorrelationId(t)}))}};d.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,i=this._resourceKeys;t<i.length;t++){var o=i[t];window.sessionStorage.removeItem(o)}};d.prototype._receiveMediaServiceFlushedToken=function(){var e="_spMSBT";if(window[e]){var t={tokenType:window[e].TokenType,expiresOn:window[e].ExpiresOn,notBefore:void 0,resource:window[e].Resource,accessToken:window[e].AccessToken};this._storeTokenData(t.resource,t);window[e]=void 0}};return d}();t.default=i});define("@ms/sp-client-shared/lib/tokenUtility/Constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e}();t.default=i});var __extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();define("@ms/sp-client-shared/lib/tokenUtility/OAuthUtilityError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"}(i=t.OAuthUtilityErrorType||(t.OAuthUtilityErrorType={}));var o=function(o){__extends(r,o);function r(e,t){var i=o.call(this,t.message)||this;i.__proto__=r.prototype;i._type=e;i._httpResponseStatus=t.httpResponseStatus;i._cultureName=t.cultureName;i._message=t.message;i._serverErrorCode=t.serverErrorCode;i._correlationId=t.correlationId;i._redirectUrl=t.redirectUrl;return i}Object.defineProperty(r.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"serverErrorCode",{get:function(){if(this.type!==i.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return r}(Error);t.default=o});define("@ms/odsp-datasources/lib/dataSources/base/DataSource",["require","exports","tslib","./DataRequestor"],function(e,t,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this._pageContext=t.pageContext,o=t.dataRequestorType,r=void 0===o?function(t){s.__extends(e,t);function e(e){return t.call(this,e,{pageContext:i})||this}return e}(l.default):o,n=e.dataSourceName,a=void 0===n?"DataSource":n;this.dataSourceName=a;this.dataRequestor=new r({qosName:a})}e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,i,o,r,n,a,s,l,d,c,p){void 0===r&&(r="POST");var u=e();return this.dataRequestor.getData({url:u,parseResponse:t,qosName:i,qosHandler:c,customQosLogger:p,additionalPostData:o&&o(),method:r,additionalHeaders:n,contentType:a,maxRetries:s,noRedirect:l,crossSiteCollectionCall:d,needsRequestDigest:this.needsRequestDigest(u)})};return e}();t.DataSource=i;t.default=i});define("@ms/odsp-datasources/lib/dataSources/base/DataRequestor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/async/Retry","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger","./ServerConnection","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,A,F,i,R,O,N,B,H,V){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function c(e,t){this._pageContext=t?t.pageContext:e.pageContext;this._qosName=e.qosName;this._async=new i.default(this)}c.parseJSON=function(e){return e&&JSON.parse(e)||void 0};c.prototype.getData=function(e){var p=this,g=e.url,t=e.parseResponse,f=void 0===t?c.parseJSON:t,b=e.qosName,y=e.qosExtraData,v=e.qosHandler,u=e.customQosLogger,i=e.additionalPostData,x=void 0===i?"":i,_=e.additionalHeaders,S=e.contentType,o=e.method,k=void 0===o?"POST":o,r=e.maxRetries,P=void 0===r?0:r,n=e.crossSiteCollectionCall,h=void 0!==n&&n,a=e.noRedirect,w=void 0!==a&&a,s=e.needsRequestDigest,C=void 0===s||s,I=e.responseType,T=e.onUploadProgress,D=e.timeout,l=e.authToken,d=e.noTimeoutInLastRetry,L=void 0!==d&&d;P=Math.max(P,0);var E=0,M=this._pageContext;return F.default.resolve(l||M&&(M.getAuthToken&&M.getAuthToken()||M.authToken)).then(function(i){if(i){var e="Bearer "+i;if(_){var t=!1;for(var o in _)o&&"authorization"===o.toLowerCase()&&(t=!0);t||(_.Authorization=e)}else _={Authorization:e};w=!(C=!(h=!0))}var l=new H.default(A.__assign({},M?{webServerRelativeUrl:M.webServerRelativeUrl,webAbsoluteUrl:h?M.webAbsoluteUrl:void 0,formDigest:{updateFormDigestPageLoaded:M.updateFormDigestPageLoaded,formDigestValue:M.formDigestValue,formDigestTimeoutSeconds:M.formDigestTimeoutSeconds}}:{},{needsRequestDigest:C})),r=[];p._qosName&&r.push(p._qosName);b&&r.push(b);b=r.join(".");var n,m=function(e){u&&u(e)},a=function(s,u){var e,t,h;e=function(e){var t,i=new O.default({name:b}),o=e.getResponseText(),r=A.__assign({},y||{},{CorrelationId:e.getCorrelationId(),HttpStatus:e.getStatus()}),n=!1;try{t=p._isBlobResponse(I,o)?o:f(o);n=!0;var a={resultType:O.ResultTypeEnum.Success,extraData:r};i.end(a);m(a)}catch(e){a={resultType:O.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:r};i.end(a);m(a);u()}if(n){i=new O.default({name:b+"Complete"});try{s(t);a={resultType:O.ResultTypeEnum.Success,extraData:r};i.end(a);m(a)}catch(e){a={resultType:O.ResultTypeEnum.Failure,error:"object"==typeof e?JSON.stringify(e):e,extraData:r};i.end(a);m(a)}}l=void 0};t=function(e){var a=new O.default({name:b}),s=y||{};if(e){var l=e.getCorrelationId(),d=e.getGroupThrottle(),c=e.getStatus();s=A.__assign({},s,{CorrelationId:l,HttpStatus:c,GroupThrottle:d});var p=O.ResultTypeEnum.Failure;if(403===c||404===c||429===c){P=0;p=O.ResultTypeEnum.ExpectedFailure}var t=function(e){var t=void 0;if("object"==typeof e&&"number"==typeof e.status)t=e;else if("string"==typeof e){var i=void 0;try{i=JSON.parse(e)}catch(e){}i&&(t=i.error||i["odata.error"]||{responseData:i})}(t=t||{}).status=c;l&&(t.correlationId=l);d&&(t.groupThrottle=d);var o=c.toString();if(v){o=v(t);if(500===c&&("DefaultDoclibNotFound"===o||"PrefetchWebMismatch"===o)){P=0;p=O.ResultTypeEnum.ExpectedFailure}}var r=JSON.stringify(t),n={resultType:p,error:r,resultCode:o,extraData:s};a.end(n);m(n);if(E<P){++E;h()}else u(t)},i=e.getResponseType();i&&"text"!==i?e.parseError().then(t):t(e.getResponseText())}else{var o=void 0;if(n)o={resultType:O.ResultTypeEnum.ExpectedFailure,resultCode:"RequestAborted",extraData:s};else{o={resultType:O.ResultTypeEnum.ExpectedFailure,resultCode:"Unknown",extraData:s};u({status:0,code:""})}a.end(o);m(o)}};(h=function(){l.getServerDataFromUrl({url:g,successCallback:e,failureCallback:t,uploadProgressCallback:T,additionalPostData:x,method:k,additionalHeaders:_,contentType:S,withCredentials:!i&&void 0,noRedirect:w,responseType:I,needsRequestDigest:C})})()},s=function(){n=!0;if(l){l.abort();P<=E&&l.dispose()}},d=B.default.getRUMOneLogger(),c=Date.now();d&&(Boolean(d.readTempData("appDataFetchStart"))||d.saveTempData("appDataFetchStart",c));return N.default.instrumentPromise({url:g,name:b+".Promise"},function(){var e=function(){var e=new F.default(a,s);return D&&(!L||E<P)?F.default.timeout(D,e):e};return(E<P?R.default({retries:P,callback:e,canRetry:function(e){return!0},async:p._async,delay:0,adjustRetries:function(e){return P-E},beforeRetry:function(){E++}}):e()).then(function(e){l&&l.dispose();return e},function(e){l&&l.dispose();return F.default.reject(e)})},void 0,function(e){return e instanceof Error&&F.default.isCanceled(e)?{error:e.message,resultCode:"Canceled",resultType:O.ResultTypeEnum.ExpectedFailure}:e&&403===e.status?{error:JSON.stringify(e),resultCode:"AccessDenied",resultType:O.ResultTypeEnum.ExpectedFailure}:A.__assign({},(t=e,V.Killswitch.isActivated("78C04DFD-1688-4679-A984-ED60A4341F51","4/10/2018","Include error data in QoS failures.")?{resultCode:"",error:""+t}:t instanceof Error?{resultCode:"",error:t.toString()}:(i=t)&&"object"==typeof i&&"code"in i?{resultCode:"string"==typeof t.code?t.code:""+t.status,error:JSON.stringify(t)}:{error:t,resultCode:""}),{resultType:O.ResultTypeEnum.Failure});var t,i})})};c.prototype._isBlobResponse=function(e,t){return"blob"===e&&t&&"object"==typeof t};return c}();t.DataRequestor=o;t.default=o});define("@ms/odsp-utilities/lib/async/Retry",["require","exports","./Signal"],function(e,t,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,i=e.adjustRetries,o=e.async,r=e.beforeRetry,n=e.callback,a=e.canRetry,s=void 0===a?function(){return!0}:a,l=e.delay,d=e.resetAttemptsOnRestart,c=e.retries,p=e.shouldRestart,u=0,h=new b.default(function(){t.cancel()});function m(e){if(p&&p()){d&&(u=0);f()}else h.complete(e)}function g(e){i&&(c=i(e));if(u<c&&s(e)){u++;r&&r();"number"==typeof l&&o?o.setTimeout(f,l):f()}else h.error(e)}function f(){(t=n()).then(m,g)}f();return h.getPromise()}});define("@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger",["require","exports","../../async/Async","./PageTransitionType","../events/RUMOneDataUpload.event","../../browser/PlatformDetection","../../performance/PerformanceMarker"],function(e,t,o,i,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;!function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"}(l||(l={}));var n=function(e,t,i,o,r,n,a){this.url=e;this.duration=t;this.correlationId=i;this.status=o;this.startTime=r;this.endTime=n;this.name=a};t.APICallPerformanceData=n;var d=["EUPL","ScenarioId"],c=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,p=function(e,t,i,o,r,n,a){this.controlId=e;this.startTime=t;this.endTime=i;this.renderTimeCalculator=o;this.renderTimeRequiredDataChecker=r;this.ignoreForEUPL=void 0===n||n;this.needFlatten=void 0!==a&&a};t.ControlPerformanceData=p;function u(e){return null==e}var h="__default_rumone__",m={checkInterval:100,error_timeout:3e4,max_markers:100},g=function(){function n(e,t,i){void 0===i&&(i=m);this._keyMetrics=d;this.async=new o.default(this);this.dataStartTime=Number((new Date).getTime());this._rumoneData={};this.dataState=l.Incomplete;this.controls=[];this.apis=[];this.euplBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.tempData={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this._name=e;this.loggingFunc=t;this._config=i;this.setPerfDataTimer();this._platformDetection=new r.default;this._hookUnloadEvent()}n.getRUMOneLogger=function(e,t,i){void 0===e&&(e=h);void 0===i&&(i=m);var o=t||function(e,t){a.RUMOneDataUpload.logData({streamName:e,dictionary:t})};if(!n.Loggers[e])try{var r=new n(e,o,i);e===h&&(n.rumOneLogger=r);n.Loggers[e]=r}catch(e){}return n.Loggers[e]};Object.defineProperty(n.prototype,"KeyMetrics",{get:function(){return this._keyMetrics},enumerable:!0,configurable:!0});n.prototype.getPerformanceData=function(){return this._rumoneData};n.prototype.resetLogger=function(){this._emergencyUpload();this.dataStartTime=(new Date).getTime();this.dataState=l.Incomplete;this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._excludePageData=!1;this._waitOnAddingExpectedControl=!1;this._keyMetrics=d;this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.serverMetrics={};this.clearResourceTimings();s.clearMarks(this._getOwnMakers().map(function(e){return e.name}));n._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this.logMessageInConsole("Reset performance Logger Done")};n.prototype.excludePageForPerfData=function(){this._excludePageData=!0};n.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};n.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&c.test(e)){this._rumoneData[e]=t;return!0}console.error("key "+e+" does not confrim to the Regex "+c);return!1};n.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};n.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return 0<this.controls.filter(function(e){return e.controlId===t.controlId}).length};n.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};n.prototype.writeServerUrl=function(e){this._rumoneData.ServerUrl||(this._rumoneData.ServerUrl=e||window.location.href)};n.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};n.prototype.writeControlPerformanceData=function(t){if(t){var e=this.controls.filter(function(e){return e.controlId===t.controlId})[0];if(e)e.data||(e.data=t);else{var i={controlId:t.controlId,data:t,ignoreForEUPL:t.ignoreForEUPL};this.controls.push(i)}}};n.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};n.prototype.readAPICallPerformanceData=function(){return this.apis};n.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};n.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==i.default.fullPageLoad&&e!==i.default.none&&e!==i.default.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};n.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};n.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var i=0;i<e.length;i++){var o=t[e[i]];o&&this._logRUMOneData(this.getW3cTimingName(e[i]),Number(o))}this.isW3cTimingCollected=!0}}};n.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++){var o=null;try{o=t[i].contentWindow.performance}catch(e){}o&&o.getEntriesByType&&e.concat(o.getEntriesByType("resource"))}var r={SharePoint:function(e){return/\.sharepoint\.com|\.spoppe\.com/i.test(e.name)},CDN:function(e){return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name)},ThirdParty:function(e){return!r.SharePoint(e)&&!r.CDN(e)}},n={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},a=Object.keys(r);for(i=0;i<a.length;i++){var s=a[i],l=this.categorizeResourceRequests(e,{from:r[s],requestType:null});this._logRUMOneData(s+"RequestCountTotal",l.length);for(var d=Object.keys(n),c=0;c<d.length;c++){var p=d[c];this._logRUMOneData(s+"RequestCount"+p,this.categorizeResourceRequests(l,{from:null,requestType:n[p]}).length)}if(0<l.length){this._logRUMOneData(s+"RequestDownloadTime",Math.round(l.reduce(function(e,t){return e+t.duration},0)/l.length));var u=JSON.stringify(l.map(function(e){return{name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&0<e.length}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0}}));this._logRUMOneData(s+"RequestNames",u)}}this.isW3cResourceTimingCollected=!0}};n.prototype.saveTempData=function(e,t){this.tempData[e]=t};n.prototype.readTempData=function(e){return this.tempData[e]};n.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};n.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};n.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};n.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};n.prototype.isRunning=function(){return!(this.dataState===l.Uploaded||this.dataState===l.TimeOut||this.dataState===l.Skipped)};n.prototype.writeEUPLBreakdown=function(e,t){if(e)try{var i=JSON.parse(e);for(var o in i)i.hasOwnProperty(o)&&this.addEUPLBreakdown(o,i[o],t)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};n.prototype.addEUPLBreakdown=function(e,t,i){if(e&&!u(t)){if(u(this.euplBreakDown[e])||i){var o=this._isBreakdownValue(t)?t.data:t;this.euplBreakDown[e]=o}this._isBreakdownValue(t)&&t.needFlatten&&this._logRUMOneData(e,t.data)}};n.prototype.readEUPLBreakdown=function(e){return e?this.euplBreakDown[e]:this.euplBreakDown};n.prototype.addFlights=function(e){if(e&&0<e.length){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),i=0;i<e.length;i++){var o=e[i];o&&-1===t.indexOf(o)&&t.push(o)}this._rumoneData.Flights=JSON.stringify(t)}};n.prototype.addServerMetrics=function(e,t){if(e)for(var i in e)i&&!u(e[i])&&(u(this.serverMetrics[i])||t)&&(this.serverMetrics[i]=e[i])};n.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};n.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};n.prototype.mark=function(e){(n._markers[this._name]=n._markers[this._name]||[]).push(e);s.mark(e)};n.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};n.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};n.prototype.registerErrorHandler=function(e){};n.prototype.getMarkerTime=function(e){return s.getMarkerTime(e)};n.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&this._keyMetrics.indexOf(e)<=-1&&this._keyMetrics.push(e)};Object.defineProperty(n.prototype,"waitOnAddingExpectedControl",{set:function(e){this._waitOnAddingExpectedControl=e},enumerable:!0,configurable:!0});n.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};n.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};n.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};n.prototype.collectMarks=function(){var i=this,o={},r=0;this._getOwnMakers().forEach(function(e){if(r<i._config.max_markers){var t=e.name.substr(s.MARKER_PREFIX.length)+".mark"+r++;o[t]=Math.round(e.startTime)}});this.writeEUPLBreakdown(JSON.stringify(o))};n.prototype._getOwnMakers=function(){var t=this,i=n._markers,o=[].concat.apply([],Object.keys(i).filter(function(e){return i.hasOwnProperty(e)&&e!==t._name}).map(function(e){return i[e]}));return s.getAllMarks().filter(function(e){return-1===o.indexOf(e.name)})};n.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(n.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0});n.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var i=this._name+" "+e+" : "+JSON.stringify(t);console.log(i)}};n.prototype.isCollected=function(e){return!u(this.getPerformanceDataPropertyValue(e))};n.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};n.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};n.prototype.clearPerfDataTimer=function(){if(!u(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};n.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};n.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};n.prototype.categorizeResourceRequests=function(e,t){for(var i=[],o=0;o<e.length;o++){var r=e[o];t.from&&!t.from(r)||t.requestType&&!t.requestType(r)||i.push(r)}return i};n.prototype.collectSupplementaryData=function(){this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl(null);this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown)};n.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState();if(this.dataState===l.ReadyToUpload){this.finishPerfDataUpload();return}this.processControlRenderTime();if(this.readyToComputeEUPL()){this.setEUPL();this._updateState()}}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};n.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==l.ReadyToUpload&&!(Number((new Date).getTime())-Number(this.dataStartTime)<=this._config.error_timeout)){this.dataState=l.TimeOut;var e={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(e);this.finishPerfDataUpload()}};n.prototype._updateState=function(){this.dataState=0===this._getMissedKeyMetrics().length&&0===this._getMissedControls().length?l.ReadyToUpload:l.Incomplete};n.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this._keyMetrics.length;t++){u(this.getPerformanceDataPropertyValue(this._keyMetrics[t]))&&e.push(this._keyMetrics[t])}return e};n.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};n.prototype._emergencyUpload=function(){this.isRunning()&&0===this._getMissedKeyMetrics().length&&this.finishPerfDataUpload(!0)};n.prototype.finishPerfDataUpload=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();try{this.uploadPerfData(e);if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this._unhookUnloadEvent()}var t};n.prototype.getReadableDataState=function(e){for(var t in l)if(e===Number(l[t]))return t;return"NaN"};n.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId);this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime)}var i={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){i[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});0<Object.keys(i).length&&this.writeEUPLBreakdown(JSON.stringify(i),!0)}};n.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var i=t[e];i.data&&!i.data.renderTime&&i.data.renderTimeRequiredDataChecker(this,i.data)&&(i.data.renderTime=i.data.renderTimeCalculator(this,i.data))}};n.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=0<e.length,i=0,o=e;i<o.length;i++){var r=o[i];if(!r.data||!r.data.renderTime){t=!1;break}}return t};n.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,i=this.controls;t<i.length;t++){var o=i[t];!o.ignoreForEUPL&&o.data&&o.data.renderTime&&e<o.data.renderTime&&(e=o.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};n.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};n.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&performance&&performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};n.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,i=0;i<this.apis.length;i++){var o=this.apis[i];if(o){e++;t+=o.duration;o.url=o.url.split("/").map(function(e){return e.split("?")[0]}).slice(-1)[0].replace(/\(.*?\)/g,"()")}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(this.apis)};n.prototype.setReferrer=function(){this._rumoneData.Referrer=window.document&&document.referrer};n.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};n.prototype.uploadPerfData=function(e){if(this._excludePageData){this.dataState=l.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(e||this.dataState===l.ReadyToUpload||this.dataState===l.TimeOut)if(this.loggingFunc)if(this._rumoneData){this.loggingFunc("RUMOne",this.getPerformanceData());this.dataState=l.Uploaded}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)};n.rumOneLogger=void 0;n.Loggers={};n._markers={};return n}();t.default=g});define("@ms/odsp-utilities/lib/logging/rumone/PageTransitionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"}(i||(i={}));t.default=i});define("@ms/odsp-utilities/lib/logging/events/RUMOneDataUpload.event",["require","exports","../SingleEventBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RUMOneDataUpload=i.createSingleEvent({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4});t.default=t.RUMOneDataUpload});define("@ms/odsp-datasources/lib/dataSources/base/ServerConnection",["require","exports","./ServerData","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData","@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Promise"],function(e,t,g,f,b,i,y,v,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function m(e){void 0===e&&(e={});this._scope=new i.default;this._events=this._scope.attach(new o.default(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new b.default(t).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(t){this._webAbsoluteUrl=t;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1}m._isXhrAborted=function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!0;if(e.isCancelled)return!0}catch(e){return!0}return!1};m._isValidFormDigest=function(e){return e&&e.updateFormDigestPageLoaded&&Date.now()-e.updateFormDigestPageLoaded.getTime()<1e3*e.formDigestTimeoutSeconds};m.prototype.dispose=function(){this._scope.dispose()};m.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};m.prototype.isRequestActive=function(){return!!this._currentRequest};m.prototype.getServerDataFromUrl=function(e){var t=this,i=e.url,o=e.successCallback,r=e.failureCallback,n=e.uploadProgressCallback,a=e.additionalPostData,s=e.isRest,l=void 0===s||s,d=e.method,c=void 0===d?"POST":d,p=e.withCredentials,u=e.additionalHeaders,h=e.contentType,m=e.noRedirect,g=e.responseType,f=e.needsRequestDigest,b=void 0===f?this._needsRequestDigest:f,y=(new Date).toISOString(),v=new XMLHttpRequest;v.open(c,i,!0);"boolean"==typeof p&&(v.withCredentials=p);g&&(v.responseType=g);h?v.setRequestHeader("Content-Type",h):l?v.setRequestHeader("Content-Type","application/json;odata=verbose"):v.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var x=!1;if(u)for(var _ in u)if(_){v.setRequestHeader(_,u[_]);"accept"===_.toLowerCase()&&(x=!0)}x||v.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=v;var S=function(e){b&&e&&v.setRequestHeader("x-requestdigest",e);t._events.on(v,"readystatechange",function(){t._onReadyStateChange(v,i,o,r,m,y)});n&&v.upload&&t._events.on(v.upload,"progress",function(e){n(e)});v.send(a)};b?this._ensureRequestDigest(S,r):S()};m.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};m.prototype._ensureRequestDigest=function(e,t){var i=m._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&m._isValidFormDigest(i)?e(i.formDigestValue):this._ensureRequestDigestWorker(e,t)};m.prototype._ensureRequestDigestWorker=function(i,r){var n=this,e=new m({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});i||(e._requestCanaryForAuth=!0);var a=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof a){m._requestDigestPromise||(m._requestDigestPromise=new s.default(function(o,t){e.getServerDataFromUrl({url:b.default.concatenate(a,"/_api/contextinfo"),successCallback:function(e){var t=e.getResponseText(),i=JSON.parse(t).d.GetContextWebInformation;m._formDigests[n._webServerRelativeUrl]={formDigestValue:i.FormDigestValue,formDigestTimeoutSeconds:i.FormDigestTimeoutSeconds-m.INTERVAL_ADJUST,updateFormDigestPageLoaded:new Date};o(m._formDigests[n._webServerRelativeUrl].formDigestValue);m._requestDigestPromise=void 0},failureCallback:function(e){i?i(void 0):r&&r(e);t(void 0);m._requestDigestPromise=void 0},method:"POST",noRedirect:!!r})}));m._requestDigestPromise.then(function(e){i&&i(e);return e})}else r&&r(void 0)};m.prototype._onReadyStateChange=function(e,t,i,o,r,n){if(4===e.readyState){this._currentRequest=void 0;this._events.off(e);e.upload&&this._events.off(e.upload);if(m._isXhrAborted(e))o();else{var a=new g.default(e,t),s=a.getStatus(),l=v.default.getRUMOneLogger(),d=Date.now();if(l){var c=new y.default(t,Number(e.getResponseHeader("SPClientServiceRequestDuration")),e.getResponseHeader("SPRequestGuid"),s,n,(new Date).toISOString());l.writeAPICallPerformanceData(c);l.saveTempData("appDataFetchEnd",d)}var p=!r&&this._shouldRedirectToErrorCustomPromptLocation(e);if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===s){try{p?this._redirectToErrorCustomPromptLocation(e):o(a)}catch(e){}if(!r){if(u=a.getAuthenticationRedirect()){(h=new b.default(u)).setQueryParameter("ReturnUrl",f.default.encodeURIComponent(window.location.href));window.location.href=h.toString()}}}else{try{o(a)}catch(e){}if(!r){var u;if(u=(this._webAbsoluteUrl||this._webServerRelativeUrl)+"/_layouts/15/AccessDenied.aspx"){var h;(h=new b.default(u)).setQueryParameter("Source",f.default.encodeURIComponent(window.location.href));h.setQueryParameter("Type","list");h.setQueryParameter("correlation",f.default.encodeURIComponent(a.getCorrelationId()));window.location.href=h.toString()}}}return}if(200===s||201===s||204===s){i(a);return}if(403===s){m._requestDigestPromise=void 0;r?this._ensureRequestDigestWorker(void 0,function(){return o(a)}):p?this._redirectToErrorCustomPromptLocation(e):this._ensureRequestDigestWorker(void 0);return}401===s&&p&&this._redirectToErrorCustomPromptLocation(e);o(a)}}};m.prototype._tryLoadDigest=function(e){var t=m._formDigests[this._webServerRelativeUrl];m._isValidFormDigest(e)&&(!m._isValidFormDigest(t)||t.updateFormDigestPageLoaded.getTime()<e.updateFormDigestPageLoaded.getTime())&&(m._formDigests[this._webServerRelativeUrl]=e)};m.prototype._shouldRedirectToErrorCustomPromptLocation=function(e){var t=e.getResponseHeader("X-SPO-ErrorCode"),i=e.getResponseHeader("sharepointerror");return"9.3"===t||"-2130575129"===i};m.prototype._redirectToErrorCustomPromptLocation=function(e){var t=new b.default(e.getResponseHeader("X-SPO-ErrorCustomPromptLocation"));t.setQueryParameter("ReturnUrl",window.location.href);window.location.href=t.toString()};m.INTERVAL_ADJUST=10;m._formDigests={};m._requestDigestPromise=void 0;return m}();t.default=r});define("@ms/odsp-datasources/lib/dataSources/base/ServerData",["require","exports","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){this._request=e;this._url=t}i.prototype.getSourceUrl=function(){return this._url};i.prototype.getCorrelationId=function(){return this._request.getResponseHeader("SPRequestGuid")};i.prototype.getGroupThrottle=function(){return this._request.getResponseHeader("SPGroupThrottle")};i.prototype.getStatus=function(){try{return this._request.status}catch(e){}};i.prototype.getAuthenticationRedirect=function(){return this._request.getResponseHeader("X-Forms_Based_Auth_Required")};i.prototype.getResponseType=function(){return this._request.responseType};i.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};i.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){var e={status:this._request.status,statusText:this._request.statusText,infected:void 0};this._request.getResponseHeader("x-virus-infected")&&(e.infected=!0);return e}return this.getResponseText()};i.prototype.parseError=function(){var i=this,o=new n.default;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,i=new n.default,o=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);i.complete(e)}catch(e){i.complete({message:"Unable to parse blob result."})}}},r=function(){i.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",o);t.addEventListener("error",r);t.readAsText(e)}catch(e){r()}return i.getPromise().then(function(e){if(t){t.removeEventListener("load",o);t.removeEventListener("error",r)}return e})}(this._request.response).then(function(e){var t={data:e,status:i.getStatus(),statusText:i._request.statusText,infected:!!i._request.getResponseHeader("x-virus-infected")};o.complete(t)}):o.complete(this._request.response):o.complete(this._request.responseText);return o.getPromise()};i.prototype.getValue=function(e){var t;switch(e){case i.DataValueKeys.SourceURL:t=this.getSourceUrl();break;case i.DataValueKeys.CorrelationId:t=this.getCorrelationId();break;case i.DataValueKeys.Status:t=this.getStatus();break;case i.DataValueKeys.AuthenticationRedirect:t=this.getAuthenticationRedirect();break;case i.DataValueKeys.ResponseText:t=this.getResponseText();break;case i.DataValueKeys.ErrorResponseText:t=this.getErrorResponseText()}return t};i.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return i}();t.default=i});define("@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData",["require","exports","./RUMOneLogger"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=i.APICallPerformanceData});define("@ms/odsp-datasources/lib/interfaces/ISpPageContext",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.None=0]="None";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.Strong=3]="Strong"}(t.SPVariantThemeType||(t.SPVariantThemeType={}));!function(e){e[e.FooterEnabled=2]="FooterEnabled";e[e.MegaMenuEnabled=128]="MegaMenuEnabled"}(t.SPWebPropertyFlags2||(t.SPWebPropertyFlags2={}));t.DEFAULT_LOGO_URL="_layouts/15/images/siteicon.png";t.getServerUrl=function(e){var t=e.webAbsoluteUrl,i=e.webServerRelativeUrl;return"/"===i||""===i?t:t.substring(0,t.lastIndexOf(i))};t.getSafeWebServerRelativeUrl=function(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl};t.isGroupWebContext=function(e){return e&&!!e.groupId&&e.webAbsoluteUrl===e.siteAbsoluteUrl};t.isModernTemplate=function(e){return-1!==["STS#3","GROUP#0","SITEPAGEPUBLISHING#0"].indexOf(e.webTemplateConfiguration)}});define("odsp-next/dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource","@ms/odsp-utilities/lib/resources/Resources","../../resources/SPOResourceKeys"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e,t){return i.call(this,t.pageContext)||this}return e}(i.default);t.resourceKey=r.createResolvedResourceKey(e("module").id,a,{pageContext:n.pageContext})});define("@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource",["require","exports","tslib","../base/DataSource"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(e){return t.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:e})||this}e.prototype.getMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})};return e}(o.default);t.default=r});define("odsp-next/controls/downloadAsZip/DownloadAsZip",["require","exports","./DownloadAsZipViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DownloadAsZip.html","./DownloadAsZip.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-downloadaszip",template:e("./DownloadAsZip.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/downloadAsZip/DownloadAsZipViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.formAction=e.formAction;t.filesValue=e.filesValue;t.providerValue=e.providerValue;t.id="form_download_as_zip"+e.id;t.notificationUrlValue=e.notificationUrlValue;t.accessToken=e.accessToken;t.zipFileName=e.zipFileName;t.target=e.target;t.oAuthToken=e.oAuthToken;t.guid=e.guid;t.method=e.method||"Post";return t}return e}(i.default);t.default=r});define("odsp-next/controls/downloadAsZip/DownloadAsZip.html",[],function(){return'<div id=od-Download-As-Zip class=od-DownloadAsZip><form class=DownloadAsZipForm name=form_download_as_zip data-bind="attr: { action: formAction, target: target, id: id, method: method}"><input id=download_input_1 name=provider type=hidden data-bind="value: providerValue"> <input id=download_input_2 name=guid type=hidden data-bind="value: guid"> <input id=download_input_3 name=files type=hidden data-bind="value: filesValue"> <input id=download_input_4 name=notificationUrl type=hidden data-bind="value: notificationUrlValue"> <input id=download_input_5 name=accessToken type=hidden data-bind="value: accessToken"> <input id=download_input_6 name=zipFileName type=hidden data-bind="value: zipFileName"> <input id=download_input_6 name=oAuthToken type=hidden data-bind="value: oAuthToken"></form></div>'});define("odsp-next/controls/downloadAsZip/DownloadAsZip.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DownloadAsZip{visibility:hidden}"}])});define("odsp-next/actions/download/DownloadItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/pushChannel/IPushChannelProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../providers/pushChannel/PushChannelProvider.key"],function(e,t,i,r,n,a,s,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d;!function(e){e[e.Success=0]="Success";e[e.RemoteHostClosedConnection_HttpException=1]="RemoteHostClosedConnection_HttpException";e[e.FileAndFolderDownloadError=2]="FileAndFolderDownloadError";e[e.FolderDownloadError=3]="FolderDownloadError";e[e.FileDownloadError=4]="FileDownloadError"}(d=t.ZipPayloadErrorCode||(t.ZipPayloadErrorCode={}));var c="OverAllProgress",p=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._context=e;i._pushChannelProvider=t.pushChannelProvider;return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e);t.type=a.default.downloadAsZip;var i=e.input;t.name=i.name;e.output&&0<=e.output.current&&(t.progress={current:e.output.current,minimum:0,maximum:e.output.maximum});t.payloads={downloadAsZip:{fileName:this._context.zipFileName}};return t};e.prototype.onStart=function(e){var i=this;if(!this._pushChannelProvider)return s.default.wrap();var t=new r.Task(c,{key:this._context.guid}),o=[t=t.changeOutput(function(e){return{zipFileName:i._context.zipFileName}})];e.update(o);this._pushChannelProvider.setupNotificationHandler({source:n.NotificationSource.Meta,scenarios:[n.NotificationScenario.Zip],id:this._context.guid},function(t){if("ZipProgress"===t.type&&o&&i._context.guid===t.guid){o=o.map(function(e){if(e.key===c){e=e.changeOutput(function(e){return{current:t.filesProcessed,maximum:t.totalFiles,zipFileName:i._context.zipFileName}});t.isComplete&&t.errorCode===d[d.RemoteHostClosedConnection_HttpException]?e=e.cancel():t.isComplete&&(e=e.succeed())}return e});e.update(o)}});return s.default.wrap()};e.dependencies=i.__assign({},r.default.dependencies,{pushChannelProvider:l.resourceKey.optional});return e}(r.default);t.default=p;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,p)});define("odsp-next/providers/pushChannel/IPushChannelProvider",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta"}(t.NotificationSource||(t.NotificationSource={}));(i=t.NotificationScenario||(t.NotificationScenario={}))[i.Zip=0]="Zip";!function(e){e[e.PushChannelProvider=0]="PushChannelProvider";e[e.ItemAutoRefreshProvider=1]="ItemAutoRefreshProvider";e[e.ItemAutoRefreshDataSource=2]="ItemAutoRefreshDataSource"}(t.PushChannelLogSource||(t.PushChannelLogSource={}))});define("odsp-next/actions/embed/odc/EmbedExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","./EmbedHelper"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._helper=new(t.managed(n.default));t.name=e.actionName;t._selectionHelper=e.selectionHelper;t._itemReedemer=new(t.managed(r.default));return t}e.prototype.execute=function(){var t=this;return this._selectionHelper.resolveFirst().then(function(e){return t._itemReedemer.redeemItem(e,t).then(function(){return t._helper.shareItem(e)})})};return e}(i.default);t.default=a});define("odsp-next/actions/embed/odc/EmbedHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/SharingType","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../../providers/panel/PanelProvider","../../../controls/embedBuilder/EmbedBuilder","../../../providers/dialog/DialogProvider","../../../controls/embedBuilder/EmbedBuilder.resx","../../../controls/textContainer/TextContainer"],function(e,t,o,r,n,i,a,s,l,d,c,p,u,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(s.urlDataSource);t._dialogProvider=t.resources.consume(u.resourceKey);t._panelProvider=t.resources.consume(c.resourceKey);return t}e.prototype.shareItem=function(e){return e.isSpecialFolder&&e.sharingType!==a.default.Public?this._showWarningDialog(e):this._showEmbedDialog(e)};e.prototype._showWarningDialog=function(e){var t=this,i={text:h.strings.specialFolderConfirmText},o=this._dialogProvider.requestDialog({title:h.strings.specialFolderConfirmTitle,size:"Medium",component:{name:m.default.tagName,params:i},actions:[{name:h.strings.specialFolderConfirmButton,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new n.default("Embed"),isDefault:!1}]});return o.wait().then(function(){2===o.state()&&t._showEmbedDialog(e);return{resultType:l.ResultTypeEnum.Success}})};e.prototype._showEmbedDialog=function(e){var t=d.format(h.strings.title,e.name),i={item:e,embedPageUrl:this._urlDataSource.getEmbedPageUrl(e)};return this._panelProvider.requestPanel({title:t,component:{name:p.default.tagName,params:i}}).wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})};return e}(i.default);t.default=g});define("odsp-next/controls/embedBuilder/EmbedBuilder",["require","exports","./EmbedBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./EmbedBuilder.html","./EmbedBuilder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-embed-builder",template:e("./EmbedBuilder.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/embedBuilder/EmbedBuilderViewModel",["require","exports","tslib","knockout","./EmbedBuilder.resx","../../providers/sharing/SharingProvider","../../utilities/icons/OfficeFileNameHelper","../../resources/ProviderResourceKeys","../../utilities/browser/ResponsiveUI","../../bindings/focus/SelectOnFocusBinding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/autoResizeHeight/AutoResizeHeightBinding","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/uri/Uri","../../models/item/ItemType","../loadingSpinner/LoadingSpinner"],function(n,e,t,a,s,d,c,p,u,h,i,m,g,o,f,b,y,v,x){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var _=function(e){this.name=e.name;this.maxDim=e.maxDim;this.isOriginalSize=e.isOriginalSize};e.EmbeddedImageSize=_;var r=function(r){t.__extends(l,r);function l(e){var t=r.call(this,e)||this;t._item=e.item;t._embedPageUrl=e.embedPageUrl;t._thumbnailSizes=null;t._thumbnails=null;t._sharingProvider=t.resources.consume(d.resourceKey);t._embedProvider=t.resources.consume(p.embed);t._responsiveUI=t.resources.consume(u.resourceKey);t._thumbnailProvider=t.resources.consume(p.thumbnail);t._instrumentationProvider=t.resources.consume(p.instrumentation);t.isLoading=a.observable(!0);t.isPicture=a.observable(!1);t.photoUrl=a.observable("");t.iframeSrc=a.observable("");t.embedIconImgSrc="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/embedpanel/embed.svg"):n("@ms/odsp-media/dist/media/images/embedpanel/embed.svg");t.embedCode=a.observable("");t.embedCode.subscribe(t.onEmbedCodeChange.bind(t));t.embedCodeDisplayed=a.observable("");t.configuratorUrl=a.observable("");t.embedConfiguratorClickUsageName=f.UsageName.EmbedConfiguratorClick;t.featureCssWrapperClass="od-embed-useModernEmbedPanel";t.htmlTagsOn=a.observable(!1);t.htmlTagsOn.subscribe(t.onHtmlTagsClicked.bind(t));t.previewWidth=a.observable(t._getPreviewWidth());t.previewHeight=a.observable(t._getPreviewHeight());t.instructionsText=a.observable("");t.generateText=s.strings.generate;t.disclaimerText=s.strings.disclaimer;t.loadingText=s.strings.loading;t.configuratorText=s.strings.configurator;t.imageSizeText=s.strings.imageSizeLabel;t.copyText=s.strings.embedTextLabel;t.loadingSpinnerComponentTag=x.default.tagName;t.loadingSpinnerComponentParams={loadingText:t.loadingText};t.updateSpinnerComponentParams={loadingText:""};var i=0,o=!0;if(t._item.photo)if(t._item.photo.width>t._item.photo.height){i=t._item.photo.width;o=!0}else{i=t._item.photo.height;o=!1}t._populateImageSizes(i,o);t.selectedImageSize.subscribe(t.onImageSizeChange.bind(t));t.htmlTagsText=s.strings.includeHTMLTags;t.isEmbedCodeUpdating=a.observable(!1);t._embedCodeUpdatingSpinnerTimeout=-1;t._getEmbedInfo();t.addBindingHandlers({selectOnFocus:h.default,autoResizeHeight:g.default});return t}l._getThumbnailSizeForMaxDim=function(e,t){return t?{width:e}:{height:e}};l._getEmbedCode=function(e,t){return t?'<img src="'+e.url+'" width="'+e.width+'" height="'+e.height+'" />':e.url};l.prototype.onGenerateClicked=function(){var e=this;this.isLoading(!0);this._sharingProvider.manageSharingLinks([this._item],{type:3,role:1,create:!0}).then(function(){e._getEmbedInfo()})};l.prototype.onImageSizeChange=function(e){this._updateEmbedCode(e,this.htmlTagsOn(),!0)};l.prototype.onHtmlTagsClicked=function(e){this._updateEmbedCode(this.selectedImageSize(),e,!1)};l.prototype.onEmbedCodeChange=function(){-1!==this._embedCodeUpdatingSpinnerTimeout&&this.async.clearTimeout(this._embedCodeUpdatingSpinnerTimeout);this.isEmbedCodeUpdating(!0);this.embedCodeDisplayed("");this._embedCodeUpdatingSpinnerTimeout=this.async.setTimeout(function(){this.embedCodeDisplayed(this.embedCode());this.isEmbedCodeUpdating(!1)},500)};l.prototype.reportConfiguratorUsage=function(e){o.default.logData({name:f.UsageName[e],location:f.LocationName[f.LocationName.EmbedPane],usageType:b.UsageType[b.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!0};l.prototype._updateEmbedCode=function(e,t,i){var o=this._item.photo;if(o&&this._thumbnails){var r=null,n=o.width>o.height;r=e.isOriginalSize?this._thumbnailProvider.getThumbnailForSize(this._thumbnails,o.width,o.height):this._thumbnailProvider.getThumbnailForLargestDimension(this._thumbnails,e.maxDim,n);this.embedCode(l._getEmbedCode(r,t));if(i){this.photoUrl(r.url);var a=this._getPreviewWidth(),s=this._getPreviewHeight();this.previewWidth(Math.min(a,r.width));this.previewHeight(Math.min(s,r.height))}}};l.prototype._getPreviewWidth=function(e){var t=165,i=this._item.photo||this._item.video;if(i)t=i.width>i.height?Math.min(i.width,320):i.height<320?i.width:Math.floor(i.width/i.height*320);else if(this._item.appMap&&e)switch(this._item.appMap){case c.wordType:case c.excelType:case c.powerpointType:case c.visioType:t=320}var o=this._responsiveUI.formFactorSize();300<t&&"Small"===o&&(t=300);return t};l.prototype._getPreviewHeight=function(e){var t=150,i=this._item.photo||this._item.video;if(i)t=i.height>i.width?Math.min(i.width,320):i.width<320?i.height:Math.floor(i.height/i.width*320);else if(this._item.appMap&&e)switch(this._item.appMap){case c.wordType:t=288;break;case c.excelType:t=346;break;case c.powerpointType:case c.visioType:t=327}var o=this._responsiveUI.formFactorSize();300<t&&"Small"===o&&(t=300);return t};l.prototype._getEmbedInfo=function(){var t=this,i=this._getItemType();this._embedProvider.getEmbedInfo(this._item).then(function(e){if(t._item.type===v.default.Media&&t._item.photo)if(e){t.isPicture(!0);t.previewWidth(t._getPreviewWidth(!0));t.previewHeight(t._getPreviewHeight(!0));t._thumbnailProvider.getThumbnails(t._item.graph,t._thumbnailSizes,t._getAuthKeyFromEmbedUrl(e.embedUrl)).then(function(e){t.isLoading(!1);t._thumbnails=e;t._updateEmbedCode(t.selectedImageSize(),t.htmlTagsOn(),!0)})}else{t.isLoading(!1);t.instructionsText(s.strings["generateInstructions"+i])}else{t.isLoading(!1);if(e){t.embedCode(e.embedCode);e.embedUrl&&t.iframeSrc(e.embedUrl);if(e.configuratorUrl){t.configuratorUrl(e.configuratorUrl);t.reportConfiguratorUsage(f.UsageName.EmbedConfiguratorLinkShown)}t.previewWidth(t._getPreviewWidth(!0));t.previewHeight(t._getPreviewHeight(!0))}else{t.instructionsText(s.strings["generateInstructions"+i]);t.iframeSrc(t._embedPageUrl)}}})};l.prototype._getAuthKeyFromEmbedUrl=function(e){return new y.default(e).getQueryParameter("authkey")};l.prototype._getItemType=function(){var e="File";this._item.photo?e="Photo":this._item.isAlbum?e="Album":this._item.folder&&(e="Folder");return e};l.prototype._populateImageSizes=function(e,t){var i=[];this._thumbnailSizes=[];var o=this._item.photo?m.format(s.strings.imageSizeOriginal,e):null;i.push(new _({name:o,maxDim:e,isOriginalSize:!0}));this._item.photo&&this._thumbnailSizes.push(this._item.photo);for(var r=0;r<l.DEFUALT_EMBEDDED_IMAGES_SIZES.length;r++){var n=l.DEFUALT_EMBEDDED_IMAGES_SIZES[r];if(n.maxDim<e){i.push(n);this._thumbnailSizes.push(l._getThumbnailSizeForMaxDim(n.maxDim,t))}}this.imageSizes=a.observable(i);this.selectedImageSize=a.observable(this.imageSizes()[0])};l.DEFUALT_EMBEDDED_IMAGES_SIZES=[{name:s.strings.imageSizeLarge,maxDim:1024,isOriginalSize:!1},{name:s.strings.imageSizeMedium,maxDim:660,isOriginalSize:!1},{name:s.strings.imageSizeSmall,maxDim:256,isOriginalSize:!1}];return l}(i.default);e.default=r});define("odsp-next/bindings/autoResizeHeight/AutoResizeHeightBinding",["require","exports","knockout"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.update=function(e,t,i,o,r){var n=s.utils.unwrapObservable(t());if(n.enabled){s.utils.unwrapObservable(n.elementContents);e.style.height="1px";var a=e.scrollHeight;n.additionalPadding&&(a+=n.additionalPadding);e.style.height=a+"px"}};return e}();t.default=i});define("odsp-next/controls/embedBuilder/EmbedBuilder.html",[],function(){return'<div class=EmbedBuilder data-bind="css: featureCssWrapperClass">\x3c!--ko if: isLoading--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerComponentTag, params: loadingSpinnerComponentParams }"></span>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<div class=od-embed-preview>\x3c!--ko if: !embedCode()--\x3e<img data-bind="attr: { src: embedIconImgSrc }" class=od-embed-generateIcon tabindex=-1>\x3c!--/ko--\x3e\x3c!--ko if: embedCode()--\x3e\x3c!--ko if: !isPicture()--\x3e<iframe data-bind="attr: { src: iframeSrc }, style: { width: previewWidth() + \'px\', height: previewHeight() + \'px\' }" tabindex=-1 frameborder=0 scrolling=no></iframe>\x3c!--/ko--\x3e\x3c!--ko if: isPicture()--\x3e<img data-bind="attr: { src: photoUrl}, style: { width: previewWidth() + \'px\', height: previewHeight() + \'px\' }" tabindex=-1>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-embed-details>\x3c!--ko if: !embedCode()--\x3e<p class="od-embed-instructions ms-font-l" data-bind="text: instructionsText"></p><button class="od-Button od-embed-button od-Button--primary" data-bind="click: onGenerateClicked"><span class=od-Button-label data-bind="text: generateText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: embedCode()--\x3e\x3c!--ko if: isPicture()--\x3e<div class=od-embed-pictureOptions><h2 class="od-embed-imageSize ms-font-l" data-bind="text: imageSizeText"></h2><div><select class=od-embed-sizePicker data-bind="options: imageSizes, optionsText: \'name\', value: selectedImageSize"></select></div><div class="od-embed-htmlTagsBox ms-CheckBox"><input type=checkbox class="od-embed-htmlTagsCheckbox ms-CheckBox-input" id=od-embed-htmlTagsBox data-bind="checked: htmlTagsOn"> <label class="ms-font-m ms-fontColor-neutralSecondary ms-CheckBox-field" for=od-embed-htmlTagsBox data-bind="css: {\'is-checked\': htmlTagsOn}"><span class=ms-Label data-bind="text: htmlTagsText"></span></label></div><h2 class="od-embed-copyText ms-font-l"><span data-bind="text: copyText"></span><div class="od-embed-updateSpinner ms-font-m" data-bind="css: { \'od-embed-updateSpinnerOn\': isEmbedCodeUpdating }, component: { name: loadingSpinnerComponentTag, params: updateSpinnerComponentParams }"></div></h2></div>\x3c!--/ko--\x3e<div class="od-TextField od-TextField--multiline"><textarea class=od-TextField-field readonly aria-live=polite data-bind="value: embedCodeDisplayed, selectOnFocus: { isPermanent: true }, autoResizeHeight: { enabled: true, elementContents: embedCodeDisplayed, additionalPadding: 2 }"></textarea></div>\x3c!--/ko--\x3e<p class="od-embed-disclaimer ms-font-m ms-fontColor-neutralSecondary" data-bind="text: disclaimerText"></p>\x3c!--ko if: configuratorUrl()--\x3e<p><a class=od-embed-configurator target=_blank data-bind="text: configuratorText, attr: { href: configuratorUrl }, click: reportConfiguratorUsage.bind($data, embedConfiguratorClickUsageName)"></a></p>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/embedBuilder/EmbedBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-embed-useEmbedDialog .od-embed-details{display:inline-block;vertical-align:top}.od-embed-useEmbedDialog .od-embed-disclaimer{display:inline-block;margin-top:10px}.od-embed-useEmbedDialog .od-embed-textbox{padding:1px 5px 2px 10px;width:90%;text-overflow:ellipsis}html[dir=rtl] .od-embed-useEmbedDialog .od-embed-textbox{padding:1px 10px 2px 5px}.od-embed-useModernEmbedPanel .od-embed-preview{margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-generateIcon{height:255px}.od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:16px;margin-bottom:20px}.sm .od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:11px;margin-bottom:15px}.od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:16px;margin-bottom:18px}.lg .od-embed-useModernEmbedPanel .od-embed-imageSize,.md .od-embed-useModernEmbedPanel .od-embed-imageSize,.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-bottom:13px}.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:11px;margin-bottom:8px}.od-embed-useModernEmbedPanel .od-embed-disclaimer{display:inline-block;margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-configurator{font-size:14px}.od-embed-useModernEmbedPanel .od-embed-copyText{margin-top:0;margin-bottom:20px}.sm .od-embed-useModernEmbedPanel .od-embed-copyText{margin-bottom:10px}.od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:20px}.lg .od-embed-useModernEmbedPanel .od-embed-sizePicker,.md .od-embed-useModernEmbedPanel .od-embed-sizePicker,.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:15px}.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:12px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsBox{margin-bottom:20px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsCheckbox{vertical-align:middle}.od-embed-useModernEmbedPanel .od-embed-updateSpinner{visibility:hidden}html[dir=ltr] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:right}html[dir=rtl] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:left}.od-embed-useModernEmbedPanel .od-embed-updateSpinnerOn{visibility:visible}"}])});define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor",["require","exports","tslib","../../../resources/ODCResourceKeys","../../delete/odc/DeleteExecutor","./EmptyRecycleBinHelper"],function(e,t,o,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._usePollGetItemsForDeletion=e.usePollGetItemsForDeletion;t._recycleBinItemDataSource=t.resources.consume(r.recycleBinDataSource);t._emptyRecycleBinHelper=new(t.managed(n.default));return t}e.prototype.execute=function(e){if(this._usePollGetItemsForDeletion){if(!this.currentItem||this._recycleBinItemDataSource.isLargeRecycleBin())return this._emptyRecycleBinHelper.emptyAll();this.selectionHelper.selectAll();return i.prototype.execute.call(this,e)}return this._emptyRecycleBinHelper.emptyAllAsync()};e.prototype.getDeleteExecutionInfo=function(e){var t=i.prototype.getDeleteExecutionInfo.call(this,e);t.emptyRecycleBin=!0;return t};return e}(i.default);t.default=a});define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/leftPane/LeftPane.resx","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer","../../../utilities/selection/SelectionHelper.resx","../../../controls/operation/monitor/OperationMonitor.resx","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../resources/DataSourceResourceKeys","../../../dataSources/url/QueryType"],function(e,t,o,s,l,i,r,n,d,c,p,u,a,h,m,g,f,b,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dialogProvider=t.resources.consume(a.resourceKey);t._recycleBinItemDataSource=t.resources.consume(r.recycleBinDataSource);t._itemProvider=t.resources.consume(n.resourceKey);t._urlDataSource=t.resources.consume(b.url);return t}e.prototype.emptyAllAsync=function(){var t=this;return this._recycleBinItemDataSource.emptyRecycleBinAsync().then(function(){t._invalidateRecycleBinRoot();return{resultType:d.ResultTypeEnum.Success}},function(e){t._invalidateRecycleBinRoot();f.default.log(e);return{resultType:d.ResultTypeEnum.Failure}})};e.prototype.emptyAll=function(){var e=this,t=this.observables.create(0),i=this.observables.create(!1),o=this.createComputed(function(){var e=t();return i()?m.strings.resolveError:0===e?m.strings.resolveDescription:p.format(g.strings.completedDeleteMultipleTitleFormat,e,u.strings.RecycleBin)}),r=this.observables.create(!0),n=this._dialogProvider.requestDialog({title:c.strings.emptyRecycleBin,isDismissable:!1,component:{name:h.default.tagName,params:{text:o}},actions:[{name:c.strings.cancelActionText,execute:function(){return s.default.wrap(3)},isVisible:r,icon:new l.default("Delete"),isDefault:!0},{name:c.strings.ok,execute:function(){return s.default.wrap(3)},isVisible:i,icon:new l.default("Cancel"),isDefault:!0}]}),a=this._recycleBinItemDataSource.emptyRecycleBin(t,!0).then(function(){e._invalidateRecycleBinRoot();n.state(2)},function(){e._invalidateRecycleBinRoot();r(!1);i(!0)});return n.wait().then(null,function(){e._invalidateRecycleBinRoot();a.cancel();return{resultType:d.ResultTypeEnum.ExpectedFailure}})};e.prototype._invalidateRecycleBinRoot=function(){this._itemProvider.invalidateItem(this._urlDataSource.getRootItemKey(y.default.RecycleBin))};return e}(i.default);t.default=v});define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ItemRedeemer","./LaunchMoveCopyPanelHelper"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._isMove=e.isMove;t._selectionHelper=e.selectionHelper;t._itemReedemer=new(t.managed(r.default));t._launchMoveCopyPanelHelper=new(t.managed(n.default));return t}e.prototype.execute=function(){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){return t._launchMoveCopyPanelHelper.launchPanel(e,t._isMove)})})};return e}(i.default);t.default=a});define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../controls/folderSelect/FolderSelect","../../controls/folderTree/FolderTree","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/panel/PanelProvider","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/list/ShortcutUtilities","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../controls/commands/Commands.resx"],function(e,t,o,i,p,u,h,m,r,n,a,s,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(l.url);t._currentItem=t.resources.consume(s.currentItem);t._panelProvider=t.resources.consume(r.resourceKey);t._engagement=t.resources.consume(n.resourceKey);return t}e.prototype.launchPanel=function(e,t){this._logEngagement(e,t);var i=this._currentItem(),o=this.observables.create({items:e,parentKey:i.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:i.isGroup?1:0,isAsync:!1,isMove:t}),r=t?g.strings.moveItemDialogTitle:g.strings.copyItemDialogTitle,n=t?g.strings.moveItemsDialogTitle:g.strings.copyItemsDialogTitle,a=1===e.length?r:n,s=p.isFeatureEnabled(p.MoveCopyFolderSelectionUX),l=s?u.default.tagName:h.default.tagName,d=s?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";d+=t?".Move":".Copy";this._engagement.logData({name:d,extraData:{ItemCount:null!==e?e.length:0}});var c=this._panelProvider.requestPanel({hasCommandBar:!s,scrollMode:s?"hidden":"auto",noTitle:!0,title:a,component:{name:l,params:{context:o,onComplete:function(){c.state(1)},title:a,resources:this.resources}}});return c.wait().then(function(){return{resultType:m.ResultTypeEnum.Success}})};e.prototype._logEngagement=function(e,t){var i=this._engagement,o=e.filter(function(e){return a.default.isShortcutItem(e)}).length;0<o&&(t?i.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:o}}):i.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:o}}))};return e}(i.default);t.default=d});define("odsp-next/controls/folderSelect/FolderSelect",["require","exports","./FolderSelectViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderSelect.html","./FolderSelectContent.html","./FolderSelect.css","../overlays/anchor/AnchorOverlay","../fileNameWithIcon/FileNameWithIcon"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-folder-select",template:e("./FolderSelect.html"),viewModel:i.default,synchronous:!0});o.registerTemplate("od-folder-select-content",e("./FolderSelectContent.html"));t.default=r});define("odsp-next/controls/folderSelect/FolderSelectViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../actions/createFolder/odb/CreateFolderAction","../../resources/DataSourceResourceKeys","../../bindings/element/ElementBinding","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/events/EventGroup","../../utilities/features/Features","../fileTypeIcon/FileTypeIcon","./FolderSelect.resx","../folderTree/FolderTree.resx","../../providers/item/ItemProvider","../inlineCreateFolder/InlineCreateFolder","../infoBar/InfoBar","../../providers/sharing/SharingProvider","../../utilities/sharing/SharingHelper","../../providers/suiteNav/SuiteNavProvider","../../models/item/ItemType","../../models/item/ItemParentHelper","../../dataSources/web/odb/WebDataSource.key","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../bindings/selection/SelectionBinding","../../models/selection/SelectionModel","../siteIcon/SiteIcon","../../bindings/stickyFooter/StickyFooterBinding","@ms/odsp-utilities/lib/math/Point","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../stillSpinning/StillSpinning","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../dataSources/url/QueryType","@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource","../../bindings/dismiss/DismissBinding","../../dataSources/url/odb/ItemUrlHelper","../../bindings/focus/DelayedHasFocusBinding","../../utilities/uri/UriValidator"],function(e,t,i,S,k,o,P,w,C,r,n,I,T,D,L,E,M,A,a,F,s,R,l,O,d,N,B,H,V,z,U,W,q,K,j,G,$,Y,c,Z,Q,X,J,ee,te,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(_){i.__extends(e,_);function e(e){var r=_.call(this,e)||this;r.chooseDestination=T.strings.chooseDestination;r.placesAltText=T.strings.placesAltText;r.stillSpinningTagName=$.default.tagName;r.loadingSpinnerTagName=N.default.tagName;r.siteIconTagName=W.default.tagName;r.fileTypeIconTagName=I.default.tagName;r.inlineCreateFolderTagName=E.default.tagName;r.infoBarTagName=M.default.tagName;r.sharingHintText=T.strings.sharingHintText;r._suiteNavProvider=r.resources.consume(F.resourceKey);var t=r._engagement=r.resources.consume(C.resourceKey);r.isSharingIconFocused=S.observable(!1);r.sharingHintIcon=S.observable(null);r.isSharingHintVisible=S.observable(!1);r.showSharingHintTooltip=S.observable(!1);r._sharingProvider=r.resources.consume(A.resourceKey);r.sharingInfoText=S.observable("");r.titleAccessibilityHint=D.strings.titleAccessibilityHint;r.loading=S.observable(!0);r.loadingOneDrive=S.observable(!0);var i=new V.Qos({name:"MoveCopySelect.LaunchPane"});r.context=e.context;r.itemOne=r._createContentItem();r.itemTwo=r._createContentItem();r._itemOneUsedLast=!1;var o=function(e){e&&r._showSharingInformation(e)};r.subscribe(r.itemOne.item,o);r.subscribe(r.itemTwo.item,o);r.subscribe(r.isSharingIconFocused,function(e){e?r._showSharingHint():r._dismissSharingHint()});r.waitingForItem=S.observable(!1);r.addFolderFocused=S.observable(!1);r.useLocationFocused=S.observable(!1);r.packageTooBig=S.observable(!1);r.newFolderActive=S.observable(!0);r.isSingleItem=r.isFileInfoVisible(r.context.peek().items);r.isSingleItem&&(r.fileItem=r.context.peek().items[0]);r._offset=new K.default(0,0);r.sharingHintOffset=S.observable(r._offset);r.top=S.observable("0px");r.left=S.observable("12px");r.chooseLocationText=r.context().isMove?T.strings.moveButtonLabel:T.strings.copyButtonLabel;r.chooseLocationButtonEnabled=S.observable(!0);r.onComplete=e.onComplete;r.newFolderItem=S.observable(null);r.newFolderItemFocused=S.observable(!1);r.showMinimalPackageWarning=S.observable(!0);r.createComputed(function(){if(r.newFolderItem()){var e=r.getCurrentItem();if(r.newFolderItem().parentKey===r._getParentKey(e)){var t=r._createFolderItem(r.newFolderItem(),e);e.subItems.push(t);t.focused(!0);r.focusedItem(t);r.selectionModel.selectItem(t);r.newFolderItemFocused(!1);r.newFolderItem(null)}else Y.Verbose.logData({name:"FolderSelect.AddFolder.InvalidParent",message:"Tried to add folder but current item is different than the folder that was just created."})}});r._serverDataPromise=new H.default;r.waitingForItemParams={stillWaitingTimeout:4e3,promise:null,showControl:r.waitingForItem};r._breadCrumbItems=S.observableArray([]);r.hasBackToRootButton=S.observable(!1);r.parentBreadCrumbClass=S.observable("");r._isBreadCrumbRootClickable=!0;r.parentFolderName=r.createComputed(function(){var e=r._breadCrumbItems().length;return 1<e?r.unwrapObservable(r._breadCrumbItems()[e-2].title):""});r.currentFolderName=r.createComputed(function(){var e=r._breadCrumbItems().length;return 0<e?r.unwrapObservable(r._breadCrumbItems()[e-1].title):""});1===e.context().items.length?r.moveCopyText=G.format(e.context().isMove?T.strings.moveSingleItem:T.strings.copySingleItem,e.context().items.length):r.moveCopyText=G.format(e.context().isMove?T.strings.moveMultipleItems:T.strings.copyMultipleItems,e.context().items.length);r._urlDataSource=r.resources.consume(P.url);r._itemProvider=r.resources.consume(L.resourceKey);r._actionMap=r.resources.consume(k.actionMap);r._moveCopyDataSource=r.resources.consume(P.copy);r._pageContext=r.resources.consume(j.pageContext);r._itemUrlHelper=r.resources.consume(ee.resourceKey);r._itemParentHelper=r.resources.consume(R.resourceKey);r._sitesTitle=r._getSitesTitle();r.onItemClick=function(e){return r._onItemClick(e)};r.onBreadCrumbParentClick=function(){if(r.isParentBreadCrumbClickable())return r._onBreadCrumbClick(!1)};r.onBreadCrumbRootClick=function(){return r._onBreadCrumbClick(!0)};r.onShowMoreClick=function(e){return r._onShowMoreClick(e)};r.onUseLocationClick=function(e,t){return r._onUseLocationClick(e,t)};r.onKeyEnter=function(e,t){r._onItemClick(e);return!0};r.showSharingHint=function(){return r._showSharingHint()};r.dismissSharingHint=function(){return r._dismissSharingHint()};r.focusedItem=S.observable();r.selectionModel=new U.default;r.addBindingHandlers({selection:z.default,keyboard:O.default,element:w.default,stickyFooter:q.default,dismiss:J.default,delayedHasFocus:te.default});var n=r.context().isMove?T.strings.itemTooBigInfoMove:T.strings.itemTooBigInfo;r.infoBarParams={type:S.observable(1),infoText:S.observable(n)};r.context().isMove?r.packageSizeWarning=1===r.context().items.length?T.strings.itemTooBigMove:T.strings.itemsTooBigMove:r.packageSizeWarning=1===r.context().items.length?T.strings.itemTooBig:T.strings.itemsTooBig;r.stickyFooterElement=S.observable();var a,s,l={title:T.strings.places,key:void 0,focused:S.observable(!1),selected:S.observable(!1),type:3,subItems:null,sections:[{title:r.chooseDestination,altTitle:T.strings.currentSite,items:S.observableArray(),listElement:S.observable(),focusedItem:S.observable(),showMore:S.observable(!1),showMoreInfo:S.observable(""),showMoreError:S.observable(""),showMoreFocused:r.createObservable(!1),showMoreLoading:r.createObservable(!1)}]},d=r.resources.consume(k.currentItem),c=r._getRootItem(d(),"list"),p=r._getRootItem(d(),"subsite");if(c){var u=r._itemUrlHelper.getItemUrlParts(c.key);r._siteAbsoluteUrl=p?r._itemUrlHelper.getItemUrlParts(p.key).fullItemUrl:r._pageContext.webAbsoluteUrl;r._siteTitle=p&&p.name?p.name:r._pageContext.webTitle;r._webId=p&&p.subsite&&p.subsite.id?p.subsite.id:r._pageContext.webId;r._siteId=p&&p.subsite&&p.subsite.itemReference&&p.subsite.itemReference.SiteId?p.subsite.itemReference.SiteId:r._pageContext.siteId;r._listTitle=c.name?c.name:r._pageContext.listTitle;r._siteLogoUrl=p?p.subsite.icon:r._pageContext.webLogoUrl;r._isOneDrive=c.list.templateType===Z.default.mySiteDocumentLibrary;a=r._loadWebDataSource().then(function(e){return e.getMyOneDriveUrl()});var h=!1;r.context().items.forEach(function(e){e.isDocSet&&(h=!0)});r._supportsCrossSite=(r._moveCopyDataSource.getCapabilities().supportsCopyCrossSite&&!r.context().isMove||r._moveCopyDataSource.getCapabilities().supportsMoveCrossSite&&r.context().isMove)&&(!r._pageContext||r._pageContext.isNoScriptEnabled||!1)&&r._pageContext&&r._pageContext.listBaseTemplate!==Z.default.webPageLibrary&&c.list.isDocumentLibrary&&!h&&!ie.isGallatin();var m=function(e,t,i,o){return{title:r._getLocalLibraryTitle(o),key:t,oneDriveItem:e,focused:S.observable(!1),selected:S.observable(!1),type:r._isOneDrive?5:1,siteIcon:null,folderIcon:"folder",subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,listUrl:i,isCrossSite:!1,webId:r._webId,siteId:r._siteId}};(s=r._isOneDrive?a.then(function(e){return m(c,u.fullItemUrl,u.fullListUrl,e)},function(e){return m(c,u.fullItemUrl,u.fullListUrl)}):B.default.wrap(m(c,u.fullItemUrl,u.fullListUrl))).then(function(e){0<l.sections[0].items().length?l.sections[0].items.unshift(e):l.sections[0].items.push(e)});var g=r._isPackageSizeWithinLimit()}if(r._supportsCrossSite&&g){r._initialSitesQos=new V.Qos({name:"MoveCopySelect.GetInitialSites"});r._initialSitesQosDone=!1;var f=new V.Qos({name:"MoveCopySelect.GetMyOneDriveCrossSite"});a.then(function(e){if(null!==e){if(e!==r._siteAbsoluteUrl){var t={title:T.strings.personalOneDriveRootfolder,key:e,focused:S.observable(!1),selected:S.observable(!1),type:5,siteIcon:null,folderIcon:null,subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,isCrossSite:!0};l.sections[0].items.push(t)}f.end({resultType:V.ResultTypeEnum.Success})}else{f.end({resultType:V.ResultTypeEnum.ExpectedFailure});Y.Verbose.logData({name:"MoveCopySelect.GetMyOneDriveCrossSite",message:"User does not have a my site provisioned"})}r.loadingOneDrive(!1)},function(e){f.end({resultType:V.ResultTypeEnum.Failure});r.loadingOneDrive(!1)});var b={title:r._sitesTitle,altTitle:T.strings.frequentSitesAltText,type:3,lastIndex:0,listElement:S.observable(),focusedItem:S.observable(),items:S.observableArray(),showMore:S.observable(!0),showMoreLoading:S.observable(!1),showMoreInfo:S.observable(""),showMoreError:S.observable(""),showMoreFocused:S.observable(!1)};l.sections[1]=b;r._breadCrumbItems.push(l);r._acronymDataSource=new X.AcronymAndColorDataSource(r._pageContext);r._itemProvider.getItemSync({parentKey:r._urlDataSource.getRootItemKey(Q.default.Subsites)});if(r._isOneDrive)r._getInitialSitesData(l.sections[1]);else{var y=new V.Qos({name:"MoveCopySelect.GetCurrentTeamSiteAcronymAndColor"}),v=new V.Qos({name:"MoveCopySelect.GetCurrentTeamSiteDocumentLibraryCount"}),x=[];r._loadWebDataSource().then(function(e){x.push(r._getInitialSitesData(l.sections[1]));x.push(r._getCurrentSiteData(y));x.push(r._getHasMultipleDocumentLibraries(v));B.default.all(x).done(function(e){var t=e[0],i=e[1],o=e[2];if(t){i&&o&&t.unshift(i);t=t.slice(0,8);l.sections[1].items(t);l.sections[1].showMoreLoading(!1)}})})}r._initialLoadSuccess(l,i,!!c)}else if(c){r._breadCrumbItems.push(l);r._isBreadCrumbRootClickable=!1;r.loadingOneDrive(!1);if(!g&&r._supportsCrossSite){t.logData({name:"MoveCopySelect.PackageTooBig",extraData:{numItems:r.context.peek().items.length}});r.packageTooBig(!0)}s.then(function(e){var t=e;r._updateContextWithCurrentItem(t);r._getItemData(r._getParentKey(t),t.webId,t.siteId,function(e){l=t;r._parseFolderItems(e,l);r._breadCrumbItems.push(l);r._initialLoadSuccess(l,i,!0)},function(){r._initialLoadFailure(l,i)})},function(e){r._initialLoadFailure(l,i)})}else{Y.Verbose.logData({name:"MoveCopySelect.LaunchPane",message:"List root item is null"});r.loadingOneDrive(!1);r._initialLoadFailure(l,i)}return r}e.prototype.getStatusText=function(e){if(e&&e.subItems&&0===e.subItems().length)switch(e.type){case 2:case 1:return T.strings.noSubFolders;case 0:return T.strings.noLibraries}return null};e.prototype.isSite=function(e){return!!e&&0===e.type};e.prototype.isRootItem=function(e){return!!e&&3===e.type};e.prototype.isLibraryOrFolder=function(e){return!!e&&(1===e.type||2===e.type)};e.prototype.isLibraryOrFolderOrOneDrive=function(e){return!!e&&(this.isLibraryOrFolder(e)||this.isOneDrive(e))};e.prototype.isOneDrive=function(e){return!!e&&5===e.type};e.prototype.showAddFolder=function(){var e=this.getCurrentItem(),t=e.oneDriveItem,i=this._getRootItem(t,"list");return!(e.remote||!t||!i)&&o.isSpoCreateFolderAvailable(t,i)};e.prototype.showBottomLine=function(e){return!!(e&&e.subItems&&0<e.subItems().length||this.isLibraryOrFolderOrOneDrive(e)&&this.showAddFolder())};e.prototype.getListType=function(e){if(e)return e.title===T.strings.siteCurrentLibrary?G.format(T.strings.currentLibraryFolders,e.title):0===e.type?G.format(T.strings.docLibs,e.title):5===e.type||1===e.type?G.format(T.strings.libraryFolders,e.title):G.format(T.strings.folders,e.title)};e.prototype.getShowMoreText=function(e){return e&&3===e.type?T.strings.browseSites:T.strings.showMore};e.prototype.getShowMoreAccText=function(e){var t=T.strings.browseMoreSites;e&&(0===e.type?t=T.strings.showMoreFollowedSites:1===e.type&&(t=T.strings.showMoreRecentSites));return t};e.prototype.getChooseLocationAccText=function(e){return this.context().isMove?G.format(T.strings.moveButtonAccText,e.title):G.format(T.strings.copyButtonAccText,e.title)};e.prototype.getCurrentItem=function(){return this._itemOneUsedLast?this.itemTwo.item():this.itemOne.item()};e.prototype.isParentBreadCrumbClickable=function(){return 2<this._breadCrumbItems.peek().length||this._isBreadCrumbRootClickable};e.prototype.onInfoBarClick=function(){if(this.showMinimalPackageWarning.peek()){this.infoBarParams.type(0);this.infoBarParams.infoText(this.packageSizeWarning);this.showMinimalPackageWarning(!1)}return!1};e.prototype.isFileInfoVisible=function(e){return 1===e.length};e.prototype._initialLoadSuccess=function(e,t,i){void 0===i&&(i=!1);this._setCurrentItemClass("od-FolderSelect-itemInitial");this.loading(!1);this._setCurrentItem(e,i);t.end({resultType:V.ResultTypeEnum.Success})};e.prototype._initialLoadFailure=function(e,t){e.error=S.observable(T.strings.serverError);this.loading(!1);this._setCurrentItem(e);t.end({resultType:V.ResultTypeEnum.Failure})};e.prototype._getRootItem=function(e,t){var i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return i||null};e.prototype._showSharingHint=function(){this.showSharingHintTooltip(!0);return!1};e.prototype._dismissSharingHint=function(){this.showSharingHintTooltip(!1);return!1};e.prototype._loadWebDataSource=function(){return this.resources.consumeAsync(l.resourceKey)};e.prototype._loadSitesDataSource=function(){return this.resources.consumeAsync(P.sites)};e.prototype._onItemClick=function(a){var s=this,e=this._engagement;a.focused(!1);this._breadCrumbItems.push(a);this._updateBreadcrumb();this._exitCurrentItemLeft();0===a.type?e.logData({name:"MoveCopySelect.SelectSite.Click",isIntentional:!0}):e.logData({name:"MoveCopySelect.SelectLibraryOrFolder.Click",isIntentional:!0});if(null===a.subItems)if(0===a.type||5===a.type&&a.isCrossSite){this.waitingForItemParams.promise=new B.default(function(n,e){s._loadWebDataSource().then(function(t){var e;e=5===a.type?function(e){return t.getDefaultOneDriveLibrary(e)}:function(e){return t.getDocumentLibraries(e)};s._serverDataPromise.debounce(e(a.key)).then(function(e){for(var t=[],i=0;i<e.length;i++){var o={title:e[i].title,key:e[i].target,focused:S.observable(!1),selected:S.observable(!1),listUrl:e[i].customSettingsUrl,type:1,folderIcon:"folder",subItems:null,sections:null,isCrossSite:a.isCrossSite,webId:a.webId,siteId:a.siteId,rootItemType:a.type,remote:e[i].remote};t.push(o)}if(1===t.length){var r=t[0];r.title=a.title;s._breadCrumbItems()[s._breadCrumbItems().length-1]=r;s._getItemWithWaiting(r).then(function(){n()})}else{a.subItems=S.observableArray(t);n();s._enterNextItem(a,!1)}},function(e){s._handleGetItemError(e,a);n()})})});this.waitingForItem(!0)}else 1!==a.type&&2!==a.type&&5!==a.type||this._getItemWithWaiting(a);else{this._serverDataPromise.clear();this._enterNextItem(a,!1)}return!1};e.prototype._onBreadCrumbClick=function(e){var t,i=this._engagement;if(e){i.logData({name:"MoveCopySelect.Breadcrumb.Root.Click",isIntentional:!0});if(this._isBreadCrumbRootClickable){t=this._breadCrumbItems.shift();this._breadCrumbItems([t])}else{var o=this._breadCrumbItems.slice(0,2);t=o[1];this._breadCrumbItems(o)}}else{i.logData({name:"MoveCopySelect.Breadcrumb.Click",isIntentional:!0});this._breadCrumbItems.pop();t=this._breadCrumbItems()[this._breadCrumbItems().length-1]}var r=this.getCurrentItem();r.error&&r.error()&&(r.error=null);this._serverDataPromise.isExecuting()?this._serverDataPromise.clear():this._exitCurrentItemRight();this._updateBreadcrumb();this._enterNextItem(t,!0);return!1};e.prototype._onShowMoreClick=function(t){var i=this,e=this._engagement,o=!1,r=function(){o=!0};if(3===t.type){e.logData({name:"MoveCopySelect.ShowMoreSites.Click",isIntentional:!0});t.showMoreFocused(!1);if(this._sitesFolderItem){this._breadCrumbItems.push(this._sitesFolderItem);this._exitCurrentItemLeft();this._enterNextItem(this._sitesFolderItem,!1)}else{t.showMoreLoading(!0);var n={title:this._sitesTitle,key:void 0,focused:S.observable(!1),selected:S.observable(!1),type:4,subItems:null,sections:[{title:T.strings.followed,altTitle:T.strings.followedSites,type:0,lastIndex:0,listElement:S.observable(),focusedItem:S.observable(),items:S.observableArray(),showMore:S.observable(!0),showMoreLoading:S.observable(!1),showMoreInfo:S.observable(""),showMoreError:S.observable(""),showMoreFocused:S.observable(!1)},{title:T.strings.recent,altTitle:T.strings.recentSites,type:1,lastIndex:0,listElement:S.observable(),focusedItem:S.observable(),items:S.observableArray(),showMore:S.observable(!0),showMoreLoading:S.observable(!1),showMoreInfo:S.observable(""),showMoreError:S.observable(""),showMoreFocused:S.observable(!1)}]},a=new V.Qos({name:"MoveCopySelect.GetFollowedSites"}),s=new V.Qos({name:"MoveCopySelect.GetRecentSites"});this._serverDataPromise.debounce(B.default.all([this._getSitesData(n.sections[0],a,r),this._getSitesData(n.sections[1],s,r)])).done(function(e){if(!o)if(n.sections[0].showMoreError()&&n.sections[1].showMoreError()){t.showMoreError(T.strings.serverError);t.showMore(!1)}else{i._breadCrumbItems.push(n);i._updateBreadcrumb();i._exitCurrentItemLeft();i._sitesFolderItem=n;i._enterNextItem(i._sitesFolderItem,!1)}t.showMoreLoading(!1)})}}else{e.logData({name:"MoveCopySelect.ShowMore.Click",isIntentional:!0,extraData:{Type:t.type}});var l=new V.Qos({name:"MoveCopySelect.ShowMoreSites"});this._serverDataPromise.debounce(this._getSitesData(t,l,r)).then(function(){if(o){t.showMoreLoading(!1);i._exitCurrentItemRight()}else t.listElement().focus()})}return!1};e.prototype._onUseLocationClick=function(e,t){var i=this._engagement;this.chooseLocationButtonEnabled(!1);var o=this.getCurrentItem(),r="MoveCopySelect.ChooseLocation",n=void 0!==o.rootItemType?o.rootItemType:o.type,a={ItemCount:this.context().items.length,FolderCount:this._getFolderCount(this.context().items),FileCount:this._getFileCount(this.context().items)};r+=this.context().isMove?".Move":".Copy";var s=this._getRootItem(o.oneDriveItem,"list");s&&!s.list.isDocumentLibrary&&(r+=".List");o.isCrossSite?r+=".CrossSite.Click":r+=0===n?".WithinSite.Click":".InLibrary.Click";i.logData({name:r,isIntentional:!0,extraData:a});if(o.isCrossSite){var l="MoveCopySelect.ChooseLocation";l+=this.context().isMove?".Move":".Copy";if(0!==n||this._isOneDrive)if(0===n&&this._isOneDrive)l+=".ODBToTeamSite.Click";else if(5!==n||this._isOneDrive)if(5===n&&this._isOneDrive)l+=".ODBToODB.Click";else{l+=".UnknownCrossSite.Click";Y.Verbose.logData({name:"MoveCopySelect.ChooseLocation.UnknownCrossSite.Click",message:"rootItemType: "+n})}else l+=".TeamSiteToODB.Click";else l+=".TeamSiteToTeamSite.Click";i.logData({name:l,isIntentional:!0,extraData:a})}!this._initialSitesQosDone&&this._initialSitesQos&&this._initialSitesQos.end({resultType:V.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:3}});o.webId&&(this.context.peek().webId=o.webId);o.siteId&&(this.context.peek().siteId=o.siteId);var d={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove,isCrossSite:o.isCrossSite};new(this.managed(this._actionMap.MoveCopyAction))(d).execute(t);t.stopPropagation();return!1};e.prototype._getFolderCount=function(e){for(var t=0,i=0;i<e.length;i++)e[i].folder&&t++;return t};e.prototype._getFileCount=function(e){return e.length-this._getFolderCount(e)};e.prototype._getItem=function(e,t,i){var o={parentKey:e,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e),filters:this._getFilters(),sortField:"LinkFilename",isAscending:!0,needSchema:!0,expandGroup:!0,ignoreListContext:!0,webId:t,siteId:i};return this._itemProvider.getItem(o)};e.prototype._getItemData=function(e,t,i,o,r){return this._getItem(e,t,i).then(o,r)};e.prototype._getItemWithWaiting=function(t){var i=this;this.waitingForItemParams.promise=this._serverDataPromise.debounce(this._getItemData(this._getParentKey(t),t.webId,t.siteId,function(e){1!==t.type&&5!==t.type||(t.oneDriveItem=e.item());i._parseFolderItems(e,t);i._enterNextItem(t,!1)},function(e){i._handleGetItemError(e,t)}));this.waitingForItem(!0);return this.waitingForItemParams.promise};e.prototype._handleGetItemError=function(e,t){if(!B.default.isCanceled(e)){e.status?404===e.status&&(t.error=S.observable(T.strings.itemNotFoundError)):0===t.type?t.error=S.observable(T.strings.loadLibrariesFailure):t.error=S.observable(T.strings.loadFoldersFailure);this._setNextItemClass("");this._setNextItem(t)}};e.prototype._parseFolderItems=function(e,t){t.subItems=S.observableArray();for(var i=e.content().items,o=0;o<i.length;o++){var r=i[o]();r.type===s.default.Folder&&t.subItems.push(this._createFolderItem(r,t))}};e.prototype._createFolderItem=function(e,t){return{title:e.name,key:e.id,focused:S.observable(!1),selected:S.observable(!1),listUrl:t.listUrl,oneDriveItem:e,type:2,siteIcon:null,folderIcon:e.iconName,subItems:null,sections:null,isCrossSite:t.isCrossSite,webId:t.webId,siteId:t.siteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type}};e.prototype._createContentItem=function(){var e=S.observable(),t={item:S.observable(),className:S.observable(""),element:e,regionElement:S.observable(),listElement:S.observable(),stickyFooterElement:S.observable(),resizeStickyFooter:S.observable(!1),isActive:S.observable(!1),eventGroup:new r.default(e),isEntering:!1};this.addDisposable(t.eventGroup);return t};e.prototype._addAnimationEvents=function(t,i){var o=this;void 0===i&&(i=!1);var e=function(){if(i||t.isEntering){o._setInitialFocus(t);t.isEntering=!1;var e=t.item.peek();e.subItems&&(0===e.subItems.peek().length?o.useLocationFocused(!0):o.selectionModel.selectItem(e.subItems.peek()[0]))}else t.isActive(!1)};t.element()?function(){if(i)e();else{t.eventGroup.on(t.element(),"transitionEnd",e);t.eventGroup.on(t.element(),"webkitTransitionEnd",e)}}():this.async.setTimeout(function(){o._addAnimationEvents(t,i)},10)};e.prototype._getSitesData=function(o,r,i){o.showMoreLoading(!0);var e,t=function(e){r.end({resultType:V.ResultTypeEnum.Success,extraData:{Length:e.length,Type:o.type}});o.lastIndex+=e.length;0===e.length&&0===o.lastIndex&&(0===o.type?o.showMoreInfo(T.strings.noFollowedSites):o.showMoreInfo(T.strings.loadRecentSitesFailure));for(var t=0;t<e.length;t++){var i={title:e[t].title,key:e[t].serverRelativeUrl,focused:S.observable(!1),selected:S.observable(!1),siteIcon:{iconUrl:e[t].icon,color:e[t].color,acronym:e[t].acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:e[t].itemReference&&e[t].itemReference.WebId,siteId:e[t].itemReference&&e[t].itemReference.SiteId};o.items.push(i)}5!==e.length&&o.showMore(!1);o.showMoreLoading(!1)},n=function(e){if(B.default.isCanceled(e)){r.end({resultType:V.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:o.type}});i&&i()}else{var t=!1;if(0===o.type)o.showMoreError(T.strings.loadFollowedSitesFailure);else if(1===o.type){if(500011===(e.responseData&&e.responseData.ErrorCode)){o.showMoreInfo(T.strings.noGraphRecentSitesFailure);t=!0}else o.showMoreError(T.strings.loadRecentSitesFailure)}else o.showMoreError(T.strings.loadSitesFailure);o.showMoreLoading(!1);t?r.end({resultType:V.ResultTypeEnum.ExpectedFailure,extraData:{Type:o.type}}):r.end({resultType:V.ResultTypeEnum.Failure,extraData:{Type:o.type}});o.showMore(!1)}};switch(o.type){case 0:e=this._loadSitesDataSource().then(function(e){return e.getFollowedSites(o.lastIndex,5).then(t,n)});break;case 1:e=this._loadSitesDataSource().then(function(e){return e.getRecentSites(o.lastIndex,5).then(t,n)});break;default:Y.Verbose.logData({name:"FolderSelect.GetSites.InvalidSectionType",message:"Invalid section type:"+o.type.toString()})}return e};e.prototype._getInitialSitesData=function(p){var u=this;p.showMoreLoading(!0);return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(Q.default.Subsites)}).then(function(e){for(var t=0,i=e.content().groupings[0].itemGroups,o=0;o<i.length;o++)t+=i[o].count;p.lastIndex+=t;if(0===t&&0===p.lastIndex){p.showMoreInfo(T.strings.noFollowedSites);p.showMoreLoading(!1);u._initialSitesQos.end({resultType:V.ResultTypeEnum.Success,extraData:{Length:t,Type:p.type}});u._initialSitesQosDone=!0;return null}for(var r=[],n={},a=0;a<t;a++){var s=u.peekUnwrapObservable(e.content().items[a]),l=u._itemUrlHelper.getItemUrlParts(s.key),d=l.fullItemUrl&&l.fullItemUrl.replace(/\/$/,"");if(u._isOneDrive||d!==u._siteAbsoluteUrl){var c={title:s.name,key:l.fullItemUrl,focused:S.observable(!1),selected:S.observable(!1),siteIcon:{iconUrl:s.subsite.icon,color:s.subsite.color,acronym:s.subsite.acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:s.subsite.id,siteId:s.subsite.itemReference&&s.subsite.itemReference.SiteId};if(!n[l.fullItemUrl]){n[l.fullItemUrl]=!0;r.push(c)}}}if(u._isOneDrive){r=r.slice(0,8);p.items(r);p.showMoreLoading(!1)}u._initialSitesQos.end({resultType:V.ResultTypeEnum.Success,extraData:{Length:t,Type:p.type}});u._initialSitesQosDone=!0;return r},function(e){B.default.isCanceled(e)?u._initialSitesQos.end({resultType:V.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:p.type}}):u._initialSitesQos.end({resultType:V.ResultTypeEnum.Failure,extraData:{Type:p.type}});u._initialSitesQosDone=!0;p.showMoreError(T.strings.loadSitesFailure);p.showMoreLoading(!1);return null})};e.prototype._getCurrentSiteData=function(t){var i={title:this._siteTitle,key:this._siteAbsoluteUrl,focused:S.observable(!1),selected:S.observable(!1),siteIcon:{iconUrl:"_layouts/15/images/siteicon.png"===this._siteLogoUrl?"":this._siteLogoUrl},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!!n.isFeatureEnabled(n.MoveCopyCrossLibraryUsePrime),webId:this._webId,siteId:this._siteId};return this._acronymDataSource.getAcronymData(this._siteTitle).then(function(e){t.end({resultType:V.ResultTypeEnum.Success});i.siteIcon.color=e.color;i.siteIcon.acronym=e.acronym;return i},function(e){t.end({resultType:V.ResultTypeEnum.Failure});return null})};e.prototype._getHasMultipleDocumentLibraries=function(t){var i=this;return this._loadWebDataSource().then(function(e){return e.getDocumentLibraries(i._siteAbsoluteUrl).then(function(e){t.end({resultType:V.ResultTypeEnum.Success});return 1<e.length})},function(e){t.end({resultType:V.ResultTypeEnum.Failure});return!0})};e.prototype._setCurrentItem=function(e,t){void 0===t&&(t=!1);var i;(i=this._itemOneUsedLast?this.itemTwo:this.itemOne).item(e);i.isActive(!0);this._addAnimationEvents(i,t)};e.prototype._setNextItem=function(e){var t,i,o=this;this._updateContextWithCurrentItem(e);if(this._itemOneUsedLast){t=this.itemOne;i=this.itemTwo}else{t=this.itemTwo;i=this.itemOne}this._itemOneUsedLast=!this._itemOneUsedLast;t.item(e);t.isActive(!0);i.isActive(!1);e.error||(t.isEntering=!0);this._addAnimationEvents(t);this.async.setTimeout(function(){o._setElementLeft(t.element(),0)},0)};e.prototype._setNextItemClass=function(e){this._itemOneUsedLast?this.itemOne.className(e):this.itemTwo.className(e)};e.prototype._setCurrentItemClass=function(e){this._itemOneUsedLast?this.itemTwo.className(e):this.itemOne.className(e)};e.prototype._setCurrentItemLeft=function(e){var t,i=(t=this._itemOneUsedLast?this.itemTwo.element():this.itemOne.element()).getBoundingClientRect().width+40;(e&&!d.default.isRightToLeft||!e&&d.default.isRightToLeft)&&(i=-i);this._setElementLeft(t,i)};e.prototype._setElementLeft=function(e,t){d.default.isRightToLeft?e.style.right=t+"px":e.style.left=t+"px"};e.prototype._setInitialFocus=function(e){var t,i=e.item().sections;(t=i&&0<i.length?i[0].listElement():e.listElement())&&t.focus()};e.prototype._exitCurrentItemLeft=function(){this._setCurrentItemLeft(!0)};e.prototype._exitCurrentItemRight=function(){this._setCurrentItemLeft(!1)};e.prototype._enterNextItem=function(e,t){t&&!d.default.isRightToLeft||!t&&d.default.isRightToLeft?this._setNextItemClass("od-FolderSelect-itemEnterLeft"):this._setNextItemClass("od-FolderSelect-itemEnterRight");this._setNextItem(e)};e.prototype._updateBreadcrumb=function(){this.hasBackToRootButton(2<this._breadCrumbItems().length);this.isParentBreadCrumbClickable()?this.parentBreadCrumbClass("od-FolderSelect-clickableCrumb"):this._isBreadCrumbRootClickable||this.parentBreadCrumbClass("")};e.prototype._updateContextWithCurrentItem=function(e){this.context().targetKey=this._getParentKey(e);this.context().targetId=e.key};e.prototype._getLocalLibraryTitle=function(e){var t=this._pageContext.isSiteAdmin&&this._isOneDrive;e&&(t=e===this._siteAbsoluteUrl);return this._isOneDrive?t?T.strings.personalOneDriveRootfolder:G.format(T.strings.oneDriveRootfolder,this._pageContext.webTitle):this._supportsCrossSite?T.strings.siteCurrentLibrary:this._listTitle};e.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};e.prototype._isPackageSizeWithinLimit=function(){if(!this._moveCopyDataSource.getCapabilities().supportsThrottling||n.isFeatureEnabled(n.MoveCopyCrossSiteMaxSizeIncrease))return!0;for(var e=this.context().items.length,t=0,i=0;i<e;i++){var o=this.context().items[i];o.folder||!o.size?t+=o.totalSize:t+=o.size}return t<=524288e3};e.prototype._getParentKey=function(e){var t,i=e.key,o=e.listUrl,r=this._itemUrlHelper.getUrlParts({path:i,listUrl:o});return this._urlDataSource.getKey(((t={}).id=r.serverRelativeItemUrl,t.listurl=r.normalizedListUrl,t))};e.prototype._showSharingInformation=function(i){var o=this;if(i.key)if(i.retrievedSharingPermissions){this.sharingInfoText(i.sharingInfoText);this.isSharingHintVisible(!!i.sharingInfoText)}else{this.isSharingHintVisible(!1);if(i.oneDriveItem){this._sharingProvider.getSharingData(i.oneDriveItem).getPermissions().then(function(e){var t=e[0];i.retrievedSharingPermissions=!0;i.sharingPermissions=t;i.sharingInfoText=a.getSharingStatusText(t,o.peekUnwrapObservable(i.title));o.sharingInfoText(i.sharingInfoText);o.isSharingHintVisible(!!i.sharingInfoText)},function(e){})}}};e.prototype._getSitesTitle=function(){var t=this.createObservable();this.trackPromise(this._suiteNavProvider.loadData().then(function(e){return e.CompanyDisplayName})).done(function(e){t(e)});return this.createPureComputed(function(){return t()||T.strings.sites})};return e}(c.default);t.default=p});define("odsp-next/actions/createFolder/odb/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","@ms/odsp-datasources/lib/Permissions","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/ItemParentHelper"],function(o,e,t,r,i,n,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="CreateFolder";e.item?t._currentItem=e.item:t._currentItem=t.resources.consume(s.currentItem);t._itemParentHelper=t.resources.consume(l.resourceKey);return t}e.prototype.getExecutorPath=function(){return"odsp-next/actions/createFolder/odb/CreateFolderExecutor"};e.prototype.getModuleFactory=function(){return function(){return new r.default(function(e,t){o(["odsp-next/actions/createFolder/odb/CreateFolderExecutor"],e,t)})}};e.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var e=this._currentItem();return c(e,this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")))};return e}(a.default);e.default=d;function c(e,t){return!!e&&e.queryType===i.default.Files&&(!t||t.list.allowCreateFolder&&!t.list.isExternal)&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.insertListItems)}e.isSpoCreateFolderAvailable=c});define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder",["require","exports","./InlineCreateFolderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InlineCreateFolder.html","./InlineCreateFolder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-inline-create-folder",template:e("./InlineCreateFolder.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/inlineCreateFolder/InlineCreateFolderViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../providers/engagement/Engagement","../folderBuilder/FolderBuilder.resx","../../providers/item/ItemProvider","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../loadingSpinner/LoadingSpinner"],function(e,t,i,r,n,a,s,l,d,c,o,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.namePlaceholder=s.strings.FolderNamePlaceholder;t.nameLabel=s.strings.FolderNameLabel;t.createLabel=s.strings.CreateFolderLabel;t.newFolderText=s.strings.NewFolderText;t.loadingSpinnerTagName=p.default.tagName;t.height=(e.height||38).toString()+"px";t.inputHeight=(e.height||32).toString()+"px";t._newFolderItem=e.newFolderItem;t._newItemFocused=e.newItemFocused;t.focused=e.focused;t._item=e.item;t.newFolderName=r.observable("");t.isFolderCreating=r.observable(!1);t.showAddFolderText=r.observable(!0);t.inputFocused=r.observable(!1);t._createActionStatus=r.observable("");t.errorText=r.observable("");t.successText=r.observable("");t.addBindingHandlers({keyboard:d.default});t._itemProvider=t.resources.consume(l.resourceKey);t._actionMap=t.resources.consume(n.actionMap);t._engagement=t.resources.consume(a.resourceKey);if(e.isActive){var i=new(t.managed(t._actionMap.CreateFolderAction))({item:r.observable(t._item)});t.createComputed(function(){e.isActive(i.isAvailable())})}return t}e.prototype.onEnterAddFolder=function(){this._newItemFocused&&this._newItemFocused(!0);this.onClickAddFolder()};e.prototype.onClickAddFolder=function(){this._engagement.logData({name:"InlineCreateFolder.NewFolder.Click",isIntentional:!0});this.showAddFolderText(!1);this.inputFocused(!0)};e.prototype.onExecuteClick=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Click",isIntentional:!0});this.createNewFolder(t)};e.prototype.onEnter=function(e,t){if(0!==this.newFolderName().length){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Enter",isIntentional:!0});this.createNewFolder(t);return!1}};e.prototype.onEscape=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Dismiss",isIntentional:!0});this._resetControl();t.stopPropagation();return!1};e.prototype.createNewFolder=function(e){var r=this;this.isFolderCreating(!0);this.inputFocused(!1);this.errorText("");var t={parentKey:this._item.key},i={status:this._createActionStatus};new(this.managed(this._actionMap.CreateNewFolderAction))({parentItem:this._item,newFolderName:this.newFolderName,options:i}).execute(e).then(function(){if(r._createActionStatus()){r.errorText(r._createActionStatus());r.isFolderCreating(!1)}else{r.successText(c.format(s.strings.CreateFolderSuccess,r.newFolderName.peek()));if(r._newFolderItem)r._itemProvider.getItem(t).then(function(e){for(var t=e.content().items,i=0;i<t.length;i++){var o=t[i]();if(o.displayName===r.newFolderName.peek()){r._resetControl();r._newFolderItem(o);r._itemProvider.invalidateItem(r._item.key)}}});else{r._resetControl();r._newFolderItem()}}});e.stopPropagation();return!1};e.prototype._resetControl=function(){this.showAddFolderText(!0);this.newFolderName("");this.isFolderCreating(!1);this.errorText("");this.focused(!1)};return e}(o.default);t.default=u});define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder.html",[],function(){return'<div class=od-InlineCreateFolder data-bind="attr: { \'aria-label\': newFolderText }, css: {\'is-focused\': focused }, style: { height: height }">\x3c!--ko if: isFolderCreating--\x3e<span class=od-InlineCreateFolder-icon data-bind="component: {name: loadingSpinnerTagName, params: { loadingText: \'\' }}"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: isFolderCreating--\x3e<i class="od-InlineCreateFolder-icon ms-Icon ms-Icon--FabricNewFolder" data-bind="icon: true"></i>\x3c!--/ko--\x3e\x3c!--ko if: showAddFolderText--\x3e<span role=button tabindex=0 class=od-InlineCreateFolder-addFolderText data-bind="text: newFolderText, click: onClickAddFolder, keyboard: { allowInputEvents: true, mappings: { Enter: onEnterAddFolder, Space: onEnterAddFolder } }, hasFocus: focused"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: showAddFolderText--\x3e<input class=od-InlineCreateFolder-textInput type=text data-bind="value: newFolderName, textInput: newFolderName, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter, Esc: onEscape } }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': namePlaceholder, \'aria-busy\': isFolderCreating }, hasFocus: inputFocused, automation: automationId, style: { height: inputHeight }, enable: !isFolderCreating()"> <button class="od-Button od-Button--primary od-InlineCreateFolder-createButton" data-bind="style: { visibility : newFolderName() ? \'\' : \'hidden\' }, click: onExecuteClick, attr: { \'aria-label\': createLabel }, css: { \'is-disabled\': isFolderCreating }"><span class="ms-Icon ms-Icon--CheckMark od-InlineCreateFolder-createButtonIcon" data-bind="icon: true"></span></button>\x3c!--/ko--\x3e</div>\x3c!--ko if: errorText--\x3e<div class=od-InlineCreateFolder-error aria-live=assertive data-bind="text: errorText"></div>\x3c!--/ko--\x3e\x3c!--ko if: successText--\x3e<div class=ms-accessible aria-live=polite data-bind="text: successText"></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}.od-InlineCreateFolder{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:pointer}.od-InlineCreateFolder.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent;background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-InlineCreateFolder.is-focused{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-InlineCreateFolder.is-focused{background:#00c0ff}}.od-InlineCreateFolder.is-focused .od-InlineCreateFolder-addFolderText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-InlineCreateFolder-textInput{-ms-flex-positive:1;flex-grow:1;font-size:14px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent;box-sizing:border-box;min-width:100px}[dir=ltr] .od-InlineCreateFolder-textInput{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-textInput{padding-right:10px}[dir=ltr] .od-InlineCreateFolder-textInput{margin-left:7px}[dir=rtl] .od-InlineCreateFolder-textInput{margin-right:7px}.od-InlineCreateFolder-textInput:focus,.od-InlineCreateFolder-textInput:hover{outline:1px solid transparent;border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-InlineCreateFolder-createButton{display:inline-block;width:32px;min-width:32px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0 0 3px 0}[dir=ltr] .od-InlineCreateFolder-createButton{margin-right:5px}[dir=rtl] .od-InlineCreateFolder-createButton{margin-left:5px}.od-InlineCreateFolder-createButtonIcon{font-size:18px;vertical-align:middle}.od-InlineCreateFolder-addFolderText{-ms-flex-positive:1;flex-grow:1;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";font-size:14px;cursor:pointer;outline:0}[dir=ltr] .od-InlineCreateFolder-addFolderText{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-addFolderText{padding-right:10px}.od-InlineCreateFolder-icon{width:30px;min-width:30px;text-align:center;font-size:16px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";padding-top:2px;position:relative}[dir=ltr] .od-InlineCreateFolder-icon{left:-1px}[dir=rtl] .od-InlineCreateFolder-icon{right:-1px}.od-InlineCreateFolder-icon .od-LoadingSpinner-loadingGif{vertical-align:inherit}.od-InlineCreateFolder-error{font-size:12px;color:#a80000}[dir=ltr] .od-InlineCreateFolder-error{padding-left:38px}[dir=rtl] .od-InlineCreateFolder-error{padding-right:38px}"}])});define("odsp-next/controls/infoBar/InfoBar",["require","exports","./InfoBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InfoBar.html","./InfoBar.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-infoBar",template:e("./InfoBar.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/infoBar/InfoBarViewModel",["require","exports","tslib","../../bindings/html/BindableHtmlBinding","knockout","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,o,r,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.infoText=e.infoText;t.clickHandler=e.clickHandler;t._initInfoBarClasses();t.iconClass=n.observable("");t.infoBarClass=n.observable("");t.createComputed(function(){t.infoBarClass(t._infoBarClasses[e.type()].infoBarClass);t.iconClass(t._infoBarClasses[e.type()].iconClass)});e.linkText&&e.linkUrl;t.addBindingHandlers({bindableHtml:r.default});return t}e.prototype._initInfoBarClasses=function(){this._infoBarClasses=((e={})[0]={iconClass:a.getIconClassName("Info"),infoBarClass:"ms-bgColor-info"},e[1]={iconClass:a.getIconClassName("Info"),infoBarClass:""},e[2]={iconClass:"od-InfoBar-iconPlaceholder",infoBarClass:"ms-bgColor-success"},e[3]={iconClass:a.getIconClassName("Warning")+" ms-fontColor-alert",infoBarClass:"od-InfoBar-alert"},e[4]={iconClass:a.getIconClassName("DRM")+" ms-fontColor-error",infoBarClass:"ms-bgColor-error"},e[5]={iconClass:a.getIconClassName("ErrorBadge")+" ms-fontColor-error",infoBarClass:"ms-bgColor-info"},e);var e};return e}(i.default);t.default=s});define("odsp-next/controls/infoBar/InfoBar.html",[],function(){return'<div class=od-InfoBar data-bind="class: infoBarClass"><i class="od-InfoBar-icon ms-Icon" data-bind="class: iconClass"></i> <span class=od-InfoBar-text data-bind="bindableHtml: infoText"></span></div>'});define("odsp-next/controls/infoBar/InfoBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InfoBar{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:6px 8px 8px 8px;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start}html[dir=rtl] .od-InfoBar{padding:6px 8px 8px 8px}.od-InfoBar-icon{font-size:16px;padding-top:2px}[dir=ltr] .od-InfoBar-icon{padding-left:1px}[dir=rtl] .od-InfoBar-icon{padding-right:1px}.od-InfoBar-iconPlaceholder{width:31px}.od-InfoBar-alert{background-color:#fed9cc}.od-InfoBar-text{font-size:12px}[dir=ltr] .od-InfoBar-text{padding-left:8px}[dir=rtl] .od-InfoBar-text{padding-right:8px}"}])});define("odsp-next/utilities/sharing/SharingHelper",["require","exports","knockout","./SharingHelper.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../controls/confirmation/Confirmation","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","../../controls/sharing/shareByEmail/Sharing.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disableLinkConfirm=function(t,i,e,o){var r=n.observable(!0);return e.requestDialog({title:a.strings.DisableLinkConfirmationTitle,size:"Medium",component:{name:l.default.tagName,params:{message:a.strings.DisableLinkConfirmationMessage}},actions:[{name:a.strings.DisableLinkConfirmationButton,execute:function(){s.Engagement.logData({name:"Confirm.DisableLink."+o+".Click",isIntentional:!0});r(!1);var e=t().then(function(e){return d.default.wrap(e?2:3)});i(e);return e},isDefault:!0,isAvailable:r,icon:new c.default("Save"),automationId:"UnshareConfirm"},{name:a.strings.KeepExistingLinkButton,execute:function(){s.Engagement.logData({name:"KeepExisting.DisableLink."+o+".Click",isIntentional:!0});return d.default.wrap(3)},isDefault:!1,icon:new c.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.getSharingStatusText=function(e,t){for(var i=0,o=0,r=!1,n=0,a=e.people;n<a.length;n++){var s=a[n];if(2===s.entityType)o++;else if(0!==s.sharingInfo.role){i++;1===s.entityType&&(r=!0)}}var l="";0<o&&0<i?l=1<o?u.format(r?p.strings.SharedWithPeopleGroupsAndExternalUsers:p.strings.SharedWithPeopleAndGroups,t,o,i):u.format(r?p.strings.SharedWithPeopleGroupAndExternalUsers:p.strings.SharedWithPeopleAndGroup,t,i):1===o?l=u.format(p.strings.SharedWithGroup,t):1<o?l=u.format(p.strings.SharedWithGroups,t,o):0<i&&r?l=u.format(p.strings.SharedWithPeopleAndExternalUsers,t,i):1<i?l=u.format(p.strings.SharedWithPeople,t,i):1===i&&(l=u.format(p.strings.SharedWithPerson,t));return l};t.getNumberOfDaysUntilExpiry=function(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)}});define("odsp-next/controls/confirmation/Confirmation",["require","exports","./ConfirmationViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Confirmation.html","./Confirmation.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-confirmation",template:e("./Confirmation.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/confirmation/ConfirmationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.message=e.message;return t}return e}(i.default);t.default=r});define("odsp-next/controls/confirmation/Confirmation.html",[],function(){return'<div class=od-Confirmation><p class=od-Confirmation-message data-bind="text: message"></p></div>'});define("odsp-next/controls/confirmation/Confirmation.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400}"}])});define("odsp-next/dataSources/web/odb/WebDataSource.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./WebDataSource",getModule:function(){return new t.default(function(e,t){i(["./WebDataSource"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("odsp-next/bindings/stickyFooter/StickyFooterBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=r.unwrap(t.valueAccessor());t._scrollContainer=i.scrollableElement();t._forceResize=i.forceResize;t._forceResize(!1);t.events.on(window,"resize",t._sizeContainer);t.subscribe(t._forceResize,t._forceResizeContainer);t._sizeContainer();return t}e.prototype._forceResizeContainer=function(){if(this._forceResize()){this._sizeContainer();this._forceResize(!1)}};e.prototype._sizeContainer=function(){var e=window.innerHeight,t=this._scrollContainer.getBoundingClientRect(),i=this.element.offsetHeight,o=e-t.top-i;this._scrollContainer.style.maxHeight=o.toString()+"px"};return e}(o.default);t.default=n});define("odsp-next/controls/stillSpinning/StillSpinning",["require","exports","./StillSpinningViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./StillSpinning.html","./StillSpinning.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-stillSpinning",template:e("./StillSpinning.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/stillSpinning/StillSpinningViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./StillSpinning.resx","../../bindings/css/VisibilityBinding","../progressSpinnerFlat/ProgressSpinnerFlat","../../controls/loadingSpinner/LoadingSpinner"],function(r,e,t,n,i,a,s,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){t.__extends(o,i);function o(e){var t=i.call(this,e)||this;t.addBindingHandlers({visibility:s.default});t.params=e;t.resx=a.strings;t.showControl=t.params.showControl||n.observable(!0);t.showSpinner=n.observable(!1);t.showStillWaiting=n.observable(!1);t.showError=n.observable(!1);t.errorImgUrl="undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/sitehub/error_icecream.png"):r("@ms/odsp-media/dist/media/images/siteHub/error_icecream.png");t.spinnerTagName=0===t.params.spinnerType?d.default.tagName:l.default.tagName;t.spinnerParams=0===t.params.spinnerType?{loadingText:""}:{};t._spinnerTimeoutId=t.async.setTimeout(function(){t.showSpinner(!0);var e=t.params.stillWaitingTimeout;e?t._stillWaitingTimeoutId=t.async.setTimeout(function(){t.showStillWaiting(!0);t._startErrorTimeout()},e):t._startErrorTimeout()},t.params.spinnerTimeout||o.SPINNER_TIMEOUT);t.params.promise.then(function(e){t.showControl(!1);t._clearDataSourceTimeouts()},function(e){t.showSpinner(!1);t.showStillWaiting(!1);t.showError(!0);t._clearDataSourceTimeouts()});return t}o.prototype._startErrorTimeout=function(){var e=this;this.params.errorTimeout&&(this._errorTimeoutId=this.async.setTimeout(function(){e.showSpinner(!1);e.showStillWaiting(!1);e.showError(!0)},this.params.errorTimeout))};o.prototype._clearDataSourceTimeouts=function(){this._spinnerTimeoutId&&this.async.clearTimeout(this._spinnerTimeoutId);this._stillWaitingTimeoutId&&this.async.clearTimeout(this._stillWaitingTimeoutId);this._errorTimeoutId&&this.async.clearTimeout(this._errorTimeoutId)};o.SPINNER_TIMEOUT=1e3;return o}(i.default);e.default=o});define("odsp-next/controls/stillSpinning/StillSpinning.html",[],function(){return'<div data-bind="if: showControl()"><div data-bind="component: {name: spinnerTagName, params: spinnerParams }, visibility: showSpinner()"></div>\x3c!--ko if: showStillWaiting()--\x3e<div class=od-StillSpinning-text aria-live=polite data-bind="text: resx.StillWaiting"></div>\x3c!--/ko--\x3e\x3c!--ko if: showError()--\x3e<div class=od-StillSpinning-error><img class=od-StillSpinning-imgError role=presentation data-bind="attr: {src: errorImgUrl}"><div class="ms-fontWeight-semibold ms-font-l ms-fontColor-neutralSecondary" data-bind="text: resx.Error"></div><div class="ms-font-s ms-fontColor-neutralSecondary" data-bind="text: resx.Refresh"></div></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/stillSpinning/StillSpinning.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-StillSpinning-text{text-align:center;padding-top:10px}.od-StillSpinning-error{text-align:center}.od-StillSpinning-imgError{padding-bottom:10px}"}])});define("@ms/odsp-utilities/lib/logging/events/Verbose.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/Verbose.event","@ms/telemetry-manager/lib/events/Verbose.event"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.Verbose});define("@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.customGrid=120]="customGrid";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.promotedLinks=170]="promotedLinks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary";e[e.publishingPageLibrary=850]="publishingPageLibrary";e[e.publishingAsset=851]="publishingAsset";e[e.issueTracking=1100]="issueTracking"}(i=t.ListTemplateType||(t.ListTemplateType={}));var o=[i.mySiteDocumentLibrary,i.documentLibrary,i.pictureLibrary,i.xmlFormLibrary,i.webPageLibrary,i.publishingPageLibrary,i.publishingAsset];t.isDocumentLibrary=function(e){var t=Number(e);return-1!==o.indexOf(t)};t.isGenericList=function(e){return e===i.genericList||e===i.announcements||e===i.issueTracking||e===i.contacts};t.isPromotedLinksList=function(e){return Number(e)===i.promotedLinks};t.default=i});define("@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource",["require","exports","tslib","../../interfaces/ISpPageContext","../base/CachedDataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,i,o,r,t,n,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s;!function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed"}(i.PersonaInitialsColor||(i.PersonaInitialsColor={}));i.COLOR_SERVICE_POSSIBLE_COLORS=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"];s||(s={});var l=function(t){o.__extends(e,t);function e(e){return t.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors",cacheTimeoutTime:864e5},{pageContext:e})||this}e.decodeAcronymColor=function(e){return i.COLOR_SERVICE_POSSIBLE_COLORS.indexOf(e)+1};e.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0}})};e.prototype.getAcronyms=function(t){var i=this;return this._pageContext.webServerRelativeUrl?this.getDataUtilizingCache({getUrl:function(){var e=t.map(function(e){return"{Text: "+a.default.encodeURIComponent('"'+e+'"')+"}"}).join(",");return r.getSafeWebServerRelativeUrl(i._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+e+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color}})},qosName:"GetSiteHeaderLogoAcronym"}):n.default.reject(new Error("No web URL specified for request."))};return e}(t.CachedDataSource);i.AcronymAndColorDataSource=l;i.default=l});define("@ms/odsp-datasources/lib/dataSources/base/CachedDataSource",["require","exports","tslib","./DataSource","./RequestCache"],function(e,t,b,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(c){b.__extends(e,c);function e(e,t){var i=c.call(this,e,t)||this,o=e.id,r=e.cacheIdPrefix,n=e.cacheTimeoutTime,a=e.cacheType,s=t.pageContext,l=t.requestCacheType,d=void 0===l?function(t){b.__extends(e,t);function e(e){return t.call(this,e,{cacheIdPrefix:r||void 0,pageContext:s})||this}return e}(p.RequestCache):l;i._requestCache=new d({id:o,cacheTimeoutTime:n||void 0,cacheType:a});return i}e.prototype.getDataUtilizingCache=function(e){var t=this,i=e,o=i.getUrl,r=i.getAdditionalPostData,n=i.cacheRequestKey,a=i.useStale,s=void 0!==a&&a,l=i.bypassCache,d=void 0!==l&&l,c=i.onlyCache,p=void 0!==c&&c,u=i.checkForInvalidation,h=void 0!==u&&u,m=i.setInvalidated,g=void 0!==m&&m,f=b.__rest(i,["getUrl","getAdditionalPostData","cacheRequestKey","useStale","bypassCache","onlyCache","checkForInvalidation","setInvalidated"]);(f=b.__assign({url:o&&o(),additionalPostData:r&&r(),method:"POST"},f)).url=f.url||o&&o();"needsRequestDigest"in f||(f.needsRequestDigest=this.needsRequestDigest(f.url));f.additionalPostData=f.additionalPostData||r&&r();n=n||this.getRequestKey(f.url,f.method,f.additionalPostData);return this._requestCache.getDataUtilizingCache({cacheRequestKey:n,useStale:s,bypassCache:d,onlyCache:p,checkForInvalidation:h,setInvalidated:g,getData:function(){return t.dataRequestor.getData(f)}})};e.prototype.isCachedDataInvalidated=function(e){return this._requestCache.isCachedDataInvalidated(e)};e.prototype.getRequestKey=function(e,t,i){return this._requestCache.getRequestKey(e,t,i)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._requestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._requestCache.cacheVersionId},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){this._requestCache.flushCache(e)};return e}(i.default);t.CachedDataSource=o;t.default=o});define("@ms/odsp-datasources/lib/dataSources/base/RequestCache",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,g,c,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=e.id,o=e.cacheType,r=void 0===o?f.default.session:o,n=e.cacheTimeoutTime,a=void 0===n?3e5:n,s=t.cacheIdPrefix,l=void 0===s?"odsp-ds-":s,d=t.pageContext;this._cacheTimeoutTime=a;this._id=i;this._version=d?d.siteClientTag+"_"+d.userDisplayName:"";this._store=new c.default(l,r);this._storeDefaultCacheType=r;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var i=this,o=e.cacheRequestKey,t=e.useStale,r=void 0!==t&&t,n=e.bypassCache,a=void 0!==n&&n,s=e.onlyCache,l=void 0!==s&&s,d=e.checkForInvalidation,c=e.setInvalidated,p=e.getData,u=this._cache,h=u[o];if(l)return h?g.default.resolve(h._value):g.default.resolve(void 0);d=d&&!a&&this._storeDefaultCacheType!==f.default.local;var m=h&&this._isCacheExpired(h,o,d);return a||!h||m&&!r?p().then(function(e){var t=(new Date).valueOf();u[o]={_fetched:t,_value:e};c&&i._store.setValue(o,t-1,f.default.local);i._updateCache();return e}):g.default.resolve(h._value)};e.prototype.getRequestKey=function(e,t,i){var o=[];o.push(e);o.push(t);i&&o.push(i.toString());return o.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){delete this._cache[e];this._updateCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,i){if(i&&this._isCachedDataInvalidated(e,t))return!0;var o=(new Date).valueOf()-this._cacheTimeoutTime;return e._fetched<=o};e.prototype._isCachedDataInvalidated=function(e,t){var i=Number(this._store.getValue(t,f.default.local));return!!(e&&i&&e._fetched<i)};return e}();t.RequestCache=i;t.default=i});define("odsp-next/dataSources/url/odb/ItemUrlHelper",["require","exports","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUrlHelper=o.ItemUrlHelper;t.SiteRelation=o.SiteRelation;t.resourceKey=r.createResolvedResourceKey(e("module").id,o.ItemUrlHelper,{pageContext:i.pageContext});t.default=o.ItemUrlHelper});define("@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper",["require","exports","tslib","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/string/StringHelper","./ItemUrlHelperBasic","@ms/odsp-utilities/lib/navigation/AddressParser","./ItemUrlHelperBasic"],function(e,t,i,n,a,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);var l;!function(e){e[e.sameSite=0]="sameSite";e[e.crossSite=1]="crossSite";e[e.unknown=2]="unknown"}(l=t.SiteRelation||(t.SiteRelation={}));var d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!0,configurable:!0});t.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!a.equalsCaseInsensitive(new n.default(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};t.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),i=!a.equalsCaseInsensitive(e,t);this._getIsCrossList=function(){return i};return i};t.prototype._getSiteRelation=function(){var e=l.unknown;if(this._getIsCrossDomain())e=l.crossSite;else if(void 0!==this.webUrl)e=a.equalsCaseInsensitive(s.removeDelimiter(this.defaultFullWebUrl),s.removeDelimiter(this._getFullWebUrl()))?l.sameSite:l.crossSite;else{var t=new n.default(this.defaultFullWebUrl).path,i=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==i)if(s.startsWith(s.appendDelimiter(i),s.appendDelimiter(t))){var o=new n.default(s.removeDelimiter(i)),r=new n.default(s.removeDelimiter(t));e=o.segments.length-1===r.segments.length||o.segments.length-2===r.segments.length&&"Lists"===o.segments[o.segments.length-2]?l.sameSite:l.unknown}else e=l.crossSite}this._getSiteRelation=function(){return e};return e};t.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),i=this._getServerRelativeWebUrl();void 0!==i&&(e=""+t+i);this._getFullWebUrl=function(){return e};return e};return t}(s.ItemUrlPartsBasic);t.ItemUrlParts=d;var c=function(r){i.__extends(e,r);function e(e,t){var i=t.itemUrlPartsType,o=void 0===i?d:i;return r.call(this,{context:t.pageContext,itemUrlPartsType:o})||this}e.prototype.getUrlParts=function(e){return r.prototype.getUrlParts.call(this,e)};e.prototype.getItemUrlParts=function(e){var t=o.deserializeQuery(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})};return e}(s.ItemUrlHelperBasic);t.ItemUrlHelper=c});define("@ms/odsp-datasources/lib/utilities/url/ItemUrlHelperBasic",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=e.defaultFullWebUrl,i=e.defaultListUrl,o=e.options,r=void 0===o?{}:o,n=r.path,a=void 0===n?void 0:n,s=r.listUrl,l=void 0===s?void 0:s,d=r.webUrl,c=void 0===d?void 0:d,p=r.mayInferListUrl,u=void 0!==p&&p;this.defaultFullWebUrl=h(t);this.defaultListUrl=h(i);this.path=h(a);this.listUrl=h(l);this.webUrl=h(c);this.mayInferListUrl=u}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return i(this._getServerRelativeItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return i(this._getServerRelativeListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return i(this._getNormalizedListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return i(this._getNormalizedItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!0,configurable:!0});e.prototype._getCurrentAuthority=function(){var e=new s.default(this.defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var i=new s.default(t);e=o.equalsCaseInsensitive(i.authority,this._getCurrentAuthority())?i.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),i=this._getDefaultListUrl();void 0===t||o.equalsCaseInsensitive(t,i)||(e=o.equalsCaseInsensitive(new s.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this.path&&new s.default(this.path).authority||this.listUrl&&new s.default(this.listUrl).authority||this.webUrl&&new s.default(this.webUrl).authority||this.defaultListUrl&&new s.default(this.defaultListUrl).authority||new s.default(this.defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new s.default(this.listUrl).path;else{var t=this._getDefaultListUrl(),i=this.mayInferListUrl;if(void 0!==t||i){var o=this._getServerRelativePath(),r=new s.default(t).path;if(void 0===o&&(void 0===this.webUrl||r&&d(l(r),l(this._getServerRelativeWebUrl())))||r&&d(l(o),l(r)))e=r;else if(void 0!==o&&(""===this.defaultListUrl||i)){var n=this._getServerRelativeWebUrl();if(d(l(o),l(n))){var a=new s.default(o).segments[new s.default(n).segments.length];e=""+l(n)+a}}}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),i=this._getServerRelativeListUrl();void 0!==i&&(e=""+t+i);return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),i=this._getServerRelativeItemUrl();void 0!==i&&(e=""+t+i);this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new s.default(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new s.default(this.defaultFullWebUrl).path);else{var i=new s.default(t);e=""+i.segments.slice(0,-1).join("/")}this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativePath=function(){var e;void 0!==this.path&&(e=new s.default(this.path).path);this._getServerRelativePath=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;this.path?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl());this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,i=this._getServerRelativePath(),o=this._getServerRelativeListUrl();void 0!==this.path&&void 0!==o&&d(l(i),t=l(o))&&(e=i&&i.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,i=this._getServerRelativePath(),o=this._getServerRelativeWebUrl();void 0!==this.path&&void 0!==o&&d(l(i),t=l(o))&&(e=i&&i.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this.defaultListUrl&&(e=new s.default(this.defaultListUrl).authority?this.defaultListUrl:""+this._getCurrentAuthority()+this.defaultListUrl);this._getDefaultListUrl=function(){return e};return e};return e}();t.ItemUrlPartsBasic=r;function i(e){return""===e?"/":e}function h(e){return"/"===e?"/":e}t.removeDelimiter=function(e){void 0===e&&(e="");return"/"===e[e.length-1]?e.substring(0,e.length-1):e};function l(e){void 0===e&&(e="");return"/"===e[e.length-1]?e:e+"/"}t.appendDelimiter=l;function d(e,t){var i=e.toUpperCase(),o=t&&t.toUpperCase();return i.substring(0,o&&o.length||0)===o}t.startsWith=d;var n=function(){function e(e){var t=e.context,i=e.itemUrlPartsType,o=void 0===i?r:i;this.itemUrlPartsType=o;this.itemUrlContext=t}e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,i=t.webAbsoluteUrl,o=t.listUrl;return new this.itemUrlPartsType({defaultFullWebUrl:i,defaultListUrl:o,options:e})};return e}();t.ItemUrlHelperBasic=n});define("odsp-next/controls/folderSelect/FolderSelect.html",[],function(){return'<div class=od-FolderSelect-panel><div class=od-FolderSelect-region><div class=od-FolderSelect-title data-bind="text: moveCopyText"></div><div class=ms-accessible data-bind="text: titleAccessibilityHint"></div><div class=od-FolderSelect-title-fileInfo>\x3c!--ko if: isSingleItem--\x3e\x3c!--ko component: { name: \'ms-fileName-with-icon\', params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: packageTooBig--\x3e<div class=od-FolderSelect-infoBar data-bind="css: { \'od-FolderSelect-infoBarClickable\': showMinimalPackageWarning }, component: {name: infoBarTagName, params: infoBarParams}, click: onInfoBarClick"></div><div class=ms-accessible aria-live=polite data-bind="text: packageSizeWarning"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-breadCrumbContainer><span class="od-FolderSelect-breadCrumbRootIcon od-FolderSelect-clickableCrumb" role=button data-bind="click: onBreadCrumbRootClick, keyboard: { mappings: { Enter: onBreadCrumbRootClick, Space: onBreadCrumbRootClick } }, style: { display: hasBackToRootButton() ? \'\' : \'none\' }, attr: { title: placesAltText, tabindex: hasBackToRootButton() ? 0 : -1 , \'aria-label\': placesAltText }"><i class="ms-Icon ms-Icon--DoubleChevronLeft" data-bind="icon: true"></i></span> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semilight" role=button data-bind="text: parentFolderName, class: parentBreadCrumbClass, click: onBreadCrumbParentClick, keyboard: { mappings: { Enter: onBreadCrumbParentClick, Space: onBreadCrumbParentClick } }, style: { display: parentFolderName() ? \'\' : \'none\' }, attr: { title: parentFolderName, tabindex: isParentBreadCrumbClickable() ? 0 : -1 , \'aria-label\': parentFolderName}"></span> <i class="od-FolderSelect-breadCrumbIcon ms-Icon ms-Icon--ChevronRight" data-bind="style: {display: parentFolderName() ? \'\' : \'none\'}" aria-hidden=true></i> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semibold" data-bind="text: currentFolderName, attr: { title: currentFolderName }"></span></div><div class=od-FolderSelect-ruledLine aria-hidden=true></div>\x3c!--ko if:loading--\x3e<div class=od-FolderSelect-loading data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e\x3c!--ko if: itemOne.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemOne, afterRender: itemOne.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--ko if: itemTwo.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemTwo, afterRender: itemTwo.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: waitingForItem--\x3e<div class=od-FolderSelect-waitingForData data-bind="component: {name: stillSpinningTagName, params: waitingForItemParams}"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/folderSelect/FolderSelectContent.html",[],function(){return'<div class=od-FolderSelect-itemAnimation data-bind="class: className, element: element">\x3c!--ko if: item().error--\x3e<div class="od-folderSelect-itemError od-folderSelect-itemErrorPadding" aria-live=assertive data-bind="text: item().error"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: item().error--\x3e\x3c!--ko if: item().sections--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement"><div class=od-FolderSelect-sectionContainer data-bind="foreach: item().sections">\x3c!--ko if: title--\x3e<div class=od-FolderSelect-sectionHeader data-bind="text: title"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-itemsContainer tabindex=0 role=list data-bind="foreach: items, element: listElement, attr: { tabindex: focusedItem() ? -1 : 0, \'aria-label\': altTitle }, selection: { data: items, mode: \'single\', direction: \'vertical\', focused: focusedItem, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }"><div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused }, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title }, hasFocus: focused"><i role=presentation class="ms-Icon ms-Icon--OneDrive" data-bind="icon: true, style: {display: $component.isOneDrive($data) ? \'\' : \'none\'}"></i>\x3c!--ko if: $component.isSite($data)--\x3e<span class=od-FolderSelect-siteIcon data-bind="component: { name: $component.siteIconTagName, params: siteIcon }"></span>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolder($data)--\x3e<span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span>\x3c!--/ko--\x3e<span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--ko if: showMoreInfo--\x3e<div class=od-folderSelect-itemInfo aria-live=polite data-bind="text: showMoreInfo"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreError--\x3e<div class=od-folderSelect-itemError aria-live=assertive data-bind="text: showMoreError"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMore--\x3e<div>\x3c!--ko ifnot: showMoreLoading()--\x3e<div class=od-FolderSelect-itemWrapper><a class="od-FolderSelect-showMore od-folderSelect-showMoreExtra od-FolderSelect-clickable" role=button tabindex=0 data-bind="click: $component.onShowMoreClick.bind($data), keyboard: { mappings: { Enter: $component.onShowMoreClick.bind($data), Space: $component.onShowMoreClick.bind($data) }}, css: {\'is-focused\': showMoreFocused }, attr: { \'aria-label\': $component.getShowMoreAccText($data) }, hasFocus: showMoreFocused, text: $component.getShowMoreText($data), automationType: \'FolderSelectShowMoreSites\'"></a></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreLoading--\x3e<div class=od-FolderSelect-showMoreLoading aria-busy=true data-bind="component: {name: $component.loadingSpinnerTagName, params: { loadingText: \'\' }}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: item().subItems--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement">\x3c!--ko if: item().subItems().length > 0--\x3e<div class=od-FolderSelect-itemsContainer role=list data-bind="foreach: item().subItems, element: listElement, selection: { data: item().subItems, mode: \'single\', direction: \'vertical\', focused: $component.focusedItem, selectionModel: $component.selectionModel, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }, attr: { \'aria-label\': $component.getListType(item()), tabindex: $component.selectionModel.selection().length > 0 ? -1 : 0, }, css: { \'od-FolderSelect-addBottomMargin\' : !$component.showAddFolder() }">\x3c!--ko if: $index() === 0--\x3e<div class=od-FolderSelect-destinationHeader data-bind="text: $component.chooseDestination"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused, \'is-selected\': selected}, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title}, hasFocus: focused"><span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span> <span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.showAddFolder()--\x3e<div class=od-FolderSelect-addFolder data-bind="css: { \'od-FolderSelect-addTopMargin\' : item().subItems().length === 0 }"><div class=od-FolderSelect-itemWrapper data-bind="css: { \'od-FolderSelect-hidden\': !$component.newFolderActive() }"><div class="od-FolderSelect-addFolderContainer od-FolderSelect-clickable" data-bind="component: { name: $component.inlineCreateFolderTagName, params: { item: $component.getCurrentItem().oneDriveItem, newFolderItem: $component.newFolderItem, focused: $component.addFolderFocused, newItemFocused: $component.newFolderItemFocused, isActive: $component.newFolderActive }}"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-FolderSelect-stickyFooter data-bind="stickyFooter: { scrollableElement: regionElement, forceResize: resizeStickyFooter }">\x3c!--ko if: $component.showBottomLine(item())--\x3e<div class=od-FolderSelect-ruledLine role=separator aria-hidden=true></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.getStatusText(item())--\x3e<div class=od-FolderSelect-statusLabel><span role=status data-bind="text: $component.getStatusText(item())"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolderOrOneDrive(item())--\x3e<div class=od-FolderSelect-actionContainer><button class="od-Button od-Button--primary" data-bind="click: $component.onUseLocationClick, enable: $component.chooseLocationButtonEnabled, automationType: \'FolderSelectUseLocation\', delayedHasFocus: $component.useLocationFocused, attr: { \'aria-label\': $component.getChooseLocationAccText(item()) }"><span class=od-Button-label data-bind="text: $component.chooseLocationText"></span></button>\x3c!--ko if: $component.isSharingHintVisible()--\x3e<button class=od-FolderSelect-sharingHint data-bind="click: $component.showSharingHint, event: { mouseover: $component.showSharingHint, mouseout: $component.dismissSharingHint }, element: $component.sharingHintIcon, hasFocus: $component.isSharingIconFocused, attr: { \'aria-label\': $component.sharingInfoText }">\x3c!--ko if: $component.showSharingHintTooltip()--\x3e<div class=od-FolderSelect-sharingHintTooltip><div data-bind="component: { name: \'ms-anchor-overlay\', params: { anchorElement: $component.sharingHintIcon, alignment: \'BottomRight\', allowMenuNudging: false, hasExplicitAlignment: true, isBeakVisible: ko.observable(true), offset: $component.sharingHintOffset, top: $component.top, left: $component.left }}"><div class=od-FolderSelect-sharingInfoText data-bind="text: $component.sharingInfoText"></div></div></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-sharingHintIcon ms-Icon ms-Icon--People" data-bind="icon: true"></div></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/folderSelect/FolderSelect.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}"}])});define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon",["require","exports","./FileNameWithIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FileNameWithIcon.html","./FileNameWithIcon.css","../fileTypeIcon/FileTypeIcon"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-fileName-with-icon",template:e("./FileNameWithIcon.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/fileNameWithIcon/FileNameWithIconViewModel",["require","exports","tslib","../fieldRender/iconField/IconFieldViewModel","@ms/odsp-shared/lib/base/ViewModel","../fileTypeIcon/FileTypeIcon","../../dataSources/base/AriaHelper"],function(e,t,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.oneDriveItem;t.fileName=i.name;t.fileTypeIconTagName=a.default.tagName;var o=t.createObservable(i);t.fileTypeIconParams={iconName:i.iconName,iconUrl:i.iconUrl,extension:i.extension,desiredSize:16,overlayType:n.default.getOverlayType(o),iconFieldAriaLabel:s.getIconFieldAriaLabelForItem(i)||"",hoverText:n.default.getHoverText(o)};return t}return e}(o.default);t.default=r});define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon.html",[],function(){return'<span><span class=od-FileNameWithIcon-icon data-bind="component: { name: fileTypeIconTagName, params: fileTypeIconParams }"></span> <span class=od-FileNameWithIcon-fileName data-bind="text: fileName"></span></span>'});define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FileNameWithIcon-fileName{vertical-align:bottom}[dir=ltr] .od-FileNameWithIcon-fileName{padding-left:3px}[dir=rtl] .od-FileNameWithIcon-fileName{padding-right:3px}.od-FileNameWithIcon-icon .FileTypeIcon{width:20px;height:20px}"}])});define("odsp-next/controls/folderTree/FolderTree",["require","exports","./FolderTreeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderTree.html","./FolderTreeRow.html","../inlineFolderBuilder/InlineFolderBuilder","./FolderTree.css","../fileTypeIcon/FileTypeIcon"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-folder-tree",template:e("./FolderTree.html"),viewModel:i.default,synchronous:!0});o.registerTemplate("od-folder-tree-row",e("./FolderTreeRow.html"));t.default=r});define("odsp-next/controls/folderTree/FolderTreeViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../providers/item/ItemProvider","./FolderTreeUtility","../../bindings/selection/SelectionBinding","../../bindings/keyboard/KeyboardBinding","../../models/selection/SelectionModel","../../resources/DataSourceResourceKeys","./FolderTreeCommandSet","@ms/odsp-utilities/lib/async/Promise","./FolderTree.resx","../../dataSources/url/QueryType","../../providers/sharing/SharingProvider","../../models/item/IItemTypeFilter","../../utilities/features/Features","../../utilities/sharing/SharingHelper","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../loadingSpinner/LoadingSpinner","../../bindings/focus/DelayedHasFocusBinding","../commandBar/CommandBar.key","../../bindings/component/ControlBinding"],function(r,e,t,n,i,a,s,l,d,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P,w,C){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._folderTreeWidth=260;t._folderTreeIndent=20;t.loadingSpinnerTagName=k.default.tagName;t.context=e.context;t.onComplete=e.onComplete;t.title=e.title;t.dataUpdated=n.observable(!1);t.isDisabled=n.observable(!1);t.isNewFolderDisabled=n.observable(!1);t.hasData=n.observable(!1);t.height=document.body.clientHeight+"px";t._platform=t.resources.consume(S.platformDetection);t.isMobile=t._platform.isMobile;t.rootFolderItem=n.observable();t.sharedFolderItem=n.observable();t.focusedItem=n.observable();t.selectedItems=n.observableArray();t.selectionModel=new p.default;t.itemArrayForSelection=n.observableArray();t.isRtl=_.default.isRightToLeft;t.loadingImageUrl="undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/loading/loadingspinner.gif"):r("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");t._urlDataSource=t.resources.consume(u.url);t._moveCopyDataSource=t.resources.consume(u.copy);t.newFolderName=n.observable("");t.needsRefocus=n.observable(!1);t.loadingText=g.strings.loadingText;t.addBindingHandlers({selection:d.default,delayedHasFocus:P.default,control:C.default,keyboard:c.default});t.keyboardOptions=[{target:null,useRtlMappings:!0,mappings:{Down:t.keyDown,Up:t.keyUp,Left:t.keyLeft,Right:t.keyRight,Enter:t.onEnter}},{useRtlMappings:!0,target:window,mappings:{}}];t.subscribe(t.dataUpdated,t._updateItemSet);t.subscribe(t.needsRefocus,t._setFocus);t._itemProvider=t.resources.consume(s.resourceKey);t._actionMap=t.resources.consume(a.actionMap);t._currentSet=t.resources.consume(a.currentItemSet);t._itemSet=n.observable(null);t._sharedItemSet=n.observable(null);t._sharingProvider=t.resources.consume(b.resourceKey);t.showSharingInfo=n.observable(!1);t.sharingInfoText=n.observable("");var i=t._currentSet().item();t.showSharedRoot=t._moveCopyDataSource.getCapabilities().supportsMoveCopyOnShared&&0!==i.sharingRole&&i.queryType!==f.default.SharedWithMe;t._fetchParentItem(i);t.titleAccessibilityHint=g.strings.titleAccessibilityHint;t.commandBarSpecification=C.toSpecification(w.resourceKey,{commandSet:new(t.managed(h.default))({componentViewModel:t})});return t}e.prototype.getWidth=function(e,t,i){return e._folderTreeWidth-e._folderTreeIndent*t.level};e.prototype.onClick=function(e,t,i){e.focusedItem()&&e.focusedItem().showNewFolderInput(!1);e._selectFolder(t);if(t.isOpen()){e._closeChildren(t);e._updateSelectionArray()}else{t.isLoading(!0);e._showChildren(t)}};e.prototype.keyLeft=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){e._closeChildren(this.focusedItem());e._updateSelectionArray()}else if(this.focusedItem().parent){var i=this.focusedItem().parent;e._changeSelection(i);e._selectFolder(i)}t.stopPropagation();return!0};e.prototype.keyRight=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){if(0<this.focusedItem().children().length){var i=this.focusedItem().children()[0]();e._changeSelection(i);e._selectFolder(i)}}else{e.focusedItem().isLoading(!0);e._showChildren(this.focusedItem())}t.stopPropagation();return!0};e.prototype.keyUp=function(e,t){this.focusedItem().showNewFolderInput(!1);var i=this.itemArrayForSelection.indexOf(this.focusedItem());0!==i&&e._selectFolder(this.itemArrayForSelection()[i-1]);return!0};e.prototype.keyDown=function(e,t){this.focusedItem().showNewFolderInput(!1);var i=this.itemArrayForSelection.indexOf(this.focusedItem());i!==this.itemArrayForSelection().length-1&&e._selectFolder(this.itemArrayForSelection()[i+1]);return!0};e.prototype.onEnter=function(e,t){this.isDisabled(!0);this.isNewFolderDisabled(!0);var i={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove};new(this.managed(this._actionMap.MoveCopyAction))(i).execute(t);t.stopPropagation();return!1};e.prototype._selectFolder=function(e){var t=this._urlDataSource.getKeyParams(e.key),i=this._urlDataSource.saveItemTypeFilter({filters:[y.ItemTypeFilter.folder]});for(var o in i)delete t[o];var r=this._urlDataSource.getKey(t);this.context().targetId=e.id;this.context().targetKey=r;this.context().cid=this._urlDataSource.getOwnerId(r);this.isNewFolderDisabled(!1);v.isFeatureEnabled(v.FileMoveSharingHint)&&this._showSharingInformation(e)};e.prototype._changeSelection=function(e){this.selectionModel.selectItem(e)};e.prototype._setFocus=function(){if(this.needsRefocus()){this.focusedItem().focused(!0);this.isNewFolderDisabled(!1);this.needsRefocus(!1)}};e.prototype._updateItemSet=function(){this.focusedItem().isLoading(!0);this._showChildren(this.focusedItem())};e.prototype._showChildren=function(i){var o=this;if(i.retrievedChildren()&&!this.dataUpdated()){i.isLoading(!1);0<i.children().length?i.isOpen(!0):i.isOpen(!1);this._updateSelectionArray()}else{var e={parentKey:i.key,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(i.key),skipCache:!0,filters:this._getFilters()};this._itemProvider.getItem(e).then(function(e){o._itemSet(e);i.children(l.default.convertChildren(i,o._itemSet().content().items));i.retrievedChildren(!0);i.isLoading(!1);0<i.children().length?i.isOpen(!0):i.isOpen(!1);0===i.children().length?i.iconVisible(!1):i.iconVisible(!0);if(o.dataUpdated()){for(var t=0;t<i.children().length;t++)if(i.children()[t]().name===o.newFolderName()){o._changeSelection(i.children()[t]());o._selectFolder(i.children()[t]())}o.isNewFolderDisabled(!1);o.dataUpdated(!1)}o._updateSelectionArray()})}};e.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};e.prototype._closeChildren=function(e){e.isOpen(!1);for(var t=0;t<e.children().length;t++)this._closeChildren(e.children()[t]())};e.prototype._fetchParentItem=function(e){var t=this,i=this._urlDataSource.saveItemTypeFilter({filters:[y.ItemTypeFilter.folder]}),o=this._urlDataSource.getKey(i),r={parentKey:o,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(o),filters:this._getFilters()},n=this._itemProvider.getItem(r).then(function(e){t._itemSet(e)}),a=m.default.wrap();if(this.showSharedRoot){var s=null;if(e.parent){for(var l=e;l.parent&&!l.parent.isStub&&l.parent.parent;)l=l.parent;s=l}else s=e;r={parentKey:s.key,ownerId:s.ownerId};a=this._itemProvider.getItem(r).then(function(e){t._sharedItemSet(e)},function(e){t.showSharedRoot=!1})}m.default.all([n,a]).done(this._createFolderItems.bind(this),this._createFolderItems.bind(this))};e.prototype._createFolderItems=function(){var e=null;if(this._sharedItemSet()){var t=this._getFolderItem(this._sharedItemSet());e=t;this.sharedFolderItem(t)}if(this._itemSet()){var i=this._getFolderItem(this._itemSet());i.isRoot=!0;e||(e=i);this.rootFolderItem(i);this._selectFolder(e);this._changeSelection(e);this._updateSelectionArray();this.hasData(!0)}};e.prototype._getFolderItem=function(e){var t=l.default.convertItem(null,e.item());t.children(l.default.convertChildren(t,e.content().items));t.isOpen(!0);t.retrievedChildren(!0);t.focused(!0);0===t.children().length&&t.iconVisible(!1);return t};e.prototype._updateSelectionArray=function(){var e=this._updateSelectionArrayHelper(this.rootFolderItem(),!0),t=this.sharedFolderItem()?this._updateSelectionArrayHelper(this.sharedFolderItem(),!0):[];this.itemArrayForSelection(t.concat(e))};e.prototype._updateSelectionArrayHelper=function(e,t){var i=[];t&&i.push(e);if(0<e.children().length)for(var o=0;o<e.children().length;o++)i=i.concat(this._updateSelectionArrayHelper(e.children()[o](),e.isOpen()));return i};e.prototype._showSharingInformation=function(i){var o=this;if(i.retrievedSharingPermissions){this.showSharingInfo(!!i.sharingInfoText);this.sharingInfoText(i.sharingInfoText)}else{this.showSharingInfo(!1);this._sharingProvider.getSharingData({key:"",openUrl:i.id}).getPermissions().then(function(e){var t=e[0];i.retrievedSharingPermissions=!0;i.sharingPermissions=t;i.sharingInfoText=x.getSharingStatusText(t,i.name);if(i.selected()){o.showSharingInfo(!!i.sharingInfoText);o.sharingInfoText(i.sharingInfoText)}},function(e){})}};return e}(i.default);e.default=o});define("odsp-next/controls/folderTree/FolderTreeUtility",["require","exports","knockout","../../models/item/ItemType"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}n.convertItem=function(e,t){return{name:t.name,key:t.key,type:t.type,id:t.id,iconName:t.iconName,focused:a.observable(!1),isSelectable:!0,selected:a.observable(!1),children:a.observableArray(),isOpen:a.observable(!1),retrievedChildren:a.observable(!1),iconVisible:a.observable(!0),isRoot:!1,isLoading:a.observable(!1),level:0,parent:e,showNewFolderInput:a.observable(!1),focusNewFolderInput:a.observable(!1),retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,oneDriveItem:t}};n.convertChildren=function(e,t){for(var i=[],o=0;o<t.length;o++)if(t[o]&&t[o]().type===s.default.Folder){var r=a.observable(n.convertItem(e,t[o]()));r().level=e.level+1;i.push(r)}return i};return n}();t.default=i});define("odsp-next/controls/folderTree/FolderTreeCommandSet",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../commands/Commands.resx","../../resources/ControlResourceKeys","../commands/CommandViewModel"],function(e,t,i,s,l,o,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t.commands=s.observableArray();var i=".FolderPanelTopMenu",o=d.strings;t._actionMap=t.resources.consume(c.actionMap);t.componentViewModel=e.componentViewModel;t.context=e.componentViewModel.context;t.onComplete=e.componentViewModel.onComplete;t.isDisabled=e.componentViewModel.isDisabled;t.isNewFolderDisabled=e.componentViewModel.isNewFolderDisabled;t.isNewFolderHidden=s.observable(!0);t.createComputed(function(){if((!t._focusedItem||t._focusedItem()!==t.componentViewModel.focusedItem())&&t.componentViewModel.focusedItem()){t._focusedItem=t.componentViewModel.focusedItem;var e=s.observable(t._focusedItem().oneDriveItem);t._createFolderAction=new(t.managed(t._actionMap.CreateFolderAction))({item:e})}t._createFolderAction&&t.isNewFolderHidden(!t._createFolderAction.isAvailable())});var r={context:t.context,onComplete:t.onComplete,isMove:!0},n={context:t.context,onComplete:t.onComplete,isMove:!1};t.commands=s.observableArray([new p.default({text:o.moveConfirmButton,isDisabled:t.isDisabled,icon:new l.default("CheckMark"),automationId:"folderTree-move",action:new(t.managed(t._actionMap.MoveCopyAction))(r),engagementName:"Move"+i}),new p.default({text:o.copyConfirmButton,isDisabled:t.isDisabled,icon:new l.default("CheckMark"),automationId:"folderTree-copy",action:new(t.managed(t._actionMap.MoveCopyAction))(n),engagementName:"Copy"+i}),new(t.managed(p.default))({text:o.CreateFolderCommand,isHidden:t.isNewFolderHidden,isDisabled:t.isNewFolderDisabled,icon:new l.default("CirclePlus"),callback:function(){t.componentViewModel.focusedItem().showNewFolderInput(!0);t.componentViewModel.focusedItem().focusNewFolderInput(!0);t.isNewFolderDisabled(!0)},engagementName:"NewFolder"+i})]);return t}return e}(o.default);t.default=r});define("odsp-next/controls/folderTree/FolderTree.html",[],function(){return'\x3c!--ko if: hasData--\x3e<div class="od-FolderTree-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div><div class=od-FolderTree-contentContainer><div class="od-FolderTree-sharingInfo ms-font-m" data-bind="visible: showSharingInfo, text: sharingInfoText"></div><div class="od-Panel--hasPadding od-FolderTree-padding"><div class="od-FolderTree-title ms-font-xl ms-fontWeight-semilight" data-bind="text: title"></div><span class=ms-accessible data-bind="text: titleAccessibilityHint"></span>\x3c!--ko if: showSharedRoot && sharedFolderItem()--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: sharedFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: sharedFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div>\x3c!--/ko--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: rootFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: rootFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: hasData--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: loadingText } }"></span>\x3c!--/ko--\x3e'});define("odsp-next/controls/folderTree/FolderTreeRow.html",[],function(){return"<div class=od-FolderTree-row role=treeitem data-bind=\"css: {'is-selected': selected, 'is-focused': focused, 'icon-visible': iconVisible}, click: $component.onClick.bind($data, $component), attr: { tabindex: selected() || focused() ? 0 : -1, 'aria-expanded': isOpen(), 'aria-selected': selected(), 'aria-label': name}, delayedHasFocus: { hasFocus: focused, timeout: 300 }\"><i class=\"ms-Icon ms-Icon--ChevronDown\" data-bind=\"icon: true, style: {display: !isLoading() && isOpen() ? 'inline-block' : 'none'}\"></i> <i class=ms-Icon data-bind=\"icon: true, style: {display: !isLoading() && !isOpen() ? 'inline-block' : 'none'}, css: { 'ms-Icon--ChevronRight': !$component.isRtl, 'ms-Icon--ChevronLeft': $component.isRtl }\"></i> <img class=od-FolderTree-loadingGif data-bind=\"attr: { src: $component.loadingImageUrl}, style: {display: isLoading() ? 'inline-block' : 'none'}\"> <i class=\"ms-Icon ms-Icon--OneDrive\" data-bind=\"icon: true, style: {display: isRoot ? 'inline-block' : 'none'}\"></i> <span class=od-FolderTree-folderIcon data-bind=\"component: { name: 'ms-file-type-icon', params: { iconName: iconName, desiredSize: 16 } }, style: {display: isRoot ? 'none' : 'inline-block'}\"></span> <span class=\"od-FolderTree-folderName ms-font-m\" data-bind=\"text: name\"></span></div><div class=od-FolderTree-inlineFolderBuilder data-bind=\"visible: showNewFolderInput, component: { name: 'ms-inline-folder-builder', params: { newFolderName: $component.newFolderName, iconName: iconName, width: $component.getWidth($component, $data), itemKey: key, optionalParams: { dataUpdated: $component.dataUpdated, showNewFolderInput: showNewFolderInput, hasFocus: focusNewFolderInput, needsRefocus: $component.needsRefocus } } }\"></div><ul class=od-FolderTree-children role=group data-bind=\"template: { name: 'od-folder-tree-row', foreach: children }, style: { display: isOpen() ? 'block' : 'none' }\"></ul>"});define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder",["require","exports","./InlineFolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InlineFolderBuilder.html","./InlineFolderBuilder.css","../fileTypeIcon/FileTypeIcon"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-inline-folder-builder",template:e("./InlineFolderBuilder.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilderViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../providers/item/ItemProvider","../folderBuilder/FolderBuilder.resx","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.namePlaceholder=a.strings.FolderNamePlaceholder;t.nameLabel=a.strings.FolderNameLabel;t.createLabel=a.strings.CreateFolderLabel;t.iconName=e.iconName;t.width=(e.width-57).toString()+"px";t.inputWidth=(e.width-89).toString()+"px";t.newFolderName=e.newFolderName||r.observable("");t.newFolderName("");t.buttonText=a.strings.CreateFolderLabel;t.itemKey=e.itemKey;t.isActive=r.observable(!0);var i=e.optionalParams;t.optionalParams={dataUpdated:i&&i.dataUpdated?i.dataUpdated:r.observable(!1),showNewFolderInput:i&&i.showNewFolderInput?i.showNewFolderInput:r.observable(!0),hasError:i&&i.hasError?i.hasError:r.observable(!1),status:i&&i.status?i.status:r.observable(""),hasFocus:i&&i.hasFocus?i.hasFocus:r.observable(!0),isEnabled:i&&i.isEnabled?i.isEnabled:r.observable(!0),needsRefocus:i&&i.needsRefocus?i.needsRefocus:r.observable(!1)};t.addBindingHandlers({keyboard:l.default});t._itemProvider=t.resources.consume(n.resourceKey);t._actionMap=t.resources.consume(s.actionMap);return t}e.prototype.onClick=function(e,t){e.createNewFolder(t)};e.prototype.onEnter=function(e,t){e.createNewFolder(t);return!0};e.prototype.onClickTextField=function(e,t){t.stopPropagation()};e.prototype.onEscape=function(e,t){this.optionalParams.showNewFolderInput(!1);this.newFolderName("");this.optionalParams.status("");this.optionalParams.isEnabled(!0);this.optionalParams.needsRefocus(!0);t.stopPropagation();return!1};e.prototype.createNewFolder=function(i){var o=this,e={parentKey:this.itemKey};this._itemProvider.getItem(e).then(function(e){var t=e.item();new(o.managed(o._actionMap.CreateNewFolderAction))({parentItem:t,newFolderName:o.newFolderName,options:o.optionalParams}).execute(i)});i.stopPropagation()};return e}(o.default);t.default=d});define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.html",[],function(){return'<div class=od-InlineFolderBuilder data-bind="style: { width: width}, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter.bind($component), Esc: onEscape.bind($component) } }"><span><span class=od-InlineFolderBuilder-folderIcon data-bind="component: { name: \'ms-file-type-icon\', params: { iconName: iconName, desiredSize: 16 } }"></span> <input class="od-InlineFolderBuilder-textInput od-TextField-field" type=text data-bind="value: newFolderName, textInput: newFolderName, click: onClickTextField.bind($component), hasFocus: optionalParams.hasFocus, style: { width: inputWidth }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': nameLabel }, automation: automationId, enable: optionalParams.isEnabled"></span><div class=od-InlineFolderBuilder-status aria-live=assertive data-bind="text: optionalParams.status, css: { \'od-InlineFolderBuilder-status--error\': optionalParams.hasError }"></div><div><button class="od-Button od-Button--primary od-InlineFolderBuilder-createButton" data-bind="visible: newFolderName() && optionalParams.isEnabled(), click: onClick.bind($component), attr: { \'aria-label\': createLabel }"><span class=od-Button-label data-bind="text: buttonText"></span></button></div></div>'});define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InlineFolderBuilder{overflow:visible;white-space:nowrap;word-wrap:break-word;display:inline-block}.od-InlineFolderBuilder-textInput{display:inline-block}[dir=ltr] .od-InlineFolderBuilder-textInput{margin-left:8px}[dir=rtl] .od-InlineFolderBuilder-textInput{margin-right:8px}.od-InlineFolderBuilder-createButton{margin-top:2px;line-height:0}html[dir=ltr] .od-InlineFolderBuilder-createButton{float:right}html[dir=rtl] .od-InlineFolderBuilder-createButton{float:left}.od-InlineFolderBuilder-status{margin-top:2px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";white-space:pre-wrap;word-wrap:break-word;line-height:15px}.od-InlineFolderBuilder-status--error{color:#a80000}"}])});define("odsp-next/controls/folderTree/FolderTree.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderTree-row{overflow:hidden;cursor:default;height:34px;line-height:14px;position:relative;margin:2px 0;min-width:220px;white-space:nowrap;text-overflow:ellipsis}.od-FolderTree-row.is-selected{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderTree-row.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderTree-row.is-selected{background:#00c0ff}}.od-FolderTree-row:focus{outline:1px solid transparent}.od-FolderTree-row .ms-Icon--ChevronDown{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px;font-size:12px}.od-FolderTree-row .ms-Icon--ChevronRight{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px 8px 10px 14px;font-size:12px}html[dir=rtl] .od-FolderTree-row .ms-Icon--ChevronRight{padding:10px 14px 10px 8px}.od-FolderTree-row.icon-visible .ms-Icon--ChevronRight{opacity:1}.od-FolderTree-row.icon-visible .ms-Icon--ChevronDown{opacity:1}.od-FolderTree-row .ms-Icon--OneDrive{font-size:16px;padding:10px 0;width:16px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";vertical-align:top}[dir=ltr] .od-FolderTree-row .ms-Icon--OneDrive{margin-left:-3px}[dir=rtl] .od-FolderTree-row .ms-Icon--OneDrive{margin-right:-3px}.od-FolderTree-row .od-FolderTree-loadingGif{vertical-align:bottom;padding:9px}.od-FolderTree-row>i{display:inline}.od-FolderTree-folderIcon{vertical-align:top;line-height:30px}.od--isNonMobile .od-FolderTree-row:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{theme:"themeLightAlt",defaultValue:"#beddf4"},{rawString:"}.od-focus--enabled .od-FolderTree-row.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od-FolderTree-folderName{cursor:pointer;position:relative;top:-1px;line-height:32px}[dir=ltr] .od-FolderTree-folderName{margin-left:3px}[dir=rtl] .od-FolderTree-folderName{margin-right:3px}.od-FolderTree-children{margin:0}[dir=ltr] .od-FolderTree-children{padding-left:20px}[dir=rtl] .od-FolderTree-children{padding-right:20px}.od-FolderTree-title{margin-bottom:20px}.od-FolderTree-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .ms-CommandBar{animation:none}}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-FolderTree-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .CommandBar{animation:none}}.od-FolderTree-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}.od-FolderTree-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0}[dir=ltr] .od-FolderTree-contentContainer{left:0}[dir=rtl] .od-FolderTree-contentContainer{right:0}[dir=ltr] .od-FolderTree-contentContainer{right:0}[dir=rtl] .od-FolderTree-contentContainer{left:0}.od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:22px}.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:10px}.od-FolderTree-sharingInfo{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:";padding:4px 6px}.od-FolderTree-inlineFolderBuilder{margin:2px 0;line-height:34px}[dir=ltr] .od-FolderTree-inlineFolderBuilder{padding-left:57px}[dir=rtl] .od-FolderTree-inlineFolderBuilder{padding-right:57px}"}])});define("@ms/odsp-utilities/lib/list/ShortcutUtilities",["require","exports","../features/Features"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r={ODB:563,ODC:null,Fallback:!1};!function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.default.isFeatureEnabled(r)};!function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"}(e.ShortcutErrors||(e.ShortcutErrors={}))}(o||(o={}));t.default=o});define("odsp-next/actions/userActivity/odc/UserActivityExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/userActivity/UserActivity","../../../controls/userActivity/UserActivity.resx"],function(e,t,o,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._panelProvider=t.resources.consume(r.resourceKey);return t}e.prototype.execute=function(){var e;return(e=this._panelProvider.requestPanel({title:s.strings.ActivityFeedTitle,component:{name:a.default.tagName,params:{onActivityClick:function(){e.state(1)}}}})).wait().then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(i.default);t.default=l});define("odsp-next/controls/userActivity/UserActivity",["require","exports","./UserActivityViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserActivity.html","./UserActivity.css","./UserActivityTile"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-userActivity-feed",template:e("./UserActivity.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/userActivity/UserActivityViewModel",["require","exports","tslib","knockout","../infoPane/InfoPane.resx","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){i.__extends(e,t);function e(e){var i=t.call(this)||this;i.statusText=o.observable(r.strings.sharingLoadingStatus);i.isLoading=o.observable(!0);i.activities=o.observableArray([]);i.onActivityClick=e.onActivityClick;i._activityProvider=i.resources.consume(n.userActivity);i._activityProvider.getActivities().done(function(e){var t=e.activities.slice();i.activities(t);i.isLoading(!1);i.statusText("")},function(e){i.statusText(r.strings.serverError)});return i}return e}(a.default);t.default=s});define("odsp-next/controls/userActivity/UserActivity.html",[],function(){return"<div class=od-UserActivity-Feed>\x3c!--ko if: isLoading()--\x3e<div class=od-UserActivity-Feed-Status data-bind=\"text: statusText()\"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<div class=od-UserActivity-Feed-List><div data-bind=\"foreach: { data: activities, as: 'activity' }\">\x3c!--ko component: { name: 'ms-userActivity-tile', params: { activity: activity, onActivityClick: $component.onActivityClick.bind($component) } }--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/userActivity/UserActivity.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-UserActivity-Feed{font-size:12px}.od-UserActivity-Feed-List a,.od-UserActivity-Feed-List a:hover,.od-UserActivity-Feed-List a:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("odsp-next/controls/userActivity/UserActivityTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserActivityTileViewModel","./UserActivityTile.html","./UserActivityTile.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"ms-userActivity-tile",template:e("./UserActivityTile.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/userActivity/UserActivityTileViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../../models/item/ItemType","../../dataSources/url/odc/UrlDataSource","../../resources/ODCResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../dataSources/url/PageType"],function(e,t,i,r,n,a,s,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(o){i.__extends(e,o);function e(e){var t,i=o.call(this,e)||this;i._urlDataSource=i.resources.consume(s.urlDataSource);i.activity=e.activity;i.onActivityClick=e.onActivityClick;i.timestamp=r.getRelativeDateTimeStringPast(i.activity.timestamp);i.personaSize=4;i.actorImageUrl=i.activity.actors[0].image;if(i.activity.item.itemType===n.default.File){i.itemUrl=a.default.getResourceRedirectUrl(i.activity.item.id);i.itemUrlTarget="_blank"}else{i.itemUrl=i._urlDataSource.getItemUrl(i._urlDataSource.getKey(((t={}).id=i.activity.item.id,t)),{page:l.default.Files});i.itemUrlTarget="_top"}return i}e.prototype.onClick=function(e,t){this.onActivityClick();return!0};return e}(o.default);t.default=d});define("odsp-next/controls/userActivity/UserActivityTile.html",[],function(){return"<div class=od-UserActivityTile><a data-bind=\"attr: { 'href': itemUrl, 'target': itemUrlTarget }, click: onClick\"><div class=od-UserActivityTile-ActorPhoto data-bind=\"component: { name: 'od-persona', params: { person: activity.actors[0], personaSize: $component.personaSize, showPresence: true, showName: false, iconType: 'Contact' } }\"></div><div class=od-UserActivityTile-Text><div class=od-UserActivityTile-Message data-bind=\"text: activity.message\"></div><div class=od-UserActivityTile-Timestamp data-bind=\"text: timestamp\"></div></div></a></div>"});define("odsp-next/controls/userActivity/UserActivityTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-UserActivityTile{padding:10px 0;min-height:50px}.od-UserActivityTile-ActorPhoto{position:absolute}.od-UserActivityTile-Text{position:relative}[dir=ltr] .od-UserActivityTile-Text{margin-left:58px}[dir=rtl] .od-UserActivityTile-Text{margin-right:58px}"}])});define("odsp-next/actions/rename/odc/RenameExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../RenameHelper","../../../utilities/optimizely/ExperimentsCommon.key"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._selectionHelper=e.selectionHelper;t._renameHelper=new(t.managed(n.default));t._itemReedemer=new(t.managed(r.default));return t}e.prototype.execute=function(){var t=this;this.trackPromise(this.resources.consumeAsync(a.resourceKey).then(function(e){e.fireEditEvent()}));return this._selectionHelper.resolveFirst().then(function(e){return t._itemReedemer.redeemItem(e,t).then(function(){return t._renameHelper.renameItem(e,!1)})})};return e}(i.default);t.default=s});define("odsp-next/actions/rename/RenameHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","./RenameItemOperator","../../resources/ControlResourceKeys","../../controls/itemNameEditor/ItemNameEditor","../../resources/DataSourceResourceKeys"],function(e,t,o,p,u,i,h,m,r,g,n,f,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dialogProvider=t.resources.consume(r.resourceKey);t._urlDataSource=t.resources.consume(a.url);t._parentItem=t.resources.consume(n.currentItem);return t}e.prototype.renameItem=function(o,r){var n=this,e=o.properties.FileName||o.name,t=o.extension;if(r){e+=o.extension;t=null}var a=this.observables.create(e),s=this.observables.create(""),l=this.observables.create(!1),d=this.observables.create(!0),c=this.observables.create(!0);return this._dialogProvider.requestDialog({title:m.strings.Rename,component:{name:f.default.tagName,params:{name:a,extension:t,status:s,hasError:l,isEnabled:d,hasFocus:c}},actions:[{name:m.strings.RenameCommit,execute:function(){var i=n.unwrapObservable(a);if(i===e)return p.default.wrap(2);if(i&&""===i.trim())return p.default.wrap(1);s(m.strings.Saving);d(!1);l(!1);return n.resources.consumeAsync(g.typeResourceKey).then(function(e){var t=new e({parentKey:n._parentItem().key,newName:i,nameHasExtension:r,item:o,ownerId:n._urlDataSource?n._urlDataSource.getOwnerId():""});return n.trackPromise(t.start())}).then(function(){return 2},function(e){l(!0);d(!0);c(!0);s(e.message);return 1})},isDefault:!0,isAvailable:this.observables.pureCompute(function(){return!!a().trim()&&d()}),automationId:"renameDialogCommit",icon:new u.default("Save")}]}).wait().then(function(){return{resultType:h.ResultTypeEnum.Success}})};return e}(i.default);t.default=s});define("odsp-next/actions/rename/RenameItemOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._context=e;i._fileSystemProvider=t.fileSystemProvider;return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input;t.type=a.default.renameItems;t.name=i.name;t.iconName=i.iconName;t.payloads.renameItems={item:i,parent:i.parent};t.visibility=2;return t};e.prototype.onStart=function(e){return this._fileSystemProvider.renameItem(this._context,e)};e.dependencies=i.__assign({},r.default.dependencies,{fileSystemProvider:n.resourceKey});return e}(r.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._photoProvider=e.photoProvider;t._itemProvider=e.itemProvider;t._urlDataSource=e.urlDataSource;t._rootId=e.rootId;return t}e.prototype.execute=function(e){var t=this;return this._findFolderId(this._rootId).then(function(e){return t._photoProvider.setAllPhotosSettings({cid:n.default.viewerId,allPhotosFolderId:e,allPhotosSortDirection:"2",rset:"odweb",id:"root"}).then(function(e){t._photoProvider.getAllPhotosSettings(!0);return{resultType:a.ResultTypeEnum.Success}},function(e){return{resultType:a.ResultTypeEnum.Failure}})})};e.prototype._findFolderId=function(e){if(0===this._rootId)return r.default.wrap("root");if(1===this._rootId){var t=this._getContextForPhoto();this._itemProvider.getItemSync(t);return this._itemProvider.getItem(t).then(function(e){return e.item&&e.item().id},function(e){return r.default.wrap("root")})}return r.default.wrap("root")};e.prototype._getContextForPhoto=function(){return{parentKey:this._urlDataSource.getKey((e={},e.id="photos",e)),skipCache:!0,skipInMemoryCache:!0,pageSize:1};var e};return e}(i.default);t.default=s});define("odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../controls/reportAbuseDialog/ReportAbuseDialog","../../../controls/reportAbuseDialog/ReportAbuseDialog.resx","../../../models/item/AbuseType","../../../providers/item/ItemProvider"],function(e,t,o,r,n,i,a,s,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=d.strings,h=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._abuseText=t.observables.create(null);t._abuseType=t.observables.create(null);t._selectionHelper=e.selectionHelper;t._provider=t.resources.consume(p.resourceKey);t._dialogProvider=t.resources.consume(s.resourceKey);return t}e.prototype.execute=function(){return this._executeReportAbuse()};e.prototype._executeReportAbuse=function(){var t=this;return this._selectionHelper.resolveFirst().then(function(e){return t._getReportAbuseDialog().then(function(){return t._provider.reportAbuse({item:e,rao:t._abuseType.peek(),desc:t._abuseText.peek()}).then(function(){return{resultType:a.ResultTypeEnum.Success}})})})};e.prototype._getReportAbuseDialog=function(){var e=this;return this._dialogProvider.requestDialog({title:u.title,component:{name:l.default.tagName,params:{abuseType:this._abuseType,abuseText:this._abuseText}},actions:[{name:u.title,execute:function(){return r.default.wrap(2)},isAvailable:this.createComputed(function(){return e._abuseType&&(e._abuseType()||0===e._abuseType())&&e._abuseType()!==c.default.copyrightInfringement}),isDefault:!0,icon:new n.default("EditNote"),automationId:"reportAbuseConfirm"}]}).wait()};return e}(i.default);t.default=h});define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog",["require","exports","./ReportAbuseDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ReportAbuseDialog.html","./ReportAbuseDialog.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-report-abuse",template:e("./ReportAbuseDialog.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/AbuseType","./ReportAbuseDialog.resx"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.abuseTypeEnum=r.default;t.strings=n.strings;t.spamUrl="https://go.microsoft.com/fwlink/?LinkId=117951";t.privacyUrl="https://go.microsoft.com/fwlink/?LinkId=521839";t.copyrightUrl="https://www.microsoft.com/info/cpyrtInfrg.aspx";t.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=521839";t.abuseType=e.abuseType;t.abuseText=e.abuseText;return t}return e}(i.default);t.default=a});define("odsp-next/models/item/AbuseType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.spam=0]="spam";e[e.nudityOrPornography=1]="nudityOrPornography";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation";e[e.other=4]="other";e[e.copyrightInfringement=5]="copyrightInfringement"}(i||(i={}));t.default=i});define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog.html",[],function(){return'<div class=ReportAbuseDialog><div><span data-bind="text: strings.headerPart1"></span> <a target=_blank data-bind="text: strings.headerPart2, attr: { href: codeOfConductUrl }" a></a></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeSpam data-bind="checked: abuseType, checkedValue: abuseTypeEnum.spam"> <a target=_blank data-bind="text: strings.spam, attr: { href: spamUrl}"></a></div><div class=ms-reportAbuseDialog-option><input type=radio id=abuseTypeNudityOrPornography name=abuseType data-bind="checked: abuseType, checkedValue: abuseTypeEnum.nudityOrPornography"> <label for=abuseTypeNudityOrPornography data-bind="text: strings.nudityOrPornography"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeHarassmentOrThreatening data-bind="checked: abuseType, checkedValue: abuseTypeEnum.harassmentOrThreatening"> <label for=abuseTypeHarassmentOrThreatening data-bind="text: strings.harassmentOrThreatening"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypechildEndangermentOrExploitation data-bind="checked: abuseType, checkedValue: abuseTypeEnum.childEndangermentOrExploitation"> <label for=abuseTypechildEndangermentOrExploitation data-bind="text: strings.childEndangermentOrExploitation"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeCopyrightInfringement data-bind="checked: abuseType, checkedValue: abuseTypeEnum.copyrightInfringement"> <span>\x3c!--ko if: abuseType() !== abuseTypeEnum.copyrightInfringement--\x3e<label for=abuseTypeCopyrightInfringement data-bind="text: strings.copyrightInfringementShort">&nbsp;</label>\x3c!--/ko--\x3e\x3c!--ko if: abuseType() === abuseTypeEnum.copyrightInfringement--\x3e<label for=abuseTypeCopyrightInfringement data-bind="text: strings.copyrightInfringementLong1"></label> <a target=_blank data-bind="text: strings.copyrightInfringementLong2, attr: { href: copyrightUrl}"></a>\x3c!--/ko--\x3e</span></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeOther data-bind="checked: abuseType, checkedValue: abuseTypeEnum.other"> <label for=abuseTypeOther data-bind="text: strings.other"></label></div><div class=ms-reportAbuseDialog-text-header><span data-bind="text: strings.detailsTextHeader"></span></div><textarea class=ms-reportAbuseDialog-text-area data-bind="enable: (abuseType() !== abuseTypeEnum.copyrightInfringement && abuseType() !== abuseTypeEnum.spam), value: abuseText"> </textarea><div class=ms-reportAbuseDialog-privacy><a id=privLnk target=_blank data-bind="text: strings.privacyStatement, attr: { href: privacyUrl }" a></a></div></div>'});define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-reportAbuseDialog-option{margin-top:10px}.ms-reportAbuseDialog-text-header{margin-top:15px}.ms-reportAbuseDialog-text-area{margin-top:5px;width:80%;height:40px;resize:none}"}])});define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/removeFromSharedList/RemoveFromSharedList","../../../controls/removeFromSharedList/RemoveFromSharedList.resx","../../../models/item/ItemType","../../../utilities/icons/Icon","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,o,a,i,s,l,d,c,p,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._itemProvider=t.resources.consume(r.resourceKey);t._dialogProvider=t.resources.consume(n.resourceKey);t._currentItem=e.currentItem;return t}e.prototype.execute=function(){var t=this,i=this.observables.create(!1),o=this.observables.create(""),r=this.observables.create(!1),n=this._currentItem&&this._currentItem.key;return this._selectionHelper.resolveSelection().then(function(e){return t._dialogProvider.requestDialog({title:1<e.length?d.strings.itemsTitle:e[0].type===c.default.File?d.strings.fileTitle:d.strings.folderTitle,component:{name:l.default.tagName,params:{isSpam:i,selection:e,removeAccess:!0,hasError:r,status:o}},actions:[{name:d.strings.actionText,execute:function(){return a.default.wrap(2)},isAvailable:t.observables.create(!0),isDefault:!0,icon:new p.default("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait().then(function(){return t._itemProvider.removeFromSharedList({items:e,markAsSpam:i(),parentKey:n}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return e}(i.default);t.default=u});define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList",["require","exports","./RemoveFromSharedListViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RemoveFromSharedList.html","./RemoveFromSharedList.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-remove-from-sharedlist",template:e("./RemoveFromSharedList.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/removeFromSharedList/RemoveFromSharedListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RemoveFromSharedList.resx","../../models/item/ItemType"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r.strings,s=function(o){i.__extends(e,o);function e(e){var t=o.call(this,{})||this;t.allowSpam=!!e.isSpam;t.isSpam=e.isSpam;t.status=e.status;t.hasError=e.hasError;var i=e.selection;e.hasError()?t.subText="":e.removeAccess?t.subText=1<i.length?a.itemsSubText:i[0].type===n.default.File?a.fileSubText:a.folderSubText:t.subText=1<i.length?a.itemsSubTextWithAccess:i[0].type===n.default.File?a.fileSubTextWithAccess:a.folderSubTextWithAccess;t.spamText=1<i.length?a.itemsSpamText:i[0].type===n.default.File?a.fileSpamText:a.folderSpamText;return t}return e}(o.default);t.default=s});define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.html",[],function(){return'<div class=od-RemoveFromSharedList><div class=od-RemoveFromSharedList-SubText data-bind="text: subText"></div><span data-bind="if: allowSpam"><input id=RemoveFromSharedList-isSpam type=checkbox name=isSpam class=od-isSpam data-bind="checked: isSpam"> <label for=RemoveFromSharedList-isSpam class=spamText data-bind="text: spamText"></label></span><div class=od-RemoveFromSharedList-Status data-bind="text: status, css: { \'od-RemoveFromSharedList-Status--error\': hasError }"></div></div>'});define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:#a80000}"}])});define("odsp-next/actions/requestReview/odc/RequestReviewExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/requestReviewDialog/RequestReviewDialog","../../../controls/requestReviewDialog/RequestReviewDialog.resx","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,o,r,i,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._selectionHelper=e.selectionHelper;t._itemProvider=t.resources.consume(d.resourceKey);t._dialogProvider=t.resources.consume(c.resourceKey);return t}e.prototype.execute=function(){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._dialogProvider.requestDialog({title:l.strings.title,component:{name:s.default.tagName,params:{items:e}},actions:[{name:l.strings.actionButtonText,execute:function(){return r.default.wrap(2)},isAvailable:t.observables.create(!0),isDefault:!0,icon:new a.default("EditNote"),automationId:"requestReviewConfirm"}]}).wait().then(function(){return t._itemProvider.requestReview({items:e}).then(function(){return{resultType:n.ResultTypeEnum.Success}})})})};return e}(i.default);t.default=p});define("odsp-next/controls/requestReviewDialog/RequestReviewDialog",["require","exports","./RequestReviewDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RequestReviewDialog.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-requestreview-dialog",template:e("./RequestReviewDialog.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/requestReviewDialog/RequestReviewDialogViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./RequestReviewDialog.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,o,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.strings=n.strings;t.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=117951";t.contactString=r.observable(null);t.contactString(a.format(t.strings.reviewContact,$Config.email));t.confirmPart1=a.pluralSelect(e.items.length,t.strings.confirmPart1Single,t.strings.confirmPart1Multiple);return t}return e}(i.default);t.default=s});define("odsp-next/controls/requestReviewDialog/RequestReviewDialog.html",[],function(){return'<div><span data-bind="text: confirmPart1"></span> <a target=_blank data-bind="text: strings.confirmPart2, attr: { href: codeOfConductUrl }"></a> <span data-bind="text: contactString"></span></div>'});define("odsp-next/actions/restoreAll/odc/RestoreAllExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/commands/Commands.resx","../../../providers/fileSystem/FileSystemProvider","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer"],function(e,t,o,r,i,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._currentItem=e.currentItem;t._fileSystemProvider=t.resources.consume(l.resourceKey);t._dialogProvider=t.resources.consume(d.resourceKey);return t}e.prototype.execute=function(){var e=this;return this._dialogProvider.requestDialog({title:s.strings.recycleBinRestoreAllConfirmText,component:{name:c.default.tagName,params:{text:s.strings.recycleBinRestoreAllSubText}},actions:[{name:s.strings.restore,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new a.default("RevToggleKey"),isDefault:!0}]}).wait().then(function(){return e._fileSystemProvider.restoreAll({parentKey:e._currentItem.peek().key}).then(function(){return{resultType:n.ResultTypeEnum.Success}})})};return e}(i.default);t.default=p});define("odsp-next/actions/save/SaveExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/operator/SaveOperator","../../providers/item/ItemContentProvider","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../utilities/optimizely/ExperimentsCommon.key","../../utilities/features/Features"],function(e,t,o,i,a,s,r,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._currentItem=e.currentItem;t._itemContentsProvider=t.resources.consume(r.resourceKey);return t}e.prototype.execute=function(){var n=this;return this._selectionHelper.resolveFirst().then(function(i){var e=n._itemContentsProvider.getItemContent(i),t=e.memoryContent.peek(),o=n.getFullFileName(i);c.isOneDrive&&n.trackPromise(n.resources.consumeAsync(d.resourceKey).then(function(e){e.fireEditEvent()}));var r=new Blob([t.text],{type:i.textEditorMimeType});r.name=o;r.eTag=e.correspondingETag;return n.resources.consumeAsync(s.typeResourceKey).then(function(e){var t=new e({files:[r],parentItem:n._currentItem,wasDragAndDropped:!1,type:l.UploadProcessorType.Html5file,item:i});n.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:a.ResultTypeEnum.Success}},function(e){return{resultType:a.ResultTypeEnum.Failure,error:e?e.message||e:"Unkown error occurred whil trying to save a file"}})})};e.prototype.getFullFileName=function(e){return e.name+e.extension};return e}(i.default);t.default=n});define("odsp-next/providers/operator/SaveOperator",["require","exports","tslib","./UploadOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","../../providers/item/ItemContentProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,r,a,s,l,d,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){i.__extends(e,n);function e(e,t){var i=this;e.behavior=1;i=n.call(this,e,t)||this;var o=t.itemContentProvider;i._itemContentsProvider=o;i.registerActions({restart:null,compare:i._onCompare,overwrite:i._onReplace});return i}e.prototype.getOperationDetails=function(e){var t=n.prototype.getOperationDetails.call(this,e),i=e.input;t.type=r.default.saveItem;t.name=i.fileName.peek();t.iconName=i.iconName.peek();t.payloads.uploadItems={parent:this._context.parentItem,name:i.fileName.peek()};0===i.state.peek()&&(t.state=a.default.created);t.progress.maximum=i.totalBytes.peek();t.progress.current=i.uploadedBytes.peek();switch(e.status){case 0:this._handleStart(t);break;case 1:this._handleSucceeded(t);break;case 2:this._handleFailed(t,e.error)}return t};e.prototype.onCancel=function(e,t){if(this._context.item){var i=this._itemContentsProvider.getItemContent(this._context.item);i.saveSucceded();for(var o=0,r=e;o<r.length;o++){0===r[o].status&&i.saveFailed()}}return n.prototype.onCancel.call(this,e,t)};e.prototype._handleStart=function(e){e.actions.push(this.onCancel);if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).startingSave()}};e.prototype._handleSucceeded=function(e){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveSucceded()}};e.prototype._handleFailed=function(e,t){t&&(e.error.payloads.upload={error:t});if(t&&t.errorType===s.UploadErrorType.versionMismatch){e.actions.push(this._onCompare);e.actions.push(this._onReplace)}if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveFailed()}};e.prototype._onReplace=function(e,t){for(var i=0,o=e;i<o.length;i++){var r=o[i];r.input.nameConflictBehavior(3);r.input.restart()}return l.default.wrap()};e.prototype._onCompare=function(e,t){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).outDated(!0);this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}return this.onCancel(e,t)};e.dependencies=i.__assign({},o.default.dependencies,{itemContentProvider:d.resourceKey});return e}(o.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("odsp-next/providers/operator/UploadOperator",["require","exports","tslib","./BaseUploadOperator","knockout","../../providers/item/ItemProvider","../../resources/ProviderResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,r,n,s,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this,o=t.itemProvider,r=t.uploadTeachingBubbleProvider,n=t.didUserUploadOrCreateFile;i.itemProvider=o;i._uploadTeachingBubbleProvider=r;i._invalidateItem=i.createBackgroundComputed(i._computeInvalidateItem).extend({rateLimit:{timeout:4e3}});i._shouldInvalidate=!e.skipInvalidation;i._context.itemSet&&(i._currentItem=i._context.itemSet.item.peek());i._didUserUploadOrCreateFile=n;i._itemCount=0;return i}e.prototype.dispose=function(){this._shouldInvalidate&&this._invalidateItem();a.prototype.dispose.call(this)};e.prototype.onItemUploaded=function(e){if(this._currentItem){this._itemCount++;var t=this._uploadTeachingBubbleProvider;if(t&&t.isUserInUploadFRE())switch(this._itemCount){case 1:t.addBubbleToItem(e,this._currentItem,this._itemCount);break;case 2:t.updateActiveBubble(e,this._currentItem,this._itemCount)}this._didUserUploadOrCreateFile&&this._didUserUploadOrCreateFile(!0)}};e.prototype.onOperationFinished=function(e){this._shouldInvalidate&&this._invalidateItem();a.prototype.onOperationFinished.call(this,e)};e.prototype._computeInvalidateItem=function(){this._lastUploadedItem();if(!r.computedContext.isInitial()&&this._shouldInvalidate){this.itemProvider.invalidateItem(this._context.parentItem.key,{triggerFetch:!0});this._context.item&&this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}};e.dependencies=i.__assign({},o.default.dependencies,{itemProvider:n.resourceKey,uploadTeachingBubbleProvider:s.uploadTeachingBubble.optional,didUserUploadOrCreateFile:l.didUserUploadOrCreateFile.optional});return e}(o.default);t.default=d;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,d)});define("odsp-next/providers/operator/BaseUploadOperator",["require","exports","tslib","./BaseOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event","@ms/odsp-utilities/lib/path/Path","../quota/UserStateProvider.key","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,s,n,l,d,a,c,p,o,u,h,m,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,{},t)||this;i._context=e;i._uploader=new(i.scope.attached(t.batchUploaderType))(e);i._updateQuota=t.updateQuota;i.registerActions({cancel:i.onCancel,overwrite:i._onOverwrite,rename:i._onRename,restart:i._onRestart});i._lastUploadedItem=i.createObservable();return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input,o=e.error;t.type=n.default.uploadItems;t.name=i.fileName.peek();t.iconName=i.iconName.peek();t.payloads.uploadItems={parent:this._context.parentItem,name:e.output.name,item:e.input.item};0===e.output.state&&(t.state=l.default.created);0===e.status&&e.output.uploadedBytes<e.output.totalBytes&&t.actions.push(this.onCancel);t.progress.maximum=e.output.totalBytes;t.progress.current=e.output.uploadedBytes;if(2===e.status){o&&(t.error.payloads.upload={error:o});if(!i.nameConflictBehavior.peek()&&o&&o.errorType===d.UploadErrorType.conflict){t.actions.push(this._onOverwrite);i.allowRename&&t.actions.push(this._onRename)}}2!==e.status||o&&o.errorType!==d.UploadErrorType.general||t.actions.push(this._onRestart);return t};e.prototype.onStart=function(e){this._event=new o.UploadOperation({name:"UploadOperation",dragAndDrop:this._context.wasDragAndDropped,uploadType:p.UploadProcessorType[this._context.type]});this._processUploader(this._uploader,e);return this._uploader.start()};e.prototype.onCancel=function(e,t){for(var i=0,o=e;i<o.length;i++){o[i].input.abort()}return a.default.wrap()};e.prototype.onOperationFinished=function(e){var t,i,o,r=e.state.peek(),n=e.states.peek(),a=e.operations.peek(),s=e.error.peek();if(r===l.default.completed){t=c.ResultTypeEnum.Success;this._updateQuota(!0)}else t=r===l.default.canceled?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure;i=1===a.length?u.getFileExtension(e.payloads.peek().uploadItems.name):"";o=s?s.payloads.upload?s.payloads.upload.error.errorType:d.UploadErrorType.other:d.UploadErrorType.none;this._event&&this._event.end({size:e.progress.maximum.peek(),count:a.length,failCount:n.failed,successCount:n.completed,abortCount:n.canceled,resultType:t,dragAndDrop:this._context.wasDragAndDropped,uploadType:p.UploadProcessorType[this._context.type],extension:i,extraData:{uploadOperation_ErrorType:d.UploadErrorType[o]}})};e.prototype.onItemUploaded=function(e){};e.prototype._updateTaskOutput=function(e,t){return t};e.prototype._processUploader=function(e,t){var r=this;this.addDisposable(e);var n=function(e){t.update([e])},a=0;this.addDisposable(e.filesUploading.map({mappingWithDisposeCallback:function(t){var i="&u="+ ++a,o=r._createUploaderTaskSubscription(t,i,n);return{mappedValue:i,dispose:function(){o.dispose();var e=r._computeTask(t,i);0===e.status&&(e=e.cancel());n(e)}}}}))};e.prototype._onRestart=function(e,t){for(var i=0,o=e;i<o.length;i++){o[i].input.restart()}return a.default.wrap()};e.prototype._onOverwrite=function(e,t){for(var i=0,o=e;i<o.length;i++){var r=o[i];r.input.nameConflictBehavior(1);r.input.restart()}return a.default.wrap()};e.prototype._onRename=function(e,t){for(var i=0,o=e;i<o.length;i++){var r=o[i];r.input.nameConflictBehavior(2);r.input.restart()}return a.default.wrap()};e.prototype._createUploaderTaskSubscription=function(i,o,r){var n=this,a=!1,s=this.createComputed(function(){var e=n._computeTask(i,o);a=1===e.status||3===e.status;if(1===e.status){var t=n.unwrapObservable(i.item);t&&n.onItemUploaded(t);n._lastUploadedItem(t)}r(e);a&&s&&s.dispose()}).extend({rateLimit:{timeout:0}});a&&s.dispose();return s};e.prototype._computeTask=function(t,e){var i=new s.Task(e,t),o=t.state(),r=t.error(),n=t.totalBytes(),a=t.uploadedBytes();3===o?i=i.cancel():4===o?i=i.fail(r):2===o&&(i=i.succeed());i=i.changeOutput(function(e){return{state:o,totalBytes:n,uploadedBytes:a,name:t.fileName()}});return i=this._updateTaskOutput(t,i)};e.dependencies=i.__assign({},s.default.dependencies,{updateQuota:h.resourceKey,batchUploaderType:m.batchUploaderType});return e}(s.default);t.default=g;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,g)});define("@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=r.ResultTypeEnum;t.UploadOperation=i.createPairedEvent({eventName:"UploadOperation,Qos,",shortEventName:"UploadOperation"},{dragAndDrop:3,size:2,count:2,failCount:2,abortCount:2,successCount:2,extension:1,uploadType:1,errorType:1},o.Qos);t.default=t.UploadOperation});define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../SetAlbumCoverPhotoOperator","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.itemSelectionHelper,o=e.currentItem;t._itemSelectionHelper=i;t._currentItem=o;return t}e.prototype.execute=function(e){var o=this,r=this._currentItem;return this._itemSelectionHelper.resolveSelection().then(function(i){return o.resources.consumeAsync(n.typeResourceKey).then(function(e){var t=new e({album:r,items:i});return o.trackPromise(t.start())}).then(function(){return{resultType:a.ResultTypeEnum.Success}},function(e){return{resultType:a.ResultTypeEnum.Failure}})})};return e}(o.default);t.default=r});define("odsp-next/actions/setAlbumCoverPhoto/SetAlbumCoverPhotoOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/album/AlbumProvider.key","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._context=e;i._albumProvider=t.albumProvider;return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e);t.type=a.default.setAlbumCoverPhoto;t.name=this._context.album.name;t.payloads.setAlbumCoverPhoto={album:this._context.album,item:this._context.items[0]};t.visibility=0;return t};e.prototype.onStart=function(e){return this._albumProvider.setCoverPhoto(this._context,e)};e.dependencies=i.__assign({},r.default.dependencies,{albumProvider:n.resourceKey});return e}(r.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/actions/showOperations/ShowOperationsExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowOperationsExecutorViewModel","./ShowOperationsExecutor.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-show-operations-executor",template:e("./ShowOperationsExecutor.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/actions/showOperations/ShowOperationsExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../providers/operation/OperationProvider","../../controls/operation/monitor/OperationMonitor.resx","../../controls/operation/monitor/OperationMonitor","../../bindings/component/ControlBinding"],function(e,t,o,i,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({control:l.default});t.panelOverlayTagName=r.default.tagName;t.operationMonitorSpecification=l.toSpecification(s.resourceKey,{});t.panelTitle=a.strings.title;t._operationProvider=t.resources.consume(n.resourceKey);t.addDisposable(t._operationProvider.lock());return t}e.prototype.onClosePanel=function(){this.action.complete()};return e}(i.default);t.default=d});define("odsp-next/controls/overlays/panel/PanelOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PanelOverlayViewModel","./PanelOverlay.html","../../panelHost/PanelHost.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-panel-overlay",template:e("./PanelOverlay.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/overlays/panel/PanelOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../Overlay","../../../bindings/dismiss/DismissBinding","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/element/ElementBinding","../../../utilities/browser/ResponsiveUI","../../panelHost/PanelHost.resx"],function(e,t,i,o,f,b,y,v,x,_,S,k,P,r,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={},n=function(g){i.__extends(e,g);function e(e){void 0===e&&(e={});var t=g.call(this,e)||this;t.overlayTagName=f.default.tagName;t.closePanelLabel=w.strings.closePanelLabel;t.addBindingHandlers({dismiss:b.default,element:P.default,host:y.default,interactionScope:v.default,focusTrap:_.default,recoverFocus:k.default,preserveFocus:S.default,scrollContainer:x.default});var i=e.size,o=void 0===i?"Small":i,r=e.title,n=void 0===r?"":r,a=e.onClose,s=e.ariaLabel,l=void 0===s?"":s,d=e.showCloseButton,c=void 0===d||d,p=e.isOpen,u=e.width,h=void 0===u?"":u,m=e.virtualParentElement;t._size=o;t._onClose=a;t.contentElement=t.createObservable();t.title=t.wrapObservable(n);t._ariaLabel=t.wrapObservable(l);t.showCloseButton=t.createObservable(!!t._onClose&&c);t.isOpen=p;t.widthClass=t.createPureComputed(t._computeWidthClass,{deferEvaluation:!0});t.style=h?{width:h+"px"}:C;t.ariaLabel=t.createPureComputed(t._computeAriaLabel);t.virtualParentElement=m;return t}e.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()};e.prototype._computeWidthClass=function(){return this.style===C?"od-Panel--"+r.default.determineCssClass(this._size):""};e.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)};return e}(o.default);t.default=n});define("odsp-next/controls/overlays/panel/PanelOverlay.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500,\r\n isOpen: isOpen\r\n },\r\n alignToParent: false,\r\n virtualParentElement: virtualParentElement\r\n }\r\n}--\x3e<div class=od-Panel-container data-bind="focusTrap: {}, css: { \'od-Panel--hidden\': !isPanelOpen($host.isOpen) }"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role=dialog tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: isPanelOpen($host.isOpen) }, scrollContainer, dismiss: { isOpen: isOpen || $host.isOpen, close: $component.onDismiss.bind($component), useLocalEvents: true }, class: widthClass(), attr: { \'aria-label\': ariaLabel }, style: style, element: $component.contentElement">\x3c!--ko if: title--\x3e<div class="od-Panel-title ms-font-xl ms-fontWeight-semilight" data-bind="text: title"></div>\x3c!--/ko--\x3e<div class=od-Panel-content data-bind="host: {}"></div>\x3c!--ko if: showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click: $component.onClose.bind($component), attr: { \'aria-label\': $component.closePanelLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/operation/monitor/OperationMonitor",["require","exports","./OperationMonitorViewModel","../../../bindings/component/ControlBinding","./OperationMonitor.html","./OperationMonitor.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-operation-monitor",name:e("module").id,template:e("./OperationMonitor.html"),viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/operation/monitor/OperationMonitorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/operation/OperationProvider","./OperationGroupViewModel","../../../bindings/preRender/PreRenderBinding","../../progress/bar/ProgressBar","../../fileTypeIcon/FileTypeIcon","./OperationMonitor.resx","../../notifyExperiment/NotifyExperiment","../../../bindings/component/ControlBinding","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,i,o,r,p,u,h,m,g,f,b,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(c){i.__extends(e,c);function e(e,t){void 0===e&&(e={});var i=c.call(this,e,t)||this;i.noOperationsText=g.strings.noOperationsText;i.progressBarTagName=h.default.tagName;i.fileTypeIconTagName=m.default.tagName;var o=t.operationProvider,r=e.expandGroups,n=void 0===r||r,a=e.groups,s=void 0===a?o.groups:a,l=e.onViewAll,d=e.onExecuteAction;i.addBindingHandlers({preRender:u.default,control:b.default});i._groupOperations=s;i.groups=i.addDisposable(s.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(p.default))({group:e,showIndividualOperations:n,onViewAll:l,onExecuteAction:d});return{mappedValue:t,dispose:function(){t.dispose()}}}}));i.showNotifyExperiment=i.observables.createCallback(y.forSingleValue(!1));i.hideNotifyExperimentInProgressPane=n;i.notifyExperimentSpecification=b.toSpecification(f.resourceKey,{groups:i._groupOperations,showNotifyExperiment:i.showNotifyExperiment,onExecuteAction:d});return i}e.dependencies=i.__assign({},o.default.dependencies,{operationProvider:r.resourceKey});return e}(o.default);t.default=n});define("odsp-next/controls/operation/monitor/OperationGroupViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","./OperationViewModel","./OperationActionViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","../strings/OperationStringMappings","../../../providers/operation/OperationProvider","../../../bindings/html/BindableHtmlBinding","./OperationMonitor.resx"],function(e,t,i,o,r,n,a,u,h,m,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(l){i.__extends(e,l);function e(e){var t=l.call(this,e)||this;t.viewAllText=p.strings.viewAllText;t.addBindingHandlers({bindableHtml:c.default});t._group=e.group;t._showIndividualOperations=e.showIndividualOperations;t._showOneOperation=e.showOneOperation;t._onExecuteAction=e.onExecuteAction;t._onViewAll=e.onViewAll;t._disallowedActions={};t.progress=t._group.progress;t.context={count:t._group.count,states:t._group.states,progress:t._group.progress,payloads:t._group.payloads,error:t._group.error};e.stringMappings?t._stringMappings=e.stringMappings:t._stringMappings=m.default;t._operationProvider=t.resources.consume(d.resourceKey);t._showCloseAction=t.createPureComputed(t._computeShowCloseAction);t._operations=t._getOperations();var i=t._getActions(),o=i.buttonActions,r=i.iconActions;t.buttonActions=o;t.iconActions=r;var n=t._getOperationViewModels(),a=n.operations,s=n.showViewAll;t.operations=a;t.showViewAll=s;t.title=t.createComputed(t._computeTitle);t.description=t.createComputed(t._computeDescription);t.showProgress=t.createPureComputed(t._computeShowProgress);t.showDescription=t.createPureComputed(t._computeShowDescription);t.css=t.createComputed(t._computeCss);return t}e.prototype.onClickViewAll=function(e,t){if(this._onViewAll){this._onViewAll();t.stopPropagation();t.preventDefault()}};e.prototype._computeTitle=function(){var e=u.default[this._group.state()],t=h.default[h.default.multiple],i=this._getMappingForType(),o=i.states[e],r=m.default.types[t],n=r.states[e],a=o&&o.title||i.title||n&&n.title||r.title;return m.resolveEntry(a,this.context)};e.prototype._computeDescription=function(){var e=u.default[this._group.state()],t=h.default[h.default.multiple],i=this._getMappingForType().states[e],o=m.default.types[t].states[e],r=i&&i.description||o&&o.description;return m.resolveEntry(r,this.context)};e.prototype._computeShowProgress=function(){var e=this._getMappingForType().showProgress;if(e)return m.resolveEntry(e,this.context);var t=this._group;return this._showIndividualOperations&&(t.state()===u.default.started||t.progress.current()>t.progress.minimum())};e.prototype._computeShowDescription=function(){var e=this._getMappingForType().showDescription;return e?m.resolveEntry(e,this.context):this._showIndividualOperations&&(this._group.state()!==u.default.failed||!!this.buttonActions().length)};e.prototype._computeShowCloseAction=function(){var e=this._group.state();if(e!==u.default.canceled&&e!==u.default.completed&&e!==u.default.failed)return!1;var t=this._group.actions().cancel;return!t||!1===t.isAvailable()};e.prototype._computeCss=function(){return"OperationMonitor-item--"+u.default[this._group.state()]};e.prototype._getMappingForType=function(){var e=this._stringMappings.types,t=h.default[this._group.type()];return e[t+"Group"]||e[t]};e.prototype._getActions=function(){var d=this,e=this.observables.createArray(),c=this._group,t={key:"close",count:c.count,isAvailable:this._showCloseAction,execute:function(){return r.default.wrap().then(function(){d._operationProvider.deleteGroupOperation(c)})}};this._group.actions().close=t;this.createComputed(function(){e(Object.keys(c.actions()).map(function(e){return c.actions.peek()[e]}))});var p=this._disallowedActions,i=this.addDisposable(e.filter(function(e){var t=h.default[c.type()],i=d._stringMappings.types[t].actions,o=i&&i[e.key],r=m.default.actions[e.key],n=o&&o.mode||r.mode||0,a=1!==n&&3<e.count()||1===n,s=!d._showIndividualOperations&&d._group.state()!==u.default.failed||!!r.icon||a,l=!a||3===n;p[e.key]?p[e.key](!l):p[e.key]=d.createObservable(!l);return s&&e.isAvailable()})),o=this.addDisposable(i.map({mappingWithDisposeCallback:function(e){var t=new(d.managed(a.default))({action:e,onExecuteAction:d._onExecuteAction,actionMapping:d._stringMappings.actions});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return{buttonActions:this.addDisposable(o.filter(function(e){return!e.icon})),iconActions:this.addDisposable(o.filter(function(e){return!!e.icon}))}};e.prototype._getOperations=function(){var t=this,e=this._group,i=this.createPureComputed(function(){return 1===e.operations().length}),o=this.createPureComputed(function(){return 10<e.operations().length}),r=this.createPureComputed(function(){return e.states().started<10}),n=this.createPureComputed(function(){return e.states().created+e.states().started<10});return this.addDisposable(e.operations.filter(function(e){return!(!t._showIndividualOperations&&!i()&&e.state()!==u.default.failed)&&(!(!t._showOneOperation&&i()&&e.state()!==u.default.failed)&&(!o()||e.state()===u.default.failed||(!(!n()||e.state()!==u.default.created)||!(!r()||e.state()!==u.default.started))))}))};e.prototype._getOperationViewModels=function(){var e,i=this,t=this.observables;if(this._showIndividualOperations)e=this._operations;else{e=t.createArray();t.compute(function(){e.splice.apply(e,[0,1/0].concat(i._operations().slice(0,1)))})}return{operations:this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(n.default))({operation:e,onExecuteAction:i._onExecuteAction,disallowedActions:i._disallowedActions,stringMapping:i._stringMappings});return{mappedValue:t,dispose:function(){t.dispose()}}}})),showViewAll:t.pureCompute(function(){return!!i._onViewAll&&e().length<i._operations().length})}};return e}(o.default);t.default=s});define("odsp-next/controls/operation/monitor/OperationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","./OperationActionViewModel","../strings/OperationStringMappings","../../../bindings/html/BindableHtmlBinding","knockout"],function(e,t,o,i,a,s,r,l,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({bindableHtml:n.default});t._operation=e.operation;t._onExecuteAction=e.onExecuteAction;t._disallowedActions=e.disallowedActions||{};e.stringMapping?t._stringMappings=e.stringMapping:t._stringMappings=l.default;t.context={count:t._operation.count,states:t.createComputed(t._computeStates),progress:t._operation.progress,payloads:t._operation.payloads,error:t._operation.error};t.progress=t._operation.progress;t.iconName=t._operation.iconName;t._initializeActions();t.title=t.createComputed(t._computeTitle);t.description=t.createComputed(t._computeDescription);t.css=t.createPureComputed(t._computeCss);t.showProgress=t.createPureComputed(t._computeShowProgress);return t}e.prototype._computeStates=function(){var e={created:0,started:0,completed:0,failed:0,canceled:0,expired:0};e[a.default[this._operation.state()]]=1;return e};e.prototype._computeTitle=function(){return this._operation.name};e.prototype._computeDescription=function(){var e=a.default[this._operation.state()],t=s.default[this._operation.type()],i=s.default[s.default.multiple],o=this._stringMappings.types[t].states[e],r=l.default.types[i].states[e],n=o&&o.description||r&&r.description;return this._evaluateOperationEntry(n)};e.prototype._initializeActions=function(){var i=this,e=d.observableArray();this.createComputed(function(){e(Object.keys(i._operation.actions()).map(function(e){return i._operation.actions.peek()[e]}))});var t=this.addDisposable(e.filter(function(e){return(!i._disallowedActions[e.key]||!i._disallowedActions[e.key]())&&e.isAvailable()})),o=this.addDisposable(t.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(r.default))({action:e,onExecuteAction:i._onExecuteAction,actionMapping:i._stringMappings.actions});return{mappedValue:t,dispose:function(){t.dispose()}}}}));this.buttonActions=this.addDisposable(o.filter(function(e){return!e.icon}));this.iconActions=this.addDisposable(o.filter(function(e){return!!e.icon}))};e.prototype._computeCss=function(){return"OperationMonitor-item--"+a.default[this._operation.state()]};e.prototype._computeShowProgress=function(){var e=this._operation;return e.state()!==a.default.created&&e.progress.current()>e.progress.minimum()||this._evaluateOperationEntry(this._stringMappings.types[s.default[e.type.peek()]].showProgress)};e.prototype._evaluateOperationEntry=function(e){return"function"==typeof e?e(this.context):e};return e}(i.default);t.default=c});define("odsp-next/controls/operation/monitor/OperationActionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../strings/OperationStringMappings","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._action=e.action;t._onExecuteAction=e.onExecuteAction;t._context={count:t._action.count,states:t.createObservable({}),payloads:t.createObservable({}),progress:null,error:t.createObservable()};t.key=t._action.key;var i=e.actionMapping,o=void 0===i?n.default.actions:i;t._actionMapping=o[t.key];t.icon=t._actionMapping.icon;t.title=t.createPureComputed(t._computeTitle);t.iconCss=t.createPureComputed(t._computeIconCss);return t}e.prototype.execute=function(){var e=this;a.default.wrap().then(function(){return e._action.execute()}).done();this._onExecuteAction&&this._onExecuteAction()};e.prototype._computeTitle=function(){return n.resolveEntry(this._actionMapping.name,this._context)};e.prototype._computeIconCss=function(){return this.icon&&this.icon.getClass()||""};return e}(o.default);t.default=r});define("odsp-next/bindings/preRender/PreRenderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(s){i.__extends(e,s);function e(e){for(var t=s.call(this,e)||this,i=[],o=0,r=l.virtualElements.childNodes(t.element);o<r.length;o++){var n=r[o];i.push(n)}l.virtualElements.emptyNode(t.element);var a=document.createElement(t.element.tagName);l.applyBindingsToNode(a,{template:{nodes:i}},t.bindingContext);t.element.appendChild(a);t.controlsDescendantBindings=!0;return t}return e}(o.default);t.default=r});define("odsp-next/controls/notifyExperiment/NotifyExperiment",["require","exports","./NotifyExperimentViewModel","../../bindings/component/ControlBinding","./NotifyExperiment.html","./NotifyExperiment.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-notify-experiment",name:e("module").id,template:e("./NotifyExperiment.html"),viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/notifyExperiment/NotifyExperimentViewModel",["require","exports","tslib","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-utilities/lib/logging/ABExperiment","../../utilities/features/Features","@ms/odsp-shared-sharing/lib/Share","@ms/odsp-utilities/lib/icons/ItemType","../sharing/share/react/Share","office-ui-fabric-react/lib/Utilities","../../bindings/react/ReactBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/AutoFocusBinding","../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,i,o,r,a,s,l,d,c,p,u,h,m,g,f,n,b,y,v,x,_,S,k,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=n.ClientId.sharePoint,C=n.Mode.notify,I=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this;i.addBindingHandlers({react:x.default,focusTrap:_.default,autoFocus:S.default});var o=e.groups,r=e.onExecuteAction;i._pageContext=t.pageContext;i._actionMap=t.actionMap;i._peoplePickerProvider=t.peoplePickerProvider;i._graphPeoplePickerHelper=t.graphPeoplePickerHelper;i._sharingProvider=t.sharingProvider;i._suiteNavProvider=t.suiteNavProvider;i._policyTipProvider=t.policyTipProvider;i.isImplicitShareNotifyEnabled=f.isFeatureEnabled(f.ImplicitShareNotify);i.isForceImplicitSharingExperimentEnabled=f.isFeatureEnabled(f.isForceImplicitSharingExperimentEnabled);i._groupOperations=o;i._onExecuteAction=r;i.element=i.observables.create(null);i._itemToShare=i.observables.pureCompute(i._computeItemToShare);i.showNotifyExperiment=i.observables.pureCompute(i._computeShowNotifyExperiment);i.scope.attach(e.showNotifyExperiment.register(i.showNotifyExperiment));i.shareComponent=y.default;i.shareComponentProps=i.createPureComputed(i._computeShareProps);return i}e.prototype._computeShowNotifyExperiment=function(){var e=k.default.isActivated("2bdb9988-fee9-4cb2-8625-474d848d43bc","06/05/2018","Implicit Sharing on upload experiment");if(!this._policyTipProvider||!this._pageContext||!this._graphPeoplePickerHelper)return!1;var t=Number(this._pageContext.webTemplate);if(t===m.default.teamSite||t===m.default.group){var i=this._itemToShare();if(i&&this.isImplicitShareNotifyEnabled&&!e){return(new g.ABExperiment({name:"ImplicitSharingNotificationV3",startDate:"07/13/2018"}).IsExperimentOn()||this.isForceImplicitSharingExperimentEnabled)&&i.type!==b.ItemType.Folder&&!!i.properties.uniqueId}}return!1};e.prototype._computeShareProps=function(){var e=this._itemToShare();return{clientId:w,actionMap:this._actionMap,item:e,onDismiss:this._onDismiss,peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper,resources:this.resources,sharingProvider:this._sharingProvider,suiteNavProvider:this._suiteNavProvider,policyTipProvider:this._policyTipProvider,mode:C}};e.prototype._onDismiss=function(){var e=this._itemToShare(),t={name:"Notify.Dismissed",clientId:w,mode:C,appMap:e.appMap};P.Engagement.logData(t);this._onExecuteAction()};e.prototype._computeItemToShare=function(){var e=this._groupOperations();if(1===e.length){var t=e[0].operations();if(1===t.length){var i=t[0];if(i.state()===u.default.completed&&i.type()===h.default.uploadItems){var o=i.payloads().uploadItems;if(o)return o.item()}}}};e.dependencies=i.__assign({},p.default.dependencies,{pageContext:d.pageContext.optional,actionMap:c.actionMap,peoplePickerProvider:o.resourceKey,graphPeoplePickerHelper:r.resourceKey.optional,sharingProvider:a.resourceKey,suiteNavProvider:s.resourceKey,policyTipProvider:l.resourceKey.optional});i.__decorate([v.autobind],e.prototype,"_onDismiss",null);return e}(p.default);t.default=I});define("odsp-next/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(s,t);t.resourceKey=r.createResolvedResourceKey(e("module").id,n.GraphPeoplePickerHelper,{oAuthTokenProvider:a.resourceKey,pageContext:o.pageContext})});define("@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,o,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};t.DisablePeoplePickerGraphExperiment={ODB:776};var l="DisableGraph",d=function(){function e(e,t){this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.default.isFeatureEnabled(t.PeoplePickerGraph);this._dataStore&&(e=e&&!this._dataStore.getValue(l,s.default.session));e&&(e=e&&this.isInExperimentToUseGraph());return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue(l,!0,s.default.session)};e.prototype.getGraphToken=function(){var t=this;if(this._oAuthTokenProvider){var i=new n.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){i.end({resultType:n.ResultTypeEnum.Success});return e},function(e){if(o.default.isCanceled(e)){i.end({resultType:n.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return o.default.reject(e)}i.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:n.ResultTypeEnum.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message}});t.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new a.default("PeoplePicker",s.default.session))};e.prototype.isInExperimentToUseGraph=function(){if(!i.default.isFeatureEnabled(t.DisablePeoplePickerGraphExperiment)){return new r.ABExperiment({name:"UseSmartPeoplePicker",startDate:"02/28/2018"}).IsExperimentOn()}return!0};return e}();t.GraphPeoplePickerHelper=d});define("odsp-next/providers/policyTip/PolicyTipProvider",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._dataSource=t.policyTipDataSource;return i}e.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};e.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};e.dependencies=i.__assign({},n.default.dependencies,{policyTipDataSource:r.policyTip});return e}(n.default);t.default=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("@ms/odsp-datasources/lib/dataSources/web/WebTemplateType",["require","exports","tslib","../../interfaces/WebTemplateType","../../interfaces/WebTemplateType"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.default});define("@ms/odsp-shared-sharing/lib/Share",["require","exports","tslib","./components/Share/index","./components/Share/index","./components/ShareNotification/ShareNotification","./interfaces/SharingInterfaces","./interfaces/enums/OutlookAvailability"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.Share;t.ShareNotification=n.ShareNotification;t.Mode=a.Mode;t.ClientId=a.ClientId;t.OutlookAvailability=s.default});define("@ms/odsp-shared-sharing/lib/components/Share/index",["require","exports","tslib","./Share"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@ms/odsp-shared-sharing/lib/components/Share/Share",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","../CopyLink/CopyLink","../Header/Header","../../interfaces/SharingInterfaces","../ModifyPermissions/ModifyPermissions","../PermissionsList/PermissionsList","../ShareMain/ShareMain","../ShareNotification/ShareNotification","../SharePolicyDetails/SharePolicyDetails","office-ui-fabric-react/lib/Spinner","../../utilities/EngagementHelper","react","prop-types","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Fabric","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Button","../AtMention/AtMention","../Notify/Notify","@ms/odsp-utilities/lib/uri/Uri","../Share.resx","../../utilities/SharingAbilitiesHelper","../../utilities/ShareCommunicationManager","@ms/odsp-utilities/lib/events/EventGroup","../AddPeople/AddPeople","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","./Share.scss"],function(e,t,x,i,_,S,k,o,n,a,s,l,P,v,w,d,c,C,I,p,u,T,D,h,L,m,E,g,f,b,y,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){x.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._viewStates=[];i._platformDetection=t.platformDetection;i._dismiss=t.onDismiss;i._resize=t.resize;i._store=t.sharingStore;i.isMacV4ExperimentOn=t.isMacV4ExperimentOn;i.isColorsExperimentOn=!1;if(!(i._platformDetection.isIOS||C.isOfficeProduct(i.props.clientId)&&i._platformDetection.isMac||M.Killswitch.isActivated("49ae7406-2d60-435b-8186-cae5a9e5b525","6/25/2018","Permission Icons Color Update Experiment"))){var o=new y.ABExperiment({name:"PermissionIconColors",startDate:"06/25/2018",version:y.ABExpHash.v2});i.isColorsExperimentOn=o.IsExperimentOn()}e.theme&&i._loadTheme(e.theme);i.state={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:k.ShareType.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:e.messageText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients()};i._engagementExtraData={clientId:e.clientId,scenarioId:e.scenarioId,mode:e.mode||(e.copyLinkShortcut?k.Mode.copy:k.Mode.share)};return i}e.prototype.componentDidMount=function(){var b=this;v.opened(this._engagementExtraData);var y=this._store;new g.default(this).on(window,"keydown",function(e){e&&27===e.keyCode&&b._handleEscKeyPress(e)});y.addListener(function(){var e=y.getSharingInformation(),t=y.getSharingLinkCreated(),i=y.getCompanyName(),o=y.getGroupsMemberCount(),r=y.getPolicyTipInformation(),n=y.getPermissionsMap(),a=y.getDefaultRecipients();b._outlookAvailability=y.getOutlookAvailability();if(e){var s=b.state.currentSettings;if(!s&&e&&!e.error){var l=e.defaultSharingLink;if(e.sharingLinks&&e.sharingLinks.length&&b.props.shareId)for(var d=0,c=e.sharingLinks;d<c.length;d++){var p=c[d];if(p.shareId===b.props.shareId){l=p;break}}s=b._initializeCurrentSettings(l,e,b.props.copyLinkShortcut)}if(t&&(b.state.shareTargetClicked||b.props.copyLinkShortcut||b.state.applyLinkSettingsClicked)){b._modifiedSharingLinkUrl=b._trackClickThru(t,s,e);var u=b.state.shareType,h=b.state.currentSettings,m=h?h.isEdit:s.isEdit,g=x.__assign({},b._engagementExtraData,{shareType:u,audience:t.audience,isEdit:m,recipientsCount:b.state.recipientsCount,externalRecipientsCount:b.state.externalRecipientsCount,hasMessage:b.state.hasMessage,messageLength:b.state.messageLength,daysUntilExpiry:b._getNumberOfDaysUntilExpiry(t),isDefaultLink:e.defaultSharingLink.sharingLinkKind===t.sharingLinkKind});v.shareCompleted(g);E.shareCompleted(b.state.shareType);if(u===k.ShareType.outlook||u===k.ShareType.nonOutlook)if(C.showOWAShareTarget(b.props.clientId)){b._store.navigateToOwa(b._getRecipientEmails(b.state.linkRecipients),b._modifiedSharingLinkUrl);E.outlookClicked();b._dismiss()}else try{window.external.SendViaOutlookWithContext(b._getRecipientEmails(b.state.linkRecipients),b.state.linkRecipients.length,b.state.messageText,b._modifiedSharingLinkUrl)}catch(e){}else if(u===k.ShareType.teams){b._dismiss();E.teamsClicked(t)}else if(u===k.ShareType.moreApps)try{b.setState({viewState:3,sharingLinkCreated:t,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(t.url)}catch(e){}else b.props.mode===k.Mode.linkSettings?E.linkSettingsCompleted(t,i,b.props.customLabeledAudienceConfig):b.setState({viewState:3,sharingLinkCreated:t,showActivityIndicator:!1})}else{if(b.props.copyLinkShortcut&&e&&!e.error&&!b._copyLinkShortcutInvoked){b._copyLinkShortcutInvoked=!0;b._onCopyLinkClicked(!0,s)}var f=x.__assign({},b.state,{sharingInformation:e,companyName:i,groupsMemberCount:o,currentSettings:s,policyTipInformation:r,isLoadingDefaultRecipients:y.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:n});if(a&&!a.isConsumed){f.linkRecipients=a.recipients;b._store.consumeDefaultRecipients()}b.setState(f)}}});y.fetchSuiteNavInformation();y.fetchSharingInformation(this.props.copyLinkShortcut||this.props.mode===k.Mode.linkSettings||this.props.mode===k.Mode.manageAccess||this.props.mode===k.Mode.notify);y.fetchPolicyTipInformation()};e.prototype.componentDidUpdate=function(e,t){this._resize()};e.prototype.render=function(){var e,t=L.default,i=this.props,o=i.copyLinkShortcut,r=i.clientId,n=i.showExistingAccessOption,a=i.createPeopleSharingLinks,s=i.mode,l=this.state,d=l.sharingInformation,c=l.currentSettings,p=l.showActivityIndicator,u=l.companyName,h=l.sharingLinkCreated,m=l.viewState,g=l.groupsMemberCount,f=l.linkRecipients,b={maxHeight:this.props.maxHeight||"none"};if(d&&d.error){E.pageError(d);e=w.createElement("div",{className:"od-Share"},w.createElement(S.Header,{viewState:7}),w.createElement("div",{className:"od-Share-error"},d.errorMessage))}else if(d&&c&&!o&&s===k.Mode.share){var y=p?" od-Share--hasActivity":"";e=w.createElement("div",{className:"od-Share"+y,style:b},this._renderBackButton(),this._renderViews(),this._renderActivityIndicator())}else if(d&&c&&o&&h)e=w.createElement("div",{className:"od-Share",style:b},w.createElement(_.CopyLink,{clientId:r,mode:this.props.mode,scenarioId:this.props.scenarioId,companyName:u,currentSettings:c,item:d.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(h.createdViaCopyLinkCommand),sharingInformation:d,showExistingAccessOption:n,viewState:m,groupsMemberCount:g,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:a,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));else if(d&&c&&s===k.Mode.atMention)e=w.createElement("div",null,w.createElement(T.AtMention,{clientId:r,scenarioId:this.props.scenarioId,currentSettings:c,sharingInformation:d,recipients:f}));else if(c&&s===k.Mode.linkSettings){y=p?" od-Share--hasActivity":"";e=w.createElement("div",{className:"od-Share"+y,style:b},this._renderModifyPermissions(8),this._renderActivityIndicator())}else if(c&&s===k.Mode.manageAccess)e=w.createElement("div",{className:"od-Share",style:b},this._renderPermissionsList());else if(s===k.Mode.share&&this.props.enableShimmer){e=w.createElement("div",{className:"od-Share od-Share--hasShimmer",style:b},this._renderShareMainShimmer());this._viewStates.push(1)}else if(d&&s===k.Mode.notify){c.sharingLinkKind=1;c.audience=3;this._engagementExtraData=x.__assign({},this._engagementExtraData,{appMap:d.item.appmap});e=w.createElement(D.Notify,{clientId:r,scenarioId:this.props.scenarioId,currentSettings:c,sharingInformation:d,engagementExtraData:this._engagementExtraData})}else e=d&&s===k.Mode.addPeople?w.createElement("div",{className:"od-Share",style:b},this._renderAddPeople()):w.createElement("div",{className:"od-Share"},w.createElement("div",{className:"od-Share-spinnerHolder"},w.createElement(P.Spinner,{className:"od-Share-spinner",label:t.componentLoading,size:P.SpinnerSize.large})));var v=this.isColorsExperimentOn?"is-in-colors-experiment":"";v=(this.isMacV4ExperimentOn?"is-in-mac-v4-experiment ":"")+v;return w.createElement(I.Fabric,null,w.createElement("span",{role:"status","aria-live":"assertive",className:"od-Share-screenReaderOnly"},this._getCurrentPageLabel()),w.createElement("div",{className:v},e))};e.prototype._getRecipientEmails=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i].email;r&&t.push(r)}return t};e.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),i=new Date;if(t){var o=(t.getTime()-i.getTime())/864e5;return Math.floor(o)}};e.prototype._copyLinkOnCancelClicked=function(){var e=this;this.setState({viewState:3},function(){v.linkSettingsCancelClicked(e._engagementExtraData)})};e.prototype._copyLinkOnApplyClicked=function(e){var t=this;this.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){v.linkSettingsApplyClicked(t._engagementExtraData);t._onCopyLinkClicked(!0)})};e.prototype._handleEscKeyPress=function(e){var t=this.state.viewState,i=2===t,o=4===t,r=this.props.mode===k.Mode.share;r&&i?this._onLinkPermissionsCancelClicked():r&&o?this._onBackButtonClicked():this._dismiss();e.stopPropagation()};e.prototype._initializeCurrentSettings=function(e,t,i){if(t.requiresAccessApproval&&i)return{allowEditing:!0,audience:3,expiration:null,isEdit:!0,sharingLinkKind:1,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1};if(t.defaultSharingLink===e&&this.context.usesSharingAbilities&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,i);if(0===e.audience){var o=this.props.mode===k.Mode.linkSettings&&this.props.clientId===k.ClientId.outlookWeb;if(!t.canManagePermissions||t.blockPeoplePickerAndSharing||o)e.audience=3;else if(this.props.createPeopleSharingLinks)return{allowEditing:!0,audience:4,expiration:null,isEdit:!0,sharingLinkKind:6,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1}}if(4===e.audience&&i){e.audience=3;e.sharingLinkKind=1}var r=e.sharingLinkKind;return{allowEditing:5===r||3===r||1===r||6===r,audience:e.audience,expiration:e.expiration||null,isEdit:e.isEdit&&2===t.defaultShareLinkPermission,sharingLinkKind:e.sharingLinkKind,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1}};e.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,i){var o=t.sharingAbilities,r=t.defaultSharingLink.sharingLinkKind,n=0;switch(r){case 5:case 4:n=2;break;case 3:case 2:n=1;break;case 1:default:!t.canManagePermissions||t.blockPeoplePickerAndSharing?n=3:this.props.createPeopleSharingLinks&&(n=o.peopleSharingLinkAbilities.canManageEditLink.enabled||o.peopleSharingLinkAbilities.canManageReadLink.enabled?4:3)}if(4===n&&i){n=3;r=1}var a=null,s=m.getSharingAbilitiesByAudience(n,o).linkExpiration;0<(s?s.defaultExpirationInDays:null)&&(a=new Date((new Date).toDateString())).setDate(a.getDate()+s.defaultExpirationInDays);var l=m.isEditingAllowed(n,o);return{allowEditing:l,audience:n,expiration:a,isEdit:l&&2===t.defaultShareLinkPermission,sharingLinkKind:r,specificPeople:[],updatePassword:!1,password:""}};e.prototype._loadTheme=function(e){try{var t=e;b.loadTheme(t)}catch(e){}};e.prototype._onShareTargetClicked=function(e){if(e===k.ShareType.copy){E.copyLinkShareTargetClicked();this._onCopyLinkClicked()}else e===k.ShareType.outlook?this._onOutlookClicked():e===k.ShareType.nonOutlook?this._onNonOutlookClicked():e===k.ShareType.teams?this._onTeamsClicked():e===k.ShareType.moreApps&&this._onMoreAppsClicked()};e.prototype._onCopyLinkClicked=function(e,t){var i=this,o=x.__assign({},t,this.state.currentSettings);this.setState({shareType:k.ShareType.copy,shareTargetClicked:!0},function(){i._store.shareLink(o,i.state.linkRecipients,void 0,e)})};e.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:k.ShareType.outlook,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:k.ShareType.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:k.ShareType.teams,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:k.ShareType.moreApps,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onLinkPermissionsApplyClicked=function(e){var t=this;v.linkSettingsApplyClicked(this._engagementExtraData);this._onSelectedPermissionsChange(e);this.props.mode===k.Mode.linkSettings&&this.setState({shareType:k.ShareType.share,applyLinkSettingsClicked:!0},function(){t._store.shareLink(e,t.state.linkRecipients,void 0,!1)})};e.prototype._onLinkPermissionsCancelClicked=function(){var e=this;this.props.mode===k.Mode.linkSettings&&E.dismiss();this.setState({viewState:0},function(){v.linkSettingsCancelClicked(e._engagementExtraData)})};e.prototype._onBackButtonClicked=function(){this.setState({viewState:this._viewStates.pop()})};e.prototype._onLinkPermissionsReady=function(){this.props.mode===k.Mode.linkSettings&&E.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;3===e.audience?this._store.checkPermissions(this.state.linkRecipients):t={};this.setState({viewState:0,currentSettings:{allowEditing:e.allowEditing,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,preventDownload:e.preventDownload},permissionsMap:t})};e.prototype._onSelectedPeopleChange=function(e){var t=this,i=this.state.permissionsMap;3===this.state.currentSettings.audience&&this._store.checkPermissions(e);this.setState({linkRecipients:e,permissionsMap:i},function(){t._store.fetchGroupsMemberCount(e)})};e.prototype._onSendLinkClicked=function(e){var t=this,i=this.state.linkRecipients;this.setState({shareType:k.ShareType.share,recipientsCount:i.length,externalRecipientsCount:c.getExternalPeopleCount(i),hasMessage:!!e,messageLength:e?e.length:0,shareTargetClicked:!0},function(){E.sendLinkClicked();t._store.shareLink(t.state.currentSettings,i,e)})};e.prototype._onViewPolicyTipClicked=function(){this.setState({viewState:6})};e.prototype._onSendLinkMessageChange=function(e){this.setState({messageText:e})};e.prototype._onShareTargetsRendered=function(e){var t=x.__assign({},this._engagementExtraData,{shareTargets:e});v.shareTargets(t)};e.prototype._renderBackButton=function(){if(6===this.state.viewState)return w.createElement(u.IconButton,{className:"od-Share-backButton",onClick:this._onBackButtonClicked,iconProps:{iconName:"Back"}},w.createElement("label",{className:"od-Share-screenReaderOnly"},L.default.backButtonLabel))};e.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 3:return this._renderNotification();case 4:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};e.prototype._renderShareMain=function(e,t){this._viewStates.push(0);return w.createElement(a.ShareMain,{key:"share",clientId:this.props.clientId,scenarioId:this.props.scenarioId,companyName:this.state.companyName,currentSettings:t,item:e.item,onPolicyClick:this._showPolicy,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,onSendLinkMessageChange:this._onSendLinkMessageChange,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this._onShareTargetsRendered,enableShimmer:this.props.enableShimmer,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this.props.createPeopleSharingLinks,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients})};e.prototype._renderPolicyDetails=function(){return w.createElement(l.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};e.prototype._renderModifyPermissions=function(e){this._viewStates.push(e);return w.createElement(o.ModifyPermissions,{clientId:this.props.clientId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onReady:this._onLinkPermissionsReady,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:!1,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})};e.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,i=e.sharingLinkCreated,o={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:this._getNotificationHintClickHandler(i.createdViaCopyLinkCommand),linkRecipients:e.shareType===k.ShareType.share?this.state.linkRecipients:null};return w.createElement(s.ShareNotification,{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,clientId:this.props.clientId,sharingHintProps:o,shouldCopyLinkToClipboard:!0})};e.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};e.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:3,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,defaultSharingLink:void 0,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:0,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null};return this._renderShareMain(t,e)};e.prototype._renderPermissionsList=function(){this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0);return w.createElement(n.PermissionsList,{clientId:this.props.clientId,scenarioId:this.props.scenarioId,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,viewState:this.state.viewState,backButtonClicked:this._onBackButtonClicked})};e.prototype._renderAddPeople=function(){return w.createElement(f.AddPeople,{sharingInformation:this.state.sharingInformation,clientId:this.props.clientId})};e.prototype._showModifyPermissions=function(e){var t=this;this.setState({viewState:2},function(){v.linkSettingsOpened(t._engagementExtraData)})};e.prototype._showPermissionsList=function(){v.manageAccessOpened(this._engagementExtraData);var e=this.props.onManageAccessClicked;e?e():this.setState({viewState:4})};e.prototype._showPolicy=function(){this.setState({viewState:6})};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return w.createElement(p.ActivityIndicator,{message:L.default.applyingLinkSettings})};e.prototype._getCurrentPageLabel=function(){var e,t=L.default,i=((e={})[2]=t.pageLabelLinkSettings,e[3]=t.pageLabelLinkCreated,e[4]=t.pageLabelManageAccess,e[6]=t.pageLabelPolicyTipDetails,e[0]=t.pageLabelSendLink,e)[this.state.viewState]||"";this.props.mode===k.Mode.atMention&&(i=t.grantAccessPageLabel);this.state.showActivityIndicator&&(i=t.applyingLinkSettings+i);return i};e.prototype._trackClickThru=function(e,t,i){var o=this.state.shareType,r=e.url;if(o!==k.ShareType.copy&&o!==k.ShareType.outlook)return r;var n=this._getBase62Id();this._logClickThru(n,e,t,i);var a=new h.default(r);a.setQueryParameter("e",n);return a.toString()};e.prototype._logClickThru=function(e,t,i,o){var r=this.state,n=x.__assign({},this._engagementExtraData,{shareType:r.shareType,audience:t.audience,isEdit:i.isEdit,recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,hasMessage:this.state.hasMessage,messageLength:this.state.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(t),isDefaultLink:o.defaultSharingLink.sharingLinkKind===t.sharingLinkKind,clickThruId:e,clickThruScenario:k.ShareType[r.shareType]});v.trackClickThru(n)};e.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],i=0;i<e.length;i++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[i]%62]);return t.join("")};e.contextTypes={resize:d.func.isRequired,onDismiss:d.func.isRequired,sharingStore:d.object.isRequired,usesSharingAbilities:d.bool.isRequired,platformDetection:d.object.isRequired,breakpoint:d.object.isRequired,isMacV4ExperimentOn:d.bool.isRequired};x.__decorate([i.autobind],e.prototype,"_copyLinkOnCancelClicked",null);x.__decorate([i.autobind],e.prototype,"_copyLinkOnApplyClicked",null);x.__decorate([i.autobind],e.prototype,"_loadTheme",null);x.__decorate([i.autobind],e.prototype,"_onShareTargetClicked",null);x.__decorate([i.autobind],e.prototype,"_onCopyLinkClicked",null);x.__decorate([i.autobind],e.prototype,"_onOutlookClicked",null);x.__decorate([i.autobind],e.prototype,"_onNonOutlookClicked",null);x.__decorate([i.autobind],e.prototype,"_onTeamsClicked",null);x.__decorate([i.autobind],e.prototype,"_onMoreAppsClicked",null);x.__decorate([i.autobind],e.prototype,"_onLinkPermissionsApplyClicked",null);x.__decorate([i.autobind],e.prototype,"_onLinkPermissionsCancelClicked",null);x.__decorate([i.autobind],e.prototype,"_onBackButtonClicked",null);x.__decorate([i.autobind],e.prototype,"_onLinkPermissionsReady",null);x.__decorate([i.autobind],e.prototype,"_onSelectedPermissionsChange",null);x.__decorate([i.autobind],e.prototype,"_onSelectedPeopleChange",null);x.__decorate([i.autobind],e.prototype,"_onSendLinkClicked",null);x.__decorate([i.autobind],e.prototype,"_onViewPolicyTipClicked",null);x.__decorate([i.autobind],e.prototype,"_onSendLinkMessageChange",null);x.__decorate([i.autobind],e.prototype,"_onShareTargetsRendered",null);x.__decorate([i.autobind],e.prototype,"_renderViews",null);x.__decorate([i.autobind],e.prototype,"_renderShareMain",null);x.__decorate([i.autobind],e.prototype,"_renderModifyPermissions",null);x.__decorate([i.autobind],e.prototype,"_renderNotification",null);x.__decorate([i.autobind],e.prototype,"_renderShareMainShimmer",null);x.__decorate([i.autobind],e.prototype,"_renderPermissionsList",null);x.__decorate([i.autobind],e.prototype,"_renderAddPeople",null);x.__decorate([i.autobind],e.prototype,"_showModifyPermissions",null);x.__decorate([i.autobind],e.prototype,"_showPermissionsList",null);x.__decorate([i.autobind],e.prototype,"_showPolicy",null);x.__decorate([i.autobind],e.prototype,"_trackClickThru",null);x.__decorate([i.autobind],e.prototype,"_logClickThru",null);return e}(w.Component);t.Share=r});define("@ms/odsp-shared-sharing/lib/components/CopyLink/CopyLink",["require","exports","tslib","../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/Utilities","../ModifyPermissions/ModifyPermissions","../ShareNotification/ShareNotification","../Share.resx","office-ui-fabric-react/lib/Spinner","react","../../utilities/ShareCommunicationManager"],function(e,t,i,r,n,a,s,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={shouldCopyLinkToClipboard:!0};return i}e.prototype.componentDidMount=function(){p.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 3:var i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null};return c.createElement(s.ShareNotification,{shareType:r.ShareType.copy,itemName:t.item.name,linkUrl:e.displayUrl,clientId:e.clientId,sharingHintProps:i,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard});case 2:return c.createElement(a.ModifyPermissions,{clientId:e.clientId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig});default:return c.createElement("div",{className:"od-Share-spinnerHolder"},c.createElement(d.Spinner,{className:"od-Share-spinner",label:l.default.componentLoading,type:d.SpinnerType.large}))}};e.prototype._onLinkSettingsCancelClick=function(){var e=this;this.setState({shouldCopyLinkToClipboard:!1},function(){e.props.onLinkPermissionsCancelClicked()})};e.prototype._onLinkSettingsApplyClicked=function(e){var t=this;this.setState({shouldCopyLinkToClipboard:!0},function(){t.props.onLinkPermissionsApplyClicked(e)})};i.__decorate([n.autobind],e.prototype,"_onLinkSettingsCancelClick",null);i.__decorate([n.autobind],e.prototype,"_onLinkSettingsApplyClicked",null);return e}(c.Component);t.CopyLink=o});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ModifyPermissions",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","../Header/Header","./PermissionsSettings/PermissionsSettings","office-ui-fabric-react/lib/Button","../../utilities/ShareHelper","../Share.resx","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","react","prop-types","../../utilities/SharingAbilitiesHelper","../../utilities/ShareHelper","./ModifyPermissions.scss"],function(e,t,s,a,i,r,n,l,d,c,p,u,h,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){s.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._useSharingAbilities=t.usesSharingAbilities;i._currentPassword="";i._shouldUsePassword=!1;i.state=i._initializeState();i._preventDownloadToggle=!!i.state.selectedPermissions.preventDownload;i._initializeState=i._initializeState.bind(i);i._onApplyClicked=i._onApplyClicked.bind(i);i._onCancel=i._onCancel.bind(i);i._onPeoplePickerChange=i._onPeoplePickerChange.bind(i);i._updateExpirationErrorCode=i._updateExpirationErrorCode.bind(i);i.onAudienceChange=i.onAudienceChange.bind(i);i.onEditChange=i.onEditChange.bind(i);i.onRoleChange=i.onRoleChange.bind(i);i.onExpirationChange=i.onExpirationChange.bind(i);i._onPasswordChange=i._onPasswordChange.bind(i);i._resetPasswordVariables=i._resetPasswordVariables.bind(i);i._onToggleChange=i._onToggleChange.bind(i);i._isMacV4ExperimentOn=t.isMacV4ExperimentOn;return i}e.prototype.componentDidMount=function(){this.props.onReady&&this.props.onReady()};e.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=u.invertPermissionsButtonsOrder(this.props.clientId)||this._isMacV4ExperimentOn,i=this.props.mode===a.Mode.linkSettings&&this.props.clientId===a.ClientId.teams?" teams":"";return h.createElement("div",{className:"od-ModifyPermissions"+e+i},h.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:2,mode:this.props.mode}),h.createElement("div",{className:"od-ModifyPermissions-section"},h.createElement(n.PermissionsSettings,{mode:this.props.mode,companyName:f.truncateOrganizationName(this.props.companyName),clientId:this.props.clientId,currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})),t?h.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderDefaultButton(),this._renderPrimaryButton()):h.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator())};e.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions,i=t.isEdit,o=this._isAllowEditingEnabled(e),r=o&&i,n=d.getLinkKind(e,r),a={allowEditing:o,audience:e,expiration:2===e?t.expiration:d.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),isEdit:r,sharingLinkKind:n,specificPeople:[],updatePassword:!1,password:""};this.setState(s.__assign({},this.state,{peoplePickerError:null,selectedPermissions:a}))};e.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,i=d.getLinkKind(t.audience,e);this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},t,{isEdit:e,sharingLinkKind:i,preventDownload:!1}),preventDownloadDisabled:e}));this._preventDownloadToggle=!1};e.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,i=d.getLinkKind(t.audience,2===e),o=d.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},t,{sharingRole:e,isEdit:2===e,expiration:o,sharingLinkKind:i}),preventDownloadDisabled:2===e}))};e.prototype.onExpirationChange=function(e){e||(e=d.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},this.state.selectedPermissions,{expiration:e})}))};e.prototype._renderDefaultButton=function(){return h.createElement(l.DefaultButton,{onClick:this._onCancel},c.default.cancelButtonText)};e.prototype._renderPrimaryButton=function(){return h.createElement(l.PrimaryButton,{className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked},c.default.applyButtonText)};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(i.ActivityIndicator,{message:c.default.activityMessageCreatingLink})};e.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,i=e.sharingInformation,o=p.renderPickerError({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:i.canAddExternalPrincipal,sharingInformation:i,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:d.ExpirationErrorCode.none,peoplePickerError:o,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),audience:t.audience,isEdit:t.isEdit,sharingRole:t.sharingRole,expiration:t.expiration||d.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,preventDownload:t.preventDownload},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience)}};e.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==d.ExpirationErrorCode.none||!!this.state.peoplePickerError};e.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(s.__assign({},this.state,{expirationErrorCode:e}))};e.prototype._onCancel=function(){this.props.onCancel()};e.prototype._onApplyClicked=function(){var e=this,t=this.state,i=t.selectedPermissions,o=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input");if(o&&o.value)this.setState(s.__assign({},this.state,{peoplePickerError:h.createElement("span",null,c.default.unresolvedTextError)}));else if(4!==i.audience||0!==i.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==a.Mode.linkSettings){var r=this.props.doesCreate,n=2!==i.audience?null:i.expiration;this.setState(s.__assign({},t,{selectedPermissions:s.__assign({},i,{expiration:n,updatePassword:this._shouldUsePassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle}),showActivityIndicator:r}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}else this.setState(s.__assign({},this.state,{peoplePickerError:h.createElement("span",null,c.default.recipientsRequiredError)}))};e.prototype._onPeoplePickerChange=function(e){var t=p.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&0===this.state.selectedPermissions.audience){for(var i=!1,o=!1,r=0,n=e;r<n.length;r++){var a=n[r];i||(i=a.isExternal&&!a.providerName);o||(o=!a.isExternal||a.isExternal&&!!a.providerName)}i&&o&&(t=h.createElement("span",null,c.default.mixedRecipientErrorMessage))}this.setState(s.__assign({},this.state,{peoplePickerError:t,selectedPermissions:s.__assign({},this.state.selectedPermissions,{specificPeople:e})}))};e.prototype._onPasswordChange=function(e){this._currentPassword=e;this._shouldUsePassword=!0};e.prototype._resetPasswordVariables=function(){this._currentPassword="";this._shouldUsePassword=!1};e.prototype._onToggleChange=function(e){this._preventDownloadToggle=e;this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},this.state.selectedPermissions,{preventDownload:e})}))};e.prototype._computeIsEditLink=function(e){return 5===e||3===e||1===e};e.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;if(this._useSharingAbilities&&t)return g.isEditingAllowed(e,t);if(4===e)return!0;for(var i=this.props.sharingInformation.sharingLinks,o=3===e?0:e,r=!1,n=0,a=i.filter(function(e){return o===e.audience});n<a.length;n++){var s=a[n];this._computeIsEditLink(s.sharingLinkKind)&&(r=!0)}return r};e.contextTypes={usesSharingAbilities:m.bool.isRequired,isMacV4ExperimentOn:m.bool.isRequired};return e}(h.Component);t.ModifyPermissions=o});define("@ms/odsp-shared-sharing/lib/components/ActivityIndicator/ActivityIndicator",["require","exports","tslib","react","office-ui-fabric-react/lib/Spinner","./ActivityIndicator.scss"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return o.createElement("div",{className:"od-ActivityIndicator","aria-live":"assertive"},o.createElement("div",null,o.createElement(r.Spinner,{type:r.SpinnerType.large})),o.createElement("span",{role:"alert"},this.props.message))};return t}(o.Component);t.ActivityIndicator=n});define("office-ui-fabric-react/lib/Spinner",["require","exports","tslib","./components/Spinner/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Spinner/index",["require","exports","tslib","./Spinner","./Spinner.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Spinner/Spinner",["require","exports","../../Utilities","./Spinner.base","./Spinner.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Spinner=i.styled(o.SpinnerBase,r.getStyles,void 0,{scope:"Spinner"})});define("office-ui-fabric-react/lib/components/Spinner/Spinner.base",["require","exports","tslib","react","./Spinner.types","../../Utilities"],function(e,t,h,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=f.classNamesFunction(),i=function(e){h.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.type,i=e.size,o=e.ariaLabel,r=e.ariaLive,n=e.styles,a=e.label,s=e.theme,l=e.className,d=o||a,c=f.getNativeProps(this.props,f.divProperties,["size"]),p=i;void 0===p&&void 0!==t&&(p=t===g.SpinnerType.large?g.SpinnerSize.large:g.SpinnerSize.medium);var u=b(n,{theme:s,size:p,className:l});return m.createElement("div",h.__assign({},c,{className:u.root}),m.createElement("div",{className:u.circle}),a&&m.createElement("div",{className:u.label},a),d&&m.createElement("div",{role:"status","aria-live":r},m.createElement(f.DelayedRender,null,m.createElement("div",{className:u.screenReaderText},d))))};t.defaultProps={size:g.SpinnerSize.medium,ariaLive:"polite"};return t}(f.BaseComponent);t.SpinnerBase=i});define("office-ui-fabric-react/lib/components/Spinner/Spinner.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.xSmall=0]="xSmall";e[e.small=1]="small";e[e.medium=2]="medium";e[e.large=3]="large"}(t.SpinnerSize||(t.SpinnerSize={}));!function(e){e[e.normal=0]="normal";e[e.large=1]="large"}(t.SpinnerType||(t.SpinnerType={}))});define("office-ui-fabric-react/lib/components/Spinner/Spinner.styles",["require","exports","./Spinner.types","../../Styling"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s.keyframes({"0%":{transform:"rotateZ(0deg)"},"100%":{transform:"rotateZ(360deg)"}});t.getStyles=function(e){var t,i=e.theme,o=e.size,r=e.className,n=i.palette;return{root:["ms-Spinner",r],circle:["ms-Spinner-circle",{margin:"auto",boxSizing:"border-box",borderRadius:"50%",width:"100%",height:"100%",border:"1.5px solid "+n.themeLight,borderTopColor:n.themePrimary,animationName:l,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[s.HighContrastSelector]={borderTopColor:"Highlight"},t)},o===a.SpinnerSize.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],o===a.SpinnerSize.small&&["ms-Spinner--small",{width:16,height:16}],o===a.SpinnerSize.medium&&["ms-Spinner--medium",{width:20,height:20}],o===a.SpinnerSize.large&&["ms-Spinner--large",{width:28,height:28}]],label:["ms-Spinner-label",{color:n.themePrimary,marginTop:10,textAlign:"center"}],screenReaderText:s.hiddenContentStyle}}});define("@ms/odsp-shared-sharing/lib/components/ActivityIndicator/ActivityIndicator.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}"}])});define("@ms/odsp-shared-sharing/lib/components/Header/Header",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/ContextualMenu","../../interfaces/SharingInterfaces","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareHelper","../SendButton/SendButton","../SendButton/SendButtonType","../Share.resx","@ms/odsp-utilities/lib/browser/ResponsiveUI","./Header.scss"],function(e,t,i,r,n,a,s,l,d,c,p,u,h,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={showContextualMenu:!1,target:null};i._onDismiss=t.onDismiss;i._platformDetection=t.platformDetection;i._breakpoint=t.breakpoint;i._onDismissMoreContextualMenu=i._onDismissMoreContextualMenu.bind(i);i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._onSendLinkClick=i._onSendLinkClick.bind(i);i._onMoreClick=i._onMoreClick.bind(i);i._isMacV4ExperimentOn=t.isMacV4ExperimentOn;return i}e.prototype.render=function(){var e=this.props;if(e.mode===s.Mode.linkSettings)return l.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName());var t=3===e.viewState||7===e.viewState||9===e.viewState,i=p.isMobile(this.props.clientId)||this._platformDetection.isMobile,o=i&&this._breakpoint>=f.default.DEFAULT_BREAKPOINTS.Large,r=t?"":" od-ShareHeader-backgroundColor",n=t?"":l.createElement("div",{className:"od-ShareHeader"+r},l.createElement("div",{className:"od-ShareHeader-title"},l.createElement("div",{className:"od-ShareHeader-viewName"},this._getViewName()),this._renderItemName())),a=i?l.createElement("div",{className:"od-ShareHeader-buttons-left"},this._renderCloseButton()):"";return l.createElement("div",null,a,n,this._renderRightHeaderButtons(i,o,t,e.viewState),this._renderContextualMenu())};e.prototype._renderMoreButton=function(){if(0===this.props.viewState&&!this.props.hideShareDialogOverflowButton)return l.createElement("button",{className:"od-ShareHeader-button","aria-label":g.default.moreOptionsLabel,onClick:this._onMoreClick,"aria-haspopup":!0,"aria-expanded":this.state.showContextualMenu},l.createElement(n.Icon,{iconName:"More"}))};e.prototype._renderCloseButton=function(){if(this._onDismiss&&p.showCloseButton(this.props.clientId)&&4!==this.props.viewState)return l.createElement("button",{className:"od-ShareHeader-button","aria-label":g.default.closeButtonLabel,onClick:this._dismissComponent},l.createElement(n.Icon,{iconName:"Cancel"}))};e.prototype._dismissComponent=function(e){e.stopPropagation();e.preventDefault();this._onDismiss()};e.prototype._renderRightHeaderButtons=function(e,t,i,o){return!e||t||i||0!==o?e&&t||e&&!t&&(i||0!==o)?"":l.createElement("div",{className:"od-ShareHeader-buttons-right"},this._isMacV4ExperimentOn?"":this._renderMoreButton(),this._renderCloseButton()):l.createElement("div",{className:"od-ShareHeader-button-send-right"},l.createElement(h.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,messageText:this.props.messageText,onSendLinkClicked:this.props.onSendLinkClick,permissionsMap:this.props.permissionsMap,sendButtonType:m.default.link,sharingInformation:this.props.sharingInformation}))};e.prototype._renderItemName=function(){var e=this.props,t=e.item;if(t){var i=1<t.childCount?" ("+c.format(g.default.folderHeader,t.childCount)+")":"";return p.hideItemName(e.clientId)?void 0:l.createElement("div",{className:"od-ShareHeader-itemName"},u.truncateItemNameForHeader(t.name+" "+i))}};e.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:g.default.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return l.createElement(a.ContextualMenu,{ariaLabel:g.default.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};e.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};e.prototype._onDismissMoreContextualMenu=function(){this.setState(i.__assign({},this.state,{showContextualMenu:!1}))};e.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick()};e.prototype._onSendLinkClick=function(e){this.props.onSendLinkClick(this.props.messageText)};e.prototype._getViewName=function(){var e=g.default;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 4:return e.manageExistingAccessLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;case 10:return e.addPeopleLabel;case 11:return e.requestAccessLabel;default:return e.shareLinkHeader}};e.contextTypes={onDismiss:d.func,platformDetection:d.object.isRequired,breakpoint:d.object.isRequired,isMacV4ExperimentOn:d.bool.isRequired};i.__decorate([r.autobind],e.prototype,"_dismissComponent",null);return e}(l.Component);t.Header=o});define("@ms/odsp-shared-sharing/lib/utilities/ClientIdHelper",["require","exports","../interfaces/SharingInterfaces"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){return a(e)||l(e)||s(e)||d(e)}t.isOfficeProduct=o;function r(e){return e===i.ClientId.odb||e===i.ClientId.sharePoint||e===i.ClientId.odc}t.isODSP=r;function n(e){return e===i.ClientId.odAndroid||e===i.ClientId.odIos}t.isMobile=n;t.hideItemName=function(e){return o(e)||e===i.ClientId.onenoteWeb};t.showCloseButton=function(e){return r(e)||e===i.ClientId.onenoteWeb||e===i.ClientId.officecom||n(e)};t.showOWAShareTarget=function(e){return r(e)||e===i.ClientId.officecom||e===i.ClientId.wac};t.showManagePermissions=function(e){return o(e)||e===i.ClientId.wac||e===i.ClientId.teams};t.invertPermissionsButtonsOrder=function(e){return n(e)||e===i.ClientId.teams};function a(e){return e===i.ClientId.word||e===i.ClientId.wordAndroid||e===i.ClientId.wordIos}t.isWord=a;function s(e){return e===i.ClientId.excel||e===i.ClientId.excelAndroid||e===i.ClientId.excelIos}t.isExcel=s;function l(e){return e===i.ClientId.powerpoint||e===i.ClientId.powerpointAndroid||e===i.ClientId.powerpointIos}t.isPowerPoint=l;function d(e){return e===i.ClientId.visio}t.isVisio=d});define("@ms/odsp-shared-sharing/lib/utilities/ShareHelper",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","../components/Share.resx","../utilities/ClientIdHelper","@ms/odsp-utilities/lib/features/FeatureOverrides"],function(e,a,s,l,d,c,p){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.days=[d.default.sunday,d.default.monday,d.default.tuesday,d.default.wednesday,d.default.thursday,d.default.friday,d.default.saturday];a.shortDays=[d.default.shortSunday,d.default.shortMonday,d.default.shortTuesday,d.default.shortWednesday,d.default.shortThursday,d.default.shortFriday,d.default.shortSaturday];a.shortMonths=[d.default.shortJanuary,d.default.shortFebruary,d.default.shortMarch,d.default.shortApril,d.default.shortMay,d.default.shortJune,d.default.shortJuly,d.default.shortAugust,d.default.shortSeptember,d.default.shortOctober,d.default.shortNovember,d.default.shortDecember];a.months=[d.default.january,d.default.february,d.default.march,d.default.april,d.default.may,d.default.june,d.default.july,d.default.august,d.default.september,d.default.october,d.default.november,d.default.december];a.MAX_DAYS_FOR_EXPIRING_LINK=730;var u;!function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"}(u=a.ExpirationErrorCode||(a.ExpirationErrorCode={}));a.truncateItemNameForHeader=function(e){return i(e,26)};a.truncateOrganizationName=function(e){return i(e,30)};a.truncateItemNameForShareNotification=function(e,t){return i(e,t=t||20)};function i(e,t){if(!e)return"";var i=t,o=i/2;return e.length<=i?e:e.slice(0,o)+"..."+e.slice(e.length-o)}a.isLoadingData=function(e){return 0===e.userRole&&0===e.defaultLinkKind};a.getLinkIconUrl=function(e,t){var i=e.sharingLinkKind,o=e.audience,r="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(i){case 2:case 3:return r+"/companyonly.svg";case 4:case 5:return r+"/anyone.svg";case 6:return 5===e.audience?t?t.iconUrl:r+"/chat.svg":r+"/specificpeople.svg";default:return 5===o?t?t.iconUrl:r+"/chat.svg":r+"/existingaccess.svg"}};a.getLinkIconName=function(e){switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return 2===e.audience?"Globe":1===e.audience?"Work":"PeopleAdd";default:return"Link"}};var h={ODB:778};a.getLinkLabel=function(e,t,i){var o=e.sharingLinkKind,r=e.expiration,n=e.audience;if(p.default.isFeatureEnabled(h)){var a=null;if(r){var s=r<new Date(Date.now());a=l.format(s?d.default.expiredDescription:d.default.expiresDescription,r.toLocaleDateString())}switch(o){case 2:return l.format(d.default.cslViewDescription,t);case 3:return l.format(d.default.cslEditDescription,t);case 4:return r?l.format(d.default.anonViewDescriptionWithExpiration,a):d.default.anonViewDescription;case 5:return r?l.format(d.default.anonEditDescriptionWithExpiration,a):d.default.anonEditDescription;case 1:return 5===n?e.isEdit?i?l.format(d.default.customLabeledEditLabel,i.entityName):d.default.peopleInChatEditLabel:e.isReview?i?l.format(d.default.customLabeledReviewLabel,i.entityName):d.default.peopleInChatReviewLabel:i?l.format(d.default.customLabeledViewLabel,i.entityName):d.default.peopleInChatViewLabel:d.default.existingPeopleDescription;case 6:return 2===n?e.blockDownload?r?e.hasPassword?l.format(d.default.anonymousViewOnlyWithExpirationAndPassword,a):l.format(d.default.anonymousViewOnlyWithExpiration,a):e.hasPassword?d.default.anonymousViewOnlyWithPassword:d.default.anonymousViewOnlyHint:r&&e.hasPassword?e.isEdit?l.format(d.default.anonPasswordEditDescriptionWithExpiration,a):l.format(d.default.anonPasswordViewDescriptionWithExpiration,a):!r&&e.hasPassword?e.isEdit?d.default.anonPasswordEditDescription:d.default.anonPasswordViewDescription:r&&!e.hasPassword?e.isEdit?l.format(d.default.anonEditDescriptionWithExpiration,a):l.format(d.default.anonViewDescriptionWithExpiration,a):e.isEdit?d.default.anonEditDescription:d.default.anonViewDescription:5===n?e.isEdit?i?l.format(d.default.customLabeledEditLabel,i.entityName):d.default.peopleInChatEditLabel:!0===e.isReview?i?l.format(d.default.customLabeledReviewLabel,i.entityName):d.default.peopleInChatReviewLabel:i?l.format(d.default.customLabeledViewLabel,i.entityName):d.default.peopleInChatViewLabel:1===e.audience?e.blockDownload?l.format(d.default.cslViewOnlyHint,t):e.isEdit?l.format(d.default.cslEditDescription,t):l.format(d.default.cslViewDescription,t):e.blockDownload?d.default.specificPeopleViewOnlyHint:e.isEdit?d.default.pslEditLabel:!0===e.isReview?d.default.pslReviewLabel:d.default.pslViewLabel;default:return""}}else switch(o){case 2:return l.format(d.default.cslViewDescription,t);case 3:return l.format(d.default.cslEditDescription,t);case 4:return r?l.format(d.default.anonViewDescriptionWithExpiry,r.toLocaleDateString()):d.default.anonViewDescription;case 5:return r?l.format(d.default.anonEditDescriptionWithExpiry,r.toLocaleDateString()):d.default.anonEditDescription;case 1:return 5===n?e.isEdit?i?l.format(d.default.customLabeledEditLabel,i.entityName):d.default.peopleInChatEditLabel:e.isReview?i?l.format(d.default.customLabeledReviewLabel,i.entityName):d.default.peopleInChatReviewLabel:i?l.format(d.default.customLabeledViewLabel,i.entityName):d.default.peopleInChatViewLabel:d.default.existingPeopleDescription;case 6:if(e.blockDownload){if(2===n)return r&&e.hasPassword?l.format(d.default.anonymousViewOnlyWithExpiryAndPassword,r.toLocaleDateString()):r&&!e.hasPassword?l.format(d.default.anonymousViewOnlyWithExpiry,r.toLocaleDateString()):!r&&e.hasPassword?d.default.anonymousViewOnlyWithPassword:d.default.anonymousViewOnlyHint;if(1===n)return l.format(d.default.cslViewOnlyHint,t);if(4===n)return d.default.specificPeopleViewOnlyHint}return 2===n?r&&e.hasPassword?e.isEdit?l.format(d.default.anonPasswordEditDescriptionWithExpiry,r.toLocaleDateString()):l.format(d.default.anonPasswordViewDescriptionWithExpiry,r.toLocaleDateString()):!r&&e.hasPassword?e.isEdit?d.default.anonPasswordEditDescription:d.default.anonPasswordViewDescription:r&&!e.hasPassword?e.isEdit?l.format(d.default.anonEditDescriptionWithExpiry,r.toLocaleDateString()):l.format(d.default.anonViewDescriptionWithExpiry,r.toLocaleDateString()):e.isEdit?d.default.anonEditDescription:d.default.anonViewDescription:5===n?e.isEdit?i?l.format(d.default.customLabeledEditLabel,i.entityName):d.default.peopleInChatEditLabel:!0===e.isReview?i?l.format(d.default.customLabeledReviewLabel,i.entityName):d.default.peopleInChatReviewLabel:i?l.format(d.default.customLabeledViewLabel,i.entityName):d.default.peopleInChatViewLabel:e.isEdit?d.default.pslEditLabel:!0===e.isReview?d.default.pslReviewLabel:d.default.pslViewLabel;default:return""}};a.getLinkParticipants=function(e){for(var i=[],t=e.principals,o=e.invitees,r=0,n=t;r<n.length;r++){var a=n[r];i.push({id:a.id,name:a.primaryText,image:a.imageUrl,isResolved:!0,principalName:a.loginName,userId:a.loginName,email:a.email,job:a.secondaryText,isExternal:a.isExternal,loginName:a.loginName,principalType:a.type})}for(var s=function(t){0===(!0===t.isExternal?i.filter(function(e){return e.email===t.email}):i.filter(function(e){return e.principalName===t.loginName})).length&&i.push({id:t.id,name:t.primaryText,image:t.imageUrl,isResolved:!0,principalName:t.loginName,userId:t.loginName,email:t.email,job:t.secondaryText,isExternal:t.isExternal,loginName:t.loginName,principalType:t.type})},l=0,d=o;l<d.length;l++)s(d[l]);return i};a.getEncodedMessageLength=function(e){if(!e)return 0;var t=0,i=e.length,o=0,r=!1;if(0===e.length)return 0;for(var n="&#160;",a="<br />",s="&quot;&quot;&quot;",l="&amp;",d="&#39;",c="&lt;",p="&gt;",u=" ";o<i;){var h=null,m=e[o];if(" "===m)h=o+1<i&&" "===e[o+1]||r?n:" ";else if("\n"===m){h=a;r=!0}else{'"'===m?h=s:"&"===m?h=l:"'"===m?h=d:"<"===m?h=c:">"===m?h=p:"\r"===m&&(h=u);r=!1}t+=null!==h?h.length:1;o++}return t};a.getFileShareTypeFromAudience=function(e){return 2===e?0:1===e?1:3===e?4:2};a.getRoleIconNameAndTitle=function(e){var t,i;switch(e){case 2:t="Edit";i=d.default.canEditRole;break;case 1:t="View";i=d.default.canViewRole;break;case 6:t="Feedback";i=d.default.canReviewRole}return{name:t,title:i}};a.getExpirationErrorCode=function(e,t){var i=u.none,o=t;if(!e||e.getTime()===new Date(0).getTime())return i;var r=new Date;r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var n=Math.floor((e.getTime()-r.getTime())/864e5);n<1?i=u.pastDate:n>a.MAX_DAYS_FOR_EXPIRING_LINK?i=u.overMax:o<n&&-1!==o&&(i=u.adminPolicy);return i};a.getLinkKind=function(e,t){return 2===e?t?5:4:1===e?t?3:2:0===e||3===e?1:6};a.getExpirationDatePickerErrorMessage=function(e,t){var i=d.default;switch(e){case u.pastDate:return i.pastDateExpirationError;case u.adminPolicy:return l.format(i.adminExpirationError,t);case u.overMax:return l.format(i.maxExpirationError,a.MAX_DAYS_FOR_EXPIRING_LINK);case u.adminRequired:return d.default.requireExpirationError;default:return""}};a.getDefaultExpirationDateValue=function(e){var t=e;if(-1===t)return null;var i=new Date;i.setDate(i.getDate()+t);return i};a.copySharingLinkToClipboard=function(r,n,a){return s.__awaiter(this,void 0,void 0,function(){var t,i,o;return s.__generator(this,function(e){switch(e.label){case 0:t=!1;if(c.isMobile(r))return[3,4];try{n.focus();n.setSelectionRange(0,n.value.length);t=document.execCommand("copy")}catch(e){}if(t||!window.navigator||!window.navigator.clipboard)return[3,4];e.label=1;case 1:e.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(n.value)];case 2:e.sent();t=!0;return[3,4];case 3:e.sent();return[3,4];case 4:try{i=window.external;o=i.CopyToClipboard(a);t=o||void 0===o}catch(e){}return[2,t]}})})}});define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButton",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","./SendButtonType","../../utilities/ShareHelper","prop-types","./SendButton.scss"],function(e,t,i,n,r,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._platformDetection=t.platformDetection;return i}e.prototype.render=function(){var e=!1;if(3===this.props.currentSettings.audience)for(var t=0,i=this.props.linkRecipients;t<i.length;t++){var o=i[t];if(void 0===this.props.permissionsMap[o.email]){e=!0;break}}if(this.props.ctaLabel){var r=!!this.props.errorMessage||d.isLoadingData(this.props.sharingInformation)||e||d.getEncodedMessageLength(this.props.messageText)>this.props.maximumMessageLength;if(this.props.sendButtonType===l.default.button)return n.createElement(a.PrimaryButton,{disabled:r,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===l.default.link)return n.createElement("div",{className:"od-SendButton-linkButton"},n.createElement(s.Link,{disabled:r,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};e.prototype._onSendLinkClicked=function(){this.props.onSendLinkClicked(this.props.messageText)};e.contextTypes={platformDetection:c.object.isRequired};i.__decorate([r.autobind],e.prototype,"_onSendLinkClicked",null);return e}(n.Component);t.default=o});define("office-ui-fabric-react/lib/Link",["require","exports","tslib","./components/Link/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Link/index",["require","exports","tslib","./Link","./Link.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Link/Link",["require","exports","../../Utilities","./Link.base","./Link.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Link=i.styled(o.LinkBase,r.getStyles,void 0,{scope:"Link"})});define("office-ui-fabric-react/lib/components/Link/Link.base",["require","exports","tslib","react","../../Utilities","../../KeytipData"],function(e,t,p,u,i,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=i.classNamesFunction(),o=function(e){p.__extends(t,e);function t(){var o=null!==e&&e.apply(this,arguments)||this;o._link=i.createRef();o._onClick=function(e){var t=o.props,i=t.onClick;t.disabled?e.preventDefault():i&&i(e)};return o}t.prototype.render=function(){var t=this,e=this.props,i=e.disabled,o=e.children,r=e.className,n=e.href,a=e.theme,s=e.styles,l=e.keytipProps,d=m(s,{className:r,isButton:!n,isDisabled:i,theme:a}),c=this._getRootType(this.props);return u.createElement(h.KeytipData,{keytipProps:l,ariaDescribedBy:this.props["aria-describedby"],disabled:i},function(e){return u.createElement(c,p.__assign({},e,t._removeInvalidPropsForRootType(c,t.props),{className:d.root,onClick:t._onClick,ref:t._link,"aria-disabled":i}),o)})};t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()};t.prototype._removeInvalidPropsForRootType=function(e,t){t.children,t.as;var i=t.disabled,o=t.target,r=t.href,n=(t.theme,t.getStyles,t.styles,p.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles"]));return"string"==typeof e?"a"===e?p.__assign({target:o,href:r},n):p.__assign({},n,{disabled:i}):p.__assign({target:o,href:r,disabled:i},n)};t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"};return t}(i.BaseComponent);t.LinkBase=o});define("office-ui-fabric-react/lib/components/Link/Link.styles",["require","exports","../../Styling"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={root:"ms-Link"};t.getStyles=function(e){var t,i,o=e.className,r=e.isButton,n=e.isDisabled,a=e.theme,s=a.semanticColors,l=d.getGlobalClassNames(c,a);return{root:[l.root,d.getFocusStyle(a,-2),{color:s.link},r&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",fontSize:"inherit",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(t={},t[d.HighContrastSelectorBlack]={color:"#FFFF00"},t[d.HighContrastSelectorWhite]={color:"#00009F"},t["@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)"]={borderBottom:"none"},t)},!r&&{textDecoration:"none"},n&&["is-disabled",{color:s.disabledText,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!n&&{selectors:{"&:active, &:hover, &:active:hover":{color:s.linkHovered,selectors:(i={},i[d.HighContrastSelector]={textDecoration:"underline"},i)},"&:focus":{color:s.link}}},l.root,o]}}});define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButtonType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.button=0]="button";e[e.link=1]="link"}(i||(i={}));t.default=i});define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}"}])});define("@ms/odsp-utilities/lib/browser/ResponsiveUI",["require","exports","../events/EventGroup","../scope/Scope"],function(e,l,o,r){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.ResponsiveUIEvents={formFactorChange:"formFactorChange",hamburgerVisibilityChange:"hamburgerVisibilityChange",showLabelsChange:"showCommandLabelsChange"};var t={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},d={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},i=function(){function s(e,t){this._scope=new r.default;this._events=new(this._scope.attached(o.default))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var i=t.breakpoints;this._breakpoints="function"==typeof i?i:function(){return i};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}s.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};s.determineWindowSize=function(e,t){void 0===t&&(t=d);if(0===e)return"Medium";for(var i in d)if(e<t[i])return i};s.determineCssClass=function(e){return t[e]};s.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),i=e.style;i.visibility="hidden";i.width="100px";i.msOverflowStyle="scrollbar";i.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var o=e.offsetWidth,r=t.offsetWidth;e.parentNode.removeChild(e);var n=o-r;this.getScrollbarWidth=function(){return n};return n};Object.defineProperty(s.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});s.prototype.dispose=function(){this._scope.dispose()};s.prototype.compareSize=function(e,t){var i=this._breakpoints();return i[e]-i[t]};s.prototype._afterContainerResize=function(){};s.prototype._onContainerResize=function(){var e=document.body,t=document.documentElement,i=this._windowHeight=t.clientWidth||e.clientWidth;this._windowWidth=t.clientHeight||e.clientHeight;var o=this._formFactorSize,r=this._formFactorSize=s.determineWindowSize(i,this._breakpoints());this._cssClass=s.determineCssClass(r);var n=this._isHamburgerVisible;this._isHamburgerVisible=i<d.Large;var a=this._showLabels;this._showLabels=0<this.compareSize(r,"Medium");o&&r!==o&&this._events.raise(l.ResponsiveUIEvents.formFactorChange);"boolean"==typeof n&&n!==this._isHamburgerVisible&&this._events.raise(l.ResponsiveUIEvents.hamburgerVisibilityChange);"boolean"==typeof a&&a!==this._showLabels&&this._events.raise(l.ResponsiveUIEvents.showLabelsChange);this._afterContainerResize()};s.DEFAULT_BREAKPOINTS=d;s.MAC_SCROLL_BAR_WIDTH=8;return s}();l.ResponsiveUI=i;l.default=i});define("@ms/odsp-shared-sharing/lib/components/Header/Header.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHeader{-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";display:-ms-flexbox;display:flex;height:40px;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-bottom-width:1px}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:17px;font-weight:700}[dir=ltr] .od-ShareHeader-linkSettings{margin-left:20px}[dir=rtl] .od-ShareHeader-linkSettings{margin-right:20px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-left{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-left{padding-right:8px}[dir=ltr] .od-ShareHeader-buttons-left{left:0}[dir=rtl] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-button-send-right{padding-top:12px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-button-send-right{padding-right:8px}[dir=rtl] .od-ShareHeader-button-send-right{padding-left:8px}[dir=ltr] .od-ShareHeader-button-send-right{right:0}[dir=rtl] .od-ShareHeader-button-send-right{left:0}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right{right:0}[dir=rtl] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-button{background:0 0;border:none;padding:0;width:30px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:16px;cursor:pointer;font:-apple-system-body}.ms-Fabric .od-ShareHeader-button::-moz-focus-inner{border:0}.ms-Fabric .od-ShareHeader-button{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareHeader-button:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareHeader-button:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-ShareHeader-button:focus:after{border-color:#37006e}}.od-ShareHeader-title{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}"}])});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PermissionsSettings/PermissionsSettings",["require","exports","tslib","../AudienceChoiceGroup/AudienceChoiceGroup","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Checkbox","../ExpirationDatePicker/ExpirationDatePicker","../PasswordField/PasswordField","../../../utilities/ShareHelper","../../../data/Icons/FileShareIconMap","../../../interfaces/SharingInterfaces","../../PermissionsList/ShareLink/ChangePermission/ChangePermission","../../../utilities/PeoplePickerHelper","react","prop-types","../../../utilities/SharingAbilitiesHelper","@ms/odsp-utilities/lib/string/StringHelper","../../PeoplePicker/PeoplePicker","../../Share.resx","@ms/odsp-utilities/lib/features/Features","../PreventDownload/PreventDownload","../../../utilities/EngagementHelper","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/FeatureOverrides","../../../utilities/ClientIdHelper","./PermissionsSettings.scss"],function(e,t,r,i,o,a,s,l,d,b,y,c,p,u,h,v,m,g,x,f,_,S,k,P,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I={ODB:772},T={ODB:1157},D={ODB:-1157},n=function(n){r.__extends(e,n);function e(e,t){var i=n.call(this,e)||this;i._resize=t.resize;var o=e.selectedPermissions.specificPeople;i.state={expirationErrorCode:d.ExpirationErrorCode.none,externalRecipientWarning:p.getOversharingExternalsWarning(o),groupRecipientWarning:p.getOversharingGroupsWarning(o,e.groupsMemberCount),preventDownloadDisabled:i.props.selectedPermissions.isEdit};i._getAudienceOptions=i._getAudienceOptions.bind(i);i._onAllowEditChange=i._onAllowEditChange.bind(i);i._onAllowRoleChange=i._onAllowRoleChange.bind(i);i._onChoiceGroupChange=i._onChoiceGroupChange.bind(i);i._onSelectDate=i._onSelectDate.bind(i);i._renderExpirationDatePicker=i._renderExpirationDatePicker.bind(i);i._renderExpirationDatePickerErrorMessage=i._renderExpirationDatePickerErrorMessage.bind(i);i._renderPeoplePicker=i._renderPeoplePicker.bind(i);i._platformDetection=t.platformDetection;i._isOnExperiment=!1;if(w.default.isFeatureEnabled(T)&&!i._platformDetection.isIOS&&!i._platformDetection.isAndroid&&(!C.isOfficeProduct(i.props.clientId)||!i._platformDetection.isMac)&&!P.Killswitch.isActivated("e558d959-cad6-4c72-a68f-94c8f054ff0c","7/20/2018","AddLinkSettingsHintsV2")){var r=new k.ABExperiment({name:"AddLinkSettingHintsV2",startDate:"07/20/2018",version:k.ABExpHash.v2});i._isOnExperiment=r.IsExperimentOn()}i._isLinkSettingHintsOn=i._isOnExperiment||w.default.isFeatureEnabled(D);i._permissionsOptions=i._getAudienceChoiceGroupOptions();return i}e.prototype.componentDidUpdate=function(e,t){this._resize()};e.prototype.render=function(){var e=this.props;return this.context.sharingStore.isAudienceModificationAllowed()?u.createElement("div",{className:"od-PermissionsSettings"},u.createElement("div",{className:"od-PermissionsSettings-section"},u.createElement("div",{id:"od-PermissionsSettings-description",className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},x.default.permissionsSettingsHeader,u.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-labelledby":"od-PermissionsSettings-description",href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked},x.default.learnMoreLabel)),u.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),u.createElement(i.AudienceChoiceGroup,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName}),this._renderPeoplePicker()),this._renderOtherSettings()):u.createElement("div",{className:"od-PermissionsSettings"},u.createElement("div",{className:"od-PermissionsSettings-section"},u.createElement("div",{className:"od-PermissionsSettings-bottomBorder"})),this._renderOtherSettings())};e.prototype.componentWillReceiveProps=function(e){var t=this,i=e.selectedPermissions,o=i.specificPeople;0===o.length&&0<e.recipients.length&&this._onPeoplePickerChange(e.recipients);this.setState(r.__assign({},this.state,{expirationErrorCode:d.getExpirationErrorCode(i.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:p.getOversharingExternalsWarning(o),groupRecipientWarning:p.getOversharingGroupsWarning(o,e.groupsMemberCount),preventDownloadDisabled:i.isEdit}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};e.prototype._learnMoreClicked=function(){S.linkSettingsLearnMoreClicked(this.props.engagementExtraData)};e.prototype._renderOtherSettings=function(){if(3!==this.props.selectedPermissions.audience)return u.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},u.createElement("div",{className:"od-PermissionsSettings-description"},this.context.sharingStore.isAudienceModificationAllowed()?x.default.otherSettings:""),u.createElement("div",{role:"group","aria-label":x.default.otherSettings},u.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()))};e.prototype._getSpecificPeopleOption=function(){return this.props.createPeopleSharingLinks?{disabledText:x.default.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:4,label:x.default.permissionsSpecificPeopleString,hint:this._isLinkSettingHintsOn?m.format(x.default.specificPeopleHelpText,this.props.companyName):"",linkKinds:[6],permissionsType:2}:{disabledText:x.default.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:0,label:x.default.permissionsSpecificPeopleString,hint:this._isLinkSettingHintsOn?m.format(x.default.specificPeopleHelpText,this.props.companyName):"",linkKinds:[1],permissionsType:2}};e.prototype._getAudienceChoiceGroupOptions=function(){var e=[{disabledText:x.default.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:2,label:x.default.permissionsAnyoneString,hint:this._isLinkSettingHintsOn?x.default.anonymousHelpText:"",linkKinds:[4,5],permissionsType:0},{disabledText:x.default.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:1,label:m.format(x.default.permissionsCompanyString,this.props.companyName),hint:this._isLinkSettingHintsOn?m.format(x.default.cslHelpText,this.props.companyName):"",linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];this.props.clientId===y.ClientId.outlookWeb&&e.splice(2,1);if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var t={icon:b.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:3,label:x.default.permissionsExistingPeopleString,hint:this._isLinkSettingHintsOn?x.default.existingAccessHelpText:"",linkKinds:[1],permissionsType:4};e.splice(2,0,t)}return e};e.prototype._onPeoplePickerChange=function(e){var t=this;this.setState(r.__assign({},this.state,{externalRecipientWarning:p.getOversharingExternalsWarning(e),groupRecipientWarning:p.getOversharingGroupsWarning(e,this.props.groupsMemberCount)}),function(){t.props.onPeoplePickerChange(e)})};e.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return 0!==e.selectedPermissions.audience&&4!==e.selectedPermissions.audience||!e.copyLinkShortcut&&e.mode!==y.Mode.linkSettings?void 0:u.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},u.createElement(g.default,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId}))};e.prototype._renderRolesDropDown=function(){var e=this.props,t=f.default.isFeatureEnabled(I),i=e.clientId===y.ClientId.word||e.sharingInformation.item&&e.sharingInformation.item.appmap&&"ms-word"===e.sharingInformation.item.appmap,o=0===e.selectedPermissions.audience||4===e.selectedPermissions.audience;return t&&i&&o?u.createElement("div",{className:"od-PermissionsSettings-changePermission"},u.createElement(c.ChangePermission,{selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,clientId:e.clientId,appmap:e.sharingInformation.item.appmap})):u.createElement(a.Checkbox,{className:"od-PermissionsSettings-allowEdit",label:x.default.allowEditLabel,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing})};e.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return 2===t.audience?u.createElement("div",{className:"od-PermissionsSettings-setting"},u.createElement("div",{className:"od-PermissionsSettings-datePicker"},u.createElement(s.ExpirationDatePicker,{onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays})),u.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())):void 0};e.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return d.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};e.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),i=e.selectedPermissions;return t&&2===i.audience?u.createElement("div",{className:"od-PermissionsSettings-setting"},u.createElement(l.PasswordField,{onPasswordChange:this.props.onPasswordChange})):void 0};e.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation;if(this.context.usesSharingAbilities&&e){h=[];var i=this.props.currentSettings;for(var o in e)if(e.hasOwnProperty(o)){var r=e[o],n=v.getSharingAbilitiesAudience(o);if(!n)continue;if(this.props.clientId===y.ClientId.outlookWeb&&4===n)continue;if(4===n&&!this.props.createPeopleSharingLinks){var a=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?a.isChecked=a.key===i.audience:a.isDisabled=!0;h.push(a);continue}var s=this._getAudienceOption(n);s.isDisabled=!(r.canManageEditLink.enabled||r.canManageReadLink.enabled);s.isChecked=s.key===i.audience;h.push(s)}var l={icon:b.FileShareIconMap[1],isChecked:3===i.audience,isDisabled:!1,key:3,label:x.default.permissionsExistingPeopleString,hint:this._isLinkSettingHintsOn?x.default.existingAccessHelpText:"",linkKinds:[1],permissionsType:4};h.splice(2,0,l);if(0<h.filter(function(e){return 0===e.key&&!e.isDisabled||4===e.key&&!e.isDisabled}).length&&this.props.clientId===y.ClientId.teams&&this.props.mode===y.Mode.linkSettings){var d=this._getAudienceOption(5);h.splice(2,0,d)}return h}for(var c=this._permissionsOptions,p=this.props.sharingInformation.sharingLinks.map(function(e){return e.sharingLinkKind}),u=function(e){return-1<p.indexOf(e)},h=[],m=0,g=c;m<g.length;m++){var f=g[m];if(2===f.permissionsType)t.canManagePermissions&&!t.blockPeoplePickerAndSharing?f.isChecked=f.key===this.props.currentSettings.audience:f.isDisabled=!0;else{f.linkKinds.some(u)?f.isChecked=f.key===this.props.currentSettings.audience:f.isDisabled=!0}h.push(f)}return h};e.prototype._renderPreventDownloadToggle=function(){var e=this.props.selectedPermissions,t=this.context.sharingStore.isPreventDownloadModificationAllowed(),i=!!e.preventDownload,o=this.props.sharingInformation.sharingAbilities.anonymousLinkAbilities.supportsRestrictedView.enabled;if(t&&o)return u.createElement("div",{className:"od-PermissionsSettings-setting"},u.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},u.createElement(_.PreventDownload,{onToggleChange:this.props.onToggleChange,isToggled:i,disablePreventDownload:this.state.preventDownloadDisabled})))};e.prototype._getAudienceOption=function(e){var t=x.default;return 2===e?{disabledText:t.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:2,label:t.permissionsAnyoneString,hint:this._isLinkSettingHintsOn?t.anonymousHelpText:"",linkKinds:[4,5],permissionsType:0}:1===e?{disabledText:t.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:1,label:m.format(t.permissionsCompanyString,this.props.companyName),hint:this._isLinkSettingHintsOn?m.format(t.cslHelpText,this.props.companyName):"",linkKinds:[2,3],permissionsType:1}:4===e?{disabledText:t.disabledAudienceChoiceLabel2,icon:b.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:4,label:t.permissionsSpecificPeopleString,hint:this._isLinkSettingHintsOn?m.format(t.specificPeopleHelpText,this.props.companyName):"",linkKinds:[6],permissionsType:2}:5===e?{disabledText:x.default.disabledAudienceChoiceLabel2,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&b.FileShareIconMap[5],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:5,label:this.props.customLabeledAudienceConfig?m.format(t.permissionsOnlyCustomLabeledString,this.props.customLabeledAudienceConfig.entityName):t.permissionsPeopleInChatString,linkKinds:[6],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&5}:void 0};e.prototype._onChoiceGroupChange=function(e){for(var t=0,i=this._permissionsOptions;t<i.length;t++){var o=i[t];o.isChecked=e===o.key}};e.prototype._onSelectDate=function(e){var t=this,i=d.getExpirationErrorCode(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(r.__assign({},this.state,{expirationErrorCode:i}),function(){t.props.updateExpirationErrorCode(i);t.props.onExpirationChange(e)})};e.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t);this.setState(r.__assign({},this.state,{preventDownloadDisabled:t}))};e.prototype._onAllowRoleChange=function(e){var t=this,i=!1;2===e&&(i=!0);this.setState(r.__assign({},this.state,{preventDownloadDisabled:i}),function(){t.props.onRoleChange(e)})};e.contextTypes={resize:h.func.isRequired,usesSharingAbilities:h.bool.isRequired,sharingStore:h.bool.isRequired,platformDetection:h.object.isRequired};r.__decorate([o.autobind],e.prototype,"_learnMoreClicked",null);r.__decorate([o.autobind],e.prototype,"_getSpecificPeopleOption",null);r.__decorate([o.autobind],e.prototype,"_onPeoplePickerChange",null);r.__decorate([o.autobind],e.prototype,"_getAudienceOption",null);r.__decorate([o.autobind],e.prototype,"_onAllowRoleChange",null);return e}(u.Component);t.PermissionsSettings=n});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup",["require","exports","tslib","office-ui-fabric-react/lib/FocusZone","../../ShareLinkDescription/ShareLinkDescription","react","prop-types","../../Share.resx","./AudienceChoiceGroup.scss"],function(e,t,i,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={selectedKey:i._getSelectedIndex(e)};i._platformDetection=t.platformDetection;return i}e.prototype._getSelectedIndex=function(e){for(var t=0,i=e.items;t<i.length;t++){var o=i[t];if(o.isChecked)return o.key}};e.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return a.createElement("div",{"aria-label":l.default.permissionsSettingsHeader,role:"radiogroup"},a.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,defaultActiveElement:".od-AudienceChoiceGroup-row.is-selected"},e))};e.prototype._renderItem=function(e){var t=e.key,i=!this._platformDetection.isFirefox,o=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===t;return a.createElement("div",{key:t},a.createElement("button",{role:"radio","aria-checked":r,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:r,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+o,"data-key":t},a.createElement("div",{className:"od-AudienceChoiceGroup-description"},a.createElement(n.ShareLinkDescription,{label:e.label,hint:e.hint,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:i?o:""}))),a.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};e.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};e.prototype._onRowClick=function(e,t){var i=this.props;this.setState({selectedKey:e});i.onChange(e);i.onAudienceChange(e)};e.contextTypes={platformDetection:s.object.isRequired};return e}(a.Component);t.AudienceChoiceGroup=o});define("@ms/odsp-shared-sharing/lib/components/ShareLinkDescription/ShareLinkDescription",["require","exports","tslib","../../data/Icons/FileShareIconMap","../ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton","office-ui-fabric-react/lib/Icon","react","./ShareLinkDescription.scss"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=o.FileShareIconMap[this.props.permissionsType],t=this.props.iconUrl?a.createElement("img",{className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):a.createElement(n.Icon,{iconName:e});return a.createElement("div",{className:"od-ShareLinkDescription"},a.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?a.createElement(r.InfoButton,{message:e}):"";if(this.props.showLabel)return a.createElement("div",{className:"od-ShareLinkDescription-text"},a.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t),a.createElement("div",{className:"od-ShareLinkDescription-hint"},a.createElement("p",null,this.props.hint)))};return t}(a.Component);t.ShareLinkDescription=s});define("@ms/odsp-shared-sharing/lib/data/Icons/FileShareIconMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileShareIconMap=((i={})[0]="Globe",i[3]="Lock",i[2]="PeopleAdd",i[1]="Work",i[4]="SecurityGroup",i[5]="Chat",i);var i});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","react","prop-types","./InfoButton.scss"],function(e,t,i,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={isCalloutVisible:!1};return i}e.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",null,s.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},s.createElement(a.Icon,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout})),t.isCalloutVisible&&s.createElement(n.Callout,{directionalHint:1,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))};e.prototype._onShowCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!0}))};e.prototype._onDismissCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!1}))};e.prototype._onInfoButton=function(e){this._infoButton=e};e.contextTypes={strings:l.object.isRequired};i.__decorate([r.autobind],e.prototype,"_onShowCallout",null);i.__decorate([r.autobind],e.prototype,"_onDismissCallout",null);i.__decorate([r.autobind],e.prototype,"_onInfoButton",null);return e}(s.Component);t.InfoButton=o});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:5px 4px 4px 4px;font-size:12px}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}"}])});define("@ms/odsp-shared-sharing/lib/components/ShareLinkDescription/ShareLinkDescription.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{-ms-flex-align:top;align-items:top;display:-ms-flexbox;display:flex;padding:6px 0 2px 0;width:100%}.od-ShareLinkDescription-text{width:80%;padding-top:2px}.od-ShareLinkDescription-label{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;width:100%;font:-apple-system-subheadline}[dir=ltr] .od-ShareLinkDescription-label{margin-left:8px}[dir=rtl] .od-ShareLinkDescription-label{margin-right:8px}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}[dir=ltr] .od-ShareLinkDescription-hint{margin-left:8px}[dir=rtl] .od-ShareLinkDescription-hint{margin-right:8px}[dir=ltr] .od-ShareLinkDescription-hint{text-align:left}[dir=rtl] .od-ShareLinkDescription-hint{text-align:right}.od-ShareLinkDescription-hint p{margin-top:5px;margin-bottom:5px;font-size:12px;font-weight:400}.od-ShareLinkDescription-image{width:16px;height:16px}.od-ShareLinkDescription-icon{-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:1px;box-sizing:border-box;display:-ms-flexbox;display:flex;height:24px;-ms-flex-pack:center;justify-content:center;width:24px}.od-ShareLinkDescription-icon .ms-Icon{font-size:14px}.od-ShareLinkDescription-icon.icon-PeopleAdd{border-color:"},{theme:"orangeLight",defaultValue:"#ff8c00"},{rawString:";color:"},{theme:"orangeLight",defaultValue:"#ff8c00"},{rawString:"}.od-ShareLinkDescription-icon.icon-Work{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background-color:RGBA("},{theme:"blue",defaultValue:"#0078d4"},{rawString:", .06)}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;border-color:#6264a7;background-color:RGBA(#6264a7,.06)}.od-ShareLinkDescription-icon.icon-Globe{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";background-color:RGBA("},{theme:"green",defaultValue:"#107c10"},{rawString:", .06)}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";background-color:RGBA("},{theme:"orange",defaultValue:"#d83b01"},{rawString:", .06)}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ff8c00"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:24px;height:24px;border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}"}])});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AudienceChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-weight:600}.od-AudienceChoiceGroup-row.is-selected::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:FabricMDL2Icons;font-size:16px;margin-top:8px}[dir=ltr] .od-AudienceChoiceGroup-row.is-selected::after{float:right}[dir=rtl] .od-AudienceChoiceGroup-row.is-selected::after{float:left}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast:black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #37006e inset}}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-AudienceChoiceGroup-description{-ms-flex-align:center;align-items:center;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir=ltr] .od-AudienceChoiceGroup-description{float:left}[dir=rtl] .od-AudienceChoiceGroup-description{float:right}"}])});define("office-ui-fabric-react/lib/Checkbox",["require","exports","tslib","./components/Checkbox/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Checkbox/index",["require","exports","tslib","./Checkbox"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Checkbox/Checkbox",["require","exports","../../Utilities","./Checkbox.base","./Checkbox.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Checkbox=i.styled(o.CheckboxBase,r.getStyles,void 0,{scope:"Checkbox"})});define("office-ui-fabric-react/lib/components/Checkbox/Checkbox.base",["require","exports","tslib","react","../../Utilities","../../Icon","../../KeytipData"],function(e,t,k,P,w,C,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=w.classNamesFunction(),i=function(i){k.__extends(e,i);function e(e,t){var n=i.call(this,e,t)||this;n._checkBox=w.createRef();n._onFocus=function(e){var t=n.props.inputProps;t&&t.onFocus&&t.onFocus(e)};n._onBlur=function(e){var t=n.props.inputProps;t&&t.onBlur&&t.onBlur(e)};n._onClick=function(e){var t=n.props,i=t.disabled,o=t.onChange,r=n.state.isChecked;e.preventDefault();e.stopPropagation();if(!i){o&&o(e,!r);void 0===n.props.checked&&n.setState({isChecked:!r})}};n._onRenderLabel=function(e){var t=e.label;return t?P.createElement("span",{className:n._classNames.text},t):null};n._warnMutuallyExclusive({checked:"defaultChecked"});n._id=w.getId("checkbox-");n.state={isChecked:!!(void 0!==e.checked?e.checked:e.defaultChecked)};return n}e.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({isChecked:!!e.checked})};e.prototype.render=function(){var t=this,e=this.props,i=e.checked,o=e.className,r=e.defaultChecked,n=e.disabled,a=e.inputProps,s=e.name,l=e.boxSide,d=e.theme,c=e.ariaLabel,p=e.ariaLabelledBy,u=e.ariaDescribedBy,h=e.styles,m=e.onRenderLabel,g=void 0===m?this._onRenderLabel:m,f=e.checkmarkIconProps,b=e.ariaPositionInSet,y=e.ariaSetSize,v=e.keytipProps,x=e.title,_=void 0===i?this.state.isChecked:i,S="start"!==l;this._classNames=T(h,{theme:d,className:o,disabled:n,checked:_,reversed:S,isUsingCustomLabelRender:g!==this._onRenderLabel});return P.createElement(I.KeytipData,{keytipProps:v,disabled:n},function(e){return P.createElement("button",k.__assign({},a,{"data-ktp-execute-target":e["data-ktp-execute-target"]},void 0!==i&&{checked:i},void 0!==r&&{defaultChecked:r},{disabled:n,ref:t._checkBox,name:s,id:t._id,role:"checkbox",type:"button",title:x,className:t._classNames.root,onClick:t._onClick,onFocus:t._onFocus,onBlur:t._onBlur,"aria-checked":_,"aria-disabled":n,"aria-label":c,"aria-labelledby":p,"aria-describedby":w.mergeAriaAttributeValues(u,e["aria-describedby"]),"aria-posinset":b,"aria-setsize":y}),P.createElement("label",{className:t._classNames.label,htmlFor:t._id},P.createElement("div",{className:t._classNames.checkbox,"data-ktp-target":e["data-ktp-target"]},P.createElement(C.Icon,k.__assign({iconName:"CheckMark"},f,{className:t._classNames.checkmark}))),g(t.props,t._onRenderLabel)))})};Object.defineProperty(e.prototype,"checked",{get:function(){return this.state.isChecked},enumerable:!0,configurable:!0});e.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()};e.defaultProps={boxSide:"start"};return e}(w.BaseComponent);t.CheckboxBase=i});define("office-ui-fabric-react/lib/components/Checkbox/Checkbox.styles",["require","exports","../../Styling"],function(e,t,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i,o,r,n,a=e.className,s=e.theme,l=e.reversed,d=e.checked,c=e.disabled,p=e.isUsingCustomLabelRender,u=s.semanticColors,h=u.inputForegroundChecked,m=u.disabledBackground,g=u.inputBorder,f=u.smallInputBorder,b=u.inputBackgroundChecked,y=u.disabledBodyText,v=u.inputBorderHovered,x=u.inputBackgroundChecked,_=u.inputBackgroundCheckedHovered,S=u.inputBackgroundCheckedHovered,k=u.bodyText,P=u.disabledBodyText,w=u.bodyText,C=u.disabledText;return{root:["ms-Checkbox",l&&"reversed",d&&"is-checked",!c&&"is-enabled",c&&"is-disabled",I.getFocusStyle(s,-3),s.fonts.medium,{padding:"0",border:"none",background:"none",margin:"0",outline:"none",display:"block",cursor:"pointer"},!c&&[!d&&{selectors:{":hover .ms-Checkbox-checkbox":{borderColor:v,selectors:(t={},t[I.HighContrastSelector]={borderColor:"Highlight"},t)},":focus .ms-Checkbox-checkbox":{borderColor:v},":hover .ms-Checkbox-checkmark":{color:g,opacity:"1",selectors:(i={},i[I.HighContrastSelector]={color:"Highlight"},i)}}},d&&{selectors:(o={":hover .ms-Checkbox-checkbox":{background:_,borderColor:S},":focus .ms-Checkbox-checkbox":{background:_,borderColor:S}},o[I.HighContrastSelector]={selectors:{":hover .ms-Checkbox-checkbox":{background:"Window",borderColor:"Highlight"},":focus .ms-Checkbox-checkbox":{background:"Highlight"},":focus:hover .ms-Checkbox-checkbox":{background:"Highlight"},":focus:hover .ms-Checkbox-checkmark":{color:"Window"},":hover .ms-Checkbox-checkmark":{color:"Highlight"}}},o)},{selectors:{":hover .ms-Checkbox-text":{color:k},":focus .ms-Checkbox-text":{color:k}}}],a],label:["ms-Checkbox-label",{display:"flex",margin:"0 -4px",alignItems:p?"center":"flex-start",cursor:c?"default":"pointer",position:"relative",userSelect:"none",textAlign:"left"},l&&{flexDirection:"row-reverse",justifyContent:"flex-end"}],checkbox:["ms-Checkbox-checkbox",{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",borderWidth:"1px",borderStyle:"solid",borderColor:f,margin:"0 4px",boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden"},!c&&d&&{background:x,borderColor:b,selectors:(r={},r[I.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},r)},c&&{borderColor:y},d&&c&&{background:P,borderColor:y}],checkmark:["ms-Checkbox-checkmark",{opacity:d?"1":"0",color:d&&c?m:h,selectors:(n={},n[I.HighContrastSelector]={color:c?"InactiveBorder":"Window",MsHighContrastAdjust:"none"},n)}],text:["ms-Checkbox-text",{color:c?C:w,margin:"0 4px",fontSize:I.FontSizes.medium,lineHeight:"20px"}]}}});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/DatePicker","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","../../Share.resx","react","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","./ExpirationDatePicker.scss"],function(e,t,i,r,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._platformDetection=t.platformDetection;i._minDate=new Date(Date.now());0<e.expiryRestriction?i._maxDate=new Date(i._minDate.getFullYear(),i._minDate.getMonth(),i._minDate.getDate()+e.expiryRestriction,i._minDate.getHours(),i._minDate.getMinutes(),i._minDate.getSeconds(),i._minDate.getMilliseconds()):i._maxDate=new Date(i._minDate.getFullYear()+1,i._minDate.getMonth(),i._minDate.getDate(),i._minDate.getHours(),i._minDate.getMinutes(),i._minDate.getSeconds(),i._minDate.getMilliseconds());i._datePickerStrings={months:s.months,shortMonths:s.shortMonths,days:s.days,shortDays:s.shortDays,goToToday:l.default.goToToday,setExpirationDate:l.default.setExpirationDate,nextMonthAriaLabel:l.default.nextMonthAriaLabel,prevMonthAriaLabel:l.default.prevMonthAriaLabel,ariaLabel:l.default.expirationDateTextFieldAriaLabel};return i}e.prototype.render=function(){return d.createElement("div",{className:"od-ExpirationDatePicker"},d.createElement("div",{className:"od-ExpirationDatePicker-label"},d.createElement(a.Icon,{iconName:"Calendar"})),d.createElement("div",{className:"od-ExpirationDatePicker-Content"},this._renderExpiresLabel(),d.createElement(n.DatePicker,{strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDate,value:this.props.value,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,showGoToToday:!1}),this._renderRemoveDateButton()))};e.prototype._renderExpiresLabel=function(){if(this.props.value)return d.createElement("span",{className:"od-ExpirationDate-expiresLabel",role:"alert","aria-live":"assertive"},l.default.expires)};e.prototype._renderRemoveDateButton=function(){return 0<this.props.expiryRestriction?d.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":p.format(l.default.expirationDateToolTip,this.props.expiryRestriction)},d.createElement(c.TooltipHost,{hostClassName:"od-ExpirationDatePicker-tooltip",content:p.format(l.default.expirationDateToolTip,this.props.expiryRestriction),directionalHint:1,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},d.createElement(a.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-describedby":p.format(l.default.expirationDateToolTip,this.props.expiryRestriction)}))):d.createElement("div",null,d.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,"aria-label":l.default.removeExpirationLabel},d.createElement(a.Icon,{iconName:"Cancel"})),d.createElement("p",{className:"od-ExpirationDatePicker-hidden",role:"alert","aria-live":"assertive"},this.expirationDateRemoved?l.default.expirationDateRemoved:""))};e.prototype._onDeleteDate=function(){var e=this;this.expirationDateRemoved=!0;this.setState(i.__assign({},this.state),function(){e.props.onSelectDate(null)})};e.prototype._onSelectDate=function(e){this.expirationDateRemoved=!1;this.props.onSelectDate(e)};e.prototype._formatDate=function(e){if(e){var t=e.getDay(),i=e.getMonth();return this._datePickerStrings.days[t]+" "+this._datePickerStrings.shortMonths[i]+" "+e.getDate()+" "+e.getFullYear()}return""};e.contextTypes={platformDetection:u.object.isRequired};i.__decorate([r.autobind],e.prototype,"_onDeleteDate",null);i.__decorate([r.autobind],e.prototype,"_onSelectDate",null);i.__decorate([r.autobind],e.prototype,"_formatDate",null);return e}(d.Component);t.ExpirationDatePicker=o});define("office-ui-fabric-react/lib/DatePicker",["require","exports","tslib","./components/DatePicker/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/DatePicker/index",["require","exports","tslib","./DatePicker","../Calendar/Calendar.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/DatePicker/DatePicker",["require","exports","../../Utilities","./DatePicker.base","./DatePicker.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DatePicker=i.styled(o.DatePickerBase,r.styles,void 0,{scope:"DatePicker"})});define("office-ui-fabric-react/lib/components/DatePicker/DatePicker.base",["require","exports","tslib","react","../../Utilities","../../Calendar","../../utilities/dateValues/DateValues","../../Callout","../../TextField","../../utilities/dateMath/DateMath","../../FocusTrapZone"],function(e,t,P,w,i,C,o,I,T,d,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=i.classNamesFunction(),r={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year"},n=function(t){P.__extends(e,t);function e(e){var p=t.call(this,e)||this;p._calendar=i.createRef();p._datePickerDiv=i.createRef();p._textField=i.createRef();p._onSelectDate=function(e){var t=p.props,i=t.formatDate,o=t.onSelectDate;p.props.calendarProps&&p.props.calendarProps.onSelectDate&&p.props.calendarProps.onSelectDate(e);p.setState({selectedDate:e,formattedDate:i&&e?i(e):""});o&&o(e);p._calendarDismissed()};p._onCalloutPositioned=function(){p._calendar.current&&!p.props.disableAutoFocus&&p._calendar.current.focus()};p._onTextFieldFocus=function(e){p.props.disableAutoFocus||p.props.allowTextInput||p._showDatePickerPopup()};p._onTextFieldBlur=function(e){p._validateTextInput()};p._onTextFieldChanged=function(e,t){if(p.props.allowTextInput){p.state.isDatePickerShown&&p._dismissDatePickerPopup();var i=p.props,o=i.isRequired,r=i.value,n=i.strings;p.setState({errorMessage:o&&!r?n.isRequiredErrorMessage||" ":void 0,formattedDate:t})}};p._onTextFieldKeyDown=function(e){switch(e.which){case 13:e.preventDefault();e.stopPropagation();p.state.isDatePickerShown?p.props.allowTextInput&&p._dismissDatePickerPopup():p._showDatePickerPopup();break;case 27:p._handleEscKey(e)}};p._onTextFieldClick=function(e){p.state.isDatePickerShown||p.props.disabled?p.props.allowTextInput&&p.setState({isDatePickerShown:!1}):p._showDatePickerPopup()};p._onIconClick=function(e){e.stopPropagation();p._onTextFieldClick(e)};p._dismissDatePickerPopup=function(){if(p.state.isDatePickerShown){p.setState({isDatePickerShown:!1});p._validateTextInput()}};p._calendarDismissed=function(){p._dismissDatePickerPopup()};p._handleEscKey=function(e){e.stopPropagation();p._calendarDismissed()};p._validateTextInput=function(){var e=p.props,t=e.isRequired,i=e.allowTextInput,o=e.strings,r=e.parseDateFromString,n=e.onSelectDate,a=e.formatDate,s=e.minDate,l=e.maxDate,d=p.state.formattedDate;if(!p.state.isDatePickerShown)if(!t||d){if(i){var c=null;if(d)if(p.state.selectedDate&&a&&a(p.state.selectedDate)===d)c=p.state.selectedDate;else if(!(c=r(d))||isNaN(c.getTime())){if(a){c=p.state.selectedDate;p.setState({formattedDate:a(c).toString()})}p.setState({errorMessage:o.invalidInputErrorMessage||" "})}else if(p._isDateOutOfBounds(c,s,l))p.setState({errorMessage:o.isOutOfBoundsErrorMessage||" "});else{p.setState({selectedDate:c,errorMessage:""});a&&a(c)!==d&&p.setState({formattedDate:a(c).toString()})}else p.setState({errorMessage:""});n&&n(c)}}else p.setState({errorMessage:o.isRequiredErrorMessage||" "})};p.state=p._getDefaultState();return p}e.prototype.componentWillReceiveProps=function(e){var t=e.formatDate,i=e.isRequired,o=e.strings,r=e.value,n=e.minDate,a=e.maxDate;if(!(d.compareDates(this.props.minDate,e.minDate)&&d.compareDates(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&d.compareDates(this.state.selectedDate,r)&&this.props.formatDate===t)){var s=i&&!r?o.isRequiredErrorMessage||" ":void 0;!s&&r&&(s=this._isDateOutOfBounds(r,n,a)?o.isOutOfBoundsErrorMessage||" ":void 0);this.setState({errorMessage:s});var l=this.state.selectedDate;d.compareDates(l,r)&&this.props.formatDate===t||this.setState({selectedDate:r||void 0,formattedDate:t&&r?t(r):""})}};e.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss()};e.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,i=e.strings,o=e.label,r=e.theme,n=e.className,a=e.styles,s=e.initialPickerDate,l=e.isRequired,d=e.disabled,c=e.ariaLabel,p=e.pickerAriaLabel,u=e.placeholder,h=e.allowTextInput,m=e.borderless,g=e.minDate,f=e.maxDate,b=e.calendarProps,y=this.state,v=y.isDatePickerShown,x=y.formattedDate,_=y.selectedDate,S=y.errorMessage,k=L(a,{theme:r,className:n,disabled:d,label:!!o,isDatePickerShown:v});return w.createElement("div",{className:k.root},w.createElement("div",{ref:this._datePickerDiv},w.createElement(T.TextField,{label:o,ariaLabel:c,"aria-haspopup":"true","aria-expanded":v,required:l,disabled:d,onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChange:this._onTextFieldChanged,errorMessage:S,placeholder:u,borderless:m,iconProps:{iconName:"Calendar",onClick:this._onIconClick,className:k.icon},readOnly:!h,value:x,componentRef:this._textField,role:"button"})),v&&w.createElement(I.Callout,{role:"dialog",ariaLabel:p,isBeakVisible:!1,className:k.callout,gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:4,onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned},w.createElement(D.FocusTrapZone,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus},w.createElement(C.Calendar,P.__assign({},b,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:_||s,firstDayOfWeek:t,strings:i,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:g,maxDate:f,componentRef:this._calendar})))))};e.prototype.focus=function(){this._textField.current&&this._textField.current.focus()};e.prototype.reset=function(){this.setState(this._getDefaultState())};e.prototype._showDatePickerPopup=function(){this.state.isDatePickerShown||this.setState({isDatePickerShown:!0,errorMessage:""})};e.prototype._getDefaultState=function(e){void 0===e&&(e=this.props);return{selectedDate:e.value||void 0,formattedDate:e.formatDate&&e.value?e.formatDate(e.value):"",isDatePickerShown:!1,errorMessage:void 0}};e.prototype._isDateOutOfBounds=function(e,t,i){return!!t&&0<d.compareDatePart(t,e)||!!i&&d.compareDatePart(i,e)<0};e.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:C.DayOfWeek.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:r,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calender",showWeekNumbers:!1,firstWeekOfYear:o.FirstWeekOfYear.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0};return e}(i.BaseComponent);t.DatePickerBase=n});define("office-ui-fabric-react/lib/Calendar",["require","exports","tslib","./components/Calendar/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Calendar/index",["require","exports","tslib","./Calendar","./Calendar.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Calendar/Calendar",["require","exports","tslib","react","../../utilities/dateValues/DateValues","./CalendarDay","./CalendarMonth","../../utilities/dateMath/DateMath","../../Utilities","./Calendar.scss"],function(e,t,o,k,r,P,w,s,C,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=i,n={leftNavigation:"Up",rightNavigation:"Down"},a=[r.DayOfWeek.Monday,r.DayOfWeek.Tuesday,r.DayOfWeek.Wednesday,r.DayOfWeek.Thursday,r.DayOfWeek.Friday],l={formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()},formatDay:function(e){return e.getDate().toString()},formatYear:function(e){return e.getFullYear().toString()}},d=function(i){o.__extends(e,i);function e(e){var a=i.call(this,e)||this;a._dayPicker=C.createRef();a._monthPicker=C.createRef();a._navigateDayPickerDay=function(e){a.setState({navigatedDayDate:e,navigatedMonthDate:e})};a._navigateMonthPickerDay=function(e){a.setState({navigatedMonthDate:e})};a._onNavigateDayDate=function(e,t){a._navigateDayPickerDay(e);a._focusOnUpdate=t};a._onNavigateMonthDate=function(e,t){if(t){!a.props.showMonthPickerAsOverlay&&!a.props.isDayPickerVisible&&a._onSelectDate(e);a._navigateDayPickerDay(e)}else{a._navigateMonthPickerDay(e);a._focusOnUpdate=t}};a._onSelectDate=function(e,t){var i=a.props.onSelectDate;a.setState({selectedDate:e});i&&i(e,t)};a._onHeaderSelect=function(e){a.setState({isDayPickerVisible:!a.state.isDayPickerVisible,isMonthPickerVisible:!a.state.isMonthPickerVisible});e&&(a._focusOnUpdate=!0)};a._onGotoToday=function(){var e=a.props,t=e.dateRangeType,i=e.firstDayOfWeek,o=e.today,r=e.workWeekDays,n=s.getDateRangeArray(o,t,i,r);a._onSelectDate(o,n);a._navigateDayPickerDay(o)};a._onGotoTodayKeyDown=function(e){if(13===e.which){e.preventDefault();a._onGotoToday()}};a._onDatePickerPopupKeyDown=function(e){switch(e.which){case 13:case 8:e.preventDefault();break;case 27:a._handleEscKey(e)}};a._handleEscKey=function(e){a.props.onDismiss&&a.props.onDismiss()};var t=e.value&&!isNaN(e.value.getTime())?e.value:e.today||new Date;a.state={selectedDate:t,navigatedDayDate:t,navigatedMonthDate:t,isMonthPickerVisible:!a.props.showMonthPickerAsOverlay&&a.props.isMonthPickerVisible,isDayPickerVisible:!!a.props.showMonthPickerAsOverlay||a.props.isDayPickerVisible};a._focusOnUpdate=!1;return a}e.prototype.componentWillReceiveProps=function(e){var t=e.autoNavigateOnSelection,i=e.value,o=e.today,r=void 0===o?new Date:o;t&&!s.compareDates(i,this.props.value)&&this.setState({navigatedMonthDate:i,navigatedDayDate:i});this.setState({selectedDate:i||r})};e.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};e.prototype.render=function(){var e,t=this.props,i=t.firstDayOfWeek,o=t.dateRangeType,r=t.strings,n=t.showMonthPickerAsOverlay,a=t.autoNavigateOnSelection,s=t.showGoToToday,l=t.highlightCurrentMonth,d=t.highlightSelectedMonth,c=t.navigationIcons,p=t.minDate,u=t.maxDate,h=t.className,m=this.state,g=m.selectedDate,f=m.navigatedDayDate,b=m.navigatedMonthDate,y=m.isMonthPickerVisible,v=m.isDayPickerVisible,x=n?this._onHeaderSelect:void 0,_=!n&&!v,S=n&&s;return k.createElement("div",{className:C.css("ms-DatePicker",I.root,h),role:"application"},k.createElement("div",{className:C.css("ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused",I.picker,I.pickerIsOpened,I.pickerIsFocused,y&&"ms-DatePicker-monthPickerVisible "+I.monthPickerVisible,y&&v&&"ms-DatePicker-calendarsInline "+I.calendarsInline,_&&"ms-DatePicker-monthPickerOnly "+I.monthPickerOnly,n&&"ms-DatePicker-monthPickerAsOverlay "+I.monthPickerAsOverlay)},k.createElement("div",{className:C.css("ms-DatePicker-holder ms-slideDownIn10",I.holder,S&&I.holderWithButton),onKeyDown:this._onDatePickerPopupKeyDown},k.createElement("div",{className:C.css("ms-DatePicker-frame",I.frame)},k.createElement("div",{className:C.css("ms-DatePicker-wrap",I.wrap,s&&I.goTodaySpacing)},v&&k.createElement(P.CalendarDay,{selectedDate:g,navigatedDate:f,today:this.props.today,onSelectDate:this._onSelectDate,onNavigateDate:this._onNavigateDayDate,onDismiss:this.props.onDismiss,firstDayOfWeek:i,dateRangeType:o,autoNavigateOnSelection:a,strings:r,onHeaderSelect:x,navigationIcons:c,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,dateTimeFormatter:this.props.dateTimeFormatter,showSixWeeksByDefault:this.props.showSixWeeksByDefault,minDate:p,maxDate:u,workWeekDays:this.props.workWeekDays,componentRef:this._dayPicker}),v&&y&&k.createElement("div",{className:I.divider}),y&&k.createElement(w.CalendarMonth,{navigatedDate:b,selectedDate:f,strings:r,onNavigateDate:this._onNavigateMonthDate,today:this.props.today,highlightCurrentMonth:l,highlightSelectedMonth:d,onHeaderSelect:x,navigationIcons:c,dateTimeFormatter:this.props.dateTimeFormatter,minDate:p,maxDate:u,componentRef:this._monthPicker}),s&&k.createElement("button",{role:"button",className:C.css("ms-DatePicker-goToday js-goToday",I.goToday,(e={},e[I.goTodayInlineMonth]=y,e)),onClick:this._onGotoToday,onKeyDown:this._onGotoTodayKeyDown,tabIndex:0},r.goToToday))))))};e.prototype.focus=function(){this.state.isDayPickerVisible&&this._dayPicker.current?this._dayPicker.current.focus():this.state.isMonthPickerVisible&&this._monthPicker.current&&this._monthPicker.current.focus()};e.defaultProps={onSelectDate:void 0,onDismiss:void 0,isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,value:void 0,today:new Date,firstDayOfWeek:r.DayOfWeek.Sunday,dateRangeType:r.DateRangeType.Day,autoNavigateOnSelection:!1,showGoToToday:!0,strings:null,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:n,showWeekNumbers:!1,firstWeekOfYear:r.FirstWeekOfYear.FirstDay,dateTimeFormatter:l,showSixWeeksByDefault:!1,workWeekDays:a};return e}(C.BaseComponent);t.Calendar=d});define("office-ui-fabric-react/lib/utilities/dateValues/DateValues",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Sunday=0]="Sunday";e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=3]="Wednesday";e[e.Thursday=4]="Thursday";e[e.Friday=5]="Friday";e[e.Saturday=6]="Saturday"}(t.DayOfWeek||(t.DayOfWeek={}));!function(e){e[e.January=0]="January";e[e.February=1]="February";e[e.March=2]="March";e[e.April=3]="April";e[e.May=4]="May";e[e.June=5]="June";e[e.July=6]="July";e[e.August=7]="August";e[e.September=8]="September";e[e.October=9]="October";e[e.November=10]="November";e[e.December=11]="December"}(t.MonthOfYear||(t.MonthOfYear={}));!function(e){e[e.FirstDay=0]="FirstDay";e[e.FirstFullWeek=1]="FirstFullWeek";e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(t.FirstWeekOfYear||(t.FirstWeekOfYear={}));!function(e){e[e.Day=0]="Day";e[e.Week=1]="Week";e[e.Month=2]="Month";e[e.WorkWeek=3]="WorkWeek"}(t.DateRangeType||(t.DateRangeType={}))});define("office-ui-fabric-react/lib/components/Calendar/CalendarDay",["require","exports","tslib","react","../../Utilities","../../utilities/dateValues/DateValues","../../FocusZone","../../Icon","../../utilities/dateMath/DateMath","./Calendar.scss"],function(e,t,i,I,T,D,L,E,M,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=o,r=function(t){i.__extends(e,t);function e(e){var u=t.call(this,e)||this;u.days={};u._onKeyDown=function(e,t){13!==t.which&&32!==t.which||e()};u._onDayKeyDown=function(t,i,o){return function(e){u._navigateMonthEdge(e,t,i,o)}};u._onDayMouseDown=function(i,o,e,t){return function(e){t===D.DateRangeType.Month?u._applyFunctionToDayRefs(function(e,t){e&&t.originalDate.getMonth()===i.getMonth()&&e.classList.add(A.dayPress)}):u._applyFunctionToDayRefs(function(e,t,i){if(e&&i===o){e.classList.add(A.dayPress);e.classList.add(A.dayIsHighlighted)}else e&&e.classList.remove(A.dayIsHighlighted)})}};u._onDayMouseUp=function(i,o,e,t){return function(e){t===D.DateRangeType.Month?u._applyFunctionToDayRefs(function(e,t){e&&t.originalDate.getMonth()===i.getMonth()&&e.classList.remove(A.dayPress)}):u._applyFunctionToDayRefs(function(e,t,i){e&&i===o&&e.classList.remove(A.dayPress)})}};u._onDayMouseOver=function(i,o,e,t){return function(e){t===D.DateRangeType.Month?u._applyFunctionToDayRefs(function(e,t){e&&t.originalDate.getMonth()===i.getMonth()&&e.classList.add(A.dayHover)}):u._applyFunctionToDayRefs(function(e,t,i){e&&i===o&&e.classList.add(A.dayHover)})}};u._onDayMouseLeave=function(i,o,e,t){return function(e){t===D.DateRangeType.Month?u._applyFunctionToDayRefs(function(e,t){e&&t.originalDate.getMonth()===i.getMonth()&&e.classList.remove(A.dayHover)}):u._applyFunctionToDayRefs(function(e,t,i){e&&i===o&&e.classList.remove(A.dayHover)})}};u._onTableMouseLeave=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||u._applyFunctionToDayRefs(function(e,t){if(e){e.classList.remove(A.dayHover);e.classList.remove(A.dayPress)}})};u._onTableMouseUp=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||u._applyFunctionToDayRefs(function(e,t){e&&e.classList.remove(A.dayPress)})};u._onSelectDate=function(e){var t=u.props,i=t.onSelectDate,o=t.dateRangeType,r=t.firstDayOfWeek,n=t.navigatedDate,a=t.autoNavigateOnSelection,s=t.minDate,l=t.maxDate,d=t.workWeekDays,c=M.getDateRangeArray(e,o,r,d);o!==D.DateRangeType.Day&&(c=u._getBoundedDateRange(c,s,l));i&&i(e,c);if(a&&e.getMonth()!==n.getMonth()){var p=M.compareDatePart(e,n);p<0?u._onSelectPrevMonth():0<p&&u._onSelectNextMonth()}};u._onSelectNextMonth=function(){u.props.onNavigateDate(M.addMonths(u.props.navigatedDate,1),!1)};u._onSelectPrevMonth=function(){u.props.onNavigateDate(M.addMonths(u.props.navigatedDate,-1),!1)};u._onHeaderSelect=function(){var e=u.props.onHeaderSelect;e&&e(!0)};u._onHeaderKeyDown=function(e){var t=u.props.onHeaderSelect;!t||13!==e.which&&32!==e.which||t(!0)};u._onPrevMonthKeyDown=function(e){13===e.which&&u._onKeyDown(u._onSelectPrevMonth,e)};u._onNextMonthKeyDown=function(e){13===e.which&&u._onKeyDown(u._onSelectNextMonth,e)};u.state={activeDescendantId:T.getId("DatePickerDay-active"),weeks:u._getWeeks(e)};u._onSelectNextMonth=u._onSelectNextMonth.bind(u);u._onSelectPrevMonth=u._onSelectPrevMonth.bind(u);return u}e.prototype.componentWillReceiveProps=function(e){this.setState({weeks:this._getWeeks(e)})};e.prototype.render=function(){var e,t,a=this,i=this.state,s=i.activeDescendantId,o=i.weeks,r=this.props,n=r.firstDayOfWeek,l=r.strings,d=r.navigatedDate,c=r.selectedDate,p=r.dateRangeType,u=r.navigationIcons,h=r.showWeekNumbers,m=r.firstWeekOfYear,g=r.dateTimeFormatter,f=r.minDate,b=r.maxDate,y=T.getId("DatePickerDay-dayPicker"),v=T.getId("DatePickerDay-monthAndYear"),x=u.leftNavigation,_=u.rightNavigation,S=h?M.getWeekNumbersInMonth(o.length,n,m,d):null,k=h?M.getWeekNumber(c,n,m):void 0,P=this._getWeekCornerStyles(o,p),w=!f||M.compareDatePart(f,M.getMonthStart(d))<0,C=!b||M.compareDatePart(M.getMonthEnd(d),b)<0;return I.createElement("div",{className:T.css("ms-DatePicker-dayPicker",A.dayPicker,h&&(T.getRTL()?A.showWeekNumbersRTL:A.showWeekNumbers)),id:y},I.createElement("div",{className:T.css("ms-DatePicker-header",A.header)},I.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:v,className:A.monthAndYear},this.props.onHeaderSelect?I.createElement("div",{className:T.css("ms-DatePicker-monthAndYear js-showMonthPicker",A.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":g.formatMonthYear(d,l),role:"button",tabIndex:0},g.formatMonthYear(d,l)):I.createElement("div",{className:T.css("ms-DatePicker-monthAndYear",A.monthAndYear)},g.formatMonthYear(d,l))),I.createElement("div",{className:T.css("ms-DatePicker-monthComponents",A.monthComponents)},I.createElement("div",{className:T.css("ms-DatePicker-navContainer",A.navContainer)},I.createElement("button",{className:T.css("ms-DatePicker-prevMonth js-prevMonth",A.prevMonth,(e={},e["ms-DatePicker-prevMonth--disabled "+A.prevMonthIsDisabled]=!w,e)),disabled:!w,onClick:w?this._onSelectPrevMonth:void 0,onKeyDown:w?this._onPrevMonthKeyDown:void 0,"aria-controls":y,"aria-label":l.prevMonthAriaLabel?l.prevMonthAriaLabel+" "+l.months[M.addMonths(d,-1).getMonth()]:void 0,role:"button"},I.createElement(E.Icon,{iconName:x})),I.createElement("button",{className:T.css("ms-DatePicker-nextMonth js-nextMonth",A.nextMonth,(t={},t["ms-DatePicker-nextMonth--disabled "+A.nextMonthIsDisabled]=!C,t)),disabled:!C,onClick:C?this._onSelectNextMonth:void 0,onKeyDown:C?this._onNextMonthKeyDown:void 0,"aria-controls":y,"aria-label":l.nextMonthAriaLabel?l.nextMonthAriaLabel+" "+l.months[M.addMonths(d,1).getMonth()]:void 0,role:"button"},I.createElement(E.Icon,{iconName:_}))))),I.createElement(L.FocusZone,null,I.createElement("table",{className:T.css("ms-DatePicker-table",A.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":v,"aria-activedescendant":s},I.createElement("thead",null,I.createElement("tr",null,h&&I.createElement("th",{className:T.css("ms-DatePicker-weekday",A.weekday)}),l.shortDays.map(function(e,t){return I.createElement("th",{className:T.css("ms-DatePicker-weekday",A.weekday),role:"grid",scope:"col",key:t,title:l.days[(t+n)%7],"aria-label":l.days[(t+n)%7]},l.shortDays[(t+n)%7])}))),I.createElement("tbody",{onMouseLeave:p!==D.DateRangeType.Day?this._onTableMouseLeave:void 0,onMouseUp:p!==D.DateRangeType.Day?this._onTableMouseUp:void 0},o.map(function(e,n){return I.createElement("tr",{key:S?S[n]:n,role:"row"},h&&S&&I.createElement("th",{className:T.css("ms-DatePicker-weekNumbers","ms-DatePicker-weekday",A.weekday,A.weekNumbers),key:n,title:S&&l.weekNumberFormatString&&T.format(l.weekNumberFormatString,S[n]),"aria-label":S&&l.weekNumberFormatString&&T.format(l.weekNumberFormatString,S[n]),scope:"row"},I.createElement("div",{className:T.css("ms-DatePicker-day",A.day,(t={},t["ms-DatePicker-week--highlighted "+A.weekIsHighlighted]=k===S[n],t))},I.createElement("span",null,S[n]))),e.map(function(t,e){var i,o,r=M.compareDates(d,t.originalDate);return I.createElement("td",{key:t.key,className:T.css(A.dayWrapper,"ms-DatePicker-day",a._getHighlightedCornerStyle(P,e,n),(i={},i["ms-DatePicker-weekBackground "+A.weekBackground]=t.isSelected&&(p===D.DateRangeType.Week||p===D.DateRangeType.WorkWeek),i["ms-DatePicker-dayBackground "+A.dayBackground]=p===D.DateRangeType.Day,i["ms-DatePicker-day--highlighted "+A.dayIsHighlighted]=t.isSelected&&p===D.DateRangeType.Day,i["ms-DatePicker-day--disabled "+A.dayIsDisabled]=!t.isInBounds,i["ms-DatePicker-day--infocus "+A.dayIsFocused]=t.isInBounds&&t.isInMonth,i["ms-DatePicker-day--outfocus "+A.dayIsUnfocused]=t.isInBounds&&!t.isInMonth,i)),ref:function(e){return a._setDayCellRef(e,t,r)},onClick:t.isInBounds?t.onSelected:void 0,onMouseOver:p!==D.DateRangeType.Day?a._onDayMouseOver(t.originalDate,n,e,p):void 0,onMouseLeave:p!==D.DateRangeType.Day?a._onDayMouseLeave(t.originalDate,n,e,p):void 0,onMouseDown:p!==D.DateRangeType.Day?a._onDayMouseDown(t.originalDate,n,e,p):void 0,onMouseUp:p!==D.DateRangeType.Day?a._onDayMouseUp(t.originalDate,n,e,p):void 0},I.createElement("div",{key:t.key+"div",className:T.css(A.day,(o={},o["ms-DatePicker-day--today "+A.dayIsToday]=t.isToday,o)),role:"gridcell",onKeyDown:a._onDayKeyDown(t.originalDate,n,e),"aria-label":g.formatMonthDayYear(t.originalDate,l),id:r?s:void 0,"aria-selected":t.isInBounds?t.isSelected:void 0,"data-is-focusable":!!t.isInBounds||void 0,ref:function(e){return a._setDayRef(e,t,r)}},I.createElement("span",{"aria-hidden":"true"},g.formatDay(t.originalDate))))}));var t})))))};e.prototype.focus=function(){if(this.navigatedDay){this.navigatedDay.tabIndex=0;this.navigatedDay.focus()}};e.prototype._setDayRef=function(e,t,i){i&&(this.navigatedDay=e)};e.prototype._setDayCellRef=function(e,t,i){this.days[t.key]=e};e.prototype._getWeekCornerStyles=function(p,e){var u={};switch(e){case D.DateRangeType.Month:p.forEach(function(e,c){e.forEach(function(e,t){var i=p[c-1]&&p[c-1][t]&&p[c-1][t].originalDate.getMonth()===p[c][t].originalDate.getMonth(),o=p[c+1]&&p[c+1][t]&&p[c+1][t].originalDate.getMonth()===p[c][t].originalDate.getMonth(),r=p[c][t-1]&&p[c][t-1].originalDate.getMonth()===p[c][t].originalDate.getMonth(),n=p[c][t+1]&&p[c][t+1].originalDate.getMonth()===p[c][t].originalDate.getMonth(),a=!i&&!n,s=!o&&!r,l=!o&&!n,d="";!i&&!r&&(d=T.getRTL()?d.concat(A.topRightCornerDate+" "):d.concat(A.topLeftCornerDate+" "));a&&(d=T.getRTL()?d.concat(A.topLeftCornerDate+" "):d.concat(A.topRightCornerDate+" "));s&&(d=T.getRTL()?d.concat(A.bottomRightCornerDate+" "):d.concat(A.bottomLeftCornerDate+" "));l&&(d=T.getRTL()?d.concat(A.bottomLeftCornerDate+" "):d.concat(A.bottomRightCornerDate+" "));u[c+"_"+t]=d})});break;case D.DateRangeType.Week:case D.DateRangeType.WorkWeek:p.forEach(function(e,t){var i=A.topLeftCornerDate+" "+A.bottomLeftCornerDate,o=A.topRightCornerDate+" "+A.bottomRightCornerDate;u[t+"_0"]=T.getRTL()?o:i;u[t+"_6"]=T.getRTL()?i:o})}return u};e.prototype._getHighlightedCornerStyle=function(e,t,i){return e[i+"_"+t]?e[i+"_"+t]:""};e.prototype._navigateMonthEdge=function(e,t,i,o){var r=this.props,n=r.minDate,a=r.maxDate,s=void 0;0===i&&38===e.which?s=M.addWeeks(t,-1):i===this.state.weeks.length-1&&40===e.which?s=M.addWeeks(t,1):0===o&&e.which===T.getRTLSafeKeyCode(37)?s=M.addDays(t,-1):6===o&&e.which===T.getRTLSafeKeyCode(39)&&(s=M.addDays(t,1));if(s&&(!n||M.compareDatePart(n,s)<1)&&(!a||M.compareDatePart(s,a)<1)){this.props.onNavigateDate(s,!0);e.preventDefault()}};e.prototype._applyFunctionToDayRefs=function(o){var r=this;this.state.weeks&&this.state.weeks.map(function(e,i){e.map(function(e){var t=r.days[e.key];o(t,e,i)})})};e.prototype._getWeeks=function(e){for(var t=e.navigatedDate,i=e.selectedDate,o=e.dateRangeType,r=e.firstDayOfWeek,n=e.today,a=e.minDate,s=e.maxDate,l=e.showSixWeeksByDefault,d=e.workWeekDays,c=new Date(t.getFullYear(),t.getMonth(),1),p=n||new Date,u=[];c.getDay()!==r;)c.setDate(c.getDate()-1);var h=!1,m=o===D.DateRangeType.WorkWeek?D.DateRangeType.Week:o,g=M.getDateRangeArray(i,m,r,d);o!==D.DateRangeType.Day&&(g=this._getBoundedDateRange(g,a,s));for(var f=!0,b=0;f;b++){var y=[];h=!0;for(var v=0;v<7;v++){var x=new Date(c.toString()),_={key:c.toString(),date:c.getDate().toString(),originalDate:x,isInMonth:c.getMonth()===t.getMonth(),isToday:M.compareDates(p,c),isSelected:M.isInDateRangeArray(c,g),onSelected:this._onSelectDate.bind(this,x),isInBounds:(!a||M.compareDatePart(a,c)<1)&&(!s||M.compareDatePart(c,s)<1)};y.push(_);_.isInMonth&&(h=!1);c.setDate(c.getDate()+1)}(f=l?!h||b<=5:!h)&&u.push(y)}return u};e.prototype._getBoundedDateRange=function(e,t,i){var o=e.slice();t&&(o=o.filter(function(e){return 0<=M.compareDatePart(e,t)}));i&&(o=o.filter(function(e){return M.compareDatePart(e,i)<=0}));return o};return e}(T.BaseComponent);t.CalendarDay=r});define("office-ui-fabric-react/lib/utilities/dateMath/DateMath",["require","exports","../dateValues/DateValues","../dateValues/TimeConstants","../../Utilities"],function(e,t,m,g,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function d(e,t){var i=new Date(e.getTime());i.setDate(i.getDate()+t);return i}t.addDays=d;t.addWeeks=function(e,t){return d(e,t*g.default.DaysInOneWeek)};function c(e,t){var i=new Date(e.getTime()),o=i.getMonth()+t;i.setMonth(o);i.getMonth()!==(o%g.default.MonthInOneYear+g.default.MonthInOneYear)%g.default.MonthInOneYear&&(i=d(i,-i.getDate()));return i}t.addMonths=c;t.addYears=function(e,t){var i=new Date(e.getTime());i.setFullYear(e.getFullYear()+t);i.getMonth()!==(e.getMonth()%g.default.MonthInOneYear+g.default.MonthInOneYear)%g.default.MonthInOneYear&&(i=d(i,-i.getDate()));return i};t.getMonthStart=function(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)};t.getMonthEnd=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)};t.getYearStart=function(e){return new Date(e.getFullYear(),0,1,0,0,0,0)};t.getYearEnd=function(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)};t.setMonth=function(e,t){return c(e,t-e.getMonth())};function p(e,t){return!e&&!t||!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}t.compareDates=p;t.compareDatePart=function(e,t){return i(e)-i(t)};t.getDateRangeArray=function(e,t,i,o){var r,n=new Array,a=null;o||(o=[m.DayOfWeek.Monday,m.DayOfWeek.Tuesday,m.DayOfWeek.Wednesday,m.DayOfWeek.Thursday,m.DayOfWeek.Friday]);switch(t){case m.DateRangeType.Day:a=d(r=u(e),1);break;case m.DateRangeType.Week:case m.DateRangeType.WorkWeek:a=d(r=function(e,t){var i=t-e.getDay();0<i&&(i-=g.default.DaysInOneWeek);return d(e,i)}(u(e),i),g.default.DaysInOneWeek);break;case m.DateRangeType.Month:a=c(r=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:return l.assertNever(t)}var s=r;do{t!==m.DateRangeType.WorkWeek?n.push(s):o.includes(s.getDay())&&n.push(s);s=d(s,1)}while(!p(s,a));return n};t.isInDateRangeArray=function(e,t){for(var i=0,o=t;i<o.length;i++)if(p(e,o[i]))return!0;return!1};t.getWeekNumbersInMonth=function(e,t,i,o){var r,n,a=o.getFullYear(),s=o.getMonth(),l=1,d=new Date(a,s,l),c=l+(t+g.default.DaysInOneWeek-1)-(r=t,n=d.getDay(),r!==m.DayOfWeek.Sunday&&n<r?n+g.default.DaysInOneWeek:n),p=new Date(a,s,c);l=p.getDate();for(var u=[],h=0;h<e;h++){u.push(f(p,t,i));l+=g.default.DaysInOneWeek;p=new Date(a,s,l)}return u};function f(e,t,i){var o,r,n,a;switch(i){case m.FirstWeekOfYear.FirstFullWeek:return s(e,t,g.default.DaysInOneWeek);case m.FirstWeekOfYear.FirstFourDayWeek:return s(e,t,4);default:return r=t,n=h(o=e)-1,a=(o.getDay()-n%g.default.DaysInOneWeek-r+2*g.default.DaysInOneWeek)%g.default.DaysInOneWeek,Math.floor((n+a)/g.default.DaysInOneWeek+1)}}t.getWeekNumber=f;function u(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function i(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function s(e,t,i){var o=h(e)-1,r=e.getDay()-o%g.default.DaysInOneWeek,n=h(new Date(e.getFullYear()-1,m.MonthOfYear.December,31))-1,a=(t-r+2*g.default.DaysInOneWeek)%g.default.DaysInOneWeek;0!==a&&i<=a&&(a-=g.default.DaysInOneWeek);var s=o-a;if(s<0){0!==(a=(t-(r-=n%g.default.DaysInOneWeek)+2*g.default.DaysInOneWeek)%g.default.DaysInOneWeek)&&i<=a+1&&(a-=g.default.DaysInOneWeek);s=n-a}return Math.floor(s/g.default.DaysInOneWeek+1)}function h(e){for(var t=e.getMonth(),i=e.getFullYear(),o=0,r=0;r<t;r++)o+=new Date(i,r+1,0).getDate();return o+=e.getDate()}});define("office-ui-fabric-react/lib/utilities/dateValues/TimeConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12}});define("office-ui-fabric-react/lib/components/Calendar/Calendar.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_c754aea6{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.root_c754aea6 *::-moz-focus-inner{border:0}.root_c754aea6 *{outline:transparent}.root_c754aea6 *{position:relative}.ms-Fabric--isFocusVisible .root_c754aea6 *:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_c754aea6 *::-moz-focus-inner{border:0}.root_c754aea6 *{outline:transparent}.root_c754aea6 *{position:relative}.root_c754aea6 *:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:2px solid WindowText}}.picker_c754aea6{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px;position:relative}html[dir='ltr'] .picker_c754aea6{text-align:left}html[dir='rtl'] .picker_c754aea6{text-align:right}.holder_c754aea6{-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;box-sizing:border-box;display:none}.picker_c754aea6.pickerIsOpened_c754aea6 .holder_c754aea6{-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block}.pickerIsOpened_c754aea6{position:relative}.frame_c754aea6{position:relative}.wrap_c754aea6{min-height:212px;padding:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-sizing:content-box;box-sizing:content-box}.wrap_c754aea6.goTodaySpacing_c754aea6{min-height:228px}.dayPicker_c754aea6{display:block}.header_c754aea6{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:28px;line-height:44px;width:100%}.divider_c754aea6{top:0;margin-top:-12px;margin-bottom:-12px}html[dir='ltr'] .divider_c754aea6{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir='rtl'] .divider_c754aea6{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.monthAndYear_c754aea6,.year_c754aea6{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600;padding:0 5px}.monthAndYear_c754aea6:hover,.currentYear_c754aea6:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.table_c754aea6{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit;margin-top:4px;width:197px}.table_c754aea6 td{margin:0;padding:0}.table_c754aea6 td:hover{outline:1px solid transparent}.dayWrapper_c754aea6,.weekday_c754aea6{width:28px;height:28px;padding:0;line-height:28px;font-size:12px;font-size:15px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.dayWrapper_c754aea6 *::-moz-focus-inner,.weekday_c754aea6 *::-moz-focus-inner{border:0}.dayWrapper_c754aea6 *,.weekday_c754aea6 *{outline:transparent}.dayWrapper_c754aea6 *,.weekday_c754aea6 *{position:relative}.ms-Fabric--isFocusVisible .dayWrapper_c754aea6 *:focus:after,.ms-Fabric--isFocusVisible .weekday_c754aea6 *:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast: active){.dayWrapper_c754aea6 *::-moz-focus-inner,.weekday_c754aea6 *::-moz-focus-inner{border:0}.dayWrapper_c754aea6 *,.weekday_c754aea6 *{outline:transparent}.dayWrapper_c754aea6 *,.weekday_c754aea6 *{position:relative}.dayWrapper_c754aea6 *:after,.weekday_c754aea6 *:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:2px solid WindowText}}.day_c754aea6{width:24px;height:24px;border-radius:2px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.dayIsToday_c754aea6,.dayIsToday_c754aea6:hover{position:relative;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.dayIsToday_c754aea6,.dayIsToday_c754aea6:hover{border:1px solid WindowText}}.dayIsDisabled_c754aea6:before{border-top-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayIsUnfocused_c754aea6,.dayIsDisabled_c754aea6{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:400}.dayIsFocused_c754aea6:hover,.dayIsUnfocused_c754aea6:hover{cursor:pointer;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.dayIsHighlighted_c754aea6:hover,.pickerIsFocused_c754aea6 .dayIsHighlighted_c754aea6{cursor:pointer}@media screen and (-ms-high-contrast: active){.dayIsHighlighted_c754aea6:hover,.pickerIsFocused_c754aea6 .dayIsHighlighted_c754aea6{border:2px solid Highlight}}.dayIsFocused_c754aea6:active,.dayIsHighlighted_c754aea6{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.dayIsFocused_c754aea6:active.day_c754aea6,.dayIsHighlighted_c754aea6.day_c754aea6{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.dayIsHighlighted_c754aea6.dayDisabled_c754aea6,.dayIsHighlighted_c754aea6.dayDisabled_c754aea6:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayBackground_c754aea6,.dayBackground_c754aea6:hover,.dayBackground_c754aea6:active{border-radius:2px}.dayHover_c754aea6,.dayHover_c754aea6:hover{cursor:pointer;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.dayPress_c754aea6,.dayPress_c754aea6:hover{cursor:pointer;font-weight:600;background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.dayPress_c754aea6 .dayIsToday_c754aea6,.dayPress_c754aea6:hover .dayIsToday_c754aea6{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.dayIsUnfocused_c754aea6:active,.dayIsFocused_c754aea6:active,.dayIsHighlighted_c754aea6,.dayIsHighlighted_c754aea6:hover,.dayIsHighlighted_c754aea6:active,.weekBackground_c754aea6,.weekBackground_c754aea6:hover,.weekBackground_c754aea6:active{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.dayIsToday_c754aea6,.dayIsToday_c754aea6,.pickerIsFocused_c754aea6 .dayIsToday_c754aea6,.dayIsToday_c754aea6.day_c754aea6:active{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:600;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.showWeekNumbers_c754aea6 .weekNumbers_c754aea6{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:28x;padding:0}.showWeekNumbers_c754aea6 .weekNumbers_c754aea6 .dayWrapper_c754aea6{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbers_c754aea6 .weekNumbers_c754aea6 .dayWrapper_c754aea6.weekIsHighlighted_c754aea6{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.showWeekNumbers_c754aea6 .table_c754aea6{width:225px}.showWeekNumbers_c754aea6 .table_c754aea6 .dayWrapper_c754aea6,.showWeekNumbers_c754aea6 .table_c754aea6 .weekday_c754aea6{width:30px}.showWeekNumbersRTL_c754aea6 .weekNumbers_c754aea6{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.showWeekNumbersRTL_c754aea6 .weekNumbers_c754aea6 .dayWrapper_c754aea6{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbersRTL_c754aea6 .weekNumbers_c754aea6 .dayWrapper_c754aea6.weekIsHighlighted_c754aea6{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.showWeekNumbersRTL_c754aea6 .table_c754aea6:not(.weekNumbers_c754aea6){margin-right:30px}.showWeekNumbersRTL_c754aea6 .table_c754aea6 .dayWrapper_c754aea6,.showWeekNumbersRTL_c754aea6 .table_c754aea6 .weekday_c754aea6{width:30px}.monthComponents_c754aea6,.yearComponents_c754aea6,.decadeComponents_c754aea6{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-item-align:end;align-self:flex-end}.prevMonth_c754aea6,.nextMonth_c754aea6,.prevYear_c754aea6,.nextYear_c754aea6,.prevDecade_c754aea6,.nextDecade_c754aea6{width:28px;height:28px;display:block;text-align:center;line-height:28px;text-align:center;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";border-radius:2px;position:relative;background-color:transparent;border:none;padding:0}.prevMonth_c754aea6:hover,.nextMonth_c754aea6:hover,.prevYear_c754aea6:hover,.nextYear_c754aea6:hover,.prevDecade_c754aea6:hover,.nextDecade_c754aea6:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";cursor:pointer;outline:1px solid transparent}.prevMonthIsDisabled_c754aea6,.nextMonthIsDisabled_c754aea6,.prevYearIsDisabled_c754aea6,.nextYearIsDisabled_c754aea6,.prevDecadeIsDisabled_c754aea6,.nextDecadeIsDisabled_c754aea6{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.headerToggleView_c754aea6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 8px}.headerToggleView_c754aea6:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";cursor:pointer}.currentYear_c754aea6,.currentDecade_c754aea6{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:0 5px;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:28px;line-height:28px;font-weight:600}html[dir='ltr'] .currentYear_c754aea6,html[dir='ltr'] .currentDecade_c754aea6{margin-left:5px}html[dir='rtl'] .currentYear_c754aea6,html[dir='rtl'] .currentDecade_c754aea6{margin-right:5px}.optionGrid_c754aea6{position:relative;height:210px;width:196px;margin:4px 0 0 0}html[dir='rtl'] .optionGrid_c754aea6{margin:4px 0 0 0}.monthOption_c754aea6,.yearOption_c754aea6{width:60px;height:60px;line-height:60px;cursor:pointer;margin:0 10px 10px 0;font-size:13px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";text-align:center;border:none;padding:0;background-color:transparent;border-radius:2px}html[dir='ltr'] .monthOption_c754aea6,html[dir='ltr'] .yearOption_c754aea6{float:left}html[dir='rtl'] .monthOption_c754aea6,html[dir='rtl'] .yearOption_c754aea6{float:right}html[dir='rtl'] .monthOption_c754aea6,html[dir='rtl'] .yearOption_c754aea6{margin:0 0 10px 10px}.monthOption_c754aea6:hover,.yearOption_c754aea6:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";outline:1px solid transparent}.monthOption_c754aea6.isHighlighted_c754aea6,.yearOption_c754aea6.isHighlighted_c754aea6{background-color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.dayIsDisabled_c754aea6,.monthOptionIsDisabled_c754aea6,.yearOptionIsDisabled_c754aea6{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.goToday_c754aea6{bottom:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:30px;line-height:30px;padding:0 10px;background-color:transparent;border:none;position:absolute !important;-webkit-box-sizing:content-box;box-sizing:content-box}[dir='ltr'] .goToday_c754aea6{right:13px}[dir='rtl'] .goToday_c754aea6{left:13px}.goToday_c754aea6:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:1px solid transparent}.goToday_c754aea6:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.goTodayInlineMonth_c754aea6{top:212px}.wrap_c754aea6.goTodaySpacing_c754aea6{padding-bottom:28px}.root_c754aea6.isPickingYears_c754aea6 .dayPicker_c754aea6,.root_c754aea6.isPickingYears_c754aea6 .monthComponents_c754aea6{display:none}.root_c754aea6.isPickingYears_c754aea6 .monthPicker_c754aea6{display:none}.root_c754aea6.isPickingYears_c754aea6 .yearPicker_c754aea6{display:block}@media (min-device-width: 460px){.wrap_c754aea6{padding:12px}.dayPicker_c754aea6,.monthPicker_c754aea6{min-height:200px}.header_c754aea6{height:28px;line-height:28px;width:100%}.dayWrapper_c754aea6,.weekday_c754aea6{width:28px;height:28px;line-height:28px;font-size:12px}.prevMonth_c754aea6,.nextMonth_c754aea6,.prevYear_c754aea6,.nextYear_c754aea6,.prevDecade_c754aea6,.nextDecade_c754aea6{font-size:12px;width:28px;height:28px;line-height:28px}.holder_c754aea6{display:inline-block;height:auto}.monthAndYear_c754aea6,.year_c754aea6{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.yearComponents_c754aea6{margin-left:1px}.goToday_c754aea6{padding:0 3px}[dir='ltr'] .goToday_c754aea6{right:20px}[dir='rtl'] .goToday_c754aea6{left:20px}.showWeekNumbers_c754aea6 .table_c754aea6 .dayWrapper_c754aea6,.showWeekNumbers_c754aea6 .table_c754aea6 .weekday_c754aea6{width:28px}.showWeekNumbersRTL_c754aea6 .table_c754aea6 .dayWrapper_c754aea6,.showWeekNumbersRTL_c754aea6 .table_c754aea6 .weekday_c754aea6{width:28px}.monthPickerVisible_c754aea6 .wrap_c754aea6{padding:12px}.monthPickerVisible_c754aea6 .dayPicker_c754aea6{margin:-10px 0;padding:10px 0}.monthPickerVisible_c754aea6 .dayPicker_c754aea6{-webkit-box-sizing:border-box;box-sizing:border-box;width:212px;min-height:200px}.monthPickerVisible_c754aea6 .monthPicker_c754aea6{display:block}.monthPickerVisible_c754aea6 .optionGrid_c754aea6{height:150px;width:196px}.monthPickerVisible_c754aea6 .toggleMonthView_c754aea6{display:none}.monthPickerVisible_c754aea6 .currentYear_c754aea6,.monthPickerVisible_c754aea6 .currentDecade_c754aea6{font-size:14px;margin:0;height:28px;line-height:28px;display:inline-block}.monthPickerVisible_c754aea6 .monthOption_c754aea6,.monthPickerVisible_c754aea6 .yearOption_c754aea6{width:40px;height:40px;line-height:40px;font-size:12px;margin:0 12px 16px 0}html[dir='rtl'] .monthPickerVisible_c754aea6 .monthOption_c754aea6,html[dir='rtl'] .monthPickerVisible_c754aea6 .yearOption_c754aea6{margin:0 0 16px 12px}.monthPickerVisible_c754aea6 .monthOption_c754aea6:hover,.monthPickerVisible_c754aea6 .yearOption_c754aea6:hover{outline:1px solid transparent}.monthPickerVisible_c754aea6 .monthOption_c754aea6:nth-child(4n+4),.monthPickerVisible_c754aea6 .yearOption_c754aea6:nth-child(4n+4){margin:0 0px 16px 0}html[dir='rtl'] .monthPickerVisible_c754aea6 .monthOption_c754aea6:nth-child(4n+4),html[dir='rtl'] .monthPickerVisible_c754aea6 .yearOption_c754aea6:nth-child(4n+4){margin:0 0 16px 0px}.monthPickerVisible_c754aea6 .goToday_c754aea6{font-size:12px;height:28px;line-height:28px;padding:0 10px}[dir='ltr'] .monthPickerVisible_c754aea6 .goToday_c754aea6{right:8px}[dir='rtl'] .monthPickerVisible_c754aea6 .goToday_c754aea6{left:8px}html[dir='ltr'] .monthPickerVisible_c754aea6 .goToday_c754aea6{text-align:right}html[dir='rtl'] .monthPickerVisible_c754aea6 .goToday_c754aea6{text-align:left}.monthPickerVisible_c754aea6 .root_c754aea6.isPickingYears_c754aea6 .dayPicker_c754aea6,.monthPickerVisible_c754aea6 .root_c754aea6.isPickingYears_c754aea6 .monthComponents_c754aea6{display:block}.monthPickerVisible_c754aea6 .root_c754aea6.isPickingYears_c754aea6 .monthPicker_c754aea6{display:none}.monthPickerVisible_c754aea6 .root_c754aea6.isPickingYears_c754aea6 .yearPicker_c754aea6{display:block}.calendarsInline_c754aea6 .wrap_c754aea6{padding:12px}.calendarsInline_c754aea6 .holder_c754aea6{height:auto}html[dir='ltr'] .calendarsInline_c754aea6 .table_c754aea6{margin-right:12px}html[dir='rtl'] .calendarsInline_c754aea6 .table_c754aea6{margin-left:12px}.calendarsInline_c754aea6 .dayPicker_c754aea6{width:auto}html[dir='ltr'] .calendarsInline_c754aea6 .monthPicker_c754aea6{margin-left:12px}html[dir='rtl'] .calendarsInline_c754aea6 .monthPicker_c754aea6{margin-right:12px}.calendarsInline_c754aea6 .goToday_c754aea6{padding:0 10px}[dir='ltr'] .calendarsInline_c754aea6 .goToday_c754aea6{right:14px}[dir='rtl'] .calendarsInline_c754aea6 .goToday_c754aea6{left:14px}html[dir='ltr'] .calendarsInline_c754aea6 .monthComponents_c754aea6{margin-right:12px}html[dir='rtl'] .calendarsInline_c754aea6 .monthComponents_c754aea6{margin-left:12px}.monthPickerOnly_c754aea6 .wrap_c754aea6{padding:12px}.monthPickerAsOverlay_c754aea6 .wrap_c754aea6{padding-bottom:28px;margin-bottom:6px}.monthPickerAsOverlay_c754aea6 .holder_c754aea6{height:240px;min-height:240px}.monthPickerAsOverlay_c754aea6 .holderWithButton_c754aea6{padding-top:6px;height:auto}}@media (max-device-width: 459px){.calendarsInline_c754aea6 .monthPicker_c754aea6,.calendarsInline_c754aea6 .yearPicker_c754aea6{display:none}.yearComponents_c754aea6{margin-top:2px}}.goToday_c754aea6{width:auto}.nextMonth_c754aea6,.prevMonth_c754aea6,.nextYear_c754aea6,.prevYear_c754aea6{display:inline-block}.nextMonth_c754aea6:hover,.prevMonth_c754aea6:hover,.nextYear_c754aea6:hover,.prevYear_c754aea6:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.nextMonth_c754aea6:active,.prevMonth_c754aea6:active,.nextYear_c754aea6:active,.prevYear_c754aea6:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.monthIsHighlighted_c754aea6{font-weight:600;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.monthIsHighlighted_c754aea6.monthOption_c754aea6:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.monthIsCurrentMonth_c754aea6{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthIsCurrentMonth_c754aea6.monthOption_c754aea6:hover{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthOption_c754aea6:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.topLeftCornerDate_c754aea6{border-top-left-radius:2px}.topRightCornerDate_c754aea6{border-top-right-radius:2px}.bottomLeftCornerDate_c754aea6{border-bottom-left-radius:2px}.bottomRightCornerDate_c754aea6{border-bottom-right-radius:2px}\n"}]);t.root="root_c754aea6";t.picker="picker_c754aea6";t.holder="holder_c754aea6";t.pickerIsOpened="pickerIsOpened_c754aea6";t.frame="frame_c754aea6";t.wrap="wrap_c754aea6";t.goTodaySpacing="goTodaySpacing_c754aea6";t.dayPicker="dayPicker_c754aea6";t.header="header_c754aea6";t.divider="divider_c754aea6";t.monthAndYear="monthAndYear_c754aea6";t.year="year_c754aea6";t.currentYear="currentYear_c754aea6";t.table="table_c754aea6";t.dayWrapper="dayWrapper_c754aea6";t.weekday="weekday_c754aea6";t.day="day_c754aea6";t.dayIsToday="dayIsToday_c754aea6";t.dayIsDisabled="dayIsDisabled_c754aea6";t.dayIsUnfocused="dayIsUnfocused_c754aea6";t.dayIsFocused="dayIsFocused_c754aea6";t.dayIsHighlighted="dayIsHighlighted_c754aea6";t.pickerIsFocused="pickerIsFocused_c754aea6";t.dayDisabled="dayDisabled_c754aea6";t.dayBackground="dayBackground_c754aea6";t.dayHover="dayHover_c754aea6";t.dayPress="dayPress_c754aea6";t.weekBackground="weekBackground_c754aea6";t.showWeekNumbers="showWeekNumbers_c754aea6";t.weekNumbers="weekNumbers_c754aea6";t.weekIsHighlighted="weekIsHighlighted_c754aea6";t.showWeekNumbersRTL="showWeekNumbersRTL_c754aea6";t.monthComponents="monthComponents_c754aea6";t.yearComponents="yearComponents_c754aea6";t.decadeComponents="decadeComponents_c754aea6";t.prevMonth="prevMonth_c754aea6";t.nextMonth="nextMonth_c754aea6";t.prevYear="prevYear_c754aea6";t.nextYear="nextYear_c754aea6";t.prevDecade="prevDecade_c754aea6";t.nextDecade="nextDecade_c754aea6";t.prevMonthIsDisabled="prevMonthIsDisabled_c754aea6";t.nextMonthIsDisabled="nextMonthIsDisabled_c754aea6";t.prevYearIsDisabled="prevYearIsDisabled_c754aea6";t.nextYearIsDisabled="nextYearIsDisabled_c754aea6";t.prevDecadeIsDisabled="prevDecadeIsDisabled_c754aea6";t.nextDecadeIsDisabled="nextDecadeIsDisabled_c754aea6";t.headerToggleView="headerToggleView_c754aea6";t.currentDecade="currentDecade_c754aea6";t.optionGrid="optionGrid_c754aea6";t.monthOption="monthOption_c754aea6";t.yearOption="yearOption_c754aea6";t.isHighlighted="isHighlighted_c754aea6";t.monthOptionIsDisabled="monthOptionIsDisabled_c754aea6";t.yearOptionIsDisabled="yearOptionIsDisabled_c754aea6";t.goToday="goToday_c754aea6";t.goTodayInlineMonth="goTodayInlineMonth_c754aea6";t.isPickingYears="isPickingYears_c754aea6";t.monthPicker="monthPicker_c754aea6";t.yearPicker="yearPicker_c754aea6";t.monthPickerVisible="monthPickerVisible_c754aea6";t.toggleMonthView="toggleMonthView_c754aea6";t.calendarsInline="calendarsInline_c754aea6";t.monthPickerOnly="monthPickerOnly_c754aea6";t.monthPickerAsOverlay="monthPickerAsOverlay_c754aea6";t.holderWithButton="holderWithButton_c754aea6";t.monthIsHighlighted="monthIsHighlighted_c754aea6";t.monthIsCurrentMonth="monthIsCurrentMonth_c754aea6";t.topLeftCornerDate="topLeftCornerDate_c754aea6";t.topRightCornerDate="topRightCornerDate_c754aea6";t.bottomLeftCornerDate="bottomLeftCornerDate_c754aea6";t.bottomRightCornerDate="bottomRightCornerDate_c754aea6"});define("office-ui-fabric-react/lib/components/Calendar/CalendarMonth",["require","exports","tslib","react","../../Utilities","../../FocusZone","../../utilities/dateMath/DateMath","../../Icon","./Calendar.scss"],function(e,t,i,v,x,l,_,S,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=o,r=function(t){i.__extends(e,t);function e(e){var n=t.call(this,e)||this;n._onKeyDown=function(e,t){13===t.which&&e()};n._onSelectNextYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(_.addYears(t,1),!1)};n._onSelectNextYearKeyDown=function(e){13===e.which&&n._onKeyDown(n._onSelectNextYear,e)};n._onSelectPrevYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(_.addYears(t,-1),!1)};n._onSelectPrevYearKeyDown=function(e){13===e.which&&n._onKeyDown(n._onSelectPrevYear,e)};n._onSelectMonthKeyDown=function(t){return function(e){return n._onKeyDown(function(){return n._onSelectMonth(t)},e)}};n._onSelectMonth=function(e){var t=n.props,i=t.navigatedDate,o=t.onNavigateDate,r=t.onHeaderSelect;r&&r(!0);o(_.setMonth(i,e),!0)};n._onHeaderSelect=function(){var e=n.props.onHeaderSelect;e&&e(!0)};n._onHeaderKeyDown=function(e){var t=n.props.onHeaderSelect;!t||13!==e.which&&32!==e.which||t(!0)};n._selectMonthCallbacks=[];e.strings.shortMonths.map(function(e,t){n._selectMonthCallbacks[t]=n._onSelectMonth.bind(n,t)});n._isCurrentMonth=n._isCurrentMonth.bind(n);n._onSelectNextYear=n._onSelectNextYear.bind(n);n._onSelectPrevYear=n._onSelectPrevYear.bind(n);n._onSelectMonth=n._onSelectMonth.bind(n);return n}e.prototype.render=function(){var e,t,d=this,i=this.props,c=i.navigatedDate,p=i.selectedDate,u=i.strings,h=i.today,m=i.highlightCurrentMonth,g=i.highlightSelectedMonth,o=i.navigationIcons,f=i.dateTimeFormatter,b=i.minDate,y=i.maxDate,r=o.leftNavigation,n=o.rightNavigation,a=!b||_.compareDatePart(b,_.getYearStart(c))<0,s=!y||_.compareDatePart(_.getYearEnd(c),y)<0;return v.createElement("div",{className:x.css("ms-DatePicker-monthPicker",k.monthPicker)},v.createElement("div",{className:x.css("ms-DatePicker-header",k.header)},this.props.onHeaderSelect?v.createElement("div",{className:x.css("ms-DatePicker-currentYear js-showYearPicker",k.currentYear,k.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":f.formatYear(c),role:"button",tabIndex:0},f.formatYear(c)):v.createElement("div",{className:x.css("ms-DatePicker-currentYear js-showYearPicker",k.currentYear)},f.formatYear(c)),v.createElement("div",{className:x.css("ms-DatePicker-yearComponents",k.yearComponents)},v.createElement("div",{className:x.css("ms-DatePicker-navContainer",k.navContainer)},v.createElement("button",{className:x.css("ms-DatePicker-prevYear js-prevYear",k.prevYear,(e={},e["ms-DatePicker-prevYear--disabled "+k.prevYearIsDisabled]=!a,e)),disabled:!a,onClick:a?this._onSelectPrevYear:void 0,onKeyDown:a?this._onSelectPrevYearKeyDown:void 0,"aria-label":u.prevYearAriaLabel?u.prevYearAriaLabel+" "+f.formatYear(_.addYears(c,-1)):void 0,role:"button"},v.createElement(S.Icon,{iconName:x.getRTL()?n:r})),v.createElement("button",{className:x.css("ms-DatePicker-nextYear js-nextYear",k.nextYear,(t={},t["ms-DatePicker-nextYear--disabled "+k.nextYearIsDisabled]=!s,t)),disabled:!s,onClick:s?this._onSelectNextYear:void 0,onKeyDown:s?this._onSelectNextYearKeyDown:void 0,"aria-label":u.nextYearAriaLabel?u.nextYearAriaLabel+" "+f.formatYear(_.addYears(c,1)):void 0,role:"button"},v.createElement(S.Icon,{iconName:x.getRTL()?r:n}))))),v.createElement(l.FocusZone,null,v.createElement("div",{className:x.css("ms-DatePicker-optionGrid",k.optionGrid),role:"grid"},u.shortMonths.map(function(e,t){var i,o=_.setMonth(c,t),r=d._isCurrentMonth(t,c.getFullYear(),h),n=c.getMonth()===t,a=p.getMonth()===t,s=p.getFullYear()===c.getFullYear(),l=(!b||_.compareDatePart(b,_.getMonthEnd(o))<1)&&(!y||_.compareDatePart(_.getMonthStart(o),y)<1);return v.createElement("button",{role:"gridcell",className:x.css("ms-DatePicker-monthOption",k.monthOption,(i={},i["ms-DatePicker-day--today "+k.monthIsCurrentMonth]=m&&r,i["ms-DatePicker-day--highlighted "+k.monthIsHighlighted]=(m||g)&&a&&s,i["ms-DatePicker-monthOption--disabled "+k.monthOptionIsDisabled]=!l,i)),disabled:!l,key:t,onClick:l?d._selectMonthCallbacks[t]:void 0,onKeyDown:l?d._onSelectMonthKeyDown(t):void 0,"aria-label":f.formatMonthYear(o,u),"aria-selected":r||n,"data-is-focusable":!!l||void 0,ref:n?"navigatedMonth":void 0},e)}))))};e.prototype.focus=function(){if(this.refs.navigatedMonth){this.refs.navigatedMonth.tabIndex=0;this.refs.navigatedMonth.focus()}};e.prototype._isCurrentMonth=function(e,t,i){return i.getFullYear()===t&&i.getMonth()===e};return e}(x.BaseComponent);t.CalendarMonth=r});define("office-ui-fabric-react/lib/components/Calendar/Calendar.types",["require","exports","../../utilities/dateValues/DateValues"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DayOfWeek=i.DayOfWeek;t.FirstWeekOfYear=i.FirstWeekOfYear;t.DateRangeType=i.DateRangeType});define("office-ui-fabric-react/lib/TextField",["require","exports","tslib","./components/TextField/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/TextField/index",["require","exports","tslib","./TextField","./MaskedTextField/MaskedTextField"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/TextField/TextField",["require","exports","../../Utilities","./TextField.base","./TextField.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextField=i.styled(o.TextFieldBase,r.getStyles,void 0,{scope:"TextField"})});define("office-ui-fabric-react/lib/components/TextField/TextField.base",["require","exports","tslib","react","../../Label","../../Icon","../../Utilities"],function(e,t,D,L,n,E,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=M.classNamesFunction(),i=function(t){D.__extends(e,t);function e(e){var r=t.call(this,e)||this;r._textElement=M.createRef();r._onRenderLabel=function(e){var t=e.label,i=e.required,o=r._classNames.subComponentStyles?r._classNames.subComponentStyles.label:void 0;return t?L.createElement(n.Label,{required:i,htmlFor:r._id,styles:o},e.label):null};r._onRenderDescription=function(e){return e.description?L.createElement("span",{className:r._classNames.description},e.description):null};r._warnDeprecations({iconClass:"iconProps",addonString:"prefix",onRenderAddon:"onRenderPrefix",onChanged:"onChange"});r._warnMutuallyExclusive({value:"defaultValue"});r._id=e.id||M.getId("TextField");r._descriptionId=M.getId("TextFieldDescription");void 0!==e.value?r._latestValue=e.value:void 0!==e.defaultValue?r._latestValue=e.defaultValue:r._latestValue="";r.state={value:r._latestValue,isFocused:!1,errorMessage:""};r._onInputChange=r._onInputChange.bind(r);r._onFocus=r._onFocus.bind(r);r._onBlur=r._onBlur.bind(r);r._delayedValidate=r._async.debounce(r._validate,r.props.deferredValidationTime);r._lastValidation=0;r._isDescriptionAvailable=!1;return r}Object.defineProperty(e.prototype,"value",{get:function(){return this.state.value},enumerable:!0,configurable:!0});e.prototype.componentDidMount=function(){this._isMounted=!0;this._adjustInputHeight();this.props.validateOnLoad&&this._validate(this.state.value)};e.prototype.componentWillReceiveProps=function(e){var t=this,i=this.props.onBeforeChange;if(e.value!==this.state.value&&(void 0!==e.value||void 0!==this.props.value)){i&&i(e.value);this._id=e.id||this._id;this._latestValue=e.value;this.setState({value:e.value||"",errorMessage:""},function(){t._adjustInputHeight()});var o=e.validateOnFocusIn,r=e.validateOnFocusOut;o||r||this._delayedValidate(e.value)}};e.prototype.componentWillUnmount=function(){this._isMounted=!1};e.prototype.render=function(){var e=this.props,t=e.borderless,i=e.className,o=e.description,r=e.disabled,n=e.iconClass,a=e.iconProps,s=e.label,l=e.multiline,d=e.required,c=e.underlined,p=e.addonString,u=e.prefix,h=e.resizable,m=e.suffix,g=e.theme,f=e.styles,b=e.onRenderAddon,y=void 0===b?this._onRenderAddon:b,v=e.onRenderPrefix,x=void 0===v?this._onRenderPrefix:v,_=e.onRenderSuffix,S=void 0===_?this._onRenderSuffix:_,k=e.onRenderLabel,P=void 0===k?this._onRenderLabel:k,w=e.onRenderDescription,C=void 0===w?this._onRenderDescription:w,I=this.state.isFocused,T=this._errorMessage;this._classNames=A(f,{theme:g,className:i,disabled:r,focused:I,required:d,multiline:l,hasLabel:!!s,hasErrorMessage:!!T,borderless:t,resizable:h,hasIcon:!!a,underlined:c,iconClass:n});this._isDescriptionAvailable=Boolean(this.props.onRenderDescription||o||T);return L.createElement("div",{className:this._classNames.root},L.createElement("div",{className:this._classNames.wrapper},P(this.props,this._onRenderLabel),L.createElement("div",{className:this._classNames.fieldGroup},(void 0!==p||this.props.onRenderAddon)&&L.createElement("div",{className:this._classNames.prefix},y(this.props,this._onRenderAddon)),(void 0!==u||this.props.onRenderPrefix)&&L.createElement("div",{className:this._classNames.prefix},x(this.props,this._onRenderPrefix)),l?this._renderTextArea():this._renderInput(),(n||a)&&L.createElement(E.Icon,D.__assign({className:this._classNames.icon},a)),(void 0!==m||this.props.onRenderSuffix)&&L.createElement("div",{className:this._classNames.suffix},S(this.props,this._onRenderSuffix)))),this._isDescriptionAvailable&&L.createElement("span",{id:this._descriptionId},C(this.props,this._onRenderDescription),T&&L.createElement("div",{"aria-live":"assertive"},L.createElement(M.DelayedRender,null,L.createElement("p",{className:this._classNames.errorMessage},L.createElement("span",{"data-automation-id":"error-message"},T))))))};e.prototype.focus=function(){this._textElement.current&&this._textElement.current.focus()};e.prototype.select=function(){this._textElement.current&&this._textElement.current.select()};e.prototype.setSelectionStart=function(e){this._textElement.current&&(this._textElement.current.selectionStart=e)};e.prototype.setSelectionEnd=function(e){this._textElement.current&&(this._textElement.current.selectionEnd=e)};Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._textElement.current?this._textElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._textElement.current?this._textElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});e.prototype.setSelectionRange=function(e,t){this._textElement.current&&this._textElement.current.setSelectionRange(e,t)};e.prototype._onFocus=function(e){this.props.onFocus&&this.props.onFocus(e);this.setState({isFocused:!0});this.props.validateOnFocusIn&&this._validate(this.state.value)};e.prototype._onBlur=function(e){this.props.onBlur&&this.props.onBlur(e);this.setState({isFocused:!1});this.props.validateOnFocusOut&&this._validate(this.state.value)};e.prototype._onRenderAddon=function(e){var t=e.addonString;return L.createElement("span",{style:{paddingBottom:"1px"}},t)};e.prototype._onRenderPrefix=function(e){var t=e.prefix;return L.createElement("span",{style:{paddingBottom:"1px"}},t)};e.prototype._onRenderSuffix=function(e){var t=e.suffix;return L.createElement("span",{style:{paddingBottom:"1px"}},t)};Object.defineProperty(e.prototype,"_errorMessage",{get:function(){var e=this.state.errorMessage;!e&&this.props.errorMessage&&(e=this.props.errorMessage);return e},enumerable:!0,configurable:!0});e.prototype._renderTextArea=function(){var e=M.getNativeProps(this.props,M.textAreaProperties,["defaultValue"]);return L.createElement("textarea",D.__assign({id:this._id},e,{ref:this._textElement,value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this.state.errorMessage,"aria-label":this.props.ariaLabel,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))};e.prototype._renderInput=function(){var e=M.getNativeProps(this.props,M.inputProperties,["defaultValue"]);return L.createElement("input",D.__assign({type:"text",id:this._id},e,{ref:this._textElement,value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-label":this.props.ariaLabel,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this.state.errorMessage,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))};e.prototype._onInputChange=function(e){var t=this;e.persist();var i=e.target.value;if(i!==this._latestValue){this._latestValue=i;this.setState({value:i},function(){t._adjustInputHeight();t.props.onChange&&t.props.onChange(e,i);t.props.onChanged&&t.props.onChanged(i)});var o=this.props,r=o.validateOnFocusIn,n=o.validateOnFocusOut;r||n||this._delayedValidate(i);(0,this.props.onBeforeChange)(i)}};e.prototype._validate=function(t){var i=this,e=this.props,o=e.validateOnFocusIn,r=e.validateOnFocusOut;if(this._latestValidateValue!==t||o||r){this._latestValidateValue=t;var n=(0,this.props.onGetErrorMessage)(t||"");if(void 0!==n)if("string"==typeof n){this.setState({errorMessage:n});this._notifyAfterValidate(t,n)}else{var a=++this._lastValidation;n.then(function(e){i._isMounted&&a===i._lastValidation&&i.setState({errorMessage:e});i._notifyAfterValidate(t,e)})}else this._notifyAfterValidate(t,"")}};e.prototype._notifyAfterValidate=function(e,t){this._isMounted&&e===this.state.value&&this.props.onNotifyValidationResult&&this.props.onNotifyValidationResult(t,e)};e.prototype._adjustInputHeight=function(){if(this._textElement.current&&this.props.autoAdjustHeight&&this.props.multiline){var e=this._textElement.current;e.style.height="";var t=e.scrollHeight+2;e.style.height=t+"px"}};e.defaultProps={multiline:!1,resizable:!0,autoAdjustHeight:!1,underlined:!1,borderless:!1,onChange:function(){},onBeforeChange:function(){},onNotifyValidationResult:function(){},onGetErrorMessage:function(){},deferredValidationTime:200,errorMessage:"",validateOnFocusIn:!1,validateOnFocusOut:!1,validateOnLoad:!0};return e}(M.BaseComponent);t.TextFieldBase=i});define("office-ui-fabric-react/lib/Label",["require","exports","tslib","./components/Label/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Label/index",["require","exports","tslib","./Label.base","./Label"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Label/Label.base",["require","exports","tslib","react","../../Utilities","../../Utilities"],function(e,t,c,p,u,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.classNamesFunction(),o=function(e){c.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.as,i=void 0===t?"label":t,o=e.children,r=e.className,n=e.disabled,a=e.styles,s=e.required,l=e.theme,d=h(a,{className:r,disabled:n,required:s,theme:l});return p.createElement(i,c.__assign({},u.getNativeProps(this.props,u.divProperties),{className:d.root}),o)};return t}(u.BaseComponent);t.LabelBase=o});define("office-ui-fabric-react/lib/components/Label/Label",["require","exports","../../Utilities","./Label.base","./Label.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Label=i.styled(o.LabelBase,r.getStyles,void 0,{scope:"Label"})});define("office-ui-fabric-react/lib/components/Label/Label.styles",["require","exports","../../Styling"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i=e.theme,o=e.className,r=e.disabled,n=e.required;return{root:["ms-Label",{color:i.semanticColors.bodyText,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},r&&{color:i.semanticColors.disabledBodyText,selectors:(t={},t[a.HighContrastSelector]={color:"GrayText"},t)},n&&{selectors:{"::after":{content:"' *'",color:i.semanticColors.errorText,paddingRight:12}}},o]}}});define("office-ui-fabric-react/lib/components/TextField/TextField.styles",["require","exports","../../Styling"],function(e,t,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T={root:"ms-TextField",description:"ms-TextField-description",errorMessage:"ms-TextField-errorMessage",field:"ms-TextField-field",fieldGroup:"ms-TextField-fieldGroup",prefix:"ms-TextField-prefix",suffix:"ms-TextField-suffix",wrapper:"ms-TextField-wrapper",multiline:"ms-TextField--multiline",borderless:"ms-TextField--borderless",underlined:"ms-TextField--underlined",unresizable:"ms-TextField--unresizable",required:"is-required",disabled:"is-disabled",active:"is-active"};t.getStyles=function(e){var t,i,o,r,n,a,s,l,d,c=e.theme,p=e.className,u=e.disabled,h=e.focused,m=e.required,g=e.multiline,f=e.hasLabel,b=e.borderless,y=e.underlined,v=e.hasIcon,x=e.resizable,_=e.hasErrorMessage,S=e.iconClass,k=c.semanticColors,P=c.palette,w=I.getGlobalClassNames(T,c),C={background:P.neutralLighter,color:P.neutralSecondary,display:"flex",alignItems:"center",padding:"0 10px",lineHeight:1,whiteSpace:"nowrap"};return{root:[w.root,m&&w.required,u&&w.disabled,h&&w.active,g&&w.multiline,b&&w.borderless,y&&w.underlined,I.normalize,{position:"relative",selectors:(r={},r[I.HighContrastSelector]={borderWidth:2},r)},h&&{borderColor:k.inputFocusBorderAlt},y&&!h&&{border:"0px solid "+k.inputBorder},y&&!u&&!h&&{selectors:{":hover":{borderColor:k.inputBorderHovered}}},p],wrapper:[w.wrapper,y&&{display:"flex",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:"inherit",width:"100%"},_&&{borderColor:k.errorText,selectors:{"&:focus, &:hover":{borderColor:k.errorText}}},_&&y&&!u&&{borderBottom:"1px solid "+k.errorText,selectors:{":focus":{borderBottom:"1px solid "+k.errorText},":hover":{borderBottom:"1px solid "+k.errorText}}},y&&u&&{borderBottomColor:k.disabledBackground},y&&!u&&{selectors:{":hover":{selectors:(n={},n[I.HighContrastSelector]={borderColor:"Highlight"},n)}}},y&&h&&{selectors:(a={},a[I.HighContrastSelector]={borderColor:"Highlight"},a)}],fieldGroup:[w.fieldGroup,I.normalize,{border:"1px solid "+k.inputBorder,background:k.bodyBackground,height:32,display:"flex",flexDirection:"row",alignItems:"stretch",position:"relative",selectors:{":-ms-clear":{display:"none"},":hover":{selectors:(s={},s[I.HighContrastSelector]={borderColor:"Highlight"},s)},"::placeholder":{color:k.inputPlaceholderText,opacity:1},":-ms-input-placeholder":{color:k.inputPlaceholderText,opacity:1}}},g&&{minHeight:"60px",height:"auto",display:"flex"},b&&{borderColor:"transparent",borderWidth:0},!h&&!u&&{selectors:{":hover":{borderColor:k.inputBorderHovered}}},h&&{borderColor:k.inputFocusBorderAlt,selectors:(l={},l[I.HighContrastSelector]={borderWidth:2,borderColor:"Highlight"},l)},u&&{backgroundColor:k.disabledBackground,borderColor:k.disabledBackground},y&&{flex:"1 1 0px",borderWidth:0,textAlign:"left"},y&&u&&{backgroundColor:"transparent"},_&&{borderColor:k.errorText,selectors:{"&:focus, &:hover":{borderColor:k.errorText}}},_&&h&&{borderColor:k.errorText},!f&&m&&{selectors:{":after":{content:"'*'",color:k.errorText,position:"absolute",top:-5,right:-10}}}],field:[w.field,I.normalize,{fontSize:I.FontSizes.medium,borderRadius:0,border:"none",background:"none",backgroundColor:"transparent",color:k.bodyText,padding:"0 12px",width:"100%",minWidth:0,textOverflow:"ellipsis",outline:0,selectors:{"&:active, &:focus, &:hover":{outline:0},"::placeholder":{color:k.bodySubtext}}},g&&!x&&[w.unresizable,{resize:"none"}],g&&{lineHeight:17,flexGrow:1,paddingTop:6,overflow:"auto",width:"100%"},v&&{paddingRight:24},g&&v&&{paddingRight:40},u&&{backgroundColor:"transparent",borderColor:"transparent"},y&&{textAlign:"left"},y&&u&&{backgroundColor:"transparent",color:k.disabledText},h&&{selectors:(d={},d[I.HighContrastSelector]={padding:"0 11px 0 11px"},d)}],icon:[g&&{paddingRight:24,paddingBottom:8,alignItems:"flex-end"},{pointerEvents:"none",position:"absolute",bottom:5,right:8,top:"auto",fontSize:16,lineHeight:18},S],description:[w.description,{color:k.bodySubtext,fontSize:I.FontSizes.xSmall}],errorMessage:[w.errorMessage,I.AnimationClassNames.slideDownIn20,c.fonts.small,{color:k.errorText,margin:0,paddingTop:5,display:"flex",alignItems:"center"}],prefix:[w.prefix,C],suffix:[w.suffix,C],subComponentStyles:{label:(t=e,i=t.underlined,o=t.disabled,function(){return{root:[i&&o&&{color:t.theme.palette.neutralTertiary},i&&{fontSize:I.FontSizes.medium,marginRight:8,paddingLeft:12,paddingRight:0,lineHeight:"22px",height:32}]}})}}}});define("office-ui-fabric-react/lib/components/TextField/MaskedTextField/MaskedTextField",["require","exports","tslib","react","../TextField","../../../Utilities","./inputMask"],function(e,t,o,r,n,a,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_MASK_CHAR="_";var f;!function(e){e[e.default=0]="default";e[e.backspace=1]="backspace";e[e.delete=2]="delete";e[e.textPasted=3]="textPasted"}(f||(f={}));var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._skipComponentRefResolution=!0;t._maskCharData=g.parseMask(e.mask,e.maskFormat);e.value&&t.setValue(e.value);t._isFocused=!1;t._moveCursorOnMouseUp=!1;t.state={displayValue:g.getMaskDisplay(e.mask,t._maskCharData,e.maskChar)};return t}e.prototype.componentWillReceiveProps=function(e){if(e.mask!==this.props.mask){this._maskCharData=g.parseMask(e.mask,e.maskFormat);this.state={displayValue:g.getMaskDisplay(e.mask,this._maskCharData,e.maskChar)}}};e.prototype.componentDidUpdate=function(){this.state.maskCursorPosition&&this._textField.setSelectionRange(this.state.maskCursorPosition,this.state.maskCursorPosition)};e.prototype.render=function(){return r.createElement(n.TextField,o.__assign({},this.props,{onFocus:this._onFocus,onBlur:this._onBlur,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onChange:this._onInputChange,onBeforeChange:this._onBeforeChange,onKeyDown:this._onKeyDown,onPaste:this._onPaste,value:this.state.displayValue,componentRef:this._resolveRef("_textField")}))};Object.defineProperty(e.prototype,"value",{get:function(){for(var e="",t=0;t<this._maskCharData.length;t++){if(!this._maskCharData[t].value)return;e+=this._maskCharData[t].value}return e},enumerable:!0,configurable:!0});e.prototype.setValue=function(e){for(var t=0,i=0;t<e.length&&i<this._maskCharData.length;){var o=e[t];if(this._maskCharData[i].format.test(o)){this._maskCharData[i].value=o;i++}t++}};e.prototype.focus=function(){this._textField&&this._textField.focus()};e.prototype.select=function(){this._textField&&this._textField.select()};e.prototype.setSelectionStart=function(e){this._textField&&this._textField.setSelectionStart(e)};e.prototype.setSelectionEnd=function(e){this._textField&&this._textField.setSelectionEnd(e)};e.prototype.setSelectionRange=function(e,t){this._textField&&this._textField.setSelectionRange(e,t)};Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._textField&&null!==this._textField.selectionStart?this._textField.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._textField&&this._textField.selectionEnd?this._textField.selectionEnd:-1},enumerable:!0,configurable:!0});e.prototype._onFocus=function(e){this.props.onFocus&&this.props.onFocus(e);this._isFocused=!0;for(var t=0;t<this._maskCharData.length;t++)if(!this._maskCharData[t].value){this.setState({maskCursorPosition:this._maskCharData[t].displayIndex});break}};e.prototype._onBlur=function(e){this.props.onBlur&&this.props.onBlur(e);this._isFocused=!1;this._moveCursorOnMouseUp=!0};e.prototype._onMouseDown=function(e){this.props.onMouseDown&&this.props.onMouseDown(e);this._isFocused||(this._moveCursorOnMouseUp=!0)};e.prototype._onMouseUp=function(e){this.props.onMouseUp&&this.props.onMouseUp(e);if(this._moveCursorOnMouseUp){this._moveCursorOnMouseUp=!1;for(var t=0;t<this._maskCharData.length;t++)if(!this._maskCharData[t].value){this.setState({maskCursorPosition:this._maskCharData[t].displayIndex});break}}};e.prototype._onBeforeChange=function(e){this.props.onBeforeChange&&this.props.onBeforeChange(e);null===this._changeSelectionData&&(this._changeSelectionData={changeType:f.default,selectionStart:null!==this._textField.selectionStart?this._textField.selectionStart:-1,selectionEnd:null!==this._textField.selectionEnd?this._textField.selectionEnd:-1})};e.prototype._onInputChange=function(e,t){this.props.onChange&&this.props.onChange(e,t);this.props.onChanged&&this.props.onChanged(t);if(this._changeSelectionData){var i=this.state.displayValue,o=0,r=this._changeSelectionData,n=r.changeType,a=r.selectionStart,s=r.selectionEnd;if(n===f.textPasted){var l=s-a,d=t.length+l-i.length,c=a,p=t.substr(c,d);l&&(this._maskCharData=g.clearRange(this._maskCharData,a,l));o=g.insertString(this._maskCharData,c,p)}else if(n===f.delete||n===f.backspace){var u=n===f.delete;if(d=s-a){this._maskCharData=g.clearRange(this._maskCharData,a,d);o=g.getRightFormatIndex(this._maskCharData,a)}else if(u){this._maskCharData=g.clearNext(this._maskCharData,a);o=g.getRightFormatIndex(this._maskCharData,a)}else{this._maskCharData=g.clearPrev(this._maskCharData,a);o=g.getLeftFormatIndex(this._maskCharData,a)}}else if(t.length>i.length){c=s-(d=t.length-i.length);var h=t.substr(c,d);o=g.insertString(this._maskCharData,c,h)}else if(t.length<=i.length){d=1;var m=i.length+d-t.length;c=s-d,h=t.substr(c,d);this._maskCharData=g.clearRange(this._maskCharData,c,m);o=g.insertString(this._maskCharData,c,h)}this._changeSelectionData=null;this.setState({displayValue:g.getMaskDisplay(this.props.mask,this._maskCharData,this.props.maskChar),maskCursorPosition:o})}};e.prototype._onKeyDown=function(e){this.props.onKeyDown&&this.props.onKeyDown(e);this._changeSelectionData=null;if(this._textField.value){var t=e.keyCode,i=e.ctrlKey,o=e.metaKey;if(i||o)return;if(8===t||46===t){var r=e.target.selectionStart,n=e.target.selectionEnd;if(!(8===t&&n&&0<n||46===t&&null!==r&&r<this._textField.value.length))return;this._changeSelectionData={changeType:8===t?f.backspace:f.delete,selectionStart:null!==r?r:-1,selectionEnd:null!==n?n:-1}}}};e.prototype._onPaste=function(e){this.props.onPaste&&this.props.onPaste(e);var t=e.target.selectionStart,i=e.target.selectionEnd;this._changeSelectionData={changeType:f.textPasted,selectionStart:null!==t?t:-1,selectionEnd:null!==i?i:-1}};e.defaultProps={maskChar:t.DEFAULT_MASK_CHAR,maskFormat:g.DEFAULT_MASK_FORMAT_CHARS};o.__decorate([a.autobind],e.prototype,"_onFocus",null);o.__decorate([a.autobind],e.prototype,"_onBlur",null);o.__decorate([a.autobind],e.prototype,"_onMouseDown",null);o.__decorate([a.autobind],e.prototype,"_onMouseUp",null);o.__decorate([a.autobind],e.prototype,"_onBeforeChange",null);o.__decorate([a.autobind],e.prototype,"_onInputChange",null);o.__decorate([a.autobind],e.prototype,"_onKeyDown",null);o.__decorate([a.autobind],e.prototype,"_onPaste",null);return e}(a.BaseComponent);t.MaskedTextField=i});define("office-ui-fabric-react/lib/components/TextField/MaskedTextField/inputMask",["require","exports"],function(e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.DEFAULT_MASK_FORMAT_CHARS={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};s.parseMask=function(e,t){void 0===t&&(t=s.DEFAULT_MASK_FORMAT_CHARS);if(!e)return[];for(var i=[],o=0,r=0;r+o<e.length;r++){var n=e.charAt(r+o);if("\\"===n)o++;else{var a=t[n];a&&i.push({displayIndex:r,format:a})}}return i};s.getMaskDisplay=function(e,t,i){var o=e;if(!o)return"";o=o.replace(/\\/g,"");var r=0;0<t.length&&(r=t[0].displayIndex-1);for(var n=0,a=t;n<a.length;n++){var s=a[n],l=" ";if(s.value){l=s.value;s.displayIndex>r&&(r=s.displayIndex)}else i&&(l=i);o=o.slice(0,s.displayIndex)+l+o.slice(s.displayIndex+1)}i||(o=o.slice(0,r+1));return o};s.getRightFormatIndex=function(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t)return e[i].displayIndex;return e[e.length-1].displayIndex};s.getLeftFormatIndex=function(e,t){for(var i=e.length-1;0<=i;i--)if(e[i].displayIndex<t)return e[i].displayIndex;return e[0].displayIndex};s.clearRange=function(e,t,i){for(var o=0;o<e.length;o++)if(e[o].displayIndex>=t){if(e[o].displayIndex>=t+i)break;e[o].value=void 0}return e};s.clearNext=function(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t){e[i].value=void 0;break}return e};s.clearPrev=function(e,t){for(var i=e.length-1;0<=i;i--)if(e[i].displayIndex<t){e[i].value=void 0;break}return e};s.insertString=function(e,t,i){for(var o=0,r=0,n=0;n<e.length&&o<i.length;n++)if(e[n].displayIndex>=t){r=e[n].displayIndex;for(;o<i.length;){if(e[n].format.test(i.charAt(o))){e[n].value=i.charAt(o++);n+1<e.length?r=e[n+1].displayIndex:r++;break}o++}}return r}});define("office-ui-fabric-react/lib/FocusTrapZone",["require","exports","tslib","./components/FocusTrapZone/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/FocusTrapZone/index",["require","exports","tslib","./FocusTrapZone"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/FocusTrapZone/FocusTrapZone",["require","exports","tslib","react","../../Utilities"],function(e,t,r,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){r.__extends(o,e);function o(){var o=null!==e&&e.apply(this,arguments)||this;o._root=l.createRef();o._onFocusCapture=function(e){o.props.onFocusCapture&&o.props.onFocusCapture(e);e.target!==e.currentTarget&&(o._previouslyFocusedElementInTrapZone=e.target)};o._onKeyboardHandler=function(e){o.props.onKeyDown&&o.props.onKeyDown(e);if(!e.isDefaultPrevented()&&9===e.which&&o._root.current){var t=l.getFirstTabbable(o._root.current,o._root.current.firstChild,!0),i=l.getLastTabbable(o._root.current,o._root.current.lastChild,!0);if(e.shiftKey&&t===e.target){l.focusAsync(i);e.preventDefault();e.stopPropagation()}else if(!e.shiftKey&&i===e.target){l.focusAsync(t);e.preventDefault();e.stopPropagation()}}};return o}o.prototype.componentWillMount=function(){o._focusStack.push(this)};o.prototype.componentDidMount=function(){var e=this.props,t=e.isClickableOutsideFocusTrap,i=void 0!==t&&t,o=e.forceFocusInsideTrap,r=void 0===o||o,n=e.elementToFocusOnDismiss,a=e.disableFirstFocus,s=void 0!==a&&a;this._previouslyFocusedElementOutsideTrapZone=n||document.activeElement;l.elementContains(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||s||this.focus();r&&this._events.on(window,"focus",this._forceFocusInTrap,!0);i||this._events.on(window,"click",this._forceClickInTrap,!0)};o.prototype.componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t)};o.prototype.componentWillUnmount=function(){var t=this,e=this.props.ignoreExternalFocusing;this._events.dispose();o._focusStack=o._focusStack.filter(function(e){return t!==e});var i=document.activeElement;e||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!l.elementContains(this._root.value,i)&&i!==document.body||l.focusAsync(this._previouslyFocusedElementOutsideTrapZone)};o.prototype.render=function(){var e=this.props,t=e.className,i=e.ariaLabelledBy,o=l.getNativeProps(this.props,l.divProperties);return n.createElement("div",r.__assign({},o,{className:t,ref:this._root,"aria-labelledby":i,onKeyDown:this._onKeyboardHandler,onFocusCapture:this._onFocusCapture}),this.props.children)};o.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,i=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&l.elementContains(this._root.value,this._previouslyFocusedElementInTrapZone))l.focusAsync(this._previouslyFocusedElementInTrapZone);else{var o,r="string"==typeof i?i:i&&i();this._root.current&&(o=r?this._root.current.querySelector("."+r):l.getNextElement(this._root.current,this._root.current.firstChild,!0,!1,!1,!0));o&&l.focusAsync(o)}};o.prototype._forceFocusInTrap=function(e){if(o._focusStack.length&&this===o._focusStack[o._focusStack.length-1]){var t=document.activeElement;if(!l.elementContains(this._root.current,t)){this.focus();e.preventDefault();e.stopPropagation()}}};o.prototype._forceClickInTrap=function(e){if(o._focusStack.length&&this===o._focusStack[o._focusStack.length-1]){var t=e.target;if(t&&!l.elementContains(this._root.current,t)){this.focus();e.preventDefault();e.stopPropagation()}}};o._focusStack=[];return o}(l.BaseComponent);t.FocusTrapZone=i});define("office-ui-fabric-react/lib/components/DatePicker/DatePicker.styles",["require","exports","../../Styling"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "};t.styles=function(e){var t=e.className,i=e.theme,o=e.disabled,r=e.label,n=e.isDatePickerShown,a=i.palette,s=d.getGlobalClassNames(c,i),l={color:a.neutralSecondary,fontSize:d.FontSizes.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"9px"};return{root:[s.root,n&&"is-open",d.normalize,t],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}}],callout:[s.callout],icon:[l,!r&&[s.withoutLabel,{top:"7px"}],r&&[s.withLabel,{bottom:"5px"}],!o&&[s.disabled,{pointerEvents:"initial",cursor:"pointer"}]]}}});define("office-ui-fabric-react/lib/Tooltip",["require","exports","tslib","./components/Tooltip/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Tooltip/index",["require","exports","tslib","./Tooltip","./Tooltip.base","./Tooltip.types","./TooltipHost","./TooltipHost.types","../../common/DirectionalHint"],function(e,t,i,o,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("office-ui-fabric-react/lib/components/Tooltip/Tooltip",["require","exports","../../Utilities","./Tooltip.base","./Tooltip.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Tooltip=i.styled(o.TooltipBase,r.getStyles,void 0,{scope:"Tooltip"})});define("office-ui-fabric-react/lib/components/Tooltip/Tooltip.base",["require","exports","tslib","react","../../Utilities","./Tooltip.types","../../Callout"],function(e,t,h,m,g,i,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=g.classNamesFunction(),o=function(e){h.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderContent=function(e){return m.createElement("p",{className:t._classNames.subText},e.content)};return t}t.prototype.render=function(){var e=this.props,t=e.className,i=e.calloutProps,o=e.delay,r=e.directionalHint,n=e.directionalHintForRTL,a=e.styles,s=e.id,l=e.maxWidth,d=e.onRenderContent,c=void 0===d?this._onRenderContent:d,p=e.targetElement,u=e.theme;this._classNames=b(a,{theme:u,className:t||i&&i.className,delay:o,maxWidth:l});return m.createElement(f.Callout,h.__assign({target:p,directionalHint:r,directionalHintForRTL:n},i,g.getNativeProps(this.props,g.divProperties),{className:this._classNames.root}),m.createElement("div",{className:this._classNames.content,id:s,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},c(this.props,this._onRenderContent)))};t.defaultProps={directionalHint:1,delay:i.TooltipDelay.medium,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}};return t}(g.BaseComponent);t.TooltipBase=o});define("office-ui-fabric-react/lib/components/Tooltip/Tooltip.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.zero=0]="zero";e[e.medium=1]="medium";e[e.long=2]="long"}(t.TooltipDelay||(t.TooltipDelay={}))});define("office-ui-fabric-react/lib/components/Tooltip/Tooltip.styles",["require","exports","./Tooltip.types","../../Styling"],function(e,t,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.className,i=e.delay,o=e.maxWidth,r=e.theme,n=r.palette,a=r.fonts;return{root:["ms-Tooltip",l.AnimationClassNames.fadeIn200,{background:n.white,padding:"8px",animationDelay:"300ms",maxWidth:o},i===s.TooltipDelay.zero&&{animationDelay:"0s"},i===s.TooltipDelay.long&&{animationDelay:"500ms"},t],content:["ms-Tooltip-content",a.small,n.neutralPrimary,{wordWrap:"break-word",overflowWrap:"break-word"}],subText:["ms-Tooltip-subtext",{margin:0}]}}});define("office-ui-fabric-react/lib/components/Tooltip/TooltipHost",["require","exports","tslib","react","../../Utilities","./TooltipHost.types","./Tooltip","./Tooltip.types","./TooltipHost.scss"],function(e,t,b,y,v,i,x,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=r,n=function(t){b.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._tooltipHost=v.createRef();i._closingTimer=-1;i._onTooltipMouseEnter=function(e){if(void 0!==i.props.overflowMode){var t=i._getTargetElement();if(t&&!v.hasOverflow(t))return}i._toggleTooltip(!0);i._clearDismissTimer()};i._onTooltipMouseLeave=function(e){if(i.props.closeDelay){i._clearDismissTimer();i._closingTimer=i._async.setTimeout(function(){i._toggleTooltip(!1)},i.props.closeDelay)}else i._toggleTooltip(!1)};i._clearDismissTimer=function(){i._async.clearTimeout(i._closingTimer)};i._hideTooltip=function(){i._toggleTooltip(!1)};i.state={isTooltipVisible:!1};return i}e.prototype.render=function(){var e=this.props,t=e.calloutProps,i=e.children,o=e.content,r=e.delay,n=e.directionalHint,a=e.directionalHintForRTL,s=e.hostClassName,l=e.id,d=e.setAriaDescribedBy,c=void 0===d||d,p=e.tooltipProps,u=this.state.isTooltipVisible,h=l||v.getId("tooltip"),m=!!(o||p&&p.onRenderContent&&p.onRenderContent()),g=u&&m,f=c&&u&&m?h:void 0;return y.createElement("div",b.__assign({className:v.css("ms-TooltipHost",_.host,s),ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,"aria-describedby":f}),i,g&&y.createElement(x.Tooltip,b.__assign({id:h,delay:r,content:o,targetElement:this._getTargetElement(),directionalHint:n,directionalHintForRTL:a,calloutProps:v.assign({},t,{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},v.getNativeProps(this.props,v.divProperties),p)))};e.prototype._getTargetElement=function(){if(this._tooltipHost.current){var e=this.props.overflowMode;if(void 0!==e)switch(e){case i.TooltipOverflowMode.Parent:return this._tooltipHost.current.parentElement;case i.TooltipOverflowMode.Self:return this._tooltipHost.current}return this._tooltipHost.current}};e.prototype._toggleTooltip=function(e){var t=this;this.state.isTooltipVisible!==e&&this.setState({isTooltipVisible:e},function(){return t.props.onTooltipToggle&&t.props.onTooltipToggle(t.state.isTooltipVisible)})};e.defaultProps={delay:o.TooltipDelay.medium};return e}(v.BaseComponent);t.TooltipHost=n});define("office-ui-fabric-react/lib/components/Tooltip/TooltipHost.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Parent=0]="Parent";e[e.Self=1]="Self"}(t.TooltipOverflowMode||(t.TooltipOverflowMode={}))});define("office-ui-fabric-react/lib/components/Tooltip/TooltipHost.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".host_a3f87333{display:inline}\n"}]);t.host="host_a3f87333"});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:100%;height:32px}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content{width:100%;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";cursor:pointer}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;width:100%}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-DatePicker i{display:none}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField-field,.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .od-ExpirationDate-expiresLabel{height:28px;padding:0;-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}[dir=ltr] .od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField-field{padding-left:7px}[dir=rtl] .od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField-field{padding-right:7px}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField-fieldGroup{background:0 0}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-TextField-errorMessage{display:none}.od-ExpirationDatePicker .od-ExpirationDatePicker-Content .ms-Icon{font-size:20px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker .od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}[dir=ltr] .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:8px}[dir=rtl] .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:8px}.od-ExpirationDatePicker .od-ExpirationDatePicker-info{display:-ms-flexbox;display:flex}[dir=ltr] .od-ExpirationDatePicker .od-ExpirationDatePicker-info{margin-left:auto}[dir=rtl] .od-ExpirationDatePicker .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker .od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px}[dir=ltr] .od-ExpirationDatePicker .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker .od-ExpirationDatePicker-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0}[dir=ltr] .od-ExpirationDatePicker .od-ExpirationDatePicker-delete{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker .od-ExpirationDatePicker-delete{margin-right:10px}.od-ExpirationDatePicker .od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordField/PasswordField",["require","exports","tslib","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","../../Share.resx","react","./PasswordField.scss","../../PermissionsList/ShareLink/ShareLink.scss"],function(e,t,o,i,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){o.__extends(e,n);function e(e,t){var i=n.call(this,e)||this,o="",r=!1;if(i.props.detailsPane){o="************";r=!0}i.state={currentPassword:o,disablePasswordField:!1,displayRemovePasswordButton:r,displayNotificationText:!1};i._renderRemovePasswordButton=i._renderRemovePasswordButton.bind(i);i._renderShareReminder=i._renderShareReminder.bind(i);i._onFocusPasswordField=i._onFocusPasswordField.bind(i);i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i);i._onBlurPasswordField=i._onBlurPasswordField.bind(i);i._onUpdatePassword=i._onUpdatePassword.bind(i);i._onDeletePassword=i._onDeletePassword.bind(i);return i}e.prototype.render=function(){return s.createElement("div",{className:"od-PasswordField"},s.createElement("div",{className:"od-PasswordField-label"},s.createElement(r.Icon,{iconName:"Lock"})),s.createElement("div",{className:"od-ShareLink-passwordFieldContent"},s.createElement(i.TextField,{ref:"passwordField",type:"password",autoComplete:"off",disabled:this.state.disablePasswordField,placeholder:a.default.setPasswordFieldText,value:this.state.currentPassword,onChanged:this._onUpdatePassword,onFocus:this._onFocusPasswordFieldDetails,onBlur:this._onBlurPasswordField,borderless:!0}),this._renderRemovePasswordButton()))};e.prototype._renderRemovePasswordButton=function(){return this.state.displayRemovePasswordButton?s.createElement("button",{className:"od-PasswordField-delete",onClick:this._onDeletePassword,"aria-label":a.default.removePassword},s.createElement(r.Icon,{iconName:"Cancel"})):void 0};e.prototype._renderShareReminder=function(){return this.state.displayNotificationText,s.createElement("div",{className:"od-PasswordField-shareReminder"},"")};e.prototype._onFocusPasswordField=function(){this.setState(o.__assign({},this.state,{displayNotificationText:!0}))};e.prototype._onFocusPasswordFieldDetails=function(){this.setState(o.__assign({},this.state,{currentPassword:""}))};e.prototype._onBlurPasswordField=function(){this.setState(o.__assign({},this.state,{displayNotificationText:!1}))};e.prototype._onUpdatePassword=function(e){var t=this,i=0<e.length;this.setState(o.__assign({},this.state,{currentPassword:e,displayRemovePasswordButton:i}),function(){t.props.onPasswordChange(e)})};e.prototype._onDeletePassword=function(){var e=this;this.setState(o.__assign({},this.state,{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1}),function(){e.props.onPasswordChange("")})};return e}(s.Component);t.PasswordField=n});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordField/PasswordField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:32px;width:100%;display:-ms-flexbox;display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{width:100%;display:-ms-flexbox;display:flex;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input:-ms-input-placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-TextField{display:inline-block;padding:2px;height:28px;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:0 0}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:28px;min-width:0;width:200px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-PasswordField .ms-Icon{font-size:20px;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-PasswordField-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0}[dir=ltr] .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-PasswordField-delete{margin-right:auto}.od-PasswordField-label{display:inline-block;margin-top:7px}[dir=ltr] .od-PasswordField-label{margin-right:8px}[dir=rtl] .od-PasswordField-label{margin-left:8px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.od-PasswordField-shareReminder{display:inline-block;margin-top:8px;font-size:12px}[dir=ltr] .od-PasswordField-shareReminder{padding-left:22px}[dir=rtl] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-passwordField{display:-ms-flexbox;display:flex}.od-PermissionsSettings-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0}.ms-Fabric .od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSettings-delete{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSettings-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSettings-delete:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-PermissionsSettings-delete:focus:after{border-color:#37006e}}[dir=ltr] .od-PermissionsSettings-delete{margin-left:auto}[dir=rtl] .od-PermissionsSettings-delete{margin-right:auto}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ShareLink.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink .od-ShareLink-main{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";min-width:54px;margin:0;padding:0}[dir=ltr] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-left:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}[dir=rtl] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-right:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;min-width:50px;height:50px}[dir=ltr] .od-ShareLink-icon{margin-right:10px}[dir=rtl] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon i{left:50%}[dir=rtl] .od-ShareLink-icon i{right:50%}html[dir=ltr] .od-ShareLink-icon i{transform:translate(-50%,-50%)}html[dir=rtl] .od-ShareLink-icon i{transform:translate(50%,-50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:17px;border-style:solid;border-width:1px;border-radius:50%;box-sizing:border-box;width:32px;min-width:32px;height:32px}[dir=ltr] .od-ShareLink-icon2{margin-right:10px}[dir=rtl] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon2 i{left:50%}[dir=rtl] .od-ShareLink-icon2 i{right:50%}html[dir=ltr] .od-ShareLink-icon2 i{transform:translate(-50%,-50%)}html[dir=rtl] .od-ShareLink-icon2 i{transform:translate(50%,-50%)}.od-ShareLink-icon2.icon-Globe{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";background-color:RGBA("},{theme:"green",defaultValue:"#107c10"},{rawString:", .06);border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareLink-icon2.icon-Chat{color:#6264a7;border-color:#6264a7;background-color:RGBA(#6264a7,.06);border-color:#6264a7}.od-ShareLink-icon2.icon-Work{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background-color:RGBA("},{theme:"blue",defaultValue:"#0078d4"},{rawString:", .06);border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-ShareLink-icon2.icon-PeopleAdd{color:"},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:";background-color:RGBA("},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:", .06);border-color:"},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:"}.od-ShareLink-details{-ms-flex:1;flex:1}.od-ShareLink-actionButton{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-ShareLink-description{padding-top:8px;font-size:12px}[dir=ltr] .od-ShareLink-description{padding-left:42px}[dir=rtl] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir=ltr] .od-ShareLink-description.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink-description.flightOff{padding-right:60px}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink--inviteesHolder{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center}[dir=ltr] .od-ShareLink--inviteesHolder{padding-left:42px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-right:42px}[dir=ltr] .od-ShareLink--inviteesHolder{padding-right:38px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-left:38px}[dir=ltr] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:100%}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:12px;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:12px}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:'';background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:block;height:7px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink-personaItem{padding:18px 0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:15px;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:11px;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font:-apple-system-caption1}.od-ShareLink-personaItem .ms-Button-icon{font-size:12px}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ChangePermission/ChangePermission",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../../../RoleSelector/RoleSelector","../../../Share.resx","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip"],function(e,t,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={selectedKey:i._getSelectedKey(e)};return i}e.prototype.render=function(){var e=this.props,t=e.selectedPermissions.audience;return r.createElement(a.RoleSelector,{disabled:4!==t,role:this.state.selectedKey,onRoleChange:this._onAllowRoleChange,clientId:e.clientId,appmap:e.appmap},4!==t&&this._renderInfoIcon())};e.prototype._onAllowRoleChange=function(e){var t=this;this.setState({selectedKey:e},function(){t.props.onRoleChange(e)})};e.prototype._getSelectedKey=function(e){return e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?2:1};e.prototype._renderInfoIcon=function(){return r.createElement(d.TooltipHost,{content:s.default.createNewLinkTooltip,directionalHint:0,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"320px"}},r.createElement(l.Icon,{iconName:"Info"}))};i.__decorate([n.autobind],e.prototype,"_onAllowRoleChange",null);return e}(r.Component);t.ChangePermission=o});define("@ms/odsp-shared-sharing/lib/components/RoleSelector/RoleSelector",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Dropdown","office-ui-fabric-react/lib/Icon","../../interfaces/SharingInterfaces","../../utilities/ShareHelper","../Share.resx","@ms/odsp-utilities/lib/features/Features","./RoleSelector.scss"],function(e,t,o,r,n,a,s,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={ODB:772},i=function(i){o.__extends(e,i);function e(e,t){return i.call(this,e)||this}e.prototype.render=function(){var e=d.getRoleIconNameAndTitle(this.props.role),t=p.default.isFeatureEnabled(u),i=this.props.clientId===l.ClientId.word||this.props.appmap&&"ms-word"===this.props.appmap,o=t&&i?[{key:1,text:c.default.canViewRole,data:c.default.canViewRoleSubText},{key:2,text:c.default.canEditRole,data:c.default.canEditRoleSubText},{key:6,text:c.default.canReviewRole,data:c.default.canReviewRoleSubText}]:[{key:1,text:c.default.canViewRole,data:c.default.canViewRoleSubText},{key:2,text:c.default.canEditRole,data:c.default.canEditRoleSubText}];return r.createElement("div",{className:"od-RoleSelector-wrapper"},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:e.name,title:e.title}),r.createElement(a.Dropdown,{className:"od-RoleSelector-rolesDropdown",disabled:!!this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChanged:this._onAllowRoleChange,defaultSelectedKey:this.props.role,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},options:o}),this.props.children)};e.prototype._onRenderTitle=function(e){return r.createElement("span",null,e[0].text)};e.prototype._onRenderOption=function(e){var t=d.getRoleIconNameAndTitle(e.key);return r.createElement("div",{className:"od-RoleSelector-roleDropdownOption"},r.createElement("div",{className:"od-RoleSelector-roleDropdownOptionMainContent"},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:t.name,title:t.title}),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionText"}," ",e.text," ")),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionSubtext"},e.data))};e.prototype._onAllowRoleChange=function(e){this.props.onRoleChange(e.key)};o.__decorate([n.autobind],e.prototype,"_onRenderTitle",null);o.__decorate([n.autobind],e.prototype,"_onRenderOption",null);o.__decorate([n.autobind],e.prototype,"_onAllowRoleChange",null);return e}(r.Component);t.RoleSelector=i});define("office-ui-fabric-react/lib/Dropdown",["require","exports","tslib","./components/Dropdown/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Dropdown/index",["require","exports","tslib","./Dropdown","./Dropdown.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Dropdown/Dropdown",["require","exports","../../Utilities","./Dropdown.base","./Dropdown.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Dropdown=i.styled(o.DropdownBase,r.getStyles)});define("office-ui-fabric-react/lib/components/Dropdown/Dropdown.base",["require","exports","tslib","react","../../Button","../../Callout","../../Checkbox","../../FocusZone","../../Icon","../../KeytipData","../../Label","../../Panel","../../Utilities","../../utilities/decorators/withResponsiveMode","../../utilities/selectableOption/SelectableOption.types","./Dropdown.types","./utilities/DropdownSizePosCache"],function(e,t,A,F,d,c,p,a,n,R,O,u,N,h,s,l,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var B=N.classNamesFunction(),i=function(r){A.__extends(e,r);function e(e){var t,l=r.call(this,e)||this;l._host=N.createRef();l._focusZone=N.createRef();l._dropDown=N.createRef();l._scrollIdleDelay=250;l._sizePosCache=new m.DropdownSizePosCache;l._onRenderTitle=function(e){var t=l.props.multiSelectDelimiter,i=void 0===t?", ":t,o=e.map(function(e){return e.text}).join(i);return F.createElement("span",null,o)};l._onRenderPlaceHolder=function(e){return e.placeHolder?F.createElement("span",null,e.placeHolder):null};l._onRenderContainer=function(e){var t=l.props,i=t.onRenderList,o=void 0===i?l._onRenderList:i,r=t.responsiveMode,n=t.calloutProps,a=t.panelProps,s=t.dropdownWidth;return r<=h.ResponsiveMode.medium?F.createElement(u.Panel,A.__assign({className:l._classNames.panel,isOpen:!0,isLightDismiss:!0,onDismissed:l._onDismiss,hasCloseButton:!1},a),o(e,l._onRenderList)):F.createElement(c.Callout,A.__assign({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:4},n,{className:l._classNames.callout,target:l._dropDown.current,onDismiss:l._onDismiss,onScroll:l._onScroll,onPositioned:l._onPositioned,calloutWidth:s||(l._dropDown.current?l._dropDown.current.clientWidth:0)}),o(e,l._onRenderList))};l._onRenderCaretDown=function(e){return F.createElement(n.Icon,{className:l._classNames.caretDown,iconName:"ChevronDown"})};l._onRenderList=function(e){var t=l.props.onRenderItem,i=void 0===t?l._onRenderItem:t,o=l._id,r=l.state.selectedIndices,n=void 0===r?[]:r;return F.createElement("div",{className:l._classNames.dropdownItemsWrapper,onKeyDown:l._onZoneKeyDown,onKeyUp:l._onZoneKeyUp,ref:l._host,tabIndex:0},F.createElement(a.FocusZone,{ref:l._focusZone,direction:a.FocusZoneDirection.vertical,defaultActiveElement:void 0!==n[0]?"#"+o+"-list"+n[0]:void 0,id:o+"-list",className:l._classNames.dropdownItems,"aria-labelledby":o+"-label",role:"listbox"},l.props.options.map(function(e,t){return i(A.__assign({},e,{index:t}),l._onRenderItem)})))};l._onRenderItem=function(e){switch(e.itemType){case s.SelectableOptionMenuItemType.Divider:return l._renderSeparator(e);case s.SelectableOptionMenuItemType.Header:return l._renderHeader(e);default:return l._renderOption(e)}};l._renderOption=function(e){var t=l.props.onRenderOption,i=void 0===t?l._onRenderOption:t,o=l.state.selectedIndices,r=void 0===o?[]:o,n=l._id,a=!(void 0===e.index||!r)&&-1<r.indexOf(e.index),s=a&&!0===e.disabled?l._classNames.dropdownItemSelectedAndDisabled:a?l._classNames.dropdownItemSelected:!0===e.disabled?l._classNames.dropdownItemDisabled:l._classNames.dropdownItem;return l.props.multiSelect?F.createElement(p.Checkbox,{id:n+"-list"+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,onChange:l._onItemClick(e),inputProps:{onMouseEnter:l._onItemMouseEnter.bind(l,e),onMouseLeave:l._onMouseItemLeave.bind(l,e),onMouseMove:l._onItemMouseMove.bind(l,e)},label:e.text,title:e.title?e.title:e.text,onRenderLabel:l._onRenderLabel.bind(l,e),className:s,role:"option","aria-selected":a?"true":"false",checked:a}):F.createElement(d.CommandButton,{id:n+"-list"+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:s,onClick:l._onItemClick(e),onMouseEnter:l._onItemMouseEnter.bind(l,e),onMouseLeave:l._onMouseItemLeave.bind(l,e),onMouseMove:l._onItemMouseMove.bind(l,e),role:"option","aria-selected":a?"true":"false",ariaLabel:e.ariaLabel||e.text,title:e.title?e.title:e.text},i(e,l._onRenderOption))};l._onRenderOption=function(e){return F.createElement("span",{className:l._classNames.dropdownOptionText},e.text)};l._onRenderLabel=function(e){var t=l.props.onRenderOption;return(void 0===t?l._onRenderOption:t)(e,l._onRenderOption)};l._onPositioned=function(){l._focusZone.current&&l._async.requestAnimationFrame(function(){return l._focusZone.current.focus()})};l._onItemClick=function(e){return function(){if(!e.disabled){l.setSelectedIndex(e.index);l.props.multiSelect||l.setState({isOpen:!1})}}};l._onScroll=function(){if(l._isScrollIdle||void 0===l._scrollIdleTimeoutId)l._isScrollIdle=!1;else{l._async.clearTimeout(l._scrollIdleTimeoutId);l._scrollIdleTimeoutId=void 0}l._scrollIdleTimeoutId=l._async.setTimeout(function(){l._isScrollIdle=!0},l._scrollIdleDelay)};l._onMouseItemLeave=function(e,t){if(l._isScrollIdle&&l._host.current)if(l._host.current.setActive)try{l._host.current.setActive()}catch(e){}else l._host.current.focus()};l._onDismiss=function(){l.setState({isOpen:!1});l._dropDown.current&&l._dropDown.current.focus()};l._onDropdownBlur=function(e){l.setState({hasFocus:!1});l.state.isOpen||l.props.onBlur&&l.props.onBlur(e)};l._onDropdownKeyDown=function(e){l._processingExpandCollapseKeyOnly=l._isExpandCollapseKey(e);if(l.props.onKeyDown){l.props.onKeyDown(e);if(e.defaultPrevented)return}var t,i=l.state.selectedIndices.length?l.state.selectedIndices[0]:-1,o=e.altKey||e.metaKey,r=l.state.isOpen;switch(e.which){case 13:l.setState({isOpen:!r});break;case 27:if(!r)return;l.setState({isOpen:!1});break;case 38:if(o){if(r){l.setState({isOpen:!1});break}return}l.props.multiSelect?l.setState({isOpen:!0}):l._isDisabled()||(t=l._moveIndex(-1,i-1,i));break;case 40:if(o){e.stopPropagation();e.preventDefault()}o&&!r||l.props.multiSelect?l.setState({isOpen:!0}):l._isDisabled()||(t=l._moveIndex(1,i+1,i));break;case 36:l.props.multiSelect||(t=l._moveIndex(1,0,i));break;case 35:l.props.multiSelect||(t=l._moveIndex(-1,l.props.options.length-1,i));break;case 32:break;default:return}if(t!==i){e.stopPropagation();e.preventDefault()}};l._onDropdownKeyUp=function(e){var t=l._processingExpandCollapseKeyOnly&&l._isExpandCollapseKey(e);l._processingExpandCollapseKeyOnly=!1;var i=l.state.isOpen;if(l.props.onKeyUp){l.props.onKeyUp(e);if(e.preventDefault)return}switch(e.which){case 32:l.setState({isOpen:!i});break;default:t&&i&&l.setState({isOpen:!1});return}e.stopPropagation();e.preventDefault()};l._onZoneKeyDown=function(e){var t;l._processingExpandCollapseKeyOnly=l._isExpandCollapseKey(e);var i=e.altKey||e.metaKey;switch(e.which){case 38:i?l.setState({isOpen:!1}):l._host.current&&(t=N.getLastFocusable(l._host.current,l._host.current.lastChild,!0));break;case 36:case 35:case 33:case 34:break;case 40:!i&&l._host.current&&(t=N.getFirstFocusable(l._host.current,l._host.current.firstChild,!0));break;case 27:l.setState({isOpen:!1});break;case 9:l.setState({isOpen:!1});return;default:return}t&&t.focus();e.stopPropagation();e.preventDefault()};l._onZoneKeyUp=function(e){var t=l._processingExpandCollapseKeyOnly&&l._isExpandCollapseKey(e);l._processingExpandCollapseKeyOnly=!1;if(t&&l.state.isOpen){l.setState({isOpen:!1});e.preventDefault()}};l._onDropdownClick=function(e){if(l.props.onClick){l.props.onClick(e);if(e.preventDefault)return}var t=l.state.isOpen;l._isDisabled()||l.setState({isOpen:!t})};l._onFocus=function(e){var t=l.state,i=t.isOpen,o=t.selectedIndices,r=l.props.multiSelect,n=l._isDisabled();i||0!==o.length||r||n||l._moveIndex(1,0,-1);l.setState({hasFocus:!0})};l._isDisabled=function(){var e=l.props.disabled,t=l.props.isDisabled;void 0!==t&&(e=t);return e};l._warnDeprecations({isDisabled:"disabled"});l._warnMutuallyExclusive({defaultSelectedKey:"selectedKey",defaultSelectedKeys:"selectedKeys",selectedKeys:"selectedKey",multiSelect:"defaultSelectedKey",selectedKey:"multiSelect"});l._id=e.id||N.getId("Dropdown");l._isScrollIdle=!0;l._processingExpandCollapseKeyOnly=!1;if(l.props.multiSelect){var i=void 0!==e.defaultSelectedKeys?e.defaultSelectedKeys:e.selectedKeys;t=l._getSelectedIndexes(e.options,i)}else{var o=void 0!==e.defaultSelectedKey?e.defaultSelectedKey:e.selectedKey;t=l._getSelectedIndexes(e.options,o);l._sizePosCache.updateOptions(e.options)}l.state={isOpen:!1,selectedIndices:t,hasFocus:!1};return l}e.prototype.componentWillReceiveProps=function(e){var t=this.props.multiSelect?"selectedKeys":"selectedKey";void 0===e[t]||e[t]===this.props[t]&&e.options===this.props.options||this.setState({selectedIndices:this._getSelectedIndexes(e.options,e[t])});e.options===this.props.options||e.multiSelect||this._sizePosCache.updateOptions(e.options)};e.prototype.componentDidUpdate=function(e,t){if(!0===t.isOpen&&!1===this.state.isOpen){this._dropDown.current&&this._dropDown.current.focus();this.props.onDismiss&&this.props.onDismiss()}};e.prototype.render=function(){var t=this,i=this._id,e=this.props,o=e.className,r=e.label,n=e.options,a=e.ariaLabel,s=e.required,l=e.errorMessage,d=e.multiSelect,c=e.keytipProps,p=e.styles,u=e.theme,h=e.panelProps,m=e.calloutProps,g=e.onRenderTitle,f=void 0===g?this._onRenderTitle:g,b=e.onRenderContainer,y=void 0===b?this._onRenderContainer:b,v=e.onRenderPlaceHolder,x=void 0===v?this._onRenderPlaceHolder:v,_=e.onRenderCaretDown,S=void 0===_?this._onRenderCaretDown:_,k=this.state,P=k.isOpen,w=k.selectedIndices,C=k.hasFocus,I=this._getAllSelectedOptions(n,w),T=N.getNativeProps(this.props,N.divProperties),D=this._isDisabled(),L=i+"-option",E=d?{role:void 0,ariaActiveDescendant:void 0,childRole:void 0,ariaSetSize:void 0,ariaPosInSet:void 0,ariaSelected:void 0}:{role:"listbox",ariaActiveDescendant:P&&1===w.length&&0<=w[0]?this._id+"-list"+w[0]:L,childRole:"option",ariaSetSize:this._sizePosCache.optionSetSize,ariaPosInSet:this._sizePosCache.positionInSet(w[0]),ariaSelected:void 0!==w[0]||void 0};this._classNames=B(p,{theme:u,className:o,hasError:Boolean(l&&0<l.length),isOpen:P,required:s,disabled:D,isRenderingPlaceholder:!I.length,panelClassName:h?h.className:void 0,calloutClassName:m?m.className:void 0});var M=this._classNames.subComponentStyles?this._classNames.subComponentStyles.label:void 0;return F.createElement("div",{className:this._classNames.root},r&&F.createElement(O.Label,{className:this._classNames.label,id:i+"-label",htmlFor:i,required:s,styles:M},r),F.createElement(R.KeytipData,{keytipProps:c,disabled:D},function(e){return F.createElement("div",A.__assign({},e,{"data-is-focusable":!D,ref:t._dropDown,id:i,tabIndex:D?-1:0,"aria-expanded":P?"true":"false",role:E.role,"aria-label":a,"aria-labelledby":i+"-label","aria-describedby":N.mergeAriaAttributeValues(L,e["aria-describedby"]),"aria-activedescendant":E.ariaActiveDescendant,"aria-disabled":D,"aria-owns":P?i+"-list":void 0},T,{className:t._classNames.dropdown,onBlur:t._onDropdownBlur,onKeyDown:t._onDropdownKeyDown,onKeyUp:t._onDropdownKeyUp,onClick:t._onDropdownClick,onFocus:t._onFocus}),F.createElement("span",{id:L,className:t._classNames.title,"aria-atomic":!0,role:E.childRole,"aria-live":!C||D||d||P?"off":"assertive","aria-label":I.length?I[0].text:t.props.placeHolder,"aria-setsize":E.ariaSetSize,"aria-posinset":E.ariaPosInSet,"aria-selected":E.ariaSelected},I.length?f(I,t._onRenderTitle):x(t.props,t._onRenderPlaceHolder)),F.createElement("span",{className:t._classNames.caretDownWrapper},S(t.props,t._onRenderCaretDown)))}),P&&y(this.props,this._onRenderContainer),l&&0<l.length&&F.createElement("div",{className:this._classNames.errorMessage},l))};e.prototype.focus=function(e){if(this._dropDown.current&&-1!==this._dropDown.current.tabIndex){this._dropDown.current.focus();e&&this.setState({isOpen:!0})}};e.prototype.setSelectedIndex=function(e){var t=this.props,i=t.onChanged,o=t.options,r=t.selectedKey,n=t.selectedKeys,a=t.multiSelect,s=this.state.selectedIndices,l=void 0===s?[]:s,d=!!l&&-1<l.indexOf(e);e=Math.max(0,Math.min(o.length-1,e));if(a||e!==l[0]){if(a||void 0!==r){if(a&&void 0===n){var c=l?this._copyArray(l):[];if(d){var p=c.indexOf(e);-1<p&&c.splice(p,1)}else c.push(e);this.setState({selectedIndices:c})}}else this.setState({selectedIndices:[e]});if(i){i(a?A.__assign({},o[e],{selected:!d}):o[e],e)}}};e.prototype._copyArray=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i];t.push(r)}return t};e.prototype._moveIndex=function(e,t,i){var o=this.props.options;if(i===t||0===o.length)return i;t<0&&(t=0);t>=o.length&&(t=o.length-1);for(var r=0;o[t].itemType===l.DropdownMenuItemType.Header||o[t].itemType===l.DropdownMenuItemType.Divider||o[t].disabled;){if(r>=o.length)return i;t+e<0?t=o.length:t+e>=o.length&&(t=-1);t+=e;r++}this.setSelectedIndex(t);return t};e.prototype._renderSeparator=function(e){var t=e.index,i=e.key;return 0<t?F.createElement("div",{role:"separator",key:i,className:this._classNames.dropdownDivider}):null};e.prototype._renderHeader=function(e){var t=this.props.onRenderOption,i=void 0===t?this._onRenderOption:t,o=e.key;return F.createElement("div",{key:o,className:this._classNames.dropdownItemHeader},i(e,this._onRenderOption))};e.prototype._onItemMouseEnter=function(e,t){if(this._isScrollIdle){t.currentTarget.focus()}};e.prototype._onItemMouseMove=function(e,t){var i=t.currentTarget;this._isScrollIdle&&document.activeElement!==i&&i.focus()};e.prototype._getSelectedIndexes=function(e,t){if(void 0===t){if(this.props.multiSelect)return this._getAllSelectedIndices(e);var i=this._getSelectedIndex(e,null);return-1!==i?[i]:[]}if(!Array.isArray(t))return[this._getSelectedIndex(e,t)];for(var o=[],r=0,n=t;r<n.length;r++){var a=n[r];o.push(this._getSelectedIndex(e,a))}return o};e.prototype._getAllSelectedOptions=function(e,t){for(var i=[],o=0,r=t;o<r.length;o++){var n=e[r[o]];n&&i.push(n)}return i};e.prototype._getAllSelectedIndices=function(e){return e.map(function(e,t){return e.selected?t:-1}).filter(function(e){return-1!==e})};e.prototype._getSelectedIndex=function(e,t){return N.findIndex(e,function(e){return null!=t?e.key===t:!!e.isSelected||!!e.selected})};e.prototype._isExpandCollapseKey=function(e){return 18===e.which||"Meta"===e.key};e.defaultProps={options:[]};return e=A.__decorate([h.withResponsiveMode],e)}(N.BaseComponent);t.DropdownBase=i});define("office-ui-fabric-react/lib/Panel",["require","exports","tslib","./components/Panel/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Panel/index",["require","exports","tslib","./Panel","./Panel.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Panel/Panel",["require","exports","tslib","react","../../Utilities","../FocusTrapZone/index","./Panel.types","../Layer/Layer","../../Overlay","../../Popup","../../Button","../../Styling","./Panel.scss"],function(e,t,N,B,H,V,z,U,W,q,i,K,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var j=o,n=K.getTheme(),r=function(t){N.__extends(e,t);function e(e){var r=t.call(this,e)||this;r._panel=H.createRef();r._content=H.createRef();r.dismiss=function(){if(r.state.isOpen){r.setState({isOpen:!1,isAnimating:!0},function(){r._async.setTimeout(r._onTransitionComplete,200)});r.props.onDismiss&&r.props.onDismiss()}};r._onRenderNavigation=function(e){var t=e.closeButtonAriaLabel;return e.hasCloseButton?B.createElement("div",{className:H.css("ms-Panel-navigation",j.navigation)},B.createElement(i.IconButton,{styles:{root:{height:"auto",width:"44px",color:n.palette.neutralSecondary,fontSize:K.IconFontSizes.large},rootHovered:{color:n.palette.neutralPrimary}},className:H.css("ms-Panel-closeButton ms-PanelAction-close"),onClick:r._onPanelClick,ariaLabel:t,"data-is-visible":!0,iconProps:{iconName:"Cancel"}})):null};r._onRenderHeader=function(e,t,i){var o=e.headerText,r=e.headerClassName,n=void 0===r?"":r;return o?B.createElement("div",{className:H.css("ms-Panel-header",j.header)},B.createElement("p",{className:H.css("ms-Panel-headerText",j.headerText,n),id:i,role:"heading","aria-level":2},o)):null};r._onRenderBody=function(e){var t=H.css("ms-Panel-content",j.content,e.isFooterAtBottom&&j.contentGrow);return B.createElement("div",{ref:r._content,className:t,"data-is-scrollable":!0},e.children)};r._onRenderFooter=function(e){var t=r.state.isFooterSticky,i=r.props.onRenderFooterContent,o=void 0===i?null:i;return o?B.createElement("div",{className:H.css("ms-Panel-footer",j.footer,t&&j.footerIsSticky)},B.createElement("div",{className:H.css("ms-Panel-footerInner",j.footerInner)},o())):null};r._onPanelClick=function(){r.dismiss()};r._onTransitionComplete=function(){r.setState({isAnimating:!1});!r.state.isOpen&&r.props.onDismissed&&r.props.onDismissed()};r._warnDeprecations({ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"});r.state={isFooterSticky:!1,isOpen:!1,isAnimating:!1,id:H.getId("Panel")};return r}e.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition);this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"click",this._dismissOnOuterClick,!0);this.props.isOpen&&this.open()};e.prototype.componentDidUpdate=function(e){var t=this._shouldListenForOuterClick(this.props),i=this._shouldListenForOuterClick(e);t&&!i?this._events.on(document.body,"click",this._dismissOnOuterClick,!0):!t&&i&&this._events.off(document.body,"click",this._dismissOnOuterClick,!0)};e.prototype.componentWillReceiveProps=function(e){e.isOpen!==this.state.isOpen&&(e.isOpen?this.open():this.dismiss())};e.prototype.render=function(){var e,t=this.props,i=t.className,o=void 0===i?"":i,r=t.elementToFocusOnDismiss,n=t.firstFocusableSelector,a=t.focusTrapZoneProps,s=t.forceFocusInsideTrap,l=t.hasCloseButton,d=t.headerText,c=t.ignoreExternalFocusing,p=t.isBlocking,u=t.isLightDismiss,h=t.isHiddenOnDismiss,m=t.layerProps,g=t.type,f=t.customWidth,b=t.onLightDismissClick,y=void 0===b?this._onPanelClick:b,v=t.onRenderNavigation,x=void 0===v?this._onRenderNavigation:v,_=t.onRenderHeader,S=void 0===_?this._onRenderHeader:_,k=t.onRenderBody,P=void 0===k?this._onRenderBody:k,w=t.onRenderFooter,C=void 0===w?this._onRenderFooter:w,I=this.state,T=I.isOpen,D=I.isAnimating,L=I.id,E=g===z.PanelType.smallFixedNear,M=H.getRTL()?E:!E,A=d&&L+"-headerText",F=g===z.PanelType.custom?{width:f}:{},R=H.getNativeProps(this.props,H.divProperties);if(!T&&!D&&!h)return null;p&&T&&(e=B.createElement(W.Overlay,{className:H.css(j.overlay,T&&D&&K.AnimationClassNames.fadeIn200,!T&&D&&K.AnimationClassNames.fadeOut200),isDarkThemed:!1,onClick:u?y:void 0}));var O=S(this.props,this._onRenderHeader,A);return B.createElement(U.Layer,N.__assign({},m),B.createElement(q.Popup,{role:"dialog",ariaLabelledBy:O?A:void 0,onDismiss:this.dismiss,className:H.css(!T&&!D&&h&&j.hiddenPanel)},B.createElement("div",N.__assign({},R,{ref:this._panel,className:H.css("ms-Panel",j.root,o,T&&"is-open "+j.rootIsOpen,g===z.PanelType.smallFluid&&"ms-Panel--smFluid "+j.rootIsSmallFluid,g===z.PanelType.smallFixedNear&&"ms-Panel--smLeft "+j.rootIsSmallLeft,g===z.PanelType.smallFixedFar&&"ms-Panel--sm "+j.rootIsSmall,g===z.PanelType.medium&&"ms-Panel--md "+j.rootIsMedium,(g===z.PanelType.large||g===z.PanelType.largeFixed)&&"ms-Panel--lg "+j.rootIsLarge,g===z.PanelType.largeFixed&&"ms-Panel--fixed "+j.rootIsFixed,g===z.PanelType.extraLarge&&"ms-Panel--xl "+j.rootIsXLarge,g===z.PanelType.custom&&"ms-Panel--custom "+j.rootIsCustom,l&&"ms-Panel--hasCloseButton "+j.rootHasCloseButton,!T&&!D&&h&&j.hiddenPanel)}),e,B.createElement(V.FocusTrapZone,N.__assign({ignoreExternalFocusing:c,forceFocusInsideTrap:!(h&&!T)&&s,firstFocusableSelector:n},a,{className:H.css("ms-Panel-main",j.main,T&&D&&!M&&K.AnimationClassNames.slideRightIn40,T&&D&&M&&K.AnimationClassNames.slideLeftIn40,!T&&D&&!M&&K.AnimationClassNames.slideLeftOut40,!T&&D&&M&&K.AnimationClassNames.slideRightOut40,a?a.className:void 0),style:F,elementToFocusOnDismiss:r,isClickableOutsideFocusTrap:!(a&&!a.isClickableOutsideFocusTrap)}),B.createElement("div",{className:H.css("ms-Panel-commands"),"data-is-visible":!0},x(this.props,this._onRenderNavigation)),B.createElement("div",{className:H.css("ms-Panel-contentInner",j.contentInner)},O,P(this.props,this._onRenderBody),C(this.props,this._onRenderFooter))))))};e.prototype.open=function(){var e=this;this.state.isOpen||this.setState({isOpen:!0,isAnimating:!0},function(){e._async.setTimeout(e._onTransitionComplete,200)})};e.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen};e.prototype._updateFooterPosition=function(){var e=this._content.current;if(e){var t=e.clientHeight,i=e.scrollHeight;this.setState({isFooterSticky:t<i})}};e.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;if(this.state.isOpen&&t&&!H.elementContains(t,e.target))if(this.props.onOuterClick){this.props.onOuterClick();e.preventDefault()}else this.dismiss()};e.defaultProps={isHiddenOnDismiss:!1,isOpen:!1,isBlocking:!0,hasCloseButton:!0,type:z.PanelType.smallFixedFar};return e}(H.BaseComponent);t.Panel=r});define("office-ui-fabric-react/lib/components/Panel/Panel.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.smallFluid=0]="smallFluid";e[e.smallFixedFar=1]="smallFixedFar";e[e.smallFixedNear=2]="smallFixedNear";e[e.medium=3]="medium";e[e.large=4]="large";e[e.largeFixed=5]="largeFixed";e[e.extraLarge=6]="extraLarge";e[e.custom=7]="custom"}(t.PanelType||(t.PanelType={}))});define("office-ui-fabric-react/lib/Overlay",["require","exports","tslib","./components/Overlay/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Overlay/index",["require","exports","tslib","./Overlay","./Overlay.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Overlay/Overlay",["require","exports","../../Utilities","./Overlay.base","./Overlay.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Overlay=i.styled(o.OverlayBase,r.getStyles,void 0,{scope:"Overlay"})});define("office-ui-fabric-react/lib/components/Overlay/Overlay.base",["require","exports","tslib","react","../../Utilities"],function(e,t,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=d.classNamesFunction(),i=function(e){s.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){d.disableBodyScroll()};t.prototype.componentWillUnmount=function(){d.enableBodyScroll()};t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,i=e.className,o=e.theme,r=e.styles,n=d.getNativeProps(this.props,d.divProperties),a=c(r,{theme:o,className:i,isDark:t});return l.createElement("div",s.__assign({},n,{className:a.root}))};return t}(d.BaseComponent);t.OverlayBase=i});define("office-ui-fabric-react/lib/components/Overlay/Overlay.styles",["require","exports","../../Styling"],function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};t.getStyles=function(e){var t,i=e.className,o=e.theme,r=e.isNone,n=e.isDark,a=o.palette,s=l.getGlobalClassNames(d,o);return{root:[s.root,{backgroundColor:a.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[l.HighContrastSelector]={border:"1px solid WindowText"},t)},r&&{visibility:"hidden"},n&&[s.rootDark,{backgroundColor:a.blackTranslucent40}],i]}}});define("office-ui-fabric-react/lib/components/Panel/Panel.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".hiddenPanel_dafe1696{visibility:hidden}.root_dafe1696{pointer-events:none;position:absolute;top:0;left:0;right:0;bottom:0}.root_dafe1696 .overlay_dafe1696{pointer-events:none;opacity:1;cursor:pointer;-webkit-transition:opacity .367s cubic-bezier(0.1, 0.9, 0.2, 1);transition:opacity .367s cubic-bezier(0.1, 0.9, 0.2, 1)}.main_dafe1696{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;width:100%;bottom:0;top:0;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}[dir='ltr'] .main_dafe1696{right:0}[dir='rtl'] .main_dafe1696{left:0}@media (min-width: 480px){.main_dafe1696{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";pointer-events:auto;width:340px}[dir='ltr'] .main_dafe1696{-webkit-box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='rtl'] .main_dafe1696{-webkit-box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='ltr'] .main_dafe1696{left:auto}[dir='rtl'] .main_dafe1696{right:auto}}.root_dafe1696.rootIsSmall_dafe1696 .main_dafe1696{width:272px}@media (min-width: 480px){.root_dafe1696.rootIsSmall_dafe1696 .main_dafe1696{width:340px}}.root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{width:272px}[dir='ltr'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{right:auto}[dir='rtl'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{left:auto}[dir='ltr'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{left:0}[dir='rtl'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{right:0}[dir='ltr'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{-webkit-box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='rtl'] .root_dafe1696.rootIsSmallLeft_dafe1696 .main_dafe1696{-webkit-box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2)}.root_dafe1696.rootIsSmallFluid_dafe1696 .main_dafe1696{width:100%}@media (min-width: 768px){.root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696,.root_dafe1696.rootIsLarge_dafe1696 .main_dafe1696,.root_dafe1696.rootIsXLarge_dafe1696 .main_dafe1696,.root_dafe1696.rootIsCustom_dafe1696 .main_dafe1696{width:auto}[dir='ltr'] .root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696,[dir='ltr'] .root_dafe1696.rootIsLarge_dafe1696 .main_dafe1696,[dir='ltr'] .root_dafe1696.rootIsXLarge_dafe1696 .main_dafe1696,[dir='ltr'] .root_dafe1696.rootIsCustom_dafe1696 .main_dafe1696{left:48px}[dir='rtl'] .root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696,[dir='rtl'] .root_dafe1696.rootIsLarge_dafe1696 .main_dafe1696,[dir='rtl'] .root_dafe1696.rootIsXLarge_dafe1696 .main_dafe1696,[dir='rtl'] .root_dafe1696.rootIsCustom_dafe1696 .main_dafe1696{right:48px}}@media (min-width: 1024px){.root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696{width:643px}[dir='ltr'] .root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696{left:auto}[dir='rtl'] .root_dafe1696.rootIsMedium_dafe1696 .main_dafe1696{right:auto}}@media (min-width: 1366px){[dir='ltr'] .root_dafe1696.rootIsLarge_dafe1696 .main_dafe1696{left:428px}[dir='rtl'] .root_dafe1696.rootIsLarge_dafe1696 .main_dafe1696{right:428px}}@media (min-width: 1366px){.root_dafe1696.rootIsLarge_dafe1696.rootIsFixed_dafe1696 .main_dafe1696{width:940px}[dir='ltr'] .root_dafe1696.rootIsLarge_dafe1696.rootIsFixed_dafe1696 .main_dafe1696{left:auto}[dir='rtl'] .root_dafe1696.rootIsLarge_dafe1696.rootIsFixed_dafe1696 .main_dafe1696{right:auto}}@media (min-width: 1366px){[dir='ltr'] .root_dafe1696.rootIsXLarge_dafe1696 .main_dafe1696{left:176px}[dir='rtl'] .root_dafe1696.rootIsXLarge_dafe1696 .main_dafe1696{right:176px}}@media (min-width: 1024px){[dir='ltr'] .root_dafe1696.rootIsCustom_dafe1696 .main_dafe1696{left:auto}[dir='rtl'] .root_dafe1696.rootIsCustom_dafe1696 .main_dafe1696{right:auto}}.root_dafe1696.rootIsOpen_dafe1696 .main_dafe1696{pointer-events:auto}.root_dafe1696.rootIsOpen_dafe1696 .overlay_dafe1696{cursor:pointer;pointer-events:auto}@media screen and (-ms-high-contrast: active){.root_dafe1696.rootIsOpen_dafe1696 .overlay_dafe1696{opacity:0}}.navigation_dafe1696{padding:0 5px;height:44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.contentInner_dafe1696{position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-overflow-scrolling:touch;-webkit-transform:translateZ(0);transform:translateZ(0)}.rootHasCloseButton_dafe1696 .contentInner_dafe1696{top:44px}.header_dafe1696,.content_dafe1696,.footerInner_dafe1696{padding-left:16px;padding-right:16px}@media (min-width: 768px){.header_dafe1696,.content_dafe1696,.footerInner_dafe1696{padding-left:32px;padding-right:32px}}@media (min-width: 1366px){.header_dafe1696,.content_dafe1696,.footerInner_dafe1696{padding-left:40px;padding-right:40px}}.header_dafe1696{margin:14px 0;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}@media (min-width: 1024px){.header_dafe1696{margin-top:30px}}.content_dafe1696{margin-bottom:0;padding-bottom:20px;overflow-y:auto}.contentGrow_dafe1696{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.footer_dafe1696{-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0;border-top:1px solid transparent;-webkit-transition:border .367s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:border .367s cubic-bezier(0.1, 0.25, 0.75, 0.9)}.footerInner_dafe1696{padding-bottom:20px;padding-top:20px}.footerIsSticky_dafe1696{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.headerText_dafe1696{font-size:21px;font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";line-height:32px;margin:0}\n"}]);t.hiddenPanel="hiddenPanel_dafe1696";t.root="root_dafe1696";t.overlay="overlay_dafe1696";t.main="main_dafe1696";t.rootIsSmall="rootIsSmall_dafe1696";t.rootIsSmallLeft="rootIsSmallLeft_dafe1696";t.rootIsSmallFluid="rootIsSmallFluid_dafe1696";t.rootIsMedium="rootIsMedium_dafe1696";t.rootIsLarge="rootIsLarge_dafe1696";t.rootIsXLarge="rootIsXLarge_dafe1696";t.rootIsCustom="rootIsCustom_dafe1696";t.rootIsFixed="rootIsFixed_dafe1696";t.rootIsOpen="rootIsOpen_dafe1696";t.navigation="navigation_dafe1696";t.contentInner="contentInner_dafe1696";t.rootHasCloseButton="rootHasCloseButton_dafe1696";t.header="header_dafe1696";t.content="content_dafe1696";t.footerInner="footerInner_dafe1696";t.contentGrow="contentGrow_dafe1696";t.footer="footer_dafe1696";t.footerIsSticky="footerIsSticky_dafe1696";t.headerText="headerText_dafe1696"});define("office-ui-fabric-react/lib/utilities/selectableOption/SelectableOption.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Normal=0]="Normal";e[e.Divider=1]="Divider";e[e.Header=2]="Header"}(t.SelectableOptionMenuItemType||(t.SelectableOptionMenuItemType={}))});define("office-ui-fabric-react/lib/components/Dropdown/Dropdown.types",["require","exports","../../utilities/selectableOption/SelectableOption.types"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropdownMenuItemType=i.SelectableOptionMenuItemType});define("office-ui-fabric-react/lib/components/Dropdown/utilities/DropdownSizePosCache",["require","exports","../Dropdown.types"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._size=0}e.prototype.updateOptions=function(e){for(var t=[],i=0,o=0;o<e.length;o++)e[o].itemType===r.DropdownMenuItemType.Divider||e[o].itemType===r.DropdownMenuItemType.Header?t.push(o):i++;this._size=i;this._displayOnlyOptionsCache=t};Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!0,configurable:!0});e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._displayOnlyOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index "+e+" is not a selectable element.");return e-t+1}};return e}();t.DropdownSizePosCache=i});define("office-ui-fabric-react/lib/components/Dropdown/Dropdown.styles",["require","exports","tslib","../../Styling"],function(e,t,P,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o,C={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},I={"@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: black-on-white)":{MsHighContrastAdjust:"none"}},T={selectors:P.__assign((i={},i[w.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"Highlight"},i),I)},D={selectors:(o={},o[w.HighContrastSelector]={borderColor:"Highlight"},o)};t.getStyles=function(e){var t=e.theme,i=e.hasError,o=e.className,r=e.isOpen,n=e.disabled,a=e.required,s=e.isRenderingPlaceholder,l=e.panelClassName,d=e.calloutClassName;if(!t)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var c,p,u,h,m,g=w.getGlobalClassNames(C,t),f=t.palette,b=t.semanticColors,y={color:f.neutralDark},v={color:b.bodySubtext},x={borderColor:b.errorText},_=[g.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"block",padding:"4px 16px",width:"100%",minHeight:32,lineHeight:20,height:"auto",position:"relative",border:"1px solid transparent",wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left"}],S=_.concat([{backgroundColor:f.neutralQuaternaryAlt,color:f.black},T]),k=_.concat([{color:b.disabledText,cursor:"default"}]);return{root:g.root,label:g.label,dropdown:[g.dropdown,w.normalize,P.__assign({},t.fonts.medium,{color:f.neutralPrimary,position:"relative",outline:0,userSelect:"none",selectors:(c={},c["&:hover ."+g.title]=[!n&&y,{borderColor:f.neutralDark},D],c["&:focus ."+g.title]=[!n&&y,{borderColor:f.themePrimary},T],c["&:active ."+g.title]=[!n&&y,{borderColor:f.themeDark},D],c["&:hover ."+g.caretDown]=!n&&y,c["&:focus ."+g.caretDown]=[!n&&y,{selectors:P.__assign((p={},p[w.HighContrastSelector]={color:"HighlightText"},p),I)}],c["&:active ."+g.caretDown]=!n&&y,c["&:hover ."+g.titleIsPlaceHolder]=v,c["&:focus ."+g.titleIsPlaceHolder]=v,c["&:active ."+g.titleIsPlaceHolder]=v,c["&:hover ."+g.titleHasError]=x,c["&:active ."+g.titleHasError]=x,c["&:focus ."+g.titleHasError]=x,c)}),o,r&&"is-open",n&&"is-disabled",a&&"is-required"],title:[g.title,w.normalize,{backgroundColor:b.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:b.inputBorder,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 32px 0 12px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},s&&[g.titleIsPlaceHolder,{color:b.inputPlaceholderText}],i&&[g.titleHasError,x],n&&{backgroundColor:b.disabledBackground,border:"none",color:b.disabledText,cursor:"default",selectors:(u={},u[w.HighContrastSelector]={border:"1px solid GrayText",color:"GrayText"},u)}],caretDownWrapper:[g.caretDownWrapper,{position:"absolute",top:1,right:12,height:32,lineHeight:30}],caretDown:[g.caretDown,{color:f.neutralSecondary,fontSize:w.FontSizes.small,pointerEvents:"none"},n&&{color:b.disabledText,selectors:(h={},h[w.HighContrastSelector]={color:"GrayText"},h)}],errorMessage:P.__assign({color:b.errorText},t.fonts.small,{paddingTop:5}),callout:[g.callout,{boxShadow:"0 0 2px 0 rgba(0,0,0,0.2)",border:"1px solid "+f.neutralLight},d],panel:[g.panel,{selectors:{"& .ms-Panel-main":{boxShadow:"-30px 0px 30px -30px rgba(0,0,0,0.2)"},"& .ms-Panel-contentInner":{padding:"0 0 20px"}}},l],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[g.dropdownItems,{display:"block"}],dropdownItem:_.concat([{selectors:(m={},m[w.HighContrastSelector]={borderColor:"Window"},m["&:hover"]={color:"inherit"},m["&:focus"]={backgroundColor:b.listItemBackgroundHovered},m["&:active"]={backgroundColor:b.listHeaderBackgroundHovered,color:f.black},m)}]),dropdownItemSelected:S,dropdownItemDisabled:k,dropdownItemSelectedAndDisabled:[S,k,{backgroundColor:"transparent"}],dropdownDivider:[g.dropdownDivider,{height:1,backgroundColor:b.bodyDivider}],dropdownOptionText:[g.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:[g.dropdownItemHeader,P.__assign({},t.fonts.medium,{fontWeight:w.FontWeights.semibold,color:b.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:32,lineHeight:32,cursor:"default",padding:"0px 16px",userSelect:"none",textAlign:"left"})],subComponentStyles:{label:{root:{display:"inline-block",marginBottom:8}}}}}});define("@ms/odsp-shared-sharing/lib/components/RoleSelector/RoleSelector.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelector-wrapper{position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:100%}.od-RoleSelector-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-RoleSelector-wrapper .ms-TooltipHost{right:0}[dir=rtl] .od-RoleSelector-wrapper .ms-TooltipHost{left:0}.od-RoleSelector-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0}[dir=ltr] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir=rtl] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelector-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-RoleSelector-rolesDropdown .ms-Dropdown-title{border-top:none;border-left:none;border-right:none;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-RoleSelector-rolesDropdown.is-open,.od-RoleSelector-rolesDropdown:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-RoleSelector-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelector-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir=rtl] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelector-roleDropdownOption{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent .od-RoleSelector-roleDropdownOptionText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;line-height:1.3}[dir=ltr] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{padding-left:37px}[dir=rtl] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{padding-right:37px}[dir=ltr] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:left}[dir=rtl] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:right}.od-RoleSelector-settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-RoleSelector-settingIcon{padding-left:8px}[dir=rtl] .od-RoleSelector-settingIcon{padding-right:8px}[dir=ltr] .od-RoleSelector-settingIcon{padding-right:12px}[dir=rtl] .od-RoleSelector-settingIcon{padding-left:12px}"}])});define("@ms/odsp-shared-sharing/lib/utilities/PeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/string/StringHelper","react","office-ui-fabric-react/lib/Link","../components/Share.resx","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","../components/Share.resx"],function(e,t,r,g,f,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getExternalPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0};t.getOversharingExternalsWarning=function(e){var t=e.filter(function(e){return 1===e.entityType}),i=t.length,o=t.map(function(e){return e.name});if(2===i){var r=(n=o.join(", ")).lastIndexOf(",");return n.substring(0,r)+" "+b.default.and+" "+n.substring(r+1)+" "+b.default.outsideOfYourOrgPlural}if(2<i){var n;r=(n=o.join(", ")).lastIndexOf(",");return n.substring(0,r+1)+" "+b.default.and+" "+n.substring(r+1)+" "+b.default.outsideOfYourOrgPlural}return 1===i?o[0]+" "+b.default.outsideOfYourOrgSingular:""};t.getOversharingGroupsWarning=function(e,t){var i=e.filter(function(e){return 2===e.entityType}).length,o="";1===i?o=b.default.oneGroupInvited:1<i&&(o=r.format(b.default.multipleGroupsInvited,i));1e3<=t?o+=" "+b.default.groupsMemberCountLargeLabel:25<=t&&(o+=" "+r.format(b.default.groupsMemberCountLabel,t));return o};t.renderPickerError=function(e){for(var t=e.selectedItems,i=e.sharingLinkKind,o=e.canAddExternalPrincipal,r=e.sharingInformation,n=e.viewPolicyTipCallback,a=e.permissionsMap,s=g.createElement("div",null,g.createElement("span",null,b.default.ptErrorMessage," "),g.createElement(f.Link,{onClick:n},b.default.ptViewPolicyTipLabel)),l=r.item.hasDlpPolicy||r.sharingAbilities&&7===r.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,d=0,c=t;d<c.length;d++){var p=c[d];if(!p.isResolved)return l&&!o?s:p.rawData?p.rawData.Description:g.createElement("span",null,b.default.noExactMatch);if(p.isExternal&&l&&!o)return s;if(p.isExternal&&p.principalType===y.default.distributionList&&2===p.entityType)return g.createElement("span",null,v.default.peoplePickerErrorDLNotSupported);var u=3===i||2===i;if(p.isExternal&&u)return g.createElement("span",null,b.default.peoplePickerErrorCsl)}if(a&&1===i){var h=0;for(var m in a)1===a[m]&&h++;if(1===h)return g.createElement("span",null,b.default.insufficientPermissionsError);if(1<h)return g.createElement("span",null,b.default.insufficientPermissionsErrorPlural)}return null}});define("@ms/odsp-shared-sharing/lib/utilities/SharingAbilitiesHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharingAbilitiesAudience=function(e){return"anonymousLinkAbilities"===e?2:"organizationLinkAbilities"===e?1:"peopleSharingLinkAbilities"===e?4:void 0};function o(e,t){return 2===e?t.anonymousLinkAbilities:1===e?t.organizationLinkAbilities:4===e?t.peopleSharingLinkAbilities:t.directSharingAbilities}t.getSharingAbilitiesByAudience=o;t.isEditingAllowed=function(e,t){var i=o(e,t);return!i.canManageEditLink||i.canManageEditLink.enabled}});define("@ms/odsp-shared-sharing/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/MessageBar","@ms/odsp-shared-react/lib/PeoplePicker","../../interfaces/SharingInterfaces","react","prop-types","../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareCommunicationManager","./PeoplePicker.scss"],function(e,t,r,i,n,a,s,l,d,c,p,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var o=function(o){r.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._peoplePickerProvider=t.peoplePickerProvider;i._resize=t.resize;i._platformDetection=t.platformDetection;i._externalUsersAllowed=i._computeAllowExternalUsers();i.state={selectedItems:e.defaultSelectedItems,searchForMoreText:i._getSearchForMoreText(e.sharingInformation.isGraphAvailable)};return i}e.prototype.componentWillReceiveProps=function(e){var t=e.defaultSelectedItems;this.setState({selectedItems:t})};e.prototype.componentDidUpdate=function(e){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;null!==this.props.error&&null===e.error&&this._resize()};e.prototype.componentDidMount=function(){this._peoplePickerControl&&!u.isMobile(this.props.clientId)&&this._peoplePickerControl.focusInput()};e.prototype.render=function(){var t=this,e={placeholder:this._computePlaceholderText(),onFocus:function(e){t._onFocus()},"aria-label":c.default.selectedItemListLabel},i=this.props.pickerSettings,o={principalSource:i.PrincipalSource,principalType:this._convertPrincipalType(i.PrincipalAccountType),querySettings:i.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,onToggleGetMoreResults:this._onToggleGetMoreResults},r=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker";return l.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:function(e){t._peoplePicker=e}},l.createElement(a.PeoplePicker,{componentRef:this._resolveRef("_peoplePickerControl"),className:r,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:e,loadingText:c.default.loadingLabel,noResultsFoundText:c.default.noResultsLabel,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:o,suggestionsClassName:"od-Share-PeoplePicker-Suggestions",onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,itemLimit:100,onInputChange:this._onInputChange,onGetMoreResults:this._onGetMoreResults,searchForMoreText:this.state.searchForMoreText,suggestionsAvailableAlertText:c.default.fabricPickerSuggestionsAvailable,enableSelectedSuggestionAlert:this._platformDetection.isIE}),this._renderError(),this._renderWarnings(),l.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this.props.error))};e.prototype._onInputChange=function(e){var t=/<.*>/g.exec(e);if(t&&t[0])return t[0].substring(1,t[0].length-1);var i=/['"].*['"]/g.exec(e);return i&&i[0]?i[0].substring(1,i[0].length-1):e};e.prototype._onGetMoreResults=function(e){var t=this.props.pickerSettings,i={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};return this._peoplePickerProvider.sharePointSearch(e,i)};e.prototype._onSuggestionSelected=function(e){var t=this.props.pickerSettings,i={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===s.PrincipalType.distributionList){i.isGraphDistributionList=!0;i.useGraph=!0}return this._peoplePickerProvider.resolve(e.userId,i).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);return e})};e.prototype._onRenderItem=function(e){var t=this.props.permissionsMap,i=e.item.isExternal&&!this._externalUsersAllowed||1===this.props.sharingLinkKind&&t&&void 0!==t[e.item.email]&&1===t[e.item.email]||!e.item.isResolved,o=e.item.name;e.removeButtonAriaLabel=p.format(c.default.removePersonLabel,o);e.item.imageAlt=p.format(c.default.userPhotoAriaLabel,o);return i?l.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},l.createElement(a.SelectedItemDefault,r.__assign({},e))):l.createElement(a.SelectedItemDefault,r.__assign({},e))};e.prototype._computePlaceholderText=function(){return 0===this.props.defaultSelectedItems.length?c.default.peoplePickerPlaceholder:c.default.peoplePickerPlaceholderWithSelection};e.prototype._convertPrincipalType=function(e){if(!e)return s.PrincipalType.none;for(var t=s.PrincipalType.none,i=0,o=e.split(",");i<o.length;i++){var r=o[i];"User"===r&&(t|=s.PrincipalType.user);"DL"===r&&(t|=s.PrincipalType.distributionList);"SecGroup"===r&&(t|=s.PrincipalType.securityGroup);"SPGroup"===r&&(t|=s.PrincipalType.sharePointGroup)}return t};e.prototype._computeAllowExternalUsers=function(){var e=this.props.sharingLinkKind;return 2!==e&&3!==e&&this.props.sharingInformation.canAddExternalPrincipal};e.prototype._renderError=function(){var e=this.props.error;if(e){this._peoplePickerControl&&!u.isMobile(this.props.clientId)&&this._peoplePickerControl.focusInput();return l.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert","aria-live":"assertive"},e)}};e.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,i=[];if(!this.props.error){100===this.state.selectedItems.length&&i.push(l.createElement(n.MessageBar,null,c.default.peoplePickerLimitMessage));e&&i.push(l.createElement(n.MessageBar,null,e));t&&i.push(l.createElement(n.MessageBar,null,t));return 0<i.length?l.createElement("div",{className:"od-Share-PeoplePicker-warning"},i):void 0}};e.prototype._getSearchForMoreText=function(e){return e?c.default.searchForMoreText:void 0};e.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};e.prototype._onFocus=function(){h.peoplePickerFocused()};e.contextTypes={peoplePickerProvider:d.object.isRequired,resize:d.func.isRequired,platformDetection:d.object.isRequired};r.__decorate([i.autobind],e.prototype,"_onInputChange",null);r.__decorate([i.autobind],e.prototype,"_onGetMoreResults",null);r.__decorate([i.autobind],e.prototype,"_onSuggestionSelected",null);r.__decorate([i.autobind],e.prototype,"_onRenderItem",null);r.__decorate([i.autobind],e.prototype,"_getSearchForMoreText",null);r.__decorate([i.autobind],e.prototype,"_onToggleGetMoreResults",null);r.__decorate([i.autobind],e.prototype,"_onFocus",null);return e}(i.BaseComponent);t.default=o});define("office-ui-fabric-react/lib/MessageBar",["require","exports","tslib","./components/MessageBar/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/MessageBar/index",["require","exports","tslib","./MessageBar","./MessageBar.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/MessageBar/MessageBar",["require","exports","../../Utilities","./MessageBar.base","./MessageBar.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MessageBar=i.styled(o.MessageBarBase,r.getStyles,void 0,{scope:"MessageBar"})});define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.base",["require","exports","tslib","react","../../Utilities","../../Button","../../Icon","./MessageBar.types"],function(e,t,i,r,n,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.classNamesFunction(),o=function(o){i.__extends(e,o);function e(e){var t,i=o.call(this,e)||this;i.ICON_MAP=((t={})[d.MessageBarType.info]="Info",t[d.MessageBarType.warning]="Info",t[d.MessageBarType.error]="ErrorBadge",t[d.MessageBarType.blocked]="Blocked2",t[d.MessageBarType.remove]="Blocked",t[d.MessageBarType.severeWarning]="Warning",t[d.MessageBarType.success]="Completed",t);i._onClick=function(e){i.setState({expandSingleLine:!i.state.expandSingleLine})};i.state={labelId:n.getId("MessageBar"),showContent:!1,expandSingleLine:!1};return i}e.prototype.render=function(){var e=this.props.isMultiline;this._classNames=this._getClassNames();return e?this._renderMultiLine():this._renderSingleLine()};e.prototype._getActionsDiv=function(){return this.props.actions?r.createElement("div",{className:this._classNames.actions},this.props.actions):null};e.prototype._getDismissDiv=function(){return this.props.onDismiss?r.createElement(a.IconButton,{disabled:!1,className:this._classNames.dismissal,onClick:this.props.onDismiss,iconProps:{iconName:"Clear"},ariaLabel:this.props.dismissButtonAriaLabel}):null};e.prototype._getDismissSingleLine=function(){return this.props.onDismiss?r.createElement("div",{className:this._classNames.dismissSingleLine},this._getDismissDiv()):null};e.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?r.createElement("div",{className:this._classNames.expandSingleLine},r.createElement(a.IconButton,{disabled:!1,className:this._classNames.expand,onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel})):null};e.prototype._getIconSpan=function(){return r.createElement("div",{className:this._classNames.iconContainer},r.createElement(s.Icon,{iconName:this.ICON_MAP[this.props.messageBarType],className:this._classNames.icon}))};e.prototype._renderMultiLine=function(){return r.createElement("div",{className:this._classNames.root,"aria-live":this._getAnnouncementPriority()},r.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv())};e.prototype._renderSingleLine=function(){return r.createElement("div",{className:this._classNames.root,"aria-expanded":!this.props.actions&&this.props.truncated?this.state.expandSingleLine:void 0},r.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine()))};e.prototype._renderInnerText=function(){return r.createElement("div",{className:this._classNames.text,id:this.state.labelId},r.createElement("span",{className:this._classNames.innerText,role:"status","aria-live":this._getAnnouncementPriority()},r.createElement(n.DelayedRender,null,r.createElement("span",null,this.props.children))))};e.prototype._getClassNames=function(){var e=this.props,t=e.theme,i=e.className,o=e.messageBarType,r=e.onDismiss,n=e.actions,a=e.truncated,s=e.isMultiline,l=this.state.expandSingleLine;return c(this.props.styles,{theme:t,messageBarType:o||d.MessageBarType.info,onDismiss:void 0!==r,actions:void 0!==n,truncated:a,isMultiline:s,expandSingleLine:l,className:i})};e.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case d.MessageBarType.blocked:case d.MessageBarType.error:case d.MessageBarType.severeWarning:return"assertive"}return"polite"};e.defaultProps={messageBarType:d.MessageBarType.info,onDismiss:void 0,isMultiline:!0};return e}(n.BaseComponent);t.MessageBarBase=o});define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.info=0]="info";e[e.error=1]="error";e[e.blocked=2]="blocked";e[e.severeWarning=3]="severeWarning";e[e.success=4]="success";e[e.warning=5]="warning";e[e.remove=9e4]="remove"}(t.MessageBarType||(t.MessageBarType={}))});define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.styles",["require","exports","tslib","../../Styling","./MessageBar.types"],function(e,t,T,D,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"};t.getStyles=function(e){var t,i,o,r,n,a,s,l,d,c,p=e.theme,u=e.className,h=e.messageBarType,m=e.onDismiss,g=e.actions,f=e.truncated,b=e.isMultiline,y=e.expandSingleLine,v=p.semanticColors,x=p.palette,_=p.fonts,S=D.getScreenSelector(0,D.ScreenWidthMaxSmall),k=D.getGlobalClassNames(E,p),P={fontSize:12,height:12,lineHeight:"12px",color:x.neutralPrimary},w={display:"flex",selectors:{"& .ms-Button-icon":P}},C={flexShrink:0,margin:8,marginLeft:0,selectors:(t={"& .ms-Button-icon":P},t[S]={margin:"0px 0px 0px 8px"},t[D.HighContrastSelector]={MsHighContrastAdjust:"none"},t)},I=D.getFocusStyle(p,0,"relative",void 0,x.black);return{root:[k.root,h===L.MessageBarType.error&&k.error,h===L.MessageBarType.blocked&&k.blocked,h===L.MessageBarType.severeWarning&&k.severeWarning,h===L.MessageBarType.success&&k.success,h===L.MessageBarType.warning&&k.warning,b?k.multiline:k.singleline,!b&&m&&k.dismissalSingleLine,!b&&f&&k.expandingSingleLine,{background:function(e,t,i){switch(e){case L.MessageBarType.error:case L.MessageBarType.blocked:return i.errorBackground;case L.MessageBarType.severeWarning:return i.blockingBackground;case L.MessageBarType.success:return i.successBackground;case L.MessageBarType.warning:return i.warningBackground}return t.neutralLighter}(h,x,v),color:x.neutralPrimary,minHeight:32,width:"100%",boxSizing:"border-box",display:"flex",position:"relative",wordBreak:"break-word",selectors:{"& .ms-Link":T.__assign({color:x.themeDark},_.small)}},b&&{flexDirection:"column"},!b&&{selectors:(i={},i[S]={flexDirection:"column"},i)},f&&{flexDirection:"column",selectors:{"& .ms-Button-icon":{fontSize:12,height:12,lineHeight:12,color:x.neutralPrimary}}},u],content:[k.content,{display:"flex",lineHeight:"normal",width:"100%",boxSizing:"border-box",selectors:{"&:before":{pointerEvents:"none",position:"absolute",right:0,bottom:0,left:0,top:0,margin:0,selectors:(o={},o[D.HighContrastSelector]={border:"1px solid WindowText",content:" "},o)}}},!b&&{selectors:(r={},r[S]={flexDirection:"row"},r)},(f||b)&&{flexDirection:"row"}],iconContainer:[k.iconContainer,{fontSize:16,minWidth:16,minHeight:16,display:"flex",color:x.neutralSecondary,flexShrink:0,margin:16,marginRight:0,selectors:(n={},n[S]={margin:"8px 0px 8px 8px"},n)}],icon:{color:function(e,t,i){switch(e){case L.MessageBarType.error:case L.MessageBarType.blocked:case L.MessageBarType.severeWarning:return i.errorText;case L.MessageBarType.success:return t.green;case L.MessageBarType.warning:return i.warningText}return t.neutralSecondary}(h,x,v)},text:[k.text,T.__assign({minWidth:0,display:"flex",flexGrow:1,margin:"16px 8px"},_.small,{selectors:(a={},a[S]={margin:"8px 0px 8px 8px"},a)}),!m&&{marginRight:16,selectors:(s={},s[S]={marginRight:8},s)},b&&g&&{marginBottom:8,selectors:(l={},l[S]={marginBottom:0},l)},!b&&g&&{selectors:(d={},d[S]={marginBottom:0},d)}],innerText:[k.innerText,{lineHeight:16,selectors:{"& span":{selectors:{"& a":{paddingLeft:4}}}}},f&&{overflow:"visible",whiteSpace:"pre-wrap"},!b&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!b&&!f&&{selectors:(c={},c[S]={overflow:"visible",whiteSpace:"pre-wrap"},c)},y&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[k.dismissSingleLine,w],expandSingleLine:[k.expandSingleLine,w],dismissal:[k.dismissal,C,I],expand:[k.expand,C,I],actions:[b?k.actions:k.actionsSingleline,{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"8px 8px 8px 0",selectors:{"& button:nth-child(n+2)":{marginLeft:8}}},b&&{margin:"0px 12px 12px 0",selectors:{"& button:nth-child(n+2)":{marginLeft:12}}}]}}});define("@ms/odsp-shared-react/lib/PeoplePicker",["require","exports","tslib","./components/PeoplePicker/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@ms/odsp-shared-react/lib/components/PeoplePicker/index",["require","exports","tslib","./PeoplePicker","./PeoplePicker.Props","./PeoplePickerDefaultItems"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t)});define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Pickers","@ms/odsp-datasources/lib/PeoplePicker","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","./PeoplePickerDefaultItems","./PeoplePicker.Props","./PeoplePicker.scss"],function(e,t,x,_,o,i,r,n,S,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=i.BasePicker,w=i.BasePickerListBelow,a=function(i){x.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dataProvider=e.dataProvider||new r.PeoplePickerProvider({pageContext:e.context,peoplePickerDataSource:e.dataSource});t.state={hasUnresolvedText:!1};return t}Object.defineProperty(e.prototype,"selectedPeople",{get:function(){return this._peoplePicker?this._peoplePicker.items:[]},enumerable:!0,configurable:!0});e.prototype.render=function(){var e=this.props,t=e.className,i=e.onRenderItem,o=e.onRenderSuggestionsItem,r=e.defaultSelectedItems,n=e.onSelectedPersonasChange,a=e.suggestionsHeaderText,s=e.suggestionsClassName,l=e.noResultsFoundText,d=e.loadingText,c=e.inputProps,p=e.onSuggestionSelected,u=e.suggestionsAvailableAlertText,h=e.enableSelectedSuggestionAlert,m=e.selectedItems,g=e.itemLimit,f=e.onInputChange,b=e.onGetMoreResults,y=e.searchForMoreText,v={className:t,onRenderSuggestionsItem:o||S.SuggestionItemDefault,onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getSuggestionStringFromPerson,defaultSelectedItems:r,selectedItems:m,onChange:n,inputProps:c,enableSelectedSuggestionAlert:h,pickerSuggestionsProps:{suggestionsHeaderText:a,loadingText:d,noResultsFoundText:l,className:s,suggestionsAvailableAlertText:u,searchForMoreText:y},onItemSelected:p,itemLimit:g,onInputChange:f,onGetMoreResults:b};switch(this.props.peoplePickerType){case k.PeoplePickerType.listBelow:v.onRenderItem=i||S.SelectedItemBelowDefault;return _.createElement(w,x.__assign({},v,{componentRef:this._resolveRef("_peoplePicker")}));default:v.onRenderItem=i||S.SelectedItemDefault;return _.createElement(P,x.__assign({},v,{componentRef:this._resolveRef("_peoplePicker")}))}};e.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};e.prototype._getSuggestionStringFromPerson=function(e,t){return t?e.name&&0===e.name.toLowerCase().indexOf(t.toLowerCase())?e.name:e.email&&0===e.email.toLowerCase().indexOf(t.toLowerCase())?e.email:"":e.name};e.prototype._onResolveSuggestions=function(t){var i=this;if(this._peoplePickerSearchPromise){this._peoplePickerSearchPromise.cancel();this._peoplePickerSearchPromise=void 0}if(t.length<2)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],t):[];var e=this._dataProvider.search(t.trim(),this._getPeoplePickerQueryParams());if(!e)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],t):[];var o=e.cached?e.cached:[];this._peoplePickerSearchPromise=e.promise;return this._peoplePickerSearchPromise.then(function(e){i._peoplePickerSearchPromise=void 0;return e?o.concat(e):[]}).then(function(e){return i.props.onResolvedSuggestions?i.props.onResolvedSuggestions(e,t):e})};e.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?this.props.peoplePickerQueryParams:{allowEmailAddresses:!1,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:n.default.user|n.default.securityGroup|n.default.sharePointGroup,required:null,urlZone:null,urlZoneSpecified:null}};x.__decorate([o.autobind],e.prototype,"_onResolveSuggestions",null);return e}(o.BaseComponent);t.PeoplePicker=a;t.default=a});define("office-ui-fabric-react/lib/Pickers",["require","exports","tslib","./components/pickers/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/pickers/index",["require","exports","tslib","./Suggestions/Suggestions","./Suggestions/SuggestionsController","./AutoFill/BaseAutoFill","./BasePicker","./BasePicker.types","./PeoplePicker/PeoplePicker","./TagPicker/TagPicker","./TagPicker/TagItem"],function(e,t,i,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t);i.__exportStar(c,t)});define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions",["require","exports","tslib","react","../../../Utilities","../../../Button","../../../Spinner","./Suggestions.scss"],function(e,t,i,C,I,T,D,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L,E=o;!function(e){e[e.none=0]="none";e[e.forceResolve=1]="forceResolve";e[e.searchMore=2]="searchMore"}(L=t.SuggestionActionType||(t.SuggestionActionType={}));var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,i=t.suggestionModel,o=t.RenderSuggestion,r=t.onClick,n=t.className,a=t.onRemoveItem,s=t.isSelectedOverride,l=t.removeButtonAriaLabel;return C.createElement("div",{className:I.css("ms-Suggestions-item",E.suggestionsItem,(e={},e["is-suggested "+E.suggestionsItemIsSuggested]=i.selected||s,e),n)},C.createElement(T.CommandButton,{onClick:r,className:I.css("ms-Suggestions-itemButton",E.itemButton)},o(i.item,this.props)),this.props.showRemoveButton?C.createElement(T.IconButton,{iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},title:l,ariaLabel:l,onClick:a,className:I.css("ms-Suggestions-closeButton",E.closeButton)}):null)};return t}(I.BaseComponent);t.SuggestionsItem=r;var n=function(t){i.__extends(e,t);function e(e){var a=t.call(this,e)||this;a._forceResolveButton=I.createRef();a._searchForMoreButton=I.createRef();a._selectedElement=I.createRef();a.SuggestionsItemOfProperType=r;a.tryHandleKeyDown=function(e,t){var i=!1,o=null,r=a.state.selectedActionType,n=a.props.suggestions.length;if(40===e)switch(r){case L.forceResolve:if(0<n){a._refocusOnSuggestions(e);o=L.none}else o=a._searchForMoreButton.current?L.searchMore:L.forceResolve;break;case L.searchMore:if(a._forceResolveButton.current)o=L.forceResolve;else if(0<n){a._refocusOnSuggestions(e);o=L.none}else o=L.searchMore;break;case L.none:-1===t&&a._forceResolveButton.current&&(o=L.forceResolve)}else if(38===e)switch(r){case L.forceResolve:if(a._searchForMoreButton.current)o=L.searchMore;else if(0<n){a._refocusOnSuggestions(e);o=L.none}break;case L.searchMore:if(0<n){a._refocusOnSuggestions(e);o=L.none}else a._forceResolveButton.current&&(o=L.forceResolve);break;case L.none:-1===t&&a._searchForMoreButton.current&&(o=L.searchMore)}if(null!==o){a.setState({selectedActionType:o});i=!0}return i};a._getMoreResults=function(){a.props.onGetMoreResults&&a.props.onGetMoreResults()};a._forceResolve=function(){a.props.createGenericItem&&a.props.createGenericItem()};a._shouldShowForceResolve=function(){return!!a.props.showForceResolve&&a.props.showForceResolve()};a._onClickTypedSuggestionsItem=function(t,i){return function(e){a.props.onSuggestionClick(e,t,i)}};a._refocusOnSuggestions=function(e){"function"==typeof a.props.refocusSuggestions&&a.props.refocusSuggestions(e)};a._onRemoveTypedSuggestionsItem=function(t,i){return function(e){(0,a.props.onSuggestionRemove)(e,t,i);e.stopPropagation()}};a.state={selectedActionType:L.none};return a}e.prototype.componentDidMount=function(){this.scrollSelected();this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null};e.prototype.componentDidUpdate=function(){if(this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current){this.scrollSelected();this.activeSelectedElement=this._selectedElement.current}};e.prototype.render=function(){var e=this.props,t=e.forceResolveText,i=e.mostRecentlyUsedHeaderText,o=e.searchForMoreText,r=e.className,n=e.moreSuggestionsAvailable,a=e.noResultsFoundText,s=e.suggestions,l=e.isLoading,d=e.isSearching,c=e.loadingText,p=e.onRenderNoResultFound,u=e.searchingText,h=e.isMostRecentlyUsedVisible,m=e.resultsMaximumNumber,g=e.resultsFooterFull,f=e.resultsFooter,b=e.isResultsFooterVisible,y=void 0===b||b,v=e.suggestionsAvailableAlertText,x=function(){return a?C.createElement("div",{role:"alert",className:I.css("ms-Suggestions-none",E.suggestionsNone)},a):null},_=e.suggestionsHeaderText;h&&i&&(_=i);var S=void 0;y&&(S=s.length>=m?g:f);var k,P,w=!(s&&s.length||l);return C.createElement("div",{className:I.css("ms-Suggestions",r||"",E.root)},_?C.createElement("div",{className:I.css("ms-Suggestions-title",E.suggestionsTitle)},_):null,t&&this._shouldShowForceResolve()&&C.createElement(T.CommandButton,{componentRef:this._forceResolveButton,className:I.css("ms-forceResolve-button",E.actionButton,(k={},k["is-selected "+E.buttonSelected]=this.state.selectedActionType===L.forceResolve,k)),onClick:this._forceResolve},t),l&&C.createElement(D.Spinner,{className:I.css("ms-Suggestions-spinner",E.suggestionsSpinner),label:c}),w?p?p(void 0,x):x():this._renderSuggestions(),o&&n&&C.createElement(T.CommandButton,{componentRef:this._searchForMoreButton,className:I.css("ms-SearchMore-button",E.actionButton,(P={},P["is-selected "+E.buttonSelected]=this.state.selectedActionType===L.searchMore,P)),iconProps:{iconName:"Search"},onClick:this._getMoreResults},o),d?C.createElement(D.Spinner,{className:I.css("ms-Suggestions-spinner",E.suggestionsSpinner),label:u}):null,!S||n||h||d?null:C.createElement("div",{className:I.css("ms-Suggestions-title",E.suggestionsTitle)},S(this.props)),C.createElement("span",{role:"alert","aria-live":"polite",className:I.css("ms-Suggestions-suggestionsAvailable",E.suggestionsAvailable)},!l&&!d&&s&&0<s.length&&v?v:null))};e.prototype.hasSuggestedAction=function(){return void 0!==this._searchForMoreButton.current||void 0!==this._forceResolveButton.current};e.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==L.none};e.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case L.forceResolve:this._forceResolve();break;case L.searchMore:this._getMoreResults()}};e.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:L.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:L.searchMore})};e.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:L.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:L.forceResolve})};e.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()};e.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)};e.prototype._renderSuggestions=function(){var i=this,e=this.props,o=e.onRenderSuggestion,r=e.removeSuggestionAriaLabel,n=e.suggestionsItemClassName,t=e.resultsMaximumNumber,a=e.showRemoveButtons,s=e.suggestionsContainerAriaLabel,l=this.props.suggestions,d=this.SuggestionsItemOfProperType;t&&(l=l.slice(0,t));return C.createElement("div",{className:I.css("ms-Suggestions-container",E.suggestionsContainer),id:"suggestion-list",role:"list","aria-label":s},l.map(function(e,t){return C.createElement("div",{ref:e.selected?i._selectedElement:"",key:e.item.key?e.item.key:t,id:"sug-"+t,role:"listitem","aria-label":e.ariaLabel},C.createElement(d,{id:"sug-item"+t,suggestionModel:e,RenderSuggestion:o,onClick:i._onClickTypedSuggestionsItem(e.item,t),className:n,showRemoveButton:a,removeButtonAriaLabel:r,onRemoveItem:i._onRemoveTypedSuggestionsItem(e.item,t)}))}))};return e}(I.BaseComponent);t.Suggestions=n});define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_7292aa07{min-width:260px}.suggestionsItem_7292aa07{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative}.suggestionsItem_7292aa07:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.suggestionsItem_7292aa07:hover .closeButton_7292aa07{display:block}.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active){.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07 .closeButton_7292aa07:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_7292aa07.suggestionsItemIsSuggested_7292aa07 .itemButton_7292aa07{color:HighlightText}}.suggestionsItem_7292aa07 .closeButton_7292aa07{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.suggestionsItem_7292aa07 .closeButton_7292aa07:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.actionButton_7292aa07{background:none;background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:40px;width:100%;font-size:12px}[dir='ltr'] .actionButton_7292aa07{padding-left:8px}[dir='rtl'] .actionButton_7292aa07{padding-right:8px}[dir='ltr'] .actionButton_7292aa07{text-align:left}[dir='rtl'] .actionButton_7292aa07{text-align:right}.actionButton_7292aa07:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.actionButton_7292aa07:focus,.actionButton_7292aa07:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_7292aa07 .ms-Button-icon{font-size:16px;width:25px}.actionButton_7292aa07 .ms-Button-label{margin:0 4px 0 9px}html[dir='rtl'] .actionButton_7292aa07 .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_7292aa07{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_7292aa07{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsContainer_7292aa07{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsNone_7292aa07{text-align:center;color:"},{theme:"info",defaultValue:"#666666"},{rawString:";font-size:12px;line-height:30px}.suggestionsSpinner_7292aa07{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir='ltr'] .suggestionsSpinner_7292aa07{padding-left:14px}html[dir='rtl'] .suggestionsSpinner_7292aa07{padding-right:14px}html[dir='ltr'] .suggestionsSpinner_7292aa07{text-align:left}html[dir='rtl'] .suggestionsSpinner_7292aa07{text-align:right}.suggestionsSpinner_7292aa07 .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_7292aa07 .ms-Spinner-label{display:inline-block;margin:0px 10px 0 16px;vertical-align:middle}html[dir='rtl'] .suggestionsSpinner_7292aa07 .ms-Spinner-label{margin:0px 16px 0 10px}.itemButton_7292aa07.itemButton_7292aa07{width:100%;padding:0px;height:100%}@media screen and (-ms-high-contrast: active){.itemButton_7292aa07.itemButton_7292aa07{color:WindowText}}.closeButton_7292aa07.closeButton_7292aa07{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast: active){.closeButton_7292aa07.closeButton_7292aa07{color:WindowText}}.closeButton_7292aa07.closeButton_7292aa07:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.suggestionsAvailable_7292aa07{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.root="root_7292aa07";t.suggestionsItem="suggestionsItem_7292aa07";t.closeButton="closeButton_7292aa07";t.suggestionsItemIsSuggested="suggestionsItemIsSuggested_7292aa07";t.itemButton="itemButton_7292aa07";t.actionButton="actionButton_7292aa07";t.buttonSelected="buttonSelected_7292aa07";t.suggestionsTitle="suggestionsTitle_7292aa07";t.suggestionsContainer="suggestionsContainer_7292aa07";t.suggestionsNone="suggestionsNone_7292aa07";t.suggestionsSpinner="suggestionsSpinner_7292aa07";t.suggestionsAvailable="suggestionsAvailable_7292aa07"});define("office-ui-fabric-react/lib/components/pickers/Suggestions/SuggestionsController",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var t=this;this._isSuggestionModel=function(e){return void 0!==e.item};this._ensureSuggestionModel=function(e){return t._isSuggestionModel(e)?e:{item:e,selected:!1,ariaLabel:e.name||e.primaryText}};this.suggestions=[];this.currentIndex=-1}e.prototype.updateSuggestions=function(e,t){if(e&&0<e.length){this.suggestions=this.convertSuggestionsToSuggestionItems(e);if(void(this.currentIndex=0)!==t){this.suggestions[t].selected=!0;this.currentSuggestion=this.suggestions[t]}}else{this.suggestions=[];this.currentIndex=-1;this.currentSuggestion=void 0}};e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1){this.setSelectedSuggestion(this.currentIndex+1);return!0}if(this.currentIndex===this.suggestions.length-1){this.setSelectedSuggestion(0);return!0}}return!1};e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(0<this.currentIndex){this.setSelectedSuggestion(this.currentIndex-1);return!0}if(0===this.currentIndex){this.setSelectedSuggestion(this.suggestions.length-1);return!0}}return!1};e.prototype.getSuggestions=function(){return this.suggestions};e.prototype.getCurrentItem=function(){return this.currentSuggestion};e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]};e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion};e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)};e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t};e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]};e.prototype.deselectAllSuggestions=function(){if(-1<this.currentIndex){this.suggestions[this.currentIndex].selected=!1;this.currentIndex=-1}};e.prototype.setSelectedSuggestion=function(e){if(e>this.suggestions.length-1||e<0){this.currentIndex=0;this.currentSuggestion.selected=!1;this.currentSuggestion=this.suggestions[0];this.currentSuggestion.selected=!0}else{-1<this.currentIndex&&(this.suggestions[this.currentIndex].selected=!1);this.suggestions[e].selected=!0;this.currentIndex=e;this.currentSuggestion=this.suggestions[e]}};return e}();t.SuggestionsController=i});define("office-ui-fabric-react/lib/components/pickers/AutoFill/BaseAutoFill",["require","exports","tslib","../../Autofill/Autofill"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Autofill/Autofill",["require","exports","tslib","react","../../Utilities"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._inputElement=r.createRef();i._autoFillEnabled=!0;i._onCompositionStart=function(e){i._autoFillEnabled=!1};i._onCompositionEnd=function(e){var t=i._getCurrentInputValue();i._tryEnableAutofill(t,i.value,!1,!0);i._async.setTimeout(function(){return i._updateValue(t)},0)};i._onClick=function(){i._value&&""!==i._value&&i._autoFillEnabled&&(i._autoFillEnabled=!1)};i._onKeyDown=function(e){i.props.onKeyDown&&i.props.onKeyDown(e);if(!e.nativeEvent.isComposing)switch(e.which){case 8:i._autoFillEnabled=!1;break;case 37:case 39:if(i._autoFillEnabled){i._value=i.state.displayValue;i._autoFillEnabled=!1}break;default:i._autoFillEnabled||-1!==i.props.enableAutofillOnKeyPress.indexOf(e.which)&&(i._autoFillEnabled=!0)}};i._onInputChanged=function(e){var t=i._getCurrentInputValue(e);i._tryEnableAutofill(t,i._value,e.nativeEvent.isComposing);i._updateValue(t)};i._onChanged=function(){};i._updateValue=function(e){i._value=i.props.onInputChange?i.props.onInputChange(e):e;i.setState({displayValue:i._getDisplayValue(i._value,i.props.suggestedDisplayValue)},function(){return i._notifyInputChange(i._value)})};i._value=e.defaultVisibleValue||"";i.state={displayValue:e.defaultVisibleValue||""};return i}Object.defineProperty(e.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!0,configurable:!0});e.prototype.componentWillReceiveProps=function(e){var t;this.props.updateValueInWillReceiveProps&&(t=this.props.updateValueInWillReceiveProps());"string"==typeof(t=this._getDisplayValue(t||this._value,e.suggestedDisplayValue))&&this.setState({displayValue:t})};e.prototype.componentDidUpdate=function(){var e=this._value,t=this.props,i=t.suggestedDisplayValue,o=t.shouldSelectFullInputValueInComponentDidUpdate,r=0;if(this._autoFillEnabled&&e&&i&&this._doesTextStartWith(i,e)){var n=!1;o&&(n=o());if(n&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,i.length,"backward");else{for(;r<e.length&&e[r].toLocaleLowerCase()===i[r].toLocaleLowerCase();)r++;0<r&&this._inputElement.current&&this._inputElement.current.setSelectionRange(r,i.length,"backward")}}};e.prototype.render=function(){var e=this.state.displayValue,t=r.getNativeProps(this.props,r.inputProperties);return o.createElement("input",i.__assign({},t,{ref:this._inputElement,value:e,autoCapitalize:"off",autoComplete:"off",onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))};e.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()};e.prototype.clear=function(){this._autoFillEnabled=!0;this._updateValue("");this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)};e.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""};e.prototype._tryEnableAutofill=function(e,t,i,o){!i&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||o)&&(this._autoFillEnabled=!0)};e.prototype._notifyInputChange=function(e){this.props.onInputValueChange&&this.props.onInputValueChange(e)};e.prototype._getDisplayValue=function(e,t){var i=e;t&&e&&this._doesTextStartWith(t,i)&&this._autoFillEnabled&&(i=t);return i};e.prototype._doesTextStartWith=function(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())};e.defaultProps={enableAutofillOnKeyPress:[40,38]};return e}(r.BaseComponent),a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(t.Autofill=n);t.BaseAutoFill=a});define("office-ui-fabric-react/lib/components/pickers/BasePicker",["require","exports","tslib","react","../../Utilities","../../FocusZone","../../Callout","../../utilities/selection/index","./Suggestions/Suggestions","./Suggestions/SuggestionsController","./BasePicker.types","../Autofill/index","./BasePicker.scss"],function(e,t,c,p,u,h,o,m,r,a,n,g,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i,s=function(i){c.__extends(e,i);function e(e){var n=i.call(this,e)||this;n.root=u.createRef();n.input=u.createRef();n.focusZone=u.createRef();n.suggestionElement=u.createRef();n.SuggestionOfProperType=r.Suggestions;n.dismissSuggestions=function(e){var t=function(){n.props.onDismiss&&n.props.onDismiss(e,n.suggestionStore.currentSuggestion?n.suggestionStore.currentSuggestion.item:void 0);(!e||e&&!e.defaultPrevented)&&n.canAddItems()&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestedDisplayValue&&n.addItemByIndex(0)};n.currentPromise?n.currentPromise.then(function(){return t()}):t();n.setState({suggestionsVisible:!1})};n.refocusSuggestions=function(e){n.resetFocus();n.suggestionStore.suggestions&&0<n.suggestionStore.suggestions.length&&(38===e?n.suggestionStore.setSelectedSuggestion(n.suggestionStore.suggestions.length-1):40===e&&n.suggestionStore.setSelectedSuggestion(0))};n.onInputChange=function(e){n.updateValue(e);n.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})};n.onSuggestionClick=function(e,t,i){n.addItemByIndex(i);n.setState({suggestionsVisible:!1})};n.onSuggestionRemove=function(e,t,i){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(t);n.suggestionStore.removeSuggestion(i)};n.onInputFocus=function(e){if(!n.state.isFocused){n.setState({isFocused:!0});n.selection.setAllSelected(!1);if(n.input.current&&""===n.input.current.value&&n.props.onEmptyInputFocus){n.onEmptyInputFocus();n.setState({isMostRecentlyUsedVisible:!0,moreSuggestionsAvailable:!1,suggestionsVisible:!0})}else n.input.current&&n.input.current.value&&n.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0});n.props.inputProps&&n.props.inputProps.onFocus&&n.props.inputProps.onFocus(e)}};n.onInputBlur=function(e){n.props.inputProps&&n.props.inputProps.onBlur&&n.props.inputProps.onBlur(e);if(!u.elementContains(n.root.value,e.relatedTarget)){n.setState({isFocused:!1});n.props.onBlur&&n.props.onBlur(e)}};n.onKeyDown=function(e){var t=e.which;switch(t){case 27:if(n.state.suggestionsVisible){n.setState({suggestionsVisible:!1});e.preventDefault();e.stopPropagation()}break;case 9:case 13:if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedActionSelected())n.suggestionElement.current.executeSelectedAction();else if(!e.shiftKey&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestionsVisible){n.completeSuggestion();e.preventDefault();e.stopPropagation()}else n._onValidateInput();break;case 8:n.props.disabled||n.onBackspace(e);e.stopPropagation();break;case 46:if(!n.props.disabled)if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible&&-1!==n.suggestionStore.currentIndex){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(n.suggestionStore.currentSuggestion.item);n.suggestionStore.removeSuggestion(n.suggestionStore.currentIndex);n.forceUpdate()}else n.onBackspace(e);e.stopPropagation();break;case 38:if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible)if(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&0===n.suggestionStore.currentIndex){e.preventDefault();e.stopPropagation();n.suggestionElement.current.focusAboveSuggestions();n.suggestionStore.deselectAllSuggestions();n.forceUpdate()}else if(n.suggestionStore.previousSuggestion()){e.preventDefault();e.stopPropagation();n.onSuggestionSelect()}break;case 40:if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible)if(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&n.suggestionStore.currentIndex+1===n.suggestionStore.suggestions.length){e.preventDefault();e.stopPropagation();n.suggestionElement.current.focusBelowSuggestions();n.suggestionStore.deselectAllSuggestions();n.forceUpdate()}else if(n.suggestionStore.nextSuggestion()){e.preventDefault();e.stopPropagation();n.onSuggestionSelect()}}};n.onItemChange=function(e,t){var i=n.state.items;if(0<=t){var o=i;o[t]=e;n._updateSelectedItems(o)}};n.onGetMoreResults=function(){n.setState({isSearching:!0},function(){if(n.props.onGetMoreResults&&n.input.current){var e=n.props.onGetMoreResults(n.input.current.value,n.state.items),t=e,i=e;if(Array.isArray(t)){n.updateSuggestions(t);n.setState({isSearching:!1})}else i.then&&i.then(function(e){n.updateSuggestions(e);n.setState({isSearching:!1})})}else n.setState({isSearching:!1});n.input.current&&n.input.current.focus();n.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})};n.addItemByIndex=function(e){n.addItem(n.suggestionStore.getSuggestionAtIndex(e).item);n.input.current&&n.input.current.clear();n.updateValue("")};n.addItem=function(e){var t=n.props.onItemSelected?n.props.onItemSelected(e):e;if(null!==t){var i=t,o=t;if(o&&o.then)o.then(function(e){var t=n.state.items.concat([e]);n._updateSelectedItems(t)});else{var r=n.state.items.concat([i]);n._updateSelectedItems(r)}n.setState({suggestedDisplayValue:""})}};n.removeItem=function(e){var t=n.state.items,i=t.indexOf(e);if(0<=i){var o=t.slice(0,i).concat(t.slice(i+1));n._updateSelectedItems(o)}};n.removeItems=function(t){var e=n.state.items,i=e.filter(function(e){return-1===t.indexOf(e)}),o=t[0],r=e.indexOf(o);n._updateSelectedItems(i,r)};n._isFocusZoneInnerKeystroke=function(e){if(n.state.suggestionsVisible)switch(e.which){case 38:case 40:return!0}return 13===e.which};var t=e.selectedItems||e.defaultSelectedItems||[];n.suggestionStore=new a.SuggestionsController;n.selection=new m.Selection({onSelectionChanged:function(){return n.onSelectionChange()}});n.selection.setItems(t);n.state={items:t,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[]};return n}Object.defineProperty(e.prototype,"items",{get:function(){return this.state.items},enumerable:!0,configurable:!0});e.prototype.componentWillUpdate=function(e,t){t.items&&t.items!==this.state.items&&this.selection.setItems(t.items)};e.prototype.componentDidMount=function(){this.selection.setItems(this.state.items);this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)};e.prototype.componentWillReceiveProps=function(e){var t=this,i=e.selectedItems;if(i){var o;i.length<this.state.items.length&&(o=this.state.items.indexOf(this.selection.getSelection()[0]));this.setState({items:e.selectedItems},function(){0<=o&&t.resetFocus(o)})}};e.prototype.componentWillUnmount=function(){i.prototype.componentWillUnmount.call(this);this.loadingTimer&&this._async.clearTimeout(this.loadingTimer);this.currentPromise&&(this.currentPromise=void 0)};e.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()};e.prototype.focusInput=function(){this.input.current&&this.input.current.focus()};e.prototype.completeSuggestion=function(){if(this.suggestionStore.hasSelectedSuggestion()&&this.input.current){this.addItem(this.suggestionStore.currentSuggestion.item);this.updateValue("");this.input.current.clear()}};e.prototype.render=function(){var e=this.state.suggestedDisplayValue,t=this.props,i=t.className,o=t.inputProps,r=t.disabled,n=this.suggestionStore.currentIndex,a=-1<n?"sug-"+n:void 0,s=void 0;if(this.props.enableSelectedSuggestionAlert){var l=-1<n?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,d=l?l.ariaLabel:void 0;s=p.createElement("div",{className:f.screenReaderOnly,role:"alert",id:"selected-suggestion-alert","aria-live":"assertive"},d," ")}return p.createElement("div",{ref:this.root,className:u.css("ms-BasePicker",i||""),onKeyDown:this.onKeyDown},p.createElement(h.FocusZone,{componentRef:this.focusZone,direction:h.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke},s,p.createElement(m.SelectionZone,{selection:this.selection,selectionMode:m.SelectionMode.multiple},p.createElement("div",{className:u.css("ms-BasePicker-text",f.pickerText,this.state.isFocused&&f.inputFocused),role:"list"},this.renderItems(),this.canAddItems()&&p.createElement(g.Autofill,c.__assign({},o,{className:u.css("ms-BasePicker-input",f.pickerInput),ref:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":a,"aria-owns":this.state.suggestionsVisible?"suggestion-list":void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true",autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:r,"aria-controls":"selected-suggestion-alert",onInputChange:this.props.onInputChange}))))),this.renderSuggestions())};e.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t};e.prototype.renderSuggestions=function(){var e=this.SuggestionOfProperType;return this.state.suggestionsVisible&&this.input?p.createElement(o.Callout,{isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:4,directionalHintForRTL:6},p.createElement(e,c.__assign({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),ref:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel},this.props.pickerSuggestionsProps))):null};e.prototype.renderItems=function(){var i=this,e=this.props,o=e.disabled,r=e.removeButtonAriaLabel,n=this.props.onRenderItem,t=this.state,a=t.items,s=t.selectedIndices;return a.map(function(e,t){return n({item:e,index:t,key:e.key?e.key:t,selected:-1!==s.indexOf(t),onRemoveItem:function(){return i.removeItem(e)},disabled:o,onItemChange:i.onItemChange,removeButtonAriaLabel:r})})};e.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&0<=e){var i=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];i&&this.focusZone.current&&this.focusZone.current.focusElement(i)}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(t.length-1)};e.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}};e.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})};e.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0);this.forceUpdate()};e.prototype.onEmptyInputFocus=function(){var e=(0,this.props.onEmptyInputFocus)(this.state.items);this.updateSuggestionsList(e)};e.prototype.updateValue=function(e){this._onResolveSuggestions(e)};e.prototype.updateSuggestionsList=function(e,t){var i=this,o=e,r=e;if(Array.isArray(o))void 0!==t?this.resolveNewValue(t,o):this.suggestionStore.updateSuggestions(o,0);else if(r&&r.then){this.loadingTimer||(this.loadingTimer=this._async.setTimeout(function(){i.setState({suggestionsLoading:!0})},500));this.suggestionStore.updateSuggestions([]);void 0!==t?this.setState({suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)}):this.setState({suggestionsVisible:!!this.input.current&&this.input.current.inputElement===document.activeElement});var n=this.currentPromise=r;n.then(function(e){if(n===i.currentPromise){if(void 0!==t)i.resolveNewValue(t,e);else{i.suggestionStore.updateSuggestions(e);i.setState({suggestionsLoading:!1})}if(i.loadingTimer){i._async.clearTimeout(i.loadingTimer);i.loadingTimer=void 0}}})}};e.prototype.resolveNewValue=function(e,t){this.suggestionStore.updateSuggestions(t,0);var i=void 0;this.suggestionStore.currentSuggestion&&(i=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e));this.setState({suggestionsLoading:!1,suggestedDisplayValue:i,suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)})};e.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)};e.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(0<this.selection.getSelectedCount()?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))};e.prototype._updateSelectedItems=function(e,t){var i=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){i._onSelectedItemsUpdated(e,t)})};e.prototype._onSelectedItemsUpdated=function(e,t){this.resetFocus(t);this.onChange(e)};e.prototype._onResolveSuggestions=function(e){var t=this.props.onResolveSuggestions(e,this.state.items);null!==t&&this.updateSuggestionsList(t,e)};e.prototype._onValidateInput=function(){if(this.props.onValidateInput&&this.input.current&&this.props.onValidateInput(this.input.current.value)!==n.ValidationState.invalid&&this.props.createGenericItem){var e=this.props.createGenericItem(this.input.current.value,this.props.onValidateInput(this.input.current.value));this.suggestionStore.createGenericSuggestion(e);this.completeSuggestion()}};e.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""};return e}(u.BaseComponent),l=function(e){c.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.state.suggestedDisplayValue,t=this.props,i=t.className,o=t.inputProps,r=t.disabled;return p.createElement("div",null,p.createElement("div",{ref:this.root,className:u.css("ms-BasePicker",i||""),onKeyDown:this.onKeyDown},p.createElement(m.SelectionZone,{selection:this.selection,selectionMode:m.SelectionMode.multiple},p.createElement("div",{className:u.css("ms-BasePicker-text",f.pickerText,this.state.isFocused&&f.inputFocused)},p.createElement(g.Autofill,c.__assign({},o,{className:u.css("ms-BasePicker-input",f.pickerInput),ref:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":this.state.suggestionsVisible?"sug-"+this.suggestionStore.currentIndex:void 0,"aria-owns":this.state.suggestionsVisible?"suggestion-list":void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true",autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:r}))))),this.renderSuggestions(),p.createElement(h.FocusZone,{componentRef:this.focusZone,className:"ms-BasePicker-selectedItems",isCircularNavigation:!0,direction:h.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke},this.renderItems()))};t.prototype.onBackspace=function(e){};return t}(t.BasePicker=s);t.BasePickerListBelow=l});define("office-ui-fabric-react/lib/utilities/selection/index",["require","exports","tslib","./interfaces","./Selection","./SelectionZone"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t)});define("office-ui-fabric-react/lib/utilities/selection/SelectionZone",["require","exports","tslib","react","../../Utilities","./interfaces"],function(e,t,i,o,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="data-selection-index",p="data-selection-toggle",a="data-selection-invoke",n="data-selection-all-toggle",s=function(e){i.__extends(t,e);function t(){var l=null!==e&&e.apply(this,arguments)||this;l._root=d.createRef();l.ignoreNextFocus=function(){l._handleNextFocus(!1)};l._onMouseDownCapture=function(e){if(document.activeElement===e.target||d.elementContains(document.activeElement,e.target)){if(d.elementContains(e.target,l._root.current))for(var t=e.target;t!==l._root.current;){if(l._hasAttribute(t,a)){l.ignoreNextFocus();break}t=d.getParent(t)}}else l.ignoreNextFocus()};l._onFocus=function(e){var t=e.target,i=l.props.selection,o=l._isCtrlPressed||l._isMetaPressed,r=l._getSelectionMode();if(l._shouldHandleFocus&&r!==c.SelectionMode.none){var n=l._hasAttribute(t,p),a=l._findItemRoot(t);if(!n&&a){var s=l._getItemIndex(a);if(o){i.setIndexSelected(s,i.isIndexSelected(s),!0);if(l.props.enterModalOnTouch&&l._isTouch&&i.setModal){i.setModal(!0);l._setIsTouch(!1)}}else l.props.isSelectedOnFocus&&l._onItemSurfaceClick(e,s)}}l._handleNextFocus(!1)};l._onMouseDown=function(e){l._updateModifiers(e);var t=e.target,i=l._findItemRoot(t);if(!l._isSelectionDisabled(t))for(;t!==l._root.current&&!l._hasAttribute(t,n);){if(i){if(l._hasAttribute(t,p))break;if(l._hasAttribute(t,a))break;if(!(t!==i&&!l._shouldAutoSelect(t)||l._isShiftPressed||l._isCtrlPressed)){l._onInvokeMouseDown(e,l._getItemIndex(i));break}if(l.props.disableAutoSelectOnInputElements&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName))return}t=d.getParent(t)}};l._onTouchStartCapture=function(e){l._setIsTouch(!0)};l._onClick=function(e){l._updateModifiers(e);var t=e.target,i=l._findItemRoot(t);if(!l._isSelectionDisabled(t))for(;t!==l._root.current;){if(l._hasAttribute(t,n)){l._onToggleAllClick(e);break}if(i){var o=l._getItemIndex(i);if(l._hasAttribute(t,p)){l._isShiftPressed?l._onItemSurfaceClick(e,o):l._onToggleClick(e,o);break}if(l._hasAttribute(t,a)){l._onInvokeClick(e,o);break}if(t===i){l._onItemSurfaceClick(e,o);break}if("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName)return}t=d.getParent(t)}};l._onContextMenu=function(e){var t=e.target,i=l.props,o=i.onItemContextMenu,r=i.selection;if(o){var n=l._findItemRoot(t);if(n){var a=l._getItemIndex(n);o(r.getItems()[a],a,e.nativeEvent)||e.preventDefault()}}};l._onDoubleClick=function(e){var t=e.target;if(!l._isSelectionDisabled(t)){var i=l.props.onItemInvoked,o=l._findItemRoot(t),r=l._getSelectionMode();if(o&&i&&r!==c.SelectionMode.none&&!l._isInputElement(t)){for(var n=l._getItemIndex(o);t!==l._root.current&&!l._hasAttribute(t,p)&&!l._hasAttribute(t,a);){if(t===o){l._onInvokeClick(e,n);break}t=d.getParent(t)}t=d.getParent(t)}}};l._onKeyDownCapture=function(e){l._updateModifiers(e);l._handleNextFocus(!0)};l._onKeyDown=function(e){l._updateModifiers(e);var t=e.target;if(!l._isSelectionDisabled(t)){var i=l.props.selection,o=65===e.which&&(l._isCtrlPressed||l._isMetaPressed),r=27===e.which;if(!l._isInputElement(t)){var n=l._getSelectionMode();if(!o||n!==c.SelectionMode.multiple||i.isAllSelected())if(r&&0<i.getSelectedCount()){i.setAllSelected(!1);e.stopPropagation();e.preventDefault()}else{var a=l._findItemRoot(t);if(a)for(var s=l._getItemIndex(a);t!==l._root.current&&!l._hasAttribute(t,p);){if(l._shouldAutoSelect(t)){l._onInvokeMouseDown(e,s);break}if(!(13!==e.which&&32!==e.which||"BUTTON"!==t.tagName&&"A"!==t.tagName&&"INPUT"!==t.tagName))return!1;if(t===a){if(13===e.which){l._onInvokeClick(e,s);e.preventDefault();return}if(32===e.which){l._onToggleClick(e,s);e.preventDefault();return}break}t=d.getParent(t)}}else{i.setAllSelected(!0);e.stopPropagation();e.preventDefault()}}}};return l}t.prototype.componentDidMount=function(){var e=d.getWindow(this._root.current),t=d.findScrollableParent(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0);this._events.on(t,"click",this._tryClearOnEmptyClick);this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0);this._events.on(document.body,"touchend",this._onTouchStartCapture,!0)};t.prototype.render=function(){return o.createElement("div",i.__assign({className:"ms-SelectionZone",ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu},{onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus}),this.props.children)};t.prototype._isSelectionDisabled=function(e){for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=d.getParent(e)}return!1};t.prototype._onToggleAllClick=function(e){var t=this.props.selection;if(this._getSelectionMode()===c.SelectionMode.multiple){t.toggleAllSelected();e.stopPropagation();e.preventDefault()}};t.prototype._onToggleClick=function(e,t){var i=this.props.selection,o=this._getSelectionMode();i.setChangeEvents(!1);if(this.props.enterModalOnTouch&&this._isTouch&&!i.isIndexSelected(t)&&i.setModal){i.setModal(!0);this._setIsTouch(!1)}if(o===c.SelectionMode.multiple)i.toggleIndexSelected(t);else{if(o!==c.SelectionMode.single){i.setChangeEvents(!0);return}var r=i.isIndexSelected(t);i.setAllSelected(!1);i.setIndexSelected(t,!r,!0)}i.setChangeEvents(!0);e.stopPropagation()};t.prototype._onInvokeClick=function(e,t){var i=this.props,o=i.selection,r=i.onItemInvoked;if(r){r(o.getItems()[t],t,e.nativeEvent);e.preventDefault();e.stopPropagation()}};t.prototype._onItemSurfaceClick=function(e,t){var i=this.props.selection,o=this._isCtrlPressed||this._isMetaPressed,r=this._getSelectionMode();r===c.SelectionMode.multiple?this._isShiftPressed&&!this._isTabPressed?i.selectToIndex(t,!o):o?i.toggleIndexSelected(t):this._clearAndSelectIndex(t):r===c.SelectionMode.single&&this._clearAndSelectIndex(t)};t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)};t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)};t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;if(!(1===t.getSelectedCount()&&t.isIndexSelected(e))){t.setChangeEvents(!1);t.setAllSelected(!1);t.setIndexSelected(e,!0,!0);if(this.props.enterModalOnTouch&&this._isTouch&&t.setModal){t.setModal(!0);this._setIsTouch(!1)}t.setChangeEvents(!0)}};t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey;this._isCtrlPressed=e.ctrlKey;this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&9===t};t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var i=e.getAttribute(r),o=Number(i);if(null!==i&&0<=o&&o<t.getItems().length)break;e=d.getParent(e)}if(e!==this._root.current)return e};t.prototype._getItemIndex=function(e){return Number(e.getAttribute(r))};t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")};t.prototype._hasAttribute=function(e,t){for(var i=!1;!i&&e!==this._root.current;){i="true"===e.getAttribute(t);e=d.getParent(e)}return i};t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName};t.prototype._isNonHandledClick=function(e){var t=d.getDocument();if(t&&e)for(;e&&e!==t.documentElement;){if(d.isElementTabbable(e))return!1;e=d.getParent(e)}return!0};t.prototype._handleNextFocus=function(e){var t=this;if(this._shouldHandleFocusTimeoutId){this._async.clearTimeout(this._shouldHandleFocusTimeoutId);this._shouldHandleFocusTimeoutId=void 0}(this._shouldHandleFocus=e)&&this._async.setTimeout(function(){t._shouldHandleFocus=!1},100)};t.prototype._setIsTouch=function(e){var t=this;if(this._isTouchTimeoutId){this._async.clearTimeout(this._isTouchTimeoutId);this._isTouchTimeoutId=void 0}this._isTouch=!0;e&&this._async.setTimeout(function(){t._isTouch=!1},300)};t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:c.SelectionMode.none:t};t.defaultProps={isMultiSelectEnabled:!0,isSelectedOnFocus:!0,selectionMode:c.SelectionMode.multiple};return t}(d.BaseComponent);t.SelectionZone=s});define("office-ui-fabric-react/lib/components/pickers/BasePicker.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.valid=0]="valid";e[e.warning=1]="warning";e[e.invalid=2]="invalid"}(t.ValidationState||(t.ValidationState={}))});define("office-ui-fabric-react/lib/components/Autofill/index",["require","exports","tslib","./Autofill"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/pickers/BasePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".pickerText_4fe0caaf{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";min-width:180px;min-height:30px}.pickerText_4fe0caaf:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#212121"},{rawString:"}.pickerText_4fe0caaf.inputFocused_4fe0caaf{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.pickerInput_4fe0caaf{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:none;padding:0 6px 0px}.screenReaderOnly_4fe0caaf{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.pickerText="pickerText_4fe0caaf";t.inputFocused="inputFocused_4fe0caaf";t.pickerInput="pickerInput_4fe0caaf";t.screenReaderOnly="screenReaderOnly_4fe0caaf"});define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePicker",["require","exports","tslib","react","../../../Utilities","../BasePicker","../BasePicker.types","./PeoplePickerItems/SelectedItemDefault","./PeoplePickerItems/SuggestionItemDefault","./PeoplePicker.scss"],function(e,t,i,o,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(n.BasePicker);t.BasePeoplePicker=d;var c=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(n.BasePickerListBelow);t.MemberListPeoplePicker=c;var p=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return o.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemNormal(i.__assign({},e),i.__assign({},t))},createGenericItem:m};return t}(d);t.NormalPeoplePicker=p;var u=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return o.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemSmall(i.__assign({},e),i.__assign({},t))},createGenericItem:m};return t}(d);t.CompactPeoplePicker=u;var h=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return o.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemNormal(i.__assign({},e),i.__assign({},t))},createGenericItem:m};return t}(c);t.ListPeoplePicker=h;function m(e,t,i){var o={key:e,primaryText:e,imageInitials:"!",ValidationState:t};t!==a.ValidationState.warning&&(o.imageInitials=r.getInitials(e,r.getRTL(),i));return o}t.createGenericItem=m});define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/SelectedItemDefault",["require","exports","tslib","react","../../../../Utilities","../../../../Persona","../../BasePicker.types","../../../../Button","./PickerItemsDefault.scss"],function(e,t,c,p,u,h,m,g,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i;t.SelectedItemDefault=function(e){var t,i,o,r=e.item,n=e.onRemoveItem,a=e.index,s=e.selected,l=e.removeButtonAriaLabel,d=u.getId();return p.createElement("div",{className:u.css("ms-PickerPersona-container",f.personaContainer,(i={},i["is-selected "+f.personaContainerIsSelected]=s,i),(o={},o["is-invalid "+f.validationError]=r.ValidationState===m.ValidationState.warning,o)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-selection-index":a,role:"listitem","aria-labelledby":"selectedItemPersona-"+d},p.createElement("div",{className:u.css("ms-PickerItem-content",f.itemContent),id:"selectedItemPersona-"+d},p.createElement(h.Persona,c.__assign({},r,{presence:void 0!==r.presence?r.presence:h.PersonaPresence.none,size:h.PersonaSize.size28}))),p.createElement(g.IconButton,{onClick:(t=n,function(){t&&t()}),iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},className:u.css("ms-PickerItem-removeButton",f.removeButton),ariaLabel:l}))}});define("office-ui-fabric-react/lib/Persona",["require","exports","tslib","./components/Persona/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Persona/index",["require","exports","tslib","./Persona","./Persona.base","./Persona.types","./PersonaCoin/index","./PersonaConsts"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t)});define("office-ui-fabric-react/lib/components/Persona/Persona",["require","exports","../../Utilities","./Persona.base","./Persona.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Persona=i.styled(o.PersonaBase,r.getStyles,void 0,{scope:"Persona"})});define("office-ui-fabric-react/lib/components/Persona/Persona.base",["require","exports","tslib","react","../../Utilities","../../Tooltip","./PersonaCoin/PersonaCoin","./Persona.types"],function(e,t,E,M,A,r,F,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=A.classNamesFunction(),i=function(t){E.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._renderElement=function(e,t,i){return M.createElement("div",{className:t},i?i(o.props):e&&M.createElement(r.TooltipHost,{content:e,overflowMode:r.TooltipOverflowMode.Parent,directionalHint:0},e))};o._warnDeprecations({primaryText:"text"});return o}e.prototype.render=function(){var e=this.props,t=e.hidePersonaDetails,i=e.onRenderOptionalText,o=e.onRenderPrimaryText,r=e.onRenderSecondaryText,n=e.onRenderTertiaryText,a=this.props.size,s=this.props,l=s.allowPhoneInitials,d=s.className,c=s.coinProps,p=s.showUnknownPersonaCoin,u=s.coinSize,h=s.styles,m=s.imageAlt,g=s.imageInitials,f=s.imageShouldFadeIn,b=s.imageShouldStartVisible,y=s.imageUrl,v=s.initialsColor,x=s.onPhotoLoadingStateChange,_=s.onRenderCoin,S=s.onRenderInitials,k=s.presence,P=s.showInitialsUntilImageLoads,w=s.showSecondaryText,C=s.theme,I={allowPhoneInitials:l,coinProps:c,showUnknownPersonaCoin:p,coinSize:u,imageAlt:m,imageInitials:g,imageShouldFadeIn:f,imageShouldStartVisible:b,imageUrl:y,initialsColor:v,onPhotoLoadingStateChange:x,onRenderCoin:_,onRenderInitials:S,presence:k,showInitialsUntilImageLoads:P,size:a,text:this._getText()},T=O(h,{theme:C,className:d,showSecondaryText:w,presence:k,size:a}),D=A.getNativeProps(this.props,A.divProperties),L=M.createElement("div",{className:T.details},this._renderElement(this._getText(),T.primaryText,o),this._renderElement(this.props.secondaryText,T.secondaryText,r),this._renderElement(this.props.tertiaryText,T.tertiaryText,n),this._renderElement(this.props.optionalText,T.optionalText,i),this.props.children);return M.createElement("div",E.__assign({},D,{className:T.root,style:u?{height:u,minWidth:u}:void 0}),M.createElement(F.PersonaCoin,E.__assign({},I)),(!t||a===R.PersonaSize.size10||a===R.PersonaSize.tiny)&&L)};e.prototype._getText=function(){return this.props.text||this.props.primaryText||""};e.defaultProps={size:R.PersonaSize.size48,presence:R.PersonaPresence.none,imageAlt:""};return e}(A.BaseComponent);t.PersonaBase=i});define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin",["require","exports","../../../Utilities","./PersonaCoin.base","./PersonaCoin.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersonaCoin=i.styled(o.PersonaCoinBase,r.getStyles,void 0,{scope:"PersonaCoin"})});define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin.base",["require","exports","tslib","react","../../../Utilities","../../../Styling","../PersonaPresence/index","../../../Icon","../../../Image","../Persona.types","../PersonaInitialsColor"],function(e,t,_,S,k,P,w,C,h,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,D=k.classNamesFunction(),m=((i={})[I.PersonaSize.tiny]=20,i[I.PersonaSize.extraExtraSmall]=24,i[I.PersonaSize.extraSmall]=28,i[I.PersonaSize.small]=40,i[I.PersonaSize.regular]=48,i[I.PersonaSize.large]=72,i[I.PersonaSize.extraLarge]=100,i[I.PersonaSize.size24]=24,i[I.PersonaSize.size28]=28,i[I.PersonaSize.size10]=20,i[I.PersonaSize.size32]=32,i[I.PersonaSize.size40]=40,i[I.PersonaSize.size48]=48,i[I.PersonaSize.size72]=72,i[I.PersonaSize.size100]=100,i),o=function(t){_.__extends(e,t);function e(e){var u=t.call(this,e)||this;u._onRenderCoin=function(e){var t=u.props,i=t.coinSize,o=t.styles,r=t.imageUrl,n=t.imageAlt,a=t.imageShouldFadeIn,s=t.imageShouldStartVisible,l=t.theme,d=t.showUnknownPersonaCoin,c=u.props.size,p=D(o,{theme:l,size:c,showUnknownPersonaCoin:d});return S.createElement(h.Image,{className:p.image,imageFit:h.ImageFit.cover,src:r,width:i||m[c],height:i||m[c],alt:n,shouldFadeIn:a,shouldStartVisible:s,onLoadingStateChange:u._onPhotoLoadingStateChange})};u._onRenderInitials=function(e){var t=e.imageInitials,i=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return S.createElement(C.Icon,{iconName:"Help"});var o=k.getRTL();return""!==(t=t||k.getInitials(u._getText(),o,i))?S.createElement("span",null,t):S.createElement(C.Icon,{iconName:"Contact"})};u._onPhotoLoadingStateChange=function(e){u.setState({isImageLoaded:e===h.ImageLoadState.loaded,isImageError:e===h.ImageLoadState.error});u.props.onPhotoLoadingStateChange&&u.props.onPhotoLoadingStateChange(e)};u._warnDeprecations({primaryText:"text"});u.state={isImageLoaded:!1,isImageError:!1};return u}e.prototype.render=function(){var e=this.props,t=e.className,i=e.coinProps,o=e.showUnknownPersonaCoin,r=e.coinSize,n=e.styles,a=e.imageUrl,s=e.onRenderCoin,l=void 0===s?this._onRenderCoin:s,d=e.onRenderInitials,c=void 0===d?this._onRenderInitials:d,p=e.presence,u=e.showInitialsUntilImageLoads,h=e.theme,m=this.props.size,g=k.getNativeProps(this.props,k.divProperties),f=r?{width:r,height:r}:void 0,b=o,y={coinSize:r,presence:p,size:m,theme:h},v=D(n,{theme:h,className:i&&i.className?i.className:t,size:m,showUnknownPersonaCoin:o}),x=Boolean(!this.state.isImageLoaded&&(u&&a||!a||this.state.isImageError||b));return S.createElement("div",_.__assign({},g,{className:v.coin}),m!==I.PersonaSize.size10&&m!==I.PersonaSize.tiny?S.createElement("div",_.__assign({},i,{className:v.imageArea,style:f}),x&&S.createElement("div",{className:P.mergeStyles(v.initials,!o&&{backgroundColor:T.initialsColorPropToColorCode(this.props)}),style:f,"aria-hidden":"true"},c(this.props,this._onRenderInitials)),a&&!b&&l(this.props,this._onRenderCoin),S.createElement(w.PersonaPresence,_.__assign({},y))):this.props.presence?S.createElement(w.PersonaPresence,_.__assign({},y)):S.createElement(C.Icon,{iconName:"Contact",className:v.size10WithoutPresenceIcon}),this.props.children)};e.prototype._getText=function(){return this.props.text||this.props.primaryText||""};e.defaultProps={size:I.PersonaSize.size48,presence:I.PersonaPresence.none,imageAlt:""};return e}(k.BaseComponent);t.PersonaCoinBase=o});define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/index",["require","exports","tslib","./PersonaPresence","./PersonaPresence.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence",["require","exports","../../../Utilities","./PersonaPresence.base","./PersonaPresence.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersonaPresence=i.styled(o.PersonaPresenceBase,r.getStyles,void 0,{scope:"PersonaPresence"})});define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence.base",["require","exports","tslib","react","../../../Utilities","../../../Icon","../Persona.types","../PersonaConsts"],function(e,t,i,p,o,r,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=o.classNamesFunction(),n=function(t){i.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._onRenderIcon=function(e,t){return p.createElement(r.Icon,{className:e,iconName:i._determineIcon(),style:t})};i._determineIcon=function(){var e=i.props.presence;if(e!==u.PersonaPresence.none){var t=u.PersonaPresence[e];switch(t){case"online":t="SkypeCheck";break;case"away":t="SkypeClock";break;case"dnd":t="SkypeMinus";break;default:t=""}return t}};return i}e.prototype.render=function(){var e=this.props,t=e.coinSize,i=e.styles,o=e.presence,r=e.theme,n=h.sizeBoolean(this.props.size),a=!(n.isSize10||n.isSize16||n.isSize24||n.isSize28||n.isSize32)&&(!t||32<t),s=t?t/3<40?t/3+"px":"40px":"",l=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:s}:void 0,d=t?{width:s,height:s}:void 0,c=m(i,{theme:r,presence:o,size:this.props.size});return o===u.PersonaPresence.none?null:p.createElement("div",{className:c.presence,style:d},a&&this._onRenderIcon(c.presenceIcon,l))};return e}(o.BaseComponent);t.PersonaPresenceBase=n});define("office-ui-fabric-react/lib/components/Persona/Persona.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size28=7]="size28";e[e.size16=8]="size16";e[e.size10=9]="size10";e[e.size24=10]="size24";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size72=14]="size72";e[e.size100=15]="size100"}(t.PersonaSize||(t.PersonaSize={}));!function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent"}(t.PersonaInitialsColor||(t.PersonaInitialsColor={}))});define("office-ui-fabric-react/lib/components/Persona/PersonaConsts",["require","exports","./Persona.types"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.size10="20px";e.size16="16px";e.size24="24px";e.size28="28px";e.size32="32px";e.size40="40px";e.size48="48px";e.size72="72px";e.size100="100px"}(t.personaSize||(t.personaSize={}));!function(e){e.size6="6px";e.size8="8px";e.size12="12px";e.size20="20px";e.size28="28px";e.border="2px"}(t.personaPresenceSize||(t.personaPresenceSize={}));t.sizeBoolean=function(e){return{isSize10:e===i.PersonaSize.size10||e===i.PersonaSize.tiny,isSize16:e===i.PersonaSize.size16,isSize24:e===i.PersonaSize.size24||e===i.PersonaSize.extraExtraSmall,isSize28:e===i.PersonaSize.size28||e===i.PersonaSize.extraSmall,isSize32:e===i.PersonaSize.size32,isSize40:e===i.PersonaSize.size40||e===i.PersonaSize.small,isSize48:e===i.PersonaSize.size48,isSize72:e===i.PersonaSize.size72||e===i.PersonaSize.large,isSize100:e===i.PersonaSize.size100||e===i.PersonaSize.extraLarge}};t.presenceBoolean=function(e){return{isAvailable:e===i.PersonaPresence.online,isAway:e===i.PersonaPresence.away,isBlocked:e===i.PersonaPresence.blocked,isBusy:e===i.PersonaPresence.busy,isDoNotDisturb:e===i.PersonaPresence.dnd,isOffline:e===i.PersonaPresence.offline}}});define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence.styles",["require","exports","../../../Styling","../PersonaConsts"],function(e,t,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};t.getStyles=function(e){var t,i,o,r,n,a=e.theme,s=a.semanticColors,l=u.getGlobalClassNames(m,a),d=h.sizeBoolean(e.size),c=h.presenceBoolean(e.presence),p="#D93B3B";return{presence:[l.presence,{position:"absolute",height:h.personaPresenceSize.size12,width:h.personaPresenceSize.size12,borderRadius:"50%",top:"auto",right:"-"+h.personaPresenceSize.border,bottom:"-"+h.personaPresenceSize.border,border:h.personaPresenceSize.border+" solid "+s.bodyBackground,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box",MsHighContrastAdjust:"none",selectors:(t={},t[u.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)},d.isSize10&&{right:"auto",top:"7px",left:0,border:0,selectors:(i={},i[u.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},i)},(d.isSize10||d.isSize24||d.isSize28||d.isSize32)&&{height:h.personaPresenceSize.size8,width:h.personaPresenceSize.size8},d.isSize16&&{height:h.personaPresenceSize.size6,width:h.personaPresenceSize.size6,borderWidth:"1.5px"},d.isSize72&&{height:h.personaPresenceSize.size20,width:h.personaPresenceSize.size20},d.isSize100&&{height:h.personaPresenceSize.size28,width:h.personaPresenceSize.size28},c.isAvailable&&{backgroundColor:"#7FBA00",selectors:(o={},o[u.HighContrastSelector]={backgroundColor:"Highlight"},o)},c.isAway&&{backgroundColor:"#FCD116"},c.isBlocked&&[{backgroundColor:s.bodyBackground,selectors:(r={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:h.personaPresenceSize.border+" solid "+p,borderRadius:"50%",boxSizing:"border-box"},":after":d.isSize40||d.isSize48||d.isSize72||d.isSize100?{content:'""',width:"100%",height:h.personaPresenceSize.border,backgroundColor:p,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},r[u.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - "+h.personaPresenceSize.border+")",height:"calc(100% - "+h.personaPresenceSize.border+")",top:parseFloat(h.personaPresenceSize.border)/2+"px",left:parseFloat(h.personaPresenceSize.border)/2+"px",borderColor:"Window"},":after":{width:"calc(100% - "+2*parseFloat(h.personaPresenceSize.border)+"px)",left:h.personaPresenceSize.border,backgroundColor:"Window"}}},r)}],c.isBusy&&{backgroundColor:p},c.isDoNotDisturb&&{backgroundColor:"#E81123"},c.isOffline&&{backgroundColor:"#93ABBD"}],presenceIcon:[l.presenceIcon,{color:s.bodyBackground,fontSize:"6px",lineHeight:h.personaPresenceSize.size12,verticalAlign:"top",selectors:(n={},n[u.HighContrastSelector]={color:"Window"},n)},d.isSize72&&{fontSize:u.FontSizes.small,lineHeight:h.personaPresenceSize.size20},d.isSize100&&{fontSize:u.FontSizes.medium,lineHeight:h.personaPresenceSize.size28},c.isAway&&{position:"relative",left:"1px"}]}}});define("office-ui-fabric-react/lib/components/Persona/PersonaInitialsColor",["require","exports","./Persona.types"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=[a.PersonaInitialsColor.lightGreen,a.PersonaInitialsColor.lightBlue,a.PersonaInitialsColor.lightPink,a.PersonaInitialsColor.green,a.PersonaInitialsColor.darkGreen,a.PersonaInitialsColor.pink,a.PersonaInitialsColor.magenta,a.PersonaInitialsColor.purple,a.PersonaInitialsColor.black,a.PersonaInitialsColor.teal,a.PersonaInitialsColor.blue,a.PersonaInitialsColor.darkBlue,a.PersonaInitialsColor.orange,a.PersonaInitialsColor.darkRed],l=s.length;t.initialsColorPropToColorCode=function(e){var t=e.primaryText,i=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case a.PersonaInitialsColor.lightBlue:return"#6BA5E7";case a.PersonaInitialsColor.blue:return"#2D89EF";case a.PersonaInitialsColor.darkBlue:return"#2B5797";case a.PersonaInitialsColor.teal:return"#00ABA9";case a.PersonaInitialsColor.lightGreen:return"#99B433";case a.PersonaInitialsColor.green:return"#00A300";case a.PersonaInitialsColor.darkGreen:return"#1E7145";case a.PersonaInitialsColor.lightPink:return"#E773BD";case a.PersonaInitialsColor.pink:return"#FF0097";case a.PersonaInitialsColor.magenta:return"#7E3878";case a.PersonaInitialsColor.purple:return"#603CBA";case a.PersonaInitialsColor.black:return"#1D1D1D";case a.PersonaInitialsColor.orange:return"#DA532C";case a.PersonaInitialsColor.red:return"#EE1111";case a.PersonaInitialsColor.darkRed:return"#B91D47";case a.PersonaInitialsColor.transparent:return"transparent"}}(o=void 0!==o?o:function(e){var t=a.PersonaInitialsColor.blue;if(!e)return t;for(var i=0,o=e.length-1;0<=o;o--){var r=e.charCodeAt(o),n=o%8;i^=(r<<n)+(r>>8-n)}return t=s[i%l]}(i||t))}});define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin.styles",["require","exports","../../../Styling","../PersonaConsts"],function(e,t,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size72:"ms-Persona--size72",size100:"ms-Persona--size100"};t.getStyles=function(e){var t,i=e.className,o=e.theme,r=o.palette,n=c.sizeBoolean(e.size),a=d.getGlobalClassNames(p,o),s=r.neutralLight,l=r.redDark;return{coin:[a.coin,o.fonts.medium,n.isSize10&&a.size10,n.isSize16&&a.size16,n.isSize24&&a.size24,n.isSize28&&a.size28,n.isSize32&&a.size32,n.isSize40&&a.size40,n.isSize48&&a.size48,n.isSize72&&a.size72,n.isSize100&&a.size100,i],size10WithoutPresenceIcon:{fontSize:"10px",position:"absolute",top:"5px",right:"auto",left:0},imageArea:[a.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:c.personaSize.size48,width:c.personaSize.size48},n.isSize10&&{overflow:"visible",background:"transparent",height:0,width:0},n.isSize16&&{height:c.personaSize.size16,width:c.personaSize.size16},n.isSize24&&{height:c.personaSize.size24,width:c.personaSize.size24},n.isSize28&&{height:c.personaSize.size28,width:c.personaSize.size28},n.isSize32&&{height:c.personaSize.size32,width:c.personaSize.size32},n.isSize40&&{height:c.personaSize.size40,width:c.personaSize.size40},n.isSize72&&{height:c.personaSize.size72,width:c.personaSize.size72},n.isSize100&&{height:c.personaSize.size100,width:c.personaSize.size100}],image:[a.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},n.isSize10&&{overflow:"visible",background:"transparent",height:0,width:0},n.isSize16&&{height:c.personaSize.size16,width:c.personaSize.size16},n.isSize24&&{height:c.personaSize.size24,width:c.personaSize.size24},n.isSize28&&{height:c.personaSize.size28,width:c.personaSize.size28},n.isSize32&&{height:c.personaSize.size32,width:c.personaSize.size32},n.isSize40&&{height:c.personaSize.size40,width:c.personaSize.size40},n.isSize72&&{height:c.personaSize.size72,width:c.personaSize.size72},n.isSize100&&{height:c.personaSize.size100,width:c.personaSize.size100}],initials:[a.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?l:r.white,fontSize:d.FontSizes.large,fontWeight:d.FontWeights.regular,lineHeight:"46px",height:c.personaSize.size48,selectors:(t={},t[d.HighContrastSelector]={border:"1px solid WindowText",MsHighContrastAdjust:"none",color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"},t)},e.showUnknownPersonaCoin&&{backgroundColor:s},(n.isSize16||n.isSize24||n.isSize28)&&{fontSize:d.FontSizes.xSmall},n.isSize16&&{height:c.personaSize.size16,lineHeight:c.personaSize.size16},n.isSize24&&{height:c.personaSize.size24,lineHeight:c.personaSize.size24},n.isSize28&&{height:c.personaSize.size28,lineHeight:c.personaSize.size28},(n.isSize32||n.isSize40)&&{fontSize:d.FontSizes.medium},n.isSize32&&{height:c.personaSize.size32,lineHeight:c.personaSize.size32},n.isSize40&&{height:c.personaSize.size40,lineHeight:c.personaSize.size40},n.isSize72&&{fontSize:d.FontSizes.xxLarge,height:c.personaSize.size72,lineHeight:c.personaSize.size72},n.isSize100&&{fontSize:d.FontSizes.superLarge,height:c.personaSize.size100,lineHeight:c.personaSize.size100}]}}});define("office-ui-fabric-react/lib/components/Persona/Persona.styles",["require","exports","../../Styling","./PersonaConsts"],function(e,t,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:"ms-Persona",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size72:"ms-Persona--size72",size100:"ms-Persona--size100",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};t.getStyles=function(e){var t=e.className,i=e.showSecondaryText,o=e.theme,r=o.palette,n=c.getGlobalClassNames(u,o),a=p.sizeBoolean(e.size),s=p.presenceBoolean(e.presence),l="16px",d={color:r.neutralSecondary,fontWeight:c.FontWeights.regular,fontSize:c.FontSizes.small};return{root:[n.root,o.fonts.medium,c.normalize,{color:r.neutralPrimary,fontSize:c.FontSizes.medium,fontWeight:c.FontWeights.regular,position:"relative",height:p.personaSize.size48,minWidth:p.personaSize.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"},":hover":{selectors:{$primaryText:{color:r.neutralDark}}}}},a.isSize10&&[n.size10,{height:p.personaSize.size10,minWidth:p.personaSize.size10}],a.isSize16&&[n.size16,{height:p.personaSize.size16,minWidth:p.personaSize.size16}],a.isSize24&&[n.size24,{height:p.personaSize.size24,minWidth:p.personaSize.size24}],a.isSize24&&i&&{height:"36px"},a.isSize28&&[n.size28,{height:p.personaSize.size28,minWidth:p.personaSize.size28}],a.isSize28&&i&&{height:"32px"},a.isSize32&&[n.size32,{height:p.personaSize.size32,minWidth:p.personaSize.size32}],a.isSize40&&[n.size40,{height:p.personaSize.size40,minWidth:p.personaSize.size40}],a.isSize48&&n.size48,a.isSize72&&[n.size72,{height:p.personaSize.size72,minWidth:p.personaSize.size72}],a.isSize100&&[n.size100,{height:p.personaSize.size100,minWidth:p.personaSize.size100}],s.isAvailable&&n.available,s.isAway&&n.away,s.isBlocked&&n.blocked,s.isBusy&&n.busy,s.isDoNotDisturb&&n.doNotDisturb,s.isOffline&&n.offline,t],details:[n.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},a.isSize10&&{paddingLeft:"17px"},(a.isSize24||a.isSize28)&&{padding:"0 12px"}],primaryText:[n.primaryText,c.noWrap,{color:r.neutralPrimary,fontWeight:c.FontWeights.regular,fontSize:c.FontSizes.large},i&&{height:l,lineHeight:l,overflowX:"hidden"},a.isSize10&&{fontSize:c.FontSizes.small,lineHeight:p.personaSize.size10},(a.isSize16||a.isSize24||a.isSize28||a.isSize32||a.isSize40)&&{fontSize:c.FontSizes.medium},a.isSize16&&{lineHeight:p.personaSize.size28},a.isSize24&&i&&{height:"18px"},a.isSize72&&{fontSize:c.FontSizes.xLarge},a.isSize100&&{fontSize:c.FontSizes.xLarge,fontWeight:c.FontWeights.semilight}],secondaryText:[n.secondaryText,c.noWrap,d,(a.isSize10||a.isSize16||a.isSize24||a.isSize28||a.isSize32)&&{display:"none"},a.isSize24&&i&&{height:"18px"},(a.isSize72||a.isSize100)&&{fontSize:c.FontSizes.medium},i&&{display:"block",height:l,lineHeight:l,overflowX:"hidden"}],tertiaryText:[n.tertiaryText,c.noWrap,d,{display:"none"},(a.isSize72||a.isSize100)&&{display:"block"}],optionalText:[n.optionalText,c.noWrap,d,{display:"none"},a.isSize100&&{display:"block"}],textContent:[n.textContent,c.noWrap]}}});define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/index",["require","exports","tslib","./PersonaCoin","./PersonaCoin.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PickerItemsDefault.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".personaContainer_27aff86c{border-radius:15px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px 2px;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;max-width:300px;vertical-align:middle}.personaContainer_27aff86c::-moz-focus-inner{border:0}.personaContainer_27aff86c{outline:transparent}.personaContainer_27aff86c{position:relative}.ms-Fabric--isFocusVisible .personaContainer_27aff86c:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.personaContainer_27aff86c:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.personaContainer_27aff86c:hover .removeButton_27aff86c{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.personaContainer_27aff86c.personaContainerIsSelected_27aff86c{background:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.personaContainer_27aff86c.personaContainerIsSelected_27aff86c .ms-Persona-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_27aff86c.personaContainerIsSelected_27aff86c .ms-Persona-primaryText{color:HighlightText}}.personaContainer_27aff86c.personaContainerIsSelected_27aff86c .removeButton_27aff86c .ms-Button-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_27aff86c.personaContainerIsSelected_27aff86c .removeButton_27aff86c .ms-Button-icon{color:HighlightText}}.personaContainer_27aff86c.personaContainerIsSelected_27aff86c .removeButton_27aff86c:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_27aff86c.personaContainerIsSelected_27aff86c{border-color:Highlight;background:Highlight;-ms-high-contrast-adjust:none}}.personaContainer_27aff86c.validationError_27aff86c .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";border-bottom:2px dotted "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.personaContainer_27aff86c.validationError_27aff86c .ms-Persona-initials{font-size:20px}.personaContainer_27aff86c.validationError_27aff86c.personaContainerIsSelected_27aff86c{background:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.personaContainer_27aff86c.validationError_27aff86c.personaContainerIsSelected_27aff86c .ms-Persona-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:2px dotted "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.personaContainer_27aff86c.validationError_27aff86c.personaContainerIsSelected_27aff86c .removeButton_27aff86c:hover{background:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_27aff86c{border:1px solid WindowText}}.personaContainer_27aff86c .itemContent_27aff86c{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:0px;max-width:100%;overflow:hidden}.personaContainer_27aff86c .removeButton_27aff86c{border-radius:15px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;width:28px;height:28px;-ms-flex-preferred-size:28px;flex-basis:28px}.personaContainer_27aff86c .removeButton_27aff86c:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.personaContainer_27aff86c .personaDetails_27aff86c{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto}.itemContainer_27aff86c{display:inline-block;vertical-align:top}\n"}]);t.personaContainer="personaContainer_27aff86c";t.removeButton="removeButton_27aff86c";t.personaContainerIsSelected="personaContainerIsSelected_27aff86c";t.validationError="validationError_27aff86c";t.itemContent="itemContent_27aff86c";t.personaDetails="personaDetails_27aff86c";t.itemContainer="itemContainer_27aff86c"});define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/SuggestionItemDefault",["require","exports","tslib","react","../../../../Utilities","../../../../Persona","../PeoplePicker.scss"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a;t.SuggestionItemNormal=function(e,t){return o.createElement("div",{className:r.css("ms-PeoplePicker-personaContent",s.peoplePickerPersonaContent)},o.createElement(n.Persona,i.__assign({presence:void 0!==e.presence?e.presence:n.PersonaPresence.none,size:n.PersonaSize.size24,className:r.css("ms-PeoplePicker-Persona",s.peoplePickerPersona),showSecondaryText:!0},e)))};t.SuggestionItemSmall=function(e,t){return o.createElement("div",{className:r.css("ms-PeoplePicker-personaContent",s.peoplePickerPersonaContent)},o.createElement(n.Persona,i.__assign({presence:void 0!==e.presence?e.presence:n.PersonaPresence.none,size:n.PersonaSize.size24,className:r.css("ms-PeoplePicker-Persona",s.peoplePickerPersona)},e)))}});define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".resultContent_33cbf444{display:table-row}.resultContent_33cbf444 .resultItem_33cbf444{display:table-cell;vertical-align:bottom}.peoplePickerPersona_33cbf444{width:180px}.peoplePickerPersona_33cbf444 .ms-Persona-details{width:100%}.peoplePicker_33cbf444 .ms-BasePicker-text{min-height:40px}.peoplePickerPersonaContent_33cbf444{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:7px 12px}\n"}]);t.resultContent="resultContent_33cbf444";t.resultItem="resultItem_33cbf444";t.peoplePickerPersona="peoplePickerPersona_33cbf444";t.peoplePicker="peoplePicker_33cbf444";t.peoplePickerPersonaContent="peoplePickerPersonaContent_33cbf444"});define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagPicker",["require","exports","tslib","react","../../../Utilities","../BasePicker","./TagItem","./TagItem.scss"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s,d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return o.createElement(a.TagItem,i.__assign({},e),e.item.name)},onRenderSuggestionsItem:function(e){return o.createElement("div",{className:r.css("ms-TagItem-TextOverflow",l.tagItemTextOverflow)}," ",e.name," ")}};return t}(n.BasePicker);t.TagPicker=d});define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItem",["require","exports","react","../../../Utilities","../../../Icon","./TagItem.scss"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n;t.TagItem=function(e){return i.createElement("div",{className:o.css("ms-TagItem",a.root,{"is-selected":e.selected},e.selected&&a.isSelected),role:"listitem",key:e.index,"data-selection-index":e.index,"data-is-focusable":(e.enableTagFocusInDisabledPicker||!e.disabled)&&!0},i.createElement("span",{className:o.css("ms-TagItem-text",a.tagItemText),"aria-label":e.children},e.children),!e.disabled&&i.createElement("span",{className:o.css("ms-TagItem-close",a.tagItemClose),onClick:e.onRemoveItem},i.createElement(r.Icon,{iconName:"Cancel"})))}});define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItem.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_bd7a3c97{-webkit-box-sizing:content-box;box-sizing:content-box;-ms-flex-negative:1;flex-shrink:1;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:2px;height:26px;line-height:26px;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;max-width:300px}.root_bd7a3c97::-moz-focus-inner{border:0}.root_bd7a3c97{outline:transparent}.root_bd7a3c97{position:relative}.ms-Fabric--isFocusVisible .root_bd7a3c97:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.root_bd7a3c97:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.root_bd7a3c97.isSelected_bd7a3c97{background:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_bd7a3c97.isSelected_bd7a3c97{border:1px solid WindowFrame}}.root_bd7a3c97.isSelected_bd7a3c97:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_bd7a3c97{border:1px solid WindowText}}.tagItemText_bd7a3c97{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:30px;margin:0 8px}.tagItemClose_bd7a3c97{cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;display:inline-block;text-align:center;vertical-align:top;width:30px;height:100%;-ms-flex-negative:0;flex-shrink:0}.tagItemButton_bd7a3c97{width:100%;height:100%}.tagItemTextOverflow_bd7a3c97{overflow:hidden;text-overflow:ellipsis;max-width:60vw;padding:7px 12px}\n"}]);t.root="root_bd7a3c97";t.isSelected="isSelected_bd7a3c97";t.tagItemText="tagItemText_bd7a3c97";t.tagItemClose="tagItemClose_bd7a3c97";t.tagItemButton="tagItemButton_bd7a3c97";t.tagItemTextOverflow="tagItemTextOverflow_bd7a3c97"});define("@ms/odsp-datasources/lib/PeoplePicker",["require","exports","tslib","./dataSources/peoplePicker/spo/PeoplePickerDataSource","./dataSources/peoplePicker/IPerson","./dataSources/peoplePicker/IPresenceType","./providers/peoplePicker/odb/PeoplePickerProvider"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t)});define("@ms/odsp-datasources/lib/dataSources/peoplePicker/spo/PeoplePickerDataSource",["require","exports","tslib","../../../utilities/url/ApiUrlHelper","../../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/features/FeatureOverrides","../../base/DataSource","../../roleAssignments/PrincipalType","../../../utilities/url/ItemUrlHelper","@ms/odsp-graph/lib/models/error/Error","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/string/EmailAddressParser"],function(e,a,t,s,l,c,i,h,d,p,u,m,o){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.PeoplePickerGraph={ODB:387};a.DisablePeoplePickerGraphExperiment={ODB:776};a.EnablePeoplePickerGraphDLErrorExperiment={ODB:779};var r=function(n){t.__extends(e,n);function e(e,t){var i=this,o=g(e)?e:t.pageContext;i=n.call(this,{},{pageContext:o})||this;var r=g(e)?e.apiUrlHelper:t.apiUrlHelper;i._imageAbsoluteWebUrl=e.imageAbsoluteWebUrl||"";i._apiUrlHelper=r||new s.ApiUrlHelper({},{itemUrlHelper:new d.ItemUrlHelper({},{pageContext:o}),pageContext:o});i._capabilities={supportsMruCaching:!0};if(t){i._dataRequestor=t.dataRequestor;i._graphPeoplePickerHelper=t.graphPeoplePickerHelper}return i}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getPersonaDetails=function(e){var r=this;return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",parseResponse:function(e){var t=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},i=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,o={personDetails:t(i.Primary),managerChain:i.ManagerChain.results.map(t),directReports:i.DirectReports.results.map(t)};o.personDetails.profilePage=l.getServerUrl(r._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(o.personDetails.sip)+"&origin=ProfileODBCard";return o}})};e.prototype.getPickerEntityInformation=function(t){var e=0;t.principalType===h.default.sharePointGroup&&(e=Number(t.rawPersonData.EntityData.SPGroupID));var i=JSON.stringify({entityInformationRequest:{PrincipalType:t.principalType,EmailAddress:t.email,GroupId:e}});return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:i,qosName:"getPickerEntityInformation",noRedirect:!0,parseResponse:function(e){return{totalMemberCount:JSON.parse(e).d.TotalMemberCount,person:t}}})};e.prototype.resolve=function(e,n){var a=this;return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:this._constructPostBody(e,n),qosName:"Resolve",parseResponse:function(e){var t=JSON.parse(e),i=JSON.parse(t.d.ClientPeoplePickerResolveUser),o=[];o[0]=i;m.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(o[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=i.Key);var r=(o=a._transformData(o,n.filterExternalUsers))[0];if(n.filterExternalUsers&&r&&1===r.entityType){r.isResolved=!1;r.entityType=0}else if(n.blockViaPolicy&&!n.filterExternalUsers&&r&&!r.isResolved&&0===r.multipleMatches.length){r.isResolved=!0;r.isExternal=!0;r.entityType=1}if(n.isGraphDistributionList&&n.useGraph&&r.isExternal){r.entityType=2;r.principalType=h.default.distributionList}return r}})};e.prototype.search=function(e,t){return t.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph()?this._graphSearch(e,t):this.sharePointSearch(e,t)};e.prototype.sharePointSearch=function(c,p){var u=this;p.onToggleGetMoreResults&&p.onToggleGetMoreResults(!1);return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:this._constructPostBody(c,p),qosName:"Search",parseResponse:function(e){var t=p.allowSharePointGroups,i=void 0===t||t,o=p.filterExternalUsers,r=p.forceResolve,n=JSON.parse(e),a=JSON.parse(n.d.ClientPeoplePickerSearchUser),s=u._transformData(a,o);o&&(s=s.filter(function(e){return 1!==e.entityType}));var l=!s.length;s=s.filter(function(e){return e.principalType===h.default.sharePointGroup?i:e.principalType===h.default.securityGroup?i||u._isValidEmail(e.email,!0):u._isValidEmail(e.email,!1)});if(m.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))r&&l&&s.push({name:c,userId:c,email:c});else if(0===s.length&&u._isValidEmail(c,!1)){var d={Key:c,IsResolved:!1};s.push({email:c,entityType:1,isResolved:!0,job:c,name:c,userId:c,rawData:d,rawPersonData:d,isExternal:!0})}return s}})};e.prototype.subscribePresence=function(e,t){var i=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var o=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,o);return{dispose:function(){try{i._skypeIntegration.UntrackPresence(e,o)}catch(e){}}}}catch(e){}return null};e.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};e.prototype._constructPostBody=function(e,t){var i={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(i)};e.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};e.prototype._graphSearch=function(o,r){var d=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(e){if(!e)return d.sharePointSearch(o,r);var t='https://graph.microsoft.com/v1.0/me/people?$search="'+o+'"&$top=30&$select=displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName',i=!1;if(c.default.isFeatureEnabled(a.EnablePeoplePickerGraphDLErrorExperiment)){i=new u.ABExperiment({name:"FilterPublicDistributionLists",startDate:"02/15/2018"}).IsExperimentOn()}i||(t+="&$filter=personType/subclass ne 'PublicDistributionList'");return d._dataRequestor.send({apiName:"Graph.PeopleSearch",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1}).then(function(e){r.onToggleGetMoreResults&&r.onToggleGetMoreResults(!0);var t=e.value,l=[];t.forEach(function(e){var t=d._transformToSharePointRawPerson(e),i=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",o="ImplicitContact"===e.personType.subclass,r="OrganizationUser"===e.personType.subclass,n="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,a="PublicDistributionList"===e.personType.subclass,s={department:e.department,email:i,image:o?void 0:"/_layouts/15/userphoto.aspx?size=S&accountname="+i,job:e.jobTitle||i,name:e.displayName,providerName:r?"Provider":void 0,userId:e.userPrincipalName||i,rawData:t,rawPersonData:t,isExternal:!r};if(r){s.entityType=0;s.principalType=h.default.user;s.isResolved=!0}else if(n){s.entityType=2;s.principalType=h.default.sharePointGroup;s.isResolved=!1}else{s.principalType=a?h.default.distributionList:h.default.none;s.entityType="Group"===e.personType.class?2:1;s.isResolved=!1;s.providerName=void 0}l.push(s)});if(0===l.length&&d._isValidEmail(o,!1)){var i={Key:o,IsResolved:!1};l.push({email:o,entityType:1,isResolved:!0,job:o,name:o,userId:o,rawData:i,rawPersonData:i,isExternal:!0})}return l},function(e){if(p.isGraphError(e))switch(e.status){case 401:case 403:case 404:d._graphPeoplePickerHelper.disableGraphCallsForPicker();return d.sharePointSearch(o,r);default:return null}return null})})};e.prototype._isValidEmail=function(e,t){if(!e)return!t;if(-1<e.indexOf(" ")||-1<e.indexOf(";"))return!1;if(m.Killswitch.isActivated("85cfc348-6fc6-4b40-9578-1e669e8aeab1","07/06/2018","t-jasm, more restrictive email validation.")){return/\S+@\S+\.\S+/.test(e)}return o.default.isValidEmailSyntax(e,!0)};e.prototype._transformData=function(e,n){var a=this;return e.map(function(e){var t=e.EntityData,i={name:e.DisplayText,email:t.Email,userId:e.Key,job:t.Title,department:t.Department,phone:t.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(0<i.multipleMatches.length){i.multipleMatches=a._transformData(i.multipleMatches,n);n&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var o=i.email;i.isResolved&&(i.image=o?a._imageAbsoluteWebUrl+"/_layouts/15/userphoto.aspx?size=S&accountname="+o:null);var r=t.PrincipalType||e.EntityType;switch(r){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=h.default.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===r?h.default.sharePointGroup:h.default.securityGroup;break;default:i.entityType=0;i.principalType=h.default.user}return i})};e.prototype._transformToSharePointRawPerson=function(e){return{Key:e.userPrincipalName,IsResolved:!1}};return e}(i.default);a.PeoplePickerDataSource=r;function g(e){return!!e.webAbsoluteUrl}});define("@ms/odsp-datasources/lib/utilities/url/ApiUrlHelper",["require","exports","tslib","./ItemUrlHelper","./ApiUrlHelperBasic","./ApiUrlHelperBasic"],function(e,t,l,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});l.__exportStar(o,t);var d=function(o){l.__extends(e,o);function e(e,t){var i=o.call(this,{webAbsoluteUrl:t.pageContext.webAbsoluteUrl})||this;i._pageContext=t.pageContext;i._itemUrlHelper=t.itemUrlHelper;return i}e.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};e.prototype.webByItemUrl=function(e){var t=e.siteRelation,i=e.isCrossDomain,o=e.fullItemUrl,r=this;(i||t===n.SiteRelation.crossSite)&&(r=r.method("SP.RemoteWeb",o));return r.segment("web")};e.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper})};return e}(i.ApiUrlBasic);t.ApiUrl=d;var r=function(s){l.__extends(e,s);function e(e,t){var i=s.call(this,{webAbsoluteUrl:t&&t.pageContext?t.pageContext.webAbsoluteUrl:""})||this,o=t.itemUrlHelper,r=t.pageContext,n=t.apiUrlType,a=void 0===n?function(e){l.__extends(t,e);function t(){return e.call(this,{},{itemUrlHelper:o,pageContext:r})||this}return t}(d):n;i._apiUrlType=a;return i}e.prototype.build=function(){return new this._apiUrlType};return e}(i.ApiUrlHelperBasic);t.ApiUrlHelper=r});define("@ms/odsp-datasources/lib/utilities/url/ApiUrlHelperBasic",["require","exports","tslib","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._webAbsoluteUrl=e.webAbsoluteUrl;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&"));t.push.apply(t,this._rawParameters);e=t.length?"?"+t.join("&"):"";var i=this._webUrl;return""+[void 0===i?this._webAbsoluteUrl:i,"_api"].concat(this._segments).join("/")+e};e.prototype.segment=function(e){return this._extend({segments:[e]})};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})};e.prototype.methodWithAliases=function(e,t){for(var i=this,o=[],r=0,n=Object.keys(t);r<n.length;r++){var a=n[r],s=t[a],l=i._autoParameter(s);i=l.apiUrl;o.push(a+"="+l.name)}return i.segment(e+"("+o.join(",")+")")};e.prototype.method=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var o=this,r=[],n=0,a=t;n<a.length;n++){var s=a[n],l=o._autoParameter(s);o=l.apiUrl;r.push(l.name)}return o.segment(e+"("+r.join(",")+")")};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=this,i=0,o=Object.keys(e);i<o.length;i++){var r=o[i],n=e[r];t=t.parameter(r,n)}return t};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})};e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,i="@a"+t;return{name:i,apiUrl:this._extend({lastParameterId:t})._parameter(i,e)}};e.prototype._parameter=function(e,t){var i,o,r,n;(n=t)&&"object"==typeof n&&"json"in n?i=a.default.encodeRestUriStringToken(JSON.stringify(t.json)):(r=t)&&"object"==typeof r&&"guid"in r?i="guid'"+t.guid+"'":i=(o=t)&&"object"==typeof o&&"raw"in o?t.raw:"number"==typeof t?""+t:"boolean"==typeof t?""+t:"'"+a.default.encodeRestUriStringToken(t)+"'";return this._extend({parameters:[{name:e,serializedValue:i}]})};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl})};e.prototype._extend=function(e){void 0===e&&(e={});var t,i,o,r,n,a,s=this.clone();s._webUrl=this._webUrl;s._lastParameterId=this._lastParameterId;(t=s._parameters).push.apply(t,this._parameters);(i=s._segments).push.apply(i,this._segments);(o=s._rawParameters).push.apply(o,this._rawParameters);"webUrl"in e&&(s._webUrl=e.webUrl);"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId);"parameters"in e&&(r=s._parameters).push.apply(r,e.parameters);"rawParameters"in e&&(n=s._rawParameters).push.apply(n,e.rawParameters);"segments"in e&&(a=s._segments).push.apply(a,e.segments);return s};return e}();t.ApiUrlBasic=r;var i=function(){function e(i){this._apiUrlType=function(e){o.__extends(t,e);function t(){return e.call(this,{webAbsoluteUrl:i.webAbsoluteUrl})||this}return t}(r)}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,i=e.indexOf("/_layouts/");if(-1<i)t=e.substring(0,i);else{var o=e.lastIndexOf("/"),r=e.lastIndexOf(".");t=o<r?e.substring(0,r)+"_"+e.substring(r+1):e}return t+"/_api/contextinfo"};return e}();t.ApiUrlHelperBasic=i});define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPerson",["require","exports","../roleAssignments/PrincipalType"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrincipalType=i.default;!function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application"}(t.EntityType||(t.EntityType={}))});define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPresenceType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unknown=0]="Unknown";e[e.Online=1]="Online";e[e.Busy=2]="Busy";e[e.DoNotDisturb=3]="DoNotDisturb";e[e.BeRightBack=4]="BeRightBack";e[e.Away=5]="Away";e[e.Offline=6]="Offline";e[e.Hidden=7]="Hidden"}(t.PresenceType||(t.PresenceType={}))});define("@ms/odsp-datasources/lib/providers/peoplePicker/odb/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/peoplePicker/spo/PeoplePickerDataSource","../../../models/store/PeopleStore"],function(e,t,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new o.PeoplePickerDataSource({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new a.PeopleStore;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,o){var r,n,a=this,t={cached:null,promise:null};this._mruCache&&!o.groupID&&0<(n=this.searchMruCache(e,o&&o.filterExternalUsers)).length&&(t.cached=n);t.promise=new i.default(function(i,t){r=a._dataSource.search(e,o).then(function(e){if(e)if(n){0<n.length&&(n=a._removeStaleCacheResults(n,e));var t=n.map(function(e){return e.userId});i(e.filter(function(e){return t.indexOf(e.userId)<0}))}else i(e)},function(e){t(e)})},function(){r&&r.cancel()});return t};e.prototype.resolve=function(e,t){var i=this;return this._dataSource.resolve(e,t).then(function(e){i._mruCache&&e.isResolved&&i.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.searchMruCache=function(e,t){var i=[],o=this._mruCache;if(o){i=o.getItems(e,t);var r=this.MaxCacheSuggestions;i.length>r&&(i=i.splice(0,r))}return i};e.prototype._removeStaleCacheResults=function(o,e){var r=o.map(function(e){return e.userId}),n=[];e.forEach(function(e){var t=r.indexOf(e.userId);if(-1<t){var i=o[t];a.PeopleStore.isCacheEntryFresh(i,e)&&n.push(i)}});return n};return e}();t.PeoplePickerProvider=r});define("@ms/odsp-datasources/lib/models/store/PeopleStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(r,i);function r(){var e=i.call(this,r._Key,r._DataStoreCachingType)||this;e._MaxItems=200;e._Version=5;e._buffer=e.getValue(r._StorageKey);e._buffer&&e._buffer.version===e._Version&&e._buffer.lastCachePrune||e.initializeBuffer();e._data={};if(Date.now()<e._buffer.lastCachePrune+6048e5||s.Killswitch.isActivated("e96e6a47-9f55-4ea4-8395-c9f48a655b2a","8/07/2018","PeopleStorePruning"))for(var t=0;t<e._buffer.dataArray.length;t++)e._data[e._buffer.dataArray[t].email]=e._buffer.dataArray[t];else{e.initializeBuffer();e.setValue(r._StorageKey,e._buffer)}return e}r.clear=function(){new n.default(r._Key,r._DataStoreCachingType).remove(r._StorageKey)};r.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};r.prototype.setItem=function(e){var t=this._data[e.email];if(t){if(r.isCacheEntryFresh(t,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var o=this._buffer.dataArray[this._buffer.index];delete this._data[o.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(r._StorageKey,this._buffer)};r.prototype.getItems=function(e,t){for(var i=[],o=0;o<this._buffer.dataArray.length;o++){var r=(this._buffer.index-o+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[r].email&&0<=this._buffer.dataArray[r].email.toLowerCase().indexOf(e.toLowerCase())||this._buffer.dataArray[r].name&&0<=this._buffer.dataArray[r].name.toLowerCase().indexOf(e.toLowerCase()))||t&&1===this._buffer.dataArray[r].entityType||i.push(this._buffer.dataArray[r])}return i};r.prototype.containsItem=function(e){return Boolean(this._data[e.email])};r.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};r._Key="ClientPeoplePicker";r._StorageKey="MRU";r._DataStoreCachingType=a.default.local;return r}(n.default);t.PeopleStore=i});define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePickerDefaultItems",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Utilities","./PickerItem.scss"],function(e,t,s,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e){return{primaryText:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt}}t.SuggestionItemDefault=function(e){var t=u(e);return l.createElement("div",{className:"ms-PeoplePicker-personaContent"},l.createElement(d.Persona,s.__assign({},t,{presence:d.PersonaPresence.none,size:d.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})))};t.SelectedItemDefault=function(e){var t=e.item,i=e.onRemoveItem,o=e.index,r=e.selected,n=e.removeButtonAriaLabel,a=u(t);return l.createElement("div",{className:p.css("ms-PickerPersona-container",{"is-selected":r}),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem"},l.createElement("div",{className:"ms-PickerItem-content"},l.createElement(d.Persona,s.__assign({},a,{presence:d.PersonaPresence.none,size:d.PersonaSize.extraSmall}))),l.createElement(c.IconButton,{onClick:function(){i&&i()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1,ariaLabel:n}))};t.SelectedItemBelowDefault=function(e){var t=e.item,i=e.onRemoveItem,o=e.index,r=e.selected,n=u(t);return l.createElement("div",{className:p.css("ms-PickerPersona-container is-listbelow",{"is-selected":r}),"data-is-focusable":!0,"data-selection-index":o,key:o},l.createElement("div",{className:"ms-PickerPersona-content"},l.createElement(d.Persona,s.__assign({},n,{presence:d.PersonaPresence.none,size:d.PersonaSize.small}))),l.createElement("div",{className:"ms-PickerItem-sideContent"},l.createElement(c.IconButton,{onClick:function(){i&&i()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))};t.SelectedItemBelowCustomMenu=function(e,t){var i=e.item,o=e.onRemoveItem,r=e.index,n=e.selected,a=u(i);return l.createElement("div",{className:p.css("ms-PickerPersona-container is-listbelow",{"is-selected":n}),"data-is-focusable":!0,"data-selection-index":r,key:r},l.createElement("div",{className:"ms-PickerPersona-content"},l.createElement(d.Persona,s.__assign({},a,{presence:d.PersonaPresence.none,size:d.PersonaSize.small}),t||null)),l.createElement("div",{className:"ms-PickerItem-sideContent"},l.createElement(c.IconButton,{onClick:function(){o&&o()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))}});define("@ms/odsp-shared-react/lib/components/PeoplePicker/PickerItem.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-PickerPersona-container{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-Fabric .ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-Fabric .ms-PickerPersona-container{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{border-color:#37006e}}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px}"}])});define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"}(t.PeoplePickerType||(t.PeoplePickerType={}))});define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-Suggestions{width:260px}"}])});define("@ms/odsp-shared-sharing/lib/utilities/ShareCommunicationManager",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/ShareHelper"],function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1;t.copyLinkShareTargetClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")};t.dismiss=function(){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")};t.shareCompleted=function(t){try{window.external.ShareCompleted(t)}catch(e){var i={name:"share_completed",shareType:t};window.parent.postMessage(JSON.stringify(i),"*")}};t.teamsClicked=function(e){try{window.external.SendLinkViaTeams(e.url)}catch(e){var t={name:"share_teamsClicked"};window.parent.postMessage(JSON.stringify(t),"*")}};t.grantAccessCompleted=function(t){try{window.external.GrantAccessCompleted(t)}catch(e){var i={name:"share_grantAccessCompleted",successful:t};window.parent.postMessage(JSON.stringify(i),"*")}};t.pageError=function(t){try{window.external.PageError(t.error,t.errorCategory,t.errorMessage,t.debugErrorMessage)}catch(e){var i={name:"share_error",error:t.error,errorCategory:t.errorCategory,errorMessage:t.errorMessage,debugErrorMessage:t.debugErrorMessage};window.parent.postMessage(JSON.stringify(i),"*")}};t.outlookClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")};t.pageFinishedLoading=function(e,t){if(!r){r=!0;new o.default({name:"ShareV3.PageFinishedLoading",startTimeOverride:window._sharingStartTime}).end({resultType:o.ResultTypeEnum.Success,extraData:{clientId:e,scenarioId:t}});try{window.external.PageFinishedLoading()}catch(e){var i={name:"share_ready"};window.parent.postMessage(JSON.stringify(i),"*")}}};t.readyForRecipients=function(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")};t.sendLinkClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")};t.peoplePickerFocused=function(){try{window.external.PeoplePickerFocused()}catch(e){var t={name:"share_peoplePickerFocused"};window.parent.postMessage(JSON.stringify(t),"*")}};t.linkSettingsCompleted=function(t,e,i){var o=a.getLinkIconUrl(t,i),r=a.getLinkLabel(t,e,i);try{window.external.LinkSettingsCompleted(t.shareId,t.url,o,r)}catch(e){var n={name:"share_linkSettingsCompleted",shareId:t.shareId,linkUrl:t.url,iconUrl:o,linkDescription:r};window.parent.postMessage(JSON.stringify(n),"*")}}});define("@ms/odsp-shared-sharing/lib/components/PeoplePicker/PeoplePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePicker-wrapper{max-height:150px;overflow-y:auto}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:13px;font-weight:400}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-error{font-size:12px;font-weight:400;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";background-color:RGBA("},{theme:"error",defaultValue:"#a80000"},{rawString:", .06);font:-apple-system-caption2}"}])});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PreventDownload/PreventDownload",["require","exports","tslib","react","office-ui-fabric-react/lib/Toggle","office-ui-fabric-react/lib/Icon","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../Share.resx","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","./PreventDownload.scss"],function(e,t,i,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={preventDownloadToggle:!1};i._onChanged=i._onChanged.bind(i);return i}e.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled;this.props.detailsPane&&(t=!0);return r.createElement("div",{className:"od-PreventDownloadToggle"},r.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},r.createElement(a.Icon,{iconName:"Blocked2"})),r.createElement(n.Toggle,{checked:t,disabled:e,label:l.default.preventDownloadLabel,onChanged:this._onChanged}),!this.props.detailsPane&&this.props.disablePreventDownload&&r.createElement(d.TooltipHost,{hostClassName:"od-preventDownload-tooltip",content:c.format(l.default.preventDownloadInfoIcon,l.default.allowEditLabel),directionalHint:1,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(a.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info"})))};e.prototype._onChanged=function(e){var t=this;s.Engagement.logData({name:"PreventDownload.ToggleChanged",isIntentional:!0});this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})};return e}(r.Component);t.PreventDownload=o});define("office-ui-fabric-react/lib/Toggle",["require","exports","tslib","./components/Toggle/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Toggle/index",["require","exports","tslib","./Toggle","./Toggle.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Toggle/Toggle",["require","exports","../../Utilities","./Toggle.base","./Toggle.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Toggle=i.styled(o.ToggleBase,r.getStyles,void 0,{scope:"Toggle"})});define("office-ui-fabric-react/lib/components/Toggle/Toggle.base",["require","exports","tslib","react","../../Utilities","../../Label","../../KeytipData"],function(e,t,x,_,S,k,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=S.classNamesFunction(),i=function(t){x.__extends(e,t);function e(e){var s=t.call(this,e)||this;s._toggleButton=S.createRef();s._onClick=function(e){var t=s.props,i=t.disabled,o=t.checked,r=t.onChanged,n=t.onClick,a=s.state.checked;if(!i){void 0===o&&s.setState({checked:!a});r&&r(!a);n&&n(e)}};s._warnMutuallyExclusive({checked:"defaultChecked"});s._warnDeprecations({onAriaLabel:"ariaLabel",offAriaLabel:void 0});s.state={checked:!(!e.checked&&!e.defaultChecked)};s._id=e.id||S.getId("Toggle");return s}Object.defineProperty(e.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0});e.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({checked:!!e.checked})};e.prototype.render=function(){var t=this,e=this.props,i=e.as,o=void 0===i?"div":i,r=e.className,n=e.theme,a=e.disabled,s=e.keytipProps,l=e.label,d=e.ariaLabel,c=e.onAriaLabel,p=e.offAriaLabel,u=e.offText,h=e.onText,m=e.styles,g=this.state.checked,f=g?h:u,b=g?c:p,y=S.getNativeProps(this.props,S.inputProperties,["defaultChecked"]),v=w(m,{theme:n,className:r,disabled:a,checked:g});return _.createElement(o,{className:v.root},l&&_.createElement(k.Label,{htmlFor:this._id,className:v.label},l),_.createElement("div",{className:v.container},_.createElement(P.KeytipData,{keytipProps:s,ariaDescribedBy:y["aria-describedby"],disabled:a},function(e){return _.createElement("button",x.__assign({},y,e,{className:v.pill,disabled:a,id:t._id,type:"button",role:"switch",ref:t._toggleButton,"aria-disabled":a,"aria-checked":g,"aria-label":d||b,"data-is-focusable":!0,onChange:t._noop,onClick:t._onClick}),_.createElement("div",{className:v.thumb}))}),f&&_.createElement(k.Label,{className:v.text},f)))};e.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()};e.prototype._noop=function(){};return e}(S.BaseComponent);t.ToggleBase=i});define("office-ui-fabric-react/lib/components/Toggle/Toggle.styles",["require","exports","../../Styling"],function(e,t,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i,o,r,n,a,s,l=e.theme,d=e.className,c=e.disabled,p=e.checked,u=l.semanticColors,h=u.bodyBackground,m=u.inputBackgroundChecked,g=u.inputBackgroundCheckedHovered,f=u.disabledBodyText,b=u.inputBorderHovered,y=u.inputForegroundChecked,v=u.disabledBodyText,x=u.disabledBackground,_=u.smallInputBorder,S=u.inputBorderHovered,k=u.disabledBodyText,P=u.disabledText;return{root:["ms-Toggle",p&&"is-checked",!c&&"is-enabled",c&&"is-disabled",l.fonts.medium,{marginBottom:"8px"},d],label:["ms-Toggle-label",c&&{color:P,selectors:(t={},t[w.HighContrastSelector]={color:"GrayText"},t)}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"}],pill:["ms-Toggle-background",w.getFocusStyle(l,-3),{fontSize:"20px",boxSizing:"border-box",width:"2.2em",height:"1em",borderRadius:"1em",transition:"all 0.1s ease",borderWidth:"1px",borderStyle:"solid",background:h,borderColor:_,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 .2em"},!c&&[!p&&{selectors:{":hover":[{borderColor:S}],":hover .ms-Toggle-thumb":[{selectors:(i={},i[w.HighContrastSelector]={borderColor:"Highlight"},i)}]}},p&&[{background:m,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(o={":hover":[{backgroundColor:g,borderColor:"transparent",selectors:(r={},r[w.HighContrastSelector]={backgroundColor:"Highlight"},r)}]},o[w.HighContrastSelector]={backgroundColor:"WindowText"},o)}]],c&&[{cursor:"default"},!p&&[{borderColor:k}],p&&[{backgroundColor:f,borderColor:"transparent",justifyContent:"flex-end"}]],!c&&{selectors:{"&:hover":{selectors:(n={},n[w.HighContrastSelector]={borderColor:"Highlight"},n)}}}],thumb:["ms-Toggle-thumb",{width:".5em",height:".5em",borderRadius:".5em",transition:"all 0.1s ease",backgroundColor:b,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},!c&&p&&[{backgroundColor:y,selectors:(a={},a[w.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},a)}],c&&[!p&&[{backgroundColor:v}],p&&[{backgroundColor:x}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 10px",userSelect:"none"}}},c&&{selectors:{"&&":{color:P,selectors:(s={},s[w.HighContrastSelector]={color:"GrayText"},s)}}}]}}});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PreventDownload/PreventDownload.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:-ms-flexbox;display:flex;line-height:32px}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:6px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 60px)}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 8px 0 4px}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px}[dir=ltr] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir=rtl] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}"}])});define("@ms/odsp-shared-sharing/lib/utilities/EngagementHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","../interfaces/SharingInterfaces"],function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.opened=function(e){this._log("Opened",e)};t.linkSettingsOpened=function(e){this._log("LinkSettings.Opened",e)};t.linkSettingsApplyClicked=function(e){this._log("LinkSettings.ApplyClicked",e)};t.linkSettingsCancelClicked=function(e){this._log("LinkSettings.CancelClicked",e)};t.linkSettingsLearnMoreClicked=function(e){this._log("LinkSettings.LearnMoreClicked",e)};t.manageAccessOpened=function(e){this._log("ManageAccess.Opened",e)};t.shareCompleted=function(e){this._log("Completed",e)};t.sendACopyClicked=function(e){this._log("SendACopy.Clicked",e)};t.sendACopyOfficeClicked=function(e){this._log("SendACopy.OfficeClicked",e)};t.sendACopyPdfClicked=function(e){this._log("SendACopy.PdfClicked",e)};t.whoElseHasAccessClicked=function(e){this._log("WhoElseHasAccess.Clicked",e)};t.shareTargets=function(e){this._log("ShareTargets",e)};t.trackClickThru=function(e){this._log("ClickThruTracker",e)};t.externalSharingCslError=function(e){this._log("externalSharingCslError",e)};t._log=function(e,t){var i={name:"ShareV3."+e,extraData:o.__assign({},t,{clientId:n.ClientId[t.clientId],scenarioId:t.scenarioId,mode:n.Mode[t.mode],shareType:n.ShareType[t.shareType],audience:t.audience,shareTargets:this._getFriendlyShareTargets(t.shareTargets)})};r.Engagement.logData(i)};t._getFriendlyShareTargets=function(e){var t=[];if(e)for(var i=0,o=e;i<o.length;i++){var r=o[i];t.push(n.ShareType[r])}return t}});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PermissionsSettings/PermissionsSettings.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:20px;height:20px}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:16px;line-height:20px;width:20px}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:20px}.od-PermissionsSettings-description{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font:-apple-system-caption2}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-PermissionsSettings-setting{margin-bottom:8px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}.od-PermissionsSettings-learnMore{margin:0 3px;white-space:nowrap;font:-apple-system-caption2}.ms-Fabric .od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSettings-learnMore{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSettings-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSettings-learnMore:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-PermissionsSettings-learnMore:focus:after{border-color:#37006e}}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir=ltr] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir=rtl] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:32px}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}"}])});define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ModifyPermissions.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}.od-ModifyPermissions-section{padding:20px 0 0 0}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0 20px 0 20px}.od-ModifyPermissions.teams .od-ModifyPermissions-actions .ms-Button{border-radius:3px}.od-ModifyPermissions.teams .od-ModifyPermissions-actions .ms-Button--default{box-shadow:0 2px 2px 0 rgba(37,36,36,.15);border:1px solid rgba(37,36,36,.15)}.od-ModifyPermissions.teams .od-ModifyPermissions-actions .ms-Button--primary{box-shadow:0 2px 2px 0 rgba(98,100,167,.4)}.od-ModifyPermissions.teams .od-ModifyPermissions-actions .ms-Button--primary.is-disabled{box-shadow:none;border:none}"}])});define("@ms/odsp-shared-sharing/lib/components/ShareNotification/ShareNotification",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","../Header/Header","../../interfaces/SharingInterfaces","../ShareHint/ShareHint","office-ui-fabric-react/lib/TextField","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","../Share.resx","./ShareNotification.scss"],function(e,t,i,r,d,c,n,p,u,a,s,l,h,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={successfullyCopied:!1,isNameTooltipVisible:!1};i._resize=t.resize;i._sharingStore=t.sharingStore;return i}e.prototype.componentDidMount=function(){this.props.shareType===c.ShareType.copy&&this.props.shouldCopyLinkToClipboard&&this._copySharingLinkToClipboard()};e.prototype.componentDidUpdate=function(){this._resize()};e.prototype.render=function(){var t=this,e=this._getNotificationLabel(),i=this._getNotificationLabel(!0),o=this._getNotificationAriaLabel(),r=this.props.shareType===c.ShareType.copy,n=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),a=this.props.shareType,s=a===c.ShareType.share||a===c.ShareType.moreApps||a===c.ShareType.copy&&this.state.successfullyCopied,l=s?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return n?u.createElement("div",{className:"od-ShareNotification"},u.createElement(d.Header,{viewState:3,clientId:this.props.clientId}),u.createElement("div",{className:"od-ShareNotification-content ms-font-su"},u.createElement(g.Icon,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon"}),u.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},f.default.accessRequestNotificationHeader),u.createElement("div",{className:"od-ShareNotification-accessRequestBody"},f.default.accessRequestNotificationBody))):u.createElement("div",{className:"od-ShareNotification "+l},u.createElement(d.Header,{viewState:3,clientId:this.props.clientId}),this._renderCheckMark(s),u.createElement("div",{className:"od-ShareNotification-content"},u.createElement("div",{className:"ms-font-l",ref:this._onNotificationLabel,onMouseOver:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip},e),this.state.isNameTooltipVisible&&e!==i&&u.createElement(m.Callout,{directionalHint:1,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300,setInitialFocus:!0},u.createElement("div",{className:"od-ShareNotification-content-tooltip"},i)),u.createElement("span",{role:"alert","aria-live":"assertive",className:"od-Share-screenReaderOnly"},o),r&&this._renderCopyCta(),r&&u.createElement("div",{className:"od-ShareNotification-urlText"},u.createElement(p.TextField,{autoFocus:!0,ariaLabel:o,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(e){t._textField=e},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField"}),u.createElement(h.PrimaryButton,{className:"od-ShareNotification-copyButton",text:f.default.copyButtonLabel,onClick:this._copySharingLinkToClipboard}))),r&&this._renderShareHint())};e.prototype._onShowNameTooltip=function(){this.setState(i.__assign({},this.state,{isNameTooltipVisible:!0}))};e.prototype._onHideNameTooltip=function(){this.setState(i.__assign({},this.state,{isNameTooltipVisible:!1}))};e.prototype._copySharingLinkToClipboard=function(){return i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(e){l.copySharingLinkToClipboard(this.props.clientId,this._textField,this.props.linkUrl).then(function(e){t.setState(i.__assign({},t.state,{successfullyCopied:e}))});return[2]})})};e.prototype._onNotificationLabel=function(e){this._notificationLabel=e};e.prototype._renderCheckMark=function(e){if(e)return u.createElement("div",{className:"od-ShareNotification-icon"},u.createElement(g.Icon,{iconName:"CheckMark"}))};e.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===c.ShareType.copy&&!t.successfullyCopied)return u.createElement("span",{className:"od-ShareNotification-copyCta"},f.default.notificationCopyFailedCta)};e.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?u.createElement("div",{className:"od-ShareNotification-footer"},u.createElement(n.ShareHint,{companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,shouldTakeFocus:!1,linkRecipients:e.linkRecipients})):null};e.prototype._getNotificationLabel=function(e){var t=f.default,i=e?this.props.itemName:l.truncateItemNameForShareNotification(this.props.itemName),o=this.props.shareType,r=i?s.format(t.notificationCopied,i):f.default.notificationCopiedLabel,n=i?s.format(t.notificationCopyFailed,i):f.default.notificationCopyFailedLabel,a=i?s.format(t.notificationSent,i):f.default.notificationSentLabel;return o===c.ShareType.copy?this.state.successfullyCopied?r:n:o===c.ShareType.share?a:o===c.ShareType.moreApps?n:""};e.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===c.ShareType.copy?this.state.successfullyCopied?f.default.notificationCopiedLabel:f.default.notificationCopyFailedLabel:e===c.ShareType.share?f.default.notificationSentLabel:e===c.ShareType.moreApps?f.default.notificationCopyFailedLabel:""};e.contextTypes={resize:a.func.isRequired,sharingStore:a.object.isRequired};i.__decorate([r.autobind],e.prototype,"_onShowNameTooltip",null);i.__decorate([r.autobind],e.prototype,"_onHideNameTooltip",null);i.__decorate([r.autobind],e.prototype,"_copySharingLinkToClipboard",null);i.__decorate([r.autobind],e.prototype,"_onNotificationLabel",null);return e}(u.Component);t.ShareNotification=o});define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHint",["require","exports","tslib","./ShareHintDetail/ShareHintDetail","../ShareLinkDescription/ShareLinkDescription","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/locale/Locale","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Coachmark","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/ABExperiment","./ShareHint.scss"],function(e,t,l,d,c,p,i,u,h,m,o,g,f,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b={ODB:1176},r=function(r){l.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._targetButton=n.createRef();i._odShareHintchevron=n.createRef();i._onDismiss=function(){i.setState({isCoachmarkVisible:!1})};i._isOnExperiment=!1;if(a.default.isFeatureEnabled(b)){var o=new s.ABExperiment({name:"CoachMark",startDate:"08/2/2018",version:s.ABExpHash.v2});i._isOnExperiment=o.IsExperimentOn()}i.state={isCoachmarkVisible:i._isOnExperiment};return i}e.prototype.render=function(){var e,t,i=this.props,o=this._getFileShareTypeFromAudience(),r=this._getLabelFromPermissionsType(o),n=!!this.props.onShareHintClick,a="od-ShareHint "+(m.isLoadingData(i.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),s="od-ShareHint-data "+(n?"od-ShareHint--clickable":"");e=p.createElement("div",{className:"od-ShareHint-shimmer"},p.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},p.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},p.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),p.createElement("div",{className:"od-ShareHint-text-shimmer"}));t=i.onShareHintClick?p.createElement("button",{className:s,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this),autoFocus:i.shouldTakeFocus},p.createElement("div",{className:"od-ShareHint-iconHolder"},p.createElement(c.ShareLinkDescription,{label:r,permissionsType:o,showLabel:!1})),p.createElement(d.ShareHintDetail,{companyName:i.companyName,currentSettings:i.currentSettings,sharingInformation:i.sharingInformation,linkRecipients:i.linkRecipients}),this._renderChevron(n)):p.createElement("div",l.__assign({className:s},{autoFocus:!0}),p.createElement("div",{className:"od-ShareHint-iconHolder"},p.createElement(c.ShareLinkDescription,{label:r,permissionsType:o,showLabel:!1})),p.createElement(d.ShareHintDetail,{companyName:i.companyName,currentSettings:i.currentSettings,sharingInformation:i.sharingInformation,linkRecipients:i.linkRecipients}),this._renderChevron(n));return p.createElement("div",{className:a},t,e,this.state.isCoachmarkVisible&&p.createElement(g.Coachmark,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:u.default.isRightToLeft?4:6}},p.createElement(f.TeachingBubbleContent,{calloutProps:{directionalHint:u.default.isRightToLeft?4:6,gapSpace:0},headline:h.default.modifyPermissionsHeader,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:h.default.closeButtonLabel,onDismiss:this._onDismiss},h.default.linkSettingsExplanation1,p.createElement("br",null),h.default.linkSettingsExplanation2)))};e.prototype._renderChevron=function(e){if(e)return p.createElement("div",{ref:this._odShareHintchevron},p.createElement(o.Icon,{iconName:u.default.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron"}))};e.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};e.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return 2===e?0:1===e?1:3===e?4:2};e.prototype._getLabelFromPermissionsType=function(e){var t=h.default;return 0===e?t.permissionsAnyoneString:1===e?i.format(t.permissionsCompanyString,this.props.companyName):4===e?t.permissionsExistingPeopleString:2===e?t.permissionsSpecificPeopleString:void 0};return e}(p.Component);t.ShareHint=r});define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHintDetail/ShareHintDetail",["require","exports","tslib","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","react","@ms/odsp-utilities/lib/string/StringHelper","../../Share.resx","../../../utilities/ShareHelper","./ShareHintDetail.scss"],function(e,t,i,n,a,s,l,d,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._renderStatusIcons=i._renderStatusIcons.bind(i);return i}e.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return s.createElement("div",{className:"od-ShareHintDetail"},s.createElement("div",{className:"od-ShareHintDetail-description"},s.createElement("div",{className:"od-ShareHintDetail-status"},s.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons())))};e.prototype._renderStatusIcons=function(){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.password,i=this.props.currentSettings.preventDownload,o=[];e&&e.getTime()!==new Date(0).getTime()&&o.push({icon:"Calendar",tooltip:""+l.format(d.default.expiresIn,this._getMonthAndDay(),e.getFullYear())});0<t.length&&o.push({icon:"Lock",tooltip:d.default.sharePasswordReminderText});i&&o.push({icon:"Blocked2",tooltip:d.default.preventDownloadHint});var r=o.map(function(e,t){return s.createElement("i",{className:"od-ShareHintDetail-item"},s.createElement(a.TooltipHost,{content:e.tooltip,id:e.icon},s.createElement(n.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return s.createElement("div",{className:"od-ShareHintDetail-iconsList"},r)};e.prototype._getLabel=function(e){if(!e)return"";var t=d.default,i=this.props.companyName;if(e.preventDownload){if(2===e.audience)return t.anonymousViewOnlyHint;if(1===e.audience)return l.format(t.cslViewOnlyHint,i);if(4===e.audience)return t.specificPeopleViewOnlyHint}switch(e.sharingLinkKind){case 1:return 0===e.audience?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?d.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:t.existingPeopleDescription;case 2:return l.format(t.cslViewDescription,i);case 3:return l.format(t.cslEditDescription,i);case 4:return t.anonViewDescription;case 5:return t.anonEditDescription;case 6:return 4===e.audience?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?d.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:"";default:return""}};e.prototype._getMonthAndDay=function(){var e=this.props.currentSettings.expiration,t="";if(e&&e.getTime()!==new Date(0).getTime()){t+=r.shortMonths[e.getMonth()];t+=" "+e.getDate()}return t};return e}(s.Component);t.ShareHintDetail=o});define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHintDetail/ShareHintDetail.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:12px;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font:-apple-system-caption1}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:10px}[dir=ltr] .od-ShareHintDetail-item{margin-right:4px}[dir=rtl] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}"}])});define("office-ui-fabric-react/lib/Coachmark",["require","exports","tslib","./components/Coachmark/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Coachmark/index",["require","exports","tslib","./Coachmark"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Coachmark/Coachmark",["require","exports","tslib","react","../../Utilities","../../Styling","../../utilities/positioning","./PositioningContainer/index","./Beak/Beak","./Coachmark.styles","../../FocusTrapZone"],function(e,t,k,P,r,i,l,w,C,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=r.classNamesFunction();t.COACHMARK_ATTRIBUTE_NAME="data-coachmarkid";var o=function(t){k.__extends(e,t);function e(e){var s=t.call(this,e)||this;s._entityInnerHostElement=r.createRef();s._translateAnimationContainer=r.createRef();s._ariaAlertContainer=r.createRef();s._positioningContainer=r.createRef();s.dismiss=function(e){var t=s.props.onDismiss;t&&t(e)};s._onKeyDown=function(e){(e.altKey&&67===e.which||13===e.which&&s._translateAnimationContainer.current&&s._translateAnimationContainer.current.contains(e.target))&&s._onFocusHandler()};s._onFocusHandler=function(){s.state.isCollapsed&&s._openCoachmark()};s._onPositioned=function(e){s._async.requestAnimationFrame(function(){s.setState({targetAlignment:e.alignmentEdge,targetPosition:e.targetEdge})})};s._setBeakPosition=function(){var e,t,i,o,r,n,a=s.state.targetAlignment;switch(s._beakDirection){case l.RectangleEdge.top:case l.RectangleEdge.bottom:if(a)if(a===l.RectangleEdge.left){e=I.COACHMARK_WIDTH/2-C.BEAK_WIDTH/2+"px";r="left"}else{i=I.COACHMARK_WIDTH/2-C.BEAK_WIDTH/2+"px";r="right"}else{e="calc(50% - "+C.BEAK_WIDTH/2+"px)";r="center"}if(s._beakDirection===l.RectangleEdge.top){t="3px";n="top"}else{o="3px";n="bottom"}break;case l.RectangleEdge.left:case l.RectangleEdge.right:if(a)if(a===l.RectangleEdge.top){t=I.COACHMARK_WIDTH/2-C.BEAK_WIDTH/2+"px";n="top"}else{o=I.COACHMARK_WIDTH/2-C.BEAK_WIDTH/2+"px";n="bottom"}else{t="calc(50% - "+C.BEAK_WIDTH/2+"px)";n="center"}if(s._beakDirection===l.RectangleEdge.left){e="3px";r="left"}else{i="3px";r="right"}}s.setState({beakLeft:e,beakRight:i,beakBottom:o,beakTop:t,transformOrigin:r+" "+n})};s._openCoachmark=function(){s.setState({isCollapsed:!1});s.props.onAnimationOpenStart&&s.props.onAnimationOpenStart();s._entityInnerHostElement.current&&s._entityInnerHostElement.current.addEventListener("transitionend",function(){s._async.setTimeout(function(){s.props.teachingBubbleRef&&s.props.teachingBubbleRef.focus()},500);s.props.onAnimationOpenEnd&&s.props.onAnimationOpenEnd()})};s.state={isCollapsed:e.isCollapsed,isBeaconAnimating:!0,isMeasuring:!0,entityInnerHostRect:{width:0,height:0},isMouseInProximity:!1};return s}Object.defineProperty(e.prototype,"_beakDirection",{get:function(){var e=this.state.targetPosition;return void 0===e?l.RectangleEdge.bottom:l.getOppositeEdge(e)},enumerable:!0,configurable:!0});e.prototype.render=function(){var e=this.props,t=e.children,i=e.target,o=e.color,r=e.positioningContainerProps,n=e.ariaDescribedBy,a=e.ariaDescribedByText,s=e.ariaLabelledBy,l=e.ariaLabelledByText,d=e.ariaAlertText,c=this.state,p=c.beakLeft,u=c.beakTop,h=c.beakRight,m=c.beakBottom,g=c.isCollapsed,f=c.isBeaconAnimating,b=c.isMeasuring,y=c.entityInnerHostRect,v=c.transformOrigin,x=c.alertText,_=D(I.getStyles,{isCollapsed:g,isBeaconAnimating:f,isMeasuring:b,entityHostHeight:y.height+"px",entityHostWidth:y.width+"px",width:I.COACHMARK_WIDTH+"px",height:I.COACHMARK_HEIGHT+"px",color:o,transformOrigin:v}),S=g?I.COACHMARK_HEIGHT:y.height;return P.createElement(w.PositioningContainer,k.__assign({target:i,offsetFromTarget:C.BEAK_HEIGHT,componentRef:this._positioningContainer,finalHeight:S,onPositioned:this._onPositioned,bounds:this._getBounds()},r),P.createElement("div",{className:_.root},d&&P.createElement("div",{className:_.ariaContainer,role:"alert",ref:this._ariaAlertContainer,"aria-hidden":!g},x),P.createElement("div",{className:_.pulsingBeacon}),P.createElement("div",{className:_.translateAnimationContainer,ref:this._translateAnimationContainer},P.createElement("div",{className:_.scaleAnimationLayer},P.createElement("div",{className:_.rotateAnimationLayer},this._positioningContainer.current&&P.createElement(C.Beak,{left:p,top:u,right:h,bottom:m,direction:this._beakDirection,color:o}),P.createElement(T.FocusTrapZone,{isClickableOutsideFocusTrap:!0},P.createElement("div",{className:_.entityHost,tabIndex:-1,"data-is-focusable":!0,role:"dialog","aria-labelledby":s,"aria-describedby":n},g&&[s&&P.createElement("p",{id:s,key:0,className:_.ariaContainer},l),n&&P.createElement("p",{id:n,key:1,className:_.ariaContainer},a)],P.createElement("div",{className:_.entityInnerHost,ref:this._entityInnerHostElement,"aria-hidden":g},t))))))))};e.prototype.componentWillReceiveProps=function(e){this.props.isCollapsed&&!e.isCollapsed&&this._openCoachmark()};e.prototype.shouldComponentUpdate=function(e,t){return!r.shallowCompare(e,this.props)||!r.shallowCompare(t,this.state)};e.prototype.componentDidUpdate=function(e,t){t.targetAlignment===this.state.targetAlignment&&t.targetPosition===this.state.targetPosition||this._setBeakPosition();e.preventDismissOnLostFocus!==this.props.preventDismissOnLostFocus&&this._addListeners()};e.prototype.componentDidMount=function(){var e=this;this._async.requestAnimationFrame(function(){if(e._entityInnerHostElement.current&&e.state.entityInnerHostRect.width+e.state.entityInnerHostRect.width===0){e.setState({isMeasuring:!1,entityInnerHostRect:{width:e._entityInnerHostElement.current.offsetWidth,height:e._entityInnerHostElement.current.offsetHeight}});e._setBeakPosition();e.forceUpdate()}e._addListeners();e._async.setTimeout(function(){e._addProximityHandler(e.props.mouseProximityOffset)},e.props.delayBeforeMouseOpen);e.props.ariaAlertText&&e._async.setTimeout(function(){e.props.ariaAlertText&&e._ariaAlertContainer.current&&e.setState({alertText:e.props.ariaAlertText})},0)})};e.prototype._addListeners=function(){var e=this.props.preventDismissOnLostFocus,t=r.getDocument();this._events.off();if(t){this._events.on(t,"keydown",this._onKeyDown,!0);if(!e){this._events.on(t,"click",this._dismissOnLostFocus,!0);this._events.on(t,"focus",this._dismissOnLostFocus,!0)}}};e.prototype._dismissOnLostFocus=function(e){var t=e.target,i=this._translateAnimationContainer.current&&!r.elementContains(this._translateAnimationContainer.current,t),o=this.props.target;i&&t!==o&&!r.elementContains(o,t)&&this.dismiss(e)};e.prototype._getBounds=function(){var e=this.props,t=e.isPositionForced,i=e.positioningContainerProps;return t?!i||3!==i.directionalHint&&7!==i.directionalHint?{left:-1/0,top:-1/0,bottom:1/0,right:1/0,width:1/0,height:1/0}:{left:0,top:-1/0,bottom:1/0,right:window.innerWidth,width:window.innerWidth,height:1/0}:void 0};e.prototype._addProximityHandler=function(o){var r=this;void 0===o&&(o=0);var e=[];this._async.setTimeout(function(){r._setTargetElementRect();r._events.on(window,"resize",function(){e.forEach(function(e){clearInterval(e)});e.push(r._async.setTimeout(function(){r._setTargetElementRect()},100))})},10);this._events.on(document,"mousemove",function(e){if(r.state.isCollapsed){var t=e.pageY,i=e.pageX;r._setTargetElementRect();r._isInsideElement(i,t,o)!==r.state.isMouseInProximity&&r._openCoachmark()}r.props.onMouseMove&&r.props.onMouseMove(e)})};e.prototype._setTargetElementRect=function(){this._translateAnimationContainer&&this._translateAnimationContainer.current&&(this._targetElementRect=this._translateAnimationContainer.current.getBoundingClientRect())};e.prototype._isInsideElement=function(e,t,i){void 0===i&&(i=0);return e>this._targetElementRect.left-i&&e<this._targetElementRect.left+this._targetElementRect.width+i&&t>this._targetElementRect.top-i&&t<this._targetElementRect.top+this._targetElementRect.height+i};e.defaultProps={isCollapsed:!0,mouseProximityOffset:10,delayBeforeMouseOpen:3600,color:i.DefaultPalette.themePrimary,isPositionForced:!0,positioningContainerProps:{directionalHint:7}};return e}(r.BaseComponent);t.Coachmark=o});define("office-ui-fabric-react/lib/components/Coachmark/PositioningContainer/index",["require","exports","tslib","./PositioningContainer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Coachmark/PositioningContainer/PositioningContainer",["require","exports","tslib","react","./PositioningContainer.styles","../../../Layer","../../../Utilities","../../../utilities/positioning","../../../Styling"],function(e,t,i,p,u,h,m,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,f={opacity:0},b=((o={})[l.RectangleEdge.top]="slideUpIn20",o[l.RectangleEdge.bottom]="slideDownIn20",o[l.RectangleEdge.left]="slideLeftIn20",o[l.RectangleEdge.right]="slideRightIn20",o),r=function(t){i.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._positionedHost=m.createRef();i._contentHost=m.createRef();i.dismiss=function(e){i.onResize(e)};i.onResize=function(e){var t=i.props.onDismiss;t?t(e):i._updateAsyncPosition()};i._setInitialFocus=function(){if(i._contentHost.current&&i.props.setInitialFocus&&!i._didSetInitialFocus&&i.state.positions){i._didSetInitialFocus=!0;m.focusFirstChild(i._contentHost.current)}};i._onComponentDidMount=function(){i._async.setTimeout(function(){i._events.on(i._targetWindow,"scroll",i._async.throttle(i._dismissOnScroll,10),!0);i._events.on(i._targetWindow,"resize",i._async.throttle(i.onResize,10),!0);i._events.on(i._targetWindow.document.body,"focus",i._dismissOnLostFocus,!0);i._events.on(i._targetWindow.document.body,"click",i._dismissOnLostFocus,!0)},0);i.props.onLayerMounted&&i.props.onLayerMounted();i._updateAsyncPosition();i._setHeightOffsetEveryFrame()};i._didSetInitialFocus=!1;i.state={positions:void 0,heightOffset:0};i._positionAttempts=0;return i}e.prototype.componentWillMount=function(){this._setTargetWindowAndElement(this._getTarget())};e.prototype.componentDidMount=function(){this._onComponentDidMount()};e.prototype.componentDidUpdate=function(){this._setInitialFocus();this._updateAsyncPosition()};e.prototype.componentWillUpdate=function(e){var t=this._getTarget(e);if(t!==this._getTarget()||"string"==typeof t||t instanceof String){this._maxHeight=void 0;this._setTargetWindowAndElement(t)}e.offsetFromTarget!==this.props.offsetFromTarget&&(this._maxHeight=void 0);e.finalHeight!==this.props.finalHeight&&this._setHeightOffsetEveryFrame()};e.prototype.render=function(){if(!this._targetWindow)return null;var e=this.props,t=e.className,i=e.positioningContainerWidth,o=e.positioningContainerMaxHeight,r=e.children,n=this.state.positions,a=u.getClassNames(),s=n&&n.targetEdge?g.AnimationClassNames[b[n.targetEdge]]:"",l=this._getMaxHeight()+this.state.heightOffset,d=o&&l<o?l:o,c=p.createElement("div",{ref:this._positionedHost,className:m.css("ms-PositioningContainer",a.container)},p.createElement("div",{className:g.mergeStyles("ms-PositioningContainer-layerHost",a.root,t,s,!!i&&{width:i}),style:n?n.elementPosition:f,tabIndex:-1,ref:this._contentHost},r,d));return this.props.doNotLayer?c:p.createElement(h.Layer,null,c)};e.prototype._dismissOnScroll=function(e){var t=this.props.preventDismissOnScroll;this.state.positions&&!t&&this._dismissOnLostFocus(e)};e.prototype._dismissOnLostFocus=function(e){var t=e.target,i=this._positionedHost.current&&!m.elementContains(this._positionedHost.current,t);(!this._target&&i||e.target!==this._targetWindow&&i&&(this._target.stopPropagation||!this._target||t!==this._target&&!m.elementContains(this._target,t)))&&this.onResize(e)};e.prototype._updateAsyncPosition=function(){var e=this;this._async.requestAnimationFrame(function(){return e._updatePosition()})};e.prototype._updatePosition=function(){var e=this.state.positions,t=this.props,i=t.offsetFromTarget,o=t.onPositioned,r=this._positionedHost.current,n=this._contentHost.current;if(r&&n){var a=void 0;(a=m.assign(a,this.props)).bounds=this._getBounds();a.target=this._target;if(document.body.contains(a.target)){a.gapSpace=i;var s=l.positionElement(a,r,n);if(!e&&s||e&&s&&!this._arePositionsEqual(e,s)&&this._positionAttempts<5){this._positionAttempts++;this.setState({positions:s},function(){o&&o(s)})}else{this._positionAttempts=0;o&&o(s)}}else void 0!==e&&this.setState({positions:void 0})}};e.prototype._getBounds=function(){if(!this._positioningBounds){var e=this.props.bounds;e||(e={top:0+this.props.minPagePadding,left:0+this.props.minPagePadding,right:this._targetWindow.innerWidth-this.props.minPagePadding,bottom:this._targetWindow.innerHeight-this.props.minPagePadding,width:this._targetWindow.innerWidth-2*this.props.minPagePadding,height:this._targetWindow.innerHeight-2*this.props.minPagePadding});this._positioningBounds=e}return this._positioningBounds};e.prototype._getMaxHeight=function(){var e=this.props,t=e.directionalHintFixed,i=e.offsetFromTarget,o=e.directionalHint;if(!this._maxHeight)if(t&&this._target){var r=i||0;this._maxHeight=l.getMaxHeight(this._target,o,r,this._getBounds())}else this._maxHeight=this._getBounds().height-2;return this._maxHeight};e.prototype._arePositionsEqual=function(e,t){return this._comparePositions(e.elementPosition,t.elementPosition)};e.prototype._comparePositions=function(e,t){for(var i in t)if(t.hasOwnProperty(i)){var o=e[i],r=t[i];if(o&&r&&o.toFixed(2)!==r.toFixed(2))return!1}return!0};e.prototype._setTargetWindowAndElement=function(e){if(e)if("string"==typeof e){var t=m.getDocument();this._target=t?t.querySelector(e):null;this._targetWindow=m.getWindow()}else if(e.stopPropagation){this._targetWindow=m.getWindow(e.toElement);this._target=e}else if(void 0!==e.x&&void 0!==e.y){this._targetWindow=m.getWindow();this._target=e}else{var i=e;this._targetWindow=m.getWindow(i);this._target=e}else this._targetWindow=m.getWindow()};e.prototype._setHeightOffsetEveryFrame=function(){var i=this;this._contentHost&&this.props.finalHeight&&(this._setHeightOffsetTimer=this._async.requestAnimationFrame(function(){if(i._contentHost.current){var e=i._contentHost.current.lastChild,t=e.scrollHeight-e.offsetHeight;i.setState({heightOffset:i.state.heightOffset+t});e.offsetHeight<i.props.finalHeight?i._setHeightOffsetEveryFrame():i._async.cancelAnimationFrame(i._setHeightOffsetTimer)}}))};e.prototype._getTarget=function(e){void 0===e&&(e=this.props);return e.target};e.defaultProps={preventDismissOnScroll:!1,offsetFromTarget:0,minPagePadding:8,directionalHint:7};return e}(m.BaseComponent);t.PositioningContainer=r});define("office-ui-fabric-react/lib/components/Coachmark/PositioningContainer/PositioningContainer.styles",["require","exports","tslib","../../../Utilities","../../../Styling"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return{"@media screen and (-ms-high-contrast: active)":e}}t.highContrastActive=n;function a(){return{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}t.focusClear=a;t.getClassNames=o.memoizeFunction(function(){return r.mergeStyleSets({root:{position:"absolute",boxSizing:"border-box",border:"1px solid ${}",selectors:i.__assign({},n({border:"1px solid WindowText"}),{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}})},container:{position:"relative"},main:{backgroundColor:"#ffffff",overflowX:"hidden",overflowY:"hidden",position:"relative"},overFlowYHidden:{overflowY:"hidden"}})})});define("office-ui-fabric-react/lib/components/Coachmark/Beak/Beak",["require","exports","tslib","react","../../../Utilities","./Beak.styles","../../../utilities/positioning"],function(e,g,i,f,b,y,v){"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.BEAK_HEIGHT=10;g.BEAK_WIDTH=18;var t=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e,t,i,o,r,n,a=this.props,s=a.left,l=a.top,d=a.bottom,c=a.right,p=a.color,u=a.direction,h=void 0===u?v.RectangleEdge.top:u;if(h===v.RectangleEdge.top||h===v.RectangleEdge.bottom){e=g.BEAK_HEIGHT;t=g.BEAK_WIDTH}else{e=g.BEAK_WIDTH;t=g.BEAK_HEIGHT}switch(h){case v.RectangleEdge.top:default:i=g.BEAK_WIDTH/2+", 0";o=g.BEAK_WIDTH+", "+g.BEAK_HEIGHT;r="0, "+g.BEAK_HEIGHT;n="translateY(-100%)";break;case v.RectangleEdge.right:i="0, 0";o=g.BEAK_HEIGHT+", "+g.BEAK_HEIGHT;r="0, "+g.BEAK_WIDTH;n="translateX(100%)";break;case v.RectangleEdge.bottom:i="0, 0";o=g.BEAK_WIDTH+", 0";r=g.BEAK_WIDTH/2+", "+g.BEAK_HEIGHT;n="translateY(100%)";break;case v.RectangleEdge.left:i=g.BEAK_HEIGHT+", 0";o="0, "+g.BEAK_HEIGHT;r=g.BEAK_HEIGHT+", "+g.BEAK_WIDTH;n="translateX(-100%)"}var m=b.classNamesFunction()(y.getStyles,{left:s,top:l,bottom:d,right:c,height:e+"px",width:t+"px",transform:n,color:p});return f.createElement("div",{className:m.root,role:"presentation"},f.createElement("svg",{height:e,width:t,className:m.beak},f.createElement("polygon",{points:i+" "+o+" "+r})))};return e}(b.BaseComponent);g.Beak=t});define("office-ui-fabric-react/lib/components/Coachmark/Beak/Beak.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:[{position:"absolute",boxShadow:"inherit",border:"none",boxSizing:"border-box",transform:e.transform,width:e.width,height:e.height,left:e.left,top:e.top,right:e.right,bottom:e.bottom}],beak:{fill:e.color,display:"block"}}}});define("office-ui-fabric-react/lib/components/Coachmark/Coachmark.styles",["require","exports","../../Styling"],function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.COACHMARK_WIDTH=32;r.COACHMARK_HEIGHT=32;r.translateOne=n.keyframes({"0%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"78.57%":{transform:"translate(0, 0)",animationTimingFunction:"cubic-bezier(0.62, 0, 0.56, 1)"},"82.14%":{transform:"translate(0, -5px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0, 1)"},"84.88%":{transform:"translate(0, 9px)",animationTimingFunction:"cubic-bezier(1, 0, 0.56, 1)"},"88.1%":{transform:"translate(0, -2px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0.67, 1)"},"90.12%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"100%":{transform:"translate(0, 0)"}});r.scaleOne=n.keyframes({"0%":{transform:" scale(0)",animationTimingFunction:"linear"},"14.29%":{transform:"scale(0)",animationTimingFunction:"cubic-bezier(0.84, 0, 0.52, 0.99)"},"16.67%":{transform:"scale(1.15)",animationTimingFunction:"cubic-bezier(0.48, -0.01, 0.52, 1.01)"},"19.05%":{transform:"scale(0.95)",animationTimingFunction:"cubic-bezier(0.48, 0.02, 0.52, 0.98)"},"21.43%":{transform:"scale(1)",animationTimingFunction:"linear"},"42.86%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"45.71%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"50%":{transform:"scale(1)",animationTimingFunction:"linear"},"90.12%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"92.98%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"97.26%":{transform:"scale(1)",animationTimingFunction:"linear"},"100%":{transform:"scale(1)"}});r.rotateOne=n.keyframes({"0%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"83.33%":{transform:" rotate(0deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"83.93%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"84.52%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.12%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.71%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"86.31%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"100%":{transform:"rotate(0deg)"}});r.getStyles=function(e,t){void 0===t&&(t=n.getTheme());var i=n.PulsingBeaconAnimationStyles.continuousPulseAnimationDouble(e.beaconColorOne?e.beaconColorOne:t.palette.themePrimary,e.beaconColorTwo?e.beaconColorTwo:t.palette.themeTertiary,"35px","150px","10px"),o=n.PulsingBeaconAnimationStyles.createDefaultAnimation(i);return{root:[{position:"relative"}],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:"0"},e.isCollapsed&&e.isBeaconAnimating&&o],translateAnimationContainer:[{width:"100%",height:"100%"},e.isCollapsed&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:r.translateOne,transition:"opacity 0.5s ease-in-out"},!e.isCollapsed&&{opacity:"1"}],scaleAnimationLayer:[{width:"100%",height:"100%"},e.isCollapsed&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:r.scaleOne}],rotateAnimationLayer:[{width:"100%",height:"100%"},e.isCollapsed&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:r.rotateOne},!e.isCollapsed&&{opacity:"1"}],entityHost:[{position:"relative",outline:"none",overflow:"hidden",backgroundColor:e.color,borderRadius:r.COACHMARK_WIDTH,transition:"border-radius 250ms, width 500ms, height 500ms cubic-bezier(0.5, 0, 0, 1)",visibility:"hidden"},!e.isMeasuring&&{width:r.COACHMARK_WIDTH,height:r.COACHMARK_HEIGHT,visibility:"visible"},!e.isCollapsed&&{borderRadius:"1px",opacity:"1",width:e.entityHostWidth,height:e.entityHostHeight}],entityInnerHost:[{transition:"transform 500ms cubic-bezier(0.5, 0, 0, 1)",transformOrigin:e.transformOrigin,transform:"scale(0)"},!e.isCollapsed&&{width:e.entityHostWidth,height:e.entityHostHeight,transform:"scale(1)"},!e.isMeasuring&&{visibility:"visible"}],ariaContainer:{position:"fixed",opacity:0,height:0,width:0,pointerEvents:"none"}}}});define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHint.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:16px 16px 0 16px;position:relative}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:16px}.od-ShareHint .ms-Label{font-size:12px;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:10px;padding-top:9px;color:#3c3c3c}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:14px;font-weight:400;background:0 0;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:10px;margin:0;opacity:0;transition:opacity .2s}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data:focus{border-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data:focus{border:2px solid Highlight;outline:0}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:10px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint--clickable:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:36px;height:24px}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:24px;border-bottom:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}])});define("@ms/odsp-shared-sharing/lib/components/ShareNotification/ShareNotification.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;background-color:#599b00;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;border-radius:50%;width:44px;height:44px;animation:bounce .45s;animation-fill-mode:both;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;margin-left:44px}.od-ShareNotification-content{width:90%}[dir=ltr] .od-ShareNotification-content{padding-left:16px}[dir=rtl] .od-ShareNotification-content{padding-right:16px}[dir=ltr] .od-ShareNotification-content{padding-right:16px}[dir=rtl] .od-ShareNotification-content{padding-left:16px}.od-ShareNotification-content-tooltip{margin:5px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-ms-flexbox;display:flex}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir=ltr] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir=rtl] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:32px}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;width:12px;height:12px;cursor:pointer}[dir=ltr] .od-ShareNotification-close{right:12px}[dir=rtl] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0 0 0;padding:16px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:12px;font-weight:400}.od-ShareNotification-copyButton{height:32px;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:17px;font-weight:300;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 8px 24px 8px;text-align:left}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/PermissionsList",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","./ShareLink/ShareLink","./SharePrincipal/SharePrincipal","./SharePrincipal/SharePrincipal2","../../utilities/ClientIdHelper","react","../Share.resx","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/FocusZone","@ms/odsp-utilities/lib/features/FeatureOverrides","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","./PermissionsList.scss"],function(e,t,i,r,n,a,s,l,d,c,p,u,h,m,g,f,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={ODB:778},o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={viewState:i.props.viewState,showLinkDetails:!1,currentSharingLink:void 0};i._isLinkSettingsEditPanelEnabled=i.props.clientId===n.ClientId.teams||(i.props.mode===n.Mode.manageAccess||i.props.mode===n.Mode.share)&&f.default.isFeatureEnabled(x);return i}e.prototype.componentDidMount=function(){this.props.mode===n.Mode.manageAccess&&b.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype.render=function(){var e,t=this.props.sharingInformation,i=0<this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1);e=t.hasPermissionsInformation?t.isShared?c.createElement("div",{className:"od-PermissionsList-content"},c.createElement("ul",{className:"od-PermissionsList-links","aria-label":p.default.permissionsListLinksLabel},this._renderLinks()),c.createElement(g.FocusZone,{direction:g.FocusZoneDirection.vertical},c.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":p.default.permissionsListPrincipalsLabel},this._renderPrincipals(i)))):c.createElement("div",null,p.default.notShared):c.createElement("div",{className:"od-Share-spinnerHolder"},c.createElement(u.Spinner,{className:"od-Share-spinner",label:p.default.componentLoading,type:u.SpinnerType.large}));var o=!(this._isLinkSettingsEditPanelEnabled&&!this.state.showLinkDetails)||d.showManagePermissions(this.props.clientId);return c.createElement("div",{className:"od-PermissionsList"},o&&this._renderHeader(),this.state.showLinkDetails?this._renderLinkDetails():e)};e.prototype._renderHeader=function(){return c.createElement("div",{className:"od-PermissionsList-header"},this.props.mode!==n.Mode.manageAccess&&c.createElement(v.IconButton,{className:"od-Share-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"}},c.createElement("label",{className:"od-Share-screenReaderOnly"},p.default.backButtonLabel)),c.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:4,"data-is-focusable":!0,mode:this.props.mode}))};e.prototype._renderLinkDetails=function(){return c.createElement(a.ShareLink,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList})};e.prototype._showPermissionsList=function(){this.setState({showLinkDetails:!1})};e.prototype._renderLinks=function(){var i=this,e=this.props.sharingInformation.sharingLinks,o=!1;return c.createElement("li",{className:"od-PermissionsList-linksListHolder"},this._isLinkSettingsEditPanelEnabled&&c.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},c.createElement(h.Icon,{iconName:"Link",className:"ms-Icon ms-Icon--Link"}),p.default.linksListHeader,c.createElement(m.TooltipHost,{content:p.default.linksListHeaderTooltip,directionalHint:1,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},c.createElement(h.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))),c.createElement("div",{className:"od-PermissionsList-links","aria-label":p.default.permissionsListLinksLabel},e.map(function(e,t){if(0!==e.audience&&e.isActive){o=!0;return c.createElement(a.ShareLink,{key:e.shareId,mode:i.props.mode,companyName:i.props.companyName,link:e,clientId:i.props.clientId,sharingInformation:i.props.sharingInformation,groupsMemberCount:i.props.groupsMemberCount,linkRecipients:i.props.linkRecipients,enableLinkSettings:i._isLinkSettingsEditPanelEnabled,showMoreOptions:i._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:i._onLinkSelected,linkDetailsView:!1,showPermissionsList:i._showPermissionsList})}}),!o&&this._renderNoSharingLinks()))};e.prototype._renderNoSharingLinks=function(){return c.createElement("div",{className:"od-PermissionsList-emptyLinks"},p.default.noLinksGivingAccess)};e.prototype._onLinkSelected=function(e){this.setState({currentSharingLink:e,showLinkDetails:!0})};e.prototype._renderPrincipals=function(i){var o=this,r=this.props.sharingInformation,e=r.sharingPrincipals.slice();return this._isLinkSettingsEditPanelEnabled?c.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&c.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},c.createElement(h.Icon,{iconName:"PlayerSettings",className:"ms-Icon ms-Icon--PlayerSettings"}),p.default.principalsListHeader,c.createElement(m.TooltipHost,{content:p.default.principalsListHeaderTooltip,directionalHint:1,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},c.createElement(h.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))),c.createElement("div",{className:"od-PermissionsList-entities",role:"list","aria-label":p.default.permissionsListPrincipalsLabel},e.map(function(e,t){return c.createElement(l.SharePrincipal2,{key:e.id,principal:e,userRole:r.userRole,clientId:o.props.clientId,appmap:o.props.sharingInformation.item.appmap})}))):c.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":p.default.permissionsListPrincipalsLabel},e.map(function(e,t){return c.createElement("li",{key:e.id},c.createElement(s.SharePrincipal,{principal:e,takeFocus:!i&&0===t,userRole:r.userRole,clientId:o.props.clientId,appmap:o.props.sharingInformation.item.appmap}))}))};i.__decorate([y.autobind],e.prototype,"_showPermissionsList",null);i.__decorate([y.autobind],e.prototype,"_onLinkSelected",null);return e}(c.Component);t.PermissionsList=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ShareLink",["require","exports","tslib","react","prop-types","../../Share.resx","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","./LinkMember/LinkMember","../../../utilities/ShareHelper","../ShareLinkParticipants/ShareLinkParticipants","office-ui-fabric-react/lib/Facepile","../ShareLinkDetails/ShareLinkDetails","office-ui-fabric-react/lib/Persona","../ShareLink/ConfirmationDialog/ConfirmationDialog","./ShareLink.scss","../../ModifyPermissions/PermissionsSettings/PermissionsSettings.scss"],function(e,t,u,a,i,s,l,r,d,c,n,h,p,m,g,f,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){u.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._store=t.sharingStore;i._link=i.props.link;i.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,link:i._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:h.getLinkParticipants(i._link),showConfirmationDialog:!1,confirmationCode:b.ConfirmationCode.none,selectedPermissions:i._getLinkSettings(),expirationErrorCode:h.ExpirationErrorCode.none,linkDetailsView:i.props.linkDetailsView};return i}e.prototype.render=function(){var t=this,e=this.props.link,i=e.url,o=h.getLinkIconName(this.props.link),r=h.getLinkLabel(this.props.link,this.props.companyName),n=e.principals&&0<e.principals.length||e.invitees&&0<e.invitees.length;return this.props.enableLinkSettings&&this.state.linkDetailsView?this._renderLinkDetails():this.props.enableLinkSettings?a.createElement("div",null,this._renderShareLink(),this.props.enableLinkSettings&&n&&a.createElement("div",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder","data-is-focusable":!0,"aria-expanded":this.state.linkMemberExpanded},a.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick},!this.state.linkMemberExpanded&&6===this._link.sharingLinkKind&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&a.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},s.default.inviteesHolderLabel),6===this._link.sharingLinkKind&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList()),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):a.createElement("div",null,a.createElement("div",{className:"od-ShareLink flightOff"},a.createElement("div",{className:"od-ShareLink-main"},a.createElement("div",{className:"od-ShareLink-icon"},a.createElement(c.Icon,{iconName:o})),a.createElement("div",{className:"od-ShareLink-details","aria-live":"polite","aria-atomic":"true","aria-relevant":"all","aria-labelledby":"descriptorLive"},a.createElement("div",{id:"descriptorLive",className:"ms-u-screenReaderOnly"},this.state.linkRemovedText),a.createElement(d.TextField,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:i,readOnly:!0,ariaLabel:r,componentRef:function(e){return t._textField=e}})),a.createElement(l.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},ariaLabel:s.default.removeLinkText})),a.createElement("div",{className:"od-ShareLink-description flightOff"},r)),n&&this._renderLinkMembers())};e.prototype._renderLinkDetails=function(){return a.createElement(g.ShareLinkDetails,{companyName:this.props.companyName,link:this._link,participants:this.state.participants,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,mode:this.props.mode,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this.props.showPermissionsList,enableLinkSettings:this.props.enableLinkSettings})};e.prototype._renderParticipantsList=function(){return a.createElement(p.ShareLinkParticipants,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings})};e.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return a.createElement(m.Facepile,{personas:e,personaSize:f.PersonaSize.size24,maxDisplayablePersonas:4,overflowButtonType:m.OverflowButtonType.descriptive,overflowButtonProps:{ariaLabel:s.default.overflowButtonFacepileAriaLabel}})};e.prototype._renderChevron=function(){return a.createElement(l.IconButton,{className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"}})};e.prototype._onChevronClick=function(){this.setState({linkMemberExpanded:!this.state.linkMemberExpanded})};e.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,i=t.confirmationCode,o=t.participants,r=t.participant;return a.createElement(b.ConfirmationDialog,{confirmationCode:i,participants:o,participant:r,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===b.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:b.ConfirmationCode.none})}})};e.prototype._onCancel=function(){var e=this;this.setState(function(){return u.__assign({},e.state,{showConfirmationDialog:!1,participants:h.getLinkParticipants(e._link),expirationErrorCode:h.ExpirationErrorCode.none,selectedPermissions:e._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})});if(!this.state.hasSettingsChange&&!this.state.hasPeopleChange){var t=this.props.showPermissionsList;t&&t()}};e.prototype._onConfirmationDeleteLink=function(){if(this.state.confirmationCode===b.ConfirmationCode.link){this._onShareLinkDelete();this.setState({showConfirmationDialog:!1,confirmationCode:b.ConfirmationCode.none,hasSettingsChange:!1,linkDetailsView:!1})}var e=this.props.showPermissionsList;e&&e()};e.prototype._renderShareLink=function(){var t=this,e=this._link,i=e.url,o=this.state.copyLinkToClipboardSuccess,r=h.getLinkIconName(this.props.link),n=h.getLinkLabel(e,this.props.companyName);return a.createElement("div",{className:"od-ShareLink"},a.createElement("div",{className:"od-ShareLink-main"},a.createElement("div",{className:"od-ShareLink-icon2 icon-"+r},a.createElement(c.Icon,{iconName:r})),a.createElement("div",{className:"od-ShareLink-details","aria-live":"polite","aria-atomic":"true","aria-relevant":"all","aria-labelledby":"descriptorLive"},a.createElement("div",{id:"descriptorLive",className:"od-ShareLink-details-screenReaderOnly"},this.state.linkRemovedText),a.createElement(d.TextField,{"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:i,readOnly:!0,ariaLabel:n,componentRef:function(e){return t._textField=e}})),a.createElement(l.DefaultButton,{onClick:this._copySharingLinkToClipboard,"data-is-focusble":!0},o?s.default.copiedButtonLabel:s.default.copyButtonLabel),this.props.showMoreOptions?a.createElement(l.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails,iconProps:{iconName:"More"},ariaLabel:s.default.moreOptionsLabel}):a.createElement(l.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return t.setState({showConfirmationDialog:!0,confirmationCode:b.ConfirmationCode.link})},iconProps:{iconName:"Cancel"},ariaLabel:s.default.removeLinkText})),a.createElement("div",{className:"od-ShareLink-description",onClick:this._showLinkDetails},n))};e.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}));return a.createElement("ul",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder flightOff","data-is-focusable":!0},e.map(function(e){return a.createElement("li",{key:e.primaryText,"data-is-focusable":!0},a.createElement(n.LinkMember,{primaryText:e.primaryText,imageUrl:e.imageUrl}))}))};e.prototype._showLinkDetails=function(){var e=this.props.onShowLinkDetailsClicked;e&&e(this._link)};e.prototype._onShareLinkDelete=function(){var e=this._link;this.setState({linkRemovedText:s.default.linkRemovedText});this._store.unshareLink(e.sharingLinkKind,e.shareId)};e.prototype._onLinkClicked=function(e){try{var t=e.target;t.focus();t.setSelectionRange(0,t.value.length)}catch(e){}};e.prototype._copySharingLinkToClipboard=function(){var t=this,e=this.props.clientId,i=this._link.url,o=this._textField;h.copySharingLinkToClipboard(e,o,i).then(function(e){t.setState({copyLinkToClipboardSuccess:e});e&&setTimeout(function(){t.setState({copyLinkToClipboardSuccess:!1})},2e3)})};e.prototype._updateLinkSettings=function(e){var t=this,i=[],o=[],r=this.state.participants;if(e)i.push(u.__assign({},e,{type:e.principalType}));else{for(var n=function(t){0===(!0===t.isExternal?r.filter(function(e){return e.email===t.email}):r.filter(function(e){return e.userId===t.loginName})).length&&i.push(t)},a=0,s=this._link.invitees;a<s.length;a++){n(s[a])}for(var l=function(t){if(!0===t.isExternal&&1===d.state.selectedPermissions.audience)return"continue";0===(!0===t.isExternal?d._link.invitees.filter(function(e){return e.email===t.email}):d._link.invitees.filter(function(e){return e.loginName===t.userId})).length&&!0===t.isResolved&&o.push(t)},d=this,c=0,p=r;c<p.length;c++){l(p[c])}}if(0<i.length||0<o.length||this.state.hasSettingsChange){this._store.shareLink(this.state.selectedPermissions,o,void 0,!1,!1,this._link.shareId,i);this._store.addListener(function(){t.setState(function(){var e=t._store.getSharingInformation().sharingLinks.filter(function(e){return e.shareId===t._link.shareId});if(e&&0<e.length){t._link=e[0];return{link:t._link,participants:6===t._link.sharingLinkKind?h.getLinkParticipants(t._link):[]}}})})}};e.prototype._onPeoplePickerChange=function(e,t){this.setState(u.__assign({},this.state,{selectedPermissions:this.state.selectedPermissions,participants:0===e.length?this.state.participants.concat(t):this.state.participants,hasPeopleChange:0===e.length}))};e.prototype._onRoleChange=function(e){var t=this.state.selectedPermissions,i=h.getLinkKind(t.audience,2===e);this.setState(u.__assign({},this.state,{selectedPermissions:u.__assign({},t,{sharingRole:e,isEdit:2===e,sharingLinkKind:i}),hasSettingsChange:e!==this._getSharingRole()||this.state.hasSettingsChange}))};e.prototype._getSharingRole=function(){return this.state.selectedPermissions.isEdit?2:this.state.selectedPermissions.isReview?6:1};e.prototype._onExpirationChange=function(e){var t=this;e||this._link.expiration||(e=h.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(function(){return u.__assign({},t.state,{selectedPermissions:u.__assign({},t.state.selectedPermissions,{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})})};e.prototype._onPasswordChange=function(e){var t=this;this.setState(function(){return u.__assign({},t.state,{selectedPermissions:u.__assign({},t.state.selectedPermissions,{password:e,updatePassword:0<e.length}),hasSettingsChange:!0})})};e.prototype._getLinkSettings=function(){return{allowEditing:!0,audience:this._link.audience,expiration:this._link.expiration,isEdit:this._link.isEdit,isReview:this._link.isReview,sharingLinkKind:this._link.sharingLinkKind,specificPeople:h.getLinkParticipants(this._link),updatePassword:this._link.updatePassword,password:this._link.password,sharingRole:this._getSharingRoleFromLink(),preventDownload:this._link.blockDownload,hasPassword:this._link.hasPassword}};e.prototype._getSharingRoleFromLink=function(){return this._link.isEdit?2:this._link.isReview?6:1};e.contextTypes={sharingStore:i.object.isRequired};u.__decorate([r.autobind],e.prototype,"_renderLinkDetails",null);u.__decorate([r.autobind],e.prototype,"_onChevronClick",null);u.__decorate([r.autobind],e.prototype,"_onCancel",null);u.__decorate([r.autobind],e.prototype,"_onConfirmationDeleteLink",null);u.__decorate([r.autobind],e.prototype,"_showLinkDetails",null);u.__decorate([r.autobind],e.prototype,"_onShareLinkDelete",null);u.__decorate([r.autobind],e.prototype,"_onLinkClicked",null);u.__decorate([r.autobind],e.prototype,"_copySharingLinkToClipboard",null);u.__decorate([r.autobind],e.prototype,"_updateLinkSettings",null);u.__decorate([r.autobind],e.prototype,"_onPeoplePickerChange",null);u.__decorate([r.autobind],e.prototype,"_onRoleChange",null);u.__decorate([r.autobind],e.prototype,"_onExpirationChange",null);u.__decorate([r.autobind],e.prototype,"_onPasswordChange",null);u.__decorate([r.autobind],e.prototype,"_getLinkSettings",null);return e}(a.Component);t.ShareLink=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/LinkMember/LinkMember",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","./LinkMember.scss"],function(e,t,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}e.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{className:"od-LinkMember"},s.createElement(a.Persona,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:a.PersonaInitialsColor.blue,size:a.PersonaSize.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&s.createElement(n.Callout,{directionalHint:1,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},s.createElement("div",{className:"od-LinkMember-tooltip"},s.createElement("span",null,e.primaryText))))};e.prototype._onShowCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!0}))};e.prototype._onDismissCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!1}))};i.__decorate([r.autobind],e.prototype,"_onShowCallout",null);i.__decorate([r.autobind],e.prototype,"_onDismissCallout",null);return e}(s.Component);t.LinkMember=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/LinkMember/LinkMember.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkParticipants/ShareLinkParticipants",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Utilities","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../Share.resx"],function(e,t,i,n,r,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:l.ConfirmationCode.none,hasPeopleChange:!1};return i}e.prototype.render=function(){var t=this;return n.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(e){return n.createElement("li",{className:"od-ShareLink-personaItem",key:t.props.showDetailsPanel?"Panel-li-"+e.email:e.email},n.createElement(r.Persona,{imageUrl:e.image,primaryText:e.name,secondaryText:e.isExternal?d.default.externalUser:e.job,size:r.PersonaSize.size32,showSecondaryText:!(!e.job&&!e.isExternal)}),6===t.props.link.sharingLinkKind&&n.createElement(a.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){return t.setState({showConfirmationDialog:!0,confirmationCode:l.ConfirmationCode.participant,participant:e})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};e.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,i=t.confirmationCode,o=t.participants,r=t.participant;return n.createElement(l.ConfirmationDialog,{confirmationCode:i,participants:o,participant:r,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===l.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:l.ConfirmationCode.none})}})};e.prototype._onCancel=function(){var e=this;this.setState(function(){return i.__assign({},e.state,{showDetailsPanel:!1,showConfirmationDialog:!1,participants:e.state.participants,hasPeopleChange:!1})})};e.prototype._onConfirmationDeleteParticipant=function(){if(this.state.confirmationCode===l.ConfirmationCode.participant){this._onLinkParticipantDelete();this.setState({showConfirmationDialog:!1,confirmationCode:l.ConfirmationCode.none})}};e.prototype._onLinkParticipantDelete=function(){var t=this.state.participant,e=[];if(this.props.showDetailsPanel){e=!0===t.isExternal?this.props.participants.filter(function(e){return e.email!==t.email}):this.props.participants.filter(function(e){return e.principalName!==t.principalName});this.setState(i.__assign({},this.state,{participants:e,hasPeopleChange:!0}));this.props.onRemoveParticipant(t,e)}else this.props.updateLinkSettings(t)};i.__decorate([s.autobind],e.prototype,"_onCancel",null);i.__decorate([s.autobind],e.prototype,"_onConfirmationDeleteParticipant",null);i.__decorate([s.autobind],e.prototype,"_onLinkParticipantDelete",null);return e}(n.Component);t.ShareLinkParticipants=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../../../Share.resx","./ConfirmationDialog.scss"],function(e,t,o,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p;!function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.participant=2]="participant";e[e.linkSettings=3]="linkSettings";e[e.back=4]="back"}(p=t.ConfirmationCode||(t.ConfirmationCode={}));var i=function(i){o.__extends(e,i);function e(e,t){return i.call(this,e)||this}e.prototype.render=function(){var e,t,i,o=this.props,r=o.confirmationCode,n=o.participant;switch(r){case p.link:e=c.default.deleteLinkDialogTitle;t=c.default.deleteLinkButtonText;i=c.default.cancelButtonText;break;case p.linkSettings:e=c.default.changeLinkSettingsDialogTitle;t=c.default.changeItButtonText;i=c.default.cancelButtonText;break;case p.participant:e=d.format(c.default.deleteLinkParticipantDialogTitle,n.name);t=c.default.removeButtonText;i=c.default.cancelButtonText;break;case p.back:e=c.default.leaveLinkSettingsDialogTitle;t=c.default.saveButtonText;i=c.default.cancelButtonText}return a.createElement("div",null,a.createElement(s.Dialog,{hidden:!1,className:"od-confirmationDialog",onDismiss:this.props.onCancel,dialogContentProps:{type:s.DialogType.close,title:e},modalProps:{isDarkOverlay:!0,isBlocking:!0}},this._getDialogSubText(),r===p.back?a.createElement(s.DialogFooter,{className:"od-confirmationDialog-footer"},a.createElement(l.DefaultButton,{className:"od-confirmationDialog-discard",onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:c.default.discardButtonText}),a.createElement("div",{className:"od-confirmationDialog-saveCancel"},a.createElement(l.PrimaryButton,{onClick:this.props.onApply,text:t}),a.createElement(l.DefaultButton,{onClick:this.props.onCancel,text:i}))):a.createElement(s.DialogFooter,null,a.createElement(l.PrimaryButton,{onClick:this.props.onApply,text:t}),a.createElement(l.DefaultButton,{onClick:this.props.onCancel,text:i}))))};e.prototype._getDialogSubText=function(){switch(this.props.confirmationCode){case p.link:return a.createElement("div",{className:"od-ConfirmationDialog-subText"},a.createElement("span",null,a.createElement("strong",null,c.default.deleteLinkLeadText)),a.createElement("span",null,c.default.deleteLinkEndText));case p.linkSettings:return a.createElement("div",{className:"od-ConfirmationDialog-subText"},a.createElement("span",null,c.default.applyLinkSettingsText));case p.participant:return}};return e}(a.Component);t.ConfirmationDialog=i});define("office-ui-fabric-react/lib/Dialog",["require","exports","tslib","./components/Dialog/index","./components/Dialog/index"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.Dialog});define("office-ui-fabric-react/lib/components/Dialog/index",["require","exports","tslib","./Dialog","./Dialog.base","./DialogContent","./DialogContent.base","./DialogFooter","./DialogFooter.base","./DialogContent.types"],function(e,t,i,o,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t)});define("office-ui-fabric-react/lib/components/Dialog/Dialog",["require","exports","../../Utilities","./Dialog.base","./Dialog.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Dialog=i.styled(o.DialogBase,r.getStyles,void 0,{scope:"Dialog"})});define("office-ui-fabric-react/lib/components/Dialog/Dialog.base",["require","exports","tslib","react","../../Utilities","./DialogContent.types","../../Modal","../../utilities/decorators/withResponsiveMode","./DialogContent"],function(e,t,C,I,i,o,T,r,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=i.classNamesFunction(),E={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:""},M={type:o.DialogType.normal,className:"",topButtonsProps:[]},n=function(t){C.__extends(e,t);function e(e){var a=t.call(this,e)||this;a._getSubTextId=function(){var e=a.props,t=e.ariaDescribedById,i=e.modalProps,o=e.dialogContentProps,r=e.subText,n=t||i&&i.subtitleAriaId;n||(n=(r||o&&o.subText)&&a._defaultSubTextId);return n};a._getTitleTextId=function(){var e=a.props,t=e.ariaLabelledById,i=e.modalProps,o=e.dialogContentProps,r=e.title,n=t||i&&i.titleAriaId;n||(n=(r||o&&o.title)&&a._defaultTitleTextId);return n};a._id=i.getId("Dialog");a._defaultTitleTextId=a._id+"-title";a._defaultSubTextId=a._id+"-subText";a._warnDeprecations({isOpen:"hidden",type:"dialogContentProps.type",subText:"dialogContentProps.subText",contentClassName:"dialogContentProps.className",topButtonsProps:"dialogContentProps.topButtonsProps",className:"modalProps.className",isDarkOverlay:"modalProps.isDarkOverlay",isBlocking:"modalProps.isBlocking",containerClassName:"modalProps.containerClassName",onDismissed:"modalProps.onDismissed",onLayerDidMount:"modalProps.onLayerDidMount",ariaDescribedById:"modalProps.subtitleAriaId",ariaLabelledById:"modalProps.titleAriaId"});return a}e.prototype.render=function(){var e=this.props,t=e.className,i=e.containerClassName,o=e.contentClassName,r=e.elementToFocusOnDismiss,n=e.firstFocusableSelector,a=e.forceFocusInsideTrap,s=e.styles,l=e.hidden,d=e.ignoreExternalFocusing,c=e.isBlocking,p=e.isClickableOutsideFocusTrap,u=e.isDarkOverlay,h=e.isOpen,m=e.onDismiss,g=e.onDismissed,f=e.onLayerDidMount,b=e.responsiveMode,y=e.subText,v=e.theme,x=e.title,_=e.topButtonsProps,S=e.type,k=C.__assign({},E,this.props.modalProps),P=C.__assign({},M,this.props.dialogContentProps),w=L(s,{theme:v,className:t||k.className,containerClassName:i||k.containerClassName,hidden:l});return I.createElement(T.Modal,C.__assign({elementToFocusOnDismiss:r,firstFocusableSelector:n,forceFocusInsideTrap:a,ignoreExternalFocusing:d,isClickableOutsideFocusTrap:p,onDismissed:g,onLayerDidMount:f,responsiveMode:b},k,{isDarkOverlay:void 0!==u?u:k.isDarkOverlay,isBlocking:void 0!==c?c:k.isBlocking,isOpen:void 0!==h?h:!l,className:w.root,containerClassName:w.main,onDismiss:m||k.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),I.createElement(D.DialogContent,C.__assign({titleId:this._defaultTitleTextId,subTextId:this._defaultSubTextId,title:x,subText:y,showCloseButton:void 0!==c?!c:!k.isBlocking,topButtonsProps:_||P.topButtonsProps,type:void 0!==S?S:P.type,onDismiss:m||P.onDismiss,className:o||P.className},P),this.props.children))};e.defaultProps={hidden:!0};return e=C.__decorate([r.withResponsiveMode],e)}(i.BaseComponent);t.DialogBase=n});define("office-ui-fabric-react/lib/components/Dialog/DialogContent.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.normal=0]="normal";e[e.largeHeader=1]="largeHeader";e[e.close=2]="close"}(t.DialogType||(t.DialogType={}))});define("office-ui-fabric-react/lib/Modal",["require","exports","tslib","./components/Modal/index","./components/Modal/index"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.default=r.Modal});define("office-ui-fabric-react/lib/components/Modal/index",["require","exports","tslib","./Modal"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Modal/Modal",["require","exports","../../Utilities","./Modal.base","./Modal.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Modal=i.styled(o.ModalBase,r.getStyles,void 0,{scope:"Modal"})});define("office-ui-fabric-react/lib/components/Modal/Modal.base",["require","exports","tslib","react","../../Utilities","../FocusTrapZone/index","./Modal.styles","../../Overlay","../../Layer","../Popup/index","../../utilities/decorators/withResponsiveMode"],function(e,t,o,_,r,S,k,P,w,C,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=r.classNamesFunction(),i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._focusTrapZone=r.createRef();t.state={id:r.getId("Modal"),isOpen:e.isOpen,isVisible:e.isOpen};return t}e.prototype.componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer);e.isOpen&&(this.state.isOpen?this.setState({isVisible:!0}):this.setState({isOpen:!0}));if(!e.isOpen&&this.state.isOpen){this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(k.animationDuration));this.setState({isVisible:!1})}};e.prototype.componentDidUpdate=function(e,t){e.isOpen||t.isVisible||this.setState({isVisible:!0})};e.prototype.render=function(){var e=this.props,t=e.className,i=e.containerClassName,o=e.elementToFocusOnDismiss,r=e.firstFocusableSelector,n=e.forceFocusInsideTrap,a=e.ignoreExternalFocusing,s=e.isBlocking,l=e.isClickableOutsideFocusTrap,d=e.isDarkOverlay,c=e.onDismiss,p=e.onLayerDidMount,u=e.responsiveMode,h=e.titleAriaId,m=e.styles,g=e.subtitleAriaId,f=e.theme,b=this.state,y=b.isOpen,v=b.isVisible;if(!y)return null;var x=T(m,{theme:f,className:t,containerClassName:i,isOpen:y,isVisible:v});return u>=I.ResponsiveMode.small?_.createElement(w.Layer,{onLayerDidMount:p},_.createElement(C.Popup,{role:s?"alertdialog":"dialog",ariaLabelledBy:h,ariaDescribedBy:g,onDismiss:c},_.createElement("div",{className:x.root},_.createElement(P.Overlay,{isDarkThemed:d,onClick:s?void 0:c,styles:k.getOverlayStyles}),_.createElement(S.FocusTrapZone,{componentRef:this._focusTrapZone,className:x.main,elementToFocusOnDismiss:o,isClickableOutsideFocusTrap:l||!s,ignoreExternalFocusing:a,forceFocusInsideTrap:n,firstFocusableSelector:r},this.props.children)))):null};e.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()};e.prototype._onModalClose=function(){this.setState({isOpen:!1});this.props.onDismissed&&this.props.onDismissed()};e.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""};return e=o.__decorate([I.withResponsiveMode],e)}(r.BaseComponent);t.ModalBase=i});define("office-ui-fabric-react/lib/components/Modal/Modal.styles",["require","exports","../../Styling"],function(e,l,d){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.animationDuration=d.AnimationVariables.durationValue2;l.getOverlayStyles={root:{selectors:(t={},t[d.HighContrastSelector]={opacity:0},t)}};var t,c={root:"ms-Modal",main:"ms-Dialog-main",isOpen:"is-open"};l.getStyles=function(e){var t=e.className,i=e.containerClassName,o=e.isOpen,r=e.isVisible,n=e.theme,a=n.palette,s=d.getGlobalClassNames(c,n);return{root:[s.root,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+l.animationDuration},o&&s.isOpen,r&&{opacity:1,pointerEvents:"auto"},t],main:[s.main,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)",backgroundColor:a.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid tranparent",maxHeight:"100%",overflowY:"auto"},i]}}});define("office-ui-fabric-react/lib/components/Dialog/DialogContent",["require","exports","../../Utilities","./DialogContent.base","./DialogContent.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DialogContent=i.styled(o.DialogContentBase,r.getStyles,void 0,{scope:"DialogContent"})});define("office-ui-fabric-react/lib/components/Dialog/DialogContent.base",["require","exports","tslib","react","../../Utilities","./DialogContent.types","../../Button","./DialogFooter","../../utilities/decorators/withResponsiveMode"],function(e,t,g,f,i,b,y,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=i.classNamesFunction(),n=function(t){g.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e,t=this.props,i=t.showCloseButton,o=t.className,r=t.closeButtonAriaLabel,n=t.onDismiss,a=t.subTextId,s=t.subText,l=t.titleId,d=t.title,c=t.type,p=t.styles,u=t.theme,h=v(p,{theme:u,className:o,isLargeHeader:c===b.DialogType.largeHeader,isClose:c===b.DialogType.close}),m=this._groupChildren();s&&(e=f.createElement("p",{className:h.subText,id:a},s));return f.createElement("div",{className:h.content},f.createElement("div",{className:h.header},f.createElement("p",{className:h.title,id:l,role:"heading","aria-level":2},d),f.createElement("div",{className:h.topButton},this.props.topButtonsProps.map(function(e,t){return f.createElement(y.IconButton,g.__assign({key:e.uniqueId||t},e))}),(c===b.DialogType.close||i&&c!==b.DialogType.largeHeader)&&f.createElement(y.IconButton,{className:h.button,iconProps:{iconName:"Cancel"},ariaLabel:r,onClick:n}))),f.createElement("div",{className:h.inner},f.createElement("div",{className:h.innerContent},e,m.contents),m.footers))};e.prototype._groupChildren=function(){var t={footers:[],contents:[]};f.Children.map(this.props.children,function(e){"object"==typeof e&&null!==e&&e.type===o.DialogFooter?t.footers.push(e):t.contents.push(e)});return t};e.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"};return e=g.__decorate([r.withResponsiveMode],e)}(i.BaseComponent);t.DialogContentBase=n});define("office-ui-fabric-react/lib/components/Dialog/DialogFooter",["require","exports","../../Utilities","./DialogFooter.base","./DialogFooter.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DialogFooter=i.styled(o.DialogFooterBase,r.getStyles,void 0,{scope:"DialogFooter"})});define("office-ui-fabric-react/lib/components/Dialog/DialogFooter.base",["require","exports","tslib","react","../../Utilities"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.classNamesFunction(),a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.className,i=e.styles,o=e.theme;this._classNames=n(i,{theme:o,className:t});return r.createElement("div",{className:this._classNames.actions},r.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))};t.prototype._renderChildrenAsActions=function(){var t=this;return r.Children.map(this.props.children,function(e){return e?r.createElement("span",{className:t._classNames.action},e):null})};return t}(o.BaseComponent);t.DialogFooterBase=a});define("office-ui-fabric-react/lib/components/Dialog/DialogFooter.styles",["require","exports","../../Styling"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};t.getStyles=function(e){var t=e.className,i=e.theme,o=r.getGlobalClassNames(n,i);return{actions:[o.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"20px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[o.action],actionsRight:[o.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0",selectors:{$action:{margin:"0 4px"}}}]}}});define("office-ui-fabric-react/lib/components/Dialog/DialogContent.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};t.getStyles=function(e){var t=e.className,i=e.theme,o=e.isLargeHeader,r=e.isClose,n=e.hidden,a=e.isMultiline,s=i.palette,l=i.fonts,d=c.getGlobalClassNames(p,i);return{content:[o&&d.contentLgHeader,r&&d.close,{flexGrow:1,overflowY:"auto"},t],subText:[d.subText,o?l.medium:l.small,{margin:"0 0 20px 0",paddingTop:"8px",color:s.neutralPrimary,lineHeight:"1.5",wordWrap:"break-word",fontWeight:c.FontWeights.semilight}],header:[d.header,{position:"relative",width:"100%",boxSizing:"border-box"},o&&[d.headerLg,{backgroundColor:s.themePrimary}],r&&d.close],button:[d.button,n&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:s.neutralSecondary,fontSize:"16px"}}}],inner:[d.inner,{padding:a?"0 20px 20px":"0 28px 20px"}],innerContent:[d.content,{position:"relative",width:"100%",selectors:{".ms-Button.ms-Button--compount":{marginBottom:"20px",selectors:{"&:last-child":{marginBottom:"0"}}}}},t],title:[d.title,{color:s.neutralPrimary,margin:"0",padding:"20px 36px 20px 28px"},l.xLarge,o&&[{color:s.white,marginBottom:"8px",padding:"26px 28px 28px"},l.xxLarge],a&&l.xxLarge],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"12px 12px 0 0",selectors:{"> *":{flex:"0 0 auto"}}}]}}});define("office-ui-fabric-react/lib/components/Dialog/Dialog.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={root:"ms-Dialog"};t.getStyles=function(e){var t,i=e.className,o=e.containerClassName,r=e.dialogDefaultMinWidth,n=void 0===r?"288px":r,a=e.dialogDefaultMaxWidth,s=void 0===a?"340px":a,l=e.hidden,d=e.theme;return{root:[c.getGlobalClassNames(p,d).root,i],main:[{width:n,selectors:(t={},t["@media (min-width: "+c.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:n},t)},!l&&{display:"flex"},o]}}});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:12px}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}[dir=ltr] .od-confirmationDialog-discard{float:left}[dir=rtl] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0 4px}"}])});define("office-ui-fabric-react/lib/Facepile",["require","exports","tslib","./components/Facepile/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Facepile/index",["require","exports","tslib","./Facepile.types","./Facepile.base","./Facepile"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t)});define("office-ui-fabric-react/lib/components/Facepile/Facepile.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.descriptive=1]="descriptive";e[e.more=2]="more";e[e.downArrow=3]="downArrow"}(t.OverflowButtonType||(t.OverflowButtonType={}))});define("office-ui-fabric-react/lib/components/Facepile/Facepile.base",["require","exports","tslib","react","../../Utilities","./Facepile.types","../../FocusZone","./FacepileButton","../../Icon","../../Persona","../../PersonaCoin"],function(e,t,s,h,o,r,m,l,n,a,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o.classNamesFunction(),i=function(i){s.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._classNames=c(t.props.styles,{theme:t.props.theme,className:t.props.className});t._ariaDescriptionId=o.getId();return t}e.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,i=t.ariaDescription,o=t.chevronButtonProps,r=t.maxDisplayablePersonas,n=t.personas,a=t.overflowPersonas,s=t.showAddButton,l=this._classNames,d=Math.min(n.length,r||n.length);o&&!e&&(e=o);var c=a&&0<a.length,p=c?n:n.slice(0,d),u=(c?a:n.slice(d))||[];return h.createElement("div",{className:l.root},this.onRenderAriaDescription(),h.createElement("div",{className:l.itemContainer},s?this._getAddNewElement():null,h.createElement(m.FocusZone,{ariaDescribedBy:i&&this._ariaDescriptionId,role:"listbox",direction:m.FocusZoneDirection.horizontal},h.createElement("ul",{className:l.members},this._onRenderVisiblePersonas(p,0===u.length&&1===n.length))),e?this._getOverflowElement(u):null))};e.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&h.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)};e.prototype._onRenderVisiblePersonas=function(e,o){var r=this;return e.map(function(e,t){var i=o?r._getPersonaControl(e):r._getPersonaCoinControl(e);return h.createElement("li",{key:(o?"persona":"personaCoin")+"-"+t,className:r._classNames.member},e.onClick?r._getElementWithOnClickEvent(i,e,t):r._getElementWithoutOnClickEvent(i,e,t))})};e.prototype._getPersonaControl=function(e){var t=this.props,i=t.getPersonaProps,o=t.personaSize;return h.createElement(a.Persona,s.__assign({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},i?i(e):null,{styles:{details:{flex:"1 0 auto"}}}))};e.prototype._getPersonaCoinControl=function(e){var t=this.props,i=t.getPersonaProps,o=t.personaSize;return h.createElement(d.PersonaCoin,s.__assign({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},i?i(e):null))};e.prototype._getElementWithOnClickEvent=function(e,t,i){return h.createElement(l.FacepileButton,s.__assign({},o.getNativeProps(t,o.buttonProperties),this._getElementProps(t,i),{onClick:this._onPersonaClick.bind(this,t)}),e)};e.prototype._getElementWithoutOnClickEvent=function(e,t,i){return h.createElement("div",s.__assign({},o.getNativeProps(t,o.buttonProperties),this._getElementProps(t,i)),e)};e.prototype._getElementProps=function(e,t){var i=this._classNames;return{key:(e.imageUrl?"i":"")+t,"data-is-focusable":!0,role:"option",className:i.itemButton,title:e.personaName,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}};e.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case r.OverflowButtonType.descriptive:return this._getDescriptiveOverflowElement(e);case r.OverflowButtonType.downArrow:return this._getIconElement("ChevronDown");case r.OverflowButtonType.more:return this._getIconElement("More");default:return null}};e.prototype._getDescriptiveOverflowElement=function(e){var t=this.props,i=t.overflowButtonProps,o=t.personaSize;if(!e||e.length<1)return null;var r=e.map(function(e){return e.personaName}).join(", "),n=Math.max(e.length,0),a=this._classNames;return h.createElement(l.FacepileButton,s.__assign({},i,{ariaDescription:r,className:a.descriptiveOverflowButton}),h.createElement(d.PersonaCoin,{title:r,size:o,onRenderInitials:this._renderInitialsNotPictured(n),initialsColor:d.PersonaInitialsColor.transparent}))};e.prototype._getIconElement=function(e){var t=this.props,i=t.overflowButtonProps,o=t.personaSize,r=this._classNames;return h.createElement(l.FacepileButton,s.__assign({},i,{className:r.overflowButton}),h.createElement(d.PersonaCoin,{size:o,onRenderInitials:this._renderInitials(e,!0),initialsColor:d.PersonaInitialsColor.transparent}))};e.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,i=e.personaSize,o=this._classNames;return h.createElement(l.FacepileButton,s.__assign({},t,{className:o.addButton}),h.createElement(d.PersonaCoin,{size:i,onRenderInitials:this._renderInitials("AddFriend")}))};e.prototype._onPersonaClick=function(e,t){e.onClick(t,e);t.preventDefault();t.stopPropagation()};e.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)};e.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)};e.prototype._renderInitials=function(e,t){var i=this._classNames;return function(){return h.createElement(n.Icon,{iconName:e,className:t?i.overflowInitialsIcon:""})}};e.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return h.createElement("span",{className:t.overflowInitialsIcon},"+"+e)}};e.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:d.PersonaSize.size32};return e}(o.BaseComponent);t.FacepileBase=i});define("office-ui-fabric-react/lib/components/Facepile/FacepileButton",["require","exports","tslib","react","../../Utilities","../../Button","../../Styling","../Button/BaseButton.styles"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=s.getStyles(a.getTheme());return o.createElement(n.BaseButton,i.__assign({},this.props,{styles:e}))};return t}(r.BaseComponent);t.FacepileButton=l});define("office-ui-fabric-react/lib/PersonaCoin",["require","exports","tslib","./components/Persona/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Facepile/Facepile",["require","exports","../../Utilities","./Facepile.base","./Facepile.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Facepile=i.styled(o.FacepileBase,r.styles,void 0,{scope:"Facepile"})});define("office-ui-fabric-react/lib/components/Facepile/Facepile.styles",["require","exports","../../Styling"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"};t.styles=function(e){var t=e.className,i=e.theme,o=e.spacingAroundItemButton,r=void 0===o?2:o,n=i.palette,a=i.fonts,s=d.getGlobalClassNames(c,i),l={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",selectors:{"button&":{display:"inline",background:"none",backgroundColor:"transparent",padding:0,cursor:"pointer",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}}}};return{root:[s.root,{width:"auto"},t],addButton:[s.addButton,d.getFocusStyle(i,-1),l,{selectors:{"button&":{fontSize:a.medium.fontSize,color:n.white,backgroundColor:n.themePrimary,marginRight:2*r+"px",selectors:{"&:hover":{backgroundColor:n.themeDark},"&:focus":{backgroundColor:n.themeDark},"&:active":{backgroundColor:n.themeDarker},"&:disabled":{backgroundColor:n.neutralTertiaryAlt}}}}}],descriptiveOverflowButton:[s.descriptiveOverflowButton,d.getFocusStyle(i,-1),l,{selectors:{"button&":{fontSize:a.small.fontSize,color:n.neutralSecondary,backgroundColor:n.neutralLight,marginLeft:2*r+"px"}}}],itemButton:[s.itemButton,l],itemContainer:[s.itemContainer,{display:"flex"}],members:[s.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+r+"px"}],member:[s.member,{display:"inline-flex",flex:"0 0 auto",margin:r+"px"}],overflowButton:[s.overflowButton,d.getFocusStyle(i,-1),l,{selectors:{"button&":{fontSize:a.medium.fontSize,color:n.neutralSecondary,backgroundColor:n.neutralLight,marginLeft:2*r+"px"}}}],overflowInitialsIcon:[{color:n.neutralPrimary}],screenReaderOnly:d.hiddenContentStyle}}});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkDetails/ShareLinkDetails",["require","exports","tslib","react","prop-types","../../Share.resx","../ShareLinkParticipants/ShareLinkParticipants","../../PeoplePicker/PeoplePicker","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Utilities","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker","../ShareLink/ChangePermission/ChangePermission","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","../../ModifyPermissions/PreventDownload/PreventDownload","../../ModifyPermissions/PasswordField/PasswordField","@ms/odsp-utilities/lib/string/StringHelper","../ShareLink/ShareLink","./ShareLinkDetails.scss"],function(e,t,r,n,i,a,s,l,d,c,p,u,h,m,g,f,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._store=t.sharingStore;i._link=i.props.link;i.state={expirationErrorCode:m.ExpirationErrorCode.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none,participants:i.props.participants,linkRemovedText:"",selectedPermissions:i.props.selectedPermissions,peoplePickerError:d.renderPickerError({selectedItems:r.__assign({},i.props.participants),sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})};return i}e.prototype.render=function(){return n.createElement("div",{className:"od-ShareLinkDetails--div"},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())};e.prototype._renderDetailsPanelContent=function(){return n.createElement("div",{className:"od-ShareLinkDetails--content"},this._renderShareLink(),n.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},a.default.modifyPermissionsHeader),n.createElement("div",{className:"od-ShareLinkDetails--changeSettings"},this._renderChangePermission(),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()),n.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},4===this.props.link.audience?a.default.flexibleLinkPeoplePickerHeader:a.default.notFlexibleLinkPeoplePickerHeader),this._renderPeoplePicker(),this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};e.prototype._renderShareLink=function(){return n.createElement(v.ShareLink,{link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList})};e.prototype._renderDetailsPanelHeader=function(){return n.createElement("div",{className:"od-ShareLinkDetails--header"},n.createElement(g.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Back"},onClick:this._onBack}),n.createElement("span",null,a.default.manageExistingAccessLabel))};e.prototype._renderDetailsPanelActions=function(){return n.createElement("div",{className:"od-ShareLinkDetails--actions"},n.createElement(g.DefaultButton,{primary:!0,onClick:this._onSave,disabled:!(this.state.hasPeopleChange||this.state.hasSettingsChange)},a.default.saveButtonText),n.createElement(g.DefaultButton,{onClick:this._onCancel,disabled:!(this.state.hasPeopleChange||this.state.hasSettingsChange)},a.default.discardButtonText))};e.prototype._renderParticipantsList=function(){return n.createElement(s.ShareLinkParticipants,{link:this._link,showDetailsPanel:!0,participants:this.state.participants,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant})};e.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,i=d.getOversharingExternalsWarning(t.participants),o=d.getOversharingGroupsWarning(t.participants,this.props.groupsMemberCount);if(4===this.props.selectedPermissions.audience)return n.createElement(l.default,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:i,oversharingGroupsWarning:o,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId})};e.prototype._onPeoplePickerChange=function(e){var t=d.renderPickerError({selectedItems:this.state.participants,sharingLinkKind:this._link.sharingLinkKind,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this._store.getPolicyTipInformation,permissionsMap:this._store.getPermissionsMap()}),i=e[0],o=[];o=!0===i.isExternal?this.state.participants.filter(function(e){return e.email===i.email}):this.state.participants.filter(function(e){return e.userId===i.userId});this.setState({participants:0===o.length?this.state.participants.concat(e):this.state.participants,hasPeopleChange:0===o.length,peoplePickerError:t});this.props.onPeoplePickerChange(o,e)};e.prototype._onRemoveParticipant=function(e,t){this.setState({participants:t})};e.prototype._renderChangePermission=function(){return n.createElement("div",{className:"od-ShareLinkDetails--setting"},n.createElement(h.ChangePermission,{selectedPermissions:this.props.getLinkSettings(),onRoleChange:this._onRoleChange,clientId:this.props.clientId,appmap:this.props.sharingInformation.item.appmap}))};e.prototype._onRoleChange=function(e){this.setState({hasSettingsChange:!0});this.props.onRoleChange(e)};e.prototype._renderExpirationDatePicker=function(){var e=this.state.selectedPermissions;if(2===e.audience)return n.createElement("div",{className:"od-ShareLinkDetails--setting"},n.createElement("div",{className:"od-ShareLinkDetails--datePicker"},n.createElement(u.ExpirationDatePicker,{onSelectDate:this._onSelectDate,value:e.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays})),n.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage()))};e.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return m.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};e.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;t&&(e=t.primaryText?y.format(a.default.passwordSetBy,t.primaryText):t.email?y.format(a.default.passwordSetBy,t.email):"");return n.createElement("div",{className:"od-ShareLinkDetails--setting"},n.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},n.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},n.createElement(b.PasswordField,{onPasswordChange:this._onPasswordChange,detailsPane:!0})),n.createElement("span",{className:"od-ShareLinkDetails--passwordCreatedByLabel"},e)))}};e.prototype._onPasswordChange=function(e){var t=this;this.setState(function(){return r.__assign({},t.state,{hasSettingsChange:0<e.length})});this.props.onPasswordChange(e)};e.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return n.createElement("div",{className:"od-ShareLinkDetails--setting"},n.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},n.createElement(f.PreventDownload,{isToggled:e,disablePreventDownload:!0,detailsPane:!0})))};e.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,i=t.confirmationCode,o=t.participants,r=t.participant;return n.createElement(p.ConfirmationDialog,{confirmationCode:i,participants:o,participant:r,onApply:this._onConfirmationApply,onCancel:this.state.confirmationCode===p.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none})},onDiscard:this.props.showPermissionsList})};e.prototype._onConfirmationApply=function(){switch(this.state.confirmationCode){case p.ConfirmationCode.link:this._onShareLinkDelete();this.setState({showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none,hasSettingsChange:!1});return;case p.ConfirmationCode.linkSettings:this._onLinkSettingsApply();this.setState({showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none,hasSettingsChange:!1});return;case p.ConfirmationCode.back:this.setState(r.__assign({},this.state,{showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none}));return}};e.prototype._onShareLinkDelete=function(){var e=this._link;this.setState({linkRemovedText:a.default.linkRemovedText});this._store.unshareLink(e.sharingLinkKind,e.shareId)};e.prototype._onCancel=function(){this.setState(r.__assign({},this.state,{showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none}));this.props.onCancel()};e.prototype._onSave=function(){if(this.state.hasSettingsChange)this.setState(r.__assign({},this.state,{confirmationCode:p.ConfirmationCode.linkSettings,showConfirmationDialog:!0}));else if(this.state.hasPeopleChange){this.setState(r.__assign({},this.state,{hasPeopleChange:!1}));this.props.updateLinkSettings(null)}};e.prototype._onLinkSettingsApply=function(){this.props.updateLinkSettings(null)};e.prototype._onBack=function(){this.state.hasPeopleChange||this.state.hasSettingsChange?this.setState(r.__assign({},this.state,{showConfirmationDialog:!0,confirmationCode:p.ConfirmationCode.back})):this.props.onCancel()};e.prototype._onSelectDate=function(e){var t=this,i=this.props.sharingInformation.anonymousLinkExpirationRestrictionDays;m.getExpirationErrorCode(e,i)!==m.ExpirationErrorCode.none?this.setState(r.__assign({},this.state,{expirationErrorCode:m.getExpirationErrorCode(e,i)}),function(){t._updateExpirationErrorCode(m.getExpirationErrorCode(e,i))}):this.setState(r.__assign({},this.state,{expirationErrorCode:m.getExpirationErrorCode(e,i)}),function(){t._updateExpirationErrorCode(m.getExpirationErrorCode(e,i));t._onExpirationChange(e)})};e.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return r.__assign({},t.state,{selectedPermissions:r.__assign({},t.state.selectedPermissions,{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})});this.props.onExpirationChange(e)};e.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(r.__assign({},this.state,{expirationErrorCode:e}))};e.contextTypes={sharingStore:i.object.isRequired};r.__decorate([c.autobind],e.prototype,"_renderDetailsPanelContent",null);r.__decorate([c.autobind],e.prototype,"_renderShareLink",null);r.__decorate([c.autobind],e.prototype,"_renderDetailsPanelHeader",null);r.__decorate([c.autobind],e.prototype,"_renderDetailsPanelActions",null);r.__decorate([c.autobind],e.prototype,"_renderParticipantsList",null);r.__decorate([c.autobind],e.prototype,"_onPeoplePickerChange",null);r.__decorate([c.autobind],e.prototype,"_onRemoveParticipant",null);r.__decorate([c.autobind],e.prototype,"_onRoleChange",null);r.__decorate([c.autobind],e.prototype,"_onPasswordChange",null);r.__decorate([c.autobind],e.prototype,"_onConfirmationApply",null);r.__decorate([c.autobind],e.prototype,"_onShareLinkDelete",null);r.__decorate([c.autobind],e.prototype,"_onCancel",null);r.__decorate([c.autobind],e.prototype,"_onSave",null);r.__decorate([c.autobind],e.prototype,"_onLinkSettingsApply",null);r.__decorate([c.autobind],e.prototype,"_onBack",null);r.__decorate([c.autobind],e.prototype,"_onSelectDate",null);r.__decorate([c.autobind],e.prototype,"_updateExpirationErrorCode",null);return e}(n.Component);t.ShareLinkDetails=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkDetails/ShareLinkDetails.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;padding:0 20px;box-sizing:border-box;position:absolute;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:40px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}[dir=ltr] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--changeSettings{padding:22px 0 12px;min-height:136px}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:-ms-flexbox;display:flex}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{font-size:12px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";display:block}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:-ms-flexbox;display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px;line-height:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:12px;font-style:italic;margin-top:-5px;padding:0}[dir=ltr] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";font-size:14px}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:40px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400}[dir=ltr] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--actions{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-negative:0;flex-shrink:0;margin-top:auto;height:56px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";margin:10px -20px 0}[dir=ltr] .od-ShareLinkDetails--actions{padding-right:35px}[dir=rtl] .od-ShareLinkDetails--actions{padding-left:35px}[dir=ltr] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir=rtl] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal",["require","exports","tslib","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Persona","../../../interfaces/SharingInterfaces","react","prop-types","office-ui-fabric-react/lib/Icon","../../../utilities/ClientIdHelper","../../Share.resx","@ms/odsp-utilities/lib/features/Features","./SharePrincipal.scss"],function(e,t,i,c,r,p,u,n,a,s,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={ODB:772},o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:i._computeInitialRoleText(e.principal)};i._store=t.sharingStore;i._onChangeRoleClick=i._onChangeRoleClick.bind(i);i._onPermissionsClick=i._onPermissionsClick.bind(i);return i}e.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!s.isMobile(this.props.clientId)&&this._focusElement.focus()};e.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})};e.prototype.render=function(){var t=this,e=this.props.principal;return u.createElement("div",{className:"od-SharePrincipal",role:"listitem","aria-live":"polite","aria-atomic":"true","aria-label":e.primaryText+" "+this._computeRoleText(),tabIndex:-1,ref:function(e){t._focusElement=e}},u.createElement(r.Persona,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:r.PersonaInitialsColor.blue,primaryText:e.primaryText,size:r.PersonaSize.regular,imageUrl:e.imageUrl}),u.createElement("div",{className:"od-SharePrincipal-details"},u.createElement("div",{className:"od-SharePrincipal-details-primaryText"},e.primaryText),this._renderChangePermissionsButton(e)))};e.prototype._computeInitialRoleText=function(e){var t=h.default,i=this.props.principal.role;if("number"!=typeof i)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(i){case 2:return t.canEditLabel;case 6:return h.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};e.prototype._computeRoleText=function(){return this.state.isUpdatingRole?h.default.updatingPermissions:this.state.roleText};e.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||3!==this.props.userRole||2!==t&&1!==t&&6!==t?u.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):u.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0},u.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role))};e.prototype._renderChevron=function(e){if(2===e||1===e||6===e)return u.createElement("div",{className:"od-SharePrincipal-permissions-icon"},u.createElement(a.Icon,{iconName:"ChevronDown"}))};e.prototype._renderContextualMenu=function(e){var t,i,o,r,n=this,a=this.props,s=h.default,l=m.default.isFeatureEnabled(g),d=a.clientId===p.ClientId.word||a.appmap&&"ms-word"===a.appmap;switch(e){case 1:t=2;i=h.default.allowEdit;o=6;r=h.default.ReviewOnly;break;case 6:t=2;i=h.default.allowEdit;o=1;r=h.default.changeToViewOnly;break;case 2:t=1;i=h.default.changeToViewOnly;o=6;r=h.default.ReviewOnly}return this.state.showContextualMenu&&l&&d?u.createElement(c.ContextualMenu,{items:[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,t)},{key:"editable2",name:r,onClick:this._onChangeRoleClick.bind(this,o)},{key:"stopSharing",name:""+s.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){n.setState({showContextualMenu:!1})},directionalHint:4,isBeakVisible:!0,target:this.state.target}):this.state.showContextualMenu?u.createElement(c.ContextualMenu,{items:[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+s.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){n.setState({showContextualMenu:!1})},directionalHint:4,isBeakVisible:!0,target:this.state.target}):void 0};e.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText});this._store.updatePermissions(this.props.principal,e)};e.prototype._onStopSharingClick=function(e){this.setState({isUpdatingRole:!0});this._store.updatePermissions(this.props.principal,0)};e.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(2===t||1===t||6===t)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};e.contextTypes={sharingStore:n.object.isRequired};return e}(u.Component);t.SharePrincipal=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-ms-flexbox;display:flex;outline:0}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir=ltr] .od-SharePrincipal-persona{margin-right:8px}[dir=rtl] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{cursor:pointer;background:0 0;border:none;padding:0}.ms-Fabric .od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric .od-SharePrincipal-permissions{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-SharePrincipal-permissions:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-SharePrincipal-permissions:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-SharePrincipal-permissions:focus:after{border-color:#37006e}}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px}[dir=ltr] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharePrincipal-deleteIcon{right:8px}[dir=rtl] .od-SharePrincipal-deleteIcon{left:8px}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal2",["require","exports","tslib","office-ui-fabric-react/lib/Persona","../../../interfaces/SharingInterfaces","react","prop-types","office-ui-fabric-react/lib/Icon","../../Share.resx","@ms/odsp-utilities/lib/features/Features","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","./SharePrincipal2.scss"],function(e,t,i,r,l,n,a,s,d,c,p,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m={ODB:772},o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._store=t.sharingStore;i._onChangeRoleClick=i._onChangeRoleClick.bind(i);return i}e.prototype.render=function(){var e=this.props.principal,t=3===e.role,i=this._computeRoleText(e);return n.createElement("div",{className:"od-ShareLink-personaItem od-SharePrincipal2","data-is-focusable":!0,role:"listitem","aria-label":e.primaryText+" "+i,tabIndex:-1},n.createElement(r.Persona,{className:"od-SharePrincipal-persona2",size:r.PersonaSize.size32,primaryText:e.primaryText,secondaryText:e.isExternal?d.default.externalUser:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}),n.createElement("div",{className:"od-SharePrincipal-permissions"},t?n.createElement("span",{className:"od-SharePrincipal-ownerLabel"},d.default.ownerLabel):this._renderChangePermissions(e)))};e.prototype._renderChangePermissions=function(e){var t=e.role;return 3!==this.props.userRole||2!==t&&1!==t&&6!==t?n.createElement("div",{className:"od-SharePrincipal-permissionsRole"},this._renderRoleIcon(e)):n.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e),this._renderChangePermissionDropdown())};e.prototype._renderRoleIcon=function(e){var t=p.getRoleIconNameAndTitle(e.role),i=this._computeRoleText(e);return n.createElement(h.TooltipHost,{content:i,calloutProps:{gapSpace:0}},n.createElement(s.Icon,{className:"od-SharePrincipal-roleIcon",iconName:t.name}))};e.prototype._renderChangePermissionDropdown=function(){return n.createElement(u.IconButton,{className:"od-SharePrincipal-changePermissionsChevron",menuProps:{items:this._getContextualMenuItems(),isBeakVisible:!1,directionalHint:4}})};e.prototype._onChangeRoleClick=function(e){this._store.updatePermissions(this.props.principal,e)};e.prototype._onStopSharingClick=function(e){this._store.updatePermissions(this.props.principal,0)};e.prototype._getContextualMenuItems=function(){var e,t,i,o,r=this.props,n=r.principal.role,a=c.default.isFeatureEnabled(m),s=r.clientId===l.ClientId.word||r.appmap&&"ms-word"===r.appmap;switch(n){case 1:e=2;t=d.default.canEditLabel;i=6;o=d.default.canReviewRole;break;case 6:e=2;t=d.default.canEditLabel;i=1;o=d.default.canViewLabel;break;case 2:e=1;t=d.default.canViewLabel;i=6;o=d.default.canReviewRole}return a&&s?[{key:"editable1",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"editable2",name:o,onClick:this._onChangeRoleClick.bind(this,i)},{key:"stopSharing",name:""+d.default.stopSharing,onClick:this._onStopSharingClick.bind(this)}]:[{key:"editable1",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"stopSharing",name:""+d.default.stopSharing,onClick:this._onStopSharingClick.bind(this)}]};e.prototype._computeRoleText=function(e){var t=d.default,i=e.role;if("number"!=typeof i)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(i){case 2:return t.canEditLabel;case 6:return d.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};e.contextTypes={sharingStore:a.object.isRequired};return e}(n.Component);t.SharePrincipal2=o});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal2.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-ownerLabel{padding-right:8px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-ownerLabel{padding-left:8px}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-permissionsRole{padding-right:40px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-permissionsRole{padding-left:40px}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("@ms/odsp-shared-sharing/lib/components/PermissionsList/PermissionsList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;min-height:236px}.od-PermissionsList-header{position:relative}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-backButton{position:absolute}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0 5px}.od-ShareLinkDetails--sectionHeader .ms-Icon--Info{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0}"}])});define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareMain",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","../Header/Header","../../interfaces/SharingInterfaces","../SendLink/SendLink","./ShareTargets/ShareTargets","../ShareHint/ShareHint","react","prop-types","../Share.resx","../../utilities/AttachAsCopyHelper","../../utilities/ClientIdHelper","../ActivityIndicator/ActivityIndicator","../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","../../utilities/EngagementHelper","../../utilities/ShareCommunicationManager","../../utilities/ShareHelper","@ms/odsp-utilities/lib/browser/ResponsiveUI","./ShareMain.scss"],function(e,t,l,i,a,d,r,n,s,c,p,u,h,m,g,f,b,y,v,x,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){l.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._platformDetection=t.platformDetection;i._breakpoint=t.breakpoint;i.state={isAttachAsCopyContextualMenuVisible:!1,shareType:d.ShareType.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return i}e.prototype.componentDidMount=function(){x.pageFinishedLoading(this.props.clientId,this.props.scenarioId);this._updatePeoplePickerError(this.props)};e.prototype.componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};e.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=this.props,i=this.state.showActivityIndicator?this._getActivityMessage():"",o=this.props.hideShareDialogOverflowButton||!1,r=this._renderFooter(),n=r?{className:"od-ShareMain-section-body"}:null;return c.createElement("div",{className:"od-ShareMain"+e},c.createElement(a.Header,{ctaLabel:u.default.sendButtonLabel,clientId:t.clientId,currentSettings:t.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,item:t.item,linkRecipients:t.linkRecipients,permissionsMap:t.permissionsMap,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,onSendLinkClick:this._onSendLinkClicked,messageText:this.props.messageText,viewState:0,sharingInformation:t.sharingInformation,hideShareDialogOverflowButton:o,maximumMessageLength:500}),c.createElement("div",l.__assign({},n),c.createElement("div",{className:"od-ShareMain-section full-bleed"},c.createElement(s.ShareHint,{companyName:t.companyName,currentSettings:t.currentSettings,onShareHintClick:t.onShareHintClicked,sharingInformation:t.sharingInformation,shouldTakeFocus:!t.enableShimmer,linkRecipients:null})),this._renderSendLink(),this._renderTargets()),r,this._renderActivityIndicator(),c.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},i))};e.prototype._renderTargets=function(){return c.createElement("div",{className:"od-ShareMain-targets"},c.createElement(n.ShareTargets,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this.props.onShareTargetsRendered,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};e.prototype._renderFooter=function(){var e=this.props.clientId;if(m.isOfficeProduct(e)){var t=h.default.getAttachAsCopyOptions(e,this.props.engagementExtraData);if(0<t.length)return c.createElement("div",null,c.createElement(y.DefaultButton,{className:"od-ShareMain-footer",text:u.default.attachACopyInstead,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:t}}))}else if((e===d.ClientId.ngsc||m.isMobile(e))&&this._isSendCopyEnabled())return c.createElement("div",null,c.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},c.createElement("div",{className:"od-ShareMain-attachIcon"},c.createElement(b.Icon,{iconName:"Copy"})),c.createElement("span",null,u.default.attachACopyInstead)))};e.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||_.isLoadingData(this.props.sharingInformation)){var e=m.isMobile(this.props.clientId)||this._platformDetection.isMobile,t=e&&this._breakpoint>=S.default.DEFAULT_BREAKPOINTS.Large,i=this.props;return c.createElement("div",{className:"od-ShareMain-section"},c.createElement(r.SendLink,{ctaLabel:u.default.sendButtonLabel,showTextArea:!0,sharingInformation:i.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:i.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:i.groupsMemberCount,onViewPolicyTipClicked:i.onViewPolicyTipClicked,linkRecipients:i.linkRecipients,permissionsMap:i.permissionsMap,messageText:i.messageText,onSendLinkMessageChange:i.onSendLinkMessageChange,createPeopleSharingLinks:i.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:i.clientId,showSendButton:!e||t,maximumMessageLength:500,isLoadingDefaultRecipients:i.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this.props.engagementExtraData}))}};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return c.createElement(g.ActivityIndicator,{message:this._getActivityMessage()})};e.prototype._onSelectedPeopleChange=function(e){var t=this.props,i=f.renderPickerError({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,permissionsMap:t.permissionsMap});if(i){for(var o=t.currentSettings.sharingLinkKind,r=3===o||2===o,n=!1,a=0,s=e;a<s.length;a++){if(s[a].isExternal&&r){n=!0;break}}n&&v.externalSharingCslError(t.engagementExtraData)}this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:i}),function(){t.onSelectedPeopleChange(e)})};e.prototype._onShareTargetClicked=function(e){var t=this;!this._isPeoplePickerValid(e)&&(4===this.props.currentSettings.audience||0===this.props.currentSettings.audience||0<this.props.linkRecipients.length)||this.setState(l.__assign({},this.state,{showActivityIndicator:!0,shareType:e}),function(){t.props.onShareTargetClicked(e)})};e.prototype._onSendLinkClicked=function(e){var t=this;this._isPeoplePickerValid(d.ShareType.share)&&this.setState(l.__assign({},this.state,{showActivityIndicator:!0,shareType:d.ShareType.share}),function(){t.props.onSendLinkClicked(e)})};e.prototype._onAttachAsCopyClicked=function(){var e=this.props.clientId;v.sendACopyClicked(this.props.engagementExtraData);if(m.isOfficeProduct(e)){var t=!this.state.isAttachAsCopyContextualMenuVisible;this.setState(l.__assign({},this.state,{isAttachAsCopyContextualMenuVisible:t}),function(){})}else if(e===d.ClientId.ngsc||m.isMobile(e))try{window.external.SendCopy()}catch(e){}};e.prototype._getActivityMessage=function(){var e=u.default;switch(this.state.shareType){case d.ShareType.share:return e.activityMessageSendingMail;case d.ShareType.copy:case d.ShareType.outlook:case d.ShareType.nonOutlook:case d.ShareType.teams:case d.ShareType.moreApps:default:return e.activityMessageCreatingLink}};e.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};e.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==d.ShareType.share&&!this.props.createPeopleSharingLinks&&0===this.props.currentSettings.audience){for(var t=!1,i=!1,o=0,r=this.props.linkRecipients;o<r.length;o++){var n=r[o];t||(t=n.isExternal&&!n.providerName);i||(i=!n.isExternal||n.isExternal&&!!n.providerName)}if(t&&i){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,u.default.mixedRecipientErrorMessage)}));return!1}}var a=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input"),s=4===this.props.currentSettings.audience||0===this.props.currentSettings.audience||e===d.ShareType.share;if(a.value){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,u.default.unresolvedTextError)}));return!1}if(0===this.props.linkRecipients.length&&s){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,u.default.recipientsRequiredError)}));return!1}return!0}};e.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=f.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,permissionsMap:e.permissionsMap});this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:t}))}};e.contextTypes={platformDetection:p.object.isRequired,breakpoint:p.object.isRequired};l.__decorate([i.autobind],e.prototype,"_onSelectedPeopleChange",null);l.__decorate([i.autobind],e.prototype,"_onShareTargetClicked",null);l.__decorate([i.autobind],e.prototype,"_onSendLinkClicked",null);l.__decorate([i.autobind],e.prototype,"_onAttachAsCopyClicked",null);return e}(c.Component);t.ShareMain=o});define("@ms/odsp-shared-sharing/lib/components/SendLink/SendLink",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/TextField","../../utilities/PeoplePickerHelper","react","prop-types","../PeoplePicker/PeoplePicker","../SendButton/SendButton","../SendButton/SendButtonType","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Link","../Share.resx","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","../../utilities/EngagementHelper","@ms/odsp-utilities/lib/features/FeatureOverrides","../../utilities/ClientIdHelper","./SendLink.scss"],function(e,t,i,o,n,c,p,a,u,h,m,g,s,f,l,d,b,y,v,x,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={ODB:1175},k={ODB:-1175},r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._platformDetection=t.platformDetection;i._isMacV4ExperimentOn=t.isMacV4ExperimentOn;i.state={messageLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._isOnExperiment=!1;if(x.default.isFeatureEnabled(S)&&!i._platformDetection.isIOS&&(!_.isOfficeProduct(i.props.clientId)||!i._platformDetection.isMac)&&!y.Killswitch.isActivated("08cded93-1718-48b0-9b7e-bfdcf6384ef3","7/17/2018","AddMessageBorder")){var o=new b.ABExperiment({name:"AddMessageBorder",startDate:"07/17/2018",version:b.ABExpHash.v2});i._isOnExperiment=o.IsExperimentOn()}return i}e.prototype.componentWillReceiveProps=function(e){c.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,permissionsMap:e.permissionsMap});this.setState(i.__assign({},this.state))};e.prototype.render=function(){var e=this._isOnExperiment||x.default.isFeatureEnabled(k),t=this.props,i=t.currentSettings,o=t.linkRecipients,r=c.getOversharingExternalsWarning(o),n=c.getOversharingGroupsWarning(o,t.groupsMemberCount),a=this._platformDetection.isIOS?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||this._isMacV4ExperimentOn?"od-SendLink-emailButtons":"od-SendLink-emailButtons-left",s=e?"od-SendLink-message-border":"od-SendLink-message-no-border",l=this.props.showSendButton?p.createElement("div",{className:a},p.createElement(h.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,messageText:this.props.messageText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:m.default.button,sharingInformation:this.props.sharingInformation})):"",d=t.isLoadingDefaultRecipients?p.createElement("div",null,p.createElement(f.Spinner,{className:"od-SendLink-spinner",label:g.default.loadingRecipients,size:f.SpinnerSize.small})):p.createElement(u.default,{defaultSelectedItems:o,error:t.errorMessage,onChange:t.onSelectedPeopleChange,oversharingExternalsWarning:r,oversharingGroupsWarning:n,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:i.sharingLinkKind,sharingInformation:t.sharingInformation,permissionsMap:t.permissionsMap,clientId:t.clientId});return p.createElement("div",{className:"od-SendLink"},p.createElement("div",{className:"od-SendLink-email"},d,p.createElement("div",{className:"od-SendLink-message "+s},this._renderTextArea(),this._renderCharacterCounter(),l,this._renderLink())))};e.prototype._onManageExistingAccessClick=function(){v.whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};e.prototype._renderLink=function(){var e=!1;if(this._platformDetection.isAndroid&&(!_.isOfficeProduct(this.props.clientId)||!this._platformDetection.isMac)&&!y.Killswitch.isActivated("42c7cf37-86fb-49ba-bf35-2f337ca7a463","7/25/2018","Manage Access Link Experiment")){e=new b.ABExperiment({name:"ManageAccessLink",startDate:"07/25/2018",version:b.ABExpHash.v2}).IsExperimentOn()}if(e||this._isMacV4ExperimentOn)return p.createElement(l.Link,{className:"od-SendLink-showAccessLink",onClick:this._onManageExistingAccessClick},d.default.manageExistingAccessLabel)};e.prototype._renderTextArea=function(){if(this.props.showTextArea)return p.createElement(n.TextField,{placeholder:g.default.messagePlaceholder,ariaLabel:g.default.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText})};e.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t="od-SendLink-characterCounter "+(e>this.props.maximumMessageLength?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return p.createElement("span",{className:t},e,"/",this.props.maximumMessageLength)};e.prototype._validateMessage=function(e){this.props.onSendLinkMessageChange(e);var t=s.getEncodedMessageLength(e);this.setState(i.__assign({},this.state,{messageLength:t}));return""};e.contextTypes={platformDetection:a.object.isRequired,isMacV4ExperimentOn:a.bool.isRequired};i.__decorate([o.autobind],e.prototype,"_validateMessage",null);return e}(p.Component);t.SendLink=r});define("@ms/odsp-shared-sharing/lib/components/SendLink/SendLink.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-SendLink-message{margin-top:16px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:12px;font-weight:400;font:-apple-system-footnote}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-left:5px}[dir=rtl] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-right:5px}.od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-fieldGroup{margin-bottom:16px}.od-SendLink-message-no-border .ms-TextField.ms-TextField--multiline div{border-color:transparent}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-left{font:-apple-system-headline}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}.od-SendLink-emailButtons-rounded .ms-Button{font:-apple-system-headline;border-radius:8px;height:44px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding:6px 0 7px 0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-footnote}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-SendLink-showAccessLink{display:block;font-size:14px;margin:45px 30px 0 0;font:-apple-system-footnote}[dir=ltr] .od-SendLink-showAccessLink{float:left}[dir=rtl] .od-SendLink-showAccessLink{float:right}[dir=rtl] .od-SendLink-showAccessLink{margin:45px 0 0 30px}"}])});define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareTargets/ShareTargets",["require","exports","tslib","../../../interfaces/SharingInterfaces","react","../../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Tooltip","../../../components/Share.resx","./ShareTargets.scss"],function(e,t,i,o,p,r,n,u,h,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&3!==this.props.currentSettings.audience;this._shareTargetsData=this._getShareTargetsData();if(!h.isLoadingData(this.props.sharingInformation)){for(var t=[],i=0,o=this._shareTargetsData;i<o.length;i++){var r=o[i];t.push(r.shareType)}this.props.onShareTargetsRendered(t)}return e?p.createElement("div",{className:"od-ShareTargets"},p.createElement(a.TooltipHost,{content:s.default.accessRequestTooltip,calloutProps:{calloutWidth:300,directionalHint:1}},p.createElement("ul",{className:"od-ShareTargets-items",role:"group","aria-label":s.default.otherWaysToShareLabel},this._renderTargets()))):p.createElement("div",{className:"od-ShareTargets"},p.createElement("ul",{className:"od-ShareTargets-items",role:"group","aria-label":s.default.otherWaysToShareLabel},this._renderTargets()))};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&3!==this.props.currentSettings.audience,i=0,o=this._shareTargetsData;i<o.length;i++){var r=o[i],n=void 0,a=r.icon,s=a.split(":",2)[1],l=t||h.isLoadingData(this.props.sharingInformation),d="od-ShareTargets-icon "+(l?"od-ShareTargets-disabled":""),c="od-ShareTargets-itemText ms-font-xs "+(l?"od-ShareTargets-disabled":"");n=-1<a.indexOf("font:")?p.createElement(u.Icon,{iconName:s,className:d}):p.createElement("img",{src:s,className:d});e.push(p.createElement("li",{key:r.shareType,className:"od-ShareTargets-item"},p.createElement("button",{className:"od-ShareTargets-target",disabled:l,onClick:r.action},p.createElement("div",{className:"od-ShareTargets-itemImage"},n),p.createElement("div",{className:c},r.label))))}return e};t.prototype._getShareTargetsData=function(){var e=[{label:s.default.copyLinkLabel,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:o.ShareType.copy,action:this._onClick.bind(this,o.ShareType.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===o.OutlookAvailability.available?e.push({label:s.default.outlookLabel,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:o.ShareType.outlook,action:this._onClick.bind(this,o.ShareType.outlook)}):t===o.OutlookAvailability.other&&e.push({label:s.default.nonOutlookLabel,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:o.ShareType.nonOutlook,action:this._onClick.bind(this,o.ShareType.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:s.default.teamsLabel,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:o.ShareType.teams,action:this._onClick.bind(this,o.ShareType.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:s.default.moreAppsLabel,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:o.ShareType.moreApps,action:this._onClick.bind(this,o.ShareType.moreApps)});return e};t.prototype._onClick=function(e,t){this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){if(r.showOWAShareTarget(this.props.clientId)&&this.props.outlookAvailability===o.OutlookAvailability.available)return o.OutlookAvailability.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return o.OutlookAvailability.none}};t.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};t.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};i.__decorate([n.autobind],t.prototype,"_determineMailShareTarget",null);return t}(p.Component);t.ShareTargets=l});define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareTargets/ShareTargets.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:50%;color:#3c3c3c;cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.od-ShareTargets-itemImage--border{border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font:-apple-system-short-caption2}.od-ShareTargets-target{background:0 0;border:none}.ms-Fabric .od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric .od-ShareTargets-target{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareTargets-target:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareTargets-target:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-ShareTargets-target:focus:after{border-color:#37006e}}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("@ms/odsp-shared-sharing/lib/utilities/AttachAsCopyHelper",["require","exports","../components/Share.resx","../utilities/EngagementHelper","../utilities/ClientIdHelper"],function(e,t,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(i||(i={})).getAttachAsCopyOptions=function(e,t){var i=[],o=function(e,t){var i=!1;try{var o=window.external;i=o.IsSendCopyEnabled()}catch(e){}if(i){var r=function(){!function(e){a.sendACopyOfficeClicked(e);try{var t=window.external;t.SendCopy()}catch(e){}}(t)};return s.isWord(e)?{key:"word",name:n.default.wordDocument,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:r}:s.isPowerPoint(e)?{key:"powerpoint",name:n.default.powerPointPresentation,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:r}:s.isExcel(e)?{key:"excel",name:n.default.excelWorkbook,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:r}:s.isVisio(e)?{key:"visio",name:n.default.visioDrawing,iconProps:{iconName:"VisioLogo"},onClick:r}:{key:"document",name:n.default.document,iconProps:{iconName:"Document"},onClick:r}}}(e,t);o&&i.push(o);var r=function(e){var t=!1;try{var i=window.external;t=i.IsSendPdfEnabled()}catch(e){}if(t)return{key:"pdf",name:n.default.pdf,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e){a.sendACopyPdfClicked(e);try{var t=window.external;t.SendPdf()}catch(e){}}(e)}}}(t);r&&i.push(r);return i};t.default=i});define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareMain.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ShareMain-section{padding:20px 16px 0 16px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";cursor:pointer;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font:-apple-system-subheadline;bottom:0}.ms-Fabric .od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric .od-ShareMain-footer{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareMain-footer:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareMain-footer:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-ShareMain-footer:focus:after{border-color:#37006e}}.is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";cursor:pointer;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font:-apple-system-subheadline;bottom:0;box-shadow:none;border-radius:0}.ms-Fabric .is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button::-moz-focus-inner{border:0}.ms-Fabric .is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button:focus:after{border-color:#37006e}}.is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button.ms-Button--default{position:fixed}.is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button.ms-Button--default:focus{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";box-shadow:none}.ms-Fabric .od-ShareMain-footer{position:fixed}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}"}])});define("@ms/odsp-shared-sharing/lib/components/SharePolicyDetails/SharePolicyDetails",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../Header/Header","@ms/odsp-shared-react/lib/PolicyTip","react","prop-types","office-ui-fabric-react/lib/Utilities","../Share.resx","./SharePolicyDetails.scss"],function(e,t,i,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._store=t.sharingStore;i._resize=t.resize;i.state={showJustificationInput:!1};return i}e.prototype.componentDidUpdate=function(){this._resize()};e.prototype.render=function(){var e=this.props,t=this.state,i=e.policyTipInformation.info;return s.createElement("div",{className:"od-SharePolicyDetails"},s.createElement(n.Header,{clientId:e.clientId,item:e.sharingInformation.item,viewState:6}),s.createElement("div",{className:"od-Share-PolicyTip"},s.createElement(a.PolicyTip,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:i?2===i.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};e.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:c.default.ptHeader,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?c.default.ptLastScanned+": "+r.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:e?c.default.ptLearnMoreActionLabel:void 0,learnMoreLabel:e?c.default.ptLearnMoreLabel:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:c.default.ptNoPolicyTipInfo,overrideActionLabel:t?c.default.ptOverrideActionLabel:void 0,overrideLabel:c.default.ptOverrideLabel,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:c.default.ptReportActionLabel,reportLabel:c.default.ptReportLabel,reportInProgressLabel:c.default.ptReportInProgress,submitButtonLabel:c.default.ptSubmitLabel,titleText:void 0}};e.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?c.default.ptReportConfirmation:2===e||3===e?c.default.ptOverrideConfirmation:""};e.prototype._onOverrideClicked=function(){var e=this.props.policyTipInformation.info.overrideOption;1===e?this._store.updatePolicy(0):2===e&&this.setState(i.__assign({},this.state,{showJustificationInput:!0}))};e.prototype._onOverrideSubmitClicked=function(e){this._store.updatePolicy(0,e)};e.prototype._onReportClicked=function(){this._store.updatePolicy(1)};e.contextTypes={sharingStore:l.object.isRequired,resize:l.func.isRequired};i.__decorate([d.autobind],e.prototype,"_onOverrideClicked",null);i.__decorate([d.autobind],e.prototype,"_onOverrideSubmitClicked",null);i.__decorate([d.autobind],e.prototype,"_onReportClicked",null);return e}(s.Component);t.SharePolicyDetails=o});define("@ms/odsp-shared-react/lib/PolicyTip",["require","exports","tslib","./components/PolicyTip/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@ms/odsp-shared-react/lib/components/PolicyTip/index",["require","exports","tslib","./PolicyTip"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@ms/odsp-shared-react/lib/components/PolicyTip/PolicyTip",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/TextField","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Icon","./PolicyTip.scss"],function(e,t,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:e.overrideRequiresJustification};return t}e.prototype.componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(o.__assign({},this.state,{isLoading:!1}))};e.prototype.componentWillUnmount=function(){this.props.onDismissed()};e.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?l.createElement("div",{className:"od-PolicyTip-container"},l.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):l.createElement("div",{className:"od-PolicyTip-container"},l.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),l.createElement("div",{className:"od-PolicyTip-header"},l.createElement(c.Icon,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),l.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),l.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),l.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return l.createElement("div",null,l.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};e.prototype._renderIssues=function(){for(var e=[],t=0,i=0,o=this.props.strings.issues;i<o.length;i++){var r=o[i];e.push(l.createElement("span",{className:"od-PolicyTip-issue",key:t++},r))}return e};e.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=l.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),i=d.formatToArray(e.learnMoreLabel,t);return l.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},i)}};e.prototype._getAction=function(e,t,i,o){if(i)return l.createElement("div",{className:"od-PolicyTip-action"},l.createElement("span",null,""+d.format(e,t)));var r=l.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:o,role:"button",href:"javascript:;"},t),n=d.formatToArray(e,r);return l.createElement("div",{className:"od-PolicyTip-action"},n)};e.prototype._renderActions=function(){var e=this.props,t=this.state,i=e.strings,o=[],r=this._getAction(i.reportLabel,i.reportActionLabel,t.reportButtonClicked,this._onReportClicked);o.push(r);if(i.overrideActionLabel){var n=this._getAction(i.overrideLabel,i.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);o.push(n)}return o};e.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?l.createElement("div",{className:"od-PolicyTip-status"},l.createElement(a.Spinner,null),l.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?l.createElement("div",{className:"od-PolicyTip-status"},l.createElement(c.Icon,{iconName:"CheckMark"}),l.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};e.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return l.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},l.createElement(s.TextField,{autoAdjustHeight:!0,multiline:!0,onBeforeChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&l.createElement(n.PrimaryButton,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};e.prototype._onReportClicked=function(){var e=this;this.setState(o.__assign({},this.state,{isLoading:!0,reportButtonClicked:!0}),function(){e.props.onReportClicked()})};e.prototype._onOverrideClicked=function(){var e=this;this.setState(o.__assign({},this.state,{overrideButtonClicked:!0}),function(){e.props.onOverrideClicked()})};e.prototype._onOverrideSubmitClicked=function(){var e=this;this.setState(o.__assign({},this.state,{isLoading:!0,overrideSubmitClicked:!0}),function(){e.props.onOverrideSubmitClicked(e.state.justificationText)})};e.prototype._onJustificationChanged=function(e){this.props.overrideRequiresJustification&&this.setState(o.__assign({},this.state,{justificationText:e,overrideSubmitDisabled:!e}))};o.__decorate([r.autobind],e.prototype,"_onReportClicked",null);o.__decorate([r.autobind],e.prototype,"_onOverrideClicked",null);o.__decorate([r.autobind],e.prototype,"_onOverrideSubmitClicked",null);o.__decorate([r.autobind],e.prototype,"_onJustificationChanged",null);return e}(r.BaseComponent);t.PolicyTip=i});define("@ms/odsp-shared-react/lib/components/PolicyTip/PolicyTip.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-PolicyTip-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:21px;font-weight:100;margin:0 0 8px 0}.od-PolicyTip-description{font-size:14px;font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-ms-flexbox;display:flex;margin:20px 0}.od-PolicyTip-blockedIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:17px;font-weight:300;font-weight:600}[dir=ltr] .od-PolicyTip-headerText{margin-left:12px}[dir=rtl] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:14px;font-weight:400;margin-bottom:12px}[dir=ltr] .od-PolicyTip-issue{margin-left:33px}[dir=rtl] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-ms-flexbox;display:flex}[dir=ltr] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir=rtl] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:12px;font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir=ltr] .od-PolicyTip-label{margin-left:4px}[dir=rtl] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:12px;font-weight:400}[dir=ltr] .od-PolicyTip-statusText{margin-left:4px}[dir=rtl] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:17px;font-weight:300}"}])});define("@ms/odsp-shared-sharing/lib/components/SharePolicyDetails/SharePolicyDetails.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}"}])});define("@ms/odsp-shared-sharing/lib/components/AtMention/AtMention",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Utilities","../Header/Header","office-ui-fabric-react/lib/MessageBar","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","../Share.resx","../../utilities/EngagementHelper","react","prop-types","../../utilities/ShareCommunicationManager","./AtMention.scss"],function(e,t,i,n,o,a,s,l,d,c,p,u,h,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._dismiss=t.onDismiss;i._resize=t.resize;i._store=t.sharingStore;i._platformDetection=t.platformDetection;var o=0===e.recipients.length;o||i._notifyReady();i.state={canShare:i._canShare(e.recipients),isLoading:o,isSharing:!1};return i}e.prototype.componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};e.prototype.componentDidUpdate=function(){setTimeout(this._resize,10)};e.prototype.componentDidMount=function(){var t=this;this._notifyReadyForRecipients();this._store.addListener(function(){var e=t._store.getGrantAccessResult();if(null!==e){t._notifyGrantAccessCompleted(e);t._dismiss()}})};e.prototype.render=function(){var e,t=this.state,i=t.canShare,o=t.isLoading,r=t.isSharing;e=o?this._renderLoadingSpinner():i?this._renderHappyPath():this._renderSadPath();return m.createElement("div",{className:"od-AtMention "+(r?"od-AtMention--isSharing":"")},!o&&m.createElement(s.Header,{mode:n.Mode.atMention,viewState:5}),e,this._renderSharingActivityIndicator(),m.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this._getScreenReaderAlertMessage()))};e.prototype._renderLoadingSpinner=function(){return m.createElement("div",{className:"od-AtMention-spinnerHolder"},m.createElement(p.Spinner,{className:"od-AtMention-spinner",label:u.default.componentLoading,type:p.SpinnerType.large}))};e.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return m.createElement(o.ActivityIndicator,{message:u.default.grantAccessActivityIndicatorString})};e.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return m.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),m.createElement("div",{className:"od-AtMention-message"},u.default.atMentionHappyMessage),m.createElement(c.PrimaryButton,{className:e,onClick:this._onShareClicked},u.default.shareAndNotifyButtonLabel))};e.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return m.createElement("div",{className:"od-AtMention-container"},m.createElement(l.MessageBar,{messageBarType:l.MessageBarType.warning},this._getSadMessage()),this._renderRecipients(!0),m.createElement(c.PrimaryButton,{className:e,onClick:this._onOkayClicked},u.default.okayButtonLabel))};e.prototype._renderRecipients=function(e){var i=this,t=this.props.recipients.map(function(e){var t=i._isRecipientInvalid(e);return m.createElement("li",null,m.createElement(d.Persona,{className:"od-AtMention-recipient "+(t?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:d.PersonaSize.extraSmall}))});return m.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":u.default.grantAccessRecipientsListLabel},t)};e.prototype._onShareClicked=function(){var e=this;this.setState({isSharing:!0},function(){h.shareCompleted({clientId:e.props.clientId,scenarioId:e.props.scenarioId,mode:n.Mode.atMention});e._store.grantAccess(e.props.recipients)})};e.prototype._onOkayClicked=function(){this._notifyGrantAccessCompleted(!1);this._dismiss()};e.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?u.default.grantAccessActivityIndicatorString:u.default.grantAccessPageLabel};e.prototype._canShare=function(e){var t=this,i=this.props.sharingInformation;return!!i.canManagePermissions&&(!!i.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};e.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};e.prototype._notifyReady=function(){f.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype._notifyReadyForRecipients=function(){f.readyForRecipients()};e.prototype._notifyGrantAccessCompleted=function(e){f.grantAccessCompleted(e)};e.prototype._getSadMessage=function(){var e=this.props.sharingInformation;return e.canManagePermissions&&e.canAddInternalPrincipal?u.default.atMentionSadMessageRecipient:u.default.atMentionSadMessageOwner};e.contextTypes={onDismiss:g.func.isRequired,resize:g.func.isRequired,sharingStore:g.object.isRequired,platformDetection:g.object.isRequired};i.__decorate([a.autobind],e.prototype,"_onShareClicked",null);i.__decorate([a.autobind],e.prototype,"_onOkayClicked",null);return e}(m.Component);t.AtMention=r});define("@ms/odsp-shared-sharing/lib/components/AtMention/AtMention.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{display:-ms-inline-flexbox;display:inline-flex;margin-bottom:8px}[dir=ltr] .od-AtMention li{margin-right:4px}[dir=rtl] .od-AtMention li{margin-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;margin:16px 16px 0 16px}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention .od-AtMention-message{margin-bottom:16px;font:-apple-system-body}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:44px;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:150px;-ms-flex-pack:center;justify-content:center}"}])});define("@ms/odsp-shared-sharing/lib/components/Notify/Notify",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Utilities","../../interfaces/SharingInterfaces","../ShareNotification/ShareNotification","../Header/Header","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","../../utilities/EngagementHelper","../Share.resx","../PeoplePicker/PeoplePicker","../../utilities/PeoplePickerHelper","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Link","./NotifyGroupRecipient","../SendButton/SendButton","../../utilities/ShareHelper","../SendButton/SendButtonType","../../utilities/ShareCommunicationManager","./Notify.scss"],function(e,t,s,n,i,r,a,l,d,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){s.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._sharingStore=t.sharingStore;i._resize=t.resize;i.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:9};return i}e.prototype.componentWillMount=function(){var t=this,e=this.props;this._sharingStore.addListener(this._onStoreUpdate);var i=e.sharingInformation.sharingPrincipals,o=e.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(i).map(function(e){return{userId:e.loginName,name:e.primaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),r=o.filter(function(e){return e.principalType!==b.default.user}).map(function(e){return s.__assign({},e,{checked:!0,expanded:!1,groupId:e.rawPersonData.groupId,memberCount:null})});r.forEach(function(e){t._sharingStore.fetchMemberCount(e)});var n=o.filter(function(e){return e.principalType===b.default.user}),a={};n.concat(r).forEach(function(e){a[e.email]=3});this.setState({isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:r,people:n,peoplePickerError:null,permissionsMap:a,viewState:9},function(){h.opened(t.props.engagementExtraData)})};e.prototype.componentDidMount=function(){C.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype.componentDidUpdate=function(e,t){this._resize()};e.prototype._onExpandClick=function(){var e=this;this.setState(function(e){return s.__assign({},e,{isExpanded:!e.isExpanded})},function(){h._log("Notify.ExpandLinkClicked",e.props.engagementExtraData)})};e.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return n.createElement("div",{className:v.css("od-Notify-PeoplePicker")},n.createElement(g.default,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))};e.prototype._onStoreUpdate=function(){var t=this._sharingStore.getPermissionsMap(),i=f.renderPickerError({selectedItems:this.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this._sharingStore.getPolicyTipInformation,permissionsMap:t});i&&h._log("Notify.AddedUserWhoDoesNotHaveAccess",this.props.engagementExtraData);t=s.__assign({},this.state.permissionsMap,t);this.setState(function(e){return s.__assign({},e,{peoplePickerError:i,permissionsMap:t})})};e.prototype._onPeoplePickerSelected=function(t){this._sharingStore.checkPermissions(t);h._log("Notify.AddedUserFromPeoplePicker",this.props.engagementExtraData);var i=this._sharingStore.getPermissionsMap(),o=f.renderPickerError({selectedItems:this.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this._sharingStore.getPolicyTipInformation,permissionsMap:i});i=s.__assign({},this.state.permissionsMap,i);this.setState(function(e){return s.__assign({},e,{peoplePickerRecipients:t,peoplePickerError:o,permissionsMap:i})})};e.prototype._updateGroupCount=function(){for(var e=this._sharingStore.getMembersCounts(),t=this.state.groups.slice(0),i=0;i<t.length;i++){var o=this.state.groups[i];if(e[o.email]!==o.memberCount){o.memberCount=e[o.email];t[i]=o}}this.setState(function(e){return s.__assign({},e,{groups:t})})};e.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)};e.prototype._computeTotalMemberCount=function(){var e=this.state,t=e.people.length+e.peoplePickerRecipients.length;return t+=this._computeTotalGroupsMembersCount()};e.prototype.onRemoveItem=function(e){var t=this.state.people.slice(0),i=t.indexOf(e);-1<i&&t.splice(i,1);h._log("Notify.RemovedUserFromPeoplePicker",this.props.engagementExtraData);this.setState(function(e){return s.__assign({},e,{people:t})})};e.prototype._allRecipients=function(){var e=this.state;return e.people.concat(e.peoplePickerRecipients).concat(e.groups.filter(function(e){return e.checked}))};e.prototype._showSuccessMessage=function(){this.setState(function(e){return s.__assign({},e,{viewState:3,showActivityIndicator:!1})})};e.prototype._sendNotification=function(){var e=this,t=this._allRecipients();this.setState({showActivityIndicator:!0},function(){C.sendLinkClicked();e._sharingStore.shareLink(e.props.currentSettings,t,void 0,void 0,!0);h.shareCompleted(s.__assign({},e.props.engagementExtraData,{recipientsCount:t.length}));C.shareCompleted(a.ShareType.share);e._showSuccessMessage()})};e.prototype._renderGroup=function(e){return n.createElement(S.NotifyGroupRecipient,{clientId:this.props.clientId,group:e,checked:e.checked,memberCount:e.memberCount,updateCountCallback:this._updateGroupCount,engagementExtraData:this.props.engagementExtraData})};e.prototype._onGroupsExpandClick=function(){var t=this.state.groupsIsExpanded;this.setState(function(e){return s.__assign({},e,{groupsIsExpanded:!t})})};e.prototype._renderGroups=function(e){var t=this,i=this.state,o=i.groupsIsExpanded?" expanded ":"",r=5<i.groups.length?" scroll ":"";if(0!==e.length)return n.createElement("div",{className:v.css("od-Notify-groups-container")},n.createElement("div",{className:v.css("od-Notify-groups-expand")},n.createElement(x.Label,{className:v.css("od-Notfiy-groupLabel")},m.default.notifyGroupsLabel),n.createElement(u.IconButton,{className:"od-Notify-group-expand-icon",iconProps:{iconName:o?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),n.createElement("div",{className:v.css("od-Notify-groups-recipient-container"+o+r)},o&&e.map(function(e){return n.createElement("div",{key:e.email,className:v.css("od-Notify-groups-listItem")},t._renderGroup(e))})))};e.prototype._renderPerson=function(e){var t=this;return n.createElement("div",{className:v.css("od-Notify-PickerPersona-container"),"data-is-focusable":!0,role:"listitem"},n.createElement(p.Persona,{imageUrl:e.image,primaryText:e.name,size:p.PersonaSize.extraSmall,className:v.css("od-Notify-persona")}),n.createElement(u.IconButton,{onClick:function(){t.onRemoveItem&&t.onRemoveItem(e)},iconProps:{iconName:"Cancel"},className:v.css("od-Notify-cancel"),"data-is-focusable":!1}))};e.prototype._renderPeople=function(e){var t=this,i=5<this.state.people.length?" scroll ":"";return n.createElement("div",{className:v.css("od-Notify-people-container")},n.createElement(x.Label,{className:v.css("od-Notify-peopleLabel")},m.default.notifyPeopleLabel),n.createElement("div",{className:v.css("od-Notify-people-recipient-container"+i)},e.map(function(e){return n.createElement("div",{key:e.email,className:v.css("od-Notify-people-listItem")},t._renderPerson(e))})))};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return n.createElement(c.ActivityIndicator,{message:m.default.activityMessageSendingMail})};e.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,i=e.currentSettings,o={companyName:this._sharingStore.getCompanyName(),currentSettings:i,sharingInformation:t,onShareHintClick:null,linkRecipients:this._allRecipients()};return n.createElement(l.ShareNotification,{shareType:a.ShareType.share,itemName:t.item.name,linkUrl:null,clientId:this.props.clientId,sharingHintProps:o,shouldCopyLinkToClipboard:!0})};e.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return 0<this.state.groups.filter(function(e){return e.checked}).length?y.format(m.default.notifyMembersTotalPlus,e):1===e?y.format(m.default.notifyMemberTotal):0===e?"":y.format(m.default.notifyMembersTotal,e)};e.prototype._displayTotalMembersCount=function(){return n.createElement(x.Label,{className:v.css("od-Notify-totalMembersCount")},this._displayTotalMemberCountString())};e.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":y.format(m.default.notifyGroupsMembersTotalPlus,e)};e.prototype._displayTotalGroupsMembersCount=function(){return n.createElement(x.Label,{className:v.css("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())};e.prototype._sendButtonError=function(){return n.createElement(x.Label,null,m.default.notifySendButtonError)};e.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,i=e.showActivityIndicator?" blocker":"",o=P.truncateItemNameForShareNotification(this.props.sharingInformation.item.name,10);return n.createElement("div",{className:"od-Notify"+i},n.createElement("div",{className:"od-Notify-headerAndMessage"},n.createElement(d.Header,{clientId:t.clientId,viewState:9}),n.createElement(x.Label,{className:v.css("od-Notify-message")},y.format(m.default.notifyMessage,o))),!e.isExpanded&&n.createElement("div",null,n.createElement("div",{className:v.css("od-Notify-horizontalLine")}),n.createElement(_.Link,{onClick:this._onExpandClick,className:v.css("od-Notify-show-link")},m.default.sendNotifyLinkExpandLink)),e.isExpanded&&n.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),n.createElement("div",{className:v.css("od-Notify-sendNotification-button")},n.createElement(k.default,{ctaLabel:m.default.sendNotifyLinkButton,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,messageText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:w.default.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCount()))};e.prototype._renderViews=function(){switch(this.state.viewState){case 3:return this._renderNotification();default:return this._renderNotifyMain()}};e.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return n.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())};e.contextTypes={resize:i.func.isRequired,strings:i.object.isRequired,sharingStore:i.object.isRequired};s.__decorate([r.autobind],e.prototype,"_onExpandClick",null);s.__decorate([r.autobind],e.prototype,"_renderPeoplePicker",null);s.__decorate([r.autobind],e.prototype,"_onStoreUpdate",null);s.__decorate([r.autobind],e.prototype,"_onPeoplePickerSelected",null);s.__decorate([r.autobind],e.prototype,"_updateGroupCount",null);s.__decorate([r.autobind],e.prototype,"_computeTotalGroupsMembersCount",null);s.__decorate([r.autobind],e.prototype,"_computeTotalMemberCount",null);s.__decorate([r.autobind],e.prototype,"onRemoveItem",null);s.__decorate([r.autobind],e.prototype,"_allRecipients",null);s.__decorate([r.autobind],e.prototype,"_showSuccessMessage",null);s.__decorate([r.autobind],e.prototype,"_sendNotification",null);s.__decorate([r.autobind],e.prototype,"_renderGroup",null);s.__decorate([r.autobind],e.prototype,"_onGroupsExpandClick",null);s.__decorate([r.autobind],e.prototype,"_renderGroups",null);s.__decorate([r.autobind],e.prototype,"_renderPerson",null);s.__decorate([r.autobind],e.prototype,"_renderPeople",null);s.__decorate([r.autobind],e.prototype,"_renderNotification",null);s.__decorate([r.autobind],e.prototype,"_displayTotalMemberCountString",null);s.__decorate([r.autobind],e.prototype,"_displayTotalMembersCount",null);s.__decorate([r.autobind],e.prototype,"_displayTotalGroupMemberCountString",null);s.__decorate([r.autobind],e.prototype,"_displayTotalGroupsMembersCount",null);s.__decorate([r.autobind],e.prototype,"_sendButtonError",null);s.__decorate([r.autobind],e.prototype,"_renderNotifyMain",null);s.__decorate([r.autobind],e.prototype,"_renderViews",null);return e}(n.Component);t.Notify=o});define("@ms/odsp-shared-sharing/lib/components/Notify/NotifyGroupRecipient",["require","exports","tslib","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Utilities","react","prop-types","../../utilities/EngagementHelper","./Notify.scss"],function(e,t,i,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._sharingStore=t.sharingStore;i.state={};return i}e.prototype.componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)};e.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)};e.prototype._onCheckboxChange=function(e,t){this.props.group.checked=t;c._log("Notify.GroupCheckboxClicked",this.props.engagementExtraData);this.props.updateCountCallback()};e.prototype._renderGroup=function(){return l.createElement(r.Checkbox,{boxSide:"start",label:this.props.group.name,defaultChecked:this.props.checked,onChange:this._onCheckboxChange,className:s.css("od-Notify-group-checkbox")})};e.prototype.render=function(){return l.createElement(n.TooltipHost,{className:s.css("od-Notify-group-recipient"),id:this.props.group.email,content:this.props.group.name,directionalHint:5},this._renderGroup())};e.contextTypes={sharingStore:d.object.isRequired,strings:d.object.isRequired};i.__decorate([a.autobind],e.prototype,"_onCheckboxChange",null);i.__decorate([a.autobind],e.prototype,"_renderGroup",null);return e}(l.Component);t.NotifyGroupRecipient=o});define("@ms/odsp-shared-sharing/lib/components/Notify/Notify.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Notify{padding:0 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-Notify-message{display:-ms-inline-flexbox;display:inline-flex;font-size:15px;padding:6px 0 4px 0;margin:0 3px 0 0}[dir=rtl] .od-Notify-message{margin:0 0 0 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0 0 auto}[dir=rtl] .od-Notify-show-link{margin:8px auto 0 0}.od-Notify-sendNotification-button{margin:24px auto 6px 0}[dir=ltr] .od-Notify-sendNotification-button{text-align:right}[dir=rtl] .od-Notify-sendNotification-button{text-align:left}[dir=rtl] .od-Notify-sendNotification-button{margin:24px 0 6px auto}.od-Notify-group-recipient{display:-ms-flexbox;display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{border-radius:16px;position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.od-Notify-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-Notify-PickerPersona-container.is-selected{background:#d0d0d0}.od-Notify-PickerPersona-container.is-selected:hover{background:#dadada}.od-Notify-PickerPersona-container.is-listbelow{width:100%}.od-Notfiy-groupLabel{font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 0 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:6px 0;margin:0 0 0 auto}[dir=ltr] .od-Notify-totalMembersCount{text-align:right}[dir=rtl] .od-Notify-totalMembersCount{text-align:left}[dir=rtl] .od-Notify-totalMembersCount{margin:0 auto 0 0}.od-Notify-groups-expand{height:26px;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start;margin:14px 0 0}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0 14px;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0 10px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-people-listItem{margin:1px}.od-Notify-PeoplePicker .ms-PickerPersona-container{margin:1px}.od-Notify-PickerPersona-container{max-width:180px;margin:1px}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:11px}[dir=ltr] .od-Notify-groupMembersCount{margin-left:28px}[dir=rtl] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0}"}])});define("@ms/odsp-shared-sharing/lib/components/AddPeople/AddPeople",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","react","./EditView/EditView","../Share.resx","../../components/ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Icon","../Header/Header","./AddPeople.scss"],function(e,t,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p;!function(e){e[e.edit=0]="edit";e[e.successGrantingPermissions=1]="successGrantingPermissions";e[e.successRequestingPermissions=2]="successRequestingPermissions";e[e.failure=3]="failure"}(p=t.AddPeopleView||(t.AddPeopleView={}));var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={message:"",view:p.edit,loading:!1};return t}e.prototype.render=function(){var e=this.state.loading?" blocker":"";return n.createElement("div",{className:"od-AddPeople"+e},this.renderView(),this.state.loading?n.createElement(l.ActivityIndicator,{message:this.state.message}):null)};e.prototype.renderView=function(){switch(this.state.view){case p.edit:return n.createElement(a.EditView,{sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure});case p.successGrantingPermissions:return this._renderSuccessGranting();case p.successRequestingPermissions:return this._renderSuccessRequesting();case p.failure:return this._renderFailure()}};e.prototype._onLoading=function(o){this.setState(function(e,t){if(e.view===p.edit){var i=void 0;i=o.requestedAccess?s.default.activityRequestingAccess:o.notifiedRecipients?s.default.activityAddingAndNotifying:s.default.activityAdding;return r.__assign({},e,{loading:!0,message:i})}return e})};e.prototype._onSuccess=function(e){var t,i;if(e.requestedAccess){t=s.default.accessRequested;i=p.successRequestingPermissions}else{t=e.notifiedRecipients?s.default.addedAndNotified:s.default.added;i=p.successGrantingPermissions}this.setState({view:i,message:t,loading:!1})};e.prototype._onFailure=function(e){this.setState({view:p.failure,message:s.default.addFailed,loading:!1})};e.prototype._renderSuccessGranting=function(){return n.createElement("div",{className:"od-AddPeople-Success"},n.createElement(c.Header,{clientId:this.props.clientId,viewState:9}),n.createElement(d.Icon,{className:"od-ShareNotification-icon",iconName:"CheckMark"}),n.createElement("p",{className:"od-AddPeople-SuccessMessage"},this.state.message))};e.prototype._renderSuccessRequesting=function(){return n.createElement("div",{className:"od-AddPeople-Success"},n.createElement(c.Header,{clientId:this.props.clientId,viewState:9}),n.createElement(d.Icon,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),n.createElement("p",{className:"od-AddPeople-SuccessMessage"},this.state.message))};e.prototype._renderFailure=function(){return n.createElement("div",{className:"od-AddPeople-Failure"},n.createElement(c.Header,{clientId:this.props.clientId,viewState:9}),n.createElement("p",null,this.state.message))};r.__decorate([o.autobind],e.prototype,"_onLoading",null);r.__decorate([o.autobind],e.prototype,"_onSuccess",null);r.__decorate([o.autobind],e.prototype,"_onFailure",null);return e}(n.Component);t.AddPeople=i});define("@ms/odsp-shared-sharing/lib/components/AddPeople/EditView/EditView",["require","exports","tslib","../../Header/Header","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","react","../../Share.resx","../../PeoplePicker/PeoplePicker","../../RoleSelector/RoleSelector","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Checkbox","prop-types","./EditView.scss"],function(e,t,a,i,o,n,s,l,d,c,p,u,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){a.__extends(e,r);function e(e,t){var i,o=r.call(this,e)||this;o._store=t.sharingStore;o._store.addListener(function(){var e=o._store.getAddPeopleResult();null!==e&&(e&&o.props.onSuccess?o.props.onSuccess({notifiedRecipients:o.state.notifyRecipients,requestedAccess:o.userRequiresAccessApproval()}):o.props.onFailure&&o.props.onFailure({notifiedRecipients:o.state.notifyRecipients,requestedAccess:o.userRequiresAccessApproval()}))});i=3===o.props.sharingInformation.userRole?2:o.props.sharingInformation.userRole;o.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,errorMessage:null};return o}e.prototype.render=function(){return s.createElement("div",{className:"od-AddPeople-Edit"},s.createElement("div",{className:"od-AddPeople-Edit-Header"},this._renderHeader()),s.createElement("div",{className:"od-AddPeople-Edit-Section"},this._renderPeoplePicker(),this._renderRoleSelector(),this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))};e.prototype.isAddButtonEnabled=function(){return 0<this.state.people.length&&null===this.state.errorMessage};e.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval};e.prototype.isUnverifiedExternal=function(e){return e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType};e.prototype.numberSelectedUnverifiedExternals=function(){var t=this;return this.state.people.filter(function(e){return t.isUnverifiedExternal(e)}).length};e.prototype._renderPeoplePicker=function(){var e=this.state.people,t=p.getOversharingExternalsWarning(e),i=p.getOversharingGroupsWarning(e,0);return s.createElement("div",{className:"od-AddPeople-PeoplePicker"},s.createElement(d.default,{defaultSelectedItems:this.state.people,error:this.state.errorMessage,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:i,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:1,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:!0}))};e.prototype._renderHeader=function(){return s.createElement(i.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:this.userRequiresAccessApproval()?11:10})};e.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return s.createElement(u.TextField,{className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:l.default.messagePlaceholder,value:this.state.messageText,ariaLabel:l.default.messageAriaLabel,multiline:!0,resizable:!1,onChanged:this._onMessageChange})};e.prototype._renderRoleSelector=function(){return s.createElement("div",{className:"od-AddPeople-RoleSelector"},s.createElement(c.RoleSelector,{onRoleChange:this._onRoleSelectorChange,role:this.state.roleSelection,clientId:this.props.clientId,appmap:this.props.sharingInformation.item.appmap}))};e.prototype._renderNotificationSelector=function(){var e=0<this.numberSelectedUnverifiedExternals();return s.createElement(h.Checkbox,{className:"od-AddPeople-NotificationSelector",disabled:e,label:l.default.notifyPeople,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients})};e.prototype._renderAddButton=function(){var e=this.userRequiresAccessApproval()?l.default.requestAccessButtonLabel:l.default.addButtonLabel;return s.createElement(n.PrimaryButton,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton"},e)};e.prototype._onPeoplePickerChange=function(r){var n=this;this.setState(function(e,t){var i=p.renderPickerError({selectedItems:r,sharingLinkKind:1,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:function(){return null}}),o=n.state.notifyRecipients||0<r.filter(function(e){return e.isExternal}).length;return a.__assign({},e,{people:r,notifyRecipients:o,errorMessage:i})})};e.prototype._onMessageChange=function(e){this.setState({messageText:e})};e.prototype._onRoleSelectorChange=function(e){this.setState({roleSelection:e})};e.prototype._onAllowEditChange=function(e,t){this.setState({notifyRecipients:t})};e.prototype._onAddButtonClick=function(){var e=this.state.messageText||null;this._store.addPeople(this.state.people,this.state.roleSelection,this.userRequiresAccessApproval(),this.state.notifyRecipients,e);this.props.onLoading&&this.props.onLoading({notifiedRecipients:this.state.notifyRecipients,requestedAccess:this.userRequiresAccessApproval()})};e.contextTypes={sharingStore:m.object.isRequired};a.__decorate([o.autobind],e.prototype,"_renderPeoplePicker",null);a.__decorate([o.autobind],e.prototype,"_renderHeader",null);a.__decorate([o.autobind],e.prototype,"_renderMessageArea",null);a.__decorate([o.autobind],e.prototype,"_onPeoplePickerChange",null);a.__decorate([o.autobind],e.prototype,"_onMessageChange",null);a.__decorate([o.autobind],e.prototype,"_onRoleSelectorChange",null);a.__decorate([o.autobind],e.prototype,"_onAllowEditChange",null);a.__decorate([o.autobind],e.prototype,"_onAddButtonClick",null);return e}(s.Component);t.EditView=r});define("@ms/odsp-shared-sharing/lib/components/AddPeople/EditView/EditView.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;padding-bottom:12px}.od-AddPeople-Edit-Section{padding:0 16px 0 16px;display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap}.od-AddPeople-PeoplePicker{padding-bottom:12px}.od-AddPeople-Message{padding-bottom:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{padding:0}.od-AddPeople-RoleSelector{padding-bottom:12px}.od-AddPeople-NotificationSelector{-ms-flex-item-align:start;align-self:flex-start;padding-bottom:12px}.od-AddPeople-AddButton{-ms-flex-item-align:start;align-self:flex-start}"}])});define("@ms/odsp-shared-sharing/lib/components/AddPeople/AddPeople.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-AddPeople-Success{display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{margin-top:24px}.od-AddPeople-Failure{padding:24px 16px 0 16px}"}])});define("@ms/odsp-shared-sharing/lib/components/Share/Share.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share{min-width:320px;min-height:150px;overflow-y:auto;overflow-x:hidden}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:6px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:6px}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;border-color:#6264a7;background-color:RGBA(#6264a7,.06)}.od-Share .icon-Globe{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";background-color:RGBA("},{theme:"green",defaultValue:"#107c10"},{rawString:", .06)}.od-Share .icon-Work{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background-color:RGBA("},{theme:"blue",defaultValue:"#0078d4"},{rawString:", .06)}.od-Share .icon-PeopleAdd{color:"},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:";background-color:RGBA("},{theme:"orangeLighter",defaultValue:"#ea4300"},{rawString:", .06)}.od-Share .icon-SecurityGroup{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";background-color:RGBA("},{theme:"orange",defaultValue:"#d83b01"},{rawString:", .06)}.od-Share .icon-Group{border-color:#d9b108;color:#d9b108;background-color:#fffdf4}.od-Share .ms-Tooltip{pointer-events:none}.is-in-colors-experiment .od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.is-in-colors-experiment .od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.is-in-colors-experiment .od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f3f3f3;border:1px solid #393939}.is-in-colors-experiment .od-ShareLinkDescription-icon.icon-SecurityGroup{color:#a4262c;background:#faf2f3;border:1px solid #a4262c}.is-in-colors-experiment .od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d}.is-in-colors-experiment .od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}.is-in-mac-v4-experiment .ms-Button .ms-Button-label{font-size:13px;font-weight:400}.is-in-mac-v4-experiment .ms-Button-textContainer{padding-bottom:2px}.is-in-mac-v4-experiment .ms-Button--default{background:#fff;border:1px solid #aeaeae;color:#262627;border-radius:4px;box-shadow:0 1px 1px #aeaeae;height:24px}.is-in-mac-v4-experiment .ms-Button--default:hover{background:#f8f7f7}.is-in-mac-v4-experiment .ms-Button--default .od-focus--enabled{border:none;box-shadow:0 0 4px 4px #84c1f3;background:#f8f7f7}.is-in-mac-v4-experiment .ms-Button--default:focus::after{border:none;outline:0}.is-in-mac-v4-experiment .ms-Button--default:active{color:#fff;background:linear-gradient(#6bb2f9,#087eff);border:1px solid transparent;box-shadow:none}.is-in-mac-v4-experiment .ms-Button--default.is-disabled{border:1px solid #e9e9e9;box-shadow:none;background:#f5f5f5;color:#b8b8ba}.is-in-mac-v4-experiment .ms-Button--primary{color:#fff;background:linear-gradient(#6bb2f9,#087eff);border:none;border-radius:4px;box-shadow:0 1px 1px #aeaeae;height:24px}.is-in-mac-v4-experiment .ms-Button--primary:hover{background:linear-gradient(#6bb2f9,#0773e8)}.is-in-mac-v4-experiment .ms-Button--primary .od-focus--enabled{border:none;box-shadow:0 0 4px 4px #84c1f3;background:linear-gradient(#6bb2f9,#0773e8)}.is-in-mac-v4-experiment .ms-Button--primary:focus::after{border:none;outline:0}.is-in-mac-v4-experiment .ms-Button--primary:active{color:#fff;background:linear-gradient(#1e8cfa,#076ede);border:none;box-shadow:none}.is-in-mac-v4-experiment .ms-Button--primary.is-disabled{border:1px solid #e9e9e9;box-shadow:none;background:#f5f5f5;color:#b8b8ba}.is-in-mac-v4-experiment .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{height:40px;font-size:13px;font-weight:400}.is-in-mac-v4-experiment .od-ShareHeader-viewName{font-size:14px;font-weight:600}.is-in-mac-v4-experiment .od-ShareHint .od-ShareHint-data{font-size:11px;font-weight:400}.is-in-mac-v4-experiment .od-ShareHintDetail-status{font-size:11px;font-weight:400}.is-in-mac-v4-experiment .od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.is-in-mac-v4-experiment .od-SendLink-showAccessLink{font-size:12px;font-weight:400}.is-in-mac-v4-experiment .od-ShareTargets-itemText{font-size:11px;font-weight:400}.is-in-mac-v4-experiment .od-ShareMain-footer.ms-Button .ms-Button-flexContainer{font-size:13px;font-weight:400}.is-in-mac-v4-experiment .od-PermissionsSettings-description{font-size:13px;font-weight:400}.is-in-mac-v4-experiment .od-ShareLinkDescription-label{font-size:15px;font-weight:400}.is-in-mac-v4-experiment .od-ExpirationDatePicker-Content{font-size:13px;font-weight:400}.is-in-mac-v4-experiment .od-PermissionsSettings-allowEdit{font-size:12px;font-weight:400}.is-in-mac-v4-experiment .od-ShareNotification-urlText{-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}[dir=ltr] .is-in-mac-v4-experiment .od-ShareNotification-copyButton{margin-left:3px}[dir=rtl] .is-in-mac-v4-experiment .od-ShareNotification-copyButton{margin-right:3px}.is-focusVisible .is-in-mac-v4-experiment .ms-Button--default:focus{border:1px solid transparent;box-shadow:0 0 4px 4px #84c1f3;background:#f8f7f7}.is-focusVisible .is-in-mac-v4-experiment .ms-Button--primary:focus{border:none;box-shadow:0 0 4px 4px #84c1f3;background:linear-gradient(#6bb2f9,#0773e8)}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share{width:320px}}button.od-Share-backButton{background:0 0;border:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:absolute;top:8px}[dir=ltr] button.od-Share-backButton{left:10px}[dir=rtl] button.od-Share-backButton{right:10px}html[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}.od-Share-spinnerHolder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:150px;-ms-flex-pack:center;justify-content:center}.od-Share-error{padding:16px;font-size:14px;font-weight:400;word-break:break-word}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("odsp-next/controls/sharing/share/react/Share",["require","exports","tslib","prop-types","office-ui-fabric-react/lib/Utilities","@ms/odsp-shared-sharing/lib/components/Share/index","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","react","../../../../providers/sharing/react/SharingStore","../../../../utilities/features/Features","@ms/odsp-utilities/lib/icons/ItemType","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-utilities/lib/browser/ResponsiveUI","@ms/odsp-utilities/lib/logging/ABExperiment","es6-promise/auto","../../../sharedSharing/SharedSharing.css"],function(e,t,i,o,r,n,p,u,a,h,s,m,g,f,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(c){i.__extends(e,c);function e(e){var t=c.call(this,e)||this,i=window._sharingContextInfo;t._copyLinkShortcut=e.copyLinkShortcut;t._onDismiss=e.onDismiss;t._onResize=e.onResize;t._peoplePickerProvider=e.peoplePickerProvider;t._mode=e.mode||(t._copyLinkShortcut?u.Mode.copy:u.Mode.share);t._messageText=e.messageText;t._sharingStore=new h.default({item:e.item,sharingInformation:e.sharingInformation,defaultRecipients:e.defaultRecipients,accessChecked:e.accessChecked,mode:t._mode,sharingContextInformation:i},{sharingProvider:e.sharingProvider,suiteNavProvider:e.suiteNavProvider,peoplePickerProvider:e.peoplePickerProvider,policyTipProvider:e.policyTipProvider,graphPeoplePickerHelper:e.graphPeoplePickerHelper});t._platformDetection=new g.default;t._breakpoint=f.default.DEFAULT_BREAKPOINTS[f.default.determineWindowSize(window.innerWidth)];t._isMacV4ExperimentOn=!1;if((t.props.clientId===u.ClientId.word||t.props.clientId===u.ClientId.excel||t.props.clientId===u.ClientId.powerpoint||t.props.clientId===u.ClientId.visio)&&t._platformDetection.isMac&&!p.Killswitch.isActivated("a7071538-6b97-4deb-9c36-b790abf6651c","7/27/2018","Mac Sharing Dialog V4 Experiment")){var o=new b.ABExperiment({name:"MacOfficeSharingDialogV4",startDate:"07/27/2018",version:b.ABExpHash.v2});t._isMacV4ExperimentOn=o.IsExperimentOn()}t._noMaxHeightRestrictionExp=!t._platformDetection.isIOS&&!t._platformDetection.isAndroid;if(!e.noMaxHeightRestriction&&!t._noMaxHeightRestrictionExp){var r=t.props.maxHeight;t._maxHeight=r<550?r:550}var n=0,a=" ";if(e.item&&e.item.properties){var s=e.item.properties,l=s.ItemChildCount?parseInt(s.ItemChildCount,10):0,d=s.FolderChildCount?parseInt(s.FolderChildCount,10):0;n=t.props.item.type===m.default.OneNote?0:l+d;a=e.item.name}else if(i){a=i.itemName||" ";n=i.itemCount||0}t._sharingItemInformation={name:a,childCount:n,hasDlpPolicy:void 0};return t}e.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize.bind(this),onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,usesSharingAbilities:s.isFeatureEnabled(s.SharingAbilities),platformDetection:this._platformDetection,breakpoint:this._breakpoint,isMacV4ExperimentOn:this._isMacV4ExperimentOn}};e.prototype.render=function(){var e=this.props;return a.createElement("div",{className:"od-share-v3",ref:"share"},a.createElement(n.Share,{copyLinkShortcut:this._copyLinkShortcut,shareId:e.shareId,theme:e.theme,clientId:e.clientId||e.sharingProvider.getClientId(),scenarioId:e.scenarioId||"",customLabeledAudienceConfig:e.customLabeledAudienceConfig,showExistingAccessOption:e.sharingProvider.supportsExistingAccessOption(e.item),onManageAccessClicked:e.onManageAccessClicked,hideShareDialogOverflowButton:e.hideShareDialogOverflowButton,enableShimmer:!p.Killswitch.isActivated("c06652c0-2c26-4b10-b9b1-dce25a2e3a9f","2/09/2018","Enable share ux shimmer"),createPeopleSharingLinks:s.isFeatureEnabled(s.SharingSupportsEmailAuthGuest)&&s.isFeatureEnabled(s.PeopleSharingLinks),maxHeight:this._maxHeight,mode:this._mode,messageText:this._messageText,sharingItemInformation:this._sharingItemInformation}))};e.prototype.componentWillUnmount=function(){this._sharingStore.dispose()};e.prototype._resize=function(){var t=this.refs.share;if(t){this._onResize&&this._onResize();var e=this._maxHeight,i=t.clientHeight>e?e:t.clientHeight;try{window.external.Resize(t.clientWidth,i)}catch(e){var o={name:"share_resize",width:t.clientWidth,height:i};window.top.postMessage(JSON.stringify(o),"*")}}};e.prototype._dismiss=function(){try{window.external.Dismiss()}catch(e){var t={name:"share_dismiss"};window.top.postMessage(JSON.stringify(t),"*")}};e.childContextTypes={peoplePickerProvider:o.object.isRequired,resize:o.func.isRequired,onDismiss:o.func,sharingStore:o.object.isRequired,usesSharingAbilities:o.bool.isRequired,platformDetection:o.object.isRequired,breakpoint:o.object.isRequired,isMacV4ExperimentOn:o.bool.isRequired};i.__decorate([r.autobind],e.prototype,"_resize",null);i.__decorate([r.autobind],e.prototype,"_dismiss",null);return e}(a.Component);t.default=l});define("odsp-next/providers/sharing/react/SharingStore",["require","exports","tslib","../../../providers/peoplePicker/PeoplePickerProvider","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","../../../providers/policyTip/PolicyTipProvider","@ms/odsp-shared-sharing/lib/store/odb/SharingStore"],function(e,t,o,r,n,a,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){o.__extends(e,i);function e(e,t){return i.call(this,e,t)||this}e.dependencies={sharingProvider:n.resourceKey,suiteNavProvider:a.resourceKey,peoplePickerProvider:r.resourceKey,policyTipProvider:s.resourceKey};return e}(i.default);t.default=l});define("@ms/odsp-shared-sharing/lib/store/odb/SharingStore",["require","exports","tslib","../../interfaces/SharingInterfaces","../../Share","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/events/EventGroup","../../components/Share.resx"],function(e,t,v,c,d,s,i,p,x,_,u,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k={ODB:781},P={ODB:469},o={ODB:868},r={ODB:780},n=function(){function e(e,t){var o=this;this._listeners=null;var i=e.item,r=e.sharingInformation,n=e.defaultRecipients,a=e.accessChecked,s=void 0===a||a,l=e.mode;this._item=i;this._sharingContextInformation=e.sharingContextInformation;this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._store={sharingInformation:r,sharingLinkCreated:null,companyName:this._sharingContextInformation&&this._sharingContextInformation.organizationName||S.default.companyNameFallback,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:d.OutlookAvailability.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};if(n&&0!==n.length)this._resolveDefaultRecipients(n,s,l);else{this._eventGroup=new u.default(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var i=t.recipientIds;o._resolveDefaultRecipients(i,s,l)}}catch(e){}})}}e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getSharingInformation=function(){return this._store.sharingInformation};e.prototype.fetchSharingInformation=function(e){var a=this;if(!this._store.sharingInformation||this._sharingInformationInvalidated||e&&!this._store.sharingInformation.hasPermissionsInformation){var t=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,t).then(function(e){a._store.sharingInformation=e;a._fetchAdditionalAuthenticationTokens();a.fetchPolicyTipInformation();a._emitChange()},function(e){var t=5,i=e&&e.code,o=e&&e.status,r=e&&e.message&&e.message.value||S.default.getSharingInformationError,n=e&&e.responseData&&e.responseData.error_description||r;i?-1<i.indexOf("-2147024809")&&r&&r.value&&-1<r.value.indexOf("Item does not exist")&&(t=3):o&&500<=parseInt(o,10)&&(t=2);a._store.sharingInformation={error:t,errorCategory:1,errorMessage:r,debugErrorMessage:o+" - "+n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1};a._emitChange()})}else this._emitChange()};e.prototype.fetchMemberCount=function(i){var o=this;this._groupMembersCountHash[i.email]||this._peoplePickerProvider.getPickerEntityInformation(i).then(function(e){var t=e.totalMemberCount;o._groupMembersCountHash[i.email]=t;o._emitChange()}).catch(function(e){o._groupMembersCountHash[i.email]=null;o._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(a,e,t,s,i,o,r){var l=this,n=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;var d=0,c=0,p=(e=e||[]).map(function(e){1===e.entityType?c++:d++;return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});if((x.default.isFeatureEnabled(k)&&x.default.isFeatureEnabled(P)&&3!==a.audience||5===a.audience)&&!this._store.sharingInformation.requiresAccessApproval)this._shareLink(a,p,t,s,n,o,r);else if(1!==a.sharingLinkKind&&6!==a.sharingLinkKind)this._shareLink(a,p,t,s,n,o,r);else{var u=void 0;u=a.sharingRole?this._getRoleString(a.sharingRole):this._getRoleValue(a.isEdit);var h={items:[this._item],roleValue:u,sendEmail:void 0!==t,message:t,requireSignIn:!0,propagateSharing:!0},m=this._store.sharingInformation.directLink;if(0===e.length)this._handleSharedLink(m,s);else{for(var g=!0,f=0,b=e;f<b.length;f++){var y=b[f];3!==this._store.permissionsMap[y.email]&&(g=!1)}g||i?this._sharingProvider.emailWithoutPermissioning(p,this._item,t).done(function(e){var t=e.statusCode;if(0===t)l._handleSharedLink(m,s);else{var i=S.default,o=5,r=i.getSharingInformationError;if(-8===t){o=6;r=i.sharingOperationNotSupportedError}else if(-13===t){o=7;r=_.format(i.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===t){o=5;r=e.errorMessage}l._store.sharingInformation=v.__assign({},l._store.sharingInformation,{error:o,errorCategory:3,errorMessage:r});l._emitChange()}}):this._sharingProvider.share(p,h,!0).done(function(e){var t=e.statusCode;if(0===t){var i=m;0===d&&1===c&&e.invitationLink?i=v.__assign({},m,{url:e.invitationLink}):0===d&&1<c&&e.invitationLink&&(i=v.__assign({},m,{url:l._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));5===a.audience&&(i=v.__assign({},i,{audience:5}));l._handleSharedLink(i,s)}else if(1===t){l._store.accessRequestCreated=!0;l._handleSharedLink(m,s)}else{var o=S.default,r=5,n=o.getSharingInformationError;if(-8===t){r=6;n=o.sharingOperationNotSupportedError}else if(-13===t){r=7;n=_.format(o.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===t){r=5;n=e.errorMessage}l._store.sharingInformation=v.__assign({},l._store.sharingInformation,{error:r,errorCategory:3,errorMessage:n});l._emitChange()}})}}s&&this._store.defaultLink&&this._store.defaultLink.audience!==a.audience&&this._cleanupDefaultLink()};e.prototype.unshareLink=function(e,t){var i=this,o={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(o).done(function(e){if(!0===e){i._removeLinkByShareId(t);i._updateIsShared();i._emitChange()}})};e.prototype.getSharingLinkCreated=function(){return this._store.sharingLinkCreated};e.prototype.updatePermissions=function(n,e){var a=this;this._sharingProvider.updatePermissions2(n,this._item,e).done(function(e){var t=a._store.sharingInformation.sharingPrincipals;if(e.role===c.UpdatePermissionsRole.NONE){a._store.sharingInformation.sharingPrincipals=t.filter(function(e){return e.id!==n.id});a._updateIsShared();a._emitChange()}else for(var i=0,o=t;i<o.length;i++){var r=o[i];if(r.id===n.id){switch(e.role){case c.UpdatePermissionsRole.VIEW:r.role=1;break;case c.UpdatePermissionsRole.EDIT:r.role=2;break;case 6:r.role=6}a._emitChange()}}})};e.prototype.addPeople=function(e,t,i,o,r){var n=this,a=this._getRoleString(t),s={items:[this._item],roleValue:a,sendEmail:o,message:r,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,s,!0).then(function(e){n._store.addPeopleResult=0===e.statusCode;n._emitChange()},function(){n._store.addPeopleResult=!1;n._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var o=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(e){var t=o._store.companyName||e.CompanyDisplayName,i=e?JSON.parse(e.ClientData):{HasEXOLicense:!1};o._store.companyName=t;o._store.outlookAvailability=i.HasEXOLicense?d.OutlookAvailability.available:d.OutlookAvailability.none;o._emitChange()});else{this._store.outlookAvailability=d.OutlookAvailability.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._store.companyName};e.prototype.getOutlookAvailability=function(){return this._store.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.fetchGroupsMemberCount=function(e){for(var o=this,r=0,t=function(i){var e={userId:i.userId,name:i.name,email:i.email,rawPersonData:i.rawPersonData,principalType:i.principalType};if(i.principalType===s.default.securityGroup){var t=n._groupsMemberCountCache[i.userId];void 0!==t?r+=t:n._peoplePickerProvider.getPickerEntityInformation(e).then(function(e){var t=e.totalMemberCount;o._groupsMemberCountCache[i.userId]=t;r+=t;o._store.groupsMemberCount=r;o._emitChange()}).catch(function(e){o._groupsMemberCountCache[i.userId]=null;o._emitChange()})}},n=this,i=0,a=e;i<a.length;i++){t(a[i])}this._store.groupsMemberCount=r;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._store.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var t=this;if(this._policyTipProvider){if(this._store.policyTipInfo.info){this._emitChange();return}var e=this._store.sharingInformation;if(!e)return;var i=e.sharingAbilities;if(i){if(7!==(i&&i.directSharingAbilities.canAddExternalPrincipal.disabledReason))return}else{if(this._item&&!this._isPolicyTipFlagSet(this._item.policyTip,4))return;if(!this._item)return}this._policyTipProvider.getPolicyTip(this._item).then(function(e){if(e){t._store.policyTipInfo.info=e;t._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._store.policyTipInfo};e.prototype.updatePolicy=function(e,t){var i=this;if(this._policyTipProvider){var o={item:this._item,action:e};t&&(o.justification=t);this._policyTipProvider.updatePolicy(o).then(function(e){i._store.policyTipInfo.actionResult=e;i._sharingInformationInvalidated=!0;i.fetchSharingInformation(!0);i._emitChange()})}};e.prototype.checkPermissions=function(e,t){var r=this;if(0!==e.length){var i=[];this._recipients=[];for(var o=0,n=e;o<n.length;o++){var a=n[o];i.push({alias:a.email});this._recipients.push(a.email)}t=t||this._store.invitedUsers;this._invitedUsers=[];for(var s=0,l=t;s<l.length;s++){var d=l[s];i.push({alias:d.email});this._invitedUsers.push(d.email)}this._sharingProvider.checkPermissions(i,this._item).then(function(e){r._store.permissionsMap={};for(var t=0,i=e;t<i.length;t++){var o=i[t];-1<r._invitedUsers.indexOf(o.inputEntity)?r._store.permissionsMap[o.inputEntity]=o.hasAccess?3:2:-1<r._recipients.indexOf(o.inputEntity)&&(r._store.permissionsMap[o.inputEntity]=o.hasAccess?3:1)}r._emitChange()})}else{this._store.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._store.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._store.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._store.defaultRecipients={isConsumed:!0,recipients:this._store.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,i=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}}),o={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(i,o,!0).done(function(e){t._store=v.__assign({},t._store,{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._store.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._store.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._store.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._store.isValidatingDefaultRecipients};e.prototype._cleanupDefaultLink=function(){var e=this._store.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._store.defaultLink=void 0}};e.prototype._emitChange=function(){for(var e=0,t=this._listeners;e<t.length;e++){(0,t[e])()}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var t=this;if(this._store.sharingInformation){var i=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();i?this._graphPeoplePickerHelper.getGraphToken().then(function(e){i=!!e;t._store.sharingInformation.isGraphAvailable=i}):this._store.sharingInformation.isGraphAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._store.sharingLinkCreated=e;this._updateIsShared();this._emitChange()};e.prototype._getRoleValue=function(e){return e?"role:1073741827":"role:1073741826"};e.prototype._getRoleString=function(e){return 6===e?"roletype:Reviewer":2===e?"role:1073741827":"role:1073741826"};e.prototype._removeLinkByShareId=function(t){this._store.sharingInformation.sharingLinks=this._store.sharingInformation.sharingLinks.map(function(e){if(t===e.shareId){e.expiration=null;e.isActive=!1;e.shareId=i.default.Empty;e.url=null;e.principals=[]}return e})};e.prototype._updateIsShared=function(){for(var e=this._store.sharingInformation,t=e.sharingLinks,i=e.sharingPrincipals,o=!1,r=0,n=t;r<n.length;r++){var a=n[r];a.isActive&&1!==a.sharingLinkKind&&(o=!0)}o||(o=0<i.length);this._store.sharingInformation.isShared=o};e.prototype._getOwaUrl=function(e,t){var i=location.origin.indexOf(".cn")===location.origin.length-3,o=location.origin.indexOf(".de")===location.origin.length-3,r="https://outlook.office.com/owa/";i?r="https://partner.outlook.cn/owa/":o&&(r="https://outlook.de/owa/");return r+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,a){var s=this,l=e||[],i=[];this._store.isValidatingDefaultRecipients=0<e.length;if(!t){l=[];for(var o=[],r=0,n=e;r<n.length;r++){var d=n[r];o.push({alias:d})}i.push(this._sharingProvider.checkPermissions(o,this._item).then(function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];o.hasAccess||l.push(o.inputEntity)}}))}p.default.all(i).then(function(){if(0!==l.length){for(var e=[],t=[],i={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},o=0,r=l;o<r.length;o++){var n=r[o];e.push(s._peoplePickerProvider.resolve(n,i).then(function(e){t.push(e)}))}p.default.all(e).then(function(){s._store.defaultRecipients={isConsumed:!1,recipients:t};s._store.isValidatingDefaultRecipients=!1;s._emitChange()},function(){s._store.defaultRecipients={isConsumed:!1,recipients:[]};s._store.isValidatingDefaultRecipients=!1;s._emitChange()})}else if(a===c.Mode.atMention){s._store=v.__assign({},s._store,{grantAccessResult:!0});s._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(1<t.length){for(var i=[],o=0,r=t[1].split("&");o<r.length;o++){var n=r[o];-1===n.indexOf("email=")&&i.push(n)}var a=i.join("&");return t[0]+"?"+a}return e};e.prototype._shareLink=function(i,e,t,o,r,n,a){var s=this,l={emailData:t,items:[this._item],recipients:e,settings:{sharingLinkKind:i.sharingLinkKind,expiration:i.expiration,updatePassword:i.updatePassword,password:i.password,shareId:n,inviteesToRemove:a}};if(i.updatePassword&&2===i.audience){l.settings.sharingLinkKind=6;l.settings.allowAnonymousAccess=!0;i.sharingRole?l.settings.role=i.sharingRole:l.settings.role=i.isEdit?2:1}if(2===i.audience){l.settings.allowAnonymousAccess=!0;l.settings.restrictShareMembership=!1}else if(1===i.audience){l.settings.allowAnonymousAccess=!1;l.settings.restrictShareMembership=!1}if(i.preventDownload){l.settings.role=7;i.sharingRole=7;l.settings.sharingLinkKind=6}if(4===i.audience||5===i.audience){l.settings.restrictShareMembership=!0;i.sharingRole?l.settings.role=i.sharingRole:l.settings.role=i.isEdit?2:1}this._sharingProvider.shareLink(l).done(function(e){if(e.error){s._store.sharingInformation=v.__assign({},s._store.sharingInformation,{error:e.error,errorCategory:2,errorMessage:S.default.getSharingInformationError});s._emitChange()}else{var t=e.link;5===i.audience&&(t.audience=5);t.sharingLinkKind===s._store.sharingInformation.defaultSharingLink.sharingLinkKind&&r&&o&&s._store.sharingInformation.sharingLinks.forEach(function(e){e.audience!==t.audience||e.isActive||(s._store.defaultLink=t)});if(n){s._sharingInformationInvalidated=!0;s.fetchSharingInformation(!0);s._emitChange()}else s._handleSharedLink(t,o)}})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype.isAudienceModificationAllowed=function(){return!0};e.prototype.isPasswordModificationAllowed=function(){return x.default.isFeatureEnabled(o)};e.prototype.isPreventDownloadModificationAllowed=function(){return x.default.isFeatureEnabled(r)};return e}();t.default=n});!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("es6-promise/auto",[],t):e.ES6Promise=t()}(this,function(){"use strict";function d(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(i,1)}}function i(){for(var e=0;e<_;e+=2){(0,L[e])(L[e+1]),L[e]=void 0,L[e+1]=void 0}_=0}function s(e,t){var i=this,o=new this.constructor(a);void 0===o[M]&&y(o);var r=i._state;if(r){var n=arguments[r-1];P(function(){return b(r,o,n,i._result)})}else g(i,o,e,t);return o}function l(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(a);return u(t,e),t}function a(){}function c(e){try{return e.then}catch(e){return O.error=e,O}}function p(e,t,i){t.constructor===e.constructor&&i===s&&t.constructor.resolve===l?(n=e,(a=t)._state===F?h(n,a._result):a._state===R?m(n,a._result):g(a,void 0,function(e){return u(n,e)},function(e){return m(n,e)})):i===O?(m(e,O.error),O.error=null):void 0===i?h(e,t):d(i)?(o=t,r=i,P(function(t){var i=!1,e=function(e,t,i,o){try{e.call(t,i,o)}catch(e){return e}}(r,o,function(e){i||(i=!0,o!==e?u(t,e):h(t,e))},function(e){i||(i=!0,m(t,e))},t._label);!i&&e&&(i=!0,m(t,e))},e)):h(e,t);var o,r,n,a}function u(e,t){e===t?m(e,new TypeError("You cannot resolve a promise with itself")):(o=typeof(i=t),null===i||"object"!==o&&"function"!==o?h(e,t):p(e,t,c(t)));var i,o}function o(e){e._onerror&&e._onerror(e._result),f(e)}function h(e,t){e._state===A&&(e._result=t,e._state=F,0!==e._subscribers.length&&P(f,e))}function m(e,t){e._state===A&&(e._state=R,e._result=t,P(o,e))}function g(e,t,i,o){var r=e._subscribers,n=r.length;e._onerror=null,r[n]=t,r[n+F]=i,r[n+R]=o,0===n&&e._state&&P(f,e)}function f(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var o=void 0,r=void 0,n=e._result,a=0;a<t.length;a+=3)o=t[a],r=t[a+i],o?b(i,o,r,n):r(n);e._subscribers.length=0}}function b(e,t,i,o){var r=d(i),n=void 0,a=void 0,s=void 0,l=void 0;if(r){if((n=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(i,o))===O?(l=!0,a=n.error,n.error=null):s=!0,t===n)return void m(t,new TypeError("A promises callback cannot return that same promise."))}else n=o,s=!0;t._state!==A||(r&&s?u(t,n):l?m(t,a):e===F?h(t,n):e===R&&m(t,n))}function y(e){e[M]=N++,e._state=void 0,e._result=void 0,e._subscribers=[]}var e,r,n,v,x=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},_=0,S=void 0,k=void 0,P=function(e,t){L[_]=e,L[_+1]=t,2===(_+=2)&&(k?k(i):E())},w="undefined"!=typeof window?window:void 0,C=w||{},I=C.MutationObserver||C.WebKitMutationObserver,T="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),D="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=new Array(1e3),E=void 0;E=T?function(){return process.nextTick(i)}:I?(r=0,n=new I(i),v=document.createTextNode(""),n.observe(v,{characterData:!0}),function(){v.data=r=++r%2}):D?((e=new MessageChannel).port1.onmessage=i,function(){return e.port2.postMessage(0)}):void 0===w&&"function"==typeof require?function(){try{var e=Function("return this")().require("vertx");return void 0!==(S=e.runOnLoop||e.runOnContext)?function(){S(i)}:t()}catch(e){return t()}}():t();var M=Math.random().toString(36).substring(2),A=void 0,F=1,R=2,O={error:null},N=0,B=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(a),this.promise[M]||y(this.promise),x(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?h(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&h(this.promise,this._result))):m(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,o=i.resolve;if(o===l){var r=c(t);if(r===s&&t._state!==A)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(i===H){var n=new i(a);p(n,t,r),this._willSettleAt(n,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(o(t),e)},e.prototype._settledAt=function(e,t,i){var o=this.promise;o._state===A&&(this._remaining--,e===R?m(o,i):this._result[t]=i),0===this._remaining&&h(o,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;g(e,void 0,function(e){return i._settledAt(F,t,e)},function(e){return i._settledAt(R,t,e)})},e}(),H=function(){function t(e){this[M]=N++,this._result=this._state=void 0,this._subscribers=[],a!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e(function(e){u(t,e)},function(e){m(t,e)})}catch(e){m(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var i=this.constructor;return this.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})})},t}();return H.prototype.then=s,H.all=function(e){return new B(this,e).promise},H.race=function(r){var n=this;return new n(x(r)?function(e,t){for(var i=r.length,o=0;o<i;o++)n.resolve(r[o]).then(e,t)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},H.resolve=l,H.reject=function(e){var t=new this(a);return m(t,e),t},H._setScheduler=function(e){k=e},H._setAsap=function(e){P=e},H._asap=P,H.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=H},(H.Promise=H).polyfill(),H});define("odsp-next/controls/sharedSharing/SharedSharing.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".isFluent .od-AudienceChoiceGroup-row{padding:0;width:calc(100% - 32px)}.isFluent .od-AudienceChoiceGroup-row.is-selected::after{color:#323130;font-size:12px}.isFluent .od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#FAFAF9;border-color:#a19f9d}.isFluent .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.isFluent .od-ExpirationDatePicker .od-ExpirationDatePicker-Content{border-bottom:1px solid #f3f2f1}.isFluent .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:16px}[dir=ltr] .isFluent .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:12px}[dir=rtl] .isFluent .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:12px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.isFluent .od-ShareHeader-title{-ms-flex-align:start;align-items:flex-start}.isFluent .od-ShareHeader-viewName{font-size:20px;font-weight:600;color:#323130}.isFluent .od-ShareHeader-itemName{text-align:initial;font-size:12px}.isFluent .od-ModifyPermissions-section{padding:0}.isFluent .od-ModifyPermissions-margins{margin:0 20px 0 16px}[dir=rtl] .isFluent .od-ModifyPermissions-margins{margin:0 16px 0 20px}.isFluent .od-PasswordField .od-ShareLink-passwordFieldContent{border-bottom:1px solid #f3f2f1}.isFluent .od-PasswordField-label{font-size:16px}[dir=ltr] .isFluent .od-PasswordField-label{margin-right:12px}[dir=rtl] .isFluent .od-PasswordField-label{margin-left:12px}.isFluent .od-PermissionsSettings-description{padding-bottom:8px;font-size:14px;font-weight:600;color:#323130}.isFluent .od-PermissionsSettings-bottomBorder{border-bottom:0}.isFluent .od-PermissionsSettings-setting{margin-bottom:12px}.isFluent .od-PermissionsSettings-setting .ms-Checkbox-checkbox{border-radius:2px}.isFluent .od-PermissionsSettings-learnMore{display:none}.isFluent .od-PermissionsSettings-setting--PreventDownload-Icon{font-size:16px}.isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir=rtl] .isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}[dir=ltr] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir=rtl] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-right:0}.isFluent .od-RoleSelector-settingIcon{font-size:16px}[dir=ltr] .isFluent .od-RoleSelector-settingIcon{padding-left:0}[dir=rtl] .isFluent .od-RoleSelector-settingIcon{padding-right:0}.isFluent .od-SendLink-emailButtons-left .ms-Button{border-radius:2px}.isFluent .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:14px;height:32px}.isFluent .od-SendLink-sendContainer{-ms-flex-pack:end;justify-content:flex-end}.isFluent .od-Share{min-width:340px}.isFluent .od-Share .ms-Button+.ms-Button{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:#323130;border:1px solid #8a8886}[dir=ltr] .isFluent .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .isFluent .od-Share .ms-Button+.ms-Button{margin-right:13px}.isFluent .od-Share .ms-Button+.ms-Button:hover{background-color:#f3f2f1;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.isFluent .od-Share .ms-Button+.ms-Button:active{background-color:#c8c6c4;color:#201f1e}.isFluent .od-Share .ms-Button{border-radius:2px}.isFluent .od-Share .icon-Globe{color:#0b6a0b;border-color:#0b6a0b;background-color:#F1F6F1}.isFluent .od-Share .icon-Work{color:#004e8c;border-color:#004e8c;background-color:#F0F5F8}.isFluent .od-Share .icon-PeopleAdd{color:#393939;border-color:#393939;background-color:RGBA(#393939,.06)}.isFluent .od-Share .icon-SecurityGroup{color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.isFluent .od-Share .ms-Button{border-radius:2px}.isFluent .od-ShareHint{margin:0 16px}.isFluent .od-ShareHint .od-ShareHint-data{border-radius:2px}.isFluent .od-ShareMain-section{padding:16px 16px 0}.isFluent .od-ShareMain-section.full-bleed{padding:0}.isFluent .od-ShareNotification-icon{background-color:#498205}.isFluent .od-ShareNotification-content .ms-font-l{font-weight:500}.isFluent .od-ShareNotification-urlText{padding:12px 0}.isFluent .od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{border-radius:2px;border-color:#b3b0ad}.isFluent .od-ShareNotification .od-ShareHint{border-top:0;margin:0}.isFluent .od-ShareNotification-successPadding .od-ShareNotification-copyButton{display:none}html[dir=ltr] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}html[dir=rtl] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}html[dir=ltr] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}html[dir=rtl] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.isFluent .od-ShareTargets-itemImage{background-color:#faf9f8}.isFluent .od-ShareTargets-icon{font-size:26px;color:#323130}.isFluent .od-ShareTargets-itemText{font-size:10px}"}])});define("odsp-next/bindings/focus/AutoFocusBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o.applyBindingsToNode,d=o.virtualElements,n=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=t,o=i.observables,r=i.bindingContext,n=i.element,a=function(){var e=document.createElement("a");e.href="javascript:;";e.className="ms-accessible";e.setAttribute("role","presentation");return e}();d.prepend(n,a);o.backgroundCompute(function(){a.focus()});l(a,{},r);return t}e.supportsVirtualElements=!0;return e}(r.default);t.default=n});define("odsp-next/controls/notifyExperiment/NotifyExperiment.html",[],function(){return'\x3c!--ko if: showNotifyExperiment--\x3e\x3c!--ko autoFocus--\x3e\x3c!--ko focusTrap--\x3e<div class=od-Notify-callout data-bind="react: { componentType: shareComponent, props: shareComponentProps }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/notifyExperiment/NotifyExperiment.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Notify-callout{min-height:68px;width:260px}.od-Notify-callout:focus{outline:0}.od-Notify-callout .od-Share{min-width:inherit;min-height:inherit;width:inherit;height:inherit}.od-Notify-callout .od-Share .od-Share-spinnerHolder{min-width:inherit;min-height:inherit;width:inherit;height:inherit}"}])});define("odsp-next/controls/operation/monitor/OperationMonitor.html",[],function(){return'<div class=OperationMonitor data-bind=preRender>\x3c!--ko ifnot: showNotifyExperiment()--\x3e\x3c!--ko if: groups().length--\x3e<div class=OperationMonitor-groups data-bind="foreach: groups"><div class=OperationMonitor-group><div class=OperationMonitor-item data-bind="class: css()">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemName data-bind="bindableHtml: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showDescription--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--/ko--\x3e\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: operations().length--\x3e<hr aria-hidden=true><div class=OperationMonitor-items data-bind="foreach: operations"><div class=OperationMonitor-item data-bind="class: css(), css: { \'OperationMonitor-item--icon\': !!iconName }">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemType data-bind="component: { name: $component.fileTypeIconTagName, params: { desiredSize: 48, iconName: iconName } }"></div><div class=OperationMonitor-itemName data-bind="text: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showViewAll--\x3e<button class=od-OperationMonitor-viewAll data-bind="click: onClickViewAll, text: viewAllText"></button>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: groups().length--\x3e<p class=od-OperationMonitor-empty data-bind="text: noOperationsText"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: hideNotifyExperimentInProgressPane--\x3e<div class=od-notify-experiment data-bind="control: notifyExperimentSpecification, visible: showNotifyExperiment()"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/operation/monitor/OperationMonitor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OperationMonitor hr{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin:8px 0 16px 0}html[dir=rtl] .OperationMonitor hr{margin:8px 0 16px 0}.OperationMonitor-group:not(:last-child){padding-bottom:32px}.OperationMonitor-items .OperationMonitor-item:not(:last-child){margin-bottom:16px}.OperationMonitor-item{padding:0 40px 0 0}html[dir=rtl] .OperationMonitor-item{padding:0 0 0 40px}.OperationMonitor-item--icon .OperationMonitor-itemType{display:block}[dir=ltr] .OperationMonitor-item--icon{padding-left:56px}[dir=rtl] .OperationMonitor-item--icon{padding-right:56px}.OperationMonitor-itemName{font-size:14px;font-weight:400;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding-top:4px;line-height:20px}.OperationMonitor-itemProgress{padding:8px 0}.OperationMonitor-itemDescription{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";font-size:11px;line-height:18px}.OperationMonitor-item--failed .OperationMonitor-itemDescription{color:#a80000;font-size:11px;word-wrap:break-word}.OperationMonitor-itemType{display:none;width:48px;height:48px;text-align:center;box-sizing:border-box;overflow:hidden;line-height:48px;margin-top:8px}html[dir=ltr] .OperationMonitor-itemType{float:left}html[dir=rtl] .OperationMonitor-itemType{float:right}[dir=ltr] .OperationMonitor-itemType{margin-left:-56px}[dir=rtl] .OperationMonitor-itemType{margin-right:-56px}.OperationMonitor-item:after{display:table;width:100%;content:'';clear:both}.OperationMonitor-itemIconActions{width:32px}html[dir=ltr] .OperationMonitor-itemIconActions{float:right}html[dir=rtl] .OperationMonitor-itemIconActions{float:left}[dir=ltr] .OperationMonitor-itemIconActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemIconActions{margin-left:-40px}.OperationMonitor-itemIconAction{width:32px;height:32px;text-align:center;padding-top:12px;text-align:center;box-sizing:border-box;overflow:hidden;background:0 0;border:0;cursor:pointer}.OperationMonitor-itemIconAction .ms-Icon{-ms-transform:translate(0,-50%);transform:translate(0,-50%);display:block;font-size:14px}.OperationMonitor-itemIconAction.cancel{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OperationMonitor-itemButtonActions{width:218px}html[dir=ltr] .OperationMonitor-itemButtonActions{clear:right}html[dir=rtl] .OperationMonitor-itemButtonActions{clear:left}[dir=ltr] .OperationMonitor-itemButtonActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemButtonActions{margin-left:-40px}.OperationMonitor-itemButtonAction.od-Button{margin-top:6px}.OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}html[dir=rtl] .OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}.OperationMonitor-itemButtonAction.od-Button .od-Button-label{font-size:12px}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-left:0}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-right:0}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-right:6px}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-left:6px}.od-OperationMonitor-viewAll{padding:0;border:none;margin-top:16px;cursor:pointer;background:0 0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-OperationMonitor-empty{font-size:14px;font-weight:400}.AnchorOverlay .OperationMonitor{max-width:400px;padding:10px}.ms-Callout .OperationMonitor{max-width:400px;padding:10px}"}])});define("odsp-next/actions/showOperations/ShowOperationsExecutor.html",[],function(){return"\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: panelTitle\r\n }\r\n}--\x3e\x3c!--ko control: operationMonitorSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/actions/showPermissions/ShowPermissionsExecutor",["require","exports","./ShowPermissionsExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowPermissionsExecutor.html","./ShowPermissionsExecutor.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-show-permissions-panel-executor",template:e("./ShowPermissionsExecutor.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/actions/showPermissions/ShowPermissionsExecutorViewModel",["require","exports","tslib","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../base/ControlExecutorViewModel","../../controls/dialogHost/DialogHost","../../controls/fileNameWithIcon/FileNameWithIcon","../../resources/ProviderResourceKeys","../../providers/dialog/DialogProvider","../../bindings/html/BindableHtmlBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../controls/personaTile/PersonaTile","../../controls/overlays/panel/PanelOverlay","../../controls/infoPane/InfoPane.resx","../../controls/infoPane/sections/sharing/SharingSectionHelper","../../controls/sharing/sharingLink/SharingLink","../../providers/item/ItemProvider","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","./ShowPermissionsExecutorCommandSet","../../utilities/features/Features","../../controls/commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../bindings/react/ReactBinding","../../controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage","../../controls/sharing/share/react/Share","@ms/odsp-shared-sharing/lib/Share"],function(e,t,i,r,a,o,n,s,l,d,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P,w,C,I,T,D,L,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=g.strings,A=function(o){i.__extends(e,o);function e(e){var r=o.call(this,e)||this;r.malwareDetectedMessageComponent=D.malwareDetectedMessage;r.addBindingHandlers({bindableHtml:c.default,keyboard:p.default,control:I.default,selection:u.default,react:T.default});r.panelOverlayTagName=m.default.tagName;r.dialogHostTagName=n.default.tagName;r.personaTileTagName=h.default.tagName;r.sharingLinkTagName=b.default.tagName;r.permissionsPanelName=M.sharingPermissionsPanelName;r.FileNameWithIconTagname=s.default.tagName;r.addPeopleText=M.addPeople;r.advancedText=M.advanced;r.stopSharingText=M.stopSharing;r.personaListScreenReaderText=M.personaListScreenReaderText;var t=e.item,i=e.engagementSource;r.item=r.resources.consume(y.resourceKey).getItemSync({parentKey:t.key}).item;r.isLoading=r.createObservable(!1);r.hasFocus=!1;r.resources.bind(d.resourceKey);r.engagementSource=i;r.commandBarSpecification=I.toSpecification(C.resourceKey,{commandSet:new(r.managed(P.default))({engagementSource:r.engagementSource,item:r.item})});r._sharingSectionHelper=new(r.managed(f.default))({item:r.item});r.updateComplete=r._sharingSectionHelper.updateComplete;r.readPermissionsUpdated=r._sharingSectionHelper.readPermissionsUpdated;r._initializeUpdateText();r.links=r._sharingSectionHelper.links;r.personaTileCollection=r._sharingSectionHelper.personaTileCollection;r.scopes=r._sharingSectionHelper.scopes;r.createComputed(r._permissionsChanged);r.canUnshare=r.createPureComputed(function(){return!r._sharingSectionHelper.privateDescription()&&r._sharingSectionHelper.canUnshare()});r.hasSettings=r._sharingSectionHelper.hasSettings;r.isLoading=r._sharingSectionHelper.isLoading;r.advancedUrl=r._sharingSectionHelper.advancedUrl;r.isShareLinkVisible=r._sharingSectionHelper.isShareLinkVisible;r.hasFocus=r._sharingSectionHelper.hasFocus||!1;r.canManagePermissions=r._sharingSectionHelper.canManagePermissions;r.isSharedGlyphFeatureOn=w.isFeatureEnabled(w.EnableFolderShareAccessHint);r.isManageAccessInReactEnabled=w.isFeatureEnabled(w.EnableManageAccessInReact);r.isItemMalwareDetected=r.createPureComputed(r._computeIsItemMalwareDetected);r._storageOptionsProvider=r.resources.consume(l.storageOptions.optional);r.isPremium=r.createPureComputed(r._computeIsPremium);r.personaListTabIndex=r.createPureComputed(function(){for(var e=!1,t=0,i=r.keyNav.focusableTiles();t<i.length;t++){var o=i[t];e=e||o.focused()}return e});r.virtualParentElement=e.event?r._getVirtualParent(e.event.target):void 0;r.shareComponent=L.default;r.shareComponentProps=r.createPureComputed(r._computeShareComponentProps);return r}e.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing(this.onClosePanel.bind(this))};e.prototype.onClosePanel=function(){this.action.complete()};e.prototype.onPermissionsPanelShareClick=function(){this._sharingSectionHelper.onShareClick()};e.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};e.prototype.onAdvancedClick=function(){this.resources.consume(r.resourceKey).logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};e.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};e.prototype._permissionsChanged=function(){this.keyNav=this._sharingSectionHelper.keyNav;this.fileItem=this._sharingSectionHelper.fileItem};e.prototype._initializeUpdateText=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};e.prototype._computeIsPremium=function(){if(this._storageOptionsProvider.isReady())return this._storageOptionsProvider.hasOffice.peek()};e.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};e.prototype._computeIsItemMalwareDetected=function(){var e=this.item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};e.prototype._computeShareComponentProps=function(){var e=this.resources.consume(v.resourceKey),t=this.resources.consume(x.resourceKey),i=this.resources.consume(_.resourceKey),o=this.resources.consume(S.resourceKey),r=this.resources.consume(k.resourceKey),n=this.resources.consume(a.actionMap);if(this.item()){return{actionMap:n,copyLinkShortcut:!1,item:this.item(),peoplePickerProvider:e,graphPeoplePickerHelper:t,resources:this.resources,sharingInformation:null,sharingProvider:i,suiteNavProvider:o,policyTipProvider:r,maxHeight:void 0,defaultRecipients:[],mode:E.Mode.manageAccess,noMaxHeightRestriction:!0}}};return e}(o.default);t.default=A});define("odsp-next/controls/personaTile/PersonaTile",["require","exports","./PersonaTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PersonaTile.html","./PersonaTile.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-persona-tile",template:e("./PersonaTile.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/personaTile/PersonaTileViewModel",["require","exports","tslib","../persona/Persona.resx","../persona/Persona","../../bindings/scrollIntoView/ScrollIntoViewBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.personaTagName=n.default.tagName;t.addBindingHandlers({scrollIntoView:a.default});var i=e.tile;t.tile=i;t.tile.personaParams.disableTab=!0;t.tile.personaParams.canManagePermissions=e.canManagePermissions;t.disableTab=e.disableTab;t._person=t.tile.personaParams.person.peek();t.ariaLabel=t.createComputed(t._computeAriaLabel);return t}e.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",i=this.tile.personaParams.canManagePermissions?r.strings.EnterKeyInstruction:"";if(0===e)t=r.strings.Owner;else if(2===e){t=r.strings.Edit;t+=i}else if(1===e){t=r.strings.View;t+=i}return this._person.name+" "+t};return e}(o.default);t.default=s});define("odsp-next/controls/personaTile/PersonaTile.html",[],function(){return"<div class=od-PersonaTile role=treeitem data-bind=\"attr: { tabindex: (tile.index === 0) && !(disableTab === true) ? 0 : -1, 'aria-label': ariaLabel }, hasFocus: tile.focused, scrollIntoView: { isSelected: tile.focused }\"><div class=od-PersonaTile-Persona data-bind=\"attr: { 'aria-hidden': true }, component: { name: personaTagName, params: tile.personaParams }\"></div></div>"});define("odsp-next/controls/personaTile/PersonaTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PersonaTile:focus{border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}"}])});define("odsp-next/controls/infoPane/sections/sharing/SharingSectionHelper",["require","exports","tslib","../../../../providers/engagement/Engagement","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features","../../InfoPane.resx","../../../../providers/sharing/SharingProvider","knockout","@ms/odsp-utilities/lib/async/Promise","../../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/utilities/path/Path","../../../../models/item/ItemType","../../../confirmation/Confirmation","../../../../utilities/icons/Icon","../../../../controls/itemLink/ItemLink","../../../../dataSources/url/QueryType","./SharingSectionKeyboardNav","../../../../utilities/optimizely/ExperimentsCommon.key"],function(e,t,c,o,r,n,i,a,s,l,d,p,u,h,m,g,f,b,y,v,x,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=i.strings,k=function(i){c.__extends(e,i);function e(e){var l=i.call(this,e)||this;l.sharingApiErrorMessage=l.createObservable("");l._people=l.createObservable(Array());l.keyNav=new x.default;l.personaTileCollection=l._getPersonaTileCollection();l.keyNav.focusableTiles=l.personaTileCollection;l.isNewSharingFlowEnabled=n.isFeatureEnabled(n.SharingDialogRedux);l.isLoading=s.observable(!1);l.scopes=s.observableArray();l.links=s.observableArray();l._scopesLinks=l.observables.createArray();l.hasFocus=e.hasFocus;l.personaSize=4;l.hasSettings=s.observable(!1);l.advancedUrl=s.observable("");l.canUnshare=s.observable(!1);l.showEmailLink=s.observable(!1);l.readPermissionsUpdated=l.createObservable(!1);l.updateComplete=l.createObservable("");l.canManagePermissions=l.createObservable(!1);l.hasInheritedLink=l.createObservable(!1);var t=l.resources.consume(r.actionMap);l.privateDescription=l.createPureComputed(l._computeShareStatus);l._engagement=l.resources.consume(o.resourceKey);l._currentItemShareAction=l.isNewSharingFlowEnabled?new(l.managed(t.ShareByLinkAction)):new(l.managed(t.ShareAction));l._sharingProvider=l.resources.consume(a.resourceKey);l._item=e.item;l.isShareLinkVisible=l.createComputed(l._computeIsShareLinkVisible);l.fileItem=l._item();l.createComputed(function(){var e=l._item();l._onItemChanged(e)});l.totalNumberOfLinks=l.createPureComputed(l._computeTotalNumberOfLinks);l.statusText=l.createComputed(l._computeStatusText);l.fileName=l.createObservable("");l.mailto=l.createComputed(function(){if(!l.hasSettings())return"";for(var e,t="mailto:",i=[],o=0,r=l.scopes();o<r.length;o++)for(var n=0,a=r[o].people;n<a.length;n++){var s=a[n];s.email&&i.push(s.email)}l.showEmailLink(0<i.length&&i.length<30);t+=u.default.encodeURIComponent(i.join(";"));t+="?subject="+u.default.encodeURIComponent(l._settings.itemName);e=m.canonicalizeDecodedUrl(l._settings.itemUrl);t+="&body="+u.default.encodeURIComponent(l._normalizeUrl(e));l.fileName(l._settings.itemName);l.canManagePermissions(l._settings.canManagePermissions);l.hasInheritedLink(l._settings.hasInheritedLink);l.sharingApiErrorMessage(l._settings.sharingApiErrorMessage);return t});return l}e.prototype.dispose=function(){i.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};e.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};e.prototype.onScopeClick=function(e){this._executeShare(e);return!1};e.prototype.notifyPermissionsUpdated=function(){this.updateComplete(S.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};e.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};e.prototype.onShareClick=function(){this._executeShare(this._item.peek());return!1};e.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};e.prototype.convertPersonToPersonaTile=function(e,t,i){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:i,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};e.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};e.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};e.prototype._stopSharingConfirm=function(t){var i=this,e=this.resources.consume(d.resourceKey),o=this._engagement,r=s.observable(!0);e.requestDialog({title:S.stopSharingConfirmationTitle,size:"Medium",component:{name:f.default.tagName,params:{message:S.stopSharingConfirmationMessage}},actions:[{name:S.stopSharingConfirmationButton,execute:function(){o.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});r(!1);return i._stopSharing().then(function(e){n.isFeatureEnabled(n.SharedByMe)&&i._item.peek().queryType===v.default.SharedByMe&&t();return 2},function(e){return 3})},isDefault:!0,isAvailable:r,icon:new b.default("Save"),automationId:"UnshareConfirm"},{name:S.stopSharingCancelButton,execute:function(){o.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return l.default.wrap(3)},isDefault:!1,icon:new b.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};e.prototype._executeShare=function(t,e){void 0===e&&(e=this.resources);n.isOneDrive&&this.trackPromise(e.consumeAsync(_.resourceKey).then(function(e){e.fireShareEvent(t)}));var i=this.resources.consume(r.actionMap);(this.isNewSharingFlowEnabled?this.addDisposable(new(e.injected(i.ShareByLinkAction))):this.addDisposable(new(e.injected(i.ShareAction))({item:s.observable(t),startState:3}))).execute(null)};e.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),i="",o=this.scopes();this._hasError&&(i=this._errorText);t?i=S.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(o)||(i=e.type===g.default.Folder?S.sharingUnsharedFolderStatus:S.sharingUnsharedFileStatus);return i};e.prototype._hasNonOwnerScopes=function(e){var t=!0,i=!1;e&&0!==e.length||(t=!1);if(t)for(var o=0;o<e.length&&!i;o++)for(var r=e[o].people,n=0;n<r.length&&!i;n++){0!==r[n].sharingInfo.role&&(i=!0)}return t&&i};e.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var i=e[0].people[0];t=1===e[0].people.length&&2===i.entityType?p.format(S.sharingUnsharedOwnedByGroup,i.name):S.sharingUnsharedNotShared}}else t=S.sharingUnsharedNotShared;return t};e.prototype._areAllOwners=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];if(o.sharingInfo&&0!==o.sharingInfo.role)return!1}return!0};e.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};e.prototype._onItemChanged=function(t){var i=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(t&&t.key!==this._itemKey){this._itemKey=t.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(t){this._sharingData=this._sharingProvider.getSharingData(t);this._sharingData.getSettings().then(function(e){i._settings=e;i.advancedUrl(e.advancedUrl);i.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(e){i.isLoading(!1);i.scopes(i._processScopes(t,e))},function(e){e&&403===e.status?i._errorText=S.accessDenied:e&&e.code&&-1<e.code.indexOf("-2130575139")?i._errorText=S.noscriptErrorStatus:i._errorText=S.serverError;i._hasError=!0;i.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&i.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=t}};e.prototype._processScopes=function(e,t){var i=this,o=[];0<t.length&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var r=0;r<t.length;r++){var n=t[r];if(n&&n.people.length){var a=c.__assign({},n,{headerHtml:"",sharingPeople:[]});if(n.item&&n.item.key!==this._item.peek().key){var s;s="<span data-bind=\"component: { name: '"+y.default.tagName+"', params: { item: scope.item } }\"></span>";a.headerHtml=p.format(S.sharingScopeHeaderFormat,s)}n.people.forEach(function(e){e.sharingInfo.link&&i._scopesLinks.push(e.sharingInfo.link);a.sharingPeople.push({personInfo:e,sharingItem:n.item})});o.push(a)}}for(var l=new Array,d=0;d<o.length;d++)l=l.concat(o[d].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(l);return o};e.prototype._getPersonaTileCollection=function(){var n=this,o=this.createPureComputed(function(){for(var e={},t=0,i=n._people();t<i.length;t++){var o=i[t],r=o.personInfo;3!==r.sharingInfo.type&&(e[r.userId]=o)}return e}),e=this.observables.createArray();this.createBackgroundComputed(function(){e.splice.apply(e,[0,e.peek().length].concat(n._people().map(function(e){return e.personInfo.userId})))});return e.filter(function(e){return e in o()}).map({mappingWithDisposeCallback:function(e){var t=n.createObservable(),i=n.createComputed(function(){t(o()[e].personInfo||t.peek())});return{mappedValue:n.convertPersonToPersonaTile(t,e,o()[e].sharingItem),dispose:function(){i.dispose()}}}})};e.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return e}(h.default);t.default=k});define("@ms/odsp-datasources/lib/utilities/path/Path",["require","exports","tslib","@ms/odsp-utilities/lib/path/Path","@ms/odsp-utilities/lib/path/Path"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.getFolderNameFromPath=function(e){var t=e.lastIndexOf("/");return 0<=t?e.substring(t+1):e};t.getSharePointPath=function(e){return decodeURI(e)};t.canonicalizeUrl=function(t){var i;try{i=decodeURI(t)}catch(e){i=t}return t=i===t?o.encodePath(t,!0):t.replace("#","%23")};t.canonicalizeDecodedUrl=function(e){e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23"));return e}});define("odsp-next/controls/infoPane/sections/sharing/SharingSectionKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.keyboardOptions=[{target:null,mappings:{Enter:e.onKeyEnter}},{target:window,mappings:{}}];e.focusedTile=e.observables.create();e.focusableTiles=e.observables.createArray();return e}e.prototype.onKeyEnter=function(e,t){var i=e.keyNav.focusedTile();if(i){i.personaParams.inputEvent(t);i.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return e}(o.default);t.default=r});define("odsp-next/controls/sharing/sharingLink/SharingLink",["require","exports","./SharingLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingLink.html","./SharingLink.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-sharingLink",template:e("./SharingLink.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/sharing/sharingLink/SharingLinkViewModel",["require","exports","tslib","knockout","../../../providers/engagement/Engagement","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../sharingByLink/SharingByLinkStringHelper","../../../utilities/sharing/SharingHelper","../../../bindings/focus/SelectOnFocusBinding","../../../bindings/tooltip/TooltipBinding","../sharedWith/SharedWith.resx","../../infoPane/InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../persona/Persona","../../overlays/panel/PanelOverlay","../editLink/EditLink.resx","../editLink/EditLink","../../../bindings/react/ReactBinding","office-ui-fabric-react/lib/Icon","../../../models/item/ItemHelper","../../../utilities/features/Features"],function(e,t,i,a,s,l,d,o,r,c,p,u,h,m,g,f,n,b,y,v,x,_,S,k,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.passwordProtectedLinkIndicatorLabel=v.strings.passwordProtectedLinkIndicatorAriaLabel;t._engagement=t.resources.consume(s.resourceKey);t.link=e.link;var i=!e.isShareLinkVisible||e.isShareLinkVisible,o=6===t.link.kind?t._dedupeLinkMembers(t.link.linkInvitees.concat(t.link.linkMembers)):t.link.linkMembers;t.totalLinkMembers=t.createObservable(o);t._extraMembersCount=t.createPureComputed(t._getExtraMembers);t.extraMembersText=t.createPureComputed(t._getExtraMemberText);t.briefLinkMembers=t.createPureComputed(t._getBriefLinkMembers);t.extraLinkMembers=t.createPureComputed(t._getExtraLinkMembers);t.extraMembersName=t.createPureComputed(t._getExtraMembersName);t.showTotal=t.createObservable(!1);t.personaTagName=b.default.tagName;t.personaSize=7;t.isLinkVisible=10!==t.link.type&&i;t._onLinkRemoved=e.onLinkRemoved;t.isEditable=e.isEditable||!1;t.arePasswordLinksEnabled=P.isFeatureEnabled(P.EnablePasswordProtectedLinks);t.isPasswordProtectedLink=t.link&&t.link.hasPassword;t.panelOverlayTagName=y.default.tagName;t.editLinkTagName=x.default.tagName;t.editLinkPanelTitle=v.strings.editLinkPanelTitle;t.editLinkParams={onClose:t.onClosePanel.bind(t),onLinkRemoved:t._onLinkRemoved,sharingLink:t.link};t.showEditLinkPanel=t.createObservable(!1);t._sharingProvider=t.resources.consume(l.resourceKey);t.disableLinkText=v.strings.removeLinkButtonText;t.shareableLinkText=m.strings.ShareableLink;t.isInheritedText=t.link.isInherited?m.strings.InheritedText:"";t.sharingHintText=a.observable("");var r=t.resources.consume(d.resourceKey.optional);r&&r.loadData().then(function(e){t.sharingHintText(c.getLinkHintText(t.link,e.CompanyDisplayName))});t.canManageLinks=a.observable(!1);t._sharingProvider.getSharingData(t.link.item).getSettings().then(function(e){P.isFeatureEnabled(P.EnableLinkLevelManageAccess)?t.canManageLinks(t.link.linkMembers&&!t.link.isInherited&&!k.hasAutoAlbumTag(t.link.item)):t.canManageLinks(e.canManageLinks&&!t.link.isInherited&&!k.hasAutoAlbumTag(t.link.item))});t.addBindingHandlers({tooltip:h.default,selectOnFocus:u.default,react:_.default});t.iconComponent=S.Icon;t.iconComponentProps=t._getLinkIconProps(t.link);return t}e.prototype.logCopy=function(){this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0});return!0};e.prototype.removeSharingLink=function(){var t=this,e=this.resources.consume(r.resourceKey);p.disableLinkConfirm(function(){t._engagement.logData({name:"Disable "+t.link.tag+" Link.SharingLink.Click",isIntentional:!0});var e={link:t.link,type:t.link.type,role:t.link.role,create:!1};return t._sharingProvider.manageSharingLinks([t.link.item],e).then(function(e){t._onLinkRemoved&&t._onLinkRemoved();return o.default.wrap(!0)},function(e){return!1})},function(e){t.isReady=e},e,"SharingLink")};e.prototype.onSharingHintClick=function(){if(this.isEditable){this._engagement.logData({name:this.link.tag+"Link.SharingLink.EditPermissions",isIntentional:!0});this.showEditLinkPanel(!0)}};e.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)};e.prototype.showTotalLinkMembers=function(){this.showTotal(!0)};e.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)};e.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return 0<e?e+1:0};e.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();if(t){99<t&&(e=g.strings.sharingExtraNumberOverflow);e=f.format(g.strings.sharingExtraNumberText,t)}return e};e.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e};e.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]};e.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(m.strings.NameSeparator)};e.prototype._dedupeLinkMembers=function(e){for(var t=[],i=[],o=0,r=e;o<r.length;o++){var n=r[o],a=n.email;if(!t[a]){t[a]=!0;i.push(n)}}return i};e.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=2===e.audience||5===t||4===t;this.isCSL=1===e.audience||3===t||2===t;this.isPSL=0===e.audience||4===e.audience;this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL;var i="Link";this.isAnonymousLink?i="Globe":this.isCSL?i="Work":this.isPSL&&(i="PeopleAdd");return{iconName:i}};return e}(n.default);t.default=w});define("odsp-next/controls/sharing/sharingByLink/SharingByLinkStringHelper",["require","exports","./SharingByLink.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLinkHintText=function(e,t,i,o){if(null===e)return"";if(6===e.kind){if(e.blockDownload){if(2===e.audience)return e.expiration?l.format(e.hasPassword?s.strings.AnonymousViewOnlyWithExpiryAndPassword:s.strings.AnonymousViewOnlyWithExpiry,new Date(e.expiration).toLocaleDateString()):e.hasPassword?s.strings.AnonymousViewOnlyWithPassword:s.strings.AnonymousViewOnlyText;if(1===e.audience)return l.format(s.strings.OrganizationViewOnly,t);if(4===e.audience)return s.strings.SpecificPeopleViewOnly}if(2!==e.audience)return 2===e.role?s.strings.pslEditLabel:6===e.role?s.strings.pslReviewLabel:1===e.role?s.strings.pslViewLabel:s.strings.peopleSharingLinkLabel;if(e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return c(6,new Date(e.expiration));if(1===e.role||5===e.type)return c(5,new Date(e.expiration))}else if(!e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return s.strings.AnonymousPasswordEditText;if(1===e.role||5===e.type)return s.strings.AnonymousPasswordViewText}else if(e.expiration&&!e.hasPassword){if(2===e.role||6===e.type)return d(6,new Date(e.expiration));if(1===e.role||5===e.type)return d(5,new Date(e.expiration))}else{if(2===e.role||6===e.type)return s.strings.AnonymousEditText;if(1===e.role||5===e.type)return s.strings.AnonymousViewText}}if(8===e.type&&i&&0<i.length&&o&&1===o){for(var r=i[0].sharingInfo.role,n=1;n<i.length;n++)if(r!==i[n].sharingInfo.role){r=5;break}return 1===i.length?2===r?l.format(s.strings.InvitedUsersOneEditLinkText,i[0].name):1===r?l.format(s.strings.InvitedUsersOneViewLinkText,i[0].name):l.format(s.strings.InvitedUsersOneAccessLinkText,i[0].name):2===i.length?2===r?l.format(s.strings.InvitedUsersTwoEditLinkText,i[0].name,i[1].name):1===r?l.format(s.strings.InvitedUsersTwoViewLinkText,i[0].name,i[1].name):l.format(s.strings.InvitedUsersTwoAccessLinkText,i[0].name,i[1].name):3===i.length?2===r?l.format(s.strings.InvitedUsersThreeEditLinkText,i[0].name,i[1].name):1===r?l.format(s.strings.InvitedUsersThreeViewLinkText,i[0].name,i[1].name):l.format(s.strings.InvitedUsersThreeAccessLinkText,i[0].name,i[1].name):2===r?l.format(s.strings.InvitedUsersThreePlusEditLinkText,i[0].name,i[1].name,i.length-2):1===r?l.format(s.strings.InvitedUsersThreePlusViewLinkText,i[0].name,i[1].name,i.length-2):l.format(s.strings.InvitedUsersThreePlusAccessLinkText,i[0].name,i[1].name,i.length-2)}var a=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return s.strings.AnonymousViewText;switch(e.type){case 9:return 2===e.role?t?l.format(s.strings.OrganizationEditText,t):s.strings.NoNameOrganizationEditText:t?l.format(s.strings.OrganizationViewText,t):s.strings.NoNameOrganizationViewText;case 8:return 2===o?2===e.role?s.strings.ToLineEditText:s.strings.ToLineViewText:s.strings.DirectLinkText;case 6:return e.supportsExpiration&&a?d(6,new Date(e.expiration)):s.strings.AnonymousEditText;case 5:return e.supportsExpiration&&a?d(5,new Date(e.expiration)):s.strings.AnonymousViewText;case 3:return s.strings.AnonymousEmbedText;case 4:return l.format(s.strings.appText,e.name);case 7:return s.strings.AnonymousSurveyText;case 10:return s.strings.OneNoteSharingText;default:return""}};t.getWhoCanAccessLinkOptions=function(e,t,i){var o=[];if(1===i||2===i){e.anonymousLinksEnabled&&e.canManageLinks&&o.push({text:s.strings.AnonymousOptionText,type:6});e.organizationLinksEnabled&&e.canManageLinks&&(t?o.push({text:l.format(s.strings.NamedOrganizationOptionText,t),type:9}):o.push({text:s.strings.UnnamedOrganizationOptionText,type:9}))}1===i?o.push({text:s.strings.SpecificPeopleOptionText,type:8}):o.push({text:s.strings.ToLineOptionText,type:8});return o};t.getSharingInfoText=function(e){return 0===e.length?null:1===e.length?l.format(s.strings.PermissionsInfoOneAccessLinkText,e[0].name):2===e.length?l.format(s.strings.PermissionsInfoTwoAccessLinkText,e[0].name,e[1].name):3===e.length?l.format(s.strings.PermissionsInfoThreeAccessLinkText,e[0].name,e[1].name):l.format(s.strings.PermissionsInfoThreePlusAccessLinkText,e[0].name,e[1].name,e.length-2)};function d(e,t){var i=new Date(t).toLocaleDateString(),o=t.getTime()<Date.now();return 6===e?l.format(o?s.strings.AnonymousEditExpiredText:s.strings.AnonymousEditExpiryText,i):5===e?l.format(o?s.strings.AnonymousViewExpiredText:s.strings.AnonymousViewExpiryText,i):""}function c(e,t){var i=new Date(t).toLocaleDateString(),o=t.getTime()<Date.now();return 6===e?l.format(o?s.strings.AnonymousPasswordEditExpiredText:s.strings.AnonymousPasswordEditExpiryText,i):5===e?l.format(o?s.strings.AnonymousPasswordViewExpiredText:s.strings.AnonymousPasswordViewExpiryText,i):""}});define("odsp-next/controls/sharing/editLink/EditLink",["require","exports","./EditLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./EditLink.html","./EditLink.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-editLink",template:e("./EditLink.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/sharing/editLink/EditLinkViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../providers/item/ItemProvider","./EditLink.resx","../../../controls/sharing/sharingByLink/SharingByLink.resx","../../../utilities/sharing/SharingHelper","../../../providers/sharing/SharingProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features"],function(e,t,i,a,s,l,d,o,c,r,p,u,h,n,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.setPasswordAriaLabel=l.strings.setPasswordAriaLabel;var i=e.onClose,o=e.onLinkRemoved,r=e.sharingLink;t._onClose=i;t._onLinkRemoved=o;t._sharingLink=r;t.addBindingHandlers({selectOnFocus:u.default});t._itemProvider=t.resources.consume(s.resourceKey);t._sharingProvider=t.resources.consume(c.resourceKey);t._engagement=t.resources.consume(a.resourceKey);t._sharingLinkExpirationHelper=new(t.managed(h.default));t.cancelButtonText=l.strings.cancelButtonText;t.createBackgroundComputed(t._computeValidInput);t.invalidPasswordText=d.strings.invalidPasswordError;t.linkExpirationInDays=t.createObservable(t._getDefaultLinkExpirationInDays(t._sharingLink.expiration));t.linkExpiresChecked=t.createObservable(!!t._sharingLink.expiration);t.linkExpiresInputLabel=t.createPureComputed(t._computeLinkExpiresInputLabel);t.linkExpiresText=l.strings.setExpirationLabel;t.passwordChanged=t.createObservable(!1);t.passwordValue=t.createObservable("");t.updateButtonText=l.strings.updateButtonText;t.setPasswordPermissionsWarning=d.strings.SetPasswordPermissionsWarning;t.removeLinkButtonText=l.strings.removeLinkButtonText;t.arePasswordLinksEnabled=m.isFeatureEnabled(m.EnablePasswordProtectedLinks);t.isSetPasswordChecked=t.createObservable(!!t._sharingLink.hasPassword);t.setPasswordLabel=l.strings.setPasswordLabel;t.arePasswordLinksEnabled&&t._onSetPasswordChecked();t.isPasswordInvalid=t.createComputed(t._computeIsPasswordInvalid);t.isUpdateButtonDisabled=t.createComputed(t._computeIsUpdateButtonDisabled);return t}e.prototype.onUpdateClick=function(){var t=this;this._logEngagementEvent("Update");var e=this._sharingLink,i=[e.item],o=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,r={type:e.type,role:e.role,create:!0,expiration:o};if(this.arePasswordLinksEnabled){var n=this.isSetPasswordChecked.peek(),a=n&&this.passwordChanged.peek(),s=!n&&e.hasPassword;a&&(r.password=this.passwordValue.peek());s&&(r.password="")}this._sharingProvider.manageSharingLinks(i,r).then(function(e){t._itemProvider.invalidateItem(i[0].key,{triggerFetch:!0});t._onClose()})};e.prototype.changePasswordInput=function(){this.passwordChanged(!0);this.passwordValue("")};e.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel");this._onClose()};e.prototype.onRemoveLinkClicked=function(){var t=this,i=this._sharingLink,e=this.resources.consume(p.resourceKey);this._logEngagementEvent("RemoveLink");o.disableLinkConfirm(function(){t._engagement.logData({name:"Disable "+i.tag+" Link.SharingLink.Click",isIntentional:!0});var e={link:i,type:i.type,role:i.role,create:!1};return t._sharingProvider.manageSharingLinks([i.item],e).then(function(e){t._onLinkRemoved&&t._onLinkRemoved();return r.default.wrap(!0)},function(e){return!1})},function(e){},e,"EditLink")};e.prototype._onSetPasswordChecked=function(){if(this._sharingLink&&this._sharingLink.hasPassword){this.passwordValue("        ")}};e.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),i=t.toString();if(t<=0&&t>h.MAX_EXPIRATION){i="";this.linkExpiresChecked(!1)}this.linkExpirationInDays(i)};e.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&0<e.length&&0===e.trim().length};e.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),i=this.isPasswordInvalid();if(!e&&!t)return!1;var o=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(o)!==h.LinkExpirationValidity.Valid||i};e.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};e.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt(h.DEFAULT_EXPIRATION,10);e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e)));return t.toString()};e.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"EditLinkPanel."+e+".Click",isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})};return e}(n.default);t.default=g});define("odsp-next/dataSources/sharing/odc/SharingLinkExpirationHelper",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/sharing/sharingByLink/SharingByLink.resx"],function(e,o,i,r,t,n,a){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.DEFAULT_EXPIRATION="30";o.MAX_EXPIRATION=1825;var s;!function(e){e[e.Invalid=0]="Invalid";e[e.Empty=1]="Empty";e[e.Valid=2]="Valid"}(s=o.LinkExpirationValidity||(o.LinkExpirationValidity={}));var l=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.computeExpirationValidity=function(e){if(""===e)return s.Empty;var t=e.match(/^-?[0-9]+/);if(t&&t[0]!==e||!t)return s.Invalid;var i=parseInt(e,10);return i<=0||i>o.MAX_EXPIRATION?s.Invalid:s.Valid};e.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===s.Valid){var t=parseInt(e,10),i=new Date;i.setDate(i.getDate()+t);return n.format(a.strings.daysWithDate,r.getShortDisplayDate(i))}return a.strings.days};e.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)};e.prototype.calculateLinkExpiration=function(e){if(0<e&&e<=o.MAX_EXPIRATION){var t=new Date;t.setDate(t.getDate()+e);return t.toISOString()}return null};return e}(t.default);o.default=l});define("odsp-next/controls/sharing/editLink/EditLink.html",[],function(){return'<div class=od-EditLink><div class="ms-CheckBox od-EditLink-linkExpiresCheckbox"><input type=checkbox id=od-EditLink-linkExpires data-bind="checked: linkExpiresChecked" class=ms-CheckBox-input> <label for=od-EditLink-linkExpires class=ms-CheckBox-field data-bind="css: {\'is-checked\': linkExpiresChecked}"><span data-bind="text: linkExpiresText, automation: \'linkExpiresText\'" class=ms-Label></span></label>\x3c!--ko if: linkExpiresChecked()--\x3e<div class=od-EditLink-linkExpiresInputDiv><input id=od-EditLink-linkExpiresInput class=od-EditLink-linkExpiresInput type=number data-bind="value: linkExpirationInDays, selectOnFocus: { isPermanent: false, isReentrant: true }"> <label for=od-EditLink-linkExpiresInput><span class=od-EditLink-linkExpiresInputLabel data-bind="text: linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: arePasswordLinksEnabled--\x3e<div class="ms-CheckBox od-EditLink-setPasswordCheckbox"><input type=checkbox id=od-EditLink-setPassword data-bind="checked: isSetPasswordChecked" class=ms-CheckBox-input> <label for=od-EditLink-setPassword class=ms-CheckBox-field data-bind="css: {\'is-checked\': isSetPasswordChecked}"><span data-bind="text: setPasswordLabel, automation: \'setPasswordLabel\'" class=ms-Label></span></label>\x3c!--ko if: isSetPasswordChecked()--\x3e<div class=od-EditLink-setPasswordInputContainer><input id=od-EditLink-setPasswordInput class=od-EditLink-setPasswordInput type=password data-bind="attr: { \'aria-label\': setPasswordAriaLabel, \'aria-invalid\': isPasswordInvalid() }, value: passwordValue, valueUpdate: \'input\', click: changePasswordInput, selectOnFocus: { isPermanent: false, isReentrant: true }, css: { \'od-EditLink-invalidPasswordOutline\': isPasswordInvalid() }"></div>\x3c!--ko if: isPasswordInvalid()--\x3e<div class=od-EditLink-invalidPasswordError role=alert data-bind="text: invalidPasswordText"></div>\x3c!--/ko--\x3e<div class=od-EditLink-passwordProtectedLinkInformationArea><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon: true"></i><div class=od-EditLink-passwordProtectedLinkInformationTextArea data-bind="text: setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-EditLink-removeLinkHolder><i class="ms-Icon ms-Icon--Delete" data-bind="icon: true"></i> <button class=od-EditLink-removeLinkText data-bind="click: onRemoveLinkClicked, text: removeLinkButtonText"></button></div><div class=od-EditLink-buttons><button class="od-Button od-Button--primary" role=button data-bind="click: onUpdateClick, disable: isUpdateButtonDisabled"><span class=od-Button-label data-bind="text: updateButtonText"></span></button> <button class=od-Button role=button data-bind="click: onCancelClick"><span class=od-Button-label data-bind="text: cancelButtonText"></span></button></div></div>'});define("odsp-next/controls/sharing/editLink/EditLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-EditLink-invalidPasswordError{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-removeLinkHolder{-ms-flex-align:center;align-items:center;color:#a80000;display:-ms-flexbox;display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-size:14px;font-weight:400;background:0 0;border:none;color:#a80000;cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";display:-ms-flexbox;display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"}])});define("odsp-next/controls/sharing/sharingLink/SharingLink.html",[],function(){return'<div class=od-SharingLink role=group data-bind="attr: { \'aria-label\': sharingHintText }"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class=od-SharingLink-iconBackground data-bind="css: { \'od-SharingLink-anonymous-bg\': isAnonymousLink, \'od-SharingLink-csl-bg\': isCSL, \'od-SharingLink-psl-bg\': isPSL, \'od-SharingLink-generic-bg\': isGeneric }"></div><div class=od-SharingLink-icon role=presentation data-bind="react: { componentType: iconComponent, props: iconComponentProps }, css: { \'od-SharingLink-anonymous\': isAnonymousLink, \'od-SharingLink-csl\': isCSL, \'od-SharingLink-psl\': isPSL, \'od-SharingLink-generic\': isGeneric }"></div></div><div class=od-SharingLink-cell><div class="od-Sharinglink-table od-Sharinglink-url"><div class=od-Sharinglink-row><div class=od-SharingLink-cell>\x3c!--ko if: isLinkVisible--\x3e<input class="od-SharingLink-input od-TextField-field" type=text readonly data-bind="value: link.url, selectOnFocus: { isPermanent: true }, attr: { \'title\': shareableLinkText, \'aria-label\': shareableLinkText }, event: { copy: $component.logCopy.bind($component) }">\x3c!--/ko--\x3e\x3c!--ko ifnot: isLinkVisible--\x3e<span class=od-SharingLink-linkSwitcher data-bind="text: sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if: canManageLinks--\x3e<div class=od-SharingLink-cell><button class=od-SharingLink-removeLinkButton data-bind="css: { \'od-SharingLink-removeLinkButton-leftMargin\': isLinkVisible }, click: removeSharingLink, attr: { \'title\': disableLinkText, \'aria-label\': disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: isLinkVisible--\x3e<div class=od-SharingLink-linkSwitcher>\x3c!--ko if: isEditable--\x3e<div class=od-SharingLink-sharingHintContainer><button class=od-SharingLink-sharingHint data-bind="click: onSharingHintClick">\x3c!--ko text: sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon: true"></i></button>\x3c!--ko if: arePasswordLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role=img data-bind="icon: true, attr: {\'aria-label\': passwordProtectedLinkIndicatorLabel }"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !isEditable--\x3e<div class=od-SharingLink-sharingHint data-bind="text: sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: link.linkMembers--\x3e<div class=od-SharingLink-linkUser><div class=od-Sharing-briefLinkMembers>\x3c!--ko foreach: briefLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: extraMembersText()--\x3e\x3c!--ko if: !showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role=button data-bind="icon: true, click: showTotalLinkMembers, tooltip: { content: extraMembersName }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role=button data-bind="icon: true, click: hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: showTotal()--\x3e<div class=od-Sharing-extraLinkMembers>\x3c!--ko foreach: extraLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showEditLinkPanel--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: editLinkPanelTitle\r\n }\r\n }--\x3e\x3c!--ko component: {\r\n name: editLinkTagName,\r\n params: editLinkParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/sharing/sharingLink/SharingLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-SharingLink{margin-bottom:10px;display:-ms-flexbox;display:flex}.od-SharingLink-cell{display:table-cell;max-width:200px}.od-SharingLink-iconCell{vertical-align:top;width:48px;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:10px}[dir=rtl] .od-SharingLink-iconCell{padding-left:10px}.od-SharingLink-icon{display:inline-block;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:28px;min-width:48px;height:48px;text-align:center;line-height:48px;position:absolute;background-color:transparent;border-width:1px;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%;min-width:48px;height:48px;border-style:solid;border-width:1px;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:10px}[dir=rtl] .od-SharingLink-iconBackground{margin-left:10px}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:table-row}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingLink-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:4px}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:4px}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:2px 4px}.od-SharingLink-linkMember .ms-Icon{font-size:12px;width:24px;text-align:center;line-height:24px}.od-SharingLink-linkUser{width:200px}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:24px;height:24px;border-radius:50%;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:inline-block;margin:0 4px;line-height:24px}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:24px;display:table-cell;width:24px;text-align:center}.od-SharingLink-chevron{font-size:11px}[dir=ltr] .od-SharingLink-chevron{margin-left:4px}[dir=rtl] .od-SharingLink-chevron{margin-right:4px}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-size:12px;font-weight:400}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:#107c10}.od-SharingLink-csl{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-SharingLink-psl{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:#107c10;border-color:#107c10;opacity:.1}.od-SharingLink-csl-bg{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .od-SharingLink-lock{margin-left:12px}html[dir=rtl] .od-SharingLink-lock{margin-right:12px}.od-SharingLink-sharingHintContainer{display:-ms-flexbox;display:flex}"}])});define("odsp-next/actions/showPermissions/ShowPermissionsExecutorCommandSet",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../utilities/icons/Icon","../../resources/ControlResourceKeys","../../controls/commands/Command","../../controls/commands/Commands.resx","../../controls/sharing/share/commands/ShareCommandBuilder"],function(e,t,o,r,i,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.commands=r.observableArray();t._actionMap=t.resources.consume(s.actionMap);t.engagementSource=e.engagementSource;t.commands=r.observableArray([new(t.managed(c.default))({renderLabel:2,mode:2,item:e.item}).command]);n.isFeatureEnabled(n.AddPeopleReact)?t.commands.push(new(t.managed(c.default))({renderLabel:2,mode:4,item:e.item}).command):t.commands.push(new(t.managed(l.CommandViewModel))({text:d.strings.grantAccess,icon:new a.default("PlayerSettings"),renderLabel:2,tooltip:d.strings.grantAccessCommandLabel,accessibleLabel:d.strings.grantAccessCommandLabel,engagementName:"GrantAccessFlowStartedFrom"+t.engagementSource,action:n.isFeatureEnabled(n.SharingDialogRedux)?new(t.managed(t._actionMap.ShareByLinkAction))({item:e.item}):new(t.managed(t._actionMap.ShareAction))({activeTab:1,item:e.item})}));return t}return e}(i.default);t.default=p});define("odsp-next/controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage",["require","exports","react","office-ui-fabric-react/lib/MessageBar","@ms/odsp-utilities/lib/string/StringHelper","../MalwareDetectedMessage.resx"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.malwareDetectedMessage=function(){var e=i.createElement("a",{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},n.strings.malwareDetectedMessageLearnMore),t=r.formatToArray(n.strings.malwareDetectedMessage,e);return i.createElement(o.MessageBar,{messageBarType:o.MessageBarType.severeWarning,isMultiline:!0},t)}});define("odsp-next/actions/showPermissions/ShowPermissionsExecutor.html",[],function(){return'\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n ariaLabel: permissionsPanelName,\r\n onClose: $component.onClosePanel.bind($component),\r\n virtualParentElement: virtualParentElement\r\n }\r\n }--\x3e\x3c!--ko if: isSharedGlyphFeatureOn--\x3e<div class="od-ShowPermissions-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div>\x3c!--/ko--\x3e<div class=od-PermissionsPanel-container data-bind="css: { \'od-PermissionsPanel-container-withCommandbar\': isSharedGlyphFeatureOn }">\x3c!--ko if: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-titleBar--react><div class="od-PermissionsPanel-fileName manageAccessInReactEnabled-fileName">\x3c!--ko component: { name: FileNameWithIconTagname, params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e</div><div class="od-PermissionsPanel-head manageAccessInReactEnabled-head" data-bind="text: permissionsPanelName"></div><div class=od-PermissionsPanel-stopSharing data-bind="visible: canUnshare"><a role=button href=javascript:; data-bind="click: stopSharing, text: stopSharingText"></a><br></div></div>\x3c!--ko if: isItemMalwareDetected--\x3e<div class=od-PermissionsPanel-malwareDetectedMessageBar--react data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-titleBar><div class=od-PermissionsPanel-head data-bind="text: permissionsPanelName"></div><div class=od-PermissionsPanel-fileName>\x3c!--ko component: { name: FileNameWithIconTagname, params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e</div><button class=od-PermissionsPanel-stopSharing data-bind="visible: canUnshare, click: stopSharing, text: stopSharingText"></button></div>\x3c!--/ko--\x3e\x3c!--ko if: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-content-React data-bind="react: { componentType: shareComponent, props: shareComponentProps }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-content><div class=od-PermissionsPanel data-bind="keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }">\x3c!--ko if: !isLoading() && isShareLinkVisible && !isSharedGlyphFeatureOn--\x3e<div class=od-PermissionsPanel-addPeople><a role=button href=# data-bind="click: onPermissionsPanelShareClick, hasFocus: hasFocus"><div class=od-PermissionsPanel-addPeople-icon><i class="ms-Icon ms-Icon--PeopleAdd" data-bind="icon: true"></i></div><span class=od-PermissionsPanel-addPeople-text data-bind="text: addPeopleText"></span></a></div>\x3c!--/ko--\x3e\x3c!--ko if: isItemMalwareDetected--\x3e<div class=od-PermissionsPanel-malwareDetectedMessageBar data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e<span role=alert class=ms-accessible data-bind="text: updateComplete, visible: readPermissionsUpdated()"></span>\x3c!--ko if: !isLoading()--\x3e<div class=od-PermissionsPanel-links data-bind="foreach: { data: links, as: \'link\' }"><div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); } } }"></div></div><div class=od-PermissionPanel-shareScope data-bind="foreach: { data: scopes, as: \'scope\' }"><div class=od-PermissionPanel-shareScopeHeader data-bind="bindableHtml: headerHtml"></div><div class=od-PermissionPanel-shareEntities data-bind="foreach: { data: people, as: \'person\' }">\x3c!--ko if: person.sharingInfo.link--\x3e<div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: person.sharingInfo.link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); }, isEditable: $component.isPremium() } }"></div>\x3c!--/ko--\x3e</div></div><div class=id-PermissionsPanel-PersonaList role=tree data-bind="attr: { \'aria-label\': personaListScreenReaderText, \'tabindex\': personaListTabIndex() ? -1 : 0 }"><div class=od-PermissionsPanel-PersonaTiles>\x3c!--ko foreach: personaTileCollection--\x3e<div class=od-PermissionsPanel-entity data-bind="component: { name: $parent.personaTileTagName, params: { canManagePermissions: $parent.canManagePermissions(), tile: $data } }"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: canManagePermissions()--\x3e<div class=od-PermissionsPanel-linksBox data-bind="if: hasSettings()"><a target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: advancedUrl(), click: onAdvancedClick"></a></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/actions/showPermissions/ShowPermissionsExecutor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PermissionsPanel-malwareDetectedMessageBar{padding:0 40px 20px 0}html[dir=rtl] .od-PermissionsPanel-malwareDetectedMessageBar{padding:0 0 20px 40px}.od-PermissionsPanel-malwareDetectedMessageBar--react{padding-bottom:20px}.od-PermissionsPanel-titleBar--react{padding-top:10px;padding-bottom:32px}[dir=ltr] .od-PermissionsPanel-titleBar--react{padding-left:20px}[dir=rtl] .od-PermissionsPanel-titleBar--react{padding-right:20px}.manageAccessInReactEnabled-fileName{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.manageAccessInReactEnabled-head{font-weight:300;padding-top:15px;padding-bottom:6px}.od-PermissionsPanel-content-React{height:calc(100% - 145px);overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel-content-React .od-Share{width:340px}"}])});define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor",["require","exports","./ShowReactVersionHistoryExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowReactVersionHistoryExecutor.html","./VersionHistory.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-show-version-history-executor",template:e("./ShowReactVersionHistoryExecutor.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../bindings/react/ReactBinding","../../bindings/html/BindableHtmlBinding","../../controls/versionHistory/VersionHistory.resx","../../controls/overlays/panel/PanelOverlay","../../providers/versionHistory/VersionHistoryProvider","../../controls/versionHistory/react/ReactVersionHistoryList"],function(e,t,i,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.addBindingHandlers({bindableHtml:a.default,react:n.default});t.panelTagName=l.default.tagName;t.panelSize="Medium";t.panelTitle=s.strings.panelName;var i=e.item,o=t.createObservable([]);t.addBindingHandlers({react:n.default});t.resources.consume(d.resourceKey).getVersionHistoryInfo(i()).then(function(e){o(e)});t.listComponent=c.default;t.listComponentProps={items:o,fileItem:i(),resources:t.resources};t.virtualParentElement=e.event?t._getVirtualParent(e.event.target):void 0;return t}e.prototype.onClosePanel=function(){this.action.complete()};e.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};return e}(o.default);t.default=r});define("odsp-next/providers/versionHistory/VersionHistoryProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._dataSource=t.dataSource}e.prototype.getVersionHistoryInfo=function(e){return this._dataSource.getVersionHistoryInfo(e)};e.prototype.restoreVersionByLabel=function(e,t){return this._dataSource.restoreVersionByLabel(e,t)};e.prototype.deleteVersionByLabel=function(e,t){return this._dataSource.deleteVersionByLabel(e,t)};e.prototype.canRestoreVersions=function(e){return this._dataSource.canRestoreVersions(e)};e.prototype.canDeleteVersions=function(e){return this._dataSource.canDeleteVersions(e)};e.prototype.showVersionLabel=function(){return this._dataSource.showVersionLabel()};return e}();t.default=r;t.resourceKey=i.createResolvedResourceKey(e("module").id,r,{dataSource:o.versionHistory})});define("odsp-next/controls/versionHistory/react/ReactVersionHistoryList",["require","exports","tslib","react","office-ui-fabric-react/lib/DetailsList","office-ui-fabric-react/lib/Fabric","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/index","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../../../resources/ControlResourceKeys","../../../providers/versionHistory/VersionHistoryProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../models/item/OneDriveItem","../VersionHistory.resx","../../commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/graft/Graft","../../list/react/detailsList/fields/UserRenderer","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,a,s,l,o,d,r,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.fileItem=e.fileItem;t.state={items:[],onItemContextMenu:null,menuProps:null};t._versionHistoryProvider=t.resources.consume(g.resourceKey);t.columns=t._getColumns();t.selectionMode=e.selectionMode;t.scope=new r.default;t.observables=t.scope.attach(new(t.resources.consume(o.observablesFactoryTypeResourceKey))({owner:t}));t._actionMap=t.resources.consume(m.actionMap);t._platform=t.resources.consume(P.platformDetection);return t}e.prototype.componentWillMount=function(){this.observables.compute(this._computeItems).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};e.prototype.render=function(){var t=this,e=this.state,i=e.items,o=e.onItemContextMenu,r=e.menuProps;return a.createElement(l.Fabric,null,a.createElement(s.DetailsList,{componentRef:function(e){return t._list=e},items:i,columns:this.columns,selectionMode:d.SelectionMode.none,onItemContextMenu:o,getRowAriaLabel:this._getAriaLabel,className:"od-versionHistoryList",ariaLabel:"List of versions, use up and down arrow keys to navigate, use the SPACE key to select within the list."}),r&&a.createElement(p.ContextualMenu,n.__assign({},r)))};e.prototype._getAriaLabel=function(e){return v.strings.columnNameNumber+" "+e.versionLabel+", "+v.strings.columnNameModifiedDate+" "+e.created.toString()+", "+v.strings.columnNameModifiedBy+" "+e.createdBy.Title+", "+v.strings.columnNameSize+" "+u.default.getDisplayString(e.size,{ignoreZero:!0})};e.prototype._reLoadPage=function(){var t=this;this._versionHistoryProvider.getVersionHistoryInfo(this.fileItem).then(function(e){t.setState({items:e})})};e.prototype._computeItems=function(){var o=this,e=this.props.items();this.setState({items:e,onItemContextMenu:function(e,t,i){o.setState({menuProps:n.__assign({target:"#more-"+e.id},o._getMenuProps(e))})}})};e.prototype._getColumns=function(){var o=this,e=[{key:"version.modifiedDate",columnActionsMode:s.ColumnActionsMode.disabled,name:v.strings.columnNameModifiedDate,ariaLabel:_.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameModifiedDate),fieldName:null,minWidth:160,maxWidth:160,onRender:function(e,t,i){return a.createElement("div",{className:"od-modifiedDateColumn"},a.createElement("a",{className:"od-modifiedDateColumn-modifiedDate","aria-label":_.format(v.strings.cellAriaLabel,v.strings.columnNameModifiedDate,h.getFriendlyDateTimeStringPast(new Date(e.created))),href:o._getOpenFileLink(e)},h.getFriendlyDateTimeStringPast(new Date(e.created))))}},{key:"version.dotdotdot",name:"",columnActionsMode:s.ColumnActionsMode.disabled,ariaLabel:_.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameDotdotdot),fieldName:null,minWidth:40,maxWidth:40,onRender:function(e,t,i){return a.createElement(c.IconButton,{id:"more-"+e.id,className:"od-FieldRenderer-dot od-modifiedDateColumn-moreButton",role:"button",ariaLabel:v.strings.buttonNameDotdotdot,iconProps:{iconName:"More"},onClick:function(){return o.setState({menuProps:n.__assign({target:"#more-"+e.id},o._getMenuProps(e))})}})}},{key:"version.modifiedBy",name:v.strings.columnNameModifiedBy,columnActionsMode:s.ColumnActionsMode.disabled,ariaLabel:_.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameModifiedBy),fieldName:null,minWidth:160,maxWidth:160,onRender:function(e,t,i){return k.userRendererByUser([{title:e.createdBy.Title,email:e.createdBy.Email,picture:void 0,sip:e.createdBy.Email}],o.resources,{text:"version.modifiedBy",isDisabled:!1,ariaLabel:_.format(v.strings.cellAriaLabel,v.strings.columnNameModifiedBy,e.createdBy.Title)},"od-modifiedByColumn")}},{key:"version.size",name:v.strings.columnNameSize,columnActionsMode:s.ColumnActionsMode.disabled,ariaLabel:_.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameSize),fieldName:null,minWidth:80,maxWidth:80,onRender:function(e,t,i){return a.createElement("div",{"data-is-focusable":"true",className:"od-fileSizeColumn","aria-label":_.format(v.strings.cellAriaLabel,v.strings.columnNameSize,u.default.getDisplayString(e.size,{ignoreZero:!0}))},e.size?u.default.getDisplayString(e.size,{ignoreZero:!0}):"")}}];this._versionHistoryProvider.showVersionLabel()&&e.unshift({key:"version.number",name:v.strings.columnNameNumber,columnActionsMode:s.ColumnActionsMode.disabled,fieldName:null,minWidth:40,maxWidth:40,ariaLabel:_.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameNumber),onRender:function(e,t,i){return a.createElement("div",{"data-is-focusable":"true",className:"od-versionNumberColumn","aria-label":_.format(v.strings.cellAriaLabel,v.strings.columnNameNumber,e.versionLabel)},e.versionLabel)}});return e};e.prototype._getOpenFileLink=function(e){var t=this.fileItem,i=new y.default(t.key);S.default(i,t);e.isCurrentVersion||S.default(i,{properties:{path:e.url}});var o=this.resources.consume(f.url),r=this.resources.consume(b.navigation),n=this._platform.isMac;return t.appMap&&!n?o.getOpenInOfficeClientUrl(i,r.viewParams):e.url};e.prototype._getMenuProps=function(e){var t=this;return{directionalHint:7,isBeakVisible:!1,items:this._getMenuItems(e),gapSpace:0,onDismiss:function(){return t.setState({menuProps:null})}}};e.prototype._getMenuItems=function(i){var o=this,e={key:"version.restore",name:v.strings.versionActionNameRestore,onClick:function(){o._versionHistoryProvider.restoreVersionByLabel(o.fileItem,i.versionLabel).then(function(e){e&&o._reLoadPage()})}},t={key:"version.open",name:v.strings.versionActionNameOpen,onClick:function(e,t){return new(o.resources.injected(o._actionMap.NavigationAction))({url:o._getOpenFileLink(i)}).execute(e)}},r={key:"version.download",name:x.strings.Download,onClick:function(e,t){return new(o.resources.injected(o._actionMap.NavigationAction))({url:o._getOpenFileLink(i)}).execute(e)}},n={key:"version.delete",name:v.strings.versionActionNameDelete,onClick:function(){o._versionHistoryProvider.deleteVersionByLabel(o.fileItem,i.versionLabel).then(function(e){e&&o._reLoadPage()})}},a=[];this._canRestoreVersion(i)&&a.push(e);this._platform.isMac?a.push(r):a.push(t);this._canDeleteVersion(i)&&a.push(n);return a};e.prototype._canDeleteVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canDeleteVersions(this.fileItem)};e.prototype._canRestoreVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canRestoreVersions(this.fileItem)};return e}(a.Component);t.ReactVersionHistoryList=i;t.default=i});define("office-ui-fabric-react/lib/DetailsList",["require","exports","tslib","./components/DetailsList/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/DetailsList/index",["require","exports","tslib","../../utilities/selection/index","../GroupedList/GroupedList.types","./DetailsList","./DetailsList.types","./DetailsRow","./DetailsRowCheck"],function(e,t,i,o,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.hidden=0]="hidden";e[e.visible=1]="visible"}(t.CollapseAllVisibility||(t.CollapseAllVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList",["require","exports","tslib","../../Utilities","./DetailsList.base","./DetailsList.styles","./DetailsList.base"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsList=o.styled(r.DetailsListBase,n.getStyles,void 0,{scope:"DetailsList"});i.__exportStar(a,t)});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.base",["require","exports","tslib","react","../../Utilities","../DetailsList/DetailsList.types","../DetailsList/DetailsHeader","../DetailsList/DetailsHeader.types","../DetailsList/DetailsRow","../../FocusZone","../../utilities/selection/index","../../utilities/dragdrop/DragDropHelper","../../GroupedList","../../List","../../utilities/decorators/withViewport","../../utilities/groupedList/GroupedListUtility","./DetailsRow.styles"],function(e,t,ie,oe,a,re,i,ne,r,ae,se,n,le,de,o,ce,pe){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var ue=a.classNamesFunction(),he=new Array(10),s=function(t){ie.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._root=a.createRef();o._header=a.createRef();o._groupedList=a.createRef();o._list=a.createRef();o._focusZone=a.createRef();o._selectionZone=a.createRef();o._onRenderRow=function(e,t){return oe.createElement(r.DetailsRow,ie.__assign({},e))};o._onRenderDetailsHeader=function(e,t){return oe.createElement(i.DetailsHeader,ie.__assign({},e))};o._onRenderDetailsFooter=function(e,t){return null};o._onRenderListCell=function(i){return function(e,t){return o._onRenderCell(i,e,t)}};o._onScroll=function(e){var t=o.props.onScroll;t&&t(e)};o._activeRows={};o._columnOverrides={};o._onColumnIsSizingChanged=o._onColumnIsSizingChanged.bind(o);o._onColumnResized=o._onColumnResized.bind(o);o._onColumnAutoResized=o._onColumnAutoResized.bind(o);o._onRowDidMount=o._onRowDidMount.bind(o);o._onRowWillUnmount=o._onRowWillUnmount.bind(o);o._onToggleCollapse=o._onToggleCollapse.bind(o);o._onActiveRowChanged=o._onActiveRowChanged.bind(o);o._onBlur=o._onBlur.bind(o);o._onHeaderKeyDown=o._onHeaderKeyDown.bind(o);o._onContentKeyDown=o._onContentKeyDown.bind(o);o._onRenderCell=o._onRenderCell.bind(o);o._onGroupExpandStateChanged=o._onGroupExpandStateChanged.bind(o);o._onColumnDragEnd=o._onColumnDragEnd.bind(o);o.state={focusedItemIndex:-1,lastWidth:0,adjustedColumns:o._getAdjustedColumns(e),isSizing:!1,isDropping:!1,isCollapsed:e.groupProps&&e.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:e.groupProps&&!e.groupProps.isAllGroupsCollapsed};o._selection=e.selection||new se.Selection({onSelectionChanged:void 0,getKey:e.getKey});o._selection.setItems(e.items,!1);o._dragDropHelper=e.dragDropEvents?new n.DragDropHelper({selection:o._selection,minimumPixelsForDrag:e.minimumPixelsForDrag}):null;o._initialFocusedIndex=e.initialFocusedIndex;return o}e.prototype.scrollToIndex=function(e,t,i){this._list.current&&this._list.current.scrollToIndex(e,t,i);this._groupedList.current&&this._groupedList.current.scrollToIndex(e,t,i)};e.prototype.focusIndex=function(e,t,i,o){void 0===t&&(t=!1);var r=this.props.items[e];if(r){this.scrollToIndex(e,i,o);var n=this._getItemKey(r,e),a=this._activeRows[n];a&&this._setFocusToRow(a,t)}};e.prototype.getStartItemIndexInView=function(){return this._list&&this._list.current?this._list.current.getStartItemIndexInView():this._groupedList&&this._groupedList.current?this._groupedList.current.getStartItemIndexInView():0};e.prototype.componentWillUnmount=function(){this.props.onScroll&&this._root.current&&this._root.current.removeEventListener("scroll",this._onScroll);this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.componentDidMount=function(){this.props.onScroll&&this._root.current&&this._root.current.addEventListener("scroll",this._onScroll)};e.prototype.componentDidUpdate=function(e,t){if(void 0!==this._initialFocusedIndex){if(n=this.props.items[this._initialFocusedIndex]){var i=this._getItemKey(n,this._initialFocusedIndex);(o=this._activeRows[i])&&this._setFocusToRowIfPending(o)}}if(this.props.items!==e.items&&0<this.props.items.length&&-1!==this.state.focusedItemIndex&&!a.elementContains(this._root.current,document.activeElement,!1)){var o,r=this.state.focusedItemIndex<this.props.items.length?this.state.focusedItemIndex:this.props.items.length-1,n=this.props.items[r];i=this._getItemKey(n,this.state.focusedItemIndex);(o=this._activeRows[i])?this._setFocusToRow(o):this._initialFocusedIndex=r}this.props.onDidUpdate&&this.props.onDidUpdate(this)};e.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.checkboxVisibility,o=t.items,r=t.setKey,n=t.selectionMode,a=t.columns,s=t.viewport,l=t.compact,d=e.setKey!==r||void 0===e.setKey,c=!1;e.layoutMode!==this.props.layoutMode&&(c=!0);if(d){this._initialFocusedIndex=e.initialFocusedIndex;this.setState({focusedItemIndex:void 0!==this._initialFocusedIndex?this._initialFocusedIndex:-1})}e.items!==o&&this._selection.setItems(e.items,d);e.checkboxVisibility===i&&e.columns===a&&e.viewport.width===s.width&&e.compact===l||(c=!0);this._adjustColumns(e,!0);e.selectionMode!==n&&(c=!0);c&&(this._pendingForceUpdate=!0)};e.prototype.componentWillUpdate=function(){this._pendingForceUpdate&&this._forceListUpdates()};e.prototype.render=function(){var e=this.props,t=e.ariaLabelForListHeader,i=e.ariaLabelForSelectAllCheckbox,o=e.ariaLabelForSelectionColumn,r=e.className,n=e.checkboxVisibility,a=e.compact,s=e.constrainMode,l=e.dragDropEvents,d=e.groups,c=e.groupProps,p=e.items,u=e.isHeaderVisible,h=e.layoutMode,m=e.onItemInvoked,g=e.onItemContextMenu,f=e.onColumnHeaderClick,b=e.onColumnHeaderContextMenu,y=e.selectionMode,v=e.selectionPreservedOnEmptyClick,x=e.selectionZoneProps,_=e.ariaLabel,S=e.ariaLabelForGrid,k=e.rowElementEventMap,P=e.shouldApplyApplicationRole,w=void 0!==P&&P,C=e.getKey,I=e.listProps,T=e.usePageCache,D=e.onShouldVirtualize,L=e.enableShimmer,E=e.viewport,M=e.minimumPixelsForDrag,A=e.getGroupHeight,F=e.styles,R=e.theme,O=this.state,N=O.adjustedColumns,B=O.isCollapsed,H=O.isSizing,V=O.isSomeGroupExpanded,z=this._selection,U=this._dragDropHelper,W=this._getGroupNestingDepth(),q=ie.__assign({renderedWindowsAhead:H?0:2,renderedWindowsBehind:H?0:2,getKey:C},I),K=ne.SelectAllVisibility.none;y===se.SelectionMode.single&&(K=ne.SelectAllVisibility.hidden);if(y===se.SelectionMode.multiple){var j=c&&c.headerProps&&c.headerProps.isCollapsedGroupSelectVisible;void 0===j&&(j=!0);K=j||!d||V?ne.SelectAllVisibility.visible:ne.SelectAllVisibility.hidden}n===re.CheckboxVisibility.hidden&&(K=ne.SelectAllVisibility.none);var G=this.props,$=G.onRenderDetailsHeader,Y=void 0===$?this._onRenderDetailsHeader:$,Z=G.onRenderDetailsFooter,Q=void 0===Z?this._onRenderDetailsFooter:Z,X=this._getDetailsFooterProps(),J=this._getColumnReorderProps(),ee=(u?1:0)+ce.GetGroupCount(d)+(p?p.length:0),te=ue(F,{theme:R,compact:a,isFixed:h===re.DetailsListLayoutMode.fixedColumns,isHorizontalConstrained:s===re.ConstrainMode.horizontalConstrained,className:r});return oe.createElement("div",ie.__assign({ref:this._root,className:te.root,"data-automationid":"DetailsList","data-is-scrollable":"false","aria-label":_},w?{role:"application"}:{}),oe.createElement("div",{role:"grid","aria-label":S,"aria-rowcount":ee,"aria-colcount":(K!==ne.SelectAllVisibility.none&&K!==ne.SelectAllVisibility.hidden?1:0)+(N?N.length:0),"aria-readonly":"true"},oe.createElement("div",{onKeyDown:this._onHeaderKeyDown,role:"presentation"},u&&Y({componentRef:this._header,selectionMode:y,layoutMode:h,selection:z,columns:N,onColumnClick:f,onColumnContextMenu:b,onColumnResized:this._onColumnResized,onColumnIsSizingChanged:this._onColumnIsSizingChanged,onColumnAutoResized:this._onColumnAutoResized,groupNestingDepth:W,isAllCollapsed:B,onToggleCollapseAll:this._onToggleCollapse,ariaLabel:t,ariaLabelForSelectAllCheckbox:i,ariaLabelForSelectionColumn:o,selectAllVisibility:K,collapseAllVisibility:c&&c.collapseAllVisibility,viewport:E,columnReorderProps:J,minimumPixelsForDrag:M,cellStyleProps:pe.DEFAULT_CELL_STYLE_PROPS},this._onRenderDetailsHeader)),oe.createElement("div",{onKeyDown:this._onContentKeyDown,role:"presentation"},oe.createElement(ae.FocusZone,{componentRef:this._focusZone,className:te.focusZone,direction:ae.FocusZoneDirection.vertical,isInnerZoneKeystroke:me,onActiveElementChanged:this._onActiveRowChanged,onBlur:this._onBlur},oe.createElement(se.SelectionZone,ie.__assign({ref:this._selectionZone,selection:z,selectionPreservedOnEmptyClick:v,selectionMode:y,onItemInvoked:m,onItemContextMenu:g,enterModalOnTouch:this.props.enterModalSelectionOnTouch},x||{}),d?oe.createElement(le.GroupedList,{componentRef:this._groupedList,groups:d,groupProps:c?this._getGroupProps(c):void 0,items:p,onRenderCell:this._onRenderCell,selection:z,selectionMode:y,dragDropEvents:l,dragDropHelper:U,eventsToRegister:k,listProps:q,onGroupExpandStateChanged:this._onGroupExpandStateChanged,usePageCache:T,onShouldVirtualize:D,getGroupHeight:A}):oe.createElement(de.List,ie.__assign({ref:this._list,role:"presentation",items:L&&!p.length?he:p,onRenderCell:this._onRenderListCell(0),usePageCache:T,onShouldVirtualize:D},q))))),Q(ie.__assign({},X),this._onRenderDetailsFooter)))};e.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this);this._forceListUpdates()};e.prototype._onRenderCell=function(e,t,i){var o=this.props,r=o.compact,n=o.dragDropEvents,a=o.rowElementEventMap,s=o.onRenderMissingItem,l=o.onRenderItemColumn,d=o.onRenderRow,c=void 0===d?this._onRenderRow:d,p=o.selectionMode,u=o.viewport,h=o.checkboxVisibility,m=o.getRowAriaLabel,g=o.getRowAriaDescribedBy,f=o.checkButtonAriaLabel,b=o.checkboxCellClassName,y=o.groupProps,v=o.useReducedRowRenderer,x=o.cellStyleProps,_=void 0===x?pe.DEFAULT_CELL_STYLE_PROPS:x,S=y&&y.collapseAllVisibility,k=this._selection,P=this._dragDropHelper,w={item:t,itemIndex:i,compact:r,columns:this.state.adjustedColumns,groupNestingDepth:e,selectionMode:p,selection:k,onDidMount:this._onRowDidMount,onWillUnmount:this._onRowWillUnmount,onRenderItemColumn:l,eventsToRegister:a,dragDropEvents:n,dragDropHelper:P,viewport:u,checkboxVisibility:h,collapseAllVisibility:S,getRowAriaLabel:m,getRowAriaDescribedBy:g,checkButtonAriaLabel:f,checkboxCellClassName:b,useReducedRowRenderer:v,cellStyleProps:_};return t?c(w,this._onRenderRow):s?s(i,w):null};e.prototype._onGroupExpandStateChanged=function(e){this.setState({isSomeGroupExpanded:e})};e.prototype._onColumnIsSizingChanged=function(e,t){this.setState({isSizing:t})};e.prototype._onHeaderKeyDown=function(e){if(40===e.which&&this._focusZone.current&&this._focusZone.current.focus()){e.preventDefault();e.stopPropagation()}};e.prototype._onContentKeyDown=function(e){if(38===e.which&&!e.altKey&&this._header.current&&this._header.current.focus()){e.preventDefault();e.stopPropagation()}};e.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.props.groups;t&&0<t.length;){e++;t=t[0].children}return e};e.prototype._onRowDidMount=function(e){var t=e.props,i=t.item,o=t.itemIndex,r=this._getItemKey(i,o);this._activeRows[r]=e;this._setFocusToRowIfPending(e);var n=this.props.onRowDidMount;n&&n(i,o)};e.prototype._setFocusToRowIfPending=function(e){var t=e.props.itemIndex;if(void 0!==this._initialFocusedIndex&&t===this._initialFocusedIndex){this._setFocusToRow(e);delete this._initialFocusedIndex}};e.prototype._setFocusToRow=function(e,t){void 0===t&&(t=!1);this._selectionZone.current&&this._selectionZone.current.ignoreNextFocus();this._async.setTimeout(function(){e.focus(t)},0)};e.prototype._onRowWillUnmount=function(e){var t=this.props.onRowWillUnmount,i=e.props,o=i.item,r=i.itemIndex,n=this._getItemKey(o,r);delete this._activeRows[n];t&&t(o,r)};e.prototype._onToggleCollapse=function(e){this.setState({isCollapsed:e});this._groupedList.current&&this._groupedList.current.toggleCollapseAll(e)};e.prototype._onColumnDragEnd=function(e,t){var i=this.props.columnReorderOptions,o=re.ColumnDragEndLocation.outside;if(i&&i.onDragEnd){if(e.dropLocation&&e.dropLocation!==re.ColumnDragEndLocation.header)o=e.dropLocation;else if(this._root.current){var r=this._root.current.getBoundingClientRect();t.clientX>r.left&&t.clientX<r.right&&t.clientY>r.top&&t.clientY<r.bottom&&(o=re.ColumnDragEndLocation.surface)}i.onDragEnd(o)}};e.prototype._forceListUpdates=function(){this._pendingForceUpdate=!1;this._groupedList.current&&this._groupedList.current.forceUpdate();this._list.current&&this._list.current.forceUpdate()};e.prototype._adjustColumns=function(e,t,i){var o=this._getAdjustedColumns(e,t,i),r=this.props.viewport.width;o&&this.setState({adjustedColumns:o,lastWidth:r})};e.prototype._getAdjustedColumns=function(e,t,i){var o,r=this,n=e.items,a=e.layoutMode,s=e.selectionMode,l=e.columns,d=e.viewport.width,c=this.props?this.props.columns:[],p=this.state?this.state.lastWidth:-1,u=this.state?this.state.lastSelectionMode:void 0;if(void 0!==d){if(!(t||p!==d||u!==s||c&&l!==c))return}else d=this.props.viewport.width;l=l||h(n,!0);a===re.DetailsListLayoutMode.fixedColumns?(o=this._getFixedColumns(l)).forEach(function(e){r._rememberCalculatedWidth(e,e.calculatedWidth)}):(o=void 0!==i?this._getJustifiedColumnsAfterResize(l,d,e,i):this._getJustifiedColumns(l,d,e,0)).forEach(function(e){r._getColumnOverride(e.key).currentWidth=e.calculatedWidth});return o};e.prototype._getFixedColumns=function(e){var i=this;return e.map(function(e){var t=a.assign({},e,i._columnOverrides[e.key]);t.calculatedWidth||(t.calculatedWidth=t.maxWidth||t.minWidth||100);return t})};e.prototype._getJustifiedColumnsAfterResize=function(e,t,o,i){var r=this,n=e.slice(0,i);n.forEach(function(e){return e.calculatedWidth=r._getColumnOverride(e.key).currentWidth});var a=n.reduce(function(e,t,i){return e+S(t,0===i,o)},0),s=e.slice(i),l=t-a;return n.concat(this._getJustifiedColumns(s,l,o,i))};e.prototype._getJustifiedColumns=function(e,t,o,r){for(var n=this,i=o.selectionMode,a=o.checkboxVisibility,s=o.groups,l=i!==se.SelectionMode.none&&a!==re.CheckboxVisibility.hidden?40:0,d=0,c=t-(l+(s?36:0)),p=e.map(function(e,t){var i=ie.__assign({},e,{calculatedWidth:e.minWidth||100},n._columnOverrides[e.key]);d+=S(i,t+r===0,o);return i}),u=p.length-1;0<u&&c<d;){var h=(f=p[u]).minWidth||100,m=d-c;if(f.calculatedWidth-h>=m||!f.isCollapsable){f.calculatedWidth=Math.max(f.calculatedWidth-m,h);d=c}else{d-=S(f,!1,o);p.splice(u,1)}u--}for(var g=0;g<p.length&&d<c;g++){var f=p[g],b=g===p.length-1,y=this._columnOverrides[f.key];if(!y||!y.calculatedWidth||b){var v=c-d,x=void 0;if(b)x=v;else{var _=f.maxWidth;h=f.minWidth||_||100;x=_?Math.min(v,_-h):v}f.calculatedWidth=f.calculatedWidth+x;d+=x}}return p};e.prototype._onColumnResized=function(e,t,i){var o=Math.max(e.minWidth||100,t);this.props.onColumnResize&&this.props.onColumnResize(e,o,i);this._rememberCalculatedWidth(e,o);this._adjustColumns(this.props,!0,i);this._forceListUpdates()};e.prototype._rememberCalculatedWidth=function(e,t){var i=this._getColumnOverride(e.key);i.calculatedWidth=t;i.currentWidth=t};e.prototype._getColumnOverride=function(e){return this._columnOverrides[e]=this._columnOverrides[e]||{}};e.prototype._onColumnAutoResized=function(t,i){var o=this,r=0,n=0,a=Object.keys(this._activeRows).length;for(var e in this._activeRows)if(this._activeRows.hasOwnProperty(e)){this._activeRows[e].measureCell(i,function(e){r=Math.max(r,e);++n===a&&o._onColumnResized(t,r,i)})}};e.prototype._onActiveRowChanged=function(e,t){var i=this.props,o=i.items,r=i.onActiveItemChanged;if(e&&e.getAttribute("data-item-index")){var n=Number(e.getAttribute("data-item-index"));if(0<=n){r&&r(o[n],n,t);this.setState({focusedItemIndex:n})}}};e.prototype._onBlur=function(e){this.setState({focusedItemIndex:-1})};e.prototype._getItemKey=function(e,t){var i=this.props.getKey,o=void 0;e&&(o=e.key);i&&(o=i(e,t));o||(o=t);return o};e.prototype._getDetailsFooterProps=function(){var e={columns:this.state.adjustedColumns,groupNestingDepth:this._getGroupNestingDepth(),selection:this._selection};return ie.__assign({},e)};e.prototype._getColumnReorderProps=function(){var e=this.props.columnReorderOptions;if(e)return ie.__assign({},e,{onColumnDragEnd:this._onColumnDragEnd})};e.prototype._getGroupProps=function(e){var i=this,o=e.onRenderFooter,r=e.onRenderHeader,n=this.state.adjustedColumns,a=this._getGroupNestingDepth(),t=o?function(e,t){return o(ie.__assign({},e,{columns:n,groupNestingDepth:a,selection:i._selection}),t)}:void 0,s=r?function(e,t){return r(ie.__assign({},e,{columns:n,groupNestingDepth:a,selection:i._selection}),t)}:void 0,l=e;return ie.__assign({},l,{onRenderFooter:t,onRenderHeader:s})};e.defaultProps={layoutMode:re.DetailsListLayoutMode.justified,selectionMode:se.SelectionMode.multiple,constrainMode:re.ConstrainMode.horizontalConstrained,checkboxVisibility:re.CheckboxVisibility.onHover,isHeaderVisible:!0,enableShimmer:!1};return e=ie.__decorate([o.withViewport],e)}(a.BaseComponent);t.DetailsListBase=s;function h(e,t,i,o,r,n,a){var s=[];if(e&&e.length){var l=e[0];for(var d in l)l.hasOwnProperty(d)&&s.push({key:d,name:d,fieldName:d,minWidth:100,maxWidth:300,isCollapsable:!!s.length,isMultiline:void 0!==a&&a,isSorted:o===d,isSortedDescending:!!r,isRowHeader:!1,columnActionsMode:re.ColumnActionsMode.clickable,isResizable:t,onColumnClick:i,isGrouped:n===d})}return s}t.buildColumns=h;function me(e){return e.which===a.getRTLSafeKeyCode(39)}function S(e,t,i){var o=i.cellStyleProps,r=void 0===o?pe.DEFAULT_CELL_STYLE_PROPS:o;return e.calculatedWidth+r.cellLeftPadding+r.cellRightPadding+(e.isPadded?r.cellExtraRightPadding:0)}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.disabled=0]="disabled";e[e.clickable=1]="clickable";e[e.hasDropdown=2]="hasDropdown"}(t.ColumnActionsMode||(t.ColumnActionsMode={}));!function(e){e[e.unconstrained=0]="unconstrained";e[e.horizontalConstrained=1]="horizontalConstrained"}(t.ConstrainMode||(t.ConstrainMode={}));!function(e){e[e.outside=0]="outside";e[e.surface=1]="surface";e[e.header=2]="header"}(t.ColumnDragEndLocation||(t.ColumnDragEndLocation={}));!function(e){e[e.fixedColumns=0]="fixedColumns";e[e.justified=1]="justified"}(t.DetailsListLayoutMode||(t.DetailsListLayoutMode={}));!function(e){e[e.onHover=0]="onHover";e[e.always=1]="always";e[e.hidden=2]="hidden"}(t.CheckboxVisibility||(t.CheckboxVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader",["require","exports","../../Utilities","./DetailsHeader.base","./DetailsHeader.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsHeader=i.styled(o.DetailsHeaderBase,r.getStyles,void 0,{scope:"DetailsHeader"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.base",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.types","../../FocusZone","../../Icon","../../Layer","../GroupedList/GroupSpacer","../../GroupedList","./DetailsRowCheck","../../utilities/selection/interfaces","../../utilities/dragdrop/index","../../components/DetailsList/DetailsColumn","./DetailsHeader.types","../../Utilities"],function(e,t,c,I,i,T,o,D,L,E,M,A,F,n,R,O,N,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var B=r.classNamesFunction(),a=function(t){c.__extends(e,t);function e(e){var h=t.call(this,e)||this;h._rootComponent=T.createRef();h._draggedColumnIndex=-1;h._dropHintDetails={};h._getDropHintPositions=function(){for(var e,t=h.props.columns,i=h._columnReorderProps,o=0,r=0,n=i&&i.frozenColumnCountFromStart?i.frozenColumnCountFromStart:0,a=i&&i.frozenColumnCountFromEnd?i.frozenColumnCountFromEnd:0,s=n;s<t.length-a+1;s++)if(h._rootElement){var l=h._rootElement.querySelectorAll("#columnDropHint_"+s)[0];if(l)if(s===n){o=l.offsetLeft;r=l.offsetLeft;e=l}else{var d=(l.offsetLeft+o)/2;h._dropHintDetails[s-1]={originX:o,startX:r,endX:d,dropHintElementRef:e};r=d;o=(e=l).offsetLeft;s===t.length-a&&(h._dropHintDetails[s]={originX:o,startX:r,endX:l.offsetLeft,dropHintElementRef:e})}}};h._computeDropHintToBeShown=function(e){if(h._rootElement){var t=e-h._rootElement.getBoundingClientRect().left,i=h._currentDropHintIndex;if(h._isValidCurrentDropHintIndex()&&t>=h._dropHintDetails[i].startX&&t<=h._dropHintDetails[i].endX)return;var o=h.props.columns,r=h._columnReorderProps,n=r&&r.frozenColumnCountFromStart?r.frozenColumnCountFromStart:0,a=r&&r.frozenColumnCountFromEnd?r.frozenColumnCountFromEnd:0,s=n,l=o.length-a,d=-1;t<=h._dropHintDetails[s].endX?d=s:t>=h._dropHintDetails[l].startX?d=l:h._isValidCurrentDropHintIndex()&&(h._dropHintDetails[i+1]&&t>=h._dropHintDetails[i+1].startX&&t<=h._dropHintDetails[i+1].endX?d=i+1:h._dropHintDetails[i-1]&&t>=h._dropHintDetails[i-1].startX&&t<=h._dropHintDetails[i-1].endX&&(d=i-1));if(-1===d)for(var c=n,p=l;c<p;){var u=Math.ceil((p+c)/2);if(t>=h._dropHintDetails[u].startX&&t<=h._dropHintDetails[u].endX){d=u;break}t<h._dropHintDetails[u].originX?p=u:t>h._dropHintDetails[u].originX&&(c=u)}if(d===h._draggedColumnIndex||d===h._draggedColumnIndex+1)h._isValidCurrentDropHintIndex()&&h._resetDropHints();else if(i!==d&&0<=d){h._resetDropHints();h._updateDropHintElement(h._dropHintDetails[d].dropHintElementRef,"visible");h._currentDropHintIndex=d}}};h._onRenderColumnHeaderTooltip=function(e,t){return I.createElement("span",{className:e.hostClassName},e.children)};h._onSelectAllClicked=function(){h.props.selection.toggleAllSelected()};h._onRootMouseDown=function(e){var t=e.target.getAttribute("data-sizer-index"),i=Number(t),o=h.props.columns;if(null!==t&&0===e.button){h.setState({columnResizeDetails:{columnIndex:i,columnMinWidth:o[i].calculatedWidth,originX:e.clientX}});e.preventDefault();e.stopPropagation()}};h._onRootMouseMove=function(e){var t=h.state,i=t.columnResizeDetails,o=t.isSizing;i&&!o&&e.clientX!==i.originX&&h.setState({isSizing:!0})};h._onRootRef=function(e){h._rootElement=e?i.findDOMNode(e):void 0};h._onRootKeyDown=function(e){var t=h.state,i=t.columnResizeDetails,o=t.isSizing,r=h.props,n=r.columns,a=r.onColumnResized,s=e.target.getAttribute("data-sizer-index");if(s&&!o){var l=Number(s);if(i){var d=void 0;if(13===e.which){h.setState({columnResizeDetails:void 0});e.preventDefault();e.stopPropagation()}else 37===e.which?d=T.getRTL()?1:-1:39===e.which&&(d=T.getRTL()?-1:1);if(d){e.shiftKey||(d*=10);h.setState({columnResizeDetails:c.__assign({},i,{columnMinWidth:i.columnMinWidth+d})});a&&a(n[l],i.columnMinWidth+d,l);e.preventDefault();e.stopPropagation()}}else if(13===e.which){h.setState({columnResizeDetails:{columnIndex:l,columnMinWidth:n[l].calculatedWidth}});e.preventDefault();e.stopPropagation()}}};h._onSizerMouseMove=function(e){var t=e.buttons,i=h.props,o=i.onColumnIsSizingChanged,r=i.onColumnResized,n=i.columns,a=h.state.columnResizeDetails;if(void 0===t||1===t){e.clientX!==a.originX&&o&&o(n[a.columnIndex],!0);if(r){var s=e.clientX-a.originX;T.getRTL()&&(s=-s);r(n[a.columnIndex],a.columnMinWidth+s,a.columnIndex)}}else h._onSizerMouseUp(e)};h._onSizerBlur=function(e){h.state.columnResizeDetails&&h.setState({columnResizeDetails:void 0,isSizing:!1})};h._onSizerMouseUp=function(e){var t=h.props,i=t.columns,o=t.onColumnIsSizingChanged,r=h.state.columnResizeDetails;h.setState({columnResizeDetails:void 0,isSizing:!1});o&&o(i[r.columnIndex],!1)};h._columnReorderProps=e.columnReorderProps||e.columnReorderOptions&&s(e.columnReorderOptions);h.state={columnResizeDetails:void 0,groupNestingDepth:h.props.groupNestingDepth,isAllCollapsed:h.props.isAllCollapsed};h._onToggleCollapseAll=h._onToggleCollapseAll.bind(h);h._onSelectAllClicked=h._onSelectAllClicked.bind(h);h._setDraggedItemIndex=h._setDraggedItemIndex.bind(h);h._updateDragInfo=h._updateDragInfo.bind(h);h._onDragOver=h._onDragOver.bind(h);h._onDrop=h._onDrop.bind(h);h._getHeaderDragDropOptions=h._getHeaderDragDropOptions.bind(h);h._updateDroppingState=h._updateDroppingState.bind(h);h._getDropHintPositions=h._getDropHintPositions.bind(h);h._computeDropHintToBeShown=h._computeDropHintToBeShown.bind(h);h._resetDropHints=h._resetDropHints.bind(h);h._isValidCurrentDropHintIndex=h._isValidCurrentDropHintIndex.bind(h);h._onRootRef=h._onRootRef.bind(h);h._isEventOnHeader=h._isEventOnHeader.bind(h);h._onDropIndexInfo={sourceIndex:Number.MIN_SAFE_INTEGER,targetIndex:Number.MIN_SAFE_INTEGER};h._id=T.getId("header");h._currentDropHintIndex=Number.MIN_SAFE_INTEGER;return h}e.prototype.componentDidMount=function(){var e=this.props.selection,t=this._columnReorderProps;this._events.on(e,n.SELECTION_CHANGE,this._onSelectionChanged);this._events.on(this._rootElement,"mousedown",this._onRootMouseDown);this._events.on(this._rootElement,"keydown",this._onRootKeyDown);t&&this._dragDropHelper&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()))};e.prototype.componentDidUpdate=function(e){this._columnReorderProps=this.props.columnReorderProps||this.props.columnReorderOptions&&s(this.props.columnReorderOptions);if(this._columnReorderProps)!this._subscriptionObject&&this._dragDropHelper&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()));else if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}this.props!==e&&0<=this._onDropIndexInfo.sourceIndex&&0<=this._onDropIndexInfo.targetIndex&&e.columns[this._onDropIndexInfo.sourceIndex].key===this.props.columns[this._onDropIndexInfo.targetIndex].key&&(this._onDropIndexInfo={sourceIndex:Number.MIN_SAFE_INTEGER,targetIndex:Number.MIN_SAFE_INTEGER})};e.prototype.componentWillReceiveProps=function(e){var t=this.state.groupNestingDepth;e.groupNestingDepth!==t&&this.setState({groupNestingDepth:e.groupNestingDepth})};e.prototype.componentWillUnmount=function(){if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}};e.prototype.render=function(){var o=this,e=this.props,r=e.columns,t=e.ariaLabel,i=e.ariaLabelForSelectAllCheckbox,n=e.selectAllVisibility,a=e.ariaLabelForSelectionColumn,s=e.indentWidth,l=e.viewport,d=e.onColumnClick,c=e.onColumnContextMenu,p=e.styles,u=e.theme,h=this._columnReorderProps,m=this.state,g=m.isAllSelected,f=m.columnResizeDetails,b=m.isSizing,y=m.groupNestingDepth,v=m.isAllCollapsed,x=n!==N.SelectAllVisibility.none,_=n===N.SelectAllVisibility.hidden,S=this.props.onRenderColumnHeaderTooltip,k=void 0===S?this._onRenderColumnHeaderTooltip:S;!this._dragDropHelper&&h&&(this._dragDropHelper=new R.DragDropHelper({selection:{getSelection:function(){}},minimumPixelsForDrag:this.props.minimumPixelsForDrag}));var P=h&&h.frozenColumnCountFromStart?h.frozenColumnCountFromStart:0,w=h&&h.frozenColumnCountFromEnd?h.frozenColumnCountFromEnd:0;this._classNames=B(p,{theme:u,isAllSelected:g,isSelectAllHidden:n===N.SelectAllVisibility.hidden,isResizingColumn:!!f&&b,isSizing:b,isAllCollapsed:v,isCheckboxHidden:_});var C=this._classNames;return I.createElement(D.FocusZone,{role:"row","aria-label":t,className:C.root,componentRef:this._rootComponent,ref:this._onRootRef,onMouseMove:this._onRootMouseMove,"data-automationid":"DetailsHeader",style:{minWidth:l?l.width:0},direction:D.FocusZoneDirection.horizontal},x?[I.createElement("div",{key:"__checkbox",className:C.cellIsCheck,"aria-labelledby":this._id+"-check",onClick:this._onSelectAllClicked,"aria-colindex":_?void 0:1,role:_?void 0:"columnheader"},k({hostClassName:T.css(C.checkTooltip),id:this._id+"-checkTooltip",setAriaDescribedBy:!1,content:i,children:I.createElement(F.DetailsRowCheck,{id:this._id+"-check","aria-label":a,"aria-describedby":this._id+"-checkTooltip","data-is-focusable":!_,isHeader:!0,selected:g,anySelected:!1,canSelect:!_,className:C.check})},this._onRenderColumnHeaderTooltip)),i&&!this.props.onRenderColumnHeaderTooltip?I.createElement("label",{key:"__checkboxLabel",id:this._id+"-checkTooltip",className:C.accessibleLabel},i):null]:null,0<y&&this.props.collapseAllVisibility===A.CollapseAllVisibility.visible?I.createElement("div",{className:C.cellIsGroupExpander,onClick:this._onToggleCollapseAll,"data-is-focusable":!0},I.createElement(L.Icon,{className:C.collapseButton,iconName:"ChevronDown"})):null,I.createElement(M.GroupSpacer,{indentWidth:s,count:y-1}),r.map(function(e,t){var i=!!h&&(P<=t&&t<r.length-w);return[h&&(i||t===r.length-w)&&o._renderDropHint(t),I.createElement(O.DetailsColumn,{column:e,key:e.key,columnIndex:(x?2:1)+t,parentId:o._id,isDraggable:i,updateDragInfo:o._updateDragInfo,dragDropHelper:o._dragDropHelper,onColumnClick:d,onColumnContextMenu:c,isDropped:o._onDropIndexInfo.targetIndex===t,cellStyleProps:o.props.cellStyleProps}),e.isResizable&&o._renderColumnSizer(t)]}),h&&0===w&&this._renderDropHint(r.length),b&&I.createElement(E.Layer,null,I.createElement("div",{className:C.sizingOverlay,onMouseMove:this._onSizerMouseMove,onMouseUp:this._onSizerMouseUp})))};e.prototype.focus=function(){return Boolean(this._rootComponent.current&&this._rootComponent.current.focus())};e.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}};e.prototype._updateDroppingState=function(e,t){0<=this._draggedColumnIndex&&"drop"!==t.type&&(e||this._resetDropHints())};e.prototype._isValidCurrentDropHintIndex=function(){return 0<=this._currentDropHintIndex};e.prototype._onDragOver=function(e,t){if(0<=this._draggedColumnIndex){t.stopPropagation();this._computeDropHintToBeShown(t.clientX)}};e.prototype._onDrop=function(e,t){var i=this._draggedColumnIndex,o=this._columnReorderProps;if(0<=this._draggedColumnIndex&&t&&t instanceof DragEvent){var r=i>this._currentDropHintIndex?this._currentDropHintIndex:this._currentDropHintIndex-1,n=!1;t.stopPropagation();if(this._isValidCurrentDropHintIndex()){n=!0;this._onDropIndexInfo.sourceIndex=i;this._onDropIndexInfo.targetIndex=r}this._resetDropHints();this._dropHintDetails={};this._draggedColumnIndex=-1;if(n)if(o&&o.onColumnDrop){var a={draggedIndex:i,targetIndex:r};o.onColumnDrop(a)}else o&&o.handleColumnReorder&&o.handleColumnReorder(i,r)}};e.prototype._setDraggedItemIndex=function(e){if(0<=e){this._draggedColumnIndex=this.props.selectionMode!==n.SelectionMode.none?e-2:e-1;this._getDropHintPositions()}else{this._resetDropHints();this._draggedColumnIndex=-1;this._dropHintDetails={}}};e.prototype._updateDragInfo=function(e,t){var i=this._columnReorderProps,o=e.itemIndex;if(0<=o){this._draggedColumnIndex=this.props.selectionMode!==n.SelectionMode.none?o-2:o-1;this._getDropHintPositions();i&&i.onColumnDragStart&&i.onColumnDragStart(!0)}else if(t&&0<=this._draggedColumnIndex){this._resetDropHints();this._draggedColumnIndex=-1;this._dropHintDetails={};if(i&&i.onColumnDragEnd){var r=this._isEventOnHeader(t);i.onColumnDragEnd({dropLocation:r},t)}}};e.prototype._resetDropHints=function(){if(0<=this._currentDropHintIndex){this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"hidden");this._currentDropHintIndex=Number.MIN_SAFE_INTEGER}};e.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.visibility=t;e.childNodes[0].style.visibility=t};e.prototype._isEventOnHeader=function(e){if(this._rootElement){var t=this._rootElement.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return o.ColumnDragEndLocation.header}};e.prototype._renderColumnSizer=function(e){var t,i=this.props.columns,o=this.props.columns[e],r=this.state.columnResizeDetails,n=this._classNames;return I.createElement("div",{key:o.key+"_sizer","aria-hidden":!0,role:"button","data-is-focusable":!1,onClick:l,"data-sizer-index":e,onBlur:this._onSizerBlur,className:T.css(n.cellSizer,e<i.length-1?n.cellSizerStart:n.cellSizerEnd,(t={},t[n.cellIsResizing]=r&&r.columnIndex===e,t)),onDoubleClick:this._onSizerDoubleClick.bind(this,e)})};e.prototype._renderDropHint=function(e){var t=this._classNames;return I.createElement("div",{key:"dropHintKey",className:t.dropHintStyle,id:"columnDropHint_"+e},I.createElement(L.Icon,{key:"dropHintCaretKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:t.dropHintCaretStyle,iconName:"CaretUpSolid8"}),I.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:t.dropHintLineStyle}))};e.prototype._onSizerDoubleClick=function(e,t){var i=this.props,o=i.onColumnAutoResized,r=i.columns;o&&o(r[e],e)};e.prototype._onSelectionChanged=function(){var e=this.props.selection.isAllSelected();this.state.isAllSelected!==e&&this.setState({isAllSelected:e})};e.prototype._onToggleCollapseAll=function(){var e=this.props.onToggleCollapseAll,t=!this.state.isAllCollapsed;this.setState({isAllCollapsed:t});e&&e(t)};e.defaultProps={selectAllVisibility:N.SelectAllVisibility.visible,collapseAllVisibility:A.CollapseAllVisibility.visible};return e}(T.BaseComponent);t.DetailsHeaderBase=a;function s(e){return c.__assign({},e,{onColumnDragEnd:void 0})}function l(e){e.stopPropagation()}});define("office-ui-fabric-react/lib/components/GroupedList/GroupSpacer",["require","exports","react","../../Utilities","./GroupSpacer.styles"],function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.classNamesFunction();t.GroupSpacer=i.styled(function(e){var t=e.count,i=e.styles,o=e.theme,r=e.indentWidth,n=void 0===r?36:r,a=l(i,{theme:o});return 0<t?s.createElement("span",{className:a.root,style:{width:t*n}}):null},o.getStyles,void 0,{scope:"GroupSpacer"})});define("office-ui-fabric-react/lib/components/GroupedList/GroupSpacer.styles",["require","exports","../../Styling"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={root:"ms-GroupSpacer"};t.getStyles=function(e){var t=e.theme;return{root:[i.getGlobalClassNames(o,t).root,{display:"inline-block"}]}}});define("office-ui-fabric-react/lib/GroupedList",["require","exports","tslib","./components/GroupedList/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/GroupedList/index",["require","exports","tslib","./GroupedList","./GroupedList.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList",["require","exports","../../Utilities","./GroupedList.styles","./GroupedList.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupedList=i.styled(r.GroupedListBase,o.getStyles,void 0,{scope:"GroupedList"})});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList.styles",["require","exports","../../Styling"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={root:"ms-GroupedList",group:"ms-GroupedList-group",link:"ms-Link",listCell:"ms-List-cell"},l="cubic-bezier(0.445, 0.050, 0.550, 0.950)";t.getStyles=function(e){var t,i=e.theme,o=e.className,r=i.palette,n=a.getGlobalClassNames(s,i);return{root:[n.root,{position:"relative",fontSize:a.FontSizes.small,selectors:(t={},t["& :global(."+n.listCell+")"]={minHeight:36},t)},o],group:[n.group,{transition:"background-color "+a.AnimationVariables.durationValue2+" "+l}],groupIsDropping:[{backgroundColor:r.neutralLight}]}}});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList.base",["require","exports","tslib","react","../../Utilities","./GroupedListSection","../../List","../../utilities/selection/index"],function(e,t,i,x,_,S,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=_.classNamesFunction(),r=function(t){i.__extends(e,t);function e(e){var v=t.call(this,e)||this;v._list=_.createRef();v._renderGroup=function(e,t){var i=v.props,o=i.dragDropEvents,r=i.dragDropHelper,n=i.eventsToRegister,a=i.groupProps,s=i.items,l=i.listProps,d=i.onRenderCell,c=i.selectionMode,p=i.selection,u=i.viewport,h=i.onShouldVirtualize,m={onToggleSelectGroup:v._onToggleSelectGroup,onToggleCollapse:v._onToggleCollapse,onToggleSummarize:v._onToggleSummarize},g=_.assign({},a.headerProps,m),f=_.assign({},a.showAllProps,m),b=_.assign({},a.footerProps,m),y=v._getGroupNestingDepth();return!a.showEmptyGroups&&e&&0===e.count?null:x.createElement(S.GroupedListSection,{ref:"group_"+t,key:v._getGroupKey(e,t),dragDropEvents:o,dragDropHelper:r,eventsToRegister:n,footerProps:b,getGroupItemLimit:a&&a.getGroupItemLimit,group:e,groupIndex:t,groupNestingDepth:y,groupProps:a,headerProps:g,listProps:l,items:s,onRenderCell:d,onRenderGroupHeader:a.onRenderHeader,onRenderGroupShowAll:a.onRenderShowAll,onRenderGroupFooter:a.onRenderFooter,selectionMode:c,selection:p,showAllProps:f,viewport:u,onShouldVirtualize:h,groupedListClassNames:v._classNames})};v._getPageHeight=function(o){return function(e){var t=v.state.groups,i=t&&t[e];return o(i,e)}};v._onToggleCollapse=function(e){var t=v.props.groupProps,i=t&&t.headerProps&&t.headerProps.onToggleCollapse;if(e){i&&i(e);e.isCollapsed=!e.isCollapsed;v._updateIsSomeGroupExpanded();v.forceUpdate()}};v._onToggleSelectGroup=function(e){e&&v.props.selection.toggleRangeSelected(e.startIndex,e.count)};v._onToggleSummarize=function(e){var t=v.props.groupProps,i=t&&t.showAllProps&&t.showAllProps.onToggleSummarize;if(i)i(e);else{e&&(e.isShowingAll=!e.isShowingAll);v.forceUpdate()}};v._getPageSpecification=function(e,t){var i=v.state.groups,o=i&&i[e];return{key:o&&o.name}};v._isSomeGroupExpanded=v._computeIsSomeGroupExpanded(e.groups);v.state={lastWidth:0,groups:e.groups};return v}e.prototype.scrollToIndex=function(e,t,i){this._list.current&&this._list.current.scrollToIndex(e,t,i)};e.prototype.getStartItemIndexInView=function(){return this._list.current.getStartItemIndexInView()||0};e.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.groups,o=t.selectionMode,r=!1;if(e.groups!==i){this.setState({groups:e.groups});r=!0}e.selectionMode!==o&&(r=!0);r&&this._forceListUpdates()};e.prototype.render=function(){var e=this.props,t=e.className,i=e.usePageCache,o=e.onShouldVirtualize,r=e.getGroupHeight,n=e.theme,a=e.styles,s=this.state.groups;this._classNames=d(a,{theme:n,className:t});return x.createElement("div",{className:this._classNames.root,"data-automationid":"GroupedList","data-is-scrollable":"false",role:"presentation"},s?x.createElement(l.List,{ref:this._list,items:s,onRenderCell:this._renderGroup,getItemCountForPage:this._returnOne,getPageHeight:r&&this._getPageHeight(r),getPageSpecification:this._getPageSpecification,usePageCache:i,onShouldVirtualize:o}):this._renderGroup(null,0))};e.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this);this._forceListUpdates()};e.prototype.toggleCollapseAll=function(e){var t=this.state.groups,i=this.props.groupProps,o=i&&i.onToggleCollapseAll;if(t){o&&o(e);for(var r=0;r<t.length;r++)t[r].isCollapsed=e;this._updateIsSomeGroupExpanded();this.forceUpdate()}};e.prototype._returnOne=function(){return 1};e.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(t))};e.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.state.groups;t&&0<t.length;){e++;t=t[0].children}return e};e.prototype._forceListUpdates=function(e){var t=(e=e||this.state.groups)?e.length:1;if(this._list.current){this._list.current.forceUpdate();for(var i=0;i<t;i++){(o=this._list.current.refs["group_"+String(i)])&&o.forceListUpdate()}}else{var o;(o=this.refs["group_"+String(0)])&&o.forceListUpdate()}};e.prototype._computeIsSomeGroupExpanded=function(e){var t=this;return!(!e||!e.some(function(e){return e.children?t._computeIsSomeGroupExpanded(e.children):!e.isCollapsed}))};e.prototype._updateIsSomeGroupExpanded=function(){var e=this.state.groups,t=this.props.onGroupExpandStateChanged,i=this._computeIsSomeGroupExpanded(e);if(this._isSomeGroupExpanded!==i){t&&t(i);this._isSomeGroupExpanded=i}};e.defaultProps={selectionMode:o.SelectionMode.multiple,isHeaderVisible:!0,groupProps:{}};return e}(_.BaseComponent);t.GroupedListBase=r});define("office-ui-fabric-react/lib/components/GroupedList/GroupedListSection",["require","exports","tslib","react","../../Utilities","../../utilities/selection/index","./GroupHeader","./GroupShowAll","./GroupFooter","../../List","../../Utilities"],function(e,t,c,w,r,n,a,s,l,C,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){c.__extends(k,o);function k(e){var S=o.call(this,e)||this;S._root=r.createRef();S._list=r.createRef();S._onRenderGroupHeader=function(e){return w.createElement(a.GroupHeader,c.__assign({},e))};S._onRenderGroupShowAll=function(e){return w.createElement(s.GroupShowAll,c.__assign({},e))};S._onRenderGroupFooter=function(e){return w.createElement(l.GroupFooter,c.__assign({},e))};S._renderSubGroup=function(e,t){var i=S.props,o=i.dragDropEvents,r=i.dragDropHelper,n=i.eventsToRegister,a=i.getGroupItemLimit,s=i.groupNestingDepth,l=i.groupProps,d=i.items,c=i.headerProps,p=i.showAllProps,u=i.footerProps,h=i.listProps,m=i.onRenderCell,g=i.selection,f=i.selectionMode,b=i.viewport,y=i.onRenderGroupHeader,v=i.onRenderGroupShowAll,x=i.onRenderGroupFooter,_=i.onShouldVirtualize;return!e||0<e.count||l&&l.showEmptyGroups?w.createElement(k,{ref:"subGroup_"+t,key:S._getGroupKey(e,t),dragDropEvents:o,dragDropHelper:r,eventsToRegister:n,footerProps:u,getGroupItemLimit:a,group:e,groupIndex:t,groupNestingDepth:s,groupProps:l,headerProps:c,items:d,listProps:h,onRenderCell:m,selection:g,selectionMode:f,showAllProps:p,viewport:b,onRenderGroupHeader:y,onRenderGroupShowAll:v,onRenderGroupFooter:x,onShouldVirtualize:_}):null};S._getGroupDragDropOptions=function(){var e=S.props,t=e.group,i=e.groupIndex,o=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:-1,context:{data:t,index:i,isGroup:!0},canDrag:function(){return!1},canDrop:o.canDrop,updateDropState:S._updateDroppingState}};S._updateDroppingState=function(e,t){var i=S.state.isDropping,o=S.props.dragDropEvents;i?o&&o.onDragEnter&&o.onDragEnter(t,void 0):o&&o.onDragLeave&&o.onDragLeave(t,void 0);i!==e&&S.setState({isDropping:e})};var t=e.selection,i=e.group;S.state={isDropping:!1,isSelected:!(!t||!i)&&t.isRangeSelected(i.startIndex,i.count)};return S}k.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,i=e.selection;t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getGroupDragDropOptions()));i&&this._events.on(i,n.SELECTION_CHANGE,this._onSelectionChange)};k.prototype.componentWillUnmount=function(){this._dragDropSubscription&&this._dragDropSubscription.dispose()};k.prototype.componentDidUpdate=function(e){if(this.props.group!==e.group||this.props.groupIndex!==e.groupIndex||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions()))}};k.prototype.render=function(){var e=this.props,t=e.getGroupItemLimit,i=e.group,o=e.groupIndex,r=e.headerProps,n=e.showAllProps,a=e.footerProps,s=e.viewport,l=e.selectionMode,d=e.onRenderGroupHeader,c=void 0===d?this._onRenderGroupHeader:d,p=e.onRenderGroupShowAll,u=void 0===p?this._onRenderGroupShowAll:p,h=e.onRenderGroupFooter,m=void 0===h?this._onRenderGroupFooter:h,g=e.onShouldVirtualize,f=e.groupedListClassNames,b=this.state.isSelected,y=i&&t?t(i):1/0,v=i&&!i.children&&!i.isCollapsed&&!i.isShowingAll&&(i.count>y||i.hasMoreData),x=i&&i.children&&0<i.children.length,_={group:i,groupIndex:o,groupLevel:i?i.level:0,isSelected:b,viewport:s,selectionMode:l},S=I.assign({},r,_),k=I.assign({},n,_),P=I.assign({},a,_);return w.createElement("div",{ref:this._root,className:I.css(f&&f.group,this._getDroppingClassName()),role:"presentation"},c(S,this._onRenderGroupHeader),i&&i.isCollapsed?null:x?w.createElement(C.List,{ref:this._list,items:i.children,onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:g}):this._onRenderGroup(y),i&&i.isCollapsed?null:v&&u(k,this._onRenderGroupShowAll),m(P,this._onRenderGroupFooter))};k.prototype.forceUpdate=function(){o.prototype.forceUpdate.call(this);this.forceListUpdate()};k.prototype.forceListUpdate=function(){var e=this.props.group;if(this._list.current){this._list.current.forceUpdate();if(e&&e.children&&0<e.children.length)for(var t=e.children.length,i=0;i<t;i++){(o=this._list.current.refs["subGroup_"+String(i)])&&o.forceListUpdate()}}else{var o;(o=this.refs["subGroup_"+String(0)])&&o.forceListUpdate()}};k.prototype._onSelectionChange=function(){var e=this.props,t=e.group,i=e.selection.isRangeSelected(t.startIndex,t.count);i!==this.state.isSelected&&this.setState({isSelected:i})};k.prototype._onRenderGroupCell=function(i,o){return function(e,t){return i(o,e,t)}};k.prototype._onRenderGroup=function(e){var t=this.props,i=t.group,o=t.items,r=t.onRenderCell,n=t.listProps,a=t.groupNestingDepth,s=t.onShouldVirtualize,l=i?i.count:o.length,d=i?i.startIndex:0;return w.createElement(C.List,c.__assign({items:o,onRenderCell:this._onRenderGroupCell(r,a),ref:this._list,renderCount:Math.min(l,e),startIndex:d,onShouldVirtualize:s},n))};k.prototype._returnOne=function(){return 1};k.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(e.level)+String(t))};k.prototype._getDroppingClassName=function(){var e=this.state.isDropping,t=this.props,i=t.group,o=t.groupedListClassNames;e=!(!i||!e);return I.css(e&&"is-dropping",e&&o&&o.groupIsDropping)};return k}(r.BaseComponent);t.GroupedListSection=i});define("office-ui-fabric-react/lib/components/GroupedList/GroupHeader",["require","exports","../../Utilities","./GroupHeader.styles","./GroupHeader.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupHeader=i.styled(r.GroupHeaderBase,o.getStyles,void 0,{scope:"GroupHeader"})});define("office-ui-fabric-react/lib/components/GroupedList/GroupHeader.styles",["require","exports","../../Styling"],function(e,t,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:"ms-GroupHeader",check:"ms-GroupHeader-check",dropIcon:"ms-GroupHeader-dropIcon",expand:"ms-GroupHeader-expand",isCollapsed:"is-collapsed",title:"ms-GroupHeader-title",isSelected:"is-selected",iconTag:"ms-Icon--Tag",group:"ms-GroupedList-group",isDropping:"is-dropping"},h="cubic-bezier(0.075, 0.820, 0.165, 1.000)",m="cubic-bezier(0.390, 0.575, 0.565, 1.000)",g="cubic-bezier(0.600, -0.280, 0.735, 0.045)";t.getStyles=function(e){var t,i,o=e.theme,r=e.className,n=e.selected,a=e.isCollapsed,s=o.semanticColors,l=o.palette,d=p.getGlobalClassNames(u,o),c=[p.getFocusStyle(o),{cursor:"default",background:"none",backgroundColor:"transparent",border:"none",fontSize:p.IconFontSizes.large}];return{root:[d.root,p.getFocusStyle(o),{cursor:"default",userSelect:"none",selectors:(t={":hover":{background:s.listItemBackgroundHovered},":hover $check":{opacity:1}},t[":global(."+d.group+"."+d.isDropping+")"]={selectors:{"> $root $dropIcon":{transition:"transform "+p.AnimationVariables.durationValue4+" "+h+" opacity "+p.AnimationVariables.durationValue1+" "+m,transitionDelay:p.AnimationVariables.durationValue3,opacity:1,transform:"rotate(0.2deg) scale(1);"},$check:{opacity:0}}},t)},n&&[d.isSelected,{background:s.listItemBackgroundChecked,selectors:{":hover":{background:s.listItemBackgroundCheckedHovered},$check:{opacity:1}}}],r],groupHeaderContainer:[{display:"flex",alignItems:"center",height:40}],headerCount:[{padding:"0px 4px"}],check:[d.check,c,{opacity:0,selectors:{":focus":{opacity:1}},width:"40px"}],expand:[d.expand,c,{width:36,height:40,color:l.neutralSecondary,paddingTop:4}],expandIsCollapsed:[a?[d.isCollapsed,{transform:"rotate(0deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}]:{transform:"rotate(-180deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}],title:[d.title,{paddingLeft:"12px",fontSize:p.FontSizes.xLarge,fontWeight:p.FontWeights.light,cursor:"pointer",outline:0,whiteSpace:"nowrap",textOverflow:"ellipsis"}],dropIcon:[d.dropIcon,{position:"absolute",left:-26,fontSize:p.IconFontSizes.large,color:l.neutralSecondaryAlt,transition:"transform "+p.AnimationVariables.durationValue2+" "+g+", opacity "+p.AnimationVariables.durationValue4+" "+m,opacity:0,transform:"rotate(0.2deg) scale(0.65)",transformOrigin:"10px 10px",selectors:(i={},i[":global(."+d.iconTag+")"]={position:"absolute"},i)}]}}});define("office-ui-fabric-react/lib/components/GroupedList/GroupHeader.base",["require","exports","tslib","react","../../Utilities","../../utilities/selection/index","../../Check","../../Icon","./GroupSpacer","../../Spinner","../../FocusZone"],function(e,t,S,k,i,P,w,C,I,T,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=i.classNamesFunction(),o=function(t){S.__extends(e,t);function e(e){var s=t.call(this,e)||this;s._onToggleCollapse=function(e){var t=s.props,i=t.group,o=t.onToggleCollapse,r=t.isGroupLoading,n=!s.state.isCollapsed,a=!n&&r&&r(i);s.setState({isCollapsed:n,isLoadingVisible:a});o&&o(i);e.stopPropagation();e.preventDefault()};s._onToggleSelectGroupClick=function(e){var t=s.props,i=t.onToggleSelectGroup,o=t.group;i&&i(o);e.preventDefault();e.stopPropagation()};s._onHeaderClick=function(){var e=s.props,t=e.group,i=e.onGroupHeaderClick,o=e.onToggleSelectGroup;i?i(t):o&&o(t)};s._onRenderTitle=function(e){var t=e.group;return t?k.createElement("div",{className:s._classNames.title},k.createElement("span",null,t.name),k.createElement("span",{className:s._classNames.headerCount},"(",t.count,t.hasMoreData&&"+",")")):null};s.state={isCollapsed:s.props.group&&s.props.group.isCollapsed,isLoadingVisible:!1};return s}e.prototype.componentWillReceiveProps=function(e){if(e.group){var t=e.group.isCollapsed,i=e.headerProps&&e.headerProps.isGroupLoading,o=!t&&i&&i(e.group);this.setState({isCollapsed:t,isLoadingVisible:o})}};e.prototype.render=function(){var e=this.props,t=e.group,i=e.groupLevel,o=e.viewport,r=e.selectionMode,n=e.loadingText,a=e.isSelected,s=e.selected,l=e.indentWidth,d=e.onRenderTitle,c=void 0===d?this._onRenderTitle:d,p=e.isCollapsedGroupSelectVisible,u=void 0===p||p,h=e.expandButtonProps,m=e.theme,g=e.styles,f=e.className,b=this.state,y=b.isCollapsed,v=b.isLoadingVisible,x=r===P.SelectionMode.multiple&&(u||!(t&&t.isCollapsed)),_=a||s;this._classNames=L(g,{theme:m,className:f,selected:_,isCollapsed:y});return t?k.createElement("div",{className:this._classNames.root,style:o?{minWidth:o.width}:{},onClick:this._onHeaderClick,"aria-label":t.ariaLabel||t.name,"data-is-focusable":!0},k.createElement(D.FocusZone,{className:this._classNames.groupHeaderContainer,direction:D.FocusZoneDirection.horizontal},x?k.createElement("button",{type:"button",className:this._classNames.check,"data-selection-toggle":!0,onClick:this._onToggleSelectGroupClick},k.createElement(w.Check,{checked:_})):r!==P.SelectionMode.none&&k.createElement(I.GroupSpacer,{indentWidth:l,count:1}),k.createElement(I.GroupSpacer,{indentWidth:l,count:i}),k.createElement("div",{className:this._classNames.dropIcon},k.createElement(C.Icon,{iconName:"Tag"})),k.createElement("button",S.__assign({type:"button",className:this._classNames.expand,onClick:this._onToggleCollapse},h),k.createElement(C.Icon,{className:this._classNames.expandIsCollapsed,iconName:"ChevronDown"})),c(this.props,this._onRenderTitle),v&&k.createElement(T.Spinner,{label:n}))):null};e.defaultProps={expandButtonProps:{"aria-label":"expand collapse group"}};return e}(i.BaseComponent);t.GroupHeaderBase=o});define("office-ui-fabric-react/lib/Check",["require","exports","tslib","./components/Check/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/Check/index",["require","exports","tslib","./Check","./Check.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/Check/Check",["require","exports","../../Utilities","./Check.base","./Check.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Check=i.styled(o.CheckBase,r.getStyles,void 0,{scope:"Check"})});define("office-ui-fabric-react/lib/components/Check/Check.base",["require","exports","tslib","react","../../Utilities","../../Icon","./Check.styles","../../Utilities"],function(e,t,i,n,o,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r.classNamesFunction(),d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.shouldComponentUpdate=function(e){return this.props.checked!==e.checked||this.props.theme!==e.theme||this.props.className!==e.className};t.prototype.render=function(){var e=this.props,t=e.checked,i=e.className,o=e.theme,r=l(s.getStyles,{theme:o,className:i,checked:t});return n.createElement("div",{className:r.root},n.createElement(a.Icon,{iconName:"CircleRing",className:r.circle}),n.createElement(a.Icon,{iconName:"StatusCircleCheckmark",className:r.check}))};t.defaultProps={checked:!1};return t}(o.BaseComponent);t.CheckBase=d});define("office-ui-fabric-react/lib/components/Check/Check.styles",["require","exports","../../Styling"],function(e,t,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check"};t.getStyles=function(e){var t,i,o,r,n=e.checkBoxHeight,a=void 0===n?"18px":n,s=e.checked,l=e.className,d=e.theme,c=d.palette,p=d.semanticColors,u=m.getGlobalClassNames(g,d),h={fontSize:a,position:"absolute",left:0,top:0,width:a,height:a,textAlign:"center",verticalAlign:"middle"};return{root:[u.root,{lineHeight:"1",width:a,height:a,verticalAlign:"top",position:"relative",userSelect:"none",selectors:{":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:p.bodyBackground},"$checkHost:hover &, $checkHost:focus &, &:hover, &:focus":{opacity:1}}},s&&["is-checked",{selectors:{":before":{background:c.themePrimary,opacity:1,selectors:(t={},t[m.HighContrastSelector]={background:"Window"},t)}}}],l],circle:[u.circle,h,{color:c.neutralTertiaryAlt,selectors:(i={},i[m.HighContrastSelector]={color:"WindowText"},i)},s&&{color:c.white}],check:[u.check,h,{opacity:0,color:c.neutralTertiaryAlt,fontSize:"16px",left:".5px",selectors:(o={":hover":{opacity:1}},o[m.HighContrastSelector]={MsHighContrastAdjust:"none"},o)},s&&{opacity:1,color:c.white,fontWeight:900,selectors:(r={},r[m.HighContrastSelector]={border:"none",color:"WindowText"},r)}],checkHost:[{}]}}});define("office-ui-fabric-react/lib/components/GroupedList/GroupShowAll",["require","exports","../../Utilities","./GroupShowAll.styles","./GroupShowAll.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupShowAll=i.styled(r.GroupShowAllBase,o.getStyles,void 0,{scope:"GroupShowAll"})});define("office-ui-fabric-react/lib/components/GroupedList/GroupShowAll.styles",["require","exports","../../Styling"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={root:"ms-GroupShowAll",link:"ms-Link"};t.getStyles=function(e){var t,i=e.theme,o=r.getGlobalClassNames(n,i);return{root:[o.root,{position:"relative",padding:"10px 84px",cursor:"pointer",selectors:(t={},t["."+o.link]={fontSize:r.FontSizes.small},t)}]}}});define("office-ui-fabric-react/lib/components/GroupedList/GroupShowAll.base",["require","exports","tslib","react","../../Utilities","../../Link","./GroupSpacer"],function(e,t,i,s,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o.classNamesFunction(),r=function(e){i.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSummarizeClick=function(e){t.props.onToggleSummarize(t.props.group);e.stopPropagation();e.preventDefault()};return t}t.prototype.render=function(){var e=this.props,t=e.group,i=e.groupLevel,o=e.showAllLinkText,r=e.styles,n=e.theme,a=c(r,{theme:n});return t?s.createElement("div",{className:a.root},s.createElement(d.GroupSpacer,{count:i}),s.createElement(l.Link,{onClick:this._onSummarizeClick},o)):null};t.defaultProps={showAllLinkText:"Show All"};return t}(o.BaseComponent);t.GroupShowAllBase=r});define("office-ui-fabric-react/lib/components/GroupedList/GroupFooter",["require","exports","../../Utilities","./GroupFooter.styles","./GroupFooter.base"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupFooter=i.styled(r.GroupFooterBase,o.getStyles,void 0,{scope:"GroupFooter"})});define("office-ui-fabric-react/lib/components/GroupedList/GroupFooter.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={root:"ms-groupFooter",link:"ms-Link"};t.getStyles=function(e){var t,i=e.theme,o=e.className,r=n.getGlobalClassNames(a,i);return{root:[r.root,{position:"relative",padding:"5px 38px",selectors:(t={},t[":global(."+r.link]={fontSize:n.FontSizes.small},t)},o]}}});define("office-ui-fabric-react/lib/components/GroupedList/GroupFooter.base",["require","exports","tslib","react","../../Utilities","./GroupSpacer"],function(e,t,i,l,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o.classNamesFunction(),r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.group,i=e.groupLevel,o=e.footerText,r=e.indentWidth,n=e.styles,a=e.theme,s=c(n,{theme:a});return t&&o?l.createElement("div",{className:s.root},l.createElement(d.GroupSpacer,{indentWidth:r,count:i}),o):null};return t}(o.BaseComponent);t.GroupFooterBase=r});define("office-ui-fabric-react/lib/List",["require","exports","tslib","./components/List/index"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/components/List/index",["require","exports","tslib","./List","./List.types"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);i.__exportStar(r,t)});define("office-ui-fabric-react/lib/components/List/List",["require","exports","tslib","react","../../Utilities"],function(e,t,P,u,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},i=function(e){return e.getBoundingClientRect()},c=i,b=i,o=function(t){P.__extends(e,t);function e(e){var p=t.call(this,e)||this;p._root=w.createRef();p._surface=w.createRef();p._onRenderPage=function(e,t){var i=p.props,r=i.onRenderCell,o=i.role,n=e.page,a=n.items,s=n.startIndex,l=P.__rest(e,["page"]),d=void 0===o?"listitem":"presentation",c=(a||[]).map(function(e,t){var i=s+t,o=p.props.getKey?p.props.getKey(e,i):e&&e.key;null==o&&(o=i);return u.createElement("div",{role:d,className:w.css("ms-List-cell"),key:o,"data-list-index":i,"data-automationid":"ListCell"},r&&r(e,i,p.state.isScrolling))});return u.createElement("div",P.__assign({},l),c)};p.state={pages:[],isScrolling:!1};p._estimatedPageHeight=0;p._totalEstimates=0;p._requiredWindowsAhead=0;p._requiredWindowsBehind=0;p._measureVersion=0;p._onAsyncScroll=p._async.debounce(p._onAsyncScroll,100,{leading:!1,maxWait:500});p._onAsyncIdle=p._async.debounce(p._onAsyncIdle,200,{leading:!1});p._onAsyncResize=p._async.debounce(p._onAsyncResize,16,{leading:!1});p._onScrollingDone=p._async.debounce(p._onScrollingDone,500,{leading:!1});p._cachedPageHeights={};p._estimatedPageHeight=0;p._focusedIndex=-1;p._pageCache={};return p}e.prototype.scrollToIndex=function(e,t,i){void 0===i&&(i=0);for(var o=this.props.startIndex,r=o+this._getRenderCount(),n=this._allowedRect,a=0,s=1,l=o;l<r;l+=s){var d=this._getPageSpecification(l,n),c=d.height;s=d.itemCount;if(l<=e&&e<l+s){if(t){for(var p=b(this._scrollElement),u=this._scrollElement.scrollTop,h=this._scrollElement.scrollTop+p.height,m=e-l,g=0;g<m;++g)a+=t(l+g);var f=a+t(e);switch(i){case 1:this._scrollElement.scrollTop=a;return;case 2:this._scrollElement.scrollTop=f-p.height;return;case 3:this._scrollElement.scrollTop=(a+f-p.height)/2;return}if(u<=a&&f<=h)return;a<u||h<f&&(a=f-p.height)}this._scrollElement.scrollTop=a;return}a+=c}};e.prototype.getStartItemIndexInView=function(e){for(var t=0,i=this.state.pages||[];t<i.length;t++){var o=i[t];if(!o.isSpacer&&(this._scrollTop||0)>=o.top&&(this._scrollTop||0)<=o.top+o.height){if(!e){var r=Math.floor(o.height/o.itemCount);return o.startIndex+Math.floor((this._scrollTop-o.top)/r)}for(var n=0,a=o.startIndex;a<o.startIndex+o.itemCount;a++){r=e(a);if(o.top+n<=this._scrollTop&&this._scrollTop<o.top+n+r)return a;n+=r}}}return 0};e.prototype.componentDidMount=function(){this._updatePages();this._measureVersion++;this._scrollElement=w.findScrollableParent(this._root.current);this._events.on(window,"resize",this._onAsyncResize);this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0);if(this._scrollElement){this._events.on(this._scrollElement,"scroll",this._onScroll);this._events.on(this._scrollElement,"scroll",this._onAsyncScroll)}};e.prototype.componentWillReceiveProps=function(e){if(e.items!==this.props.items||e.renderCount!==this.props.renderCount||e.startIndex!==this.props.startIndex){this._resetRequiredWindows();this._requiredRect=null;this._measureVersion++;this._invalidatePageCache();this._updatePages(e)}};e.prototype.shouldComponentUpdate=function(e,t){var i=this.state.pages,o=t.pages,r=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.items===this.props.items&&i.length===o.length)for(var n=0;n<i.length;n++){var a=i[n],s=o[n];if(a.key!==s.key||a.itemCount!==s.itemCount){r=!0;break}}else r=!0;return r};e.prototype.forceUpdate=function(){this._invalidatePageCache();this._updateRenderRects(this.props,!0);this._updatePages();this._measureVersion++;t.prototype.forceUpdate.call(this)};e.prototype.render=function(){for(var e=this.props,t=e.className,i=e.role,o=this.state.pages,r=void 0===o?[]:o,n=[],a=w.getNativeProps(this.props,w.divProperties),s=0,l=r;s<l.length;s++){var d=l[s];n.push(this._renderPage(d))}return u.createElement("div",P.__assign({ref:this._root},a,{role:void 0===i?"list":i,className:w.css("ms-List",t)}),u.createElement("div",{ref:this._surface,className:w.css("ms-List-surface"),role:"presentation"},n))};e.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)};e.prototype._invalidatePageCache=function(){this._pageCache={}};e.prototype._renderPage=function(e){var t,i=this.props.usePageCache;if(i&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var o=this._getPageStyle(e),r=this.props.onRenderPage,n=(void 0===r?this._onRenderPage:r)({page:e,className:w.css("ms-List-page"),key:e.key,ref:e.key,style:o,role:"presentation"},this._onRenderPage);i&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:n});return n};e.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return P.__assign({},t?t(e):{},e.items?{}:{height:e.height})};e.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var i=t.getAttribute("data-list-index");if(i){this._focusedIndex=Number(i);break}t=w.getParent(t)}};e.prototype._onScroll=function(){this.state.isScrolling||this.setState({isScrolling:!0});this._resetRequiredWindows();this._onScrollingDone()};e.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0;this._requiredWindowsBehind=0};e.prototype._onAsyncScroll=function(){this._updateRenderRects();this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this._updatePages();var e,t};e.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,i=e.renderedWindowsBehind,o=this._requiredWindowsAhead,r=this._requiredWindowsBehind,n=Math.min(t,o+1),a=Math.min(i,r+1);if(n!==o||a!==r){this._requiredWindowsAhead=n;this._requiredWindowsBehind=a;this._updateRenderRects();this._updatePages()}(n<t||a<i)&&this._onAsyncIdle()};e.prototype._onScrollingDone=function(){this.setState({isScrolling:!1})};e.prototype._onAsyncResize=function(){this.forceUpdate()};e.prototype._updatePages=function(e){var t=this;void 0===e&&(e=this.props);this._requiredRect||this._updateRenderRects(e);var i=this._buildPages(e),o=this.state.pages;this._notifyPageChanges(o,i.pages);this.setState(i,function(){if(e.getPageHeight)t._onAsyncIdle();else{if(t._updatePageMeasurements(i.pages)){t._materializedRect=null;if(t._hasCompletedFirstRender)t._onAsyncScroll();else{t._hasCompletedFirstRender=!0;t._updatePages(e)}}else t._onAsyncIdle()}})};e.prototype._notifyPageChanges=function(e,t,i){void 0===i&&(i=this.props);var o=i.onPageAdded,r=i.onPageRemoved;if(o||r){for(var n={},a=0,s=e;a<s.length;a++){(c=s[a]).items&&(n[c.startIndex]=c)}for(var l=0,d=t;l<d.length;l++){var c;(c=d[l]).items&&(n[c.startIndex]?delete n[c.startIndex]:this._onPageAdded(c))}for(var p in n)n.hasOwnProperty(p)&&this._onPageRemoved(n[p])}};e.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var i=0;i<e.length;i++){var o=e[i];o.items&&(t=this._measurePage(o)||t)}return t};e.prototype._measurePage=function(e){var t=!1,i=this.refs[e.key],o=this._cachedPageHeights[e.startIndex];if(i&&this._shouldVirtualize()&&(!o||o.measureVersion!==this._measureVersion)){var r={width:i.clientWidth,height:i.clientHeight};if(r.height||r.width){t=e.height!==r.height;e.height=r.height;this._cachedPageHeights[e.startIndex]={height:r.height,measureVersion:this._measureVersion};this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+r.height)/(this._totalEstimates+1));this._totalEstimates++}}return t};e.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)};e.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)};e.prototype._buildPages=function(e){var t=e.renderCount,p=e.items,u=e.startIndex,i=e.getPageHeight;t=this._getRenderCount(e);for(var h=P.__assign({},n),m=[],g=1,f=0,b=null,y=this._focusedIndex,v=u+t,x=this._shouldVirtualize(e),_=0===this._estimatedPageHeight&&!i,S=this._allowedRect,o=function(t){var e=k._getPageSpecification(t,S),i=e.height,o=e.data,r=e.key;g=e.itemCount;var n=f+i-1,a=-1<w.findIndex(k.state.pages,function(e){return!!e.items&&e.startIndex===t}),s=!S||n>=S.top&&f<=S.bottom,l=!k._requiredRect||n>=k._requiredRect.top&&f<=k._requiredRect.bottom;if(!_&&(l||s&&a)||!x||t<=y&&y<t+g||t===u){if(b){m.push(b);b=null}var d=Math.min(g,v-t),c=k._createPage(r,p.slice(t,t+d),t,void 0,void 0,o);c.top=f;c.height=i;m.push(c);l&&k._allowedRect&&function(e,t){e.top=t.top<e.top||-1===e.top?t.top:e.top;e.left=t.left<e.left||-1===e.left?t.left:e.left;e.bottom=t.bottom>e.bottom||-1===e.bottom?t.bottom:e.bottom;e.right=t.right>e.right||-1===e.right?t.right:e.right;e.width=e.right-e.left+1;e.height=e.bottom-e.top+1}(h,{top:f,bottom:n,height:i,left:S.left,right:S.right,width:S.width})}else{b||(b=k._createPage("spacer-"+t,void 0,t,0,void 0,o,!0));b.height=(b.height||0)+(n-f)+1;b.itemCount+=g}f+=n-f+1;if(_&&x)return"break"},k=this,r=u;r<v;r+=g){if("break"===o(r))break}if(b){b.key="spacer-end";m.push(b)}this._materializedRect=h;return{pages:m,measureVersion:this._measureVersion}};e.prototype._getPageSpecification=function(e,t){var i=this.props.getPageSpecification;if(i){var o=i(e,t),r=o.itemCount,n=void 0===r?this._getItemCountForPage(e,t):r,a=o.height;return{itemCount:n,height:void 0===a?this._getPageHeight(e,n,t):a,data:o.data,key:o.key}}return{itemCount:n=this._getItemCountForPage(e,t),height:this._getPageHeight(e,n,t)}};e.prototype._getPageHeight=function(e,t,i){if(this.props.getPageHeight)return this.props.getPageHeight(e,i);var o=this._cachedPageHeights[e];return o?o.height:this._estimatedPageHeight||30};e.prototype._getItemCountForPage=function(e,t){var i=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return i||10};e.prototype._createPage=function(e,t,i,o,r,n,a){void 0===i&&(i=-1);void 0===o&&(o=t?t.length:0);void 0===r&&(r={});void 0===n&&(n=void 0);e=e||"page-"+i;var s=this._pageCache[e];if(s&&s.page)return s.page;if(t)for(var l=0;l<t.length;l++)t[l]=t[l]||void 0;return{key:e,startIndex:i,itemCount:o,items:t,style:r||{},top:0,height:0,data:n,isSpacer:a||!1}};e.prototype._getRenderCount=function(e){var t=e||this.props,i=t.items,o=t.startIndex,r=t.renderCount;return void 0===r?i?i.length-o:0:r};e.prototype._updateRenderRects=function(e,t){var i=(e=e||this.props).renderedWindowsAhead,o=e.renderedWindowsBehind,r=this.state.pages;if(this._shouldVirtualize(e)){var n=this._surfaceRect,a=this._scrollElement&&this._scrollElement.scrollHeight,s=this._scrollElement?this._scrollElement.scrollTop:0;if(this._surface.current&&(t||!r||!this._surfaceRect||!a||a!==this._scrollHeight||Math.abs(this._scrollTop-s)>this._estimatedPageHeight/3)){n=this._surfaceRect=c(this._surface.current);this._scrollTop=s}!t&&a&&a===this._scrollHeight||this._measureVersion++;this._scrollHeight=a;var l=Math.max(0,-n.top),d={top:l,left:n.left,bottom:l+window.innerHeight,right:n.right,width:n.width,height:window.innerHeight};this._requiredRect=p(d,this._requiredWindowsBehind,this._requiredWindowsAhead);this._allowedRect=p(d,o,i)}};e.defaultProps={startIndex:0,onRenderCell:function(e,t,i){return u.createElement("div",null,e&&e.name||"")},renderedWindowsAhead:2,renderedWindowsBehind:2};return e}(w.BaseComponent);t.List=o;function p(e,t,i){var o=e.top-t*e.height,r=e.height+(t+i)*e.height;return{top:o,bottom:o+r,height:r,left:e.left,right:e.right,width:e.width}}});define("office-ui-fabric-react/lib/components/List/List.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.auto=0]="auto";e[e.top=1]="top";e[e.bottom=2]="bottom";e[e.center=3]="center"}(t.ScrollToMode||(t.ScrollToMode={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck",["require","exports","tslib","react","../../Utilities","../../Check","../Check/Check.styles","./DetailsRowCheck.styles","../../Utilities"],function(e,t,f,b,y,v,x,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=o.classNamesFunction(),S=o.classNamesFunction();t.DetailsRowCheck=y.styled(function(e){var t=e.canSelect,i=void 0!==t&&t,o=(e.isSelected,e.anySelected),r=void 0!==o&&o,n=(e.selected,e.isHeader),a=void 0!==n&&n,s=e.className,l=(e.checkClassName,e.styles),d=e.theme,c=e.compact,p=f.__rest(e,["canSelect","isSelected","anySelected","selected","isHeader","className","checkClassName","styles","theme","compact"]),u=e.isSelected||e.selected,h=x.getStyles({theme:d}),m=_(h,{theme:d}),g=S(l,{theme:d,canSelect:i,selected:u,anySelected:r,className:s,isHeader:a,compact:c});return b.createElement("div",f.__assign({},p,{role:"checkbox",className:y.css(g.root,g.check,m.checkHost),"aria-checked":u,"data-selection-toggle":!0,"data-automationid":"DetailsRowCheck"}),b.createElement(v.Check,{checked:u}))},i.getStyles,void 0,{scope:"DetailsRowCheck"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={root:"ms-DetailsRow-check",isDisabled:"ms-DetailsRow-check--isDisabled",isHeader:"ms-DetailsRow-check--isHeader"};t.getStyles=function(e){var t=e.theme,i=e.className,o=e.isHeader,r=e.selected,n=e.anySelected,a=e.canSelect,s=e.compact,l=c.getGlobalClassNames(p,t),d=r||n;return{root:[l.root,!a&&[l.isDisabled,{visibility:"hidden"}],o&&l.isHeader,d&&{opacity:1},i],check:[c.getFocusStyle(t),{display:"flex",alignItems:"center",justifyContent:"center",cursor:"default",boxSizing:"border-box",verticalAlign:"top",background:"none",backgroundColor:"transparent",border:"none",opacity:0,height:s||o?32:40,width:40,padding:0,margin:0,selectors:{"&:hover":{opacity:1}}},(r||n||d)&&{opacity:1}],isDisabled:[]}}});define("office-ui-fabric-react/lib/utilities/dragdrop/index",["require","exports","tslib","./DragDropHelper"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("office-ui-fabric-react/lib/utilities/dragdrop/DragDropHelper",["require","exports","react-dom","../../Utilities"],function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._selection=e.selection;this._dragEnterCounts={};this._activeTargets={};this._lastId=0;this._events=new a.EventGroup(this);this._events.on(document.body,"mouseup",this._onMouseUp.bind(this),!0);this._events.on(document,"mouseup",this._onDocumentMouseUp.bind(this),!0)}e.prototype.dispose=function(){this._events.dispose()};e.prototype.subscribe=function(o,r,t){var n,a,s,l,d,c,p,u,h,m,g=this,e=t.key,f=void 0===e?""+ ++this._lastId:e,b=[];if(t&&o){var i=t.eventMap,y=t.context,v=t.updateDropState,x={root:o,options:t,key:f};u=this._isDraggable(x);h=this._isDroppable(x);if((u||h)&&i)for(var _=0,S=i;_<S.length;_++){var k=S[_],P={callback:k.callback.bind(null,y),eventName:k.eventName};b.push(P);this._events.on(o,P.eventName,P.callback)}if(h){a=function(e){if(!e.isHandled){e.isHandled=!0;g._dragEnterCounts[f]--;0===g._dragEnterCounts[f]&&v(!1,e)}};s=function(e){e.preventDefault();if(!e.isHandled){e.isHandled=!0;g._dragEnterCounts[f]++;1===g._dragEnterCounts[f]&&v(!0,e)}};l=function(e){g._dragEnterCounts[f]=0;v(!1,e)};d=function(e){g._dragEnterCounts[f]=0;v(!1,e);t.onDrop&&t.onDrop(t.context.data,e)};c=function(e){e.preventDefault();t.onDragOver&&t.onDragOver(t.context.data,e)};this._dragEnterCounts[f]=0;r.on(o,"dragenter",s);r.on(o,"dragleave",a);r.on(o,"dragend",l);r.on(o,"drop",d);r.on(o,"dragover",c)}if(u){p=this._onMouseDown.bind(this,x);l=this._onDragEnd.bind(this,x);n=function(e){var t=g._dragData.dragTarget.options;t&&t.onDragStart&&t.onDragStart(t.context.data,t.context.index,g._selection.getSelection(),e);g._isDragging=!0;e.dataTransfer.setData("id",o.id)};r.on(o,"dragstart",n);r.on(o,"mousedown",p);r.on(o,"dragend",l)}m={target:x,dispose:function(){g._activeTargets[f]===m&&delete g._activeTargets[f];if(o){for(var e=0,t=b;e<t.length;e++){var i=t[e];g._events.off(o,i.eventName,i.callback)}if(h){r.off(o,"dragenter",s);r.off(o,"dragleave",a);r.off(o,"dragend",l);r.off(o,"dragover",c);r.off(o,"drop",d)}if(u){r.off(o,"dragstart",n);r.off(o,"mousedown",p);r.off(o,"dragend",l)}}}};this._activeTargets[f]=m}return{key:f,dispose:function(){m&&m.dispose()}}};e.prototype.unsubscribe=function(e,t){var i=this._activeTargets[t];i&&i.dispose()};e.prototype._onDragEnd=function(e,t){var i=e.options;i.onDragEnd&&i.onDragEnd(i.context.data,t)};e.prototype._onMouseUp=function(e){this._isDragging=!1;if(this._dragData){for(var t=0,i=Object.keys(this._activeTargets);t<i.length;t++){var o=i[t],r=this._activeTargets[o];if(r.target.root){this._events.off(r.target.root,"mousemove");this._events.off(r.target.root,"mouseleave")}}if(this._dragData.dropTarget){a.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");a.EventGroup.raise(this._dragData.dropTarget.root,"drop")}}this._dragData=null};e.prototype._onDocumentMouseUp=function(e){e.target===document.documentElement&&this._onMouseUp(e)};e.prototype._onMouseMove=function(e,t){var i=t.buttons,o=void 0===i?1:i;if(this._dragData&&1!==o)this._onMouseUp(t);else{var r=e.root,n=e.key;if(this._isDragging&&this._isDroppable(e)&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key!==n&&!this._isChild(r,this._dragData.dropTarget.root)&&0<this._dragEnterCounts[this._dragData.dropTarget.key]){a.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");a.EventGroup.raise(r,"dragenter");this._dragData.dropTarget=e}}};e.prototype._onMouseLeave=function(e,t){if(this._isDragging&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key===e.key){a.EventGroup.raise(e.root,"dragleave");this._dragData.dropTarget=void 0}};e.prototype._onMouseDown=function(e,t){if(0===t.button)if(this._isDraggable(e)){this._dragData={clientX:t.clientX,clientY:t.clientY,eventTarget:t.target,dragTarget:e};for(var i=0,o=Object.keys(this._activeTargets);i<o.length;i++){var r=o[i],n=this._activeTargets[r];if(n.target.root){this._events.on(n.target.root,"mousemove",this._onMouseMove.bind(this,n.target));this._events.on(n.target.root,"mouseleave",this._onMouseLeave.bind(this,n.target))}}}else this._dragData=null};e.prototype._isChild=function(e,t){for(var i=r.findDOMNode(e),o=r.findDOMNode(t);o&&o.parentElement;){if(o.parentElement===i)return!0;o=o.parentElement}return!1};e.prototype._isDraggable=function(e){var t=e.options;return!(!t.canDrag||!t.canDrag(t.context.data))};e.prototype._isDroppable=function(e){var t=e.options,i=this._dragData&&this._dragData.dragTarget?this._dragData.dragTarget.options.context:void 0;return!(!t.canDrop||!t.canDrop(t.context,i))};return e}();t.DragDropHelper=i});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn",["require","exports","../../Utilities","./DetailsColumn.base","./DetailsColumn.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsColumn=i.styled(o.DetailsColumnBase,r.getStyles,void 0,{scope:"DetailsColumn"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn.base",["require","exports","tslib","react","../../Icon","../../Utilities","./DetailsList.types","./DetailsRow.styles"],function(e,t,o,u,h,r,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.classNamesFunction(),i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._onRenderColumnHeaderTooltip=function(e,t){return u.createElement("span",{className:e.hostClassName},e.children)};t._onRootMouseDown=function(e){t.props.isDraggable&&0===e.button&&e.stopPropagation()};t._root=r.createRef();t._onDragStart=t._onDragStart.bind(t);t._onDragEnd=t._onDragEnd.bind(t);t._onRootMouseDown=t._onRootMouseDown.bind(t);t._updateHeaderDragInfo=t._updateHeaderDragInfo.bind(t);return t}e.prototype.render=function(){var e=this.props,t=e.column,i=e.columnIndex,o=e.parentId,r=e.isDraggable,n=e.styles,a=e.theme,s=e.cellStyleProps,l=void 0===s?g.DEFAULT_CELL_STYLE_PROPS:s,d=this.props.onRenderColumnHeaderTooltip,c=void 0===d?this._onRenderColumnHeaderTooltip:d;this._classNames=f(n,{theme:a,headerClassName:t.headerClassName,iconClassName:t.iconClassName,isActionable:t.columnActionsMode!==m.ColumnActionsMode.disabled,isEmpty:!t.name,isIconVisible:t.isSorted||t.isGrouped||t.isFiltered,isPadded:t.isPadded,isIconOnly:t.isIconOnly,cellStyleProps:l});var p=this._classNames;return u.createElement(u.Fragment,null,u.createElement("div",{key:t.key,ref:this._root,role:"columnheader","aria-sort":t.isSorted?t.isSortedDescending?"descending":"ascending":"none","aria-colindex":i,className:p.root,"data-is-draggable":r,draggable:r,style:{width:t.calculatedWidth+l.cellLeftPadding+l.cellRightPadding+(t.isPadded?l.cellExtraRightPadding:0)},"data-automationid":"ColumnsHeaderColumn","data-item-key":t.key},r&&u.createElement(h.Icon,{iconName:"GripperBarVertical",className:p.gripperBarVerticalStyle}),c({hostClassName:p.cellTooltip,id:o+"-"+t.key+"-tooltip",setAriaDescribedBy:!1,content:t.columnActionsMode!==m.ColumnActionsMode.disabled?t.ariaLabel:"",children:u.createElement("span",{id:o+"-"+t.key,"aria-label":t.isIconOnly?t.name:void 0,"aria-labelledby":t.isIconOnly?void 0:o+"-"+t.key+"-name ",className:p.cellTitle,"data-is-focusable":t.columnActionsMode!==m.ColumnActionsMode.disabled,role:t.columnActionsMode!==m.ColumnActionsMode.disabled?"button":void 0,"aria-describedby":this.props.onRenderColumnHeaderTooltip||this._hasAccessibleLabel()?o+"-"+t.key+"-tooltip":void 0,onContextMenu:this._onColumnContextMenu.bind(this,t),onClick:this._onColumnClick.bind(this,t),"aria-haspopup":t.columnActionsMode===m.ColumnActionsMode.hasDropdown},u.createElement("span",{id:o+"-"+t.key+"-name",className:p.cellName},(t.iconName||t.iconClassName)&&u.createElement(h.Icon,{className:p.iconClassName,iconName:t.iconName}),t.isIconOnly?u.createElement("span",{className:p.accessibleLabel},t.name):t.name),t.isFiltered&&u.createElement(h.Icon,{className:p.nearIcon,iconName:"Filter"}),t.isSorted&&u.createElement(h.Icon,{className:p.sortIcon,iconName:t.isSortedDescending?"SortDown":"SortUp"}),t.isGrouped&&u.createElement(h.Icon,{className:p.nearIcon,iconName:"GroupedDescending"}),t.columnActionsMode===m.ColumnActionsMode.hasDropdown&&!t.isIconOnly&&u.createElement(h.Icon,{"aria-hidden":!0,className:p.filterChevron,iconName:"ChevronDown"}))},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:this._renderAccessibleLabel())};e.prototype.componentDidMount=function(){var e=this;if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}if(this.props.dragDropHelper&&this.props.isDraggable){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getColumnDragDropOptions());this._events.on(this._root.current,"mousedown",this._onRootMouseDown)}var t=this._classNames;if(this.props.isDropped){this._root.current&&this._root.current.classList.add(t.borderAfterDropping);setTimeout(function(){e._root.current&&e._root.current.classList.remove(t.borderAfterDropping)},1500)}};e.prototype.componentWillUnmount=function(){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}};e.prototype.componentDidUpdate=function(){if(!this._dragDropSubscription&&this.props.dragDropHelper&&this.props.isDraggable){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.value,this._events,this._getColumnDragDropOptions());this._events.on(this._root.current,"mousedown",this._onRootMouseDown)}if(this._dragDropSubscription&&!this.props.isDraggable){this._dragDropSubscription.dispose();this._events.off(this._root.current,"mousedown");delete this._dragDropSubscription}};e.prototype._onColumnClick=function(e,t){var i=this.props.onColumnClick;e.onColumnClick&&e.onColumnClick(t,e);i&&i(t,e)};e.prototype._getColumnDragDropOptions=function(){var e=this,t=this.props.columnIndex;return{selectionIndex:t,context:{data:t,index:t},canDrag:function(){return e.props.isDraggable},canDrop:function(){return!1},onDragStart:this._onDragStart,updateDropState:function(){},onDrop:function(){},onDragEnd:this._onDragEnd}};e.prototype._hasAccessibleLabel=function(){var e=this.props.column;return!!(e.ariaLabel||e.filterAriaLabel||e.sortAscendingAriaLabel||e.sortDescendingAriaLabel||e.groupAriaLabel)};e.prototype._renderAccessibleLabel=function(){var e=this.props,t=e.column,i=e.parentId,o=this._classNames;return this._hasAccessibleLabel()&&!this.props.onRenderColumnHeaderTooltip?u.createElement("label",{key:t.key+"_label",id:i+"-"+t.key+"-tooltip",className:o.accessibleLabel},t.ariaLabel,t.isFiltered&&t.filterAriaLabel||null,t.isSorted&&(t.isSortedDescending?t.sortDescendingAriaLabel:t.sortAscendingAriaLabel)||null,t.isGrouped&&t.groupAriaLabel||null):null};e.prototype._onDragStart=function(e,t,i,o){var r=this._classNames;if(t){this._updateHeaderDragInfo(t);this._root.current.classList.add(r.borderWhileDragging)}};e.prototype._onDragEnd=function(e,t){var i=this._classNames;this._root.current.classList.remove(i.borderWhileDragging)};e.prototype._updateHeaderDragInfo=function(e,t){this.props.setDraggedItemIndex&&this.props.setDraggedItemIndex(e);this.props.updateDragInfo&&this.props.updateDragInfo({itemIndex:e},t)};e.prototype._onColumnContextMenu=function(e,t){var i=this.props.onColumnContextMenu;if(e.onColumnContextMenu){e.onColumnContextMenu(e,t);t.preventDefault()}if(i){i(e,t);t.preventDefault()}};return e}(r.BaseComponent);t.DetailsColumnBase=i});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow.styles",["require","exports","tslib","../../Styling"],function(e,z,t,U){"use strict";Object.defineProperty(z,"__esModule",{value:!0});var W={root:"ms-DetailsRow",compact:"ms-DetailsList--Compact",cell:"ms-DetailsRow-cell",cellCheck:"ms-DetailsRow-cellCheck",cellMeasurer:"ms-DetailsRow-cellMeasurer",listCellFirstChild:"ms-List-cell:first-child",isFocusable:"[data-is-focusable='true']",isContentUnselectable:"is-contentUnselectable",isSelected:"is-selected",isCheckVisible:"is-check-visible",fields:"ms-DetailsRow-fields"};z.DEFAULT_CELL_STYLE_PROPS={cellLeftPadding:12,cellRightPadding:8,cellExtraRightPadding:24};var q={rowHeight:42,compactRowHeight:32,rowVerticalPadding:11,compactRowVerticalPadding:6,rowShimmerLineHeight:7,rowShimmerIconPlaceholderHeight:16,rowShimmerVerticalBorder:0,compactRowShimmerVerticalBorder:0};q=t.__assign({},q,{rowShimmerVerticalBorder:(q.rowHeight-q.rowShimmerLineHeight)/2,compactRowShimmerVerticalBorder:(q.compactRowHeight-q.rowShimmerLineHeight)/2});z.getStyles=function(e){var t,i,o,r,n,a,s,l,d,c=e.theme,p=e.isSelected,u=e.canSelect,h=e.droppingClassName,m=e.anySelected,g=e.isCheckVisible,f=e.checkboxCellClassName,b=e.compact,y=e.className,v=e.cellStyleProps,x=void 0===v?z.DEFAULT_CELL_STYLE_PROPS:v,_=c.palette,S=_.neutralPrimary,k=_.neutralSecondaryAlt,P=_.white,w=_.neutralSecondary,C=_.neutralLighter,I=_.neutralLight,T=_.neutralDark,D=_.neutralQuaternaryAlt,L=_.black,E=_.themePrimary,M=U.getGlobalClassNames(W,c),A={defaultHeaderTextColor:S,defaultMetaTextColor:k,defaultBackgroundColor:P,hoverTextColor:S,hoverMetaTextColor:w,hoverColorBackground:C,selectedTextColor:T,selectedMetaTextColor:S,selectedBackgroundColor:I,selectedHoverTextColor:L,selectedHoverMetaTextColor:T,selectedHoverBackgroundColor:D,focusHeaderTextColor:L,focusBackgroundColor:D,focusMetaTextColor:T},F=4*x.cellRightPadding+"px solid "+A.defaultBackgroundColor,R=x.cellLeftPadding+"px solid "+A.defaultBackgroundColor,O=[U.getFocusStyle(c,-1,void 0,void 0,E,P),M.isSelected,{color:A.selectedMetaTextColor,background:A.selectedBackgroundColor,borderBottom:"1px solid "+P,selectors:{"&:before":{position:"absolute",display:"block",top:-1,height:1,bottom:0,left:0,right:0,content:"",borderTop:"1px solid "+P},"&:hover":{background:A.selectedHoverBackgroundColor,selectors:{$cell:{color:A.selectedHoverMetaTextColor,selectors:(t={},t[U.HighContrastSelector]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},t["&.$isRowHeader"]={color:A.selectedHoverTextColor,selectors:(i={},i[U.HighContrastSelector]={color:"HighlightText"},i)},t)}}},"&:focus":{background:A.focusBackgroundColor,selectors:{$cell:(o={color:A.focusMetaTextColor},o[U.HighContrastSelector]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},o["&.$isRowHeader"]={color:A.focusHeaderTextColor,selectors:(r={},r[U.HighContrastSelector]={color:"HighlightText"},r)},o)}}}}],N=[M.isContentUnselectable,{userSelect:"none",cursor:"default"}],B={minHeight:q.compactRowHeight,border:0},H={minHeight:q.compactRowHeight,paddingTop:q.compactRowVerticalPadding,paddingBottom:q.compactRowVerticalPadding,paddingLeft:x.cellLeftPadding+"px",selectors:(n={},n["&$shimmer"]={padding:0,borderLeft:R,borderRight:F,borderTop:q.compactRowShimmerVerticalBorder+"px solid "+A.defaultBackgroundColor,borderBottom:q.compactRowShimmerVerticalBorder+"px solid "+A.defaultBackgroundColor},n["&$shimmerIconPlaceholder"]={borderRight:x.cellRightPadding+"px solid "+A.defaultBackgroundColor,borderBottom:(q.compactRowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+A.defaultBackgroundColor,borderTop:(q.compactRowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+A.defaultBackgroundColor},n)},V=[U.getFocusStyle(c,-1),M.cell,{display:"inline-block",position:"relative",boxSizing:"border-box",minHeight:q.rowHeight,verticalAlign:"top",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingTop:q.rowVerticalPadding,paddingBottom:q.rowVerticalPadding,paddingLeft:x.cellLeftPadding+"px",selectors:(a={"& > button":{maxWidth:"100%"}},a[M.isFocusable]=U.getFocusStyle(c,-1,void 0,void 0,w,P),a["&$shimmer"]={padding:0,borderLeft:R,borderRight:F,borderTop:q.rowShimmerVerticalBorder+"px solid "+A.defaultBackgroundColor,borderBottom:q.rowShimmerVerticalBorder+"px solid "+A.defaultBackgroundColor},a["&$shimmerIconPlaceholder"]={borderRight:x.cellRightPadding+"px solid "+A.defaultBackgroundColor,borderBottom:(q.rowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+A.defaultBackgroundColor,borderTop:(q.rowHeight-q.rowShimmerIconPlaceholderHeight)/2+"px solid "+A.defaultBackgroundColor},a)},p&&{selectors:(s={"&.$isRowHeader":{color:A.selectedTextColor,selectors:(l={},l[U.HighContrastSelector]={color:"HighlightText"},l)}},s[U.HighContrastSelector]={background:"Highlight",color:"HighlightText","-ms-high-contrast-adjust":"none",selectors:{a:{color:"HighlightText"}}},s)},b&&H];return{root:[M.root,U.AnimationClassNames.fadeIn400,h,g&&M.isCheckVisible,U.getFocusStyle(c,0,void 0,void 0,p?w:E,P),{borderBottom:"1px solid "+C,background:A.defaultBackgroundColor,color:A.defaultMetaTextColor,display:"flex",minWidth:"100%",minHeight:q.rowHeight,whiteSpace:"nowrap",padding:0,boxSizing:"border-box",verticalAlign:"top",textAlign:"left",selectors:(d={},d[M.listCellFirstChild+" &:before"]={display:"none"},d["&:hover"]={background:A.hoverColorBackground,color:A.hoverMetaTextColor},d["&:hover $check"]={opacity:1},d)},p&&O,!u&&N,b&&B,y],cellUnpadded:[{paddingRight:x.cellRightPadding+"px"}],cellPadded:[{paddingRight:x.cellExtraRightPadding+x.cellRightPadding+"px",selectors:{"&.$checkCell":{paddingRight:0}}}],cell:V,cellMeasurer:[M.cellMeasurer,{overflow:"visible",whiteSpace:"nowrap"}],checkCell:[V,M.cellCheck,f,{padding:0,paddingTop:1,marginTop:-1,flexShrink:0}],checkCover:[{position:"absolute",top:-1,left:0,bottom:0,right:0,display:"none"},m&&{display:"block"}],fields:[M.fields,{display:"flex",alignItems:"stretch"}],isRowHeader:[{color:A.defaultHeaderTextColor,fontSize:U.FontSizes.medium}],isMultiline:[{whiteSpace:"normal",wordBreak:"break-word",textOverflow:"clip"}],shimmer:[],shimmerIconPlaceholder:[],shimmerLeftBorder:[{borderLeft:"40px solid "+A.defaultBackgroundColor}],shimmerBottomBorder:[{borderBottom:"1px solid "+A.defaultBackgroundColor}],check:[]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsColumn.styles",["require","exports","../../Styling","./DetailsRow.styles","./DetailsHeader.styles"],function(e,t,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={isActionable:"is-actionable",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",isEmpty:"is-empty",isIconVisible:"is-icon-visible",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVerticalStyle:"ms-DetailsColumn-gripperBar"};t.getStyles=function(e){var t=e.theme,i=e.headerClassName,o=e.iconClassName,r=e.isActionable,n=e.isEmpty,a=e.isIconVisible,s=e.isPadded,l=e.isIconOnly,d=e.cellStyleProps,c=void 0===d?y.DEFAULT_CELL_STYLE_PROPS:d,p=t.semanticColors,u=t.palette,h=b.getGlobalClassNames(x,t),m={iconForegroundColor:p.bodySubtext,headerForegroundColor:p.bodyText,headerBackgroundColor:p.bodyBackground,dropdownChevronForegroundColor:u.neutralTertiary,resizerColor:u.neutralTertiaryAlt},g=b.keyframes({from:{borderColor:u.themePrimary},to:{borderColor:"transparent"}}),f={color:m.iconForegroundColor,opacity:1,paddingLeft:8};return{root:[v.getCellStyles(e),i,r&&[h.isActionable,{selectors:{":hover":{color:p.bodyText,background:p.listHeaderBackgroundHovered},":active":{background:p.listHeaderBackgroundPressed}}}],n&&[h.isEmpty,{textOverflow:"clip"}],a&&h.isIconVisible,s&&{paddingRight:c.cellExtraRightPadding+c.cellRightPadding},{selectors:{':hover i[data-icon-name="GripperBarVertical"]':{display:"block"}}}],gripperBarVerticalStyle:[{display:"none",position:"absolute",textAlign:"left",color:u.neutralTertiary,left:1}],nearIcon:f,sortIcon:[f,{paddingLeft:4,position:"relative",top:1}],iconClassName:[f,o],filterChevron:[h.filterChevron,{color:m.dropdownChevronForegroundColor,paddingLeft:4,verticalAlign:"middle"}],cellTitle:[h.cellTitle,b.getFocusStyle(t),{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",boxSizing:"border-box",overflow:"hidden",padding:"0 "+c.cellRightPadding+"px 0 "+c.cellLeftPadding+"px"}],cellName:[h.cellName,{flex:"0 1 auto",overflow:"hidden",textOverflow:"ellipsis"},l&&{selectors:{$nearIcon:{paddingLeft:0}}}],cellTooltip:[{display:"block",position:"absolute",top:0,left:0,bottom:0,right:0}],accessibleLabel:[b.hiddenContentStyle],borderAfterDropping:[{borderStyle:"solid",borderWidth:1,borderColor:u.themePrimary,left:-1,lineHeight:31,animation:g+" 1.5s forwards"}],borderWhileDragging:[{borderStyle:"solid",borderWidth:1,borderColor:u.themePrimary,animation:g+" 0.2s forwards"}]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.styles",["require","exports","../../Styling","../../Utilities","./DetailsRow.styles"],function(e,v,x,_,S){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var k={tooltipHost:"ms-TooltipHost",root:"ms-DetailsHeader",cell:"ms-DetailsHeader-cell",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintCaretStyle:"ms-DetailsHeader-dropHintCaretStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVertical:"ms-DetailsColumn-gripperBarVertical"},P=32;v.getCellStyles=function(e){var t=e.theme,i=e.cellStyleProps,o=void 0===i?S.DEFAULT_CELL_STYLE_PROPS:i,r=t.semanticColors;return[x.getGlobalClassNames(k,t).cell,x.getFocusStyle(t),x.FontClassNames.small,{color:r.bodyText,position:"relative",display:"inline-block;",boxSizing:"border-box",padding:"0 "+o.cellRightPadding+"px 0 "+o.cellLeftPadding+"px",border:"none",lineHeight:"inherit",margin:"0",height:P,verticalAlign:"top",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left"}]};v.getStyles=function(e){var t,i,o,r=e.theme,n=e.className,a=e.isSelectAllHidden,s=e.isAllSelected,l=e.isResizingColumn,d=e.isSizing,c=e.isAllCollapsed,p=e.cellStyleProps,u=void 0===p?S.DEFAULT_CELL_STYLE_PROPS:p,h=r.semanticColors,m=r.palette,g=x.getGlobalClassNames(k,r),f={iconForegroundColor:h.bodySubtext,headerForegroundColor:h.bodyText,headerBackgroundColor:h.bodyBackground,dropdownChevronForegroundColor:m.neutralTertiary,resizerColor:m.neutralTertiaryAlt},b={opacity:1,transition:"opacity 0.3s linear"},y=v.getCellStyles(e);return{root:[g.root,{display:"inline-block",background:f.headerBackgroundColor,position:"relative",minWidth:"100%",verticalAlign:"top",height:P,lineHeight:P,whiteSpace:"nowrap",boxSizing:"content-box",paddingBottom:"1px",borderBottom:"1px solid "+h.bodyDivider,cursor:"default",userSelect:"none",selectors:(t={"&:hover $check":{opacity:1}},t[g.tooltipHost+" $checkTooltip"]={display:"block"},t)},s&&g.isAllSelected,a&&{selectors:{$cell$cellIsCheck:{visibility:"hidden"}}},l&&g.isResizingColumn,n],check:[{height:32},{selectors:(i={},i["."+_.IsFocusVisibleClassName+" &:focus"]={opacity:1},i)}],cellWrapperPadded:[{paddingRight:u.cellExtraRightPadding+u.cellRightPadding}],cellIsCheck:[y,g.cellIsCheck,{position:"relative",padding:0,margin:0,display:"inline-flex",alignItems:"center"},s&&{opacity:1}],cellIsGroupExpander:[y,{paddingLeft:"8px",paddingRight:"8px",width:"36px"}],cellIsActionable:[{selectors:{":hover":{color:h.bodyText,background:h.listHeaderBackgroundHovered},":active":{background:h.listHeaderBackgroundPressed}}}],cellIsEmpty:[{textOverflow:"clip"}],cellSizer:[g.cellSizer,x.focusClear(),{display:"inline-block",position:"relative",cursor:"ew-resize",bottom:0,top:0,overflow:"hidden",height:"inherit",background:"transparent",zIndex:1,width:16,selectors:{":after":{content:'""',position:"absolute",top:0,bottom:0,width:1,background:f.resizerColor,opacity:0,left:"50%"},":focus:after":b,":hover:after":b,"&$cellIsResizing:after":[b,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)"}]}}],cellIsResizing:[g.isResizing],cellSizerStart:[{margin:"0 -8px"}],cellSizerEnd:[{margin:0,marginLeft:-16}],collapseButton:[g.collapseButton,{textAlign:"center",transform:"rotate(-180deg)",transformOrigin:"50% 50%",transition:"transform 0.1s linear",width:20,outline:0,paddingRight:0},c&&{transform:"rotate(0deg)"},c&&g.isCollapsed],checkTooltip:[],sizingOverlay:[d&&{position:"absolute",left:0,top:0,right:0,bottom:0,cursor:"ew-resize",background:"rgba(255, 255, 255, 0)",selectors:(o={},o[x.HighContrastSelector]={background:"transparent","-ms-high-contrast-adjust":"none"},o)}],accessibleLabel:[x.hiddenContentStyle],dropHintCircleStyle:[g.dropHintCircleStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,height:9,width:9,borderRadius:"50%",marginLeft:-5,top:34,overflow:"visible",zIndex:10,border:"1px solid "+m.themePrimary,background:m.white}],dropHintCaretStyle:[g.dropHintCaretStyle,{display:"inline-block",visibility:"hidden",position:"absolute",top:22,left:-7.5,fontSize:16,color:m.themePrimary,overflow:"visible",zIndex:10}],dropHintLineStyle:[g.dropHintLineStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,top:-3,overflow:"hidden",height:37,width:1,background:m.themePrimary,zIndex:10}],dropHintStyle:[{display:"inline-block",position:"absolute"}]}}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.hidden=1]="hidden";e[e.visible=2]="visible"}(t.SelectAllVisibility||(t.SelectAllVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow",["require","exports","../../Utilities","./DetailsRow.base","./DetailsRow.styles"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsRow=i.styled(o.DetailsRowBase,r.getStyles,void 0,{scope:"DetailsRow"})});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow.base",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.types","./DetailsRowCheck","../GroupedList/GroupSpacer","./DetailsRowFields","../../FocusZone","../../utilities/selection/interfaces","../../GroupedList","../../Utilities"],function(e,t,W,q,o,K,j,r,G,$,Y,Z,Q,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var X=i.classNamesFunction(),n=function(i){W.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._cellMeasurer=K.createRef();t._focusZone=K.createRef();t._onRootRef=function(e){t._root=e?o.findDOMNode(e):void 0};t.state={selectionState:t._getSelectionState(e),columnMeasureInfo:void 0,isDropping:!1,groupNestingDepth:e.groupNestingDepth};t._droppingClassNames="";t._updateDroppingState=t._updateDroppingState.bind(t);t._onToggleSelection=t._onToggleSelection.bind(t);return t}e.prototype.componentDidMount=function(){var e=this.props.dragDropHelper;e&&(this._dragDropSubscription=e.subscribe(this._root,this._events,this._getRowDragDropOptions()));this._events.on(this.props.selection,Z.SELECTION_CHANGE,this._onSelectionChanged);if(this.props.onDidMount&&this.props.item){this._hasMounted=!0;this.props.onDidMount(this)}};e.prototype.componentDidUpdate=function(e){var t=this.state,i=this.props,o=i.item,r=i.onDidMount,n=t.columnMeasureInfo;if(this.props.itemIndex!==e.itemIndex||this.props.item!==e.item||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root,this._events,this._getRowDragDropOptions()))}if(n&&0<=n.index&&this._cellMeasurer.current){var a=this._cellMeasurer.current.getBoundingClientRect().width;n.onMeasureDone(a);this.setState({columnMeasureInfo:void 0})}if(o&&r&&!this._hasMounted){this._hasMounted=!0;r(this)}};e.prototype.componentWillUnmount=function(){var e=this.props,t=e.item,i=e.onWillUnmount;i&&t&&i(this);if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}};e.prototype.componentWillReceiveProps=function(e){this.setState({selectionState:this._getSelectionState(e),groupNestingDepth:e.groupNestingDepth})};e.prototype.shouldComponentUpdate=function(e,t){if(this.props.useReducedRowRenderer){if(this.state.selectionState){var i=this._getSelectionState(e);if(this.state.selectionState.isSelected!==i.isSelected)return!0}return K.shallowCompare(this.props,e)}return!0};e.prototype.render=function(){var e=this.props,t=e.className,i=e.columns,o=e.dragDropEvents,r=e.item,n=e.itemIndex,a=e.onRenderCheck,s=void 0===a?this._onRenderCheck:a,l=e.onRenderItemColumn,d=e.selectionMode,c=e.viewport,p=e.checkboxVisibility,u=e.getRowAriaLabel,h=e.getRowAriaDescribedBy,m=e.checkButtonAriaLabel,g=e.checkboxCellClassName,f=e.rowFieldsAs,b=void 0===f?$.DetailsRowFields:f,y=e.selection,v=e.indentWidth,x=e.shimmer,_=e.compact,S=e.theme,k=e.styles,P=this.state,w=P.columnMeasureInfo,C=P.isDropping,I=P.groupNestingDepth,T=this.state.selectionState,D=T.isSelected,L=void 0!==D&&D,E=T.isSelectionModal,M=void 0!==E&&E,A=Boolean(o&&o.canDrag&&o.canDrag(r)),F=C?this._droppingClassNames?this._droppingClassNames:"is-dropping":"",R=u?u(r):void 0,O=h?h(r):void 0,N=y.canSelectItem(r),B=d===Z.SelectionMode.multiple,H=d!==Z.SelectionMode.none&&p!==j.CheckboxVisibility.hidden,V=d===Z.SelectionMode.none?void 0:L,z=X(k,{theme:S,isSelected:L,canSelect:!B,anySelected:M,isCheckVisible:p===j.CheckboxVisibility.always,checkboxCellClassName:g,droppingClassName:F,className:t,compact:_}),U=q.createElement(b,{rowClassNames:z,columns:i,item:r,itemIndex:n,columnStartIndex:H?1:0,onRenderItemColumn:l,shimmer:x});return x?q.createElement("div",{className:K.css(H&&z.shimmerLeftBorder,!_&&z.shimmerBottomBorder)},U):q.createElement(Y.FocusZone,W.__assign({},K.getNativeProps(this.props,K.divProperties),{direction:Y.FocusZoneDirection.horizontal,ref:this._onRootRef,componentRef:this._focusZone,role:"row","aria-label":R,ariaDescribedBy:O,className:K.css(z.root),"data-is-focusable":!0,"data-selection-index":n,"data-item-index":n,"aria-rowindex":n+1,"data-is-draggable":A,draggable:A,"data-automationid":"DetailsRow",style:{minWidth:c?c.width:0},"aria-selected":V,allowFocusRoot:!0}),H&&q.createElement("div",{role:"gridcell","aria-colindex":1,"data-selection-toggle":!0,className:z.checkCell},s({selected:L,anySelected:M,title:m,canSelect:N,compact:_,className:z.check,theme:S})),q.createElement(G.GroupSpacer,{indentWidth:v,count:I-(this.props.collapseAllVisibility===Q.CollapseAllVisibility.hidden?1:0)}),r&&U,w&&q.createElement("span",{role:"presentation",className:K.css(z.cellMeasurer,z.cell),ref:this._cellMeasurer},q.createElement(b,{rowClassNames:z,columns:[w.column],item:r,itemIndex:n,columnStartIndex:(H?1:0)+i.length,onRenderItemColumn:l})),q.createElement("span",{role:"checkbox",className:K.css(z.checkCover),"aria-checked":L,"data-selection-toggle":!0}))};e.prototype.measureCell=function(e,t){var i=K.assign({},this.props.columns[e]);i.minWidth=0;i.maxWidth=999999;delete i.calculatedWidth;this.setState({columnMeasureInfo:{index:e,column:i,onMeasureDone:t}})};e.prototype.focus=function(e){void 0===e&&(e=!1);return!!this._focusZone.current&&this._focusZone.current.focus(e)};e.prototype._onRenderCheck=function(e){return q.createElement(r.DetailsRowCheck,W.__assign({},e))};e.prototype._getSelectionState=function(e){var t=e.itemIndex,i=e.selection;return{isSelected:i.isIndexSelected(t),isSelectionModal:!!i.isModal&&i.isModal()}};e.prototype._onSelectionChanged=function(){var e=this._getSelectionState(this.props);K.shallowCompare(e,this.state.selectionState)||this.setState({selectionState:e})};e.prototype._onToggleSelection=function(){this.props.selection.toggleIndexSelected(this.props.itemIndex)};e.prototype._getRowDragDropOptions=function(){var e=this.props,t=e.item,i=e.itemIndex,o=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:i,context:{data:t,index:i},canDrag:o.canDrag,canDrop:o.canDrop,onDragStart:o.onDragStart,updateDropState:this._updateDroppingState,onDrop:o.onDrop,onDragEnd:o.onDragEnd}};e.prototype._updateDroppingState=function(e,t){var i=this.state,o=i.selectionState,r=i.isDropping,n=this.props,a=n.dragDropEvents,s=n.item;e?a.onDragEnter&&(this._droppingClassNames=a.onDragEnter(s,t)):a.onDragLeave&&a.onDragLeave(s,t);r!==e&&this.setState({selectionState:o,isDropping:e})};return e}(K.BaseComponent);t.DetailsRowBase=n});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowFields",["require","exports","tslib","react","../../Utilities","./DetailsRow.styles"],function(e,t,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state=t._getState(e);return t}e.prototype.componentWillReceiveProps=function(e){this.setState(this._getState(e))};e.prototype.render=function(){var e=this.props,t=e.columns,o=e.columnStartIndex,r=e.shimmer,n=e.rowClassNames,i=e.cellStyleProps,a=void 0===i?c.DEFAULT_CELL_STYLE_PROPS:i,s=this.state.cellContent;return l.createElement("div",{className:n.fields,"data-automationid":"DetailsRowFields",role:"presentation"},t.map(function(e,t){var i=void 0===e.calculatedWidth?"auto":e.calculatedWidth+a.cellLeftPadding+a.cellRightPadding+(e.isPadded?a.cellExtraRightPadding:0);return l.createElement("div",{key:t,role:e.isRowHeader?"rowheader":"gridcell","aria-colindex":t+o+1,className:d.css(e.className,e.isMultiline&&n.isMultiline,e.isRowHeader&&n.isRowHeader,e.isIconOnly&&r&&n.shimmerIconPlaceholder,r&&n.shimmer,n.cell,e.isPadded?n.cellPadded:n.cellUnpadded),style:{width:i},"data-automationid":"DetailsRowCell","data-automation-key":e.key},s[t])}))};e.prototype._getState=function(e){var o=this,r=e.item,n=e.itemIndex,a=e.onRenderItemColumn,s=e.shimmer;return{cellContent:e.columns.map(function(e){var t;try{var i=e.onRender||a;t=i&&!s?i(r,n,e):o._getCellText(r,e)}catch(e){}return t})}};e.prototype._getCellText=function(e,t){var i=e&&t&&t.fieldName?e[t.fieldName]:"";null==i&&(i="");return i};return e}(d.BaseComponent);t.DetailsRowFields=i});define("office-ui-fabric-react/lib/utilities/decorators/withViewport",["require","exports","tslib","react","./BaseDecorator","../../Utilities"],function(e,t,o,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withViewport=function(i){return function(t){o.__extends(e,t);function e(e){var a=t.call(this,e)||this;a._root=s.createRef();a._updateViewport=function(e){var t=a.state.viewport,i=a._root.current,o=s.findScrollableParent(i),r=s.getRect(o),n=s.getRect(i);if(((n&&n.width)!==t.width||(r&&r.height)!==t.height)&&a._resizeAttempts<3&&n&&r){a._resizeAttempts++;a.setState({viewport:{width:n.width,height:r.height}},function(){a._updateViewport(e)})}else{a._resizeAttempts=0;e&&a._composedComponentInstance&&a._composedComponentInstance.forceUpdate()}};a._resizeAttempts=0;a.state={viewport:{width:0,height:0}};return a}e.prototype.componentDidMount=function(){this._onAsyncResize=this._async.debounce(this._onAsyncResize,500,{leading:!1});var e=s.getWindow(),t=this._root.current;if(e&&e.ResizeObserver){this._viewportResizeObserver=new e.ResizeObserver(this._onAsyncResize);this._viewportResizeObserver.observe(t)}else this._events.on(e,"resize",this._onAsyncResize);this.props.skipViewportMeasures||this._updateViewport()};e.prototype.componentWillUnmount=function(){this._events.dispose();this._viewportResizeObserver&&this._viewportResizeObserver.disconnect()};e.prototype.render=function(){var e=this.state.viewport,t=this.props.skipViewportMeasures||0<e.width&&0<e.height;return r.createElement("div",{className:"ms-Viewport",ref:this._root,style:{minWidth:1,minHeight:1}},t&&r.createElement(i,o.__assign({ref:this._updateComposedComponentRef,viewport:e},this.props)))};e.prototype.forceUpdate=function(){this._updateViewport(!0)};e.prototype._onAsyncResize=function(){this._updateViewport()};return e}(n.BaseDecorator)}});define("office-ui-fabric-react/lib/utilities/groupedList/GroupedListUtility",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GetGroupCount=function(e){var t=0;if(e)for(var i=e.slice(),o=void 0;i&&0<i.length;){++t;(o=i.pop())&&o.children&&i.push.apply(i,o.children)}return t}});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.styles",["require","exports","../../Styling"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={root:"ms-DetailsList",compact:"ms-DetailsList--Compact",isFixed:"is-fixed",isHorizontalConstrained:"is-horizontalConstrained",listCell:"ms-List-cell"};t.getStyles=function(e){var t,i,o=e.theme,r=e.className,n=e.isHorizontalConstrained,a=e.compact,s=e.isFixed,l=o.semanticColors,d=c.getGlobalClassNames(p,o);return{root:[d.root,{position:"relative",fontSize:c.FontSizes.small,background:l.listBackground,color:l.listText,selectors:(t={},t["& ."+d.listCell]={minHeight:38,wordBreak:"break-word"},t)},s&&[d.isFixed],a&&[d.compact,{selectors:(i={},i["."+d.listCell]={minHeight:32},i)}],n&&[d.isHorizontalConstrained,{overflowX:"auto",overflowY:"visible",WebkitOverflowScrolling:"touch"}],r],focusZone:[{display:"inline-block",minWidth:"100%",minHeight:1}]}}});define("odsp-next/controls/list/react/detailsList/fields/UserRenderer",["require","exports","@ms/odsp-utilities/lib/async/Promise","react","office-ui-fabric-react/lib/Utilities","knockout","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-datasources/lib/Permissions","./../../../../../resources/ProviderResourceKeys","../../../../../resources/DataSourceResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Async","../../../../peopleCard/PeopleCardCommons","../../../../../utilities/features/Features","./BaseText","@ms/odsp-list-utilities/lib/Renderers/BaseText","../../../../../controls/personaCard/EasyLpc","../../../../../utilities/killSwitch/KillSwitch"],function(a,e,s,p,d,t,i,l,u,n,h,c,o,m,r,g,f,b,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var v=new o.default,x=void 0,_=r.isFeatureEnabled(r.PeopleCardsReactComponent),S=r.isFeatureEnabled(r.PeopleCardsOnLoki),k=null;e.userRenderer=function(e){var t=e.item,i=e.column,o=e.resources,r=e.isDisabled,n=t.properties[i.key],a=Array.isArray(n)?n:n?[n]:[],s=t.properties.isDisabled||r,l=g.getCellText(t,i);return l||a.length?C(a,o,{text:l,isDisabled:s,ariaLabel:a.length?g.getAriaLabel(i,a[0].title):""},d.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":S||_,"od-FieldRenderer--disabled":s})):null};function P(e,t){var i=t.consume(n.profile.optional);if(i){var o=e.map(function(e){return e.sip});i.personRendered(o)}return{lastMouseMove:null,showCardTimeoutId:-1,prepareCardTimeoutId:-1}}e.generatePeopleCardState=P;function w(e){if(!x){var t=e.consume(n.bundleLoader);x=t.waitForPageRenderingComplete().then(function(){return new s.default(function(e,t){v.setTimeout(function(){e(l.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return new s.default(function(e,t){a(["../../../../personaCard/PersonaCardLauncher"],e,t)})}}))},1e3)})})}}e.loadPeopleCardComponent=w;function C(e,o,t,r){var i=e||[],n=t.text,a=t.ariaLabel,s=t.noTextRender,l=t.title,d=t.isDisabled;if(o.consume(h.identity).getIdentity().type===u.IdentityType.anonymous)return p.createElement("div",null,i.map(function(e,t){return p.createElement("div",{key:t},p.createElement(f.BaseText,{text:e.title||n,isDisabled:d,ariaLabel:a,noTextRender:s,title:l}))}));_&&w(o);var c=P(i,o);return i.length?p.createElement("div",null,i.map(function(e,t){var i=I({resources:o,user:e,ariaLabel:a,isDisabled:d,noTextRender:s,cellClassName:r,state:c});return p.createElement("div",{key:t},i)})):p.createElement(f.BaseText,{text:n,isDisabled:d,ariaLabel:a,noTextRender:s,title:l})}e.userRendererByUser=C;function I(s){var l=s.user,e=s.resources,t=s.ariaLabel,i=s.isDisabled,o=s.noTextRender,d=l.email||l.sip;return d?!s.resources.isExposed(c.pageContext)||y.default.isActivated("3f3b9808-5ac4-446c-b8d3-7d61be3da609","2/20/2018","Use new LPC")?p.createElement("span",{ref:function(e){_&&e&&l&&d?(r=e,n=d,a=s.resources,x&&x.then(function(e){k=r;e.personaRendered(r,n,a.consume(c.pageContext))})):k&&(t=e,i=d,o=s.resources,x&&x.then(function(e){e.personaRemoved(t,i,o.consume(c.pageContext))}));var t,i,o,r,n,a},className:s.cellClassName,"data-is-focusable":!0,role:"button","aria-label":s.ariaLabel,onMouseOut:function(e){return D(s.state)},onMouseMove:function(e){!function(e,t,i,o){void 0===o&&(o=null);if(_)return;if(e&&(e.sip||e.email)){if(-1===i.prepareCardTimeoutId){var r=t.consume(n.profile.optional);i.prepareCardTimeoutId=v.setTimeout(function(){return r.getPeopleCardData(e.email||e.sip)},m.PEOPLE_CARD_DATA_PRELOAD_DELAY)}i.lastMouseMove=o;i.lastMouseMove.persist();-1===i.showCardTimeoutId&&(i.showCardTimeoutId=v.setTimeout(function(){return T(e,t,o,!0)},m.PEOPLE_CARD_HOVER_DELAY))}}(l,s.resources,s.state,e)},onClick:function(e){T(l,s.resources,s.state,e)}},l.title):p.createElement(b.EasyLpc,{resourceScope:e,personaType:"User",identifier:d,loggingData:{name:"UserRenderer.LPC.Click"},placeHolder:p.createElement("span",{className:s.cellClassName},l.title)},p.createElement("span",{className:s.cellClassName,"data-is-focusable":!0,role:"button","aria-label":s.ariaLabel},l.title)):p.createElement(f.BaseText,{text:l.title,isDisabled:i,ariaLabel:t,noTextRender:o,title:l.title})}e.getUserComponent=I;function T(i,o,e,r,n){void 0===r&&(r=null);void 0===n&&(n=!1);if(!_){(r=r||e.lastMouseMove).stopPropagation();r.preventDefault();r=t.utils.extend({},r);D(e);i&&(i.sip||i.email)&&l.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return new s.default(function(e,t){a(["../../../../personaCard/PersonaCardLauncher"],e,t)})}}).then(function(e){var t={name:i.title,email:i.email,image:i.picture,sip:i.sip||i.email,userId:i.sip};new(o.injected(e))(t).show(r,n)})}}function D(e){v.clearTimeout(e.showCardTimeoutId);v.clearTimeout(e.prepareCardTimeoutId);e.showCardTimeoutId=-1;e.prepareCardTimeoutId=-1;e.lastMouseMove=null}e.resourceKey=new i.ResourceKey({name:a("module").id,factory:new i.ConstantResourceFactory(e.userRenderer)})});define("odsp-next/controls/list/react/detailsList/fields/BaseText",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/BaseText"],function(e,t,d,i,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,i=e.item,o=e.column,r=e.children,n=e.noTextRender,a=e.title,s=p(o,t),l=i&&i.properties.isDisabled||e.isDisabled;void 0===t&&(t=u(i,o));return d.createElement(c.BaseText,{text:t,isDisabled:l,ariaLabel:s,noTextRender:n,title:a},r)};function p(e,t){(!t||e.internalName&&"attachments"===e.internalName.toLowerCase()&&"0"===t)&&(t=o.strings.emptyValueAriaLabel);return i.format(o.strings.cellAriaLabel,e.name,t)}t.getAriaLabel=p;function u(e,t){var i="";if(e&&void 0===(i=e[t.key])&&e.properties){void 0===(i=e.properties[t.key])&&(i=e.recycleBinProperties[t.key]);i&&Array.isArray(i)&&(i=i.join(", "))}return i}t.getCellText=u;t.isCellChanged=function(e,t,i){return!(!e||!t)&&u(e,i)!==u(t,i)}});define("@ms/odsp-list-utilities/lib/Renderers/BaseText",["require","exports","react","office-ui-fabric-react/lib/Utilities"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,i=e.isDisabled,o=e.noTextRender,r=e.ariaLabel,n=e.children;t=t||" ";r=r||t;return a.createElement("div",{"aria-label":o?r:void 0,className:s.css(e.className,{"od-FieldRenderer--disabled":i})},o?null:a.createElement("span",null,t),n)}});define("odsp-next/controls/personaCard/EasyLpc",["require","exports","tslib","react","../../resources/SPOResourceKeys","../../resources/ProviderResourceKeys","../../utilities/delayLoading/DelayLoadingHelper","@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard","./LpcCallbacks"],function(e,t,o,c,r,p,u,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._pageContext=e.resourceScope.consume(r.pageContext);return t}e.prototype.render=function(){var e=this.props,t=e.personaType,i=e.identifier,o=e.locationId,r=e.placeHolder,n=e.resourceScope,a=e.loggingData,s=u.getReactDeferredComponentModuleLoader(),l=n.consume(p.bundleLoader),d=u.waitForPageLoadWithTimeout(l);return c.createElement(h.DeferredSpLivePersonaCard,{moduleLoader:s,personaType:t,identifier:i,locationId:o,pageContext:this._pageContext,placeHolder:r,addGroupMembersCallback:m.makeAddMembersCallback(n),customWaiter:d,loggingData:a},this.props.children)};return e}(c.Component);t.EasyLpc=i});define("odsp-next/utilities/delayLoading/DelayLoadingHelper",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Async"],function(e,t,a,s,l,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=new i.default;t.loadModuleOnEvent=function(e,t){if(e){var i=e.eventSource,o=e.eventName,r=e.eventGroup,n=void 0===r?new s.default(this):r;return new l.default(function(e){n.on(i,o,function(){n.off(i,o);a.loadModule({path:t.path,getModule:t.getModule}).then(e)})})}return a.loadModule({path:t.path,getModule:t.getModule})};t.getReactDeferredComponentModuleLoader=function(){return{load:function(i,e){return a.loadModule({path:i,getModule:e}).then(function(e){return(t={})[i]=e,t;var t})},parse:void 0}};t.waitForPageLoadWithTimeout=function(e,t,i){void 0===t&&(t=1);void 0===i&&(i=1e3);var o=new r.default;(1===t?e.waitForPageRenderingComplete():e.waitForPLT()).then(function(){n.setTimeout(function(){return o.complete()},i)});return o.getPromise()}});define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../ReactDeferredComponent/index","@ms/odsp-utilities/lib/async/Promise"],function(a,e,s,i,t,o,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(n){s.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this,o="@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/SpLivePersonaCard",r=s.__assign({},i.props.moduleLoader,{parse:function(e){return e[o]&&e[o].SpLivePersonaCard}});i._deferredComponentProps={modulePath:o,getModule:function(){return new l.default(function(e,t){a(["@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/SpLivePersonaCard"],e)})},moduleLoader:r,waitPLT:!0,props:i.props,customWaiter:i.props.customWaiter,placeHolder:i.props.placeHolder};return i}e.prototype.render=function(){return i.createElement(o.ReactDeferredComponent,s.__assign({},this._deferredComponentProps),this.props.children)};s.__decorate([t.autobind],e.prototype,"render",null);return e}(t.BaseComponent);e.DeferredSpLivePersonaCard=r;e.wrapWithDeferredSpLivePersonaCard=function(e,t){return i.createElement(r,s.__assign({},e),t)}});define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index",["require","exports","tslib","./ReactDeferredComponent"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t)});define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/ReactDeferredComponent",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/events/PLT.event","@ms/odsp-utilities/lib/performance/PerformanceCollection","office-ui-fabric-react/lib/Utilities"],function(e,t,o,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._mounted=!1;t.state={ComponentModule:void 0};t._pltEventHandler=function(e){s.PLT.isTypeOf(e)&&t._deferLoadComponent()};e.customWaiter?e.customWaiter.then(t._deferLoadComponent):void 0!==e.waitPLT&&!e.waitPLT||l.default.pageLoaded()?t._deferLoadComponent():a.Manager.addLogHandler(t._pltEventHandler);return t}e.prototype.render=function(){var t=this,e=this.state.ComponentModule;return e?r.createElement(e,o.__assign({ref:function(e){e&&d.hoistMethods(t,e)}},this.props.props),this.props.children):this.props.placeHolder||null};e.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)};e.prototype._deferLoadComponent=function(){var i=this;!this.state.ComponentModule&&this.props.moduleLoader&&this.props.modulePath&&this.props.moduleLoader.load(this.props.modulePath,this.props.getModule).then(function(e){i.props.moduleLoader.parse&&(e=i.props.moduleLoader.parse(e));if(!e){var t="ReactDeferredComponent: component not found when loading "+i.props.modulePath+" - check your load and parse functions";console.error(t);throw t}i._mounted?i.setState({ComponentModule:e}):i.state={ComponentModule:e};a.Manager&&a.Manager.removeLogHandler(i._pltEventHandler)})};o.__decorate([n.autobind],e.prototype,"_deferLoadComponent",null);return e}(r.Component);t.ReactDeferredComponent=i});define("odsp-next/controls/personaCard/LpcCallbacks",["require","exports","../../resources/ControlResourceKeys"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.makeAddMembersCallback=function(o){var t=o.consume(r.actionMap);function i(e){var t=new(o.injected(e))({}),i=function(){t.dispose()};t.execute(null).done(i,i)}return function(e){i(t.LaunchGroupMembershipPanelAction);if(window._isRunningTABTest){window._spLaunchSiteSettings=function(){i(t.LaunchSiteSettingsPanelAction)};window._spLaunchSitePermissions=function(){i(t.LaunchSitePermissionsPanelAction)}}}}});define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor.html",[],function(){return'\x3c!--ko component: {\r\n name: panelTagName,\r\n params: {\r\n ariaLabel: panelTitle,\r\n size: panelSize,\r\n onClose: $component.onClosePanel.bind($component),\r\n virtualParentElement: virtualParentElement\r\n }\r\n}--\x3e<div class=od-versionHistory-panelTitle data-bind="text: panelTitle"></div><div class=od-versionHistory-container role=application><div data-bind="react: { componentType: listComponent, props: listComponentProps }"></div></div>\x3c!--/ko--\x3e'});define("odsp-next/actions/showVersionHistoryAction/VersionHistory.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-versionHistory-panelTitle{top:50px;position:absolute;padding-bottom:20px;font-size:20px}.od-versionHistory-container{position:absolute;top:100px;overflow:auto}.od-versionHistory-container .od-fileSizeColumn,.od-versionHistory-container .od-modifiedByColumn,.od-versionHistory-container .od-versionNumberColumn{line-height:32px}.od-versionHistory-container .od-modifiedDateColumn{height:32px;line-height:32px}.od-versionHistory-container .od-FieldRenderer-dot.od-modifiedDateColumn-moreButton.ms-Button.ms-Button--icon{margin:0}"}])});define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../resources/ControlResourceKeys","../../NavigationAction","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,o,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._viewParams=t.resources.consume(n.viewParams);return t}e.prototype.execute=function(e){var t=s.extend({},this._viewParams.peek());t.ft?delete t.ft:t.ft=8..toString();return new(this.managed(a.default))({url:"#"+r.serializeQuery(t),ignoreHistory:!0}).execute(null)};return e}(i.default);t.default=l});define("odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/commands/Commands.resx","../../../controls/addToAlbum/AddToAlbum","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer"],function(e,t,i,o,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.actionName,o=e.itemSelectionHelper,r=e.panelProvider;t.name=i;t._itemSelectionHelper=o;t._panelProvider=r;t._itemReedemer=new(t.managed(l.default));return t}e.prototype.execute=function(e){var i=this;return this._itemSelectionHelper.resolveSelection().then(function(t){return i._itemReedemer.redeemItems(t,i).then(function(){var e=i._panelProvider.requestPanel({title:r.strings.AddToAlbum,component:{name:a.default.tagName,params:{selection:t,onComplete:function(){e.state(1)}}}});return e.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}},function(){return{resultType:s.ResultTypeEnum.Failure}})})})};return e}(o.default);t.default=n});define("odsp-next/controls/addToAlbum/AddToAlbum",["require","exports","./AddToAlbumViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AddToAlbum.html","./AddToAlbum.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-add-to-album",template:e("./AddToAlbum.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/addToAlbum/AddToAlbumViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../providers/album/AlbumProvider","../../providers/item/ItemProvider","../../resources/DataSourceResourceKeys","./AddToAlbum.resx","../commands/Commands.resx","../progressSpinnerFlat/ProgressSpinnerFlat","../image/frame/ImageFrame","../../bindings/keyboard/KeyboardBinding","../../models/item/OneDriveItem","../../models/itemSet/ItemSet","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../actions/createAlbum/CreateAlbumOperator"],function(n,e,t,i,a,s,l,d,c,p,u,h,m,g,f,b){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.thumbnailSize={width:50,height:50};t._albumProvider=t.resources.consume(a.resourceKey);t._urlDataSource=t.resources.consume(l.url);t._itemProvider=t.resources.consume(s.resourceKey);t._onComplete=e.onComplete;t.addBindingHandlers({keyboard:h.default});t.newAlbumName=t.createObservable("");t.newAlbumPlaceholder=d.strings.newAlbumPlaceholder;t.emptyAlbumListTitle=d.strings.emptyAlbumListTitle;t.emptyAlbumListBody=d.strings.emptyAlbumListBody;t.createNewAlbumText=c.strings.CreateCommit;t.closeText=c.strings.Close;t.savingText=c.strings.Saving;t.progressSpinnerFlatTagName=p.default.tagName;t.imageFrameTagName=u.default.tagName;t.isLoading=t.createObservable(!0);t.isMakingRequest=t.createObservable(!1);t.isSubmitDisabled=t.createComputed(t._computeSubmitDisabled);t.selection=e&&e.selection;t.createNewAlbumInputIsVisible=t.createObservable(!1);t.nameCollisionErrorString=t.createObservable("");t.hasError=t.createComputed(t._computeHasError);t.emptyAlbumListImgSrc="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/album/empty-albums-list.svg"):n("@ms/odsp-media/dist/media/images/album/empty-albums-list.svg");t.shouldShowEmptyAlbumList=t.createObservable(!1);if(!t.selection)throw new Error("No items passed to Add to Album control");var i=new m.default,o=new g.default;o.item=t.createObservable(i);t.itemSet=t.createObservable(o);t.itemSet.equalityComparer=f.objectStrictEquality;t.children=t.observables.createArray([]);t.children.equalityComparer=f.arrayStrictEquality;t.init();t.createComputed(function(){t.newAlbumName();t.nameCollisionErrorString("")});return t}e.prototype.init=function(){var t=this,e={parentKey:this._albumProvider.getAlbumsParentKey({}),ownerId:this._urlDataSource.getOwnerId(),pageSize:100,startIndex:0,isAscending:!1};this.itemSet(this._itemProvider.getItemSync(e));this._itemProvider.getItem(e).then(function(e){t.isLoading(!1);t._updateChildrenSet()},function(e){})};e.prototype.onClickAlbumRow=function(e,t){this.isMakingRequest(!0);var i={album:e,items:this.selection};this._albumProvider.addToAlbum(i);this._onComplete()};e.prototype.createNewAlbum=function(e,t){var i=this,o=this.unwrapObservable(this.newAlbumName).trim();this.isMakingRequest(!0);this.resources.consumeAsync(b.typeResourceKey).then(function(e){var t=new e({name:o,keys:i.selection.filter(function(e){return!!e}).map(function(e){return e.key})});return i.trackPromise(t.start())}).done(function(){i._onComplete()},function(e){i.isMakingRequest(!1);i.nameCollisionErrorString(e&&e.error&&e.error.message||"")});return!1};e.prototype.onCloseButtonClick=function(e,t){this._onComplete()};e.prototype.setFocusToInput=function(e,t){this.createNewAlbumInputIsVisible(!0)};e.prototype._computeHasError=function(){return this.nameCollisionErrorString&&!!this.nameCollisionErrorString()};e.prototype._computeSubmitDisabled=function(){return this.newAlbumName().trim().length<1||this.isMakingRequest()};e.prototype._updateChildrenSet=function(){for(var e=this.itemSet().content().items,t=0,i=e;t<i.length;t++){var o=i[t],r=this.unwrapObservable(o);r&&r.folder&&r.folder.covers&&0===r.folder.covers.length&&r.folder.covers.push({url:"odsp-media/images/album/empty-album.svg",width:this.thumbnailSize.width,height:this.thumbnailSize.height})}this.shouldShowEmptyAlbumList(e.length<=0);this.children(e)};return e}(i.default);e.default=o});define("odsp-next/actions/createAlbum/CreateAlbumOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,{},t)||this;i._albumProvider=t.albumProvider;i._context=e;i._payloads={createAlbum:{name:i.createObservable(""),items:i.createObservable(),album:i.createObservable()}};return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e);t.type=n.default.createAlbum;t.name=e.input;t.payloads=this._payloads;e.output&&e.output.isAlbum&&this._payloads.createAlbum.album(e.output);return t};e.prototype.onStart=function(e){return this._albumProvider.createAlbum(this._context,e)};e.dependencies=i.__assign({},r.default.dependencies,{albumProvider:a.resourceKey});return e}(r.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/controls/addToAlbum/AddToAlbum.html",[],function(){return'<div class=od-AddToAlbum>\x3c!--ko ifnot: isLoading--\x3e<div class="od-AddToAlbum-createArea od-TextField"><form class="od-AddToAlbum-form od-AddToAlbum-form--buttonVisible" data-bind="submit: createNewAlbum, css: { \'od-AddToAlbum-form--errorVisible\': hasError }"><input type=text class=od-TextField-field autocomplete=off data-bind="textInput: newAlbumName, attr: { placeholder: newAlbumPlaceholder }, hasFocus: createNewAlbumInputIsVisible, css: { \'od-AddToAlbum-createAreaInput--error\': hasError }"><p class=od-AddToAlbum-error data-bind="visible: hasError, text: nameCollisionErrorString"></p><p class=od-AddToAlbum-savingText data-bind="visible: isMakingRequest, text: savingText"></p><button type=submit class="od-Button od-Button--primary od-AddToAlbum-createNewAlbumButton od-AddToAlbum-createNewAlbumButton--visible" data-bind="text: createNewAlbumText, click: createNewAlbum, disable: isSubmitDisabled"></button><div class=ms-clearfix></div></form></div>\x3c!--ko foreach: children--\x3e<div class=od-AddToAlbum-albumRow data-bind="click: $parent.onClickAlbumRow.bind($parent)"><a href=# data-bind="attr: { title: name }"><span class=thumbnail><div class=od-AddToAlbum-albumThumbnail data-bind="component: { name: $component.imageFrameTagName, params: { image: folder.covers[0], desiredSize: $parent.thumbnailSize } }"></div></span><div class="od-AddToAlbum-albumName ms-font-l" data-bind="text: name"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if: shouldShowEmptyAlbumList--\x3e<div class=od-AddToAlbum-emptyList><img class=od-AddToAlbum-emptyListImage data-bind="attr: { src: emptyAlbumListImgSrc }"><p class="od-AddToAlbum-emptyListTitle ms-font-xl ms-fontWeight-semilight" data-bind="text: emptyAlbumListTitle"></p><p class="od-AddToAlbum-emptyListBody ms-font-m" data-bind="text: emptyAlbumListBody"></p></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isLoading--\x3e<div class=od-AddToAlbum-progressSpinner data-bind="component: { name: progressSpinnerFlatTagName }"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/addToAlbum/AddToAlbum.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-AddToAlbum-albumThumbnail{position:absolute;height:50px;width:50px}.od-AddToAlbum-albumRow{line-height:50px;height:50px;margin-bottom:6px}.od-AddToAlbum-albumRow:hover{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-AddToAlbum-albumRow a{text-decoration:none}.od-AddToAlbum-albumName{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[dir=ltr] .od-AddToAlbum-albumName{padding-left:58px}[dir=rtl] .od-AddToAlbum-albumName{padding-right:58px}.od-AddToAlbum-createArea.od-TextField{position:relative}.od-AddToAlbum-form{margin-bottom:24px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;overflow:auto}.od-AddToAlbum-emptyListBody,.od-AddToAlbum-error,.od-AddToAlbum-savingText{margin-top:8px;margin-bottom:0}.od-AddToAlbum-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-AddToAlbum-savingText{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-AddToAlbum-createAreaInput--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}.od-AddToAlbum-form--buttonVisible,.od-AddToAlbum-form--errorVisible{transition:height 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton,.od-Button.od-AddToAlbum-createNewAlbumButton--visible{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton--visible:not(:disabled),.od-Button.od-AddToAlbum-createNewAlbumButton:not(:disabled){color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Button.od-AddToAlbum-createNewAlbumButton{margin-top:-32px;z-index:-1}html[dir=ltr] .od-Button.od-AddToAlbum-createNewAlbumButton{float:right}html[dir=rtl] .od-Button.od-AddToAlbum-createNewAlbumButton{float:left}.od-Button.od-AddToAlbum-createNewAlbumButton--visible{margin-top:24px}.od-AddToAlbum-emptyListImage{margin-top:30px}.od-AddToAlbum-emptyListTitle{margin-top:40px}.od-AddToAlbum-emptyList{text-align:center}"}])});define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/ApplyOfficeLensOperator","../../../utilities/optimizely/experiments/NewFeatureDiscovery","../../../utilities/optimizely/OptimizelyHelper"],function(e,t,o,i,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._selectionHelper=e.selectionHelper;t._item=e.item;t._itemReedemer=new(t.managed(r.default));return t}e.prototype.execute=function(){var i=this;l.OptimizelyHelper.trackEvent(s.EXPERIMENT_ID,s.EVENTS.officeLensClicked);return this._selectionHelper.resolveFirst().then(function(t){return i._itemReedemer.redeemItem(t,i).then(function(){var e=new(i.managed(a.default))({item:t,parentKey:i._item.key});i.trackPromise(e.start());return e.wait().then(function(){return{resultType:n.ResultTypeEnum.Success}})})})};return e}(i.default);t.default=d});define("odsp-next/providers/operator/ApplyOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e){var t=o.call(this,{})||this;t._context=e;t._processFiltersProvider=t.resources.consume(r.processFilters);return t}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input;t.name=i.name;t.iconName=i.iconName;t.type=n.default.applyOfficeLens;t.payloads={applyOfficeLens:{item:i}};return t};e.prototype.onStart=function(e){return this._processFiltersProvider.applyOfficeLens(this._context,e)};return e}(o.default);t.default=a});define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/RemoveOfficeLensOperator"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._selectionHelper=e.selectionHelper;t._item=e.item;t._itemReedemer=new(t.managed(r.default));return t}e.prototype.execute=function(){var i=this;return this._selectionHelper.resolveFirst().then(function(t){return i._itemReedemer.redeemItem(t,i).then(function(){var e=new(i.managed(a.default))({item:t,parentKey:i._item.key});i.trackPromise(e.start());return e.wait()})}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(i.default);t.default=s});define("odsp-next/providers/operator/RemoveOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e){var t=o.call(this,{})||this;t._context=e;t._processFiltersProvider=t.resources.consume(r.processFilters);return t}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input;t.name=i.name;t.iconName=i.iconName;t.type=n.default.removeOfficeLens;t.payloads={removeOfficeLens:{item:i}};return t};e.prototype.onStart=function(e){return this._processFiltersProvider.removeOfficeLens(this._context,e)};return e}(o.default);t.default=a});define("odsp-next/actions/addToBundle/odc/AddToBundleExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../controls/bundleBuilder/BundleBuilder","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/UpdateBundleOperator","../../../providers/panel/PanelProvider","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,o,a,s,n,l,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._panelProvider=t.resources.consume(r.resourceKey);return t}e.prototype.execute=function(){var o=this;return this._selectionHelper.resolveSelection().then(function(e){var t=o.observables.createArray(),i=e[0];return o._addToBundleViaPanel(i,t).then(function(){return o._addToBundle(i,t.peek())})})};e.prototype._addToBundleViaPanel=function(e,t){var i=this.observables.create(!1),o={resources:this.resources,bundleName:e.displayName,complete:function(e){t.splice.apply(t,[0,t.peek().length].concat(e.map(function(e){return e.id})));i(!0);return a.default.wrap()},cancel:function(){i(!0);return a.default.wrap()}},r=this._panelProvider.requestPanel({noTitle:!0,hasCommandBar:!0,size:"Large",showCloseButton:!1,component:{name:s.default.tagName,params:o}}),n=this.createComputed(function(){i()&&r.state(1)});return r.wait().then(function(){n.dispose()},function(e){n.dispose();return a.default.wrapError(e)})};e.prototype._addToBundle=function(i,o){var r=this;return o&&0===o.length?a.default.wrap({resultType:n.ResultTypeEnum.Success}):this.resources.consumeAsync(l.typeResourceKey).then(function(e){var t=new e({items:o,bundleAction:0,item:i});r.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(i.default);t.default=d});define("odsp-next/controls/bundleBuilder/BundleBuilder",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./BundleBuilderViewModel","./BundleBuilder.html","./BundleBuilder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-bundle-builder",template:e("./BundleBuilder.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/bundleBuilder/BundleBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","@ms/odsp-utilities/lib/async/Promise","./BundleBuilder.resx"],function(e,t,i,o,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(d){i.__extends(e,d);function e(e){var t=d.call(this,e)||this;t.filePickerHostTagName=c.default.tagName;var i=e.complete,o=e.cancel,r=e.bundleName,n=e.typeFilter,a=e.viewType,s=void 0===a?1:a,l=e.itemKey;t.title=r?t.format(u.strings.addItemsTitleFormat,r):u.strings.addItemsTitle;t.filePickerHostParams={itemKey:l,behavior:{showActions:!1,selectionMode:1,viewType:s,typeFilter:n,completeText:u.strings.addItemsTitle},agent:{initialize:function(){return p.default.wrap()},getApplication:function(){return p.default.wrap()},complete:i,cancel:o,switchAccount:function(){return p.default.wrap()}}};return t}return e}(o.default);t.default=r});define("odsp-next/controls/filePickerHost/FilePickerHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePickerHostViewModel","./templates/FilePickerHostTemplates","../../bindings/component/ControlBinding","./FilePickerHost.html","./FilePickerHost.css","./templates/FilePickerHostInline.html"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="od-file-picker-host",s=e("./FilePickerHost.html"),l=i.registerComponent({tagName:a,template:s,viewModel:o.default,synchronous:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({automationName:a,name:e("module").id,template:s,viewModelType:o.default});i.registerTemplate(r.INLINE,e("./templates/FilePickerHostInline.html"));t.default=l});define("odsp-next/controls/filePickerHost/FilePickerHostViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","./templates/FilePickerHostTemplates","@ms/odsp-shared/lib/utilities/navigation/InPlaceNavigation","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/modules/Modules","../progressSpinnerFlat/ProgressSpinnerFlat","../../bindings/host/HostBinding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../models/item/ItemType","../../dataSources/url/PageType","../../resources/PagesResourceKeys"],function(u,e,t,h,i,m,g,f,b,y,v,x,_,S,k,P){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(p){t.__extends(e,p);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=p.call(this,e)||this;i.addBindingHandlers({host:x.default});i._urlDataSource=i.resources.consume(m.url);var o=e.itemKey,r=e.agent,n=e.behavior,a=t.loadModule,s=void 0===a?y.loadModule:a,l=i._urlDataSource.getDefaultClickUrl({key:o||i._urlDataSource.getRootItemKey(),type:S.default.Folder},{page:k.default.FilePicker,viewParams:{}}),d=new(i.managed(f.default));d.navigateTo({url:l});i.resources.expose(_.navigation,d);i.resources.expose(b.viewParams,d.viewParamsObservable);i.resources.expose(P.base.leftNav.isLeftNavVisible,i.createObservable(!1));i.resources.expose(P.base.leftNav.hideLeftNav,i.createObservable(!1));i.resources.expose(P.base.suiteNav.isSuiteNavHidden,i.createObservable(!0));i.resources.expose(P.base.commandBar.isDarkTheme,i.createObservable(!1));i.resources.expose(P.base.commandBar.isSearchHidden,i.createObservable(!1));i._pickerParams={behavior:n,agent:r,shouldHostOverlays:!1};i.pickerComponent=i.createObservable({name:v.default.tagName,params:{}});var c=i._urlDataSource.getPageModulePath(d.viewParamsObservable.peek());i.trackPromise(s({path:c,getModule:function(){return new h.default(function(e,t){if("undefined"==typeof __webpack_public_path__)window.require([c],e,t);else{e(u.context("odsp-next/pages",!0,/\.ts$/)("./"+u("path").relative("odsp-next/pages",c)+".ts"))}})}}).then(function(e){i.pickerComponent({name:e.tagName,params:i._pickerParams})}));i.pickerTemplate=g.INLINE;return i}return e}(i.default);e.default=o});define("odsp-next/controls/filePickerHost/templates/FilePickerHostTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INLINE="od-file-picker-host-inline"});define("odsp-next/controls/filePickerHost/FilePickerHost.html",[],function(){return"\x3c!--ko template: pickerTemplate--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/filePickerHost/FilePickerHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FilePickerHost{position:absolute;top:0;left:0;bottom:0;right:0}.od-FilePickerHost--frame .od-FilePickerHost-content{position:absolute;left:0;right:0;bottom:0;height:90px}.od-FilePickerHost--frame .od-FilePickerHost-frame{position:absolute;top:0;left:0;bottom:90px;right:0}.od-FilePickerHost--frame .od-FilePickerHost-frame iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:none}"}])});define("odsp-next/controls/filePickerHost/templates/FilePickerHostInline.html",[],function(){return'<div class="od-FilePickerHost od-FilePickerHost--inline" data-bind="component: pickerComponent">\x3c!--ko host: {\r\n data: $host\r\n }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/bundleBuilder/BundleBuilder.html",[],function(){return'<div class=od-BundleBuilder data-bind="component: { name: filePickerHostTagName, params: filePickerHostParams }"><div class="od-BundleBuilder-content od-ItemContent"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-BundleBuilder-title od-ItemContent-title" data-bind="text: title"></div></div></div></div>'});define("odsp-next/controls/bundleBuilder/BundleBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-BundleBuilder{position:absolute;top:0;left:0;bottom:0;right:0}"}])});define("odsp-next/actions/feedback/odc/FeedbackExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../bindings/component/ControlBinding","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/feedback/Feedback","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../models/feedback/FeedbackDialogState","../../../providers/dialog/DialogProvider","../../../providers/sendFeedback/SendFeedbackProvider","../../NavigationAction","../../../resources/ODCResourceKeys","../../../dataSources/url/AutoActionType","../../../controls/feedback/Feedback.resx","../../../controls/sendFeedback/SendFeedback.resx","../../../utilities/features/Features","../../../controls/sendFeedback/SendFeedback"],function(e,t,o,i,m,g,f,b,r,y,v,n,x,a,_,S,k,P,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._userInfoProvider=t.resources.consume(r.userInfo);t._urlDataSource=t.resources.consume(a.urlDataSource);t._sendFeedbackProvider=t.resources.consume(n.resourceKey);return t}e.prototype.execute=function(e){var t=this;if(!this._userInfoProvider.isAuthenticated()){var i=this._urlDataSource.getSignInUrlWithAction(_.default.feedback);return new(this.managed(x.default))({url:i,forceNavigation:!0}).execute(e)}var o=this.observables,r=this.resources.consume(v.resourceKey),n=o.create(y.default.initialLoad),a=o.create(""),s=o.create(""),l=o.create(!1),d=P.isFeatureEnabled(P.EnableNewTicketingService);d&&(s=this.createPureComputed(function(){return t._getHeaderText(n)}));var c,p,u={onComplete:function(){h.state(3)},comment:a,state:n,title:s,retryTrigger:l};d?p=m.toSpecification(w.resourceKey,u):c={name:f.default.tagName,params:u};var h=r.requestDialog({title:s,component:c,control:p,actions:[{name:S.strings.retryTitle,execute:function(){l(!0);return b.default.wrap(1)},isVisible:o.pureCompute(function(){return n()===y.default.error}),icon:null,isDefault:!0},{name:k.strings.sendFeedbackBtnText,execute:function(){return t._submitFeedback(a.peek(),n).then(function(){return b.default.wrap(1)})},isVisible:o.pureCompute(function(){return d&&n()===y.default.initialLoad}),isAvailable:o.pureCompute(function(){return!!a()}),icon:null,isDefault:!0}],size:"Small"});return h.wait().then(function(){return{resultType:g.ResultTypeEnum.Success}})};e.prototype._getHeaderText=function(e){var t=e();return t===y.default.error?k.strings.errorHeader:t===y.default.done?k.strings.successHeader:t===y.default.initialLoad?k.strings.emailSupportTitle:t===y.default.feedbackSent?k.strings.sendingHeader:""};e.prototype._submitFeedback=function(e,t){t(y.default.feedbackSent);return this._sendFeedbackProvider.sendFeedback(e).then(function(){t(y.default.done)},function(e){t(y.default.error)})};return e}(i.default);t.default=s});define("odsp-next/controls/feedback/Feedback",["require","exports","./FeedbackViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Feedback.html","./Feedback.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-feedback",template:e("./Feedback.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/feedback/FeedbackViewModel",["require","exports","tslib","knockout","./Feedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/feedback/FeedbackDialogState"],function(e,t,o,r,i,n,a,s,l,d,c,p,u,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="Init",f="Submit",b="Close",y="Cancel",v="Confirm",x="Timeout",_="FrameLoad",S="Parature.Flow.",k=i.strings,P=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.states=m.default;t._qos={};t._paratureEvents={};t._urlDataSource=t.resources.consume(c.url);t._reportParatureStage(g);t.state=e.state;t._retryTrigger=e.retryTrigger;t._headerText=e.title;t.progressSpinnerTagName=a.default.tagName;t.bodyText=r.observable("");t.iframeUrl=r.observable("");t._loadTimer=0;t._feedbackProvider=t.resources.consume(s.feedback);t._onComplete=e.onComplete;t.createComputed(t._onRetryTrigger);t._init();return t}e.prototype.dispose=function(){i.prototype.dispose.call(this)};e.prototype.onCloseClicked=function(){this._reportParatureStage(this.state()===m.default.done?b:y);this._onComplete()};e.prototype._init=function(){this.state(m.default.initialLoad);this._headerText(k.loadingTitle);this.bodyText("");this.iframeUrl("");this._initListeners();this._initIframe()};e.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};e.prototype._initIframe=function(){var t=this;this._feedbackProvider.getFeedbackUrl().then(function(e){t.iframeUrl(e);t._loadTimer=t.async.setTimeout(t._onIframeTimeout,1e4)},function(e){t._headerText(k.errorHeader);t.bodyText(k.errorBody);t.state(m.default.error)})};e.prototype._onIframeTimeout=function(){if(this.state()===m.default.initialLoad){this._reportParatureLoadQos(_,!0);this._reportParatureStage(x);this.state(m.default.error);this._headerText(k.errorHeader);this.bodyText(k.errorBody)}};e.prototype._initListeners=function(){this.events.on(window,"message",this._onReceiveMessage)};e.prototype._onReceiveMessage=function(e){var t=this._feedbackProvider.getFeedbackEndpoints(),i=!1;if(e){for(var o=0,r=t;o<r.length;o++){var n=r[o];if(i=e.origin.startsWith(n))break}if(i){var a={};try{a=JSON.parse(e.data)}catch(e){}a.action?this._handleReceivedAction(a.action):a.location?this.state()===m.default.initialLoad&&this._onParatureLoaded():void 0!==a.height||a.name}}};e.prototype._handleReceivedAction=function(e){switch(e){case"submit":this._reportParatureStage(f);break;case"cancel":this.onCloseClicked();break;case"confirmation":this._onConfirmed()}};e.prototype._onParatureLoaded=function(){this.async.clearTimeout(this._loadTimer);if(this.state()!==m.default.error){this._reportParatureLoadQos(_,!1);this.state(m.default.showingIframe);this._headerText(k.emailSupportTitle)}};e.prototype._onConfirmed=function(){this._reportParatureStage(v);this.state(m.default.done);this._headerText(k.successTitle)};e.prototype._reportParatureLoadQos=function(e,t){var i=this._qos[e];i||(i=this._qos[e]=new l.Qos({name:S+e}));i.end({resultType:t?h.ResultTypeEnum.Failure:h.ResultTypeEnum.Success})};e.prototype._reportParatureStage=function(e){var t=this._paratureEvents[e];t||(t=this._paratureEvents[e]=new d.Action({name:S+e,pageType:p.default[this._urlDataSource.getPageType()],queryType:u.default[this._urlDataSource.getQueryType()]}));t.end({resultType:h.ResultTypeEnum.Success})};return e}(n.default);t.default=P});define("odsp-next/models/feedback/FeedbackDialogState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.initialLoad=0]="initialLoad";e[e.showingIframe=1]="showingIframe";e[e.feedbackSent=2]="feedbackSent";e[e.done=3]="done";e[e.error=4]="error"}(i||(i={}));t.default=i});define("odsp-next/controls/feedback/Feedback.html",[],function(){return'<div class="od-feedback od-feedback-smaller"><div class=od-feedback-inner data-bind="css: {\'od-feedback--hasError\': state() === states.error }">\x3c!--ko if: state() === states.initialLoad--\x3e<div data-bind="component: progressSpinnerTagName"></div>\x3c!--/ko--\x3e\x3c!--ko if: iframeUrl().length--\x3e<iframe data-bind="attr: { src: iframeUrl }, visible: state() === states.showingIframe || state() === states.done"></iframe>\x3c!--/ko--\x3e\x3c!--ko if: state() === states.error--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/feedback/Feedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-feedback iframe{width:100%;height:400px;border:none}.od-feedback.od-feedback-smaller iframe{height:100%}.od-feedback-inner{height:400px}.od-feedback-smaller .od-feedback-inner{height:195px}.od-feedback-smaller .od-feedback-inner.od-feedback--hasError{height:auto}"}])});define("odsp-next/providers/sendFeedback/SendFeedbackProvider",["require","exports","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._sendFeedbackDataSource=t.sendFeedbackDataSource}e.prototype.sendFeedback=function(e){return this._sendFeedbackDataSource.sendFeedback(e)};return e}();t.default=r;t.resourceKey=o.createResolvedResourceKey(e("module").id,r,{sendFeedbackDataSource:i.sendFeedback})});define("odsp-next/controls/sendFeedback/SendFeedback",["require","exports","./SendFeedbackViewModel","../../bindings/component/ControlBinding","./SendFeedback.html","./SendFeedback.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-sendfeedback",template:e("./SendFeedback.html"),viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/sendFeedback/SendFeedbackViewModel",["require","exports","tslib","./SendFeedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-utilities/lib/string/StringHelper","../../models/feedback/FeedbackDialogState","../../providers/sendFeedback/SendFeedbackProvider"],function(e,t,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.states=l.default;i.state=e.state;i._retryTrigger=e.retryTrigger;i.feedbackResx=r.strings;i.email=$Config.email;i.lang=$Config.mktLocale;i.progressSpinnerTagName=a.default.tagName;i.hintText=i.feedbackResx.hintText;i.sendFeedbackBtnText=i.feedbackResx.sendFeedbackBtnText;i.bodyText=i.createPureComputed(i._computeBodyText);i.comment=e.comment;i._onComplete=e.onComplete;i.createComputed(i._onRetryTrigger);i.privacyStatementText=i.feedbackResx.privacyLink;i.privacyStatementUrl="https://privacy.microsoft.com/"+i.lang+"/privacystatement/";i._successMessage=s.format(i.feedbackResx.successBody,i.email);i._init();return i}e.prototype.dispose=function(){o.prototype.dispose.call(this)};e.prototype.onCloseClicked=function(){this._onComplete()};e.prototype._computeBodyText=function(){var e=this.state();return e===l.default.error?this.feedbackResx.errorBody:e===l.default.done?this._successMessage:""};e.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};e.prototype._init=function(){this.state(l.default.initialLoad)};e.dependencies=i.__assign({},n.default.dependencies,{sendFeedbackProvider:d.resourceKey});return e}(n.default);t.default=o});define("odsp-next/controls/sendFeedback/SendFeedback.html",[],function(){return'<div class="od-sendFeedback od-sendFeedback-smaller"><div class=od-sendFeedback-inner>\x3c!--ko if: state() === states.feedbackSent--\x3e\x3c!--ko component: { name: progressSpinnerTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-sendFeedback-area data-bind="visible: state() === states.initialLoad || state() === states.feedbackSent"><textarea class=od-sendFeedback-textarea hasfocus=true data-bind="attr: {\'aria-label\': hintText, placeholder: hintText }, textInput: comment"></textarea> <a class=od-sendFeedback-Privacy-Link target=_blank rel=“noopener” data-bind="attr: {href: privacyStatementUrl}, text: privacyStatementText"></a></div><div aria-live=assertive class=od-sendFeedback-response>\x3c!--ko if: state() === states.done--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e\x3c!--ko if: state() === states.error--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e</div></div></div>'});define("odsp-next/controls/sendFeedback/SendFeedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-sendFeedback-inner{height:400px}.od-sendFeedback-smaller .od-sendFeedback-inner{height:195px}.od-sendFeedback-smaller .od-sendFeedback-inner.od-feedback--hasError{height:auto}html[dir=ltr] .od-Button-sendFeedback{float:right}html[dir=rtl] .od-Button-sendFeedback{float:left}.od-sendFeedback-textarea{width:100%;height:110px;resize:none;padding:4px}"}])});define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../CreateAlbumFromFolderOperator","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._itemSelectionHelper=e.itemSelectionHelper;t._itemReedemer=new(t.managed(a.default));return t}e.prototype.execute=function(e){var o=this;return this._itemSelectionHelper.resolveFirst().then(function(i){return o._itemReedemer.redeemItems([i],o).then(function(){return o.resources.consumeAsync(r.typeResourceKey).then(function(e){var t=new e({folder:i});return o.trackPromise(t.start())}).then(function(){return{resultType:n.ResultTypeEnum.Success}},function(){return{resultType:n.ResultTypeEnum.Failure}})})})};return e}(i.default);t.default=s});define("odsp-next/actions/createAlbumFromFolder/CreateAlbumFromFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,{},t)||this;i._albumProvider=t.albumProvider;i._context=e;i._payloads={createAlbumFromFolder:{folder:i.createObservable(e.folder),album:i.createObservable()}};return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e);t.type=n.default.createAlbumFromFolder;t.name=e.input;t.iconName=this._context.folder.iconName;t.payloads=this._payloads;e.output&&e.output.isAlbum&&this._payloads.createAlbumFromFolder.album(e.output);return t};e.prototype.onStart=function(e){return this._albumProvider.createAlbumFromFolder(this._context,e)};e.dependencies=i.__assign({},r.default.dependencies,{albumProvider:a.resourceKey});return e}(r.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("odsp-next/actions/orderPrints/odc/OrderPrintsExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/panel/PanelProvider","../../../controls/orderPrints/OrderPrints","../../base/ItemRedeemer"],function(e,t,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.actionName,o=e.itemSelectionHelper;t.name=i;t._itemSelectionHelper=o;t._itemReedemer=new(t.managed(l.default));t._panelProvider=t.resources.consume(a.resourceKey);return t}e.prototype.execute=function(e){var o=this;return this._itemSelectionHelper.resolveSelection().then(function(i){return o._itemReedemer.redeemItems(i,o).then(function(){var e=o.observables.create(""),t=o._panelProvider.requestPanel({title:e,component:{name:s.default.tagName,params:{selection:i,onComplete:function(){t.state(1)},title:e}}});return t.wait().then(function(){return{resultType:n.ResultTypeEnum.Success}},function(){return{resultType:n.ResultTypeEnum.Failure}})})})};return e}(o.default);t.default=r});define("odsp-next/controls/orderPrints/OrderPrints",["require","exports","./OrderPrintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OrderPrints.html","./OrderPrints.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-order-prints",template:e("./OrderPrints.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/orderPrints/OrderPrintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./OrderPrints.resx","../commands/Commands.resx","../../providers/album/AlbumProvider.key","./OrderPrintsState","../progressSpinnerFlat/ProgressSpinnerFlat"],function(e,t,r,i,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(o,i);function o(e){var t=i.call(this,e)||this;t._onComplete=e.onComplete;t.selection=e.selection;t.orderPrintsStates=l.default;t.currentState=t.createObservable(l.default.splash);t.orderPrintsResx=n;t.splashImageSrc=t.createObservable(FilesConfig.imgBaseUrl+"/partners/walgreens2.png");t.orderPrintsIframeUrl=t.createObservable("");t.progressSpinnerFlatTagName=d.default.tagName;t.events.on(window,"message",t._onReceiveMessage);t._title=t.createComputed(t._computeTitle);e.title&&t.createComputed(function(){return e.title(t._title())});return t}o.prototype.onPrintButtonClicked=function(e,t){var i=this;this.currentState(l.default.loading);this.resources.consumeAsync(s.resourceKey).then(function(e){return e.getWalgreensLandingPageUrl(i.selection)}).then(function(e){i.orderPrintsIframeUrl(e.landingUrl);i.currentState(l.default.core)},function(e){i.currentState(l.default.error)})};o.prototype.onCloseButtonClicked=function(e,t){this._onComplete()};o.prototype._computeTitle=function(){var e="";switch(this.currentState()){case l.default.splash:case l.default.loading:e=a.strings.OrderPrints;break;case l.default.core:e=this.orderPrintsResx.strings.PrintToWalgreens;break;case l.default.done:e=this.orderPrintsResx.strings.WalgreensSubmittedTitle}return e};o.prototype._onReceiveMessage=function(e){if(e&&-1<e.origin.indexOf(o.WALGREENS_ORIGIN)){var t=e.data;t===o.EVENT_CANCEL||t===o.EVENT_BACK?this._onComplete():t===o.EVENT_DONE?this._onSubmitted():this.currentState(l.default.error)}};o.prototype._onSubmitted=function(){this.currentState(l.default.done)};o.WALGREENS_ORIGIN=window.$Config&&$Config.isINT?"https://m5-qa.walgreens.com":"https://m5.walgreens.com";o.EVENT_CANCEL="action=cancel";o.EVENT_BACK="action=back";o.EVENT_DONE="action=done";return o}(i.default);t.default=o});define("odsp-next/controls/orderPrints/OrderPrintsState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.splash=0]="splash";e[e.loading=1]="loading";e[e.core=2]="core";e[e.done=3]="done";e[e.error=4]="error"}(i||(i={}));t.default=i});define("odsp-next/controls/orderPrints/OrderPrints.html",[],function(){return'<div class=od-OrderPrints><div class=od-OrderPrints-splash data-bind="visible: currentState() === orderPrintsStates.splash"><p data-bind="text: orderPrintsResx.strings.WalgreensSplashText" class=od-OrderPrints-splashText></p><div class=od-OrderPrints-centered><img data-bind="attr: {src: splashImageSrc()}"></div></div><div class=od-OrderPrints-progressSpinner data-bind="component: {name: progressSpinnerFlatTagName}, visible: currentState() === orderPrintsStates.loading"></div><div class=od-OrderPrints-iframe data-bind="visible: currentState() === orderPrintsStates.core"><iframe data-bind="attr: {src: orderPrintsIframeUrl()}"></iframe></div><div class=od-OrderPrints-complete data-bind="visible: currentState() === orderPrintsStates.done"><p data-bind="text: orderPrintsResx.strings.WalgreensSubmitted"></p></div><div class=od-OrderPrints-error data-bind="visible: currentState() === orderPrintsStates.error"><p data-bind="text: orderPrintsResx.strings.WalgreensError"></p></div><div class="od-OrderPrints-actions od-OrderPrints-centered"><button type=button role=button class="od-Button od-Button--primary" data-bind="text: orderPrintsResx.strings.PrintToWalgreens, click: onPrintButtonClicked, visible: currentState() === orderPrintsStates.splash"></button></div></div>'});define("odsp-next/controls/orderPrints/OrderPrints.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OrderPrints-splash img{padding-bottom:24px;max-width:210px}.od-OrderPrints-splashText{margin-bottom:24px}.od-OrderPrints-centered{text-align:center}.od-OrderPrints iframe{border:none;width:100%;height:450px}.od-OrderPrints-actions button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/keyboardMap/KeyboardMap","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/icons/Icon"],function(e,t,i,o,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.strings,p=function(t){i.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.execute=function(){return this.resources.consume(n.resourceKey).requestDialog({title:c.keyboardShortcutsTitle,size:"Large",component:{name:a.default.tagName,params:{}},actions:[{name:c.ok,icon:new d.default("Cancel"),isDefault:!0,execute:function(){return o.default.wrap(2)}}]}).wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})};return e}(r.default);t.default=p});define("odsp-next/controls/keyboardMap/KeyboardMap",["require","exports","./KeyboardMapViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./KeyboardMap.html","./KeyboardMap.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-keyboard-map",template:e("./KeyboardMap.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/keyboardMap/KeyboardMapViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./KeyboardMap.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.strings=r.strings;var i=t.resources.consume(n.platformDetection);t.isMac=i.isMac;t.isPC=!i.isMac;return t}return e}(o.default);t.default=a});define("odsp-next/controls/keyboardMap/KeyboardMap.html",[],function(){return"<div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.arrowsDesc + '; ' + strings.arrowsAria + '; ' }\"><span class=od-KeyboardMap-key>&uarr; &darr; &larr; &rarr;</span> <span class=od-KeyboardMap-val data-bind=\"text: strings.arrowsDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.escDesc + '; ' + strings.escAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.escKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.escDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.spaceDesc + '; ' + strings.spaceKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.spaceKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.spaceDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.enterDesc + '; ' + strings.enterKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.enterKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.enterDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.altUpDesc + '; ' + strings.altUpAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.altUpKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.altUpDesc\"></span></li></ul></div><div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.renameDesc + '; ' + strings.renameKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.renameKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.renameDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deleteMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deleteMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deletePCKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deletePCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.toggleInfoDesc + '; ' + strings.toggleInfoKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.toggleInfoKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.toggleInfoDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showKeymapDesc + '; ' + strings.showKeymapAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showKeymapKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showKeymapDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showSearchDesc + '; ' + strings.showSearchAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showSearchKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showSearchDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showShareDesc + '; ' + strings.showShareKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showShareKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showShareDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.openContextualMenuDesc + '; ' + strings.openContextualMenuKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.openContextualMenuKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.openContextualMenuDesc\"></span></li></ul></div>"});define("odsp-next/controls/keyboardMap/KeyboardMap.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-KeyboardMap-group{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.od-KeyboardMap-table{display:table;list-style:none;margin:0;padding:0}.od-KeyboardMap-row{display:table-row}.od-KeyboardMap-row span{display:table-cell}.od-KeyboardMap-key{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";min-width:55px}.od-KeyboardMap-val{padding:4px 8px}"}])});define("odsp-next/actions/redeemCode/odc/RedeemCodeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ProviderResourceKeys","../../../controls/redeemCodeDialog/RedeemCodeDialog","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/guid/Guid","../../../controls/redeemCodeDialog/RedeemCodeDialog.resx"],function(e,t,o,i,r,a,s,l,n,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=p.strings,h=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.maxNameLength=255;t._token=e.redeemCode;t._storageInfoProvider=t.resources.consume(r.storageInfo);t._dialogProvider=t.resources.consume(n.resourceKey);t._redeemSuccess=e.redeemSuccess;t.supportInlineSharing=!0;return t}e.prototype.execute=function(){var e=this,t=this.observables.create(""),i=this.observables.create(!1),o=this.observables.create(!0),r=this.observables.create(!0),n=c.default.generate();return this._dialogProvider.requestDialog({title:"",component:{name:a.default.tagName,params:{token:this._token,automationId:"redeemDialog",status:t,hasError:i,isEnabled:o,hasFocus:r}},actions:[{name:u.Redeem,execute:function(){t(s.strings.Saving);o(!1);i(!1);return e._storageInfoProvider.redeemCode({token:e._token(),trackingGuid:n}).then(function(){e._redeemSuccess(!0);return 2},function(e){i(!0);o(!0);r(!0);t(e);return 1})},isAvailable:this.observables.pureCompute(function(){return!!e._token()&&o()}),isDefault:!0,icon:new d.default("CirclePlus"),automationId:"redeemDialogCommit"}]}).wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})};return e}(i.default);t.default=h});define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog",["require","exports","./RedeemCodeDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RedeemCodeDialog.html","./RedeemCodeDialog.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-redeemcode-dialog",template:e("./RedeemCodeDialog.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RedeemCodeDialog.resx","knockout"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r.strings,s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.tokenLabel=a.TokenLabel;t.token=e.token;t.status=e.status||n.observable("");t.hasError=e.hasError||n.observable(!1);t.isEnabled=e.isEnabled||n.observable(!0);t.hasFocus=e.hasFocus||n.observable(!0);return t}return e}(i.default);t.default=s});define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog.html",[],function(){return'<div class=od-RedeemCode><div class=od-TextField><label class="od-RedeemCode-nameLabel ms-Label" data-bind="text: tokenLabel"></label> <input class="od-RedeemCode-nameInput od-TextField-field" type=text data-bind="value: token, textInput: token, hasFocus: hasFocus, automation: automationId, css: { \'od-RedeemCode-input--error\': hasError }, enable: isEnabled"></div><div class=od-RedeemCode-status data-bind="text: status, css: { \'od-RedeemCode-status--error\': hasError }"></div></div>'});define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-RedeemCode-nameLabel{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-RedeemCode-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RedeemCode-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-RedeemCode-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}"}])});define("odsp-next/actions/editTags/odc/EditTagsExecutor",["require","exports","tslib","../../../resources/ProviderResourceKeys","../../../controls/tagEditor/TagEditor","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer","../../../controls/tagEditor/TagEditor.resx","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,o,a,s,r,l,n,d,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._currentItem=e.currentItem;t._selectionHelper=e.selectionHelper;t._itemReedemer=new(t.managed(n.default));t._panelProvider=t.resources.consume(r.resourceKey);t._tagProvider=t.resources.consume(a.tag);return t}e.prototype.execute=function(){var n=this;return this._selectionHelper.resolveSelection().then(function(t){var i=[],o=[],r=n.resources.consume(a.photo).getAllPhotosSettings().peek();return n._itemReedemer.redeemItems(t,n).then(function(){var e={selection:t,tagsToAdd:i,tagsToDelete:o};return n._panelProvider.requestPanel({title:d.strings.title,scrollMode:"always",component:{name:s.default.tagName,params:e}}).wait().then(function(){return 0<i.length||0<o.length?n._tagProvider.updateTags({items:t,tagsToAdd:i,tagsToDelete:o,parentKey:n._currentItem.key,rootItemId:r.rootId}).then(function(){return{resultType:l.ResultTypeEnum.Success}},function(){return{resultType:l.ResultTypeEnum.Failure}}):{resultType:l.ResultTypeEnum.Success}},function(){return{resultType:l.ResultTypeEnum.Failure}})})})};return e}(i.default);t.default=c});define("odsp-next/controls/tagEditor/TagEditor",["require","exports","./TagEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TagEditor.html","./TagEditor.css","../tagInput/TagInput","../list/TagsList"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-tag-editor",template:e("./TagEditor.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/tagEditor/TagEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./TagEditor.resx","../../models/tag/TagSourceOptions","../../resources/ProviderResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../../models/itemSet/ItemSet","../../models/item/OneDriveItem","@ms/odsp-utilities/lib/object/ObjectUtil","../../models/selection/ItemSetSelectionModel","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../bindings/keyboard/KeyboardBinding","../loadingSpinner/LoadingSpinner"],function(n,e,t,a,i,s,m,l,d,o,c,p,u,h,g,f,b){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.loadingSpinnerTagName=b.default.tagName;t.addBindingHandlers({keyboard:f.default});t.TagEditorResx=s;t._tagProvider=t.resources.consume(l.tag);t._photoProvider=t.resources.consume(l.photo);t.emptyTagsImageUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"):n("@ms/odsp-media/dist/media/images/emptyFolder/empty_tags.svg");t.isExistingTagsEmpty=a.observable(!1);t.isTextBoxSelected=a.observable(!0);t.tagInput=a.observable("");t.isLoadingExistingTags=a.observable(!1);t._resolvedTags=a.observableArray(t._getCommonTags(e.selection));t.listRange=a.observable({start:0,end:0});t.listRange.equalityComparer=u.deepCompare;t.tagInputParams={inputText:t.tagInput,resolvedTags:t._resolvedTags,tagsToAdd:e.tagsToAdd,tagsToDelete:e.tagsToDelete,isTextBoxSelected:t.isTextBoxSelected};var i=new p.default,o=new c.default;o.item=a.observable(i);t.existingTagsSet=t.resources.expose(d.currentItemSet,a.observable(o));t.itemSelectionModel=t.resources.expose(d.itemsSelection,new(t.managed(h.default)));t.createComputed(t._computeAllExistingTagsForQuery).extend({rateLimit:250});t.createComputed(t._computeEnsureThumbnails);return t}e.prototype.getThumbnailUrl=function(e){var t="";e.folder&&e.folder.covers&&0<e.folder.covers.length&&(t=o.format(e.folder.covers[0].url,50,50));return t};e.prototype.onBackspace=function(e){var t=0<=this.itemSelectionModel.getFocusIndex();if(t){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!t};e.prototype.onUp=function(e){if(0===this.itemSelectionModel.getFocusIndex()){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!1};e.prototype._getTagFieldColumn=function(){return{key:"",name:name,minWidth:240,width:240,isVisible:!0,isVisibleMobile:!0,isCollapsable:!1,groupable:!1,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:g.ColumnFieldType.Tag,filterable:!1,isFocused:a.observable(!1)}};e.prototype._computeAllExistingTagsForQuery=function(){var t=this;this.isLoadingExistingTags(!0);var i=this._resolvedTags().map(function(e){return"#"+(e.localizedTag||e.tag)});this.itemSelectionModel.clear(!0);var o=this.tagInput(),r=this._tagProvider.getAllTagsForQuery(o,i);(this._existingTagsPromise=r).then(function(e){if(r!==t._existingTagsPromise)return null;t._existingTagsPromise=null;o||0!==i.length||t.isExistingTagsEmpty(0===e.content.peek().items.length);e.schema([t._getTagFieldColumn()]);t.existingTagsSet(e);t.isLoadingExistingTags(!1)})};e.prototype._computeEnsureThumbnails=function(){var e=this._photoProvider.getAllPhotosSettings(),t={rootItemId:e.peek().rootId,ascending:e.peek().isAscending,startIndex:0,parentKey:void 0};this._tagProvider.ensureHasThumbnails(this.existingTagsSet.peek(),this.listRange(),t)};e.prototype._getCommonTags=function(e){for(var t=e.length,i={},o={},r=[],n=0,a=e;n<a.length;n++)for(var s=a[n],l=0,d=s.tags&&s.tags.filter(function(e){return e.source!==m.default[m.default.LocationAndEventsAPI]&&e.source!==m.default[m.default.SystemDefined]&&!!e.tag});l<d.length;l++){var c=d[l],p=c.localizedTag||c.tag,u=(i[p]||0)+1;i[p]=u;o[p]=c}for(var h in i)i[h]>=t&&r.push(o[h]);return r};return e}(i.default);e.default=r});define("odsp-next/models/tag/TagSourceOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.LocationAndEventsAPI=0]="LocationAndEventsAPI";e[e.ObjectDetectors=1]="ObjectDetectors";e[e.LocationBasedPlace=2]="LocationBasedPlace";e[e.UserDefined=3]="UserDefined";e[e.SystemDefined=4]="SystemDefined"}(i||(i={}));t.default=i});define("odsp-next/controls/tagEditor/TagEditor.html",[],function(){return'<div class=od-TagEditor data-bind="keyboard: { Backspace: onBackspace, Up: onUp, allowInputEvents: true }"><div data-bind="component: { name: \'od-tag-input\', params: tagInputParams }"></div>\x3c!--ko if: isExistingTagsEmpty--\x3e<div class=od-TagEditor-emptyExistingTags><img class=od-TagEditor-emptyExistingTags-image data-bind="attr:{src: emptyTagsImageUrl, height: 112 }"><div class="ms-font-xl ms-fontWeight-semilight od-TagEditor-emptyExistingTags-title" data-bind="text: TagEditorResx.strings.addFirstTagTitle"></div><div class="ms-font-m ms-fontWeight-semilight" data-bind="text: TagEditorResx.strings.addFirstTagDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: !isExistingTagsEmpty()--\x3e<div class="od-TagEditor-title ms-font-l ms-fontWeight-semilight" data-bind="text: TagEditorResx.strings.addExistingTagTitle"></div><span class=od-TagEditor-existingTags data-bind="component: { name: \'od-tags-list\', params: { itemSet: existingTagsSet, requiredRange: listRange, selectionModel: itemSelectionModel, isSelectionOnKeyInputEnabled: false } }"></span>\x3c!--ko if: isLoadingExistingTags--\x3e<span class=ms-font-m data-bind="component: { name: \'ms-loadingSpinner\', params: { loadingText: TagEditorResx.strings.loading } }"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/tagEditor/TagEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-TagEditor{overflow:hidden}.od-TagEditor-label.ms-Label{display:none}.od-TagEditor-input{width:100%}.od-TagEditor-existingTags .DetailsRow{height:52px;line-height:52px}.od-TagEditor-existingTags .DetailsRow:hover .DetailsRow-check{display:none}.od-TagEditor-title{margin-top:20px;margin-bottom:10px}.od-TagEditor-emptyExistingTags{margin-top:30px;text-align:center}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-image{margin-bottom:20px}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-title{margin-bottom:10px}"}])});define("odsp-next/controls/tagInput/TagInput",["require","exports","./TagInputViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TagInput.html","./TagInput.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-tag-input",template:e("./TagInput.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/tagInput/TagInputViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./TagInput.resx","../../bindings/keyboard/KeyboardBinding","../../bindings/scrollIntoView/ScrollIntoViewBinding","../../models/tag/TagSourceOptions","../../models/tag/TagTypeOptions","../../resources/ControlResourceKeys"],function(e,t,i,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){i.__extends(e,t);function e(e){var i=t.call(this)||this;i.error=r.observable("");i.addBindingHandlers({keyboard:a.default,scrollIntoView:s.default});i.inputChange=function(e,t){i._inputChangeOuter(t)};i.scrollDown=r.observable(!1);i.inputText=e.inputText;i._tagsToAdd=e.tagsToAdd;i._tagsToDelete=e.tagsToDelete;i._initialCommonTags=e.resolvedTags&&e.resolvedTags().slice(0)||[];i.resolvedTags=e.resolvedTags;i.maxTagLength=256;i.isDeleteMode=r.observable(!1);i._inputBoxWasEmpty=!0;i.showPlaceholder=r.observable(!0);i.inputPlaceholder=i.createComputed(function(){return""===i.inputText()&&0===i.resolvedTags().length?n.strings.InputPlaceholderText:""});i.inputSize=i.createComputed(function(){return i.inputText().length+1});i._selectionModel=i.resources.consume(c.itemsSelection);i._selectionModel.selection.subscribe(function(e){0<e.length&&i._resolveTag(e[0].peek().name)});i.isSelected=e.isTextBoxSelected;return i}e.prototype.removeItem=function(e){for(var t=0;t<this._initialCommonTags.length;t++)e===this._initialCommonTags[t]&&this._tagsToDelete.push(e);var i=this._tagsToAdd.indexOf(e);-1!==i&&this._tagsToAdd.splice(i,1);this.resolvedTags.remove(e);this.isSelected(!0)};e.prototype.focus=function(){this.isSelected(!0);this.showPlaceholder()&&this.showPlaceholder(!1)};e.prototype.inputFocus=function(){this.showPlaceholder()&&this.showPlaceholder(!1)};e.prototype.inputBlur=function(){this.showPlaceholder()||0!==this.resolvedTags().length||0!==this.inputText().length||this.showPlaceholder(!0)};e.prototype.inputPaste=function(e,t){var i=this;this.async.setTimeout(function(){i._resolveTag(i.inputText());i.inputText("")},500);return!0};e.prototype.getTagDisplayText=function(e){return"#"+(e.localizedTag||e.tag)};e.prototype.onDown=function(e,t){this.isDeleteMode(!1);this._selectionModel.setIndexFocus(0);return!1};e.prototype._inputChangeOuter=function(e){var t=this;this._timer||this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};e.prototype._add=function(e){this.inputText("");this._tagsToAdd.push(e);this.resolvedTags.push(e);this._scrollIntoView()};e.prototype._inputChange=function(e){var t=e.keyCode,i=this.inputText().length;this._scrollIntoView();if(0===i){8===t&&this._inputBoxWasEmpty&&(this.isDeleteMode.peek()?this.removeItem(this.resolvedTags.pop()):this.isDeleteMode(!0));this._inputBoxWasEmpty=!0}else{this.isDeleteMode(!1);13===t||51===t&&e.shiftKey&&1<this.inputText().length?this._resolveTag(this.inputText()):this._inputBoxWasEmpty=!1}};e.prototype._scrollIntoView=function(){var e=this;this.async.setTimeout(function(){e.scrollDown(!0);e.scrollDown(!1)},1e3)};e.prototype._resolveTag=function(e){for(var t,i=e.split(/[,;#]/),o=0;o<i.length;o++){var r=i[o].trim();if(""!==r){t=this._getUserDefinedTag(r);this._add(t)}}this._inputBoxWasEmpty=!0;this.isSelected(!0);this.isDeleteMode(!1)};e.prototype._getUserDefinedTag=function(e){return{source:l.default[l.default.UserDefined],tag:e,type:d.default[d.default.keyword]}};return e}(o.default);t.default=p});define("odsp-next/models/tag/TagTypeOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.keyword=0]="keyword";e[e.Scene=1]="Scene";e[e.Location=2]="Location"}(i||(i={}));t.default=i});define("odsp-next/controls/tagInput/TagInput.html",[],function(){return'<div class=TagInput data-bind="click: function() {focus()}, css: { \'TagInput--isDeleteMode\': isDeleteMode }, attr: {title: inputPlaceholder}"><div class=TagInput-container>\x3c!--ko foreach: resolvedTags--\x3e<div class="TagInput-resolvedTag TagInput-entry"><a class="TagInput-resolvedTagLink ms-font-m" data-bind="attr: { title: $component.getTagDisplayText($data) }"><div class=TagInput-resolvedTagName data-bind="text: $component.getTagDisplayText($data)"></div></a> <a href=# class="TagInput-removeTag ms-font-m" data-bind="click: $component.removeItem.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></a></div>\x3c!--/ko--\x3e<input class="TagInput-textBox TagInput-entry" type=text autocomplete=off autocapitalize=off autocorrect=off autofocus data-bind="value: inputText, valueUpdate: \'keyup\', attr:{ size: inputSize, title: inputPlaceholder, maxlength: maxTagLength}, automation: \'addTagInput\', event:{ keyup: inputChange, focus: inputFocus, blur: inputBlur, paste: inputPaste }, hasFocus: isSelected, keyboard: { mappings: { Down: onDown }, context: $data, allowInputEvents: true }"> <span class="TagInput-ghostText TagInput-entry" aria-hidden=true data-bind="text: inputPlaceholder, visible: showPlaceholder"></span></div><div class=TagInput-belowContainer data-bind="scrollIntoView: { isSelected: scrollDown }"></div></div><div aria-live=assertive class=TagInput-error data-bind="text: error"></div>'});define("odsp-next/controls/tagInput/TagInput.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".TagInput{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:#fff;width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:150px;position:relative}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3){background-color:"},{theme:"themeSecondary",defaultValue:"#2f69c0"},{rawString:"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag:hover,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName:hover{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.TagInput-container{display:inline-block}.TagInput-ghostText{position:absolute;top:5px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";white-space:nowrap}[dir=ltr] .TagInput-ghostText{left:5px}[dir=rtl] .TagInput-ghostText{right:5px}.TagInput-textBox{border:0;vertical-align:inherit;background-color:transparent;margin:5px;vertical-align:top;outline:0}html[dir=ltr] .TagInput-textBox{float:left}html[dir=rtl] .TagInput-textBox{float:right}.TagInput-textBox::-ms-clear{display:none}.TagInput-textBox:focus{outline-color:transparent}.TagInput-removeItem{width:20px;font-weight:700;text-decoration:none;display:inline-block;font-size:10px;vertical-align:top}.TagInput-removeItem:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.TagInput-removeItem .ms-Icon--Cancel{padding:8px 5px 5px}.TagInput-error{color:#a80000}.TagInput-resolvedTag{font-size:12px;line-height:32px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:inline-block;height:32px;margin:0 8px 8px 0;white-space:nowrap}html[dir=ltr] .TagInput-resolvedTag{float:left}html[dir=rtl] .TagInput-resolvedTag{float:right}html[dir=rtl] .TagInput-resolvedTag{margin:0 0 8px 8px}.TagInput-resolvedTagLink{display:inline-block;overflow:hidden;cursor:pointer}.TagInput-resolvedTagName{display:inline-block;padding:0 8px;max-width:180px}.TagInput-removeTag:hover,.TagInput-resolvedTagLink:hover,.od-Focus--enabled .TagInput-removeTag:focus,.od-Focus--enabled .TagInput-resolvedTagLink:focus{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.TagInput-removeTag{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";width:32px;text-decoration:none;display:inline-block;vertical-align:top;text-align:center}"}])});define("odsp-next/actions/shareByLink/odc/ShareByLinkExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/dialog/DialogProvider","../../../controls/sharing/sharingWizard/SharingWizard","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/loadingSpinner/LoadingSpinner","../../../models/item/ItemType","../../../controls/sharing/sharingWizard/SharingWizard.resx","../../../controls/sharing/shareByEmail/Sharing.resx","../../../providers/engagement/Engagement","../../../utilities/icons/Icon","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/list/ShortcutUtilities","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/textContainer/TextContainer","../../base/ItemRedeemer","../../../utilities/optimizely/ExperimentsCommon.key","../../../providers/item/ItemProvider"],function(e,t,i,m,g,f,b,y,v,x,_,S,k,P,a,w,o,C,I,s,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.canToggleEditInline=!0;t.hideInviteOptions=!0;t.requireSignInByDefault=!1;t.name=e.actionName;t._initialState=e&&e.startState?[1,e.startState]:[1];t._selectionHelper=e.selectionHelper;t._itemReedemer=new(t.managed(s.default));if(e&&e.item&&e.item())t._itemPromise=m.default.wrap([e.item()]);else if(e&&e.itemKey){var i=t.resources.consume(l.resourceKey);t._itemPromise=i.getSpecifiedItems({itemKeys:[e.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}t.urlDataSource=t.resources.consume(a.url);var o=e.sharingMethod,r=void 0===o?null:o;t.sharingMethod=r;return t}e.prototype.execute=function(){var h=this;this.trackPromise(this.resources.consumeAsync(r.resourceKey).then(function(e){e.fireShareEvent()}));return this._selectionHelper.resolveSelection().then(function(u){return h._itemReedemer.redeemItems(u,h).then(function(){var r=h.resources.consume(f.resourceKey);if(100<=u.length){var e=C.format(S.strings.MultiShareTitleText,u.length),t=C.format(S.strings.MultiShareOverLimit,100);return r.requestDialog({title:e,component:{name:I.default.tagName,params:{text:t}}}).wait().then(function(){return m.default.wrap({resultType:y.ResultTypeEnum.Success})})}for(var n=[],i=0;i<h._selectionHelper.selection().length;i++){var o=h._selectionHelper.selection()[i];n.push(o())}var a=h.observables.create([].concat(h._initialState)),s=h.observables.create(""),l=h.observables.create(!0),d=h._itemPromise,c=!1;if(!d){d=m.default.wrap(n);c=!0}if(!c)var p=r.requestDialog({title:S.strings.ShareText,size:"Medium",component:{name:v.default.tagName,params:{}}});return d.then(function(e){p&&p.dismiss();if(!e[0])return m.default.wrapError({resultType:y.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});var t=h.resources.consume(k.resourceKey);w.default.isShortcutItem(e[0])&&t.logData({name:"ShortcutLink.ShareByLinkInitiate"});var i=r.requestDialog({title:s,size:"Medium",shouldPreserveFocus:l,component:{name:b.default.tagName,params:{items:e,dialogTitle:s,stateArray:a,canToggleEditInline:h.canToggleEditInline,hideInviteOptions:h.hideInviteOptions,requireSignInByDefault:h.requireSignInByDefault,onExecuteAction:function(){return i.state(2)},shouldPreserveFocus:l,resources:h.resources,sharingMethod:h.sharingMethod}},titleAction:{name:_.strings.BackButtonText,execute:function(){var e=a();switch(e.pop()){case 2:t.logData({name:"GoBackSharedWith.SharingWizard.Click",isIntentional:!0});break;case 3:t.logData({name:"GoBackAddPeople.SharingWizard.Click",isIntentional:!0})}a(e);return m.default.wrap(1)},icon:new P.default("Back"),isVisible:h.observables.pureCompute(function(){return 1<a().length})}}),o=h.subscribe(h.resources.consume(g.currentItemSet),function(){i.dismiss()});return i.wait().then(function(){o.dispose();a([]);var e={},t={count:n.length};if(1===n.length){e.fileType=x.default[n[0].type];e.extension=n[0].extension||""}return{resultType:y.ResultTypeEnum.Success,extraData:e,extraMetrics:t}},function(e){o.dispose();a([]);return m.default.wrapError(e)})})})})};return e}(o.default);t.default=n});define("odsp-next/controls/sharing/sharingWizard/SharingWizard",["require","exports","./SharingWizardViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../sharingByLink/SharingByLink","./SharingWizard.html","./SharingWizard.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-shareWizard",template:e("./SharingWizard.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/sharing/sharingWizard/SharingWizardViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner","./SharingWizardTemplates","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../sharingWizard/SharingWizard.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/css/VisibilityBinding","../sharingHints/SharingHints"],function(e,t,o,r,i,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.loadingSpinnerTagName=n.default.tagName;t.sharingHintsTagName=u.default.tagName;t._params=e;t.addBindingHandlers({visibility:p.default});t._sharingProvider=t.resources.consume(s.resourceKey);t._stateStack=e.stateArray;t._currentState=t.createComputed(function(){return this._stateStack()[this._stateStack().length-1]});t.currentLink=r.observable(null);t._items=e.items;t._sharingMethod=e.sharingMethod;t._companyDisplayName=e.companyDisplayName;t._expiration=t.createObservable(null);t.componentDefinition=t.createComputed(function(){return t._getComponentDefinition()});t.isLoading=r.observable(!0);if(1<t._items.length){t._shareDialogTitle=c.format(d.strings.MultiShareTitleText,t._items.length);t._params.dialogTitle(t._shareDialogTitle);t.isLoading(!1)}else t._getSharingSettings();t.sharingHintsParams={guestLinkExists:r.observable(!1),sharedWithMany:r.observable(!1),sharingHintsOption:1,sharedWith:r.observableArray([]),items:t._items};return t}e.prototype._getSharingSettings=function(){var t=this,i=this._items[0],o=i.type===l.default.Folder?d.strings.MissingFolderTitle:d.strings.MissingFileTitle,e=this._sharingProvider.getSharingData(i);this.isReady=e.getSettings().then(function(e){t._sharingSettings=e;t._shareDialogTitle=t._sharingSettings.itemId?c.format(d.strings.TitleText,e.itemName):o;t._params.dialogTitle(t._shareDialogTitle);t.isLoading(!1)},function(e){t._shareDialogTitle=c.format(d.strings.TitleText,i.name);t._params.dialogTitle(t._shareDialogTitle);t.isLoading(!1)})};e.prototype._getComponentDefinition=function(){var e=a.getTemplateName(this._currentState()),t={items:this._items,dialogStateArray:this._stateStack,includeLinks:!0,currentLink:this.currentLink,height:"500px",canToggleEditInline:this._params.canToggleEditInline,onExecuteAction:this._params.onExecuteAction,shouldPreserveFocus:this._params.shouldPreserveFocus,sharingMethod:this._sharingMethod,selectedPeople:r.observableArray([]),hasUnresolvedText:r.observable(!1),companyDisplayName:this._companyDisplayName,expiration:this._expiration};4===this._currentState()?this._params.dialogTitle(d.strings.SwitchLink):this._params.dialogTitle(this._shareDialogTitle);3===this._currentState()&&(t={selectedPeople:r.observableArray([]),roleValue:r.observable(""),emailMessage:r.observable(""),errorMessage:r.observable(""),sendEmail:r.observable(!0),requireSignIn:r.observable(this._params.requireSignInByDefault),propagateSharing:r.observable(!1),hasUnresolvedText:r.observable(!1),emailMessageExceedsLimit:r.observable(!1),dialogTitle:r.observable(""),hideOptions:this._params.hideInviteOptions,showSendEmailOption:!0,onExecuteAction:this._params.onExecuteAction,items:this._items,currentLink:this.currentLink,sharingMethod:this._sharingMethod,companyDisplayName:this._companyDisplayName,expiration:this._expiration});return{name:e,params:t}};return e}(i.default);t.default=h});define("odsp-next/controls/sharing/sharingWizard/SharingWizardTemplates",["require","exports","../sharingByLink/SharingByLink","../sharedWith/SharedWith","../shareByEmail/ShareByEmail","../sharingLinksSwitcher/SharingLinksSwitcher"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTemplateName=function(e){switch(e){case 1:return i.default.tagName;case 2:return o.default.tagName;case 3:return r.default.tagName;case 6:case 4:return n.default.tagName;default:return i.default.tagName}};t.getBottomAction=function(e){switch(e){case 1:case 3:return 2;case 2:return 3;default:return 1}}});define("odsp-next/controls/sharing/sharingByLink/SharingByLink",["require","exports","./SharingByLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingByLink.html","./SharingByLink.css","../../panelHost/PanelHost"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-sharebylink",template:e("./SharingByLink.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/sharing/sharingByLink/SharingByLinkViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","../../../providers/engagement/Engagement","../../../models/teachingBubble/TeachingBubbleCampaigns","../../../utilities/dom/Dom","../../gleamCallout/GleamCallout","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/featureCards/FeatureCardsProvider","../../../providers/featureCards/FeatureCards.resx","./SharingByLink.resx","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","./SharingByLinkStringHelper","../../../utilities/attribution/AttributionHelper","../../../utilities/browser/ClipboardData","../../../resources/ControlResourceKeys","../../featureCards/FeatureCards","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../../../bindings/keyboard/KeyboardBinding","../../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../bindings/react/ReactBinding","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","../../../models/sharing/SharingNetworks","../../../bindings/teachingBubble/TeachingBubbleBinding","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features","../../../resources/ODCResourceKeys"],function(c,e,t,i,p,u,r,h,m,g,f,b,y,o,n,v,x,_,S,k,P,w,C,I,a,T,D,L,E,M,A,s,F,R){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l="ODCExpiringSharingLinks",O="ODCPasswordProtectedLinks",N="SharingByLinkDialog",B="        ",d=function(d){t.__extends(e,d);function e(e){var t=d.call(this,e)||this;t.loadingSpinnerTagName=I.default.tagName;t.passwordProtectedLinkIndicatorLabel=y.strings.passwordProtectedLinkIndicatorAriaLabel;t.addBindingHandlers({keyboard:C.default,react:D.default,selectOnFocus:L.default,teachingBubble:A.default});var i=e.canToggleEditInline,o=e.currentLink,r=e.dialogStateArray,n=e.expiration,a=e.items,s=e.onExecuteAction,l=e.shouldPreserveFocus;t._canToggleEditInline=i;t._dialogStateArray=r;t._items=a;t._onExecuteAction=s;t._shouldPreserveFocus=l;t._expiration=n;t._actionMap=t.resources.consume(S.actionMap);t._attributionHelper=t.resources.consume(x.resourceKey);t._instrumentationProvider=t.resources.consume(T.instrumentation);t._itemProvider=t.resources.consume(m.resourceKey);t._platform=t.resources.consume(g.platformDetection);t._sharingProvider=t.resources.consume(P.resourceKey);t._sharingLinkExpirationHelper=new(t.managed(E.default));t._storageOptionsProvider=t.resources.consume(T.storageOptions);t._userInfoProvider=t.resources.consume(T.userInfo);t._featureCardsProvider=t.resources.consume(f.resourceKey);t._engagement=t.resources.consume(p.resourceKey);t._odcUrlDataSource=t.resources.consume(R.urlDataSource);t.allowEditChecked=t.createObservable(!1);t.allowEditText=y.strings.AllowEdit;t.copyText=y.strings.CopyLinkText;t.currentSharingLink=o;t.error=t.createObservable("");t.displayFeatureCards=t.createObservable(!1);t.featureCardIndex=0;t.setPasswordChecked=t.createObservable(!1);t.featureCardsTagName=k.default.tagName;t.generatingLinkForSocialNetworkText=y.strings.generatingLinkForSocialNetworkText;t.getLinkText=y.strings.GetLink;t.gleamImageUrl="undefined"==typeof __webpack_public_path__?c.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):c("@ms/odsp-media/dist/media/images/premium/premium-gleam-single.svg");t.hasError=t.createObservable(!1);t.hasLoadingError=t.createObservable(!1);t.invalidPasswordText=y.strings.invalidPasswordError;t.inviteText=y.strings.AddPeopleEmail;t.isAllowEditVisible=t.createObservable(!0);t.isCopyLoadingVisible=t.createObservable(!1);t.isCreatingLink=t.createObservable(!1);t.isLinkDisabled=t.createObservable(!1);t.isManagePermissionsVisible=t.createObservable(t._canToggleEditInline);t.isMoreSectionVisible=t.createObservable(!1);t.isSingleLinkLabelVisible=t.createObservable(!1);t.linkExpiresText=y.strings.SetExpirationLabel;t.linkTitle=y.strings.ChangeLinkTitle;t.linkExpiresChecked=t.createObservable(!1);t.linkExpirationInDays=t.createObservable(E.DEFAULT_EXPIRATION).extend({notify:"always"});t.loading=t.createObservable(!0);t.manageAccessLink=y.strings.ManageAccessLink;t.managePermissionsText=y.strings.managePermissions;t.missingItemError=t._items[0].type===w.default.Folder?y.strings.MissingFolderError:y.strings.MissingFileError;t.moreOptionsText=y.strings.MoreOptions;t.moreSectionIcon=t.createPureComputed(t._computeMoreIcon);t.networksList=[M.default.Facebook,M.default.Twitter,M.default.LinkedIn,M.default.Weibo];t.networksList.forEach(function(e){e.isCreatingLink=t.createObservable(!1)});t.note=t.createObservable("");t.peopleSharingWith=t.observables.createArray();t.setPasswordPermissionsWarning=y.strings.SetPasswordPermissionsWarning;t.sharingLinkUrl=t.createObservable("");t.supportsCopy=(_.default.CanUseClipboardData()||document.queryCommandSupported&&document.queryCommandSupported("copy"))&&!t._platform.isIOS;t.setPasswordLabel=y.strings.SetPasswordLabel;t.passwordDisplayValue=t.createObservable("");t.passwordHasBeenUpdated=t.createObservable(!1);t.isPasswordInvalid=t.createComputed(t._computeIsPasswordInvalid);t._areNetworksSupported=t.createObservable(!1);t._expiringLinkGleamCalloutStrings={calloutTitle:b.strings.expiringLinksFeatureHeadline,calloutBody:b.strings.expiringLinksFeatureBody,premiumButtonText:y.strings.premiumButtonText,learnMoreButtonText:y.strings.learnMoreButtonText};t._passwordProtectedLinkGleamCalloutStrings={calloutTitle:b.strings.passwordProtectedLinksFeatureName,calloutBody:b.strings.passwordProtectedBody,premiumButtonText:y.strings.premiumButtonText,learnMoreButtonText:y.strings.learnMoreButtonText};t._isMultiSelect=1<t._items.length;t._defaultGleamCalloutIconUrl="undefined"==typeof __webpack_public_path__?c.toUrl("@ms/odsp-media/lib/images/premium/diamond-blue-background-24.svg"):c("@ms/odsp-media/dist/media/images/premium/diamond-blue-background-24.svg");t._sharingLinksCollection=t.observables.createArray();t._showExpiringLinkTeachingBubble=t.createObservable(!1);t._expiringLinkUpgradeNavigationAction=t._createExpiringLinkUpgradeNavigationAction();t._passwordProtectedLinkUpgradeNavigationAction=t._createPasswordProtectedLinkUpgradeNavigationAction();t._showAction=new(t.managed(t._actionMap.ShowPermissionsAction));t.createComputed(t._onCurrentSharingLinkUpdated);t.createComputed(t._onAllowEditToggled);t.featureCardData=t._getFeatureCardsData();t.arrowIcon=t.createPureComputed(t._computeArrowIcon);t.isNetworksSectionVisible=t.createPureComputed(t._computeIsNetworksSectionVisible);t.isPremiumEligible=t.createPureComputed(t._computeIsPremiumEligible);t.isPremium=t.createComputed(t._computeIsPremium);t.arePasswordProtectedLinksEnabled=F.isFeatureEnabled(F.EnablePasswordProtectedLinks);t.createBackgroundComputed(t._onSetPasswordChecked);t.isPasswordProtectedLinksBannerVisible=t.createPureComputed(t._computeIsPasswordProtectedLinksBannerVisible);t.createBackgroundComputed(t._computeValidInput);t.linkExpiresInputLabel=t.createPureComputed(t._computeLinkExpiresInputLabel);t.createBackgroundComputed(t._linkExpirationChanged);t.createBackgroundComputed(t._onLinkExpiresChecked);t._isExpiringLinkCalloutOpen=t.createObservable(!1);t._isPasswordProtectedLinkCalloutOpen=t.createObservable(!1);t._userInfoProvider.getExpiringSharingLinksSeen().then(function(e){if(!e){t.isAllowEditVisible(!0);t.isPremiumEligible.peek()?t.async.setTimeout(function(){t._isExpiringLinkCalloutOpen(!0)},0):t.async.setTimeout(function(){t._showExpiringLinkTeachingBubble(!0)},0);t._userInfoProvider.setExpiringSharingLinksSeen()}});t.expiringLinkTeachingBubbleOptions={campaign:t.createObservable(u.EXPIRING_SHARING_LINKS),isVisible:t._showExpiringLinkTeachingBubble};t.gleamCalloutComponent=h.GleamCallout;t.expiringLinkGleamCalloutComponentProps=t.createPureComputed(t._computeExpiringLinkGleamCalloutProps);t.passwordProtectedLinkGleamCalloutComponentProps=t.createPureComputed(t._computePasswordProtectedLinkGleamCalloutProps);t.sharingHintText=t.createComputed(function(){var e=t.currentSharingLink();if(e)return v.getLinkHintText(e,null,t.peopleSharingWith())});t._checkForSpecialFolder();t._getSharingInfo();return t}e.prototype.getNetworkAltText=function(e){return e.altText};e.prototype.logCopy=function(e,t,i){var o=this;this._engagement.logData({name:this.currentSharingLink().tag+"Link."+N+".Copy",isIntentional:!0,extraData:{linkExpiration:this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0",hasPassword:0!==this.passwordDisplayValue.peek().length}});if(i){this.isCopyLoadingVisible(!0);this.async.setTimeout(function(){o.isCopyLoadingVisible(!1)},1e3)}return!0};e.prototype.onClickCopyLink=function(e,t){var i=!1,o=r.findAncestor(t.target,"od-SharingByLink-row").getElementsByTagName("input")[0];try{o.select();i=document.execCommand("copy")}catch(e){}!i&&_.default.CanUseClipboardData()&&(i=!!_.default.CopyToClipboard(this.currentSharingLink().url));this.logCopy(e,t,i);return!0};e.prototype.onClickCreateLink=function(){this.canManageLinks&&this._createLink()};e.prototype.onMoreOptionsClicked=function(){this.isMoreSectionVisible(!this.isMoreSectionVisible.peek());return!1};e.prototype.onNetworkClicked=function(e,t){var i=this;if(this.currentSharingLink().url)M.default.open(e,this.currentSharingLink().url);else{e.isCreatingLink(!0);this._createLink(!0).then(function(){e.isCreatingLink(!1);M.default.open(e,i.currentSharingLink().url)})}this._engagement.logData({name:o.UsageName[this._getNetworkUsageName(e.name)],isIntentional:!0,location:o.LocationName[o.LocationName.SharingDialog],usageType:n.UsageType[n.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!1};e.prototype.onSetPasswordClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=1;this._isPasswordProtectedLinkCalloutOpen(!0)}return!0};e.prototype.showInvite=function(){if(!this.isCreatingLink.peek()){if(this._dialogStateArray){this._engagement.logData({name:"AddPeople."+N+".Click",isIntentional:!0});if(this.linkExpiresChecked.peek()){var e=this.linkExpirationInDays.peek(),t=this._sharingLinkExpirationHelper.computeExpirationValidity(e);t===E.LinkExpirationValidity.Valid?this._expiration(this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(e,10))):t===E.LinkExpirationValidity.Empty?this._expiration(null):t===E.LinkExpirationValidity.Invalid&&this._expiration(null)}else this._expiration(null);var i=this._dialogStateArray();i.push(3);this._dialogStateArray(i)}return!1}};e.prototype.showPermissions=function(e,t){this._shouldPreserveFocus(!1);new(this.managed(this._actionMap.ShowPropertiesAction))({useToggleBehavior:!1}).execute(t);this._engagement.logData({name:"ManagePermissions."+N+".Click",isIntentional:!0});this._onExecuteAction();new(this.managed(this._actionMap.ShowPermissionsAction))({item:this.createObservable(this._items[0])}).execute(t);return!1};e.prototype.switchLinks=function(){this.canManageLinks&&this.isAllowEditVisible(!this.isAllowEditVisible.peek())};e.prototype.onLinkExpiresClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=0;this._isExpiringLinkCalloutOpen(!0)}return!0};e.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1);0===this._currentPremiumFeatureGleamShowing?this._isExpiringLinkCalloutOpen(!0):1===this._currentPremiumFeatureGleamShowing&&this._isPasswordProtectedLinkCalloutOpen(!0)};e.prototype.onPasswordDefined=function(){this.onPasswordChanged()||this.onClickCreateLink()};e.prototype.onPasswordChanged=function(){var e=this.currentSharingLink.peek(),t=e&&0<e.url.length;if(t){this.passwordHasBeenUpdated(!0);this._onLinkExpiresOrPasswordSettingChanged()}return t};e.prototype.clearPasswordDisplayValue=function(){this.passwordDisplayValue("")};e.prototype.launchPermissionsPanel=function(e){this._engagement.logData({name:l+".PasswordBannerManageAccessClicked",isIntentional:!0});this._executeShowPermissionsPanel(e)};e.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};e.prototype._onSetPasswordChecked=function(){var e=this.setPasswordChecked(),t=this.currentSharingLink.peek(),i=t&&t.hasPassword,o=i&&!e;i&&e?this.passwordDisplayValue(B):this.passwordDisplayValue("");o&&this.onPasswordChanged()};e.prototype._computePasswordProtectedLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isPasswordProtectedLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,O,this._passwordProtectedLinkUpgradeNavigationAction),learnMoreAction:this._showPasswordProtectedLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,O,!1,function(){e._isPasswordProtectedLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,O,!0,function(){e._isPasswordProtectedLinkCalloutOpen(!0)}),strings:this._passwordProtectedLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};e.prototype._computeIsPasswordInvalid=function(){return!(!this.passwordHasBeenUpdated.peek()&&this.passwordDisplayValue()===B)&&(0!==this.passwordDisplayValue().length&&0===this.passwordDisplayValue().trim().length)};e.prototype._onGleamCalloutStateChange=function(e,t,i){var o=t?"UpsellShown":"UpsellDismissed";this._engagement.logData({name:e+"."+o});i()};e.prototype._showPasswordProtectedLinkFeatureCards=function(){this._engagement.logData({name:O+".LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.passwordProtectedLinkFeatureCardsIndex;this.displayFeatureCards(!0)};e.prototype._getFeatureCardsData=function(){var i=this,e=this._featureCardsProvider.getFeatureCards();e&&e.forEach(function(e,t){3===e.type&&(i.expiringLinkFeatureCardsIndex=t);8===e.type&&(i.passwordProtectedLinkFeatureCardsIndex=t)});return e};e.prototype._createPasswordProtectedLinkUpgradeNavigationAction=function(){return this._createNavigationAction("PasswordProtectedLinks")};e.prototype._createNavigationAction=function(e){var t=this._attributionHelper.getPurchaseAttribution({source:e,cta:"GoPremium"}),i=this.resources.consume(S.actionMap);return new(this.managed(i.NavigationAction))({url:this._odcUrlDataSource.getUpgradeOptionsUrl(t,!0)})};e.prototype._computeExpiringLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isExpiringLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,l,this._expiringLinkUpgradeNavigationAction),learnMoreAction:this._showExpiringLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,l,!1,function(){e._isExpiringLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,l,!0,function(){e._isExpiringLinkCalloutOpen(!0)}),strings:this._expiringLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};e.prototype._goToUpgradePage=function(e,t){this._engagement.logData({name:e+".GoPremiumClicked",isIntentional:!0});t.execute(null);t.dispose()};e.prototype._createExpiringLinkUpgradeNavigationAction=function(){return this._createNavigationAction("ExpiringLinks")};e.prototype._showExpiringLinkFeatureCards=function(){this._engagement.logData({name:l+".LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.expiringLinkFeatureCardsIndex;this.displayFeatureCards(!0)};e.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10);this.linkExpirationInDays(0<t&&t<=E.MAX_EXPIRATION?t.toString():"")};e.prototype._checkForSpecialFolder=function(){this._items[0].isSpecialFolder&&this.note(y.strings.specialFolderNote)};e.prototype._computeLinkExpirationInDays=function(e){var t=this.currentSharingLink.peek(),i=parseInt(E.DEFAULT_EXPIRATION,10);t&&t.expiration&&(i=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(t.expiration)));var o=i.toString();this._lastExpiration=e?o:null;this.linkExpirationInDays(o)};e.prototype._computeArrowIcon=function(){return this.unwrapObservable(this.sharingHintText)?this._computeChevron(this.isAllowEditVisible()):""};e.prototype._computeMoreIcon=function(){return this._computeChevron(!this.isMoreSectionVisible())};e.prototype._computeChevron=function(e){var t="Chevron"+(e?"Down":"Up");return i.getIconClassName(t)+" ms-Icon--"+t};e.prototype._computeIsNetworksSectionVisible=function(){return!!this._areNetworksSupported()&&!this._platform.isMobile};e.prototype._computeIsPremiumEligible=function(){return!!F.isFeatureEnabled(F.EnablePremiumCheckWebPasswordLinks)&&(!this._storageOptionsProvider.isReady()||this._storageOptionsProvider.isEligibleForPremium.peek())};e.prototype._computeIsPremium=function(){return!F.isFeatureEnabled(F.EnablePremiumCheckWebPasswordLinks)||!!this._storageOptionsProvider.isReady()&&this._storageOptionsProvider.hasOffice.peek()};e.prototype._computeIsPasswordProtectedLinksBannerVisible=function(){return this.arePasswordProtectedLinksEnabled&&this.currentSharingLink().url&&this.setPasswordChecked()};e.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};e.prototype._onLinkExpiresChecked=function(){this.linkExpiresChecked()?this._computeLinkExpirationInDays(!1):this.linkExpirationInDays("")};e.prototype._linkExpirationChanged=function(){var e=this.currentSharingLink.peek(),t=this.linkExpirationInDays();if(e)if(e.type===this._lastLinkType){if(e.url){if(this._sharingLinkExpirationHelper.computeExpirationValidity(t)!==E.LinkExpirationValidity.Invalid&&this._lastExpiration!==t){this._onLinkExpiresOrPasswordSettingChanged();this._lastExpiration=t}}}else this._lastLinkType=e.type};e.prototype._onLinkExpiresOrPasswordSettingChanged=function(){var s=this,l=this.currentSharingLink.peek(),e=this.linkExpirationInDays.peek(),t=this.passwordHasBeenUpdated.peek(),i=this.passwordDisplayValue.peek();this._engagement.logData({name:N+".UpdateLink",extraData:{linkExpiration:this.linkExpiresChecked.peek()?e:"0",hasPassword:0!==i.length}});this.isCreatingLink(!0);this.isLinkDisabled(!0);var o={type:l.type,role:l.role,create:!0};if(this.isPremium.peek()){(l.expiration||this._lastExpiration!==e)&&(o.expiration=this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(e,10)));this.isPasswordInvalid.peek()?o.password="":t&&i!==B&&(o.password=i)}this._sharingProvider.manageSharingLinks(this._items,o).then(function(e){for(var t=e.filter(function(e){return s._items[0].id===e.item.id&&e.type===l.type})[0]||e[0],i=!1,o=s._sharingLinksCollection.peek(),r=0,n=o;r<n.length;r++){var a=n[r];if(a.id===t.id&&a.isActive){t.expiration&&(a.expiration=t.expiration);t.hasPassword&&(a.hasPassword=t.hasPassword);i=!0}}i||o.push(t);s._sharingLinksCollection(o);s.currentSharingLink(t);t.hasPassword&&s.passwordDisplayValue(B);s._itemProvider.invalidateItem(s._items[0].key,{triggerFetch:!0})});this.passwordHasBeenUpdated(!1)};e.prototype._createLink=function(e){var o=this,r=this.allowEditChecked.peek()?6:5,t=this.allowEditChecked.peek()?2:1,i=this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0";if(!e){this.isCreatingLink(!0);this.isLinkDisabled(!0)}var n={type:r,role:t,create:!0,expiration:this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(i,10))};if(this.arePasswordProtectedLinksEnabled){this.isPasswordInvalid.peek()&&(n.password="");0!==this.passwordDisplayValue.peek().length&&(n.password=this.passwordDisplayValue.peek())}this._engagement.logData({name:N+".CreateLink",extraData:{linkExpiration:i,hasPassword:0!==this.passwordDisplayValue.peek().length}});return this._sharingProvider.manageSharingLinks(this._items,n).then(function(e){var t=e.filter(function(e){return o._items[0].id===e.item.id&&e.type===r})[0]||e[0],i=o._sharingLinksCollection.peek();i.push(t);o._sharingLinksCollection(i);o.currentSharingLink(t);o._enableLink();t.hasPassword&&o.passwordDisplayValue(B);o._itemProvider.invalidateItem(o._items[0].key,{triggerFetch:!0});return a.default.wrap(!0)})};e.prototype._enableLink=function(){var e=this;this.async.setTimeout(function(){e.isLinkDisabled(!1)},500)};e.prototype._isLinkExpired=function(e){if(e.expiration){return new Date(e.expiration).getTime()<=Date.now()}return!1};e.prototype._setCurrentSharingLink=function(e){var t=this;if(this._isLinkExpired(e)){var i=e.type,o=e.role,r={link:e,type:i,role:o,create:!1};this._sharingProvider.manageSharingLinks(this._items,r).then(function(e){t._sharingLinksCollection(e)});this.currentSharingLink({url:"",type:i,role:o});return!1}this.currentSharingLink(e);return!0};e.prototype._setDefaultSharingLink=function(){1===this._items.length&&!!(this._items[0].isAlbum||this._items[0].photo||this._items[0].video)?this.currentSharingLink({url:"",type:5,role:1}):this.currentSharingLink({url:"",type:6,role:2})};e.prototype._getBestSharingLink=function(e){var t=this;this.isReady=e.getBestSharingLink().then(function(e){e?t._setCurrentSharingLink(e):t._setDefaultSharingLink()},function(e){t.error(y.strings.ServerError)})};e.prototype._onAllowEditToggled=function(){var t=this,i=this.allowEditChecked(),e=this.currentSharingLink.peek();if(!(!e||i&&6===e.type||!i&&5===e.type)){this.isLinkDisabled(!0);this._sharingLinksCollection().some(function(e){return i&&6===e.type?t._setCurrentSharingLink(e):i||5!==e.type?void 0:t._setCurrentSharingLink(e)})||(i?this.currentSharingLink({url:"",type:6,role:2}):this.currentSharingLink({url:"",type:5,role:1}));this._computeLinkExpirationInDays(!0)}};e.prototype._getNetworkUsageName=function(e){var t=o.UsageName.SharedViaFacebook;e===M.default.Facebook.name?t=o.UsageName.SharedViaFacebook:e===M.default.Twitter.name?t=o.UsageName.SharedViaTwitter:e===M.default.LinkedIn.name?t=o.UsageName.SharedViaLinkedIn:e===M.default.Weibo.name&&(t=o.UsageName.SharedViaSinaWeibo);return t};e.prototype._getSharingInfo=function(){var e=this,t=this._sharingProvider.getSharingData(this._items[0]);this._getSharingSettings(t).then(function(){if(e._isMultiSelect){e._setDefaultSharingLink();e.isManagePermissionsVisible(!1);e.loading(!1)}else{e._getSharingLinks(t);e._getBestSharingLink(t)}})};e.prototype._getSharingLinks=function(e){var t=this;e.getLinks().then(function(e){null!=e&&t._sharingLinksCollection(e.filter(function(e){return e.item.id===t._items[0].id}))},function(e){t.error(y.strings.ServerError);t.loading(!1)})};e.prototype._getSharingSettings=function(e){var t=this;return this.isReady=e.getSettings().then(function(e){(t._sharingSettings=e).itemId||t.hasError(!0);t._areNetworksSupported(t._sharingSettings.networkLinksEnabled);t.canManageLinks=t._sharingSettings.canManageLinks;t.peopleSharingWith(t._sharingSettings.sharedWith)},function(e){e&&403===e.status?t.error(y.strings.AccessDenied):t.error(y.strings.ServerError);t.hasLoadingError(!0);t.loading(!1)})};e.prototype._onCurrentSharingLinkUpdated=function(){var e=this.currentSharingLink();if(e){this.sharingLinkUrl(e.url);this.allowEditChecked(6===e.type);this.linkExpiresChecked(!!e.expiration);this.setPasswordChecked(!!e.hasPassword);this.hasLoadingError(!1);this.loading(!1);this.isCreatingLink(!1);this._enableLink()}};return e}(s.default);e.default=d});define("odsp-next/controls/gleamCallout/GleamCallout",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/FocusZone","react","office-ui-fabric-react/lib/Styling","../banner/Banner.resx","./GleamCallout.css"],function(n,e,t,o,a,s,l,d,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isCalloutVisible:e.forceOpenCallout};return t}e.prototype.componentWillReceiveProps=function(e){this.setState({isCalloutVisible:e.forceOpenCallout})};e.prototype.componentDidUpdate=function(e,t){this.state.isCalloutVisible&&!t.isCalloutVisible?this.props.onOpened():!this.state.isCalloutVisible&&t.isCalloutVisible&&this.props.onDismissed()};e.prototype.render=function(){var e=this.props,t=this.state,i=this.props,o=i.strings,r=i.gleamCalloutHeaderIconUrl;return l.createElement("span",{className:"od-GleamCallout",onClick:this._showCallout},l.createElement("img",{className:"od-GleamCallout-gleam",ref:this._onGleamRef,src:"undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):n("@ms/odsp-media/dist/media/images/premium/premium-gleam-single.svg")}),t.isCalloutVisible&&l.createElement(a.Callout,{className:"od-GleamCallout-callout",directionalHint:12,directionalHintForRTL:5,gapSpace:2,onDismiss:this._onCalloutDismiss,target:this._gleam,setInitialFocus:!0},l.createElement(s.FocusZone,{className:"od-GleamCallout-calloutContent",isCircularNavigation:!0},l.createElement("button",{className:"od-GleamCallout-closeButton",onClick:this._onCalloutDismiss,"aria-label":c.strings.CloseLabel,title:c.strings.CloseLabel},l.createElement("i",{className:d.getIconClassName("Cancel")})),l.createElement("img",{className:"od-GleamCallout-headerImage",src:r}),l.createElement("h3",{className:"od-GleamCallout-title"},o.calloutTitle),l.createElement("p",{className:"od-GleamCallout-body"},o.calloutBody),l.createElement("div",null,l.createElement("button",{className:"od-Button od-GleamCallout-button od-GleamCallout-premiumButton",onClick:e.goPremiumAction},o.premiumButtonText),!this.props.isMobile&&l.createElement("button",{className:"od-Button od-Button--primary od-GleamCallout-button od-GleamCallout-learnButton",onClick:e.learnMoreAction},o.learnMoreButtonText)))))};e.prototype._showCallout=function(){this.setState({isCalloutVisible:!0})};e.prototype._onCalloutDismiss=function(){this.setState({isCalloutVisible:!1})};e.prototype._onGleamRef=function(e){this._gleam=e};t.__decorate([o.autobind],e.prototype,"_showCallout",null);t.__decorate([o.autobind],e.prototype,"_onCalloutDismiss",null);t.__decorate([o.autobind],e.prototype,"_onGleamRef",null);return e}(l.Component);e.GleamCallout=i});define("odsp-next/controls/gleamCallout/GleamCallout.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-GleamCallout-gleam{height:8px;margin-top:15px;width:8px}[dir=ltr] .od-GleamCallout-gleam{margin-left:6px}[dir=rtl] .od-GleamCallout-gleam{margin-right:6px}.od-GleamCallout-callout{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:274px}.od-GleamCallout-callout .ms-Callout-beak{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GleamCallout-callout .ms-Callout-main{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding-bottom:20px;padding-top:0}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-left:20px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-right:20px}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-right:12px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-left:12px}.od-GleamCallout-headerImage{height:36px}.od-GleamCallout-title{font-size:17px;font-weight:300;font-weight:600;margin-top:14px;margin-bottom:14px;cursor:pointer}.od-GleamCallout-button.od-Button{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:5px 8px;width:106px}.od-GleamCallout-premiumButton.od-Button{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-GleamCallout-premiumButton.od-Button{margin-right:20px}[dir=rtl] .od-GleamCallout-premiumButton.od-Button{margin-left:20px}.od-GleamCallout-premiumButton.od-Button:active,.od-GleamCallout-premiumButton.od-Button:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Button.od-Button--primary.od-GleamCallout-button.od-GleamCallout-learnButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-callout .od-Button.od-Button--primary{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-callout .od-Button.od-Button--primary:active,.od-GleamCallout-callout .od-Button.od-Button--primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-body{margin-bottom:20px}.od-GleamCallout-closeButton{background:0 0;border:none;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:block;height:20px;padding:12px 0 0 0}[dir=ltr] .od-GleamCallout-closeButton{margin-left:auto}[dir=rtl] .od-GleamCallout-closeButton{margin-right:auto}"}])});define("odsp-next/utilities/browser/ClipboardData",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(){}t.CopyToClipboard=function(e){return!!t.CanUseClipboardData()&&window.clipboardData.setData("Text",e)};t.CanUseClipboardData=function(){var e=window;return e&&void 0!==e.clipboardData&&void 0!==e.clipboardData.setData};return t}();t.default=i});define("odsp-next/models/sharing/SharingNetworks",["require","exports","./SharingNetwork.resx","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(t,e,i,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(){}e.open=function(e,t){var i=e.popupWidth,o=e.popupHeight,r=window.screenLeft||window.screenX||0,n=(window.innerWidth||0)/2-i/2+r,a=window.screenTop||window.screenY||0,s=(window.innerHeight||0)/2-o/2+a,l=e.url.replace("{{url}}",d.default.encodeURIComponent(t));window.open(l,"sharing_"+e.name,"resizable, width="+i+", height="+o+", left="+n+", top="+s)};e.Facebook={name:"fb",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}",popupWidth:626,popupHeight:436,text:i.strings.facebook,altText:i.strings.facebook,iconUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/networks/facebook.png"):t("@ms/odsp-media/dist/media/images/networks/facebook.png"),isCreatingLink:null};e.Twitter={name:"twitter",url:"http://twitter.com/share?url={{url}}",popupWidth:550,popupHeight:300,text:i.strings.twitter,altText:i.strings.twitter,iconUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/networks/twitter.png"):t("@ms/odsp-media/dist/media/images/networks/twitter.png"),isCreatingLink:null};e.LinkedIn={name:"linkedin",url:"http://www.linkedin.com/shareArticle?mini=true&url={{url}}",popupWidth:550,popupHeight:427,text:i.strings.linkedin,altText:i.strings.linkedin,iconUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/networks/linkedin.png"):t("@ms/odsp-media/dist/media/images/networks/linkedin.png"),isCreatingLink:null};e.Weibo={name:"weibo",url:"http://service.weibo.com/share/share.php?title={{url}}",popupWidth:600,popupHeight:400,text:i.strings.weibo,altText:i.strings.weibo,iconUrl:"undefined"==typeof __webpack_public_path__?t.toUrl("odsp-media/images/networks/weibo.png"):t("@ms/odsp-media/dist/media/images/networks/weibo.png"),isCreatingLink:null};return e}();e.default=o});define("odsp-next/controls/sharing/sharingByLink/SharingByLink.html",[],function(){return'<div class=od-SharingByLink>\x3c!--ko if: loading()--\x3e<div class=od-SharingByLink-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !hasError()--\x3e\x3c!--ko ifnot: loading()--\x3e<div aria-live=assertive class=od-SharingByLink-error data-bind="if: error"><span data-bind="text: error"></span></div>\x3c!--ko if: note()--\x3e<div aria-live=assertive class=od-SharingByLink-note><span data-bind="text: note"></span></div>\x3c!--/ko--\x3e<div data-bind="ifnot: hasLoadingError">\x3c!--ko if: !isSingleLinkLabelVisible()--\x3e<a href=javascript:; class=od-SharingByLink-linkSwitcher data-bind="attr: {title: linkTitle}, click: switchLinks">\x3c!--ko if: arePasswordProtectedLinksEnabled && setPasswordChecked()--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingByLink-lock" role=img data-bind="icon: true, attr: {\'aria-label\': passwordProtectedLinkIndicatorLabel }"></i>\x3c!--/ko--\x3e<span data-bind="text: sharingHintText, automation: \'sharingHintText\'"></span> <i data-bind="class: arrowIcon" class="ms-Icon od-SharingByLink-linkSwitcher-icon"></i></a>\x3c!--/ko--\x3e\x3c!--ko if: isSingleLinkLabelVisible()--\x3e<span class=od-SharingByLink-linkSwitcher data-bind="text: sharingHintText"></span>\x3c!--/ko--\x3e\x3c!--ko if: isAllowEditVisible()--\x3e<div class="ms-CheckBox od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-allowEdit data-bind="checked: allowEditChecked" class=ms-CheckBox-input> <label for=od-SharingByLink-allowEdit class="ms-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: {\'is-checked\': allowEditChecked}"><span data-bind="text: allowEditText, automation: \'allowEditText\'" class=ms-Label></span></label></div><div class="ms-CheckBox od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-linkExpires class="ms-CheckBox-input od-SharingByLink-CheckBox" data-bind="checked: linkExpiresChecked, disable: isPremiumEligible"> <label for=od-SharingByLink-linkExpires class="ms-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: { \'is-checked\': linkExpiresChecked }, teachingBubble: expiringLinkTeachingBubbleOptions, click: onLinkExpiresClicked"><span data-bind="text: linkExpiresText, automation: \'linkExpiresText\'" class=ms-Label></span></label>\x3c!--ko if: isPremiumEligible--\x3e<span data-bind="click: onLinkExpiresClicked, react: { componentType: gleamCalloutComponent, props: expiringLinkGleamCalloutComponentProps }"></span>\x3c!--/ko--\x3e\x3c!--ko if: linkExpiresChecked()--\x3e<div class=od-SharingByLink-linkExpiresInputDiv><input id=od-SharingByLink-linkExpiresInput class=od-SharingByLink-linkExpiresInput type=number data-bind="value: linkExpirationInDays, selectOnFocus: { isPermanent: false, isReentrant: true }"> <label for=od-SharingByLink-linkExpiresInput><span class=od-SharingByLink-linkExpiresInputLabel data-bind="text: linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: arePasswordProtectedLinksEnabled--\x3e<div class="ms-CheckBox od-SharingByLink-setPassword-container od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-setPassword class=ms-CheckBox-input data-bind="checked: setPasswordChecked, disable: isPremiumEligible"> <label for=od-SharingByLink-setPassword class="ms-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: { \'is-checked\': setPasswordChecked }, click: onSetPasswordClicked"><span data-bind="text: setPasswordLabel" class=ms-Label></span></label>\x3c!--ko if: isPremiumEligible--\x3e<span data-bind="click: onSetPasswordClicked, react: { componentType: gleamCalloutComponent, props: passwordProtectedLinkGleamCalloutComponentProps }"></span>\x3c!--/ko--\x3e\x3c!--ko if: setPasswordChecked()--\x3e<div class=od-SharingByLink-setPasswordInputContainer><input id=od-SharingByLink-setPasswordInput autocomplete=new-password class=od-SharingByLink-setPasswordInput type=password data-bind="value: passwordDisplayValue, valueUpdate: \'input\', attr: { \'aria-invalid\': isPasswordInvalid() }, event: { blur: onPasswordChanged, click: clearPasswordDisplayValue }, keyboard: { mappings: { \'Enter\': $component.onPasswordDefined.bind($component) } }, css: { \'od-SharingByLink-invalidPasswordOutline\': isPasswordInvalid() }"> <label for=od-SharingByLink-setPasswordInput></label>\x3c!--ko if: isPasswordInvalid()--\x3e<div class=od-SharingByLink-invalidPasswordError role=alert data-bind="text: invalidPasswordText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-SharingByLink-linkSection><div class=od-SharingByLink-table><div class=od-SharingByLink-row><div class="od-SharingByLink-cell od-SharingByLink-iconCell">\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true, attr: { \'aria-label\': getLinkText }"></i></div>\x3c!--/ko--\x3e\x3c!--ko if: !currentSharingLink().url--\x3e<a href=# class=od-SharingByLink-linkText id=od-SharingByLink-linkText data-bind="click: onClickCreateLink, automation: \'getLink\'"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true, attr: { \'aria-label\': getLinkText }"></i></div>\x3c!--ko if: !isCreatingLink()--\x3e<span class=od-SharingbyLink-text data-bind="text: getLinkText"></span>\x3c!--/ko--\x3e\x3c!--ko if: isCreatingLink()--\x3e<div class=od-SharingByLink-creatingLink-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-SharingByLink-cell><div class="od-SharingByLink-table od-SharingByLink-url"><div class=od-SharingByLink-row><div class=od-SharingByLink-cell><input class="od-SharingByLink-input od-TextField-field" type=text readonly data-bind="value: sharingLinkUrl, automation: \'sharingLinkUrl\', hasFocus: true, event: { copy: logCopy }, css: { \'is-disabled\': isLinkDisabled }, attr: { \'aria-label\': sharingHintText, \'disabled\': isLinkDisabled }"></div><div class=od-SharingByLink-cell><button class="ms-Dialog-action od-Button od-Button--primary od-SharingByLink-copyButton" data-bind="visible: supportsCopy, click: onClickCopyLink"><i class="od-SharingByLink-copySuccess ms-Icon ms-Icon--CheckMark" data-bind="icon: true, visible: isCopyLoadingVisible"></i> <span class="od-Button-label od-SharingByLink-copyButton-label" data-bind="text: copyText, visible: !isCopyLoadingVisible()"></span></button></div></div></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: !arePasswordProtectedLinksEnabled || !setPasswordChecked()--\x3e<div class=od-SharingByLink-mailRow><a href=# class=od-SharingByLink-mailText id=od-SharingByLink-mailText data-bind="click: showInvite"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Mail" data-bind="icon: true"></i></div><span class=od-SharingByLink-text data-bind="text: inviteText"></span></a></div>\x3c!--/ko--\x3e</div><div class=od-SharingByLink-moreSection>\x3c!--ko if: isNetworksSectionVisible()--\x3e<a href=# class=od-SharingByLink-moreLink data-bind="click: onMoreOptionsClicked"><span data-bind="text: moreOptionsText"></span> <span><i data-bind="class: moreSectionIcon" class=ms-Icon></i></span></a>\x3c!--/ko--\x3e\x3c!--ko if: isMoreSectionVisible()--\x3e<div><div class=od-sharingByLinks-networksList data-bind="foreach: { data: networksList, as: \'network\' }"><div class=od-SharingByLink-networksRow><a href=# class=od-SharingByLink-networkText data-bind="click: $parent.onNetworkClicked.bind($parent)"><div class=od-SharingByLink-icon><img data-bind="attr: { src: network.iconUrl, alt: $parent.getNetworkAltText(network) }"></div><div class=od-SharingByLink-social-holder><span class="od-SharingByLink-social-text od-SharingByLink-social-name" data-bind="text: network.text"></span>\x3c!--ko if: $data.isCreatingLink()--\x3e<span class="od-SharingByLink-social-text od-SharingByLink-social-creating" data-bind="text: $parent.generatingLinkForSocialNetworkText"></span>\x3c!--/ko--\x3e</div></a></div></div>\x3c!--ko if: isManagePermissionsVisible() && !isPasswordProtectedLinksBannerVisible()--\x3e<a href=# data-bind="click: showPermissions, text: managePermissionsText"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--ko if: isPasswordProtectedLinksBannerVisible()--\x3e<div class=od-sharingByLinks-passwordProtectedLinkInformationArea><i class="ms-Icon ms-Icon--Info od-SharingByLink-passwordProtectedLinkInformationIcon" data-bind="icon: true"></i><div class=od-SharingByLink-passwordProtectedLinkInformationTextArea><span class=od-SharingByLink-passwordProtectedLinkInformation data-bind="text: setPasswordPermissionsWarning"></span> <a href=# class=od-SharingByLink-ManageAccessLink data-bind="text: manageAccessLink, click: launchPermissionsPanel"></a></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: hasError()--\x3e<div class=od-SharingByLink-error data-bind="text: missingItemError" aria-live=assertive></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: displayFeatureCards--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: featureCardData, currentIndex: featureCardIndex, close: $component.closeFeatureCards.bind($component), includeOverlay: true } }"></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/sharing/sharingByLink/SharingByLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharingByLink-loadingSpinner{text-align:center;padding:75px 0}.od-SharingByLink-creatingLink-loadingSpinner{display:inline-block;padding:5px 0}.od-SharingByLink-note{margin-bottom:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingByLink-iconCell{width:50px;vertical-align:top}.od-SharingByLink-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:40px;height:40px}[dir=ltr] .od-SharingByLink-icon{margin-right:20px}[dir=rtl] .od-SharingByLink-icon{margin-left:20px}.od-SharingByLink-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Link{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Link{right:10px}.od-SharingByLink-icon .ms-Icon--Mail{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Mail{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Mail{right:10px}.od-SharingByLink-networksRow .od-SharingByLink-icon{background:0 0}.od-SharingByLink-mailRow{white-space:nowrap;margin-top:8px}.od-SharingByLink-mailRow .od-SharingByLink-icon,.od-SharingByLink-networksRow .od-SharingByLink-icon{vertical-align:middle}.od-SharingByLink-linkSwitcher{display:inline-block;margin-bottom:4px}.od-SharingByLink-linkSwitcher .ms-Icon--ChevronDown,.od-SharingByLink-linkSwitcher .ms-Icon--ChevronUp{position:relative}.od-SharingByLink-linkSwitcher-icon{display:inlin-block;vertical-align:middle;line-height:18px}a.od-SharingByLink-linkSwitcher{cursor:pointer}.od-SharingByLink-url .od-SharingByLink-cell{width:100%}.od-SharingByLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingByLink-input.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}button.od-SharingByLink-copyButton{padding:0 10px;margin-top:4px}[dir=ltr] button.od-SharingByLink-copyButton{margin-left:15px}[dir=rtl] button.od-SharingByLink-copyButton{margin-right:15px}.od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{position:relative;top:-1px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"!important}.sm .od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{top:-4px}.od-SharingByLink-copySuccess{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingByLink-linkText,.od-SharingByLink-mailText,.od-SharingByLink-networkText{font-size:17px;font-weight:300}.od-SharingbyLink-text{vertical-align:middle}.od-SharingByLink-table{display:table;width:100%}.od-SharingByLink-row{display:table-row}.od-SharingByLink-cell{display:table-cell}.od-SharingByLink-networksRow{margin-top:8px}.od-SharingByLink-linkSection{margin-top:14px}.od-SharingByLink-moreLink{display:inline-block}.od-SharingByLink-moreLink .ms-Icon--ChevronDown,.od-SharingByLink-moreLink .ms-Icon--ChevronUp{position:relative;top:2px}.od-SharingByLink-moreSection,.od-SharingByLinks-networksList{margin-top:12px}.od-sharingByLinks-networksList{margin-bottom:8px}.od-SharingByLink-social-holder{display:inline-block;vertical-align:middle}.od-SharingByLink-social-text{display:block}.od-SharingByLink-social-creating{font-size:12px;font-weight:400}.od-SharingByLink-linkExpiresInputDiv{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-linkExpiresInputDiv{margin-left:8px}[dir=rtl] .od-SharingByLink-linkExpiresInputDiv{margin-right:8px}.od-SharingByLink-linkExpiresInput{font-size:14px;font-weight:400;width:40px;height:24px;text-indent:2px}.od-SharingByLink-setPasswordInputContainer{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-setPasswordInputContainer{margin-left:8px}[dir=rtl] .od-SharingByLink-setPasswordInputContainer{margin-right:8px}.od-SharingByLink-setPasswordInput{display:block;height:24px;text-indent:8px;width:198px}.od-SharingByLink-invalidPasswordError{display:block;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:12px;padding-top:3px}.od-SharingByLink-invalidPasswordOutline{outline:1px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-SharingByLink-CheckBoxContainer{margin:2px 0}.ms-CheckBox-field.od-SharingByLink-CheckBox:before{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ms-CheckBox-field.od-SharingByLink-CheckBox:after{padding-top:1px}.od-sharingByLinks-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";display:-ms-flexbox;display:flex}.od-SharingByLink-passwordProtectedLinkInformationTextArea{padding:10px}.od-SharingByLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-right:10px}html[dir=ltr] .od-SharingByLink-lock{margin-right:4px}html[dir=rtl] .od-SharingByLink-lock{margin-left:4px}html[dir=ltr] .od-SharingByLink-manageAccessLink{padding-left:2px}html[dir=rtl] .od-SharingByLink-manageAccessLink{padding-right:2px}"}])});define("odsp-next/controls/sharing/sharedWith/SharedWith",["require","exports","./SharedWithViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharedWith.css","./SharedWith.html","../../persona/Persona"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-sharedWith",template:e("./SharedWith.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/sharing/sharedWith/SharedWithViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../providers/dialog/DialogProvider","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","./SharedWith.resx","@ms/odsp-utilities/lib/encoding/UriEncoding","../../confirmation/Confirmation","../sharingByLink/SharingByLinkStringHelper","../../../bindings/focus/SelectOnFocusBinding","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/sharing/SharingHelper","../../../utilities/icons/Icon","../../iframeLoader/IframeLoader","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../bindings/keyboard/KeyboardBinding","../../personaTile/PersonaTile","../../personaTile/PersonaTileHelper","../../../bindings/selection/SelectionBinding","./SharedWithKeyboardNav"],function(e,t,i,n,o,r,a,s,l,d,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P,w,C,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(t){i.__extends(e,t);function e(e){var r=t.call(this,e)||this;r.loadingSpinnerTagName=c.default.tagName;r.personaTileTagName=P.default.tagName;r._sharingProvider=r.resources.consume(p.resourceKey);r._engagement=r.resources.consume(d.resourceKey);r._navigation=r.resources.consume(S.navigation);r._personaTileHelper=new w.default;r.keyNav=new I.default;r.personaTileCollection=r.observables.createArray([]);r.addBindingHandlers({keyboard:k.default,selection:C.default,selectOnFocus:b.default});r.removePerson=function(e){r.people.remove(e)};r._item=e.item;r._items=e.items;e.personaSize?r.cardSize=e.personaSize:r.cardSize=n.observable(4);r.height=e.height?e.height:"none";r.showEmailLink=n.observable(!1);r.hasSettings=n.observable(!1);r.hasData=n.observable(!1);r.showRequests=n.observable(!1);r.loading=n.observable(!0);r.isMultiSelect=n.observable(!1);r.error=n.observable("");r.advancedUrl=n.observable("");r.disableLinkText=h.strings.DisableLinkText;r.emailText=h.strings.EmailEveryone;r.advancedText=h.strings.Advanced;r.requestsPending=h.strings.RequestPending;r.stopSharingText=h.strings.StopSharing;r.viewRequests=h.strings.ViewRequests;r.multiSelectErrorText=h.strings.MultiSelectError;r.userListTrimmedText=h.strings.SharedWithManyText;r.showUserListTrimmedText=r.createObservable(!1);r._selectionModel=r.resources.consume(a.itemsSelection);r._urlDataSource=r.resources.consume(s.url);r.people=n.observableArray([]);r.links=n.observableArray([]);r.canManageLinks=n.observable(!1);r.canManagePermissions=n.observable(!1);r.showAdvanced=r.createComputed(function(){return!!r.advancedUrl()});r.canUnshare=n.observable(!1);r.requestsLink=n.observable("");r.mailto=r.createComputed(function(){if(!r.hasSettings())return"";for(var e=r.people(),t="mailto:",i=new Array,o=0;o<e.length;o++)e[o].email&&i.push(e[o].email);r.showEmailLink(0<i.length&&i.length<29);t+=m.default.encodeURIComponent(i.join(";"));t+="?subject="+m.default.encodeURIComponent(r._settings.itemName);return t+="&body="+encodeURI(encodeURI(r._settings.itemUrl))});r.hasError=r.createComputed(function(){return!!r.error()});if(r._selectionModel&&r._selectionModel.selection&&1<r._selectionModel.selection().length||r._items&&1<r._items.length){r.isMultiSelect(!0);r.loading(!1)}else{e.includeLinks&&r._getLinks();r._getSharedWith()}return r}e.prototype.logCopy=function(e,t){this._engagement.logData({name:e.tag+"Link.SharedWith.Copy",isIntentional:!0});return!0};e.prototype.calculateScope=function(e){var t="";e.item&&this._getCurrentItem()!==e.item&&(t=y.format(h.strings.SharingFrom,e.item.name));return t};e.prototype.scopeClick=function(e){this._navigation.navigateTo(this._urlDataSource.getItemUrl(e.item.key));return!0};e.prototype.calculateHint=function(e){return f.getLinkHintText(e,this._companyDisplayName)};e.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.SharingDialog.Click",isIntentional:!0});this._navigation.navigateTo(this.mailto.peek())};e.prototype.clickAdvanced=function(){this._engagement.logData({name:"AdvancedSettings.SharingDialog.Click",isIntentional:!0});if(this._settings.advancedUrlOpenInPlace){this._showAdvancedDialog();return!1}return!0};e.prototype.clickAccessRequests=function(){this._engagement.logData({name:"PendingAccessRequests.SharingDialog.Click",isIntentional:!0});return!0};e.prototype.stopSharing=function(){this._engagement.logData({name:"StopSharing.SharingDialog.Click",isIntentional:!0});this._stopSharingConfirm()};e.prototype.removeSharingLink=function(t){var i=this,e=this.resources.consume(l.resourceKey);v.disableLinkConfirm(function(){i._engagement.logData({name:"Disable"+t.tag+"Link.SharedWith.Click",isIntentional:!0});var e={type:t.type,role:t.role,create:!1};return i._sharingProvider.manageSharingLinks([i._getCurrentItem()],e).then(function(e){i._updateSharingLinks(e);return r.default.wrap(!0)},function(e){return!1})},function(e){i.isReady=e},e,"SharedWith")};e.prototype._stopSharing=function(){var e=this._sharingProvider.unshare(this._getCurrentItem());this.loading(!0);return e};e.prototype._getLinks=function(){var t=this,e=this.resources.consume(u.resourceKey.optional);e&&e.loadData().then(function(e){t._companyDisplayName=e.CompanyDisplayName;0<t.links.peek().length&&t._updateSharingLinks(t.links())});this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){e&&t._updateSharingLinks(e)},function(e){t.error(h.strings.LinksError)})};e.prototype._updateSharingLinks=function(e){this.links(e.filter(function(e){return e.isActive&&8!==e.type}))};e.prototype._getSharedWith=function(){var i=this,e=this._sharingProvider.getSharingData(this._getCurrentItem());this.isReady=e.getPermissions(!0).then(function(e){var t=e[0];if(t){if(t.hasPendingAccessRequests){i.showRequests(!0);i._engagement.logData({name:"PendingAccessRequests.SharingDialog.Render"})}i.requestsLink(t.pendingAccessRequestsLink);i.canUnshare(t.canUnshare);i._parseSharedWith(t?t.people:null)}else i.loading(!1)},function(e){e&&403===e.status?i.error(h.strings.AccessDenied):i.error(h.strings.ServerError);i.loading(!1)});e.getSettings().done(function(e){i._settings=e;i.canManageLinks(e.canManageLinks);i.canManagePermissions(e.canManagePermissions);i.advancedUrl(e.advancedUrlOpenInPlace?"javascript:;":e.advancedUrl);i.hasSettings(!0)},function(e){})};e.prototype._parseSharedWith=function(e){if(e){this.people(e);this._convertPeopleToPersonaTiles();this.showUserListTrimmedText(30<=this.people().length)}this.loading(!1)};e.prototype._convertPeopleToPersonaTiles=function(){for(var e=this.people.peek(),t=new Array,i=0;i<e.length;i++){var o=e[i],r={inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),person:this.observables.create(o),personaSize:this.cardSize,removePerson:this.removePerson,showPresence:!0},n=this._personaTileHelper.convertPersonaToPersonaTile(r,o.userId);t.push(n)}this.personaTileCollection(t);this.keyNav.focusableTiles(t)};e.prototype._getCurrentItem=function(){return this._item?this._item:n.utils.unwrapObservable(this._selectionModel.selection()[0])};e.prototype._stopSharingConfirm=function(){var e=this,t=this.resources.consume(l.resourceKey),i=this._engagement,o=n.observable(!0);t.requestDialog({title:h.strings.StopSharingConfirmationTitle,size:"Medium",component:{name:g.default.tagName,params:{message:h.strings.StopSharingConfirmationMessage}},actions:[{name:h.strings.StopSharingConfirmationButton,execute:function(){i.logData({name:"Unshare.SharedWithDialog.Click",isIntentional:!0});o(!1);return e._stopSharing().then(function(e){return 2},function(e){return 3})},isDefault:!0,isAvailable:o,icon:new x.default("Save"),automationId:"UnshareConfirm"},{name:h.strings.StopSharingCancelButton,execute:function(){i.logData({name:"CancelStopSharing.SharedWithDialog.Click",isIntentional:!0});return r.default.wrap(3)},isDefault:!1,icon:new x.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};e.prototype._showAdvancedDialog=function(){var e=this,t=this.resources.consume(l.resourceKey),i=t.currentDialog();i&&i.dismiss();i=t.requestDialog({title:y.format(h.strings.AdvancedDialogTitle,this._getCurrentItem().name),size:"Large",component:{name:_.default.tagName,params:{url:this._settings.advancedUrl,onload:function(e){var t=e.target;if(t){t.commitPopup=function(){i.dismiss()};t.style.height=Math.max(300,.25*window.innerHeight)+"px"}}}},actions:[{name:h.strings.ShowAdvancedDialogCloseButton,execute:function(){e._engagement.logData({name:"AdvancedSharingClose.SharedWithDialog.Click",isIntentional:!0});return r.default.wrap(3)},isDefault:!0,isAvailable:n.observable(!0),icon:new x.default("Cancel"),automationId:"AdvancedSharingClose"}],executeDefaultAction:!1})};return e}(o.default);t.default=T});define("odsp-next/controls/iframeLoader/IframeLoader",["require","exports","./IframeLoaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IframeLoader.html","./IframeLoader.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-iframe-loader",template:e("./IframeLoader.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/iframeLoader/IframeLoaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","./IframeLoader.resx","../../bindings/element/ElementBinding","../../utilities/iframe/IframeHelper"],function(e,t,i,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(i){var o=r.call(this)||this;o.loadingLabel=s.strings.IframeLoadingLabel;o._isIframeAvailable=!0;var e=i.url,t=i.title||"";o.url="string"==typeof e?n.observable(e):e;o.title="string"==typeof t?n.observable(t):t;o.isExcludeFromScreenReader=i.isExcludeFromScreenReader||!1;o.isLoading=i.isLoading?i.isLoading:n.observable(!0);o.loadingLabelHasMargins=i.loadingLabelHasMargins;o.progressSpinnerFlatTagName=a.default.tagName;o.showLoadingLabel=i.showLoadingLabel;o.iframeElement=i.iframeElement||n.observable(null);o.tabindex=o.isExcludeFromScreenReader?"-1":null;o.role=o.isExcludeFromScreenReader?"presentation":null;o.isVisible=o.createComputed(o._computeIsVisible);o.isTitleVisible=o.createComputed(o._computeIsTitleVisible);o.addBindingHandlers({element:l.default});o.iframeOnLoad=function(e,t){o._isIframeAvailable&&i.onload&&i.onload(t);o.isLoading(!1)};o.addDisposable({dispose:function(){d.disposeIframe(o.iframeElement(),function(){o._isIframeAvailable=!1})}});return o}e.prototype._computeIsVisible=function(){return!!this.url()};e.prototype._computeIsTitleVisible=function(){return!!this.title()};return e}(o.default);t.default=r});define("odsp-next/utilities/iframe/IframeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disposeIframe=function(e,t){if(e){e.src="";t&&t()}};t.isCrossOrigin=function(){try{return!window.top.location.hostname}catch(e){return!0}}});define("odsp-next/controls/iframeLoader/IframeLoader.html",[],function(){return"<div class=ms-IframeLoader data-bind=\"css:{ 'ms-IframeLoader--visible': isVisible }\"><div class=ms-IframeLoader-title data-bind=\"css:{ 'ms-IframeLoader-title--visible': isTitleVisible }, text: title()\"></div><iframe class=ms-IframeLoader-iframe data-bind=\"attr: { src: url(), role: role, tabindex: tabindex }, event: { load: iframeOnLoad }, css: { 'ms-IframeLoader-iframe--visible': !isLoading() }, element: iframeElement\"></iframe>\x3c!--ko if: showLoadingLabel--\x3e<span class=ms-IframeLoader-loadingLabel data-bind=\"text: loadingLabel, css: { 'ms-IframeLoader-loadingLabel--visible': isLoading, 'ms-IFrameLoader-LoadingWithMargin': loadingLabelHasMargins }\"></span>\x3c!--/ko--\x3e<div class=ms-IframeLoader-progressContainer data-bind=\"css: { 'ms-IframeLoader-progressContainer--visible': isLoading }\"><div class=ms-IframeLoader-progress data-bind=\"component: { name: progressSpinnerFlatTagName }\"></div></div></div>"});define("odsp-next/controls/iframeLoader/IframeLoader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-IframeLoader{display:none;width:100%;height:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:none}.ms-IframeLoader-loadingLabel.od-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--l{font-size:17px}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframe{width:100%;height:100%;border:none;display:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframe--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"}])});define("odsp-next/controls/personaTile/PersonaTileHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return e.call(this)||this}t.prototype.convertPersonaToPersonaTile=function(e,t){return{personaParams:e,key:t,focused:this.observables.create(!1)}};return t}(o.default);t.default=r});define("odsp-next/controls/sharing/sharedWith/SharedWithKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.keyboardOptions=[{target:null,mappings:{Right:e.onKeyRight}},{target:window,mappings:{}}];e.focusedTile=e.observables.create();e.focusableTiles=e.observables.createArray();return e}e.prototype.onKeyRight=function(e,t){var i=e.keyNav.focusedTile();i.personaParams.inputEvent(t);i.personaParams.openContextMenu(!0);t.stopPropagation();return!0};return e}(o.default);t.default=r});define("odsp-next/controls/sharing/sharedWith/SharedWith.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharedWith-Container{width:100%}.od-SharedWith-loadingSpinner{text-align:center;padding:75px 0}.od-SharedWith-wrapper{margin:2px;width:100%;overflow-x:hidden;overflow-y:auto;min-height:175px}.od-SharedWith-accessRequests{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:8px 0}.od-SharedWith-accessRequestsIcon{padding:0 8px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12pt;vertical-align:middle}[dir=ltr] .od-SharedWith-accessRequestsLink{padding-left:5px}[dir=rtl] .od-SharedWith-accessRequestsLink{padding-right:5px}.od-SharedWith-person{margin:0 0 10px;width:100%}.od-SharedWith-person .od-Persona .od-Persona-details{max-width:75%;padding-left:0}.od-SharedWith-error{color:#a80000}.od-SharedWith-linksBox{margin:10px 0 1px}button.od-SharedWith-link{border:none;background:0 0}.od-SharedWith-link{text-decoration:none;cursor:pointer;padding:2px;text-transform:uppercase;font-size:12px;font-weight:400;color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-SharedWith-link{margin-right:10px}[dir=rtl] .od-SharedWith-link{margin-left:10px}.od-SharedWith-link:focus,.od-SharedWith-link:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharedWith-iconCell{width:50px;vertical-align:top}.od-SharedWith-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-SharedWith-icon{margin-right:10px}[dir=rtl] .od-SharedWith-icon{margin-left:10px}.od-SharedWith-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharedWith-icon .ms-Icon--Link{left:9px}[dir=rtl] .od-SharedWith-icon .ms-Icon--Link{right:9px}.od-SharedWith-mailRow{white-space:nowrap}.od-SharedWith-mailRow .od-SharedWith-icon{vertical-align:middle}.od-SharedWith-linkSwitcher{display:inline-block;margin-bottom:10px}a.od-SharedWith-linkScope,a.od-SharedWith-linkSwitcher{cursor:pointer}.od-SharedWith-url .od-SharedWith-cell{width:100%}.od-SharedWith-input{padding:3px;width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}button.od-SharedWith-copyButton{padding:0 10px;height:1.9em}.od-SharedWith-copyButton-label{position:relative;top:-1px}.od-SharedWith-mailText{font-size:17px;font-weight:300}.od-SharedWith-trimmedText{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharedWith-trimmedText{margin-right:5px}[dir=rtl] .od-SharedWith-trimmedText{margin-left:5px}.od-SharedWith-table{display:table;width:100%}.od-SharedWith-row{display:table-row}.od-SharedWith-cell{display:table-cell}.od-SharedWith-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer}[dir=ltr] .od-SharedWith-removeLinkButton{margin-left:10px}[dir=rtl] .od-SharedWith-removeLinkButton{margin-right:10px}.od-SharedWith--hidden{display:none}"}])});define("odsp-next/controls/sharing/sharedWith/SharedWith.html",[],function(){return'<div class=od-SharedWith-Container>\x3c!--ko if:loading--\x3e<div class=od-SharedWith-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div data-bind="if: showRequests"><div aria-live=polite class=od-SharedWith-accessRequests role=alert><i class="ms-Icon ms-Icon--Info od-SharedWith-accessRequestsIcon" data-bind="icon: true"></i> <span data-bind="text: requestsPending"></span> <a class=od-SharedWith-accessRequestsLink target=_blank data-bind="attr: {href: requestsLink }, text: viewRequests, click: $component.clickAccessRequests.bind($component)"></a></div></div><div aria-live=assertive class=od-SharedWith-error data-bind="if: hasError"><span data-bind="text: error"></span></div><div aria-live=polite data-bind="if: isMultiSelect"><span data-bind="text: multiSelectErrorText"></span></div><div class=od-SharedWith-wrapper aria-live=polite aria-relevant=text data-bind="style: { maxHeight: height }, keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }"><div data-bind="foreach: links"><div class=od-SharedWith-table><div class=od-SharedWith-row><div class="od-SharedWith-cell od-SharedWith-iconCell"><div class=od-SharedWith-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i></div></div><div class=od-SharedWith-cell>\x3c!--ko if: $parent.canManageLinks--\x3e<a class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data), click: $parent.scopeClick.bind($parent, $data)"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: $parent.canManageLinks--\x3e<span class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data)"></span>\x3c!--/ko--\x3e<div class="od-SharedWith-table od-SharedWith-url"><div class=od-SharedWith-row><div class=od-SharedWith-cell><input class=od-SharedWith-input readonly data-bind="value: url, selectOnFocus: { isPermanent: true }, event: { copy: $component.logCopy.bind($component) }, attr: { \'aria-label\': $parent.calculateHint($data)}"></div>\x3c!--ko if: $parent.canManageLinks--\x3e<div class=od-SharedWith-cell><button class=od-SharedWith-removeLinkButton data-bind="click: $parent.removeSharingLink.bind($parent, $data), attr: { \'title\': $parent.disableLinkText, \'aria-label\': $parent.disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div><span class=od-SharedWith-linkSwitcher data-bind="text: $parent.calculateHint($data)"></span></div></div></div></div><div class=od-SharedWith-PersonaTiles role=tree data-bind="foreach: { data: personaTileCollection, as: \'personaTile\' }"><div class=od-SharedWith-person data-bind="component: { name: $parent.personaTileTagName, params: { tile: personaTile } }"></div></div>\x3c!--ko if: showUserListTrimmedText()--\x3e<div class=od-SharedWith-trimmedText data-bind="text: userListTrimmedText"></div>\x3c!--/ko--\x3e</div><div class=od-SharedWith-linksBox data-bind="if: hasSettings()"><button class=od-SharedWith-link data-bind="click: stopSharing, text: stopSharingText, visible: canUnshare"></button> <button class=od-SharedWith-link data-bind="text: emailText, visible: showEmailLink(), click: $component.clickEmail.bind($component)"></button>\x3c!--ko if: canManagePermissions--\x3e<a class=od-SharedWith-link target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: showAdvanced, click: clickAdvanced"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/sharing/shareByEmail/ShareByEmail",["require","exports","./ShareByEmailViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShareByEmail.html","./ShareByEmail.css","../../peoplePicker/PeoplePicker"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-share-by-email",template:e("./ShareByEmail.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/sharing/shareByEmail/ShareByEmailViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","knockout","../../loadingSpinner/LoadingSpinner","../../../providers/panel/PanelProvider","../../peoplePicker/PeoplePicker","./Sharing.resx","../sharingTips/SharingTips","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/dateTime/DateTime","../emailLink/EmailLink.resx","../../../utilities/policyTip/PolicyTipHelper"],function(e,t,i,n,a,s,o,l,d,c,p,u,h,m,g,r,f,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.loadingSpinnerTagName=c.default.tagName;t.peoplePickerTagName=u.default.tagName;t.sharingTipsTagName=m.default.tagName;t._params=e;t._items=e.items;t._itemProvider=t.resources.consume(f.resourceKey);t._engagement=t.resources.consume(n.resourceKey);t._expiration=t.wrapObservable(e.expiration);var i=t._expiration&&t._expiration.peek();t.expirationLabel=i?b.getShortDisplayDate(new Date(t._expiration.peek())):null;t.isPasswordProtectedLink=t._params.currentLink&&t._params.currentLink.peek()&&t._params.currentLink.peek().hasPassword;var o=t._items[0].key;t.item=t._itemProvider.getItemSync({parentKey:o}).item;t._referenceRevision=t.createPureComputed(function(){return t.item().revision});t._isDoneGettingSharingSettings=t.createObservable(!1);t.canUserShareExternally=t._params.canUserShareExternally||t.observables.create(!1);t.policyTipInfo=t.createObservable(null);t._policyTipDataSource=t.resources.isExposed(a.policyTip)?t.resources.consume(a.policyTip):null;t.showShareButton=!!e.onExecuteAction;t.permissionLabel=h.strings.PermissionLabel;t.passwordProtectedLabel=h.strings.PasswordProtectedLabel;t.arePasswordProtectedLinksEnabled=s.isFeatureEnabled(s.EnablePasswordProtectedLinks);t.inputPlaceholder=h.strings.EmailPlaceholder;t.sendEmailLabel=h.strings.EmailInvitation;t.requireSignInLabel=h.strings.RequireSignInLabel;t.propagateSharingLabel=h.strings.PropagateSharingLabel;t.requireSignInTooltip=h.strings.RequireSignInTooltip;t.shareButtonText=h.strings.ShareText;t.charLimitVisible=d.observable(!1);t.charLimitReached=t._params.emailMessageExceedsLimit;t.charCountText=d.observable("");t._emailCharLimit=-1;t.canSendEmail=d.observable(!1);t.canSendLink=d.observable(!1);t.supportsSharingPropagation=d.observable(!1);t.sharingRoleOptions=d.observableArray([]);t.hideOptions=!!e.hideOptions;t.showSendEmailOption=e.showSendEmailOption;t.propagateSharing=e.propagateSharing;t.currentSharingLink=e.currentLink;t.hasSharingLink=!!t.currentSharingLink&&null!==t.currentSharingLink();if(t.hasSharingLink){t.requireSignIn=t.createComputed(function(){var e=t.currentSharingLink();return 6!==e.type&&5!==e.type});t.roleSelection=t.createComputed(function(){return t.currentSharingLink().role.toString()});t.linkType=t.createComputed(function(){return t.currentSharingLink().type});t.sendEmail=d.observable(!0)}else{t.requireSignIn=e.requireSignIn;t.roleSelection=e.roleValue;t.linkType=e.linkType?t.createObservable(e.linkType):t.createObservable(8);t.sendEmail=e.sendEmail}t.emailInputText=e.emailMessage||d.observable("");t.error=e.errorMessage||d.observable("");t._canCurrentUserShareExternally=t.createObservable(!1);t.loading=d.observable(!0);t.hasLoadingError=d.observable(!1);t.sharedWithSize=d.observable(2);t.shareAvailable=t.createComputed(t._computeShareAvailable);t.createComputed(t._computeValidateMessageLength);t.peopleSharingWith=d.observableArray([]);t.resources.bind(p.resourceKey);t._sharingSettings2=t.observables.create(null);t.ppQueryParams=t.createPureComputed(t._computePeoplePickerQueryParams);t.policyTipType=t.createPureComputed(t._computePolicyTipType);t.blockViaPolicy=t.createPureComputed(t._computeBlockViaPolicy);t._policyTipDataSource&&(t.policyTipType?t._policyTipDataSource.getPolicyTip(t.item.peek()).done(function(e){e&&e.issueDescriptions&&e.issueDescriptions.length&&t.policyTipInfo(e)}):t.policyTipInfo(null));t.sharingTipsParams=t.createComputed(t._computeSharingTipsParams);t.missingItemError=t._items[0].type===l.default.Folder?h.strings.MissingFolderError:h.strings.MissingFileError;t.sharingError=t.createObservable("");t.getSharingSettings(!!t.item.peek().policyTip);t.createBackgroundComputed(t._refreshSharingSettings);return t}e.prototype.requireSignInChanged=function(){this.requireSignIn()&&this.sendEmail(!0)};e.prototype.shareClicked=function(){var e;e=1<this._items.length?this._items:[this.item.peek()];var t=this.resources.consume(o.resourceKey),i={items:e,roleValue:this.roleSelection.peek(),message:this._params.emailMessage.peek(),sendEmail:this.sendEmail.peek(),requireSignIn:this.requireSignIn.peek(),propagateSharing:this._params.propagateSharing.peek(),expiration:this._expiration.peek()};this._engagement.logData({name:"Share.SharingDialog.Click",isIntentional:!0});t.share(this._params.selectedPeople.peek(),i);this._params.onExecuteAction&&this._params.onExecuteAction()};e.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};e.prototype._computeBlockViaPolicy=function(){if(!s.isFeatureEnabled(s.PolicyTipPanel))return!1;var e=this.policyTipType();return e?v.isPolicyTipFlagSet(e,4):void 0};e.prototype._computeSharingTipsParams=function(){if(this._isDoneGettingSharingSettings()){return{selectedPeople:this.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:this.showExternalUserWarning,policyTipType:this.policyTipType(),policyTipInfo:this.policyTipInfo,item:this.item()}}};e.prototype._computeShareAvailable=function(){if(!this._isDoneGettingSharingSettings())return!1;if(this.peoplePickerParams.hasUnresolvedText&&this.peoplePickerParams.hasUnresolvedText())return!1;if(this.blockViaPolicy()&&this.peoplePickerParams&&this.peoplePickerParams.selectedPeopleContainsExternal&&this.peoplePickerParams.selectedPeopleContainsExternal())return!1;for(var e=0,t=this.peoplePickerParams.selectedPeople();e<t.length;e++){if(!t[e].isResolved)return!1}this._emailCharLimit=this._mailSettings&&this._mailSettings.defaultCharacterLimit;this._evaluateMessageLength(this.emailInputText.peek());return!this.charLimitReached()&&0<this.peoplePickerParams.selectedPeople().length};e.prototype._computeValidateMessageLength=function(){var e=this.emailInputText();this._evaluateMessageLength(e)};e.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings2();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.blockViaPolicy()};if(e.pickerProperties){var i=e.pickerProperties;t.principalSource=i.PrincipalSource;t.principalType=i.PrincipalAccountType;t.querySettings=i.QuerySettings;t.allowEmailAddresses=i.AllowEmailAddresses;t.filterExternalUsers=!1}return t}};e.prototype._evaluateMessageLength=function(e){var t=this._getEncodedMessageLength(e),i=this._emailCharLimit;if(9999999999!==i){!this.charLimitVisible.peek()&&t&&i-100<t&&this.charLimitVisible(!0);if(this.charLimitVisible.peek()){this.charCountText(g.format(h.strings.CharacterCounterFormat,t,i));i<t?this.charLimitReached(!0):this.charLimitReached.peek()&&this.charLimitReached(!1)}}else{this.charLimitVisible(!1);this.charLimitReached(!1)}};e.prototype._getEncodedMessageLength=function(e){var t=0,i=e.length,o=0,r=!1;if(!e||0===e.length)return 0;for(var n="&#160;",a="<br />",s="&quot;&quot;&quot;",l="&amp;",d="&#39;",c="&lt;",p="&gt;",u=" ";o<i;){var h=null,m=e[o];if(" "===m)h=o+1<i&&" "===e[o+1]||r?n:" ";else if("\n"===m){h=a;r=!0}else{'"'===m?h=s:"&"===m?h=l:"'"===m?h=d:"<"===m?h=c:">"===m?h=p:"\r"===m&&(h=u);r=!1}t+=null!==h?h.length:1;o++}return t};e.prototype.getSharingSettings=function(e){var i=this,t=this.resources.consume(o.resourceKey).getSharingData(this.item(),e);this.isReady=t.getSettings().then(function(e){i.sharingSettings=e;i._sharingSettings2(e);i.sharingSettings.itemId?i.sharingSettings.blockPeoplePickerAndSharing&&i.sharingError(y.strings.CannotShareText):i.sharingError(i.missingItemError);i.showExternalUserWarning=i.sharingSettings.showAdditionalExternalWarning;i._canCurrentUserShareExternally(i.sharingSettings.canCurrentUserShareExternally);i.peoplePickerParams={selectedPeople:i._params.selectedPeople,selectedPeopleContainsExternal:i._params.selectedPeopleContainsExternal,peoplePickerQueryParams:i.ppQueryParams,hasUnresolvedText:i._params.hasUnresolvedText,contactInviteLimit:e.contactInviteLimit};i.sharingRoleOptions(e.sharingRoles);i._mailSettings=e.mailSettings;i.canSendEmail(e.canSendEmail);i.canSendLink(e.canSendLink);i.supportsSharingPropagation(e.supportsSharingPropagation);i._params.propagateSharing&&i._params.propagateSharing(e.supportsSharingPropagation);i.peopleSharingWith(e.sharedWith);i._isDoneGettingSharingSettings(!0);i.hasLoadingError(!1);i.loading(!1)},function(e){var t=i.item();if(t&&t.parentLink){i._engagement.logData({name:"GetSettings.SharingDialog.Redirect"});window.location.href=t.parentLink+"?sharingDialogForListItemId="+t.id}else{e&&403===e.status?i.error(h.strings.AccessDenied):i.error(h.strings.ServerError);i._isDoneGettingSharingSettings(!0);i.hasLoadingError(!0);i.loading(!1)}})};e.prototype._refreshSharingSettings=function(){var t=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(e){t.getSharingSettings(!0)})};return e}(r.default);t.default=x});define("odsp-next/controls/sharing/sharingTips/SharingTips",["require","exports","./SharingTipsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingTips.html","./SharingTips.css","../../dlplite/DlpLite"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-sharingTips",template:e("./SharingTips.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/sharing/sharingTips/SharingTipsViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../utilities/policyTip/PolicyTipHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../../../providers/panel/PanelProvider","../../../providers/peoplePicker/PeoplePickerProvider","knockout","../../policyTipPanel/PolicyTipPanel","./SharingTips.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,c,p,u,h,m,g,f,o,b,y,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(d,a);function d(e){var s=a.call(this,e)||this,t=e.showPolicyTip,i=void 0===t?h.isFeatureEnabled(h.PolicyTipPanel):t;s.addBindingHandlers({bindableHtml:u.default});var l=s._engagement=s.resources.consume(c.resourceKey);s._item=e.item;s._policyTipType=e.policyTipType;s._policyTipInfo=e.policyTipInfo;s.hasPolicyTip=s.createObservable(s._item&&p.isPolicyTipFlagSet(s._item.policyTip,4));s.policyTipText=p.getPolicyTipText(s._policyTipType,"onViewPolicyTipClick");s._resolvedUsers=e.selectedPeople;s.showAdvancedMessage=e.showAdditionalSharingWarning;s.showPolicyTip=i;s.advancedWarningText=b.strings.GallatinMessage;s.multiExternalUserText=f.observable("");s.expandUsersText=f.observable(b.strings.Show);s.expandGroupsText=f.observable(b.strings.Show);s.showMultiUsers=f.observable(!1);s.isUserBlocked=f.observable(!1);s.showGroups=f.observable(!1);s.singleExternalUserText=f.observable("");s.groupsText=f.observable("");s.groupsMemberCountText=f.observable("");s._renderedExternalUsers=!1;s._renderedGroups=!1;s._peoplePickerProvider=s.resources.consume(g.resourceKey);s._pickerEntityInformations=[];if(e.pickerEntityInformations)for(var o=0,r=e.pickerEntityInformations;o<r.length;o++){var n=r[o];s._pickerEntityInformations[n.person.userId]=n}s.externalUsers=s.createComputed(function(){for(var e=!1,t=[],i=0,o=s._resolvedUsers();i<o.length;i++){var r=o[i];if(1===r.entityType){var n=r.rawPersonData.EntityData.IsBlocked;e=e||n&&"true"===n.toLowerCase();t.push(r)}}s.isUserBlocked(e);if(1===t.length){var a='<span class="od-SharingTips-resolvedUser">'+(t[0].email||t[0].name)+"</span>";s.singleExternalUserText(y.format(e?b.strings.SingleEmailBlockedByAllowDenyList:b.strings.SingleExternalUserText,a));s.showMultiUsers(!1)}else 1<t.length&&s.multiExternalUserText(e?b.strings.MultipleEmailBlockedByAllowDenyList:b.strings.MultiExternalUserText);if(0<t.length&&!s._renderedExternalUsers){s._renderedExternalUsers=!0;s._engagement.logData({name:"ExternalUsers.SharingTips.Render"})}return t});s.groups=s.createComputed(function(){for(var e=[],t=0,i=0,o=s._resolvedUsers();i<o.length;i++){var r=o[i];if(2===r.entityType){var n={group:r,memberCountText:f.observable("")};if(h.isFeatureEnabled(h.OversharingMitigations)){var a=s.getGroupMemberCount(n);t+=a;n.memberCountText(d.getMemberCountText(a,!1))}e.push(n)}}1<e.length?s.groupsText(y.format(b.strings.MultiGroupText,e.length)):s.groupsText(y.format(b.strings.SingleGroupText,e.length));s.groupsMemberCountText(d.getMemberCountText(t,!0));if(0<e.length&&!s._renderedGroups){s._renderedGroups=!0;l.logData({name:"Groups.SharingTips.Render"})}return e});s.resources.bind(m.resourceKey);s._panelProvider=s.resources.consume(m.resourceKey);return s}d.getMemberCountText=function(e,t){return 1===e?t?b.strings.GroupOneMemberCountText:b.strings.SingleGroupOneMemberCountText:1<e&&e<1e3?y.format(t?b.strings.GroupMemberCountText:b.strings.SingleGroupMemberCountText,e):1e3<=e?t?b.strings.GroupMemberCountTextGreaterThan1000:b.strings.SingleGroupMemberCountTextGreaterThan1000:""};d.prototype.onViewPolicyTipClick=function(){var e={item:this._item,policyTipInfo:this._policyTipInfo()};this._panelProvider.requestPanel({component:{name:o.default.tagName,params:e}})};d.prototype.clickExpandUsers=function(){if(this.showMultiUsers()){this.expandUsersText(b.strings.Show);this.showMultiUsers(!1)}else{this._engagement.logData({name:"ExpandUsers.SharingTips.Click",isIntentional:!0});this.expandUsersText(b.strings.Hide);this.showMultiUsers(!0)}};d.prototype.clickExpandGroups=function(){if(this.showGroups()){this.expandGroupsText(b.strings.Show);this.showGroups(!1)}else{this._engagement.logData({name:"ExpandGroups.SharingTips.Click",isIntentional:!0});this.expandGroupsText(b.strings.Hide);this.showGroups(!0)}};d.prototype.getGroupMemberCount=function(e){var t=0;this._pickerEntityInformations[e.group.userId]?t=this._pickerEntityInformations[e.group.userId].totalMemberCount:this._retrievePickerEntityInformation(e);return t};d.prototype.updateGroupsMemberCountText=function(){for(var e=0,t=0,i=this._resolvedUsers();t<i.length;t++){var o=i[t];2===o.entityType&&this._pickerEntityInformations[o.userId]&&(e+=this._pickerEntityInformations[o.userId].totalMemberCount)}this.groupsMemberCountText(d.getMemberCountText(e,!0))};d.prototype._retrievePickerEntityInformation=function(t){var i=this;this._peoplePickerProvider.getPickerEntityInformation(t.group).then(function(e){i._pickerEntityInformations[t.group.userId]=e;t.memberCountText(d.getMemberCountText(e.totalMemberCount,!1));i.updateGroupsMemberCountText()},function(e){})};return d}(r.default);t.default=n});define("odsp-next/utilities/policyTip/PolicyTipHelper",["require","exports","../../controls/policyTipPanel/PolicyTipPanel.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPolicyTipActionText=function(){return a.strings.ViewPolicyTip};t.getPolicyTipHeader=function(e){return i.format(a.strings.PolicyTipHeader,"'"+e+"'")};t.getPolicyTipText=function(e,t){var i=a.strings.PolicyTipBlock,o=this.isPolicyTipFlagSet(e,4),r=this.isPolicyTipFlagSet(e,2),n=this.isPolicyTipFlagSet(e,1);o?i=a.strings.PolicyTipNotifyAndBlock:r?i=a.strings.PolicyTipBlock:n&&(i=a.strings.PolicyTipNotify);t&&(i=i+' <a href=";" data-bind="click: '+t+'">'+a.strings.ViewPolicyTip+"</a>");return i};t.isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t}});define("odsp-next/controls/policyTipPanel/PolicyTipPanel",["require","exports","./PolicyTipPanelViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PolicyTipPanel.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-policy-tip-panel",template:e("./PolicyTipPanel.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/policyTipPanel/PolicyTipPanelViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/dateTime/DateTime","../../providers/item/ItemProvider","@ms/odsp-shared-react/lib/PolicyTip","../policyTipPanel/PolicyTipPanel.resx","../../utilities/policyTip/PolicyTipHelper","../../resources/DataSourceResourceKeys","../../bindings/react/ReactBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,o,n,a,s,l,d,c,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.item,o=e.policyTipInfo;t._item=i;t._policyTipInfo=o;t.addBindingHandlers({react:p.default});t._itemProvider=t.resources.consume(a.resourceKey);t._policyTipDataSource=t.resources.consume(c.policyTip);t._showJustificationInput=t.createObservable(!1);t._confirmationText=t.createObservable("").extend({notify:"always"});t.policyTipComponent=s.PolicyTip;t.policyTipComponentProps=t.createPureComputed(t._computePolicyTipComponentParams);return t}e.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),i=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:i}};e.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:l.strings.NoPolicyTipInfoError,titleText:d.getPolicyTipHeader(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:l.strings.TipIssues,issues:e.issueDescriptions,lastScannedText:e.lastScanned?l.strings.TipLastScanned+": "+n.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:l.strings.LearnMoreActionLabel,learnMoreLabel:l.strings.LearnMoreLabel,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?l.strings.OverrideActionLabel:void 0,overrideLabel:l.strings.OverrideLabel,policyTipDescription:e.explanationText,reportActionLabel:l.strings.ReportActionLabel,reportInProgressLabel:l.strings.ReportInProgress,reportLabel:l.strings.ReportLabel,submitButtonLabel:l.strings.SubmitButtonText,titleText:d.getPolicyTipHeader(this._item.name)}};e.prototype._onReportClicked=function(){var t=this;this._logEngagementEvent("ReportClicked");var e={item:this._item,action:1};this._policyTipDataSource.updatePolicy(e).done(function(e){if(1===e){t._logEngagementEvent("FalsePositiveReported");t._confirmationText(l.strings.ReportConfirmation)}else if(3===e||2===e){t._logEngagementEvent("OverrideWithoutJustification");t._confirmationText(l.strings.OverrideConfirmation)}})};e.prototype._onOverrideClicked=function(){var t=this;this._logEngagementEvent("OverrideClicked");var e=this._policyTipInfo.overrideOption;if(1===e){var i={item:this._item,action:0};this._policyTipDataSource.updatePolicy(i).done(function(e){t._logEngagementEvent("OverrideWithoutJustification");t._confirmationText(l.strings.OverrideConfirmation)})}else if(2===e){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};e.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var i={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(i).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(l.strings.OverrideConfirmation)})};e.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};e.prototype._logEngagementEvent=function(e){o.Engagement.logData({name:"PolicyTipPanel."+e})};return e}(r.default);t.default=u});define("odsp-next/controls/policyTipPanel/PolicyTipPanel.html",[],function(){return'<div data-bind="react: { componentType: policyTipComponent, props: policyTipComponentProps }"></div>'});define("odsp-next/controls/sharing/sharingTips/SharingTips.html",[],function(){return'<div class=od-SharingTips><div class=od-SharingTips-section data-bind="if: externalUsers().length > 0"><div data-bind="if: externalUsers().length === 1"><div class=od-SharingTips-singleExternalUser data-bind="html: singleExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></div></div><div data-bind="if: externalUsers().length > 1"><span class=od-SharingTips-multiUser data-bind="text: multiExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></span> <button class=od-SharingTips-expandLink data-bind="text: expandUsersText, click: clickExpandUsers"></button><div>\x3c!--ko if: showMultiUsers--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: externalUsers"><li class=od-SharingTips-resolvedUser data-bind="text: email || name"></li></ul>\x3c!--/ko--\x3e</div></div><ms-dlplite></ms-dlplite>\x3c!--ko if: showAdvancedMessage--\x3e<div data-bind="text: advancedWarningText"></div>\x3c!--/ko--\x3e\x3c!--ko if: hasPolicyTip() && showPolicyTip--\x3e<div class=od-SharingTips-policyTip data-bind="bindableHtml: policyTipText"></div>\x3c!--/ko--\x3e</div><div class=od-SharingTips-section data-bind="if: groups().length > 0"><span class=od-SharingTips-multiUser data-bind="text: groupsText"></span> <span class=od-SharingTips-groupsMemberCount data-bind="text: groupsMemberCountText"></span> <button class=od-SharingTips-expandLink data-bind="text: expandGroupsText, click: clickExpandGroups"></button><div>\x3c!--ko if: showGroups--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: groups"><li class=od-SharingTips-resolvedUser><span data-bind="text: group.name"></span> <span data-bind="text: memberCountText"></span></li></ul>\x3c!--/ko--\x3e</div></div>\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/sharing/sharingTips/SharingTips.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-SharingTips-section{margin-top:6px}[dir=ltr] .od-SharingTips-section{margin-left:6px}[dir=rtl] .od-SharingTips-section{margin-right:6px}.od-SharingTips-resolvedUser{display:inline-block;font-weight:700}.od-SharingTips-multiUserList{display:inline;list-style:none;padding:0}.od-SharingTips-multiUserList li{display:inline}.od-SharingTips-multiUserList li:after{content:", "}.od-SharingTips-multiUserList li:last-child:after{content:""}.od-SharingTips-expandLink{color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background:0 0;border:none;padding:0;cursor:pointer}.od-SharingTips-expandLink:focus,.od-SharingTips-expandLink:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharingTips-error{color:#a80000}.od-SharingTips-policyTip{color:#a80000;margin-top:6px}"}])});define("odsp-next/controls/dlplite/DlpLite",["require","exports","./DlpLiteViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DlpLite.html","./DlpLite.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-dlplite",template:e("./DlpLite.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/dlplite/DlpLiteViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./DlpLite.resx","../../resources/DataSourceResourceKeys"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this)||this;t.strings=n.strings;t.isVisible=r.observable(!1);t.externalSharingLearnUrl=r.observable("javascript:");t.resources.consume(a.policyTip).getExternalSharingStatus().then(function(e){if(e){t.isVisible(e.isExternalSharingTipEnabled);t.externalSharingLearnUrl(e.externalSharingTipsLearnMoreUrl)}},function(e){});return t}return e}(i.default);t.default=s});define("odsp-next/controls/dlplite/DlpLite.html",[],function(){return'<div class=ms-DlpLite data-bind="visible: isVisible"><span class=ms-DlpLite-middle data-bind="text: strings.bannerWarning"></span> <a class=ms-DlpLite-middle target=_blank data-bind="text:strings.learnMore, attr: {href: externalSharingLearnUrl}"></a></div>'});define("odsp-next/controls/dlplite/DlpLite.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-DlpLite{overflow:hidden}"}])});define("odsp-next/controls/sharing/shareByEmail/ShareByEmail.html",[],function(){return'<div class=Sharing>\x3c!--ko if:loading--\x3e<div class=Sharing-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !sharingError()--\x3e\x3c!--ko ifnot:loading--\x3e<div class=Sharing-table data-bind="ifnot: hasLoadingError"><div class=Sharing-row><div class="Sharing-cell Sharing-peoplePicker" id=Sharing-peoplePicker data-bind="component: {name: peoplePickerTagName, params: peoplePickerParams}"></div>\x3c!--ko if: !hasSharingLink--\x3e<select class="Sharing-cell Sharing-simpleRoleSelector" data-bind="foreach: sharingRoleOptions, value: roleSelection, attr: {\'aria-label\': permissionLabel }, visible: sharingRoleOptions().length > 0"><option data-bind="text: name, value: value"></option></select>\x3c!--/ko--\x3e</div></div><div aria-live=assertive class=PeoplePicker-error data-bind="if: error"><span data-bind="text: error"></span></div><div data-bind="ifnot: hasLoadingError"><div aria-live=polite data-bind="component: { name: sharingTipsTagName, params: sharingTipsParams }"></div></div><div class=od-ShareByEmail-textInput data-bind="visible: canSendEmail()"><textarea class=Sharing-mailInput data-bind="enable: sendEmail, textInput: emailInputText, attr: { placeholder: inputPlaceholder }">\r\n        </textarea>\x3c!--ko if: expirationLabel--\x3e<div class=od-ShareByEmail-expirationLabel><i class="od-ShareByEmail-expirationIcon ms-Icon ms-Icon--Calendar" data-bind="icon: true"></i> <span class=od-ShareByEmail-expirationText data-bind="text: expirationLabel"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: arePasswordProtectedLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<div class=od-ShareByEmail-passwordLabel><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-ShareByEmail-passwordProtectedText data-bind="text: passwordProtectedLabel"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: !hasSharingLink--\x3e<div class=Sharing-link data-bind="visible: supportsSharingPropagation()"><input id=Sharing-aclPropagation type=checkbox data-bind="checked: propagateSharing"> <label for=Sharing-aclPropagation class=Sharing-aclPropagationLabel data-bind="text: propagateSharingLabel"></label></div><div class=Sharing-options data-bind="visible: canSendEmail() && sharingRoleOptions().length > 0 && !hideOptions"><div class=Sharing-link data-bind="visible: canSendLink"><input id=Sharing-requireSignIn type=checkbox data-bind="checked: requireSignIn, event: { change: requireSignInChanged }"> <label for=Sharing-requireSignIn data-bind="text: requireSignInLabel, attr: { title: requireSignInTooltip }"></label></div><div class=Sharing-link data-bind="visible: showSendEmailOption"><input id=Sharing-sendEmailCheckbox type=checkbox data-bind="checked: sendEmail, enable: requireSignIn()"> <label for=Sharing-sendEmailCheckbox data-bind="text: sendEmailLabel"></label></div></div>\x3c!--/ko--\x3e<div class=Sharing-charCounter data-bind="visible: charLimitVisible, css: { \'Sharing-charCounter--limitReached\': charLimitReached }, text: charCountText" aria-live=polite></div><div class=ms-clearfix></div>\x3c!--ko if: showShareButton--\x3e<div class=Sharing-submit><button class="Sharing-submitButton od-Button od-Button--primary" data-bind="click: shareClicked, enable: shareAvailable, automation: \'shareDialogCommit\'"><span class=od-Button-label data-bind="text: shareButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: sharingError()--\x3e<div class=od-ShareByEmail-error data-bind="text: sharingError" aria-live=assertive></div>\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/sharing/shareByEmail/ShareByEmail.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".Sharing{overflow:hidden}.Sharing .Sharing-requireSignInLabel{border-bottom-style:dotted;border-bottom-width:1px}.Sharing-options{width:85%}html[dir=ltr] .Sharing-options{float:left}html[dir=rtl] .Sharing-options{float:right}html[dir=ltr] .Sharing-charCounter{text-align:right}html[dir=rtl] .Sharing-charCounter{text-align:left}.Sharing-charCounter--limitReached{color:#a80000}.Sharing-submitButton{position:relative;width:100%;height:30px;margin-top:5px}html[dir=ltr] .Sharing-submit{float:right}html[dir=rtl] .Sharing-submit{float:left}.Sharing-loadingSpinner{text-align:center;padding:75px 0}.Sharing-table{display:table;width:100%;border-collapse:collapse}.Sharing-row{display:table-row;width:100%}.Sharing-cell{display:table-cell}.Sharing-peoplePicker{width:100%;vertical-align:top}.Sharing-link{padding-bottom:5px}.Sharing-simpleRoleSelector{padding:2px;vertical-align:top;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:12px;font-weight:400;height:33px}[dir=ltr] .Sharing-simpleRoleSelector{margin-left:8px}[dir=rtl] .Sharing-simpleRoleSelector{margin-right:8px}.Sharing-mailInput{resize:none;height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}#Sharing-aclPropagation,#Sharing-requireSignIn,#Sharing-sendEmailCheckbox{display:inline-block;vertical-align:sub}[dir=ltr] #Sharing-aclPropagation,[dir=ltr] #Sharing-requireSignIn,[dir=ltr] #Sharing-sendEmailCheckbox{margin-right:5px}[dir=rtl] #Sharing-aclPropagation,[dir=rtl] #Sharing-requireSignIn,[dir=rtl] #Sharing-sendEmailCheckbox{margin-left:5px}.od-Sharing-linkSwitcher{display:inline-block;margin-bottom:10px}.od-ShareByEmail-textInput{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ShareByEmail-expirationLabel{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .od-ShareByEmail-expirationIcon{margin-right:8px}[dir=rtl] .od-ShareByEmail-expirationIcon{margin-left:8px}.od-ShareByEmail-expirationText{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}])});define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher",["require","exports","./SharingLinksSwitcherViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingLinksSwitcher.html","./SharingLinksSwitcher.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-sharingLinksSwitcher",template:e("./SharingLinksSwitcher.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcherViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../progressSpinnerFlat/ProgressSpinnerFlat","./SharingLinksSwitcher.resx","../../../providers/sharing/SharingProvider","../../../bindings/css/VisibilityBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","../../../bindings/dismiss/DismissBinding","../../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/string/StringHelper","../../../actions/SwitchSharingLinkAction","../../../bindings/html/BindableHtmlBinding","@ms/odsp-utilities/lib/locale/Locale","../../../bindings/focus/SelectOnFocusBinding","../../../providers/suiteNav/SuiteNavProvider","../../../utilities/sharing/SharingHelper"],function(e,t,i,a,o,d,s,l,c,p,u,h,m,g,f,b,y,v,x,_,S,k,P,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.loadingSpinnerTagName=c.default.tagName;t.progressSpinnerFlatTagName=p.default.tagName;t._anonymousLinksEnabled=!1;t._organizationLinksEnabled=!1;e.item&&(t._item=e.item);t._stateArray=e.dialogStateArray||a.observable([]);t.addBindingHandlers({bindableHtml:_.default,dismiss:b.default,selectOnFocus:k.default,visibility:m.default});t._selectionModel=t.resources.consume(s.itemsSelection);t._selectionHelper=t.resources.consume(y.resourceKey);t._sharingProvider=t.resources.consume(h.resourceKey);t._engagement=t.resources.consume(l.resourceKey);t.loading=a.observable(!0);t.sharingLinksSelectorStrings=u.strings;t.error=a.observable("");t.links=a.observable([]);t._unsavedLinkType=a.observable(8);t.sharingLinkMenuItems=a.observableArray();t.isSharingLinkMenuOpen=a.observable(!1);t.menuAlignment=a.observable(S.default.isRightToLeft?f.default.Left:f.default.Right);t.menuLeft=a.observable(S.default.isRightToLeft?"0":"auto");t.linkSelectorCurrentLabelText=a.observable("");t.currentSharingLink=e.currentLink||a.observable(null);t.selectedSharingLinkType=e.currentLink&&e.currentLink()?a.observable(e.currentLink().type):a.observable(8);t.editChecked=a.observable(!1);t.editVisible=a.observable(!0);t.isUpdatingLink=a.observable(!1);t.processingSharingLink=a.observable(!0);t.sharingLinkError=a.observable("");t.linkExpirationMenuItems=a.observableArray();t.isLinkExpirationMenuOpen=a.observable(!1);t.shouldShowLinkExpiration=a.observable(!1);t.shouldShowCustomExpiration=a.observable(!1);t.sharingLinkExpirationDate=a.observable("");t.sharingLinkExpirationNumDays=a.observable(0);t.sharingLinkExpirationLabel=t.createComputed(function(){return 0===t.sharingLinkExpirationNumDays()?t.sharingLinksSelectorStrings.SetSharingLinkExpiration:t.sharingLinksSelectorStrings.UpdateSharingLinkExpiration});t.shouldShowSetExpirationDropDown=a.observable(!0);t._companyDisplayName=a.observable("");var i=t.resources.consume(P.resourceKey.optional);i&&i.loadData().then(function(e){t._companyDisplayName(e.CompanyDisplayName);null!=t.currentSharingLink()&&t._setCurrentLinkLabelText(t.currentSharingLink().type)});var o=!1;t._selectionModel&&t._selectionModel.selection&&1<t._selectionModel.selection().length&&(o=!0);var r=t._sharingProvider.getSharingData(t._getCurrentItem());if(!o)if(null==t.currentSharingLink())t.isReady=r.getBestSharingLink().then(function(e){if(e){t._setSelectedType(e.type);t._setCurrentSharingLink(e);t.editChecked(6===e.type||9===e.type&&2===e.role);t.processingSharingLink(!1)}},function(e){t._handleSharingLinkError()});else{t.editChecked(6===t.currentSharingLink().type||9===t.currentSharingLink().type&&2===t.currentSharingLink().role);t.processingSharingLink(!1)}t.isSingleLinkLabelVisible=!1;r.getSettings().done(function(e){t.canManageLinks=e.canManageLinks;t._anonymousLinksEnabled=e.anonymousLinksEnabled;t._organizationLinksEnabled=e.organizationLinksEnabled;if(null!=t.currentSharingLink()){t._setSelectedType(t.currentSharingLink().type);t._setCurrentSharingLink(t.currentSharingLink())}t._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;t._enforceRequiredAnonymousLinkExpiration=0<Number(e.requiredAnonymousLinkExpirationInDays);t.shouldShowSetExpirationDropDown(!t._enforceRequiredAnonymousLinkExpiration);t.loading(!1)},function(e){});t._getSharingLinks().then(function(e){if(null!=e&&0<e.length){t.links(e);t.isSingleLinkLabelVisible=e.length<2;null==t.currentSharingLink()&&t._setSelectedType(e[0].type)}},function(e){t._handleSharingLinkError();t.loading(!1)});return t}e.prototype.onClickSharingLinkMenu=function(e,t){var i=this._engagement,o=this,r=new g.default({text:this._getLinkLabelText(8),subtext:this._getLinkLabelSubtext(8),isToggleable:!1,callback:function(){o.menuItemClick(8);i.logData({name:"SwitchToDirectLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),n=new g.default({text:this._getLinkLabelText(9),subtext:this._getLinkLabelSubtext(9),isToggleable:!1,callback:function(){o.menuItemClick(9);i.logData({name:"SwitchToOrganizationLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),a=new g.default({text:this._getLinkLabelText(5),subtext:this._getLinkLabelSubtext(5),isToggleable:!1,callback:function(){o.menuItemClick(5);i.logData({name:"SwitchToAnonymousLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),s=[r];this._organizationLinksEnabled&&s.push(n);this._anonymousLinksEnabled&&s.push(a);this.sharingLinkMenuItems(s);this.isSharingLinkMenuOpen(!this.isSharingLinkMenuOpen());return s};e.prototype.menuItemClick=function(e){this._setSelectedType(e);this._unsavedLinkType(e);this._setCurrentLinkLabelText(e)};e.prototype.onDismissSharingLinksMenu=function(e,t){this.isSharingLinkMenuOpen(!1)};e.prototype.onClickLinkExpirationMenu=function(e,t){var a=this;if(this.processingSharingLink())return null;if(this._enforceRequiredAnonymousLinkExpiration){this.shouldShowCustomExpiration(!0);this.sharingLinkExpirationNumDays.peek()&&"0"!==String(this.sharingLinkExpirationNumDays.peek())||this.sharingLinkExpirationNumDays(this._adminRequiredAnonymousLinkExpirationInDays);this.sharingLinkError("");return null}var s=this,l=[],d=this._getAvailableExpirationOptions();Object.keys(d).forEach(function(e,t,i){var o=d[e],r=!isNaN(o)&&0<=o?a._calculateLinkExpiration(o):"CUSTOM",n=new g.default({text:e,isToggleable:!1,callback:function(){s.expiryDateChanged(r,o/1440)}});l.push(n)});this.linkExpirationMenuItems(l);this.isLinkExpirationMenuOpen(!this.isLinkExpirationMenuOpen());return l};e.prototype.expiryDateChanged=function(e,t){if("CUSTOM"===e)this.shouldShowCustomExpiration(!0);else if(e){this.sharingLinkExpirationNumDays(t);this.shouldShowCustomExpiration(!0)}else{this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1)}};e.prototype.onDismissLinkExpirationMenu=function(e,t){this.isLinkExpirationMenuOpen(!1)};e.prototype.switchLinksClick=function(){var o,r=this,n=this.selectedSharingLinkType();5===n&&this.editChecked()&&(n=6);this.links().forEach(function(e,t,i){e.type===n&&(9!==n||9===n&&2===e.role&&r.editChecked()||9===n&&1===e.role&&!r.editChecked())&&(o=e)});o||(o={type:n,role:this.editChecked()?2:1,url:""});var a=o&&o.expiration;if(this.shouldShowLinkExpiration()){var e=parseInt(String(this.sharingLinkExpirationNumDays()),10);if(String(this.sharingLinkExpirationNumDays())===String(e)){var t;if(e<0||730<e)t=this.sharingLinksSelectorStrings.LinkExpiration_InvalidValueErrorMessage;else if(this._enforceRequiredAnonymousLinkExpiration)if(e>this._adminRequiredAnonymousLinkExpirationInDays){var i=v.getLocalizedCountValue(this.sharingLinksSelectorStrings.LinkExpiration_AdminRequiredValueErrorMessage,this.sharingLinksSelectorStrings.LinkExpiration_ExpirationDaysIntervals,this._adminRequiredAnonymousLinkExpirationInDays);t=v.format(i,this._adminRequiredAnonymousLinkExpirationInDays)}else 0===e&&(e=this._adminRequiredAnonymousLinkExpirationInDays);if(t){this._handleSharingLinkError(t);return}a=0<e?this._calculateLinkExpiration(1440*e):null}}var s,l=this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection();s=!this._item||l&&1<l.length?this._selectionHelper.resolveSelection():d.default.wrap([this._item]);this.sharingLinkError("");s.then(function(e){new(r.managed(x.default))({items:e,link:o,expiration:a,isExecuting:r.isUpdatingLink,successCallback:function(e){r.shouldShowCustomExpiration(!1);if(null!=e){var t=r._engagement;"CUSTOM"===a?t.logData({name:"SwitchTo"+e.tag+"Link.Custom.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):a?t.logData({name:"SwitchTo"+e.tag+"Link.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):t.logData({name:"SwitchTo"+e.tag+"Link.SharingLinksSwitcher.Click",isIntentional:!0});if(!r.currentSharingLink()||e.type!==r.currentSharingLink().type||e.role!==r.currentSharingLink().role||e.expiration!==r.currentSharingLink().expiration){o.url=e.url;o.expiration=e.expiration;o.isActive=!!o.url;r._setCurrentSharingLink(o);r.processingSharingLink(!1)}var i=r._stateArray();i.pop();r._stateArray(i)}else r._handleSharingLinkError()},failureCallback:function(e){r._handleSharingLinkError(e)}}).execute(null)})};e.prototype.onClickCancelCustomExpiration=function(e,t){if(this.processingSharingLink())return!1;this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1);this.sharingLinkError("")};e.prototype._getAvailableExpirationOptions=function(){var n=this,a=[];a[this.sharingLinksSelectorStrings.LinkExpiration_Never]=0;[1,30,60].forEach(function(e,t,i){var o=1===e?n.sharingLinksSelectorStrings.LinkExpiration_SingleDay:v.format(n.sharingLinksSelectorStrings.LinkExpiration_MultiDay,e),r=1440*e;a[o]=r});a[this.sharingLinksSelectorStrings.LinkExpiration_Custom]=-1;return a};e.prototype._getSharingLinks=function(){var t=this;return this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){return e},function(e){t.error(t.sharingLinksSelectorStrings.ServerError);return null})};e.prototype._setSelectedType=function(e){6===e&&(e=5);this.selectedSharingLinkType(e);this._setCurrentLinkLabelText(e);8===e?this.editVisible(!1):this.editVisible(!0);5!==e?this.shouldShowLinkExpiration(!1):this.shouldShowLinkExpiration(!0)};e.prototype._setCurrentSharingLink=function(e){if(e){this.currentSharingLink(e);this._setCurrentLinkLabelText(e.type);this.shouldShowLinkExpiration(e.supportsExpiration);if(e.supportsExpiration){var t=e.expiration?new Date(e.expiration):null,i=e.expiration?t.toLocaleDateString():null;this.sharingLinkExpirationNumDays(r.getNumberOfDaysUntilExpiry(t));this.sharingLinkExpirationDate(i?v.format(this.sharingLinksSelectorStrings.LinkExpiration_DateDescription,i):"")}}};e.prototype._setCurrentLinkLabelText=function(e){this.linkSelectorCurrentLabelText(this._getLinkLabelText(e))};e.prototype._getLinkLabelSubtext=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkSubtext;case 9:return this._companyDisplayName()?v.format(this.sharingLinksSelectorStrings.OrganizationSubtext,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.AnonymousLinkSubtext}return""};e.prototype._getLinkLabelText=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkLabel;case 9:return this._companyDisplayName()?v.format(this.sharingLinksSelectorStrings.OrganizationTenantAccountRequired,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.NoSignInRequiredLabel}return""};e.prototype._calculateLinkExpiration=function(e){if(0<e){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};e.prototype._getCurrentItem=function(){return this._item?this._item:a.utils.unwrapObservable(this._selectionModel.selection()[0])};e.prototype._handleSharingLinkError=function(e){this.processingSharingLink(!1);this.sharingLinkError(e||this.sharingLinksSelectorStrings.ServerError)};return e}(o.default);t.default=n});define("odsp-next/actions/SwitchSharingLinkAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/sharing/SharingProvider"],function(e,t,o,i,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="SwitchSharingLink";t._items=e.items;t._newLink=e.link;t._successCallback=e.successCallback;t._failureCallback=e.failureCallback;t._isExecuting=e.isExecuting;t._sharingProvider=t.resources.consume(r.resourceKey);t._expiration=e.expiration;return t}e.prototype.onExecute=function(e,t){var r=this,i=this._expiration&&"CUSTOM"!==this._expiration?new Date(this._expiration).toLocaleDateString():null,o=this._newLink.expiration?new Date(this._newLink.expiration).toLocaleDateString():null;if(this._expiration&&"CUSTOM"!==this._expiration&&i!==o||!this._expiration&&this._newLink.expiration){this._isExecuting&&this._isExecuting(!0);return new n.default(function(t,e){var i={},o={type:r._newLink.type,role:r._newLink.role,create:!0,expiration:r._expiration};r._sharingProvider.manageSharingLinks(r._items,o).then(function(e){r._successCallback&&r._successCallback(e[0]);i.resultType=a.ResultTypeEnum.Success;t(i)},function(e){r._failureCallback&&r._failureCallback(e&&e.message?e.message.value:"");i.resultType=a.ResultTypeEnum.Failure;t(i)})})}if(this._newLink.isActive){this._successCallback&&this._successCallback(this._newLink,this._expiration);return n.default.wrap({resultType:a.ResultTypeEnum.Success})}this._successCallback(this._newLink);return n.default.wrap({resultType:a.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};return e}(i.default);t.default=s});define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher.html",[],function(){return'\x3c!--ko if:loading--\x3e<div class=od-SharingLinksSwitcher-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: error"><span data-bind="text: error"></span></div><div class=od-SharingLinksSwitcher-sharingLinkSelector><div class=od-SharingLinksSwitcher-linkPickerArea><span class=od-SharingLinksSwitcher-linkLabel data-bind="text: sharingLinksSelectorStrings.LinkLabelText"></span>\x3c!--ko if:isSingleLinkLabelVisible--\x3e<span class=od-SharingLinksSwitcher-linkInput-label data-bind="text: linkSelectorCurrentLabelText()"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isSingleLinkLabelVisible--\x3e<a href=javascript:; class="od-SharingLinksSwitcher-dropdownLinkContainer ms-font-color-neutralPrimary ms-lines ms-fullWidth" aria-haspopup=true data-bind="click: onClickSharingLinkMenu, hasFocus: true, dismiss: onDismissSharingLinksMenu, attr: {\'aria-expanded\': isSharingLinkMenuOpen}"><span class=od-SharingLinksSwitcher-dropdownText data-bind="text: linkSelectorCurrentLabelText()"></span> <i class="ms-Icon ms-Icon--ChevronDown od-SharingLinksSwitcher-dropdownArrow" data-bind="icon: true, visible: shouldShowSetExpirationDropDown, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: sharingLinkMenuItems, isOpen: isSharingLinkMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu>\x3c!--/ko--\x3e</div>\x3c!--ko if: editVisible--\x3e<div><input type=checkbox id=od-SharingLinkSwitcher-canEdit data-bind="checked: editChecked"> <label for=od-SharingLinkSwitcher-canEdit data-bind="text: sharingLinksSelectorStrings.CanEditLabel"></label></div>\x3c!--/ko--\x3e\x3c!--ko if:shouldShowLinkExpiration--\x3e<div class=od-SharingLinksSwitcher-linkExpirationArea><div data-bind="visible: !shouldShowCustomExpiration(), automation: \'SharingLinksSwitcher-expiration-selector\'"><span class=od-SharingLinksSwitcher-expiration-expirationText data-bind="visible: !!sharingLinkExpirationDate(), text: sharingLinkExpirationDate, automation: \'SharingLinksSwitcher-expiration-expirationSpan\'"></span> <span class=od-SharingLinksSwitcher-LinkExpirationMenuArea><a tabindex=0 class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-dropdownLinkContainer" aria-haspopup=true data-bind="click: onClickLinkExpirationMenu, dismiss: onDismissLinkExpirationMenu, attr: {\'aria-expanded\': isLinkExpirationMenuOpen}"><span class="od-SharingLinksSwitcher-expiration-dropdownText ms-uppercase" data-bind="text: sharingLinkExpirationLabel"></span> <i class="ms-Icon ms-Icon--ChevronDown ms-callout-icon od-SharingLinksSwitcher-expiration-dropdownArrow" data-bind="icon: true, visible: shouldShowSetExpirationDropDown, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: linkExpirationMenuItems, isOpen: isLinkExpirationMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></span></div><div class=ms-fullWidth data-bind="visible: shouldShowCustomExpiration"><div class=od-SharingLinksSwitcher-expiration-expirationText><span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_BeforeTextBox"></span> <input type=text class=od-SharingLinksSwitcher-expirationInput data-bind="selectOnFocus, value:sharingLinkExpirationNumDays, title:sharingLinksSelectorStrings.LinkExpiration_CustomValueTooltip"> <span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_AfterTextBox"></span></div><div class=od-SharingLinksSwitcher-expiration-buttons><a href=javascript:; class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-expirationSave" data-bind="click: onClickCancelCustomExpiration, text: sharingLinksSelectorStrings.CancelCustomExpiration, automation: \'SharingLinksSwitcher-expiration-cancelLink\'"></a></div></div></div>\x3c!--/ko--\x3e<div class=od-SharingLinksSwitcher-rightArea>\x3c!--ko if: isUpdatingLink--\x3e<div class=od-SharingLinksSwitcher-processing data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: \'\' } }"></div>\x3c!--/ko--\x3e<button class="od-Dialog-action od-Button" data-bind="css: { \'od-Button--primary\': true }, click: switchLinksClick, enable: !isUpdatingLink()"><span class=od-Button-label data-bind="text: sharingLinksSelectorStrings.OkayButtonLabel"></span></button></div><div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: sharingLinkError"><span data-bind="text: sharingLinkError"></span></div><div class=ms-clearfix></div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"html[dir=ltr] .od-SharingLinksSwitcher-rightArea{float:right}html[dir=rtl] .od-SharingLinksSwitcher-rightArea{float:left}.od-SharingLinksSwitcher-processing{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-SharingLinksSwitcher-processing{padding-right:5px}[dir=rtl] .od-SharingLinksSwitcher-processing{padding-left:5px}.od-SharingLinksSwitcher-loadingSpinner{text-align:center;padding:75px 0}.od-SharingLinksSwitcher-linkInput-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:block;padding-top:5px}.od-SharingLinksSwitcher-linkLabel{display:block;padding-bottom:5px}.od-SharingLinksSwitcher-updateLinkButton{font-size:12px;font-weight:400;text-transform:uppercase;white-space:nowrap;display:inline-block;cursor:pointer}a.od-SharingLinksSwitcher-updateLinkButton{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-SharingLinksSwitcher-linksSection{padding-bottom:20px}.od-SharingLinksSwitcher-error{color:#a80000}.od-SharingLinksSwitcher-linkPickerArea{margin-bottom:14px}.od-SharingLinksSwitcher-dropdownLinkContainer{color:inherit;display:inline-block;box-sizing:border-box;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:100%;padding:4px 10px;padding-bottom:2px}@media (max-width:639px){.od-SharingLinksSwitcher-dropdownLinkContainer{width:223px}}.od-SharingLinksSwitcher-dropdownLinkContainer:hover,.od-SharingLinksSwitcher-dropdownLinkContainer:visited{color:inherit;text-decoration:none}.od-SharingLinksSwitcher-dropdownArrow,.od-SharingLinksSwitcher-expiration-dropdownArrow{display:inline-block;position:relative;top:5px}html[dir=ltr] .od-SharingLinksSwitcher-dropdownArrow,html[dir=ltr] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:right}html[dir=rtl] .od-SharingLinksSwitcher-dropdownArrow,html[dir=rtl] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:left}.od-SharingLinksSwitcher-linkTypeText{padding:10px}.od-SharingLinksSwitcher-expiry-div{border-collapse:separate}.od-SharingLinksSwitcher-singleLinkLabel{display:inline-block;width:433px;padding:4px 0;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639px){.od-SharingLinksSwitcher-singleLinkLabel{width:223px}}.od-SharingLinksSwitcher-dropdownText{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639px){.od-SharingLinksSwitcher-dropdownText{width:183px}}.od-SharingLinksSwitcher-expiration-dropdownText{display:inline-block;overflow:hidden}.od-SharingLinksSwitcher-linkBoxArea{margin-bottom:5px}.od-SharingLinksSwitcher-sharingLinkSelector .od-SharingLinksSwitcher-linkInput-textbox{box-sizing:border-box;width:95%}.od-SharingLinksSwitcher-linkExpirationArea{margin-bottom:7px}.od-SharingLinksSwitcher-LinkExpirationMenuArea{display:inline-block}.od-SharingLinksSwitcher-expiration-dropdownLinkContainer{display:inline-block;vertical-align:middle}.od-SharingLinksSwitcher-expiration-expirationText{display:inline-block}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationText{padding-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationText{padding-left:10px}.od-SharingLinksSwitcher-expirationInput{display:inline-block;width:30px;margin-top:-5px;cursor:text}.od-SharingLinksSwitcher-expiration-buttons{display:inline-block}.od-SharingLinksSwitcher-expiration-expirationSave{display:inline-block;vertical-align:text-bottom}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationSave{margin-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationSave{margin-left:10px}.od-SharingLinksSwitcher-expiration-expirationError{margin-top:6px}.od-SharingLinksSwitcher-sharingLinkSelector a.od-ContextualMenu-item{padding:10px}#od-SharingLinkSwitcher-canEdit{display:inline-block;vertical-align:sub;margin-bottom:15px}[dir=ltr] #od-SharingLinkSwitcher-canEdit{margin-right:5px}[dir=rtl] #od-SharingLinkSwitcher-canEdit{margin-left:5px}"}])});define("odsp-next/controls/sharing/sharingHints/SharingHints",["require","exports","./SharingHintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingHints.html","./SharingHints.css","../../persona/Persona"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-sharingHints",template:e("./SharingHints.html"),viewModel:i.default});t.default=r});define("odsp-next/controls/sharing/sharingHints/SharingHintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SharingHints.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../shareByEmail/Sharing.resx","../../../models/item/ItemType"],function(e,t,i,o,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._openAnchorHtml='<a href="javascript:;" data-bind="attr:{title: sharedWithLinkTitle}, click: switchTabs">';t._closeAnchorHtml="</a>";t._lastPersonTemplate='<od-persona class="od-SharingHints-persona" params="{ person: lastPerson, personaSize: 1, showPresence: true, profileLinkOn: true }" ></od-persona>';t._peopleTemplate='<span data-bind = "foreach: usersTrimmed" >    <od-persona class="od-SharingHints-persona" params="{ person: $data, personaSize: 1, showPresence: true, profileLinkOn: true, includeComma: true }" ></od-persona></span>';var i=s.strings.SharedWithText,o=s.strings.SharedWithOneText;t.sharedWithLinkTitle=t.createObservable("");t.addBindingHandlers({bindableHtml:d.default});t.guestLinkExists=e.guestLinkExists;t.sharedWithMany=e.sharedWithMany||t.observables.create(!1);t.anonymousLinksText=s.strings.GuestLinkText;t.showGuestLinkHint=8==(8&e.sharingHintsOption);t.showOnlyYouHint=4==(4&e.sharingHintsOption);t.showSharedWithHint=2==(2&e.sharingHintsOption);t.showNumberOfFilesHint=1==(1&e.sharingHintsOption);t.showNumberOfFilesOnlyHint=0===e.sharingHintsOption;if(1===e.items.length){var r=e.items[0],n=s.strings.SharedWithManyText;t.sharedWithLinkTitle(l.format(s.strings.SharedWithLinkTitle,r.name));t._isFolder=r.type===u.default.Folder;t._totalFileCount=t._isFolder&&r.folder?r.folder.totalCount:0;t.totalFileCountText=l.format(p.strings.SharingHintNumberOfFilesText,t._totalFileCount);t.showNumberOfFilesHint=t.showNumberOfFilesHint&&c.isFeatureEnabled(c.OversharingMitigations)&&t._isFolder&&1<t._totalFileCount;t.showNumberOfFilesOnlyHint=t.showNumberOfFilesOnlyHint&&c.isFeatureEnabled(c.OversharingMitigations)&&t._isFolder&&1<t._totalFileCount;t.showNumberOfFilesHint&&(n=n.toLowerCase());t.sharedWithManyHtml=l.format(n,t._openAnchorHtml,t._closeAnchorHtml)}else{t.sharedWithManyHtml="";t._isFolder=!1;t._totalFileCount=0;t.totalFileCountText="";t.showNumberOfFilesHint=!1}t.onlyYouText=s.strings.OnlyYouText;t._sharedWithCallBack=e.sharedWithCallback;t.users=e.sharedWith?t.observables.createArray(e.sharedWith().reverse()):t.observables.createArray([]);t.usersTrimmed=t.createComputed(function(){var e=t.users().length;return e<4?t.users().slice(0,e-1):t.users().slice(0,3)});t.lastPerson=t.createComputed(function(){var e=t.users().length;return 0<e?t.users()[e-1]:null});t._moreLink=t.createComputed(function(){return t._openAnchorHtml+l.format(s.strings.NumberMoreText,t.users().length-3)+t._closeAnchorHtml});if(t.showNumberOfFilesHint){i=i.toLowerCase();o=o.toLowerCase()}4<t.users().length?t.sharedWithHtml=l.format(i,t._peopleTemplate,t._moreLink()):1===t.users().length?t.sharedWithHtml=l.format(o,t._lastPersonTemplate):t.sharedWithHtml=l.format(i,t._peopleTemplate,t._lastPersonTemplate);return t}e.prototype.switchTabs=function(){this._sharedWithCallBack&&this._sharedWithCallBack()};return e}(o.default);t.default=r});define("odsp-next/controls/sharing/sharingHints/SharingHints.html",[],function(){return'<div class=od-SharingHints><div class=od-SharingHints-shared data-bind="visible: showSharedWithHint && sharedWithMany()"><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithManyHtml"></span></div><div class=od-SharingHints-shared data-bind="visible: showNumberOfFilesOnlyHint"><span class=od-SharingHints-text data-bind="text: totalFileCountText"></span></div>\x3c!--ko if: showSharedWithHint && users().length > 0 && !sharedWithMany()--\x3e<div class=od-SharingHints-shared><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithHtml"></span></div>\x3c!--/ko--\x3e<div class=od-SharingHints-private data-bind="visible: showOnlyYouHint && users().length === 0 && !guestLinkExists() && !sharedWithMany()"><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="text: onlyYouText"></span></div><div class=od-SharingHints-externalWarning data-bind="visible: showGuestLinkHint && guestLinkExists"><i class="ms-Icon ms-Icon--Globe" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="text: anonymousLinksText"></span></div></div>'});define("odsp-next/controls/sharing/sharingHints/SharingHints.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharingHints{width:100%}.od-SharingHints .od-Persona--tiny{line-height:13px}.od-SharingHints .od-Persona--tiny .od-Persona-details{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-left:0}[dir=rtl] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-right:0}.od-SharingHints-text{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingHints-persona{display:inline-block}"}])});define("odsp-next/controls/sharing/sharingWizard/SharingWizard.html",[],function(){return'<div class=od-SharingWizard>\x3c!--ko if: isLoading--\x3e<div class=od-SharingWizard-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isLoading--\x3e<div class=od-SharingWizard-sharingHints data-bind="component: {name: sharingHintsTagName, params: sharingHintsParams }"></div><div class=od-SharingWizard-component data-bind="component: componentDefinition"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/sharing/sharingWizard/SharingWizard.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Dialog-content .od-SharingWizard{margin:-16px -32px -20px}.od-SharingWizard-loadingSpinner{margin-top:90px;text-align:center;margin-bottom:90px}.od-SharingWizard-component{padding:5px 32px 32px}.od-SharingWizard-sharingHints{padding:5px 27px 0}"}])});define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AddPhotosToAlbumExecutorViewModel","./AddPhotosToAlbumExecutor.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"add-photos-to-album-executor",template:e("./AddPhotosToAlbumExecutor.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/bundleBuilder/BundleBuilder","../../models/item/IItemTypeFilter","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../providers/album/AlbumProvider.key","../../controls/albumBuilder/AlbumBuilder.resx"],function(e,t,i,o,r,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.panelOverlayTagName=r.default.tagName;t.bundleBuilderTagName=n.default.tagName;var i=e.item;t._urlDataSource=t.resources.consume(l.url);t._item=i;t._signal=new c.default;t.showBundleBuilder=t.createObservable(!0);t.endWith(t.trackPromise(t._signal.getPromise().then(function(e){t.showBundleBuilder(!1);return t._addPhotosToAlbum(e)})));t.bundleBuilderParams={bundleName:t._item.name,typeFilter:{filters:[a.ItemTypeFilter.folder,a.ItemTypeFilter.media]},itemKey:t._urlDataSource.getRootItemKey(s.default.AllMyPhotos),complete:function(e){return t._complete(e)},cancel:function(){return t._cancel()}};t.panelOverlayParams={size:"XLarge",onClose:function(){return t.action.cancel()},showCloseButton:!1};return t}e.prototype._complete=function(e){for(var t=0,i=0,o=e;i<o.length;i++){var r=o[i];(r.photo||r.video)&&t++}if(t<e.length)return d.default.wrapError(new Error(u.strings.errorInvalidItems));this._signal.complete(e);return d.default.wrap()};e.prototype._cancel=function(){this._signal.cancel();return d.default.wrap()};e.prototype._addPhotosToAlbum=function(t){var i=this;return this.resources.consumeAsync(p.resourceKey).then(function(e){return e.addToAlbum({album:i._item,items:t})}).then(function(){})};return e}(o.default);t.default=h});define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor.html",[],function(){return"\x3c!--ko if: showBundleBuilder--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: panelOverlayParams\r\n}--\x3e\x3c!--ko component: {\r\n name: bundleBuilderTagName,\r\n params: bundleBuilderParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/actions/createAlbum/CreateAlbumExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateAlbumExecutorViewModel","./CreateAlbumExecutor.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"create-album-executor",template:e("./CreateAlbumExecutor.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/actions/createAlbum/CreateAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/albumBuilder/AlbumBuilder","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../controls/albumBuilder/AlbumBuilder.resx","../../dataSources/item/ItemDataSource.resx","./CreateAlbumOperator"],function(e,t,o,i,r,n,a,s,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.panelOverlayTagName=r.default.tagName;t.albumBuilderTagName=n.default.tagName;t._urlDataSource=t.resources.consume(s.url);t._name=t.createObservable("");t.showAlbumBuilder=t.createObservable(!0);t._signal=new d.default;t.endWith(t.trackPromise(t._signal.getPromise().then(function(e){t.showAlbumBuilder(!1);return t._createAlbum(e)})));t.albumBuilderParams={name:t._name,itemKey:t._urlDataSource.getRootItemKey(a.default.AllMyPhotos),complete:function(e){return t._complete(e)},cancel:function(){return t._cancel()}};t.panelOverlayParams={size:"XLarge",onClose:function(){return t.action.cancel()},showCloseButton:!1};return t}e.prototype._complete=function(e){var t=this._name.peek();if(!t)return l.default.wrapError(new Error(c.strings.errorNameNotSpecified));if(new RegExp('[/"*:<>?/|/]+').test(t))return l.default.wrapError(new Error(p.strings.InvalidChar));for(var i=0,o=0,r=e;o<r.length;o++){var n=r[o];(n.photo||n.video)&&i++}if(i<e.length)return l.default.wrapError(new Error(c.strings.errorInvalidItems));this._signal.complete(e);return l.default.wrap()};e.prototype._cancel=function(){this._signal.cancel();return l.default.wrap()};e.prototype._createAlbum=function(e){var i=this,o=this._name.peek(),r=e.map(function(e){return e.key});return this.resources.consumeAsync(u.typeResourceKey).then(function(e){var t=new e({name:o,keys:r});i.trackPromise(t.start());return t.wait()})};return e}(i.default);t.default=h});define("odsp-next/controls/albumBuilder/AlbumBuilder",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AlbumBuilderViewModel","./AlbumBuilder.html","../itemContent/ItemContent.css","./AlbumBuilder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-album-builder",template:e("./AlbumBuilder.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/albumBuilder/AlbumBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","../../bindings/editableText/EditableTextBinding","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../dataSources/url/QueryType","./AlbumBuilder.resx","../../models/item/IItemTypeFilter","knockout"],function(e,t,i,o,l,d,c,p,u,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t.filePickerHostTagName=l.default.tagName;t.addBindingHandlers({editableText:d.default});t._urlDataSource=t.resources.consume(p.url);var i=e.name,o=e.itemKey,r=void 0===o?t._urlDataSource.getRootItemKey(u.default.AllMyPhotos):o,n=e.complete,a=e.cancel;t.filePickerHostParams={itemKey:r,behavior:{showActions:!1,viewType:1,selectionMode:1,typeFilter:{filters:[m.ItemTypeFilter.media,m.ItemTypeFilter.folder]},completeText:h.strings.createCompleteActionName},agent:{initialize:function(){return c.default.wrap()},getApplication:function(){return c.default.wrap()},complete:n,cancel:a,switchAccount:function(){return c.default.wrap()}}};t.nameBindingOptions={text:i,placeholder:g.observable(h.strings.createNamePlaceholder),hasFocus:!0};return t}e.prototype.onClick=function(e,t){t.stopPropagation();return!1};return e}(o.default);t.default=r});define("odsp-next/bindings/editableText/EditableTextBinding",["require","exports","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/async/Async","knockout","./EditableText.css"],function(e,t,f,b,y,v,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _="od-EditableText--editMode",S=27,k=13,i=function(){function g(){}g.init=function(t,e,i,o,r){var n=e(),a=o,s='<div class="od-TextField od-TextField--multiline"><textarea data-bind="value: $data.text" class="od-TextField-field od-EditableText-textArea"'+(n.maxLength?' maxlength="'+n.maxLength+'" ':"")+"></textarea></div>";y.default.toggleClass(t,"od-EditableText",!0);t.innerHTML=s+'<a data-bind="text: $data.text" class="od-EditableText-readOnlyArea" href="javascript:void(0)"></a>';var l,d=t.querySelector("textarea"),c=t.querySelector("a"),p=new b.default(null),u=new v.default,h=function(e){if(void 0===n.isEditable||n.isEditable()){y.default.toggleClass(t,_,!0);g._updateTextAreaHeight(d);d.focus();if(d.select)try{d.select()}catch(e){}}},m=function(){if(n.onSubmitChange){n.onSubmitChange.call(a,d.value);y.default.toggleClass(t,_,!1)}};x.applyBindingsToDescendants(r,t);p.on(c,"click",h);p.on(d,"keydown",function(e){l=e.keyCode;if(n.onRevertChange&&l===S){n.text(d.value);n.onRevertChange.call(a);y.default.toggleClass(t,_,!1)}if(l===k){n.text(d.value);m()}e.stopPropagation()});p.on(d,"keyup",function(e){n.text(d.value)});p.on(d,"blur",function(e){l!==k&&m()});x.computed(function(){var e=!n.text(),t=void 0===n.isEditable||n.isEditable();if(n.placeholder){d.setAttribute("placeholder",n.placeholder());e&&(c.innerHTML=n.placeholder())}d.value=n.text();e||(c.innerHTML=f.default.encodeText(n.text()));y.default.toggleClass(c,"od-EditableText-readOnlyArea--empty",e);y.default.toggleClass(c,"od-EditableText-readOnlyArea--interactive",t);g._updateTextAreaHeight(d)},null,{disposeWhenNodeIsRemoved:t});x.utils.domNodeDisposal.addDisposeCallback(t,function(){u.dispose();p.dispose()});x.unwrap(n.hasFocus)&&u.setTimeout(function(){h()},300);return{controlsDescendantBindings:!0}};g._updateTextAreaHeight=function(e){e.offsetHeight<e.scrollHeight&&(e.style.height=e.scrollHeight+0+"px")};return g}();t.default=i});define("odsp-next/bindings/editableText/EditableText.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-EditableText .od-TextField{display:none;min-height:32px;margin:0}.od-EditableText .od-TextField-field.od-EditableText-textArea{min-height:32px;outline-style:none;margin:0 0 -4px}.od-EditableText-textArea{resize:none;overflow:hidden;cursor:text}a.od-EditableText-readOnlyArea{width:100%;text-decoration:none;border:1px solid transparent;padding:4px 3px 5px 8px;min-height:32px;display:block;font-size:14px;outline:0;box-sizing:border-box;word-wrap:break-word;cursor:default}html[dir=rtl] a.od-EditableText-readOnlyArea{padding:4px 8px 5px 3px}a.od-EditableText-readOnlyArea,a.od-EditableText-readOnlyArea:hover,a.od-EditableText-readOnlyArea:visited{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}a.od-EditableText-readOnlyArea--interactive:focus,a.od-EditableText-readOnlyArea--interactive:hover{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";cursor:text}a.od-EditableText-readOnlyArea--empty{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-EditableText--editMode .od-TextField{display:block}.od-EditableText--editMode .od-EditableText-readOnlyArea{display:none}"}])});define("odsp-next/controls/albumBuilder/AlbumBuilder.html",[],function(){return'<div class=od-AlbumBuilder data-bind="component: { name: filePickerHostTagName, params: filePickerHostParams }"><div class="od-AlbumBuilder-content od-ItemContent" data-bind="css: { \'od-AlbumBuilder-content--hasError\': !!$host.status().error && !!$host.status().error.message }"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-AlbumBuilder-title od-ItemContent-title" data-bind="click: onClick, editableText: nameBindingOptions"></div>\x3c!--ko if: !!$host.status().error && !!$host.status().error.message--\x3e<div class="od-AlbumBuilder-status od-ItemContent-subTitle" data-bind="text: !!$host.status().error && $host.status().error.message"></div>\x3c!--/ko--\x3e</div></div></div>'});define("odsp-next/controls/albumBuilder/AlbumBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-AlbumBuilder{position:absolute;top:0;left:0;right:0;bottom:0}.od-AlbumBuilder-title{max-width:340px}.od-AlbumBuilder-title .od-EditableText-textArea,.od-AlbumBuilder-title .od-TextField.od-TextField--multiline .od-TextField-field,.od-AlbumBuilder-title a.od-EditableText-readOnlyArea{font-size:21px;font-weight:100}.od-AlbumBuilder-title .od-EditableText .od-TextField-field.od-EditableText-textArea{min-height:33px}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive{border:none;border-bottom:1px solid transparent}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:focus,.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:hover{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-AlbumBuilder-title .od-TextField-field{border:none;border-bottom:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-AlbumBuilder-title .od-TextField-field{padding-left:0}[dir=rtl] .od-AlbumBuilder-title .od-TextField-field{padding-right:0}.od-AlbumBuilder-status{margin-top:12px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:12px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-header.od-ItemContent-header{height:90px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-status{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-title .od-TextField-field{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}])});define("odsp-next/actions/createAlbum/CreateAlbumExecutor.html",[],function(){return"\x3c!--ko if: showAlbumBuilder--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: panelOverlayParams\r\n}--\x3e\x3c!--ko component: {\r\n name: albumBuilderTagName,\r\n params: albumBuilderParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/actions/printPdf/odc/PrintPdfExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/commands/Commands.resx","../../../controls/pdfViewer/PdfViewer.resx","../../../utilities/icons/Icon","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType"],function(e,t,i,o,r,a,s,l,d,c,p,u,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.actionName,o=e.instrumentationProvider,r=e.selectionHelper;t.name=i;t._instrumentationProvider=o;t._selectionHelper=r;t._actionMap=t.resources.consume(u.actionMap);t._dialogProvider=t.resources.consume(p.resourceKey);return t}e.prototype.execute=function(i){var o=this;return this._selectionHelper.resolveFirst().then(function(e){var t=o._dialogProvider.requestDialog({title:l.strings.PrintOptionsTitle,component:{name:c.default.tagName,params:{text:l.strings.PrintOptionsText}},actions:[{name:s.strings.Download,execute:function(){var e=new(o.managed(o._actionMap.DownloadAction))({});h.default.logData({name:m.UsageName[m.UsageName.PrintPdfDownloadOptionClicked],location:m.LocationName[m.LocationName.OneUp],usageType:g.UsageType[g.UsageType.Click],currentPage:o._instrumentationProvider.currentPageName(),previousPage:o._instrumentationProvider.previousPageName()});e.execute(i);return r.default.wrap(2)},isAvailable:o.createObservable(!0),icon:new d.default("Download"),isDefault:!0}]});h.default.logData({name:m.UsageName[m.UsageName.PrintPdfDownloadOptionShown],location:m.LocationName[m.LocationName.OneUp],usageType:g.UsageType[g.UsageType.Click],currentPage:o._instrumentationProvider.currentPageName(),previousPage:o._instrumentationProvider.previousPageName()});return t.wait().then(function(){return r.default.wrap({resultType:a.ResultTypeEnum.Success})})})};return e}(o.default);t.default=n});define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./SaveAutoAlbumOperator"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._isHidden=e.isHidden;return t}e.prototype.execute=function(e){var t=this,i={album:this._selectionHelper.firstItem.peek(),operationVisibility:this._isHidden?2:0};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(n.default))(i);return t.trackPromise(e.start())}).then(function(){return{resultType:r.ResultTypeEnum.Success}},function(e){return{resultType:r.ResultTypeEnum.Failure}})};return e}(i.default);t.default=a});define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/album/AlbumProvider","../../../utilities/features/Features","../../../models/item/ItemHelper"],function(e,t,i,o,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._context=e;t._albumProvider=t.resources.consume(a.resourceKey);return t}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input;t.type=n.default.saveAutoAlbum;t.name=i.name;t.payloads.saveAutoAlbum={album:i};t.visibility=void 0!==this._context.operationVisibility?this._context.operationVisibility:0;return t};e.prototype.onStart=function(e){var t=this._context.album,i=new r.default(t.key,t);e.update([i]);return!s.isFeatureEnabled(s.EvokeDev)||l.isAutoAlbum(t)?this._albumProvider.saveAutoAlbum(this._context,e):this._albumProvider.convertToAutoAlbum(t,e)};return e}(o.default);t.default=d});define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./DiscardAutoAlbumOperator"],function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;return t}e.prototype.execute=function(e){var t=this,i={album:this._selectionHelper.firstItem.peek()};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(n.default))(i);t.trackPromise(e.start());return e.wait()}).then(function(){return{resultType:r.ResultTypeEnum.Success}},function(e){return{resultType:r.ResultTypeEnum.Failure}})};return e}(i.default);t.default=a});define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/fileSystem/FileSystemProvider","../../../dataSources/item/DeletionType","../../../providers/album/AlbumProvider","../../../dataSources/item/ItemTaskObserver"],function(e,t,i,o,s,r,n,l,a,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._context=e;t._fileSystemProvider=t.resources.consume(n.resourceKey);t._albumProvider=t.resources.consume(a.resourceKey);return t}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input;t.type=r.default.discardAutoAlbum;t.name=i.name;t.payloads.discardAutoAlbum={album:i};t.visibility=0;return t};e.prototype.onStart=function(e){var t=this,i=this._context.album,o=new s.default(i.key,i),r=this._albumProvider.getAlbumsParentKey({}),n=new(this.managed(d.default));e.update([o]);var a={items:[this._context.album],deletionType:l.default.Recycle,overrideLock:!1,parentKey:r,emptyRecycleBin:!1};this._updateAlbumDeletionStatus(n,i,1);return this._fileSystemProvider.deleteItems(a,e).then(function(e){t._updateAlbumDeletionStatus(n,i,2);n.dispose();return e})};e.prototype._updateAlbumDeletionStatus=function(e,t,i){var o=t.state&&t.state.delete||{};o.status=i;e.update([new s.default(t.key).succeed({item:{state:{delete:o}}})]);e.flush()};return e}(o.default);t.default=c});define("odsp-next/actions/moveCopy/odc/MoveCopyAction",["require","exports","tslib","../../../providers/moveCopy/MoveCopyProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../MoveCopyAction"],function(e,t,o,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._moveCopyProvider=t.resources.consume(r.resourceKey);return t}e.prototype.onExecute=function(e){var t,i=this._moveCopyProvider;t=this.isMove?i.moveItems(this.context()):i.copyItemsAsync(this.context());this.onComplete();return t.then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(i.default);t.default=a});define("odsp-next/actions/moveCopy/MoveCopyAction",["require","exports","tslib","../base/templates/SelectionAction"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="MoveCopy";t.context=e.context;t.onComplete=e.onComplete;t.isMove=e.isMove;t.isCrossSite=!!e.isCrossSite&&e.isCrossSite;return t}e.prototype.onIsAvailable=function(){return this.selectionHelper.selection().length&&this.context().isMove===this.isMove};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};return e}(i.default);t.default=r});define("odsp-next/actions/createNewFolder/odc/CreateNewFolderAction",["require","exports","tslib","../../base/ItemRedeemer","../../base/ItemCommandHelper","../CreateNewFolderAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,o,r,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._itemReedemer=new(t.managed(r.default));t._itemCommandHelper=new(t.managed(n.default));return t}e.prototype.onIsAvailable=function(){return this._itemCommandHelper.isCommandSupported(this.parentItem,a.createFolder)};e.prototype.onExecute=function(e){var t=this;return this._itemReedemer.redeemItem(this.parentItem,this).then(function(){return i.prototype.onExecute.call(t,e)})};return e}(i.default);t.default=s});define("odsp-next/actions/createNewFolder/CreateNewFolderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../createFolder/CreateFolderOperator"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.name="CreateNewFolder";t.parentItem=e.parentItem;t._newName=e.newFolderName;var i=e.options||{};t._options={dataUpdated:i.dataUpdated||t.observables.create(!1),showNewFolderInput:i.showNewFolderInput||t.observables.create(!0),hasError:i.hasError||t.observables.create(!1),status:i.status||t.observables.create(""),hasFocus:i.hasFocus||t.observables.create(!0),isEnabled:i.isEnabled||t.observables.create(!0),needsRefocus:i.needsRefocus||t.observables.create(!1)};return t}e.prototype.onExecute=function(e){var i=this;this._options.status(n.strings.Saving);this._options.hasError(!1);this._options.isEnabled(!1);return this.resources.consumeAsync(a.typeResourceKey).then(function(e){var t=new e({parent:i.parentItem,folderName:i._newName.peek()});return i.trackPromise(t.start())}).then(function(){i._options.dataUpdated(!0);i._options.showNewFolderInput(!1);i._options.isEnabled(!0);i._options.status("");return{resultType:r.ResultTypeEnum.Success}},function(e){i._options.hasError(!0);i._options.status(e.message);i._options.isEnabled(!0);i._options.hasFocus(!0);return{resultType:r.ResultTypeEnum.Failure}})};return e}(o.default);t.default=s});