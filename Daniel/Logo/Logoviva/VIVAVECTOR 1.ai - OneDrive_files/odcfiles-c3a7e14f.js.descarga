define("odsp-next/pages/files/odc/ConsumerFiles",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ConsumerFilesViewModel","./ConsumerFiles.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-consumer-files",template:e("./ConsumerFiles.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/pages/files/odc/ConsumerFilesViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../od/Files"],function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.filesTagName=r.default.tagName;t.filesParams={};return t}return e}(i.default);t.default=n});define("odsp-next/pages/files/od/Files",["require","exports","./FilesViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Files.html","./Files.css","../../../controls/list/CompactDetailsList","../../../controls/list/DetailsList","../../../controls/list/GridList","../../../controls/list/SingleAlbumList"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-files",template:e("./Files.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/pages/files/od/FilesViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","knockout","../../baseInnerPage/od/DataManagerPageViewModel","../../../resources/ProviderResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/PagesResourceKeys","../../../providers/dataManager/files/FilesDataManager","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../providers/item/ItemProvider","./DragAndDropHelper","./FilesCommandSet","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemType","../../../controls/itemContent/folder/FolderItemContent","../../../controls/itemContent/albumItemContentList/AlbumItemContentList.key","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","../../../dataSources/url/PageType","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","../../../utilities/features/Features","../../../utilities/educationAndUpsells/EducationAndUpsells","../../../models/upsell/Upsells","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../providers/engagement/Engagement","../../../providers/inAppMessaging/InAppMessagingProvider.key","../../../controls/clipboard/ClipboardHelper.key","../../../utilities/optimizely/experiments/UpdatedListView","../../../utilities/optimizely/experiments/NewGridView","../../../bindings/contextMenu/ContextMenuHelper","../../../bindings/component/ControlBinding","../../../bindings/react/ReactBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../models/inAppMessaging/MessagingTypeHelper","../../../controls/infoPane/InfoPane.key","../../../controls/listFooter/ListFooter","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/transclusion/content/TransclusionContent","../../../controls/unauthenticatedBanner/UnauthenticatedBanner","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../controls/list/viewModels/DetailsListViewModel"],function(r,e,t,n,d,i,c,u,o,a,p,m,h,s,f,g,b,v,y,x,_,I,S,T,w,C,k,F,M,R,D,A,P,L,B,V,O,E,H,U,N,K,z,q){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(l){t.__extends(e,l);function e(e){var t=l.call(this,e)||this;t.listFooterTagName=H.default.tagName;t.oneUpOverlayTagName=U.default.tagName;t.transclusionContentTagName=N.default.tagName;t.unauthenticatedBannerTagName=K.default.tagName;t.addBindingHandlers({react:B.default,control:L.default,interactionScope:V.default});t._identity=t.resources.consume(u.identity).getIdentity();t._navigation=t.resources.consume(p.navigation);t._userInfoProvider=t.resources.consume(c.userInfo);t._bundleLoader=t.resources.consume(c.bundleLoader);t._experimentHelper=t.resources.consume(S.experimentHelper);t._dragAndDropRobotProvider=t.resources.consume(c.dragAndDropRobot);t._storageOptionsProvider=t.resources.consume(c.storageOptions);t._isExistingUserPremiumUpsellEligible=t.observables.create(!1);t._isFirstRunExperienceVisible=t.resources.consume(I.isFirstRunExperienceVisible);t._educationAndUpsells=t.resources.consume(w.resourceKey);t._dialogDataStore=new z.default("SignInDialogCounter",q.default.local);t._engagement=t.resources.consume(F.resourceKey);t._iamProvider=t.resources.consumeAsync(M.resourceKey);t.isActive=t.observables.create(!1);t.showUnauthBanner=t.createObservable(!t._userInfoProvider.isAuthenticated());t.infoPaneSpecification=L.toSpecification(E.resourceKey,{});t._actionMap=t.resources.consume(I.actionMap);var i=new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:k.UploadProcessorType.Html5file});t._isUploadAvailable=i.isAvailable;var o=t._navigation.viewParams;t.isEmptyView=t.createPureComputed(t._computeIsEmptyView);t._robotRootOverride=o.robotMimicRoot;t.isGridBasedView=t.createPureComputed(t._computeIsGridBasedView);t._iosMobilePathDataSource=t.resources.isExposed(u.iosMobileAppPath)?t.resources.consume(u.iosMobileAppPath):null;var r=t.responsiveUI;t._isMobileAtStart=r.compareSize(r.formFactorSize.peek(),"Medium")<=0;if(t._dragAndDropRobotProvider&&!t._isMobileAtStart){t.isDragAndDropRobotApplicable=t.createPureComputed(t._computeIsRobotApplicable);t.dragAndDropGridHintComponent=t.createPureComputed(function(){return t._dragAndDropRobotProvider.getGridHintComponent(t.isGridBasedView,t.isDragAndDropRobotApplicable)});t.dragAndDropFooterHintComponent=t.createPureComputed(function(){return t.isEmptyView()?null:t._dragAndDropRobotProvider.getFooterHintComponent(t.isGridBasedView,t.isDragAndDropRobotApplicable)})}else{t.dragAndDropGridHintComponent=void 0;t.dragAndDropFooterHintComponent=void 0}t.dragAndDrop=new(t.managed(h.default))({});t._uploadTeachingBubbleProvider=t.resources.consume(c.uploadTeachingBubble);t.itemProvider=t.resources.consume(m.resourceKey);t._isGuidedTourVisible=t.createObservable(!1);t._guidedTourUploadTimerStartTime=0;if(t._userInfoProvider.isAuthenticated()){t.createComputed(t._computeUploadTeachingBubble);var n=t._dialogDataStore.getValue(K.LAST_SIGN_IN_DIALOG);n&&n+36e5<=Date.now()&&t._engagement.logData({name:"SignInDialog.SignedIn"})}t.upsellComponent=t.createObservable();t.upsell=d.observable(null);t.upsellParams={upsell:t.upsell,item:t.item};t.isUpsellApplicable=t.createObservable(!1);t.createBackgroundComputed(t._determineIfUpsellIsApplicable);t.createBackgroundComputed(t._initializeUpsellComponent);t._freOverride=o.showNewFre;t._guidedTourOverride=o.showGuidedTour;t._basicPositioningOverride=o.showPremiumPositioning;t._newFeaturesOverride=o.showNewFeaturesExperience;t._welcomeOverride=o.showWelcomeExperience;t.firstRunComponent=t.createObservable();t.createBackgroundComputed(t._initializeFirstRunComponent);t.guidedTourComponent=t.createObservable();t.createBackgroundComputed(t._initializeGuidedTourComponent);t.createBackgroundComputed(t._configureAreOverrideParamsAvailable);var a=t.createBackgroundComputed(t._configureIsFirstRunExperienceVisible),s=t.createBackgroundComputed(t._configureIsPremiumUpsellVisible);t.createBackgroundComputed(t._configureIsGuidedTourVisible);if(T.isFeatureEnabled(T.UseInAppMessagingAPI)){a.extend({rateLimit:{timeout:1500,method:"notifyWhenChangesStop"}});s.extend({rateLimit:{timeout:1500,method:"notifyWhenChangesStop"}});t.createBackgroundComputed(t._navigationFromRootCheck)}t.showSmartBanner=t.createObservable(!1);t.showMobileWebToAppUpsellV2=t.createObservable(!1);t.createBackgroundComputed(t._initializeMobileWebToAppUpsell);t._mobileWebToAppUpsellDismissed=t.resources.consume(I.mobileUpsellDismissedThisSession.optional);t.createBackgroundComputed(t._activateUpdatedListViewExperiment);t._setupCommandSets();t.hideLeftNav(!1);t._checkForNotifications();t.createBackgroundComputed(function(){!t.isLeftNavVisible()&&t.isLeftNavVisible()||t.async.setTimeout(function(){window.dispatchEvent(new Event("resize"))},300)});t.resources.consumeAsync(R.typeResourceKey).then(function(e){t.scope.attach(new e({isEnabled:t.isActive}))});return t}e.prototype.onDismissMobileWebToAppUpsellV2=function(){this.showMobileWebToAppUpsellV2(!1);this._mobileWebToAppUpsellDismissed(!0)};e.prototype.onMobileWebToAppUpsellGetAppClick=function(e){this.onDismissMobileWebToAppUpsellV2();this._navigation.navigateTo(e)};e.prototype.onMobileWebToAppUpsellOpenAppClick=function(e){var t=this;this.showMobileWebToAppUpsellV2(!1);var i=Date.now();if(this.platform.isIOS)this._navigation.navigateTo(e);else{this.async.setTimeout(function(){Date.now()-i<750&&t._navigation.navigateTo(e)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};e.prototype.dispose=function(){l.prototype.dispose.call(this);this.contextMenuHelper(null);this.commandSet(null)};e.prototype.computeCurrentPageName=function(){var e,t=this.item.peek(),i=this.urlDataSource.getKeyParams(t.key);switch(this.urlDataSource.getQueryType(i)){case y.default.RecycleBin:e="RecycleBin";break;case y.default.Recent:e="Recent";break;case y.default.SharedWithMe:e="Shared";break;case y.default.Search:e="Search";break;default:e="Folder"}return"Files-"+e};e.prototype.computeContentControl=function(){var e=l.prototype.computeContentControl.call(this);if(e)return e;var t=this.item(),i=this.layoutType(),o=this._getFooterHostContentControlParams();return t.type===g.default.Folder?i===x.SingleAlbum?L.toSpecification(v.resourceKey,o):L.toSpecification(b.resourceKey,o):void 0};e.prototype.computeCreateDataManager=function(){return this._createFilesDataManager};e.prototype._getFooterHostContentControlParams=function(){var e={footerItem:this.dragAndDropGridHintComponent};this._getFooterHostContentControlParams=function(){return e};return e};e.prototype._computeIsGridBasedView=function(){var e=this.layoutType();return e===x.Grid||e===x.SingleAlbum};e.prototype._computeIsEmptyView=function(){return 0===this.itemSet().content().items.length};e.prototype._computeIsRobotApplicable=function(){var e=this.itemSet(),t=e.item(),i=e.content().items;return!(t.key!==this.urlDataSource.getRootItemKey()&&!this._robotRootOverride||e.isPlaceholder||e.isExpired||!(i.length<=3)||!this._educationAndUpsells.getAreNoFilesAdded(e))};e.prototype._computeUploadTeachingBubble=function(){this._uploadTeachingBubbleProvider.checkIfTeachingBubbleIsApplicable(this.urlDataSource.getRootItemKey(),this.itemSet())};e.prototype._createFilesDataManager=function(){return new(this.managed(a.default))({requiredPageType:_.default.Files})};e.prototype._setupCommandSets=function(){var e=new(this.managed(s.default))({}),t=new(this.managed(s.default))({});this.resources.expose(o.listViewContextMenuHelper,new(this.managed(P.default))({items:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));var i=new(this.managed(P.default))({items:t.commands.peek(),rootElementClass:"od-BasePage-content",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0});this.contextMenuHelper(i);this.commandSet(e)};e.prototype._checkForNotifications=function(){var t=this;this.createBackgroundComputed(function(){if(t._bundleLoader.getBundleInfo(2).isLoaded()){var e=r("odsp-next/providers/notificationManager/NotificationManager").default;new(t.managed(e))({isPageLevel:!0}).createNotificationHandlers(function(e){return new(t.managed(e))})}});this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this.createBackgroundComputed(function(){var e=t.item();if(!e.isPlaceholder&&!t._hasConfiguredUpsell){t._hasConfiguredUpsell=!0;t._getUpsellToShow(e)}})};e.prototype._getUpsellToShow=function(e){var t=this;this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this._userInfoProvider.getUpsellToShow(e).then(function(e){e&&t.upsell(e)})};e.prototype._determineIfUpsellIsApplicable=function(){var e=this.item(),t=this.upsell();this._bundleLoader.getBundleInfo(5).isLoaded()&&e&&!this._isMobileAtStart&&this._identity.type===f.IdentityType.msa&&e.key===this.urlDataSource.getRootItemKey()&&t?this.isUpsellApplicable(t.id!==C.default.NewBrandFRE):this.isUpsellApplicable(!1)};e.prototype._configureIsGuidedTourVisible=function(){var t=this;this._guidedTourOverride?this._activateGuidedTourExperimentWithoutLightbox():this._isUploadAvailable()?this._userInfoProvider.getGuidedTourCompleted().then(function(e){e||t._userInfoProvider.getGuidedTourViewCount().then(function(e){0<e&&e<3&&t._activateGuidedTourExperimentWithoutLightbox()})}):this._isGuidedTourVisible(!1)};e.prototype._activateGuidedTourExperimentWithoutLightbox=function(){this._isMobileAtStart||this._isGuidedTourVisible(!0)};e.prototype._configureAreOverrideParamsAvailable=function(){var e=this._storageOptionsProvider.isReady();if(this._freOverride)this._isFirstRunExperienceVisible(!0);else if(e)if(this._basicPositioningOverride){this._premiumUpsellType=1;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._welcomeOverride){this._premiumUpsellType=3;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._newFeaturesOverride){this._premiumUpsellType=5;this._isExistingUserPremiumUpsellEligible(!0)}};e.prototype._configureIsPremiumUpsellVisible=function(){this.itemSet.peek().content();this._storageOptionsProvider.isReady();this._isMobileAtStart||this._activatePremiumUpsell(this.item(),this.itemSet(),!1)};e.prototype._activatePremiumUpsell=function(e,t,i){var o=this;this._educationAndUpsells.getExistingUserTypeOfPremiumUpsell(e,t,i).then(function(e){null==e||o._freOverride||5!==(o._premiumUpsellType=e)&&6!==e&&1!==e&&3!==e&&7!==e||o._isExistingUserPremiumUpsellEligible(!0)})};e.prototype._configureIsFirstRunExperienceVisible=function(){var t=this,e=this.item(),i=this.resources.consume(I.isFirstRunExperienceVisible),o=this.itemSet();o.content();this._isMobileAtStart||this._educationAndUpsells.getIsNewUser(e,o).then(function(e){if(e){t._guidedTourUploadTimerStartTime=Date.now();t.createBackgroundComputed(function(){var e=t._bundleLoader.getBundleInfo(5).isLoaded();t._bundleLoader.loadNow("odsp-next/providers/guidedTour/GuidedTourProvider",function(){return new n.default(function(e,t){r(["odsp-next/providers/guidedTour/GuidedTourProvider"],e,t)})}).then(function(){if(e){t.resources.consume(c.guidedTour).setUploadTimerStartTime(t._guidedTourUploadTimerStartTime)}})});i(!0);t._isGuidedTourVisible(!0)}})};e.prototype._initializeFirstRunComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this._isFirstRunExperienceVisible()?this._bundleLoader.loadNow("odsp-next/controls/firstRunExperience/FirstRunExperience",function(){return new n.default(function(e,t){r(["odsp-next/controls/firstRunExperience/FirstRunExperience"],e,t)})}).then(function(e){if(i){t.firstRunComponent({name:e.tagName,params:{}});T.isFeatureEnabled(T.UseInAppMessagingAPI)&&t._iamProvider.then(function(e){e.markMessagesRead(206,126)})}}):this._isExistingUserPremiumUpsellEligible()?this._bundleLoader.loadNow("odsp-next/controls/premiumIntro/PremiumIntro",function(){return new n.default(function(e,t){r(["odsp-next/controls/premiumIntro/PremiumIntro"],e,t)})}).then(function(e){if(i){t.firstRunComponent({name:e.tagName,params:{upsellType:t._premiumUpsellType}});T.isFeatureEnabled(T.UseInAppMessagingAPI)&&t._iamProvider.then(function(e){e.markMessagesReadIfPresent.apply(e,O.POSITIONING_MESSAGES.concat(O.UPSELL_MESSAGES))})}}):this.firstRunComponent(null)};e.prototype._initializeUpsellComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this.isUpsellApplicable()&&this.upsell()?this._bundleLoader.loadNow("odsp-next/controls/firstRunBanner/FirstRunBanner",function(){return new n.default(function(e,t){r(["odsp-next/controls/firstRunBanner/FirstRunBanner"],e,t)})}).then(function(e){i&&t.upsellComponent({name:e.tagName,params:t.upsellParams})}):this.upsellComponent(null)};e.prototype._initializeGuidedTourComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this._isGuidedTourVisible()?this._bundleLoader.loadNow("odsp-next/controls/guidedTour/GuidedTour",function(){return new n.default(function(e,t){r(["odsp-next/controls/guidedTour/GuidedTour"],e,t)})}).then(function(e){if(i){t.resources.consume(c.guidedTour).getDismissedThisSession()||t.guidedTourComponent({name:e.tagName,params:{onClose:t._onCloseGuidedTour.bind(t)}})}}):this.guidedTourComponent(null)};e.prototype._onCloseGuidedTour=function(){this.guidedTourComponent(null)};e.prototype._initializeMobileWebToAppUpsell=function(){this.isBannerApplicable&&(T.isFeatureEnabled(T.MobileWebToAppUpsellV2)?this._mobileWebToAppUpsellDismissed.peek()||this._initializeMobileWebToAppUpsellV2():this._initalizeSmartBanner())};e.prototype._initalizeSmartBanner=function(){var t=this,i=this._bundleLoader.getBundleInfo(1).isLoaded();this._bundleLoader.loadNow("odsp-next/controls/smartBannerV2/SmartBannerV2",function(){return new n.default(function(e,t){r(["odsp-next/controls/smartBannerV2/SmartBannerV2"],e,t)})}).then(function(e){if(i){t.smartBannerTagName=e.tagName;t.showSmartBanner(!0)}})};e.prototype._initializeMobileWebToAppUpsellV2=function(){if(this._bundleLoader.getBundleInfo(1).isLoaded()){this.mobileWebToAppUpsellV2={componentPath:"odsp-next/controls/mobileWebToAppUpsellV2/ReactMobileWebToAppUpsellV2",getModule:function(){return new n.default(function(e,t){r(["odsp-next/controls/mobileWebToAppUpsellV2/ReactMobileWebToAppUpsellV2"],e,t)})},props:{upsellPresentationType:0<this.responsiveUI.compareSize(this.responsiveUI.formFactorSize(),"Small")?"Dialog":"Banner",upsellType:"ODCWebToAppUpsell",upsellDeviceType:this.platform.isAndroid?"Android":"IOS",onClose:this.onDismissMobileWebToAppUpsellV2.bind(this),onGetAppClick:this.onMobileWebToAppUpsellGetAppClick.bind(this),onOpenAppClick:this.onMobileWebToAppUpsellOpenAppClick.bind(this),openApp:!0}};this.showMobileWebToAppUpsellV2(!0)}};e.prototype._activateUpdatedListViewExperiment=function(){var i=this,o=this.layoutType();this.trackPromise(this._bundleLoader.waitForPLT().then(function(){var e=window.optimizely,t=void 0===e?[]:e;if(o!==x.Details&&o!==x.CompactDetails||!T.isFeatureEnabled(T.EnableUpdatedFilesListView)){if(o===x.Grid&&T.isFeatureEnabled(T.UseTilesList)){t.push(["bucketVisitor",A.EXPERIMENT_ID,T.isFeatureEnabled(T.FlipOnNewGridAndListExperiment)?9183670501:9189200675]);i._experimentHelper.activateExperimentBehindFeature(T.UseTilesList,A.EXPERIMENT_ID).done()}}else{t.push(["bucketVisitor",D.EXPERIMENT_ID,T.isFeatureEnabled(T.FlipOnNewGridAndListExperiment)?9179970565:9186560432]);i._experimentHelper.activateExperimentBehindFeature(T.EnableUpdatedFilesListView,D.EXPERIMENT_ID).done()}}))};e.prototype._navigationFromRootCheck=function(){this.itemSet.peek().content();var o=this.item();this._iamProvider.then(function(e){var t=e.didUserNavigateAwayFromRoot(),i=e.didUserVisitRoot();t||o.isPlaceholder||(i?o.isRootFolder||e.markUserNavigatedAwayFromRoot():o.isRootFolder&&e.markUserVisitedRoot())})};return e}(i.default);e.default=l});define("odsp-next/pages/baseInnerPage/od/DataManagerPageViewModel",["require","exports","tslib","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../resources/DataSourceResourceKeys","../../files/od/ODCFiles.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/async/Promise","../../../controls/error/Error","../../../providers/operation/MoveCopyItemsAsyncOperation","../../../models/operation/OperationBatch","../../../models/promiseTracker/PromiseTracker","@ms/odsp-utilities/lib/async/Semaphore","@ms/odsp-utilities/lib/string/StringHelper","../../../models/item/VirtualItemType","../../../models/item/ItemType","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../providers/dataManager/FocusItemHelper","../../../controls/userState/lockedPage/LockedPage","../../../bindings/contextMenu/ContextMenuBinding","../../../models/selection/ItemSetSelectionModel","../../../providers/item/ItemProvider","../../../providers/moveCopy/MoveCopyProvider","../../../dataSources/item/IGetWorkProgressContext","../../../dataSources/item/ITaskProgress","../../../controls/oneUp/OneUp.key","./BaseInnerPageViewModel","@ms/odsp-datasources/lib/Permissions","../../../providers/dataManager/mapper/IdentityDataManagerMapper","../../../bindings/component/ControlBinding","../../../models/selection/Selection.key","../../../controls/list/react/SelectionManager"],function(e,t,i,d,c,u,o,p,m,r,h,n,f,a,s,g,b,v,y,x,_,I,S,T,w,C,k,F,l,M,R,D,A,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=function(l){i.__extends(t,l);function t(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=l.call(this,e,t)||this;i.addBindingHandlers({contextMenu:I.default,control:D.default});var o=i,r=o.resources,n=o.observables;i.loadingPromiseTracker=r.isExposed(d.promiseTracker)?r.consume(d.promiseTracker):r.expose(d.promiseTracker,new(i.managed(f.default)));i.itemProvider=r.consume(T.resourceKey);i._identityDataSource=r.consume(u.identity);i.urlDataSource=r.consume(u.url);i.viewParams=r.consume(d.viewParams);i.platform=r.consume(p.platformDetection);i._moveCopyHelper=new(i.managed(h.default))({moveCopyProvider:r.consume(w.resourceKey)});i.autoScrollEnabled=n.create(!1);i.autoScrollYPosition=n.create(0);i._createDataManager=i.createPureComputed(i._computeCreateDataManager);i._createDataManager.equalityComparer=y.objectStrictEquality;i.dataManager=i.createPureComputed(i._computeDataManager);i.dataManager.equalityComparer=y.objectStrictEquality;r.expose(c.sortManager,{updateSort:function(e,t){return i.dataManager.peek().updateSort(e,t)}});i.item=r.expose(d.currentItem,i.createPureComputed(i._computeItem));i.item.equalityComparer=y.objectStrictEquality;i.unmappedItemSet=i.createPureComputed(i._computeUnmappedItemSet);i.unmappedItemSet.equalityComparer=y.objectStrictEquality;i.dataManagerMapper=i.createObservable(new(i.managed(R.default))({itemSet:i.unmappedItemSet,requiredRange:i.createPureComputed(function(){return i.dataManager().requiredRange()})}));i.dataManagerMapper.equalityComparer=y.objectStrictEquality;i.createBackgroundComputed(i._computeUpdateDataManagerMapper);r.expose(d.currentDataManagerMapper,i.dataManagerMapper);i.itemSet=i.createPureComputed(i._computeItemSet);i.itemSet.equalityComparer=y.objectStrictEquality;r.expose(d.currentItemSet,i.itemSet);i.focusItem=i.createPureComputed(i._computeFocusItem);i.focusItem.equalityComparer=y.objectStrictEquality;i.error=r.expose(c.error,i.createPureComputed(i._computeError));i.error.equalityComparer=v.deepCompare;i._initializeRedirectAction();i._initializeAutoExecuteAction();i.isOneUp=i.createPureComputed(i.computeIsOneUp);i._initializeRange();i._initializeLayoutType();r.expose(c.files.layoutType,i.layoutType);i._indexResolver=r.expose(d.selectionIndexResolver,{isItemResolved:function(e){return i.dataManager.peek().isItemResolved(e)},resolveIndices:function(e){return i.dataManager.peek().resolveIndices(e)}});i._initializeItemSelectionModel(e);i.createBackgroundComputed(i._computeCollapseLeftNavOnViewChange);var a=r.consume(A.hasSelectionResourceKey);i.hasSelectionState=a;i.scope.attach(a.register(r.consume(P.hasSelectionResourceKey)));i.title=i.createPureComputed(i._computeTitle);i.isTitleVisible=i.createPureComputed(i._computeIsTitleVisible);i.createBackgroundComputed(i._computeSetDocumentTitle);var s=i._identityDataSource.getIdentity();s&&s.type!==M.IdentityType.anonymous&&i._checkForPendingOperations(C.IGetWorkProgressTypes.itemCopy);i._initializeFocusItemHelper();i.createBackgroundComputed(i._computeOneUpItemViewed).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}});i.isSmartBannerVisible=r.isExposed(c.base.isSmartBannerVisible)?r.consume(c.base.isSmartBannerVisible):r.expose(c.base.isSmartBannerVisible,n.create(!1));i._setUpSmartBanner();i._initializeOneUpParams();i.contentControl=i.createPureComputed(i._computeContentControl);i.hasContent=i.createPureComputed(function(){return!!i.contentControl()});return i}t.prototype.computeShouldSelectFocusItem=function(){return!this.isOneUp()&&-1<this.dataManager().focusItemIndexInItemSet()};t.prototype.computeCurrentPageName=function(){return"Default"};t.prototype.computeFocusPageName=function(){return"OneUp"};t.prototype.computeIsOneUp=function(){var e=this.focusItem(),t=(e||this.itemSet().item)(),i=!!this.error()||t.type===b.default.Error;return!(!this.urlDataSource.getFocusItemKey(this.viewParams())||!e||i||this.urlDataSource.getAutoActionType(this.viewParams()))};t.prototype.computeContentControl=function(){var e=this.error(),t=this.item();return t&&t.error&&4===t.error.type?D.toSpecification(_.resourceKey,this.getContentControlParams()):e?D.toSpecification(r.resourceKey,this._getErrorParams()()):void 0};t.prototype.getSelectionOptions=function(e){void 0===e&&(e={});return{}};t.prototype.computeReportPageView=function(){if(this.isOneUp()){var e=this.focusItem();e&&(e.peek().isPlaceholder?e():this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),item:e.peek(),name:this.computeCurrentPageName()+"-"+this.computeFocusPageName()}))}else{var t=this.itemSet(),i=t.item;i.peek().isPlaceholder?i():t.isPlaceholder?t.content():this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),item:i.peek(),name:this.computeCurrentPageName()})}};t.prototype.computeDataManagerMapper=function(){return new(this.managed(R.default))({itemSet:this.unmappedItemSet,requiredRange:this.dataManager().requiredRange})};t.prototype.getContentControlParams=function(){var e={};this.getContentControlParams=function(){return e};return e};t.prototype._getErrorParams=function(){var e=this,t=this.observables.pureCompute(function(){return{error:e.error()}});this._getErrorParams=function(){return t};return t};t.prototype._computeUpdateDataManagerMapper=function(){this.dataManagerMapper(this.computeDataManagerMapper())};t.prototype._initializeFocusItemHelper=function(){var e=this;return new(this.managed(x.default))({focusItem:this.focusItem,canSelect:function(){return e.computeShouldSelectFocusItem()}})};t.prototype._setUpSmartBanner=function(){this.isBannerApplicable=this.platform.isIOS||this.platform.isAndroid||this.platform.isWinPhone};t.prototype._computeContentControl=function(){var e=!this.item().isPlaceholder&&this._redirectAction.isAvailable();if(!this.dataManager().isActive()||e){return this.contentControl.peek()}return this.computeContentControl()};t.prototype._computeCreateDataManager=function(){var e=this.computeCreateDataManager();return e||this._createDataManager.peek()};t.prototype._computeDataManager=function(){var e=this._createDataManager(),t=this.dataManager.peek();t&&t.dispose();return e.call(this)};t.prototype._checkForPendingOperations=function(e){var c=this;return this.itemProvider.getWorkProgress({type:e}).then(function(e){if(e.progress){var d=new n.default;e.progress.map(function(a){if(a.status===k.ITaskStatuses[k.ITaskStatuses.InProgress]||a.status===k.ITaskStatuses[k.ITaskStatuses.NotStarted]){var s=c._extractCidFromResId(a.sourceResourceId),l=c._extractCidFromResId(a.targetResourceId);t._getWorkProgressQueue.enqueue(function(){var e,t,i={parentKey:c.urlDataSource.getKey((e={},e.id=a.sourceResourceId,e.cid=s,e))},o=c.itemProvider.getItem(i),r={parentKey:c.urlDataSource.getKey((t={},t.id=a.targetResourceId,t.cid=l,t))},n=c.itemProvider.getItem(r);return m.default.all([o,n]).then(function(e){if(e&&!(e&&e.length<2)){var t=e[0].item.peek(),i=e[1].item.peek();if(t&&i){var o={items:[t],parentKey:i.parent.key,targetId:i.id,targetKey:i.key,cid:l,group:t.isGroup?1:0,isMove:!1},r=c._moveCopyHelper.registerOperation(t,o,i,a.id,d);return c._moveCopyHelper.handleMoveCopyAsyncItems(o,[r],a.id)}}})})}})}},function(e){})};t.prototype._extractCidFromResId=function(e){return e.split("!")[0]};t.prototype._computeTitle=function(){var e=this.itemSet().item();return e.displayName||e.name||""};t.prototype._computeIsTitleVisible=function(){var e=this.itemSet().item(),t=!1;switch(e.virtualItemType){case g.default.AlbumRoot:case g.default.Tag:case g.default.Album:t=!0}return(!!e.displayName||!!e.name)&&(!e.parent||t)};t.prototype._computeSetDocumentTitle=function(){var e=this.focusItem()&&this.focusItem()()||this.itemSet().item(),t=e.displayName||e.name||"";document.title=t?s.format(o.strings.pageTitleFormat,t):o.strings.pageTitleDefault};t.prototype._computeItemSet=function(){return this.dataManagerMapper().mappedItemSet()};t.prototype._computeUnmappedItemSet=function(){return this.dataManager().itemSet()};t.prototype._computeItem=function(){return this.dataManager().item()};t.prototype._computeFocusItem=function(){return this.dataManager().focusItem()};t.prototype._computeError=function(){return this.dataManager().error()};t.prototype._computeOneUpItemViewed=function(){if(this.isOneUp()&&this.focusItem()&&!this.focusItem()().isPlaceholder){var e=this.focusItem.peek().peek();if(e.type!==b.default.Media)return;this.itemProvider.updateViewCount({items:[e]})}};t.prototype._initializeRange=function(){var t=this,e=this.observables;this.listRange=e.create({start:0,end:0});this.listRange.equalityComparer=v.deepCompare;this.resources.expose(c.contentRange,this.listRange);this.focusRange=e.create({start:0,end:0});this.focusRange.equalityComparer=v.deepCompare;this.createBackgroundComputed(function(){var e;if(t.item().isPlaceholder)e={start:0,end:0};else if(t.isOneUp()){e=t.focusRange();t.focusItem.peek()||(e=t.dataManagerMapper.peek().mappedRequiredRange.peek())}else e=t.listRange();t.dataManagerMapper().mappedRequiredRange(e)})};t.prototype._initializeLayoutType=function(){var t=this;this.layoutType=this.createComputed({read:function(){return t.dataManager().layoutType()},write:function(e){return t.dataManager.peek().layoutType(e)},pure:!0})};t.prototype._computeCollapseLeftNavOnViewChange=function(){this.dataManager().queryType();this.isLeftNavUserExpanded(!1)};t.prototype._initializeItemSelectionModel=function(e){var t=this;void 0===e&&(e={});var i=this.getSelectionOptions(e),o=this.createObservable();this.createBackgroundComputed(function(){o(t.itemSet())});this.itemSelectionModel=this.resources.expose(d.itemsSelection,new(this.managed(S.default))({itemSet:o,mode:i.mode,maximumSelectedCount:i.maximumSelectedCount,canSelectItem:i.canSelectItem,indexResolver:this._indexResolver}))};t.prototype._initializeAutoExecuteAction=function(){this._autoExecuteAction=new(this.managed(this.actionMap.AutoExecuteAction))({focusItem:this.focusItem});this.createBackgroundComputed(this._computeAutoExecuteAction).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};t.prototype._initializeRedirectAction=function(){var e=this;this._redirectAction=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.createPureComputed(function(){return(e.focusItem()||e.itemSet().item)()}),itemSet:this.itemSet,preserveAction:!0,focusUrl:this.createPureComputed(function(){return!!e.urlDataSource.getAutoActionType(e.viewParams())||!!e.focusItem()}),ignoreHistory:!0,openLocal:!0});this.createBackgroundComputed(this._computeAttemptRedirectForItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};t.prototype._computeAutoExecuteAction=function(){var e=this.itemSet().item;if(e.peek().isPlaceholder||this._redirectAction.isAvailable())e();else{if(!this.focusItem()||-1<this.dataManager().focusItemIndexInItemSet()){var t=this._autoExecuteAction;t.isAvailable.peek()?t.execute(null).done(function(){},function(){}):t.isAvailable()}}};t.prototype._computeAttemptRedirectForItem=function(){var e=this.focusItem()||this.itemSet().item;if(e.peek().isPlaceholder||this.itemSet().item.peek().isPlaceholder){e();e!==this.itemSet().item&&this.itemSet().item()}else{var t=this._redirectAction;if(t.isAvailable.peek()){this.viewParams();this.async.setTimeout(function(){t.isAvailable.peek()&&t.execute(null).done(function(){},function(){})},0)}}};t.prototype._initializeOneUpParams=function(){var t,i=this;t=this.createPureComputed(function(){var e=i.focusItem();return!e&&t?t.peek():e});this.resources.expose(d.focusItem,t);this.isOneUpSlideshow=this.createObservable(!1);this.oneUpSpecification=D.toSpecification(F.resourceKey,{requiredRange:this.focusRange,isSlideshow:this.isOneUpSlideshow})};t.MAX_CONCURRENT_GET_WORK_PROGRESS=4;t._getWorkProgressQueue=new a.default(t.MAX_CONCURRENT_GET_WORK_PROGRESS);return t}(l.default);t.default=L});define("odsp-next/controls/error/Error",["require","exports","./ErrorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","./Error.html","./Error.css"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"ms-error",template:e("./Error.html"),viewModel:i.default,synchronous:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-error",template:e("./Error.html"),viewModelType:i.default});t.default=n});define("odsp-next/controls/error/ErrorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../dataSources/item/ItemDataSource.resx","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../providers/error/ErrorProvider"],function(a,e,t,i,o,s,l,d,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=o.strings,r=function(n){t.__extends(e,n);function e(e,t){void 0===t&&(t={});var i=n.call(this,e,t)||this,o=e.error;i._navigation=i.resources.consume(d.navigation);i.errorTitle=o&&o.errorTitle||u.DefaultTitle;i.errorDetailedText=o&&o.errorDetailedText;i.errorHtml=o&&o.errorDetailedHtml;i.errorDetailedText||i.errorHtml||(i.errorDetailedText=u.DefaultSubText);var r=i.resources.consume(c.resourceKey).getAction(o);i.actionText=r.text;i.actionUrl=r.url;i.showAction=!r.hideButton&&!e.hideAction;i.showErrorCode=o&&o.errorCode&&i.errorTitle===u.DefaultTitle;if(i.showErrorCode){s.default.log(o,"ServerError",o.errorCode);i.errorCodeText=l.format(u.errorCodeText,o.errorCode)}else i.errorCodeText="";o&&o.correlationId?i.correlationIdText=l.format(u.errorCorrelationIdText,o.correlationId):i.correlationIdText="";if(o&&"accessremoved"===o.errorCode){i.isAccessRemoved=!0;i.imageUrl="undefined"==typeof __webpack_public_path__?a.toUrl("odsp-media/images/error/error2.svg"):a("@ms/odsp-media/dist/media/images/error/error2.svg")}else{i.isAccessRemoved=!1;i.imageUrl=i._getRandomImage()}return i}e.prototype.onButtonClick=function(){if(this.showAction){this._navigation.navigateTo(this.actionUrl)}return!1};e.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return"undefined"==typeof __webpack_public_path__?a.toUrl("odsp-media/images/error/error"+e+".svg"):a("@ms/odsp-media/dist/media/images/error/error"+e+".svg")};return e}(i.default);e.default=r});define("odsp-next/providers/error/ErrorProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../dataSources/item/ItemDataSource.resx","../../resources/DataSourceResourceKeys"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._errorDataSource=t.errorDataSource;this._defaultErrorAction={text:o.strings.DefaultActionText,url:t.urlDataSource.getRootUrl()}}e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction};return e}();t.default=n;t.resourceKey=i.createResolvedResourceKey(e("module").id,n,{errorDataSource:r.error.optional,urlDataSource:r.url})});define("odsp-next/controls/error/Error.html",[],function(){return'<div class=od-Error><div class=od-Error-image><img data-bind="attr:{src: imageUrl, alt: errorTitle}" class=od-Error-imageTag></div><div class=od-Error-title data-bind="text: errorTitle"></div>\x3c!--ko if: errorDetailedText--\x3e<div class=od-Error-subText data-bind="text: errorDetailedText, css: { \'od-Error-subtext--accessremoved\': isAccessRemoved }"></div>\x3c!--/ko--\x3e\x3c!--ko if: errorHtml--\x3e<div class=od-Error-subText data-bind="html: errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if: showAction--\x3e<form class=od-Error-button data-bind="attr:{action: actionUrl}" method=get><button class=od-Button data-bind="click: onButtonClick" type=submit><span class=od-Button-label data-bind="text: actionText"></span></button></form>\x3c!--/ko--\x3e<div class=od-Error-code data-bind="visible: correlationIdText, text: correlationIdText"></div><div class=od-Error-code data-bind="visible: showErrorCode, text: errorCodeText"></div></div>'});define("odsp-next/controls/error/Error.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:168px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}])});define("odsp-next/providers/dataManager/FocusItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.canSelect,o=e.focusItem;t._canSelect=i;t._focusItem=o;t._itemSelectionModel=t.resources.consume(n.itemsSelection);t._initializeSetFocusItemSelection();return t}e.prototype._initializeSetFocusItemSelection=function(){var i,o,r=this,n=this._itemSelectionModel;this.createBackgroundComputed(function(){var e=r._focusItem();if(e){if(r._canSelect()){n.setItemFocus(e);var t=r.observables.ignore(function(){return n.getItemKey(e)});n.setSelectedKeys([t]);i=!0}o||(i=0<n.selectedCount.peek())}else if(o){n.setItemFocus(o);if(!0===i){t=r.observables.ignore(function(){return n.getItemKey(o)});n.setSelectedKeys([t]);i=void 0}else n.clear()}o=e}).extend({deferred:!0})};return e}(o.default);t.default=r});define("odsp-next/controls/userState/lockedPage/LockedPage",["require","exports","./LockedPageViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../bindings/component/ControlBinding","./LockedPage.html"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-locked-page",template:e("./LockedPage.html"),viewModel:i.default,synchronous:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-locked-page",template:e("./LockedPage.html"),viewModelType:i.default});t.default=n});define("odsp-next/controls/userState/lockedPage/LockedPageViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/modules/Modules","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys"],function(i,e,t,o,n,r,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(r){t.__extends(e,r);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=r.call(this,e,t)||this;i._bundleLoader=i.resources.consume(l.bundleLoader);var o=i.resources.consume(s.promiseTracker);i._loaded=new n.default;o.registerPromise(i._loaded.getPromise());i.createComputed(i._compute);return i}e.prototype._compute=function(){var t=this;this._bundleLoader.getBundleInfo(3).isLoaded()&&a.loadModule({path:"../LockedHandler",getModule:function(){return new o.default(function(e,t){i(["../LockedHandler"],e,t)})}}).then(function(e){new(t.managed(e));t._loaded.complete()})};return e}(r.default);e.default=d});define("odsp-next/controls/userState/lockedPage/LockedPage.html",[],function(){return"<div class=od-LockedPage></div>"});define("odsp-next/models/selection/ItemSetSelectionModel",["require","exports","tslib","./BaseSelectionModel","../../providers/item/ItemProvider","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","knockout","./SelectionResolver","../item/ItemParentHelper","../item/RefreshMessageHelper"],function(e,t,i,o,d,a,c,s,r,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(l){i.__extends(e,l);function e(e){void 0===e&&(e={});var t=this,i={getItemKey:f};u.utils.extend(i,e||{});t=l.call(this,i)||this;var o=e.itemSet,r=void 0===o?t.resources.consume(c.currentItemSet):o,n=e.indexResolver,a=e.enableSelectionResolution,s=void 0===a||a;t.itemSet=r;t.itemProvider=t.resources.consume(d.resourceKey);t._enableSelectionResolution=s;t._itemParentHelper=t.resources.consume(m.resourceKey);t._refreshMessageHelper=t.resources.consume(h.resourceKey);t._currentItems=t.createPureComputed(t.computeCurrentItems);t._itemKey=t.createPureComputed(t._computeItemKey);t.createComputed(function(){t._onItemSetChanged(t._currentItems())});t.createComputed(t._computeResetSelectionOnKeyChange);n&&(t._selectionResolver=new(t.managed(p.default))({itemSet:t.itemSet,indexResolver:n}));return t}e.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return a.default.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var i=[],o=this.getItems(),r=0;r<o.length;r++)(this.isIndexSelected(r)||!o[r]&&this.isAllSelected.peek())&&i.push(r);return this._selectionResolver.resolveSelection(i).then(function(){return e._unwrapSelection(e.selection.peek())})}var n={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new s.default,getItemPromises:[]};this.validateResolvedSelection(n);return n.signal.getPromise()}return a.default.wrap(this._unwrapSelection(this.selection.peek(),!0))};e.prototype.validateResolvedSelection=function(e){e.resolveAttempt++;if(4<e.resolveAttempt)e.signal.error({resultType:r.ResultTypeEnum.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();e.getItemPromises=[];e.missingRanges=t;e.pendingCount=t.length;if(0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var i=0;i<5;i++)this.resolveNextRange(e)}};e.prototype.resolveNextRange=function(t){var i=this;if(0<t.missingRanges.length){var e=t.missingRanges.pop(),o=u.utils.extend({},t.itemSet.context);o.avoidSeamSnapping=!0;o.startIndex=e.start;o.endIndex=e.end;o.pageSize=e.end-e.start+1;t.getItemPromises.push(this.itemProvider.getItem(o).then(function(){t.pendingCount--;t.pendingCount?i.resolveNextRange(t):i.validateResolvedSelection(t)},function(e){i.cancelResolve(t,e)}))}};e.prototype.cancelResolve=function(e,t){for(var i=0;i<e.getItemPromises.length;i++)e.getItemPromises[i].cancel();t?e.signal.error(t):e.signal.cancel()};e.prototype.getMissingRanges=function(){var e=[],t=-1,i=-1,o=this.getMissingIndicies();if(o.length){t=o[0];i=o[o.length-1];for(;-1<t;){var r=Math.min(i,t+1e3-1),n={start:t,end:r};e.push(n);t=r===i?-1:r+1}}return e};e.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]};e.prototype._onItemSetChanged=function(e){var t=this,i=this.itemSet.peek(),o=i&&i.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(i.item.peek(),"list"));o&&o.list?this.getItemKey=function(e,t){var i=t&&t.peek&&t.peek();return i&&i.properties&&(e?i.properties.uniqueId:i.properties.ID)||i&&i.key||null}.bind(void 0,o.list.isDocumentLibrary):this.getItemKey=f;var r=i&&i.item&&i.item.peek()&&i.item.peek().key,n=!!r&&this._refreshMessageHelper.hasItemRefreshedRecently(r);this.onAddItem=n?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0;this.setItems(e,!1);this._refreshMessageHelper.clearRecentlyRefreshedItems()};e.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey();this.clear(!0)};e.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var i=[],o=0,r=e;o<r.length;o++){var n=r[o],a=this.peekUnwrapObservable(n);!a&&t||i.push(a)}return i};e.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key};return e}(o.default);function f(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.default=n});define("odsp-next/models/selection/BaseSelectionModel",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(o,i);function o(e){var t=i.call(this,e)||this;t._focusIsUserInput=!1;t.mode=e.mode||0;t.maximumSelectedCount=e.maximumSelectedCount;t.getItemKey=e.getItemKey;t._canSelectItem=e.canSelectItem||a;t._selectionModelGroup=e.selectionModelGroup;t._allSelectables={};t._items=[];t.selectedCount=t.createObservable();t.selection=t.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});t.isAllSelected=t.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});t.focusedItem=t.createObservable();t.focusedItem.equalityComparer=n.objectStrictEquality;t.isActive=t.createObservable(!0);t.clear(!0);t._clearFocusIsUserInput=t.async.throttle(t._clearFocusIsUserInput,0,{trailing:!0});t._selectionModelId=""+ ++o._nextSelectionModelId;t._selectionModelGroup&&t._selectionModelGroup.registerSelectionModel(t,t._selectionModelId);return t}o.prototype.dispose=function(){i.prototype.dispose.call(this);this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId);this._allSelectables=null};o.prototype.clear=function(e){this.isSelectedDefaultState=!1;this._keysExempt={};this._exemptCount=0;if(e){this._focusIndex=-1;this._anchorIndex=-1;this._anchorKey=null;this._focusIsUserInput=!1;this.focusedItem(null)}this.selection.removeAll();this.isAllSelected(!1);this._updateAllSelectables();this._updateSelectedCount()};o.prototype.setItems=function(e,t){this._items=e;this._selectableItems=this._items;t&&this.clear(!0);this._onItemsChanged(!0)};o.prototype.setAllFocusableItems=function(e){this._items=e;this._focusIndex=-1;this._onItemsChanged(!1)};o.prototype.getItems=function(){return this._items};o.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)};o.prototype.isItemSelected=function(e){var t=this.getItemKey(e),i=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!i||!this.isSelectedDefaultState&&i)};o.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var i=0,o=e;i<o.length;i++){var r=o[i],n=this._keyToIndex[r];if(0<=n){var a=this._items[n];if(this.canSelectItem(a)){this._keysExempt[r]=a;t.push(a)}}}this._exemptCount=t.length;this.isSelectedDefaultState=!1;this.selection(t);this._updateIsAllSelected();this._updateSelectedCount();this._updateAllSelectables();this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)};o.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(0<this.selectedCount.peek()&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)};o.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null};o.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)};o.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)};o.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)};o.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))};o.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])};o.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var i=t.preventAnchor,o=void 0!==i&&i,r=t.isFocusInput,n=void 0===r||r,a=this.focusedItem.peek(),s=this.getItemKey(e),l=this._keyToIndex[s];this._focusIsUserInput=n;if(e!==a){var d=this.getItemKey(a);this._updateSelectable(d,{focusState:0,isFocused:!1})}if(0<=l){d=this.getItemKey(e);this._focusIndex=l;this.focusedItem(e||null);d&&this._updateSelectable(d,{focusState:n?2:1,isFocused:!0})}else this.focusedItem(null);if(!o){this._anchorIndex=l||-1;this._anchorKey=s}this._clearFocusIsUserInput()};o.prototype.setIndexFocus=function(e,t){void 0===t&&(t={});this.setItemFocus(this._items[e],t)};o.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),i=this.getItemKey(t),o=this._allSelectables[i];if(o&&o.length)for(var r=0;r<o.length;r++){var n=o[r];if(n.onInvoke)return n.onInvoke(e)}return!0};o.prototype.setIsActive=function(e){this.isActive(e)};o.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,i=this.getItemKey(e);if(i){var o=this._keyToIndex[i],r=Math.min(t.length-1,Math.max(0,this._anchorIndex)),n=Math.max(o,r);if(t.length&&0<=n){for(var a=Math.min(o,r);a<=n;a++)this._setItemSelectedCore(t[a],!0,!1);this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}}}};o.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])};o.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,i=this._selectableItems;t<i.length;t++){var o=i[t];this._canSelectItem(o)&&e.push(o)}this.selection(e);this._keysExempt={};this._exemptCount=0;this._updateIsAllSelected();this._updateAllSelectables();this._updateSelectedCount();this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};o.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&0<this.selectedCount.peek()?this.clear():this.selectAll()};o.prototype.registerSelectable=function(e,i){var o,r=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");o="string"==typeof e?e:this.getItemKey(e);this._allSelectables[o]||(this._allSelectables[o]=[]);this._allSelectables[o].push(i);var t=this._items[this._keyToIndex[o]],n=this.focusedItem.peek()===t,a=n?this._focusIsUserInput?2:1:0,s=this.isItemSelected(t);this._updateSelectable(o,{focusState:a,isFocused:n,isSelected:s});return{dispose:function(){if(r._allSelectables&&r._allSelectables[o]){var e=r._allSelectables[o];if(1===e.length)delete r._allSelectables[o];else{var t=e.indexOf(i);0<=t&&e.splice(t,1)}}}}};o.prototype.getFocusIndex=function(){return this._focusIndex};o.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,i=0;t&&i<t.length;i++){var o=t[i];this.isItemSelected(o)&&!this.getItemKey(o)&&e.push(i)}return e};o.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup};o.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)};o.prototype.getItemByIndex=function(e){return 0<=e?this._items[e]:null};o.prototype._setItemSelectedCore=function(e,t,i){var o=this,r=this.getItemKey(e);if(r&&r in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return o.canSelectItem(e)}))return;1===this.mode&&t&&this.clear();this._keysExempt[r]?delete this._keysExempt[r]:this._keysExempt[r]=e;t?this.selection.push(e):this.selection.remove(e);this._updateSelectable(r,{isSelected:this.isItemSelected(e)});this._exemptCount+=t?1:-1;this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&i&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};o.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:0<e;this.isAllSelected(t)};o.prototype._updateSelectable=function(e,t){var i=this._allSelectables[e];if(i)for(var o=0,r=i;o<r.length;o++){var n=r[o];for(var a in t){var s=t[a],l=n[a];this.isObservable(l)&&l(s)}}};o.prototype._updateAllSelectables=function(){var i=this;this.observables.ignore(function(){for(var e in i._allSelectables){var t=i._items[i._keyToIndex[e]];t&&i._canSelectItem(t)&&i._updateSelectable(e,{isSelected:i.isItemSelected(t)})}})};o.prototype._onItemsChanged=function(o){var r=this;this._keyToIndex={};o&&(this._selectableItemsMap={});var n=this._items,a=[],s=this.getItemKey(this.focusedItem.peek()),l=this._anchorKey;if(n){for(var d=0,e=function(e){var t=n[e],i=c.observables.ignore(function(){return r.getItemKey(t)});if(i){c._keyToIndex[i]=e;o&&(c._selectableItemsMap[i]=!0);s&&s===i&&(c._focusIndex=e);l&&l===i&&(c._anchorIndex=e)}if(c.isItemSelected(t)){if(c.onAddItem&&!1===c.onAddItem(t)){d++;c._keysExempt[i]=t;return"continue"}a.push(t)}},c=this,t=0;t<n.length;t++)e(t);this._exemptCount+=d;this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1;this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1});this.selection(a);this._updateIsAllSelected();this._updateSelectedCount()}};o.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)};o.prototype._clearFocusIsUserInput=function(){this._focusIsUserInput=!1};o._nextSelectionModelId=1;return o}(i.default);t.default=o;function a(e){return!0}});define("odsp-next/models/selection/SelectionResolver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys"],function(e,t,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.itemSet,o=void 0===i?t.resources.consume(a.currentItemSet):i,r=e.indexResolver;t._itemSet=o;t._indexResolver=r;return t}e.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):r.default.wrap()};e.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)};e.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)};e.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,i=[],o=0,r=e;o<r.length;o++){var n=r[o],a=t[n];this._isItemResolved(a)||i.push(n)}return i};return e}(o.default);t.default=n});define("odsp-next/models/item/RefreshMessageHelper",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemRefreshMessages={};this._itemKeysRefreshed=[]}e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null};e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,i=e;t<i.length;t++){var o=i[t];this._itemRefreshMessages[o.id]=o}};e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}};e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)};e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)};e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]};e.dependencies={};return e}();t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});define("odsp-next/controls/oneUp/OneUp.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./OneUp",getModule:function(){return new t.default(function(e,t){i(["./OneUp"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/pages/baseInnerPage/od/BaseInnerPageViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../utilities/browser/ResponsiveUI","../../../dataSources/url/PageType","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../models/selection/Selection.key","../../../utilities/browser/WebViewDetector"],function(e,t,i,n,o,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i.actionMap=i.resources.consume(a.actionMap);i.commandSet=i._exposeIfNeeded(s.base.commandBar.commandSet,n.observable(null));i.isTopBarHamburgerVisible=i._exposeIfNeeded(s.base.suiteNav.isTopBarHamburgerVisible,n.observable(!1));i.isTopBarVisible=i._exposeIfNeeded(s.base.suiteNav.isTopBarVisible,n.observable(!0));i.isTopBarVisible(!0);i.isLeftNavUserExpanded=i._exposeIfNeeded(s.base.leftNav.isLeftNavUserExpanded,n.observable(!1));i.isSuiteNavHamburgerVisible=i._exposeIfNeeded(s.base.suiteNav.isSuiteNavHamburgerVisible,n.observable(!1));i.supportHamburgerInSuiteNav=i._exposeIfNeeded(s.base.suiteNav.supportHamburgerInSuiteNav,!1);i.toggleIsLeftNavUserExpanded=i._exposeIfNeeded(s.base.leftNav.toggleIsLeftNavUserExpanded,function(){return null});i.hideLeftNav=i._exposeIfNeeded(s.base.leftNav.hideLeftNav,n.observable(!1));i.hideLeftNav(!1);i.isLeftNavPresent=i._exposeIfNeeded(s.base.leftNav.isLeftNavPresent,n.observable(!0));i.isLeftNavVisible=i._exposeIfNeeded(s.base.leftNav.isLeftNavVisible,n.observable(!1));i.infoPane=i._exposeIfNeeded(s.base.infoPane.infoPane,null);i.hasSelectionState=i.resources.consume(p.hasSelectionResourceKey);i.pageType=i.resources.consume(a.currentPage);i.isInfoPaneExpanded=i._exposeIfNeeded(s.base.infoPane.isInfoPaneExpanded,n.observable(!1));i.isRetrievingData=i._exposeIfNeeded(s.base.isRetrievingData,n.observable(!1));i.responsiveUI=i.resources.consume(l.resourceKey);i.platform=i.resources.consume(u.platformDetection);i.isCommandBarDarkTheme=i._exposeIfNeeded(s.base.commandBar.isDarkTheme,n.observable(!1));i.isSuiteNavHidden=i._exposeIfNeeded(s.base.suiteNav.isSuiteNavHidden,n.observable(!0));var o=i.resources.consume(m.resourceKey);i.isSuiteNavHidden(o.isWebViewHosted()||o.isOneDriveWinApp());i.isLeftNavPresent(!o.isOneDriveWinApp());i.contextMenuHelper=i._exposeIfNeeded(s.base.contextMenuHelper,n.observable(null));i.viewParams=i.resources.consume(a.viewParams);i.isSearchHidden=i._exposeIfNeeded(s.base.commandBar.isSearchHidden,n.observable(!1));i.isSearchHidden(o.isOneDriveWinApp());i.instrumentationProvider=i.resources.consume(c.instrumentation);i.createBackgroundComputed(i.computeReportPageView).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});i.infoPaneTransclusionContentParams={provider:i.infoPane};return i}e.prototype.computeReportPageView=function(){this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),name:this.computeCurrentPageName()})};e.prototype.computeCurrentPageName=function(){return d.default[this.pageType.peek()]};e.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};return e}(o.default);t.default=r});define("odsp-next/providers/dataManager/mapper/IdentityDataManagerMapper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.itemSet=e.itemSet;t.mappedItemSet=e.itemSet;t.mappedRequiredRange=e.requiredRange;t.refreshedItemSetFlag=t.createObservable(!1);return t}e.prototype.getOriginalItemIndexByMappedIndex=function(e){return e};e.prototype.getNewMappedIndexByOldIndex=function(e){return e};return e}(i.default);t.IdentityDataManagerMapper=r;t.default=r});define("odsp-next/providers/dataManager/files/FilesDataManager",["require","exports","tslib","../DataManager","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","@ms/odsp-utilities/lib/async/Semaphore","../../../utilities/range/RangeHelper","./FilesDataManagerContextHelper","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,o,i,l,r,n,d,c,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._contextHelper=new(t.resources.injected(a.default));t._groupingType=t.createPureComputed(t._computeGroupingType,{deferEvaluation:!0});return t}e.prototype.resolveIndices=function(e){for(var t=this,i=new d.default(4),o=[],r=function(e){return function(){return t._resolveRange(e)}},n=0,a=c.createRanges(c.groupIndices(e,1e3));n<a.length;n++){var s=a[n];o.push(i.enqueue(r(s)))}return l.default.all(o).then(function(){})};e.prototype.amendCurrentContext=function(e){var t=this.itemSet.peek();t.schema.peek()&&t.schema.peek().length||(e.needSchema=!0)};e.prototype.getCurrentItemSetSync=function(e){return this.itemProvider.getItemSync(e)};e.prototype.getFocusItemSet=function(e){return this.getCurrentItemSet(e)};e.prototype.getCurrentItemSet=function(e){s.default.mark("DataManager.GetData.Started");return this.itemProvider.getItem(e)};e.prototype.computeCurrentContext=function(){var e,t=this.focusItemKey();t&&this.focusItemIndexInItemSet()<0&&(e=t);var i=this.requiredRange();return this._createGetItemContext(i,e)};e.prototype._computeGroupingType=function(){var e,t=this.queryType();if(t===r.default.Search||t===r.default.RecycleBin)e=0;else{switch(this.layoutType()){case n.Grid:case n.SingleAlbum:e=1;break;default:e=0}}return e};e.prototype._createGetItemContext=function(e,t){var i=this._contextHelper.getDefaultGetItemContext(this.viewParams());i.sortField=this.sortConfiguration().field;i.isAscending=this.sortConfiguration().isAscending;i.startIndex=e.start;i.endIndex=e.end;i.startKey=t;i.groupingType=this._groupingType();i.revision=this.referenceRevision();i.resultSetOptions=this.itemResultSetOptions;return i};e.prototype._resolveRange=function(e){var t=this._createGetItemContext(e);return this.getCurrentItemSet(t)};return e}(i.default);t.default=u});define("odsp-next/providers/dataManager/DataManager",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../models/store/ItemsStore","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/logging/ErrorHelper","../../controls/list/layouts/LayoutType","../../dataSources/url/QueryType","../../dataSources/url/PageType","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../dataSources/layout/ContentType","../../utilities/features/Features","../item/ItemProvider","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,i,o,l,d,c,u,p,m,h,f,g,r,b,v,n,y,a,x,_,s,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={timeout:0,method:"notifyWhenChangesStop"},T=a.isFeatureEnabled(a.CompactListViewInFiles),w=function(s){i.__extends(e,s);function e(e){void 0===e&&(e={});var t=s.call(this,e)||this,i=e.itemResultSetOptions,o=t,r=o.observables,n=o.resources;t.itemProvider=n.consume(x.resourceKey);t._itemsStore=n.consume(c.resourceKey);t.viewParams=n.consume(l.viewParams);t.urlDataSource=n.consume(u.url);t.platform=n.consume(m.platformDetection);t.navigation=n.consume(p.navigation);t.promiseTracker=n.consume(l.promiseTracker);t._loaderProvider=n.consume(d.bundleLoader);t.referenceItemSet=t._getReferenceItemSet();t.defaultLayoutType=y.GRID;t.itemResultSetOptions=i;t._pageType=n.consume(l.currentPage);t.isActive=r.pureCompute(t._computeIsActive);t.focusItemKey=r.pureCompute(t._computeFocusItemKey);t.currentItemKey=r.pureCompute(t._computeCurrentItemKey);t.itemSet=r.pureCompute(t._computeItemSet);t.itemSet.equalityComparer=_.objectStrictEquality;t.item=r.pureCompute(t._computeItem);t.item.equalityComparer=_.objectStrictEquality;t.error=r.create(null);var a=e.requiredPageType;t._requiredPageType=a;t._setupContextualQueryType();t.queryType=r.pureCompute(t._computeQueryType);t._layoutTypeTrigger=r.create({});t.layoutType=r.compute({read:t._computeLayoutType,write:t.updateLayoutType,deferEvaluation:!0,pure:!0});t._initializeRange();t.focusItemContext=r.pureCompute(t._computeFocusItemContext);t.focusItemContext.equalityComparer=f.deepCompare;t.focusItemIndexInItemSet=r.pureCompute(t._computeFocusItemIndexInItemSet);t.focusItemSet=r.pureCompute(t._computeFocusItemSet);t.focusItemSet.equalityComparer=_.objectStrictEquality;t.focusItem=r.pureCompute(t._computeFocusItem);t.focusItem.equalityComparer=_.objectStrictEquality;t._isFocusItemResolved=r.pureCompute(t._computeIsFocusItemResolved);t._temporarySortConfiguration=r.create();t._temporarySortConfiguration.equalityComparer=f.deepCompare;t.sortConfiguration=r.compute({read:t._computeSortConfiguration,write:t._temporarySortConfiguration,deferEvaluation:!0,pure:!0});t.sortConfiguration.equalityComparer=f.deepCompare;r.backgroundCompute(t._computeClearSortConfiguration);t.currentContext=r.pureCompute(t.computeCurrentContext);t.currentContext.equalityComparer=f.deepCompare;r.backgroundCompute(t._computeRefreshItemSet).extend({rateLimit:S});t.referenceRevision=r.pureCompute(t._computeReferenceRevision);return t}e.prototype.updateSort=function(e,t){this.sortConfiguration({field:e,isAscending:t})};e.prototype.getDefaultLayoutForView=function(){var e=this.queryType(),t=this.viewParams.peek(),i=this.urlDataSource.getLayoutContentType(t)||this._contextualQueryTypes[b.default[e]]||this.defaultLayoutType,o=e===b.default.Search&&this._pageType.peek()===v.default.Photos;return this.currentItemKey()===this.urlDataSource.getRootItemKey(b.default.SharedWithMe)?r.SharedGrid:i===y.GRID||o?r.Grid:i===y.LIST?r.Details:i===y.COMPACT_LIST?T?r.CompactDetails:r.Details:i===y.PHOTO?r.SingleAlbum:r.Details};e.prototype.isItemResolved=function(e){return e&&e.peek()&&!e.peek().isPlaceholder};e.prototype.resolveIndices=function(e){return h.default.wrap()};e.prototype.computeFocusContext=function(e){var t=this.urlDataSource.getKeyParams(e);return{parentKey:e,ownerId:this.urlDataSource.getOwnerId(e),queryType:this.urlDataSource.getQueryType(t),resultSetOptions:this.itemResultSetOptions,ignoreChildren:!0}};e.prototype.computeCurrentContext=function(){return null};e.prototype.getFocusItemSetSync=function(e){return this.itemProvider.getItemSync(e)};e.prototype.getCurrentItemSetSync=function(e){return null};e.prototype.getFocusItemSet=function(e){return this.itemProvider.getItem(e)};e.prototype.getCurrentItemSet=function(e){return h.default.wrap(null)};e.prototype.updateLayoutType=function(e,t){var i;switch(e){case r.Details:i=y.LIST;break;case r.CompactDetails:i=y.COMPACT_LIST;break;case r.SingleAlbum:i=y.PHOTO;break;default:i=y.GRID}t=t||this.queryType.peek();if(this.currentItemKey.peek()!==this.urlDataSource.getRootItemKey(b.default.SharedWithMe)){this._contextualQueryTypes[b.default[t]]=i;this._itemsStore.setValue(this._getSetViewLocalStorageKey(),this._contextualQueryTypes,n.default.local);this._layoutTypeTrigger({})}};e.prototype.amendCurrentContext=function(e){};e.prototype._computeItemSet=function(){var e=f.deepCopy(this.currentContext());if(this.isActive.peek()){return this.getCurrentItemSetSync(e)}return this.itemSet.peek()};e.prototype._computeItem=function(){var e=this.itemSet();return e&&e.item()};e.prototype._computeRefreshItemSet=function(){var t,i=this,e=this.itemSet(),o=f.deepCopy(this.currentContext()),r=e.item.peek();o.skipInMemoryCache=r.key!==this._lastRequestKey;this._lastRequestKey=r.key;o.revision&&(o.skipCache=!0);this.amendCurrentContext(o);if(this.isActive.peek())if(r.isPlaceholder&&!this._isFocusItemResolved()){var n=f.deepCopy(this.focusItemContext());t=this.getFocusItemSet(n)}else t=this.getCurrentItemSet(o);else t=null;var a=this.urlDataSource.getKeyParams(r.key),s=this.urlDataSource.getQueryType(a),l=this.focusItem.peek()?v.default[v.default.OneUp]:v.default[v.default.Files]+"-"+(b.default[s]||"Default");this._getItemPromise=t;if(this._getItemPromise){this.promiseTracker.registerPromise(t);this.error(null);this.trackPromise(t.then(function(e){if(t===i._getItemPromise){i._getItemPromise=null;I.default.mark("DataManager.GetData.Done")}},function(e){e.errorTitle||g.default.log(e);h.default.isCanceled(e)||i.error(e)}).then(function(){i.async.setTimeout(function(){i._loaderProvider.pageLoaded(l)},0)}))}};e.prototype._computeFocusItemContext=function(){var e=this.focusItemKey();return e?this.computeFocusContext(e):null};e.prototype._computeLayoutType=function(){this._layoutTypeTrigger();return this.getDefaultLayoutForView()};e.prototype._computeReferenceRevision=function(){var e=this.referenceItemSet(),t=e&&e.item&&this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t&&t().revision||0};e.prototype._computeSortConfiguration=function(){var e=this._temporarySortConfiguration();if(e)return e;this.queryType();return{}};e.prototype._computeClearSortConfiguration=function(){this.currentItemKey();this._temporarySortConfiguration(void 0)};e.prototype._computeQueryType=function(){var e=this.referenceItemSet(),t=e&&e.item||this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t?t().isPlaceholder?this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(t().key)):t().displayType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(this.currentItemKey()))};e.prototype._getSetViewLocalStorageKey=function(){return"OneDrive.Web.Files.FilesQueryType."+this.urlDataSource.getOwnerId("",this.viewParams.peek())};e.prototype._setupContextualQueryType=function(){this._contextualQueryTypes=i.__assign(((e={})[b.default[b.default.Photos]]=y.GRID,e[b.default[b.default.Files]]=y.GRID,e[b.default[b.default.Search]]=y.GRID,e[b.default[b.default.Recent]]=y.LIST,e[b.default[b.default.RecycleBin]]=y.LIST,e),this._itemsStore.getValue(this._getSetViewLocalStorageKey(),n.default.local)||{},((t={})[b.default[b.default.SharedWithMe]]=y.GRID,t));var e,t};e.prototype._computeFocusItemKey=function(){return this.urlDataSource.getFocusItemKey(this.viewParams())};e.prototype._computeCurrentItemKey=function(){return this.urlDataSource.getCurrentItemKey(this.viewParams())};e.prototype._computeFocusItemIndexInItemSet=function(){var e=this.focusItemContext();if(e)for(var t=this.referenceItemSet(),i=t&&t.content(),o=i&&i.items||[],r=0,n=Object.keys(o);r<n.length;r++){var a=n[r],s=Number(a),l=o[s],d=l&&l.peek();if(d&&this.urlDataSource.areKeysEqual(d.key,e.parentKey))return s}return-1};e.prototype._computeFocusItem=function(){if(!this.isActive())return this.focusItem.peek();var e=this.focusItemSet();if(e){var t=this.focusItemIndexInItemSet();if(-1<t){var i=e&&e.content();return(i&&i.items||[])[t]}return e.item}return null};e.prototype._computeFocusItemSet=function(){if(!this.isActive())return this.focusItemSet.peek();var e=this.focusItemContext();if(e){return-1<this.focusItemIndexInItemSet()?this.referenceItemSet():this.getFocusItemSetSync(e)}};e.prototype._computeIsFocusItemResolved=function(){var e=this.focusItem();return!e||!e().isPlaceholder&&!e().error};e.prototype._initializeRange=function(){this.requiredRange=o.observable({start:0,end:0});this.requiredRange.equalityComparer=f.deepCompare};e.prototype._computeIsActive=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return!this._requiredPageType||t===this._requiredPageType};e.prototype._getReferenceItemSet=function(){var e,t=this,i=this.observables,o=i.create();i.backgroundCompute(function(){t.itemSet();e&&t.async.clearImmediate(e);e=t.async.setImmediate(function(){o(t.itemSet.peek());e=void 0})});return i.pureCompute(function(){var e=o();if(!e||e.item().key===t.currentItemKey())return e})};return e}(s.default);t.default=w});define("odsp-next/utilities/range/RangeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupIndices=function(e,t){void 0===t&&(t=1e3);for(var i=[],o=0,r=e;o<r.length;o++){var n=r[o],a=i[i.length-1];if(!a||n-a[0]>=t){a=[];i.push(a)}a.push(n)}return i};t.createRanges=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i],n={start:r[0],end:r[r.length-1]+1};t.push(n)}return t}});define("odsp-next/pages/files/od/DragAndDropHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/quota/QuotaStatus","../../../controls/dragAndDrop/DropHelper","../../base/od/BasePageViewModel","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../controls/dragAndDrop/dragAndDropHint/DragAndDropHint","../../../controls/dragAndDrop/DragAndDrop.resx","../../../controls/dragAndDrop/targetFrame/DragAndDropTargetFrame","../../../bindings/component/ControlBinding"],function(e,t,o,i,r,n,a,s,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._dropHelper=t.resources.consume(n.resourceKey);t._currentItem=t.resources.consume(s.currentItem);t._bundleLoader=t.resources.consume(l.bundleLoader);t._isDroppingTarget=t.createObservable(!1);t._quotaLoaded=t.createComputed(t._computeQuotaLoaded);t.events.on(window,a.DragAndDropEvents.onDragging,t._onDragging);t.events.on(window,a.DragAndDropEvents.onReceiveDrop,t._onReceiveDrop);t.events.on(window,a.DragAndDropEvents.onMayReceiveDrop,t._onMayReceiveDrop);t.hintComponent=t.createComputed(t._computeHintComponent);t.decorationComponent=t.createComputed(t._computeDecorationComponent);return t}e.prototype.getOptions=function(){return{mayReceiveDrop:this._onMayReceiveDrop,isDragging:this._onDragging,receiveDrop:this._onReceiveDrop}};e.prototype._onDragging=function(e){var t=e.args,i=t&&t.value,o=t&&t.data,r=i&&o&&0===o.dragData.type;this._isDroppingTarget(r)};e.prototype._onReceiveDrop=function(e){var t=e.args;return this._dropHelper.processDrop(t,this._currentItem.peek())};e.prototype._onMayReceiveDrop=function(e){var t=e.args,i=this._currentItem&&this._currentItem.peek&&this._currentItem.peek();return i&&t&&0===t.type?{targetName:i.name}:null};e.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(3).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(l.quota));return!0}return!1};e.prototype._computeHintComponent=function(){return this._quotaLoaded()&&this._userStateProvider.status()>=r.default.full?null:{name:d.default.tagName,params:{}}};e.prototype._computeDecorationComponent=function(){if(!this._isDroppingTarget())return null;var e={message:c.strings.TargetFrameMessage,isError:!1};if(this._quotaLoaded()){var t=this._userStateProvider.accountState();if(2===t||3===t)return null;var i=this._userStateProvider.status();i===r.default.outOfSpace?e={message:c.strings.genericOverlayMessage,isError:!0}:i===r.default.full?e={message:c.strings.fullOverlayMessage,isError:!0}:i===r.default.overQuota&&(e={message:c.strings.exceedingOverlayMessage,isError:!0})}return p.toSpecification(u.resourceKey,e)};return e}(i.default);t.default=m});define("odsp-next/controls/dragAndDrop/DropHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../providers/operator/UploadOperator.key","../../providers/moveCopy/MoveCopyProvider","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../providers/item/ShortcutProvider","@ms/odsp-utilities/lib/uri/Uri","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../../pages/files/spo/itemSetProjections/PostUploadProjectionHelper","../../utilities/optimizely/ExperimentsCommon.key","../../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(i,u,t,r,n,p,m,h,f,g,a,b,s,v,y,x,l,_,d,c,I,S,T,e,o){"use strict";Object.defineProperty(u,"__esModule",{value:!0});u.updateItemMetadataOperatorTypeResourceKey=new o.ResourceKey({name:i("module").id+".updateItemMetadataOperator",loader:new o.AliasResourceLoader(function(){return e.loadModuleExport({path:"../../providers/operator/UpdateItemMetadataOperator",getModule:function(){return new n.default(function(e,t){i(["../../providers/operator/UpdateItemMetadataOperator"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var w=function(o){t.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._moveCopyProvider=t.moveCopyProvider;i._urlDataSource=t.urlDataSource;i._shortcutProvider=t.shortcutProvider;i._currentItemSet=t.currentItemSet;i._engagement=t.engagement;i._postUploadProjectionHelper=t.postUploadProjectionHelper;i._uploadBlockAction=new(i.managed(t.actionMap.UploadBlockAction))({isDragAndDrop:!0});return i}e.prototype.processDrop=function(a,s,l,d){var c=this;void 0===l&&(l=!1);void 0===d&&(d=!1);if(!s||!s.isDropEnabled||s===a.item)return!1;if(a.metadata&&a.itemSet){var e=a.itemSet.content.peek().groupings;a.metadata.itemGroups=e&&e.length&&e[0].itemGroups}var t=this._engagement;if(0===a.type){t.logData({name:"DragAndDropEvent",isIntentional:!0});T.isOneDrive&&this.trackPromise(this.resources.consumeAsync(S.resourceKey).then(function(e){e.fireUploadEvents()}));if(this._uploadBlockAction.isAvailable.peek()){this._uploadBlockAction.execute(null);return!1}var i=this._currentItemSet.peek();this.resources.consumeAsync(b.asyncTypeResourceKey).then(function(e){var t=new e({files:a.files,parentItem:s,itemSet:i,wasDragAndDropped:!0,type:a.uploadType,metadata:a.metadata,skipInvalidation:!!l});c.trackPromise(t.start());return t.wait()}).done(null,function(e){v.default.log(e)});return!0}if(1===a.type){if(a.metadata&&a.metadata.group){this._resolveSelection(a).then(function(i){var e=new g.Action({name:"DragChangeGroup",pageType:h.default[c._urlDataSource.getPageType()],queryType:f.default[c._urlDataSource.getQueryType()]}),o=[],r=a.metadata.group;l&&i.forEach(function(e){var t=y.deepCopy(e);if(!d){var i=x.deserializeQuery(t.key);i.group=r.groupingId;t.key=x.serializeQuery(i)}t.state.upload.status=1;t.properties[r.fieldSchema.Name]=r.groupingId;o.push(c.createObservable(t));e.state.removing=!0});c.resources.consumeAsync(u.updateItemMetadataOperatorTypeResourceKey).then(function(e){var t=new e({items:i,metadata:a.metadata,parentItem:s,skipInvalidation:l,onComplete:function(e){e?l&&c._postUploadProjectionHelper.updateItemSetPostUpload(a.itemSet,o,r):alert("failure updating metadata")}});c.trackPromise(t.start());return t.wait()}).done(void 0,function(e){return v.default.log(e)});var t={},n={count:i.length};if(1===i.length){t.fileType=p.default[i[0].type];t.extension=i[0].extension||""}e.end({resultType:m.ResultTypeEnum.Success,extraData:t,extraMetrics:n})}).done(null,function(e){return v.default.log(e)});return!0}if(a.itemSet.item.peek().key===s.key)return!1;this._resolveSelection(a).then(function(i){i=i.filter(function(e){return e!==s});var o=new g.Action({name:"DragMove",pageType:h.default[c._urlDataSource.getPageType()],queryType:f.default[c._urlDataSource.getQueryType()]});return c._moveCopyProvider.copyItems({items:i,parentKey:a.item.parentKey,targetId:s.id,targetKey:s.key,cid:c._urlDataSource.getOwnerId(),group:s.isGroup?1:0,isAsync:!1,isMove:!0}).then(function(){var e={},t={count:i.length};if(1===i.length){e.fileType=p.default[i[0].type];e.extension=i[0].extension||""}o.end({resultType:m.ResultTypeEnum.Success,extraData:e,extraMetrics:t})},function(){o.end({resultType:m.ResultTypeEnum.Failure})})}).done(null,function(e){return v.default.log(e)});return!0}if(3===a.type&&this._shortcutProvider){t.logData({name:"Link.DragAndDrop.Drop",isIntentional:!0});var o=a.links.split("\n");(o=o.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var t=new _.default(e).getHost()+".url";c._shortcutProvider.createShortcut(s.key,t,e)});return!0}};e.prototype._resolveSelection=function(t){return t.selection?t.selection.resolve().then(function(e){e&&0!==e.length||(e=[t.item]);return e}):n.default.wrap([t.item])};e.dependencies=t.__assign({},r.default.dependencies,{moveCopyProvider:s.resourceKey,shortcutProvider:l.resourceKey.optional,urlDataSource:a.url,actionMap:c.actionMap,currentItemSet:c.currentItemSet,postUploadProjectionHelper:I.resourceKey,engagement:d.resourceKey});return e}(r.default);u.DropHelper=w;u.resourceKey=o.createResolvedResourceKey(i("module").id,w);u.default=w});define("odsp-next/providers/item/ShortcutProvider",["require","exports","../../resources/DataSourceResourceKeys","./ItemProvider","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._shortcutDataSource=t.shortcutDataSource;this._urlDataSource=t.urlDataSource;this._itemProvider=t.itemProvider}e.prototype.createShortcut=function(t,e,i){var o=this;return this._shortcutDataSource.createShortcut(t,e,i).then(function(e){o._itemProvider.invalidateItem(t);return e})};e.prototype.getShortcutTargetData=function(e,t){return this._shortcutDataSource.getShortcutTargetData(e,t)};e.prototype.getFileByUrl=function(e){return this._shortcutDataSource.getFileByUrl(e)};e.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(r.default.Recent),startIndex:0,endIndex:5,queryType:r.default.Recent};return this._itemProvider.getItem(e)};return e}();t.default=a;t.resourceKey=n.createResolvedResourceKey(e("module").id,a,{shortcutDataSource:i.shortcut,urlDataSource:i.url,itemProvider:o.resourceKey})});define("odsp-next/pages/files/spo/itemSetProjections/PostUploadProjectionHelper",["require","exports","../../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._itemProvider=t.itemProvider}e.prototype.updateItemSetPostUpload=function(e,t,i){if(e&&t&&0<t.length){var o=e.item.peek().key,r=this._itemProvider.computeProjectedItemSet(o+"&state=postUpload",e,{parentKey:o,itemSetProjections:{PostUpload:{uploadedItems:t,group:i}}},!0);r&&e.content({groupings:r.content.peek().groupings,items:r.content.peek().items})}};return e}();t.default=r;t.resourceKey=o.createResolvedResourceKey(e("module").id,r,{itemProvider:i.resourceKey})});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame",["require","exports","./DragAndDropTargetFrameViewModel","../../../bindings/component/ControlBinding","./DragAndDropTargetFrame.html","./DragAndDropTargetFrame.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-drag-and-drop-target-frame",name:e("module").id,template:e("./DragAndDropTargetFrame.html"),viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../overlays/Overlay","../DragAndDrop.resx"],function(e,t,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){i.__extends(e,n);function e(e,t){void 0===e&&(e={});var i=n.call(this,e,t)||this,o=e.message,r=void 0===o?s.strings.TargetFrameMessage:o;i.message=r;i.overlayComponent={name:a.default.tagName,params:{animation:{afterAdd:1,beforeRemove:300}}};i.classes={"od-DragAndDropTargetFrame-hasError":e.isError};return i}return e}(o.default);t.default=r});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame.html",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div class=od-DragAndDropTargetFrame data-bind="css: classes"><div class=od-DragAndDropTargetFrame-header><div class=od-DragAndDropTargetFrame-message data-bind="text: message"></div></div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DragAndDropTargetFrame{position:absolute;box-sizing:border-box;top:0;left:0;right:0;bottom:0;border:3px solid "},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";border-top:none;pointer-events:none;transition:visibility 0s linear 167ms,opacity 167ms ease-out}.od-DragAndDropTargetFrame-hasError.od-DragAndDropTargetFrame{border:3px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-DragAndDropTargetFrame-header{height:50px;background-color:"},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}.od-DragAndDropTargetFrame-hasError .od-DragAndDropTargetFrame-header{background-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-DragAndDropTargetFrame-message{text-align:center;line-height:45px;font-size:21px;font-weight:100;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-OverlayHost-overlay .od-DragAndDropTargetFrame{opacity:0;visibility:hidden}.od-OverlayHost-overlay .od-DragAndDropTargetFrame-header{-ms-transform:translate(0,-20px);transform:translate(0,-20px)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame{opacity:.9;visibility:inherit;transition-delay:0s,0s}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame-header{-ms-transform:none;transform:none;transition-timing-function:ease-out}"}])});define("odsp-next/pages/files/od/FilesCommandSet",["require","exports","tslib","knockout","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../../actions/sort/od/SortActionMode","../../../controls/commands/SeparatorCommandSet","../../../utilities/icons/Icon","../../../controls/list/layouts/LayoutType","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../resources/ControlResourceKeys","../../../controls/commands/Command","../../../controls/commands/Commands.resx","../../../controls/commands/SortMenuBuilder","../FilterMenuBuilder","../FilterDateMenuBuilder","../../../controls/operation/commands/OperationCommandBuilder","../../../utilities/features/Features","../FilesCommandSetHelper","../../../utilities/icons/IconHelper","../../../utilities/optimizely/OptimizelyHelper","../../../controls/infoPane/InfoPane.resx","../../../controls/folderBuilder/FolderBuilder.resx","../../../utilities/optimizely/experiments/OfficeUpsell.key"],function(e,t,o,A,P,L,i,B,V,O,E,H,r,U,N,K,z,q,G,j,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var W=r.strings,$=q.isFeatureEnabled(q.CompactListViewInFiles),d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._parentNavigation=!e.disableParentNavigation;t.resources.consumeAsync(l.resourceKey).then(function(e){t._officeUpsellLogger=e});t._initOptimizelyExperiments();t.filesCommandSetHelper=new(t.managed(G.default))({showLabels:t.responsiveUI.showLabels});t.buildCommands();return t}e.prototype.buildCommands=function(){var t=this,e=this.actionMap,i=this.resources,o=i.consume(E.currentItemSet),r=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOpenInOfficeOnlineText()}),n=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOpenInOfficeClientText()}),a=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOfficeIcon()}),s=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOfficeClass()}),l=[new(this.managed(H.CommandViewModel))({text:W.Create,tooltip:W.CreateCommandTooltip,icon:new B.default("Add"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,automationId:"create",callback:function(){t._officeUpsellLogger&&t._officeUpsellLogger.logOptimizelyEvent("newCommandBar")},children:A.observableArray([new(this.managed(H.CommandViewModel))({text:W.CreateFolder,iconUrl:j.getIconUrl(i,"folder",16),hasLineBreakAfter:!0,action:new(this.managed(e.CreateFolderAction)),automationId:"createFolder"}),new(this.managed(H.CommandViewModel))({text:W.CreateWord,iconUrl:j.getIconUrl(i,"docx",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.Word})}),new(this.managed(H.CommandViewModel))({text:W.CreateExcel,iconUrl:j.getIconUrl(i,"xlsx",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.Excel})}),new(this.managed(H.CommandViewModel))({text:W.CreatePowerPoint,iconUrl:j.getIconUrl(i,"pptx",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.PowerPoint})}),new(this.managed(H.CommandViewModel))({text:W.CreateOneNote,iconUrl:j.getIconUrl(i,"onetoc",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.OneNote})}),new(this.managed(H.CommandViewModel))({text:W.CreateExcelSurvey,iconUrl:j.getIconUrl(i,"xlsx",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.ExcelSurvey})}),new(this.managed(H.CommandViewModel))({text:W.CreateText,iconUrl:j.getIconUrl(i,"txt",16),action:new(this.managed(e.CreateDocumentAction))({docType:P.DocumentType.Text}),automationId:"createTextFile"}),new(this.managed(H.CommandViewModel))({text:W.downloadOffice,icon:new B.default("ThisPC"),action:new(this.managed(e.DownloadOfficeAction)),automationId:"downloadOffice",hasLineBreakBefore:!0})])}),new(this.managed(H.CommandViewModel))({text:W.Upload,tooltip:W.UploadCommandTooltip,icon:new B.default("Upload"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,children:A.observableArray([new(this.managed(H.CommandViewModel))({text:W.UploadFile,collapsedText:A.observable(W.Upload),action:new(this.managed(e.UploadAction))({uploadProcessorType:O.UploadProcessorType.Html5file})}),new(this.managed(H.CommandViewModel))({text:W.UploadFolder,action:new(this.managed(e.UploadAction))({uploadProcessorType:O.UploadProcessorType.Folder})})])}),new(this.managed(H.CommandViewModel))({text:W.survey,icon:a,classSuffix:s,renderLabel:2,requiredChildren:1,children:A.observableArray([new(this.managed(H.CommandViewModel))({text:W.shareSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:1})}),new(this.managed(H.CommandViewModel))({text:W.viewSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:2})}),new(this.managed(H.CommandViewModel))({text:W.editSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:3})})])}),new(this.managed(H.CommandViewModel))({text:W.selectItems,renderLabel:2,icon:new B.default("CheckboxComposite"),action:new(this.managed(e.ToggleSelectionModeAction))}),new(this.managed(H.CommandViewModel))({text:W.Open,icon:a,classSuffix:s,renderLabel:2,requiredChildren:1,location:3,children:A.observableArray([new(this.managed(H.CommandViewModel))({text:r,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeOnlineAction))}),new(this.managed(H.CommandViewModel))({text:n,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeClientAction))}),new(this.managed(H.CommandViewModel))({text:W.OpenInBrowser,renderLabel:2,icon:new B.default("PDF"),action:new(this.managed(e.OpenPdfInBrowserAction))})])}),new(this.managed(H.CommandViewModel))({text:r,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeOnlineAction)),location:8}),new(this.managed(H.CommandViewModel))({text:n,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeClientAction)),location:8}),new(this.managed(H.CommandViewModel))({text:W.OpenInBrowser,renderLabel:2,icon:new B.default("PDF"),action:new(this.managed(e.OpenPdfInBrowserAction)),location:8}),new(this.managed(H.CommandViewModel))({text:W.OpenInTextEditor,renderLabel:2,icon:new B.default("Edit"),automationId:"textEditor",action:new(this.managed(e.OpenInTextEditorAction))}),new(this.managed(H.CommandViewModel))({text:W.Edit,icon:new B.default("EditNote"),renderLabel:2,action:new(this.managed(e.RedeemAction))}),new(this.managed(H.CommandViewModel))({text:W.SaveViewCommit,icon:new B.default("Save"),automationId:"save",renderLabel:2,action:new(this.managed(e.SaveAction))}),new(this.managed(H.CommandViewModel))({text:W.Preview,location:8,renderLabel:2,engagementName:"Preview",action:new(this.managed(e.PreviewAction))({})}),new(this.managed(H.CommandViewModel))({text:this._shareText,isHidden:this._shareHidden,tooltip:W.ShareCommandTooltipV3,renderLabel:2,icon:this._shareIcon,automationId:"share",keys:["S"],action:q.isFeatureEnabled(q.SharingDialogRedux)?new(this.managed(e.ShareByLinkAction)):new(this.managed(e.ShareAction))({activeTab:2})}),new(this.managed(H.CommandViewModel))({text:W.copyLink,isHidden:this._getALinkHidden,tooltip:W.CopyLinkCommandTooltipV3,renderLabel:2,iconUrl:j.getIconUrl(i,"link",16),action:q.isFeatureEnabled(q.SharingDialogRedux)?new(this.managed(e.ShareByLinkAction)):new(this.managed(e.ShareAction))({activeTab:2})})],d=[new(this.managed(H.CommandViewModel))({text:W.Download,renderLabel:2,icon:new B.default("Download"),action:new(this.managed(e.DownloadAction))}),new(this.managed(H.CommandViewModel))({text:W.emptyRecycleBin,renderLabel:2,icon:new B.default("Delete"),action:new(this.managed(e.EmptyRecycleBinAction))}),new(this.managed(H.CommandViewModel))({text:W.DeleteItem,renderLabel:2,icon:new B.default("Delete"),action:new(this.managed(e.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(H.CommandViewModel))({text:W.CreateMountPoint,renderLabel:2,icon:new B.default("OneDriveAdd"),action:new(this.managed(e.CreateMountPointAction)),automationId:"createMountPoint",resources:i}),new(this.managed(H.CommandViewModel))({text:W.RemoveMountPoint,renderLabel:2,icon:new B.default("Cancel"),action:new(this.managed(e.RemoveMountPointAction))}),new(this.managed(H.CommandViewModel))({text:W.Remove,icon:new B.default("Cancel"),renderLabel:2,action:new(this.managed(e.RemoveFromRecentAction))}),new(this.managed(H.CommandViewModel))({text:W.restoreAll,renderLabel:2,icon:new B.default("RevToggleKey"),action:new(this.managed(e.RestoreAllAction))}),new(this.managed(H.CommandViewModel))({text:W.restore,renderLabel:2,icon:new B.default("RevToggleKey"),action:new(this.managed(e.RestoreAction))}),new(this.managed(H.CommandViewModel))({text:W.Move,renderLabel:2,icon:new B.default("FabricMovetoFolder"),action:new(this.managed(e.LaunchMoveCopyPanelAction))({isMove:!0})}),new(this.managed(H.CommandViewModel))({text:W.Copy,renderLabel:2,icon:new B.default("Copy"),automationId:"copy",action:new(this.managed(e.LaunchMoveCopyPanelAction))({isMove:!1})}),new(this.managed(H.CommandViewModel))({text:W.Rename,renderLabel:2,icon:new B.default("Edit"),action:new(this.managed(e.RenameAction)),keys:["F2"],automationId:"rename"})],c=[new(this.managed(H.CommandViewModel))({text:W.addToSharedList,renderLabel:2,icon:new B.default("Add"),action:new(this.managed(e.AddToSharedListAction))}),new(this.managed(H.CommandViewModel))({text:W.removeFromSharedList,renderLabel:2,icon:new B.default("Cancel"),action:new(this.managed(e.RemoveFromSharedListAction))}),new(this.managed(H.CommandViewModel))({text:W.Play,renderLabel:2,icon:new B.default("Play"),action:new(this.managed(e.PlayAudioAction))}),new(this.managed(H.CommandViewModel))({text:W.createAlbumFromFolder,renderLabel:2,icon:new B.default("Picture"),action:new(this.managed(e.CreateAlbumFromFolderAction))}),new(this.managed(H.CommandViewModel))({text:W.AddToAlbum,renderLabel:2,icon:new B.default("Photo2Add"),action:new(this.managed(e.AddToAlbumAction))}),new(this.managed(H.CommandViewModel))({text:W.addAsCover,renderLabel:2,icon:new B.default("Picture"),action:new(this.managed(e.AddCoverPhotoAction))}),new(this.managed(H.CommandViewModel))({text:W.removeAsCover,renderLabel:2,icon:new B.default("Picture"),action:new(this.managed(e.RemoveCoverPhotoAction))}),new(this.managed(H.CommandViewModel))({text:W.editTags,renderLabel:2,icon:new B.default("Tag"),keys:["T"],action:new(this.managed(e.EditTagsAction))}),new(this.managed(H.CommandViewModel))({text:W.rotate,renderLabel:2,icon:new B.default("rotate"),action:new(this.managed(e.RotateAction))}),new(this.managed(H.CommandViewModel))({text:W.OrderPrints,icon:new B.default("Print"),renderLabel:2,action:new(this.managed(e.OrderPrintsAction))}),new(this.managed(H.CommandViewModel))({text:W.addToBundle,icon:new B.default("Add"),renderLabel:2,action:new(this.managed(e.AddToBundleAction))({})}),new(this.managed(H.CommandViewModel))({text:W.removeFromBundle,icon:new B.default("Cancel"),renderLabel:2,action:new(this.managed(e.RemoveFromBundleAction))({})}),new(this.managed(H.CommandViewModel))({text:W.Embed,icon:new B.default("Embed"),renderLabel:2,automationId:"embed",action:new(this.managed(e.EmbedAction))}),new(this.managed(H.CommandViewModel))({text:W.versionHistory,icon:new B.default("StackIndicator"),renderLabel:2,action:new(this.managed(e.ShowVersionHistoryAction))({})}),new(this.managed(H.CommandViewModel))({text:W.reportAbuse,icon:new B.default("EditNote"),renderLabel:2,action:new(this.managed(e.ReportAbuseAction))({})}),new(this.managed(H.CommandViewModel))({text:W.requestReview,icon:new B.default("EditNote"),renderLabel:2,action:new(this.managed(e.RequestReviewAction))({})}),new(this.managed(H.CommandViewModel))({text:W.viewInFolder,iconUrl:j.getIconUrl(i,"folder",16),action:new(this.managed(e.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),this.overflowHostCommand,new(this.managed(z.default))({renderLabel:2}).command],u=new(this.managed(U.default))({currentItemSet:o,itemsToAppend:[new(this.managed(H.CommandViewModel))({text:W.SortAscending,isToggleable:!0,action:new(this.managed(e.OneDriveSortAction))({mode:L.default.Order,ascending:!0})}),new(this.managed(H.CommandViewModel))({text:W.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(e.OneDriveSortAction))({mode:L.default.Order,ascending:!1})}),new(this.managed(H.CommandViewModel))({text:W.Rearrange,isToggleable:!1,hasLineBreakAfter:!0,action:new(this.managed(e.RearrangeAction))({})}),new(this.managed(H.CommandViewModel))({text:W.SaveSortOrder,isToggleable:!1,action:new(this.managed(e.SaveSortOrderAction))})]}),p=new(this.managed(H.CommandViewModel))({text:W.Sort,renderLabel:2,icon:new B.default("SortLines"),isHidden:this.selectionModeOn,requiredChildren:1,children:u.sortItems,location:4}),m=A.observable(!1),h=new(this.managed(N.default))({showCurrentView:m}),f=new(this.managed(H.CommandViewModel))({text:W.Type,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return t.responsiveUI.showLabels()?void 0:new B.default("Filter")}),isCurrentView:m,requiredChildren:1,children:h&&h.filterItems}),g=A.observable(!1),b=new(this.managed(K.default))({showCurrentView:g}),v=new(this.managed(H.CommandViewModel))({text:W.date,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return t.responsiveUI.showLabels()?void 0:new B.default("Clock")}),isCurrentView:g,requiredChildren:1,children:b&&b.filterItems});l.push(f);l.push(v);var y=this.createPureComputed(function(){return t.filesCommandSetHelper.showSelectionActionText()}),x=new(this.managed(H.CommandViewModel))({text:W.ViewList,tooltip:W.ViewListCommandTooltip,icon:new B.default(G.default.detailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:V.Details}),automationId:"switchLayout",engagementName:"ViewList"}),_=new(this.managed(H.CommandViewModel))({text:W.ViewCompactList,tooltip:W.ViewCompactListCommandTooltip,icon:new B.default(G.default.compactDetailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:V.CompactDetails}),automationId:"switchLayout",engagementName:"ViewCompactList"}),I=new(this.managed(H.CommandViewModel))({text:W.ViewGrid,tooltip:W.ViewGridCommandTooltip,icon:new B.default(G.default.gridIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:V.Grid}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),S=new(this.managed(H.CommandViewModel))({text:W.ViewPhoto,tooltip:W.ViewPhotoCommandTooltip,icon:new B.default(G.default.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:V.SingleAlbum}),automationId:"switchLayout",location:4}),T=new(this.managed(H.CommandViewModel))({renderLabel:0,icon:this.createComputed(function(){return t.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:A.observableArray([x].concat($?[_]:[],[I],[S])),automationId:"switchLayoutSwitcher",text:W.Views,tooltip:W.ViewsCommandTooltip}),w=new(this.managed(H.CommandViewModel))({text:y,tooltip:W.showSelection,isHidden:this.selectionModeOff,icon:new B.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(e.ShowSelectionAction)),keys:["CtrlD","MetaD"],automationId:"deselectAll"}),C=new(this.managed(H.CommandViewModel))({text:W.Details,icon:new B.default("Info"),location:12,action:new(this.managed(e.ShowPropertiesAction))({useToggleBehavior:!0}),renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"}),k=new(this.managed(H.CommandViewModel))({location:0,action:new(this.managed(e.OpenAction))({openRelation:3}),keys:["AltUp"]}),F=new(this.managed(H.CommandViewModel))({location:0,action:new(this.managed(e.ShowKeyboardMapAction)),keys:["Shift/"]}),M=new(this.managed(H.CommandViewModel))({location:0,action:new(this.managed(e.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]}),R=new(this.managed(H.CommandViewModel))({location:0,action:new(this.managed(e.SelectAllAction)),keys:["CtrlA","MetaA"]}),D=[l,d,c,[p].concat([T],[w,C],this._parentNavigation?[k]:[],[F,M,R])].map(function(e){return t.createObservable(e)});this.commandSets(D)};e.prototype._initOptimizelyExperiments=function(){var i=this;this._shareIcon=A.observable(new B.default("Share"));this._shareText=A.observable(W.Share);this._shareHidden=A.observable(!1);this._getALinkHidden=A.observable(!0);n.OptimizelyHelper.GetVariationIdsMapForExperiment(n.OptimizelyHelper.SHARE_EXPERIMENT_ID).done(function(e){if(e&&e.length){var t=parseInt(e[0],10);if(t===n.OptimizelyHelper.SHARE_VARIATION_LINK_ID){i._shareHidden(!0);i._getALinkHidden(!1)}else if(t===n.OptimizelyHelper.SHARE_VARIATION_SHARE_LINK_ID)i._getALinkHidden(!1);else if(t===n.OptimizelyHelper.SHARE_VARIATION_EMAIL_ID){i._shareIcon(new B.default("Mail"));i._shareText(a.strings.extractedTextEmailTypeName);i._getALinkHidden(!1)}else if(t===n.OptimizelyHelper.SHARE_VARIATION_INVITE_ID){i._shareIcon(new B.default("PeopleAdd"));i._shareText(s.strings.AddEditors);i._getALinkHidden(!1)}}})};return e}(i.default);t.default=d});define("odsp-next/controls/commands/SeparatorCommandSet",["require","exports","tslib","./BaseCommandSet","../../resources/ControlResourceKeys","../list/react/SelectionManager"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.selection=t.resources.consume(r.itemsSelection);t.actionMap=t.resources.consume(r.actionMap);t._isSelectionModal=t.resources.consume(n.isSelectionModalResourceKey);t.commandSets=t.createObservable([]);t.selectionModeOn=t.createPureComputed(t._computeSelectionModeOn);t.selectionModeOff=t.createPureComputed(t._computeSelectionModeOff);var i=t.createPureComputed(t._computeCommands);t.createComputed(function(){(e=t.commands).splice.apply(e,[0,t.commands.peek().length].concat(i()));var e});t.createComputed(t._computeSeparators).extend({rateLimit:0});return t}e.prototype._computeCommands=function(){var e=this.commandSets()||[];return[].concat.apply([],e.map(function(e){return e()}))};e.prototype._computeSeparators=function(){this.selection.selection();var e=this.commandSets();if(e.length){for(var t=!1,i=[],o=0,r=e;o<r.length;o++){for(var n=(0,r[o])(),a=!1,s=0,l=n.length-1;0<=l&&s<2;l--){if((u=n[l])&&u.isVisible.peek()){u.hasLineBreakAfter(!a);if(!a){a=!0;i.push(u)}s++}}1<s&&(t=!0)}if(!t)for(var d=0,c=i;d<c.length;d++){var u;(u=c[d]).hasLineBreakAfter(!1)}}};e.prototype._computeSelectionModeOn=function(){return this.selection&&0<this.selection.selection().length||this._isSelectionModal()};e.prototype._computeSelectionModeOff=function(){return!this.selectionModeOn()};return e}(o.default);t.default=a});define("odsp-next/controls/commands/SortMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./CommandViewModel","knockout","../../actions/sort/od/OneDriveSortAction","../../actions/sort/od/SortActionMode"],function(e,t,i,o,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(e){var r=t.call(this,e)||this;r.sortItems=l.observableArray();r._commands=[];var n=e.itemsToAppend,a=e.currentItemSet;r.createComputed(function(){r._commands.map(function(e){return e.dispose()});r._commands=[];var e=a(),t=e.schema()||[];if(0!==t.length||!e.isPlaceholder){var i=t.filter(function(e){return!(!e.sortable||!e.name)}),o=[];0<i.length&&(o=i.map(function(e,t,i){var o=new(r.managed(s.default))({text:e.name,isToggleable:!0,action:new(r.managed(d.default))({mode:c.default.Column,column:e}),hasLineBreakAfter:n&&t===i.length-1});r._commands.push(o);return o}).concat(n||[]));r.sortItems(o)}});return r}return e}(o.default);t.default=r});define("odsp-next/pages/files/FilterMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../controls/commands/CommandViewModel","knockout","../../resources/ControlResourceKeys","../../controls/commands/Commands.resx","../../utilities/icons/Icon","../../dataSources/search/ISearchDataSource"],function(e,t,i,o,s,l,d,r,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=r.strings,n=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._filterTypes=[{type:u.SearchFilterType.all,icon:void 0},{type:u.SearchFilterType.photos,icon:new c.default("Picture")},{type:u.SearchFilterType.documents,icon:new c.default("Documentation")},{type:u.SearchFilterType.music,icon:new c.default("MusicInCollection")},{type:u.SearchFilterType.folders,icon:new c.default("Folder")}];t._actionMap=t.resources.consume(d.actionMap);t.filterItems=l.observableArray();for(var i=[],o=0,r=t._filterTypes;o<r.length;o++){var n=r[o];i.push(new s.default({text:p[u.SearchFilterType[n.type].replace(/(\w)(\w*)/g,function(e,t,i){return t.toUpperCase()+i.toLowerCase()})],isToggleable:!0,icon:n.icon,action:new(t.managed(t._actionMap.FilterSearchAction))({filter:n.type,showCurrentView:e.showCurrentView}),hasLineBreakAfter:!1}))}t.filterItems(i);return t}return e}(o.default);t.default=n});define("odsp-next/pages/files/FilterDateMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../controls/commands/CommandViewModel","knockout","../../resources/ControlResourceKeys","../../controls/commands/Commands.resx","../../dataSources/search/ISearchDataSource"],function(e,t,i,o,s,l,d,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=r.strings,n=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._actionMap=t.resources.consume(d.actionMap);t.filterItems=l.observableArray();for(var i=[],o=0,r=Object.keys(c.SearchFilterDateType).filter(function(e){return isNaN(parseInt(e,10))});o<r.length;o++){var n=r[o];i.push(new s.default({text:u[n],isToggleable:!0,action:new(t.managed(t._actionMap.FilterSearchByDateAction))({filter:c.SearchFilterDateType[n],showCurrentView:e.showCurrentView}),hasLineBreakAfter:!1}))}t.filterItems(i);return t}return e}(o.default);t.default=n});define("odsp-next/controls/operation/commands/OperationCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../commands/Command","../monitor/OperationMonitor.key","../../../providers/operation/OperationProvider","../../../models/operation/OperationState","../../../models/operation/OperationType","../../../utilities/icons/Icon","../strings/OperationStringMappings","@ms/odsp-shared/lib/utilities/knockout/Renderers","../../../resources/ControlResourceKeys","../../commands/Commands.resx","knockout","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,i,o,s,r,m,u,h,n,f,g,b,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(p){i.__extends(e,p);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=p.call(this,e,t)||this,o=i,r=o.resources,n=o.observables;i._operationProvider=r.consume(m.resourceKey);i._actionMap=r.consume(b.actionMap);i._completedOperations=n.createArray();i._currentOperations=n.createArray();i._autoDismissPayload=n.pureCompute(i._computeAutoDismissPayload);var a=e.suppressNotifications,s=void 0!==a&&a;i._suppressNotifications=s;i._initializeCurrentOperation();i._showOperationsAction=new(i.managed(i._actionMap.ShowOperationsAction));i._initializeCommand(e);var l=t.openCommandExtenders,d=void 0===l?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:l,c=t.cleanupOperationsExtenders,u=void 0===c?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:c;n.backgroundCompute(i._computeOpenCommand).extend(d);n.backgroundCompute(i._computeCleanupOperationsOnClose).extend(u);return i}e.prototype._computeOpenCommand=function(){this._completedOperations().length&&this.command.isOpen(!0)};e.prototype._computeCleanupOperationsOnClose=function(){this.command.isOpen()||this.command.action.isToggled()||this.command.action.isExecuting()||a.computedContext.isInitial()||this._operationProvider.cleanup(!0)};e.prototype._initializeCurrentOperation=function(){var i=this,n=this._completedOperations,a=this._currentOperations;this._operationProvider.groups.map({mappingWithDisposeCallback:function(r){var e=i.createComputed(function(){var e=r.state(),o=!i._suppressNotifications&&!r.visibility.peek();switch(e){case u.default.completed:case u.default.failed:case u.default.created:case u.default.started:a.remove(r)}switch(e){case u.default.completed:case u.default.failed:var t=[];o&&t.push(r);n.splice.apply(n,[0,1/0].concat(t));break;case u.default.started:i.async.setTimeout(function(){(t=(e=r).state.peek()===u.default.started,i=e.progress.current.peek()<(e.progress.maximum.peek()-e.progress.minimum.peek())/2,t&&i)&&o&&n.splice(0,1/0,r);var e,t,i},500)}switch(e){case u.default.created:case u.default.started:a.unshift(r)}});return{mappedValue:r.batch.id,dispose:function(){e.dispose();n.remove(r);a.remove(r)}}}})};e.prototype._initializeCommand=function(e){var t=e.renderLabel,i=void 0===t?0:t,o=e.isDisabled,r=void 0!==o&&o,n=this.observables,a=this._suppressNotifications?void 0:{control:this._getPayload(),autoDismiss:this._autoDismissPayload,announce:!0,timeout:4e3};this.command=new(this.managed(s.CommandViewModel))({action:this._showOperationsAction,renderLabel:i,isDisabled:n.create(r),icon:n.pureCompute(this._computeIcon),iconBadge:n.pureCompute(this._computeIconBadge),hasIconOnly:n.pureCompute(this._computeHasIconOnly),accessibleLabel:l.strings.ViewActivities,prependTextToAccessibleLabel:!0,text:n.pureCompute(this._computeText).extend({rateLimit:{timeout:10,method:"notifyWhenChangesStop"}}),payload:a,hasDynamicText:!0,hasAnimation:!0,location:4})};e.prototype._computeText=function(){var e,t=this._currentOperations()[0];if(t&&t.visibility.peek()<1){var i=u.default[t.state()],o=h.default[t.type()],r=h.default[h.default.multiple],n=f.default.types[o],a=f.default.types[r],s=n.states[i],l=a.states[i],d=s&&(s.shortTitle||s.title)||l&&(l.shortTitle||l.title)||n.shortTitle||a.shortTitle,c={count:t.count,states:t.states,error:t.error,payloads:t.payloads,progress:t.progress};e=g.renderText({context:c,resources:this.resources},f.resolveEntry(d,c))}else e="";return e};e.prototype._computeIcon=function(){var e=this._operationProvider.overall.state();return e===u.default.created||e===u.default.started?new n.default("Sync","is-active"):new n.default("Sync")};e.prototype._computeIconBadge=function(){return this._operationProvider.overall.states().failed?new n.default("StatusErrorFull"):null};e.prototype._getPayload=function(){var t=this,e=this.observables,i=e.create(),o=e.pureCompute(function(){return!!t._completedOperations().length});e.backgroundCompute(function(){o.peek()?t.trackPromise(t.resources.consumeAsync(r.resourceKey.local)).done(function(e){i(e.toSpecification({groups:t._completedOperations,expandGroups:!1,onViewAll:function(){return t._onViewAll()},onExecuteAction:function(){t.command.isOpen(!1)}}))}):o()});return i};e.prototype._onViewAll=function(){this._showOperationsAction.isAvailable.peek()&&this._showOperationsAction.execute(void 0).done()};e.prototype._computeAutoDismissPayload=function(){return this._completedOperations().every(function(e){return e.state.peek()!==u.default.failed})};e.prototype._computeHasIconOnly=function(){var e=this._currentOperations()[0];return!(e&&e.visibility.peek()<1)};return e}(o.default);t.default=d});define("odsp-next/controls/operation/monitor/OperationMonitor.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./OperationMonitor",getModule:function(){return new t.default(function(e,t){i(["./OperationMonitor"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/operation/strings/OperationStringMappings",["require","exports","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../monitor/OperationMonitor.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/dataSources/upload/Upload","../../../utilities/icons/Icon","../../itemLink/ItemLink","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,i,o,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=o.strings,c=r.format,u=r.pluralSelect;function p(e){return c(d.percentProgressFormat,Math.round(e.progress.current()/e.progress.maximum()*100))}function m(e){return c(d.progressFormat,i.default.getDisplayString(e.progress.current()),i.default.getDisplayString(e.progress.maximum()))}var h=d.createdDescription,f=d.completedDescription;function g(e){return e.error()&&e.error().message||d.failedDescription}var b=d.canceledDescription;function v(e,t){return"function"==typeof e?e(t):e}t.resolveEntry=v;function y(o){return function(e){var t=e.error(),i=t&&t.payloads.upload&&t.payloads.upload.error;return v(i&&o[n.UploadErrorType[i.errorType]],i)||v(g,e)}}function x(t){return function(e){return c(t,i.default.getDisplayString(e.maxSizeInBytes),d.productName)}}var _,I=y({general:d.generalUploadErrorText,fileSize:x(d.fileSizeUploadErrorFormat),emptyFileOrFolder:d.emptyFileOrFolderUploadErrorFormat,emptyFileOrFolderForDocLib:(_=d.emptyFileOrFolderUploadErrorFormat2,function(e){return c(_,e.libraryName)}),overQuota:d.overQuotaCreateItemErrorText,overQuotaSharedFolder:d.overQuotaSharedFolderUploadErrorText,lockMismatch:d.lockMismatchUploadErrorText,accessDenied:d.accessDeniedUploadErrorText,invalidName:d.invalidNameUploadErrorText,pathTooLong:d.pathTooLongUploadErrorText,conflict:function(e){return e.allowRename?d.conflictUploadErrorText:d.conflictUploadWithoutRenameErrorText},folderUploadNotSupported:d.folderUploadNotSupported,versionMismatch:d.generalUploadErrorText,targetFolderMissing:d.accessDeniedUploadErrorText,authFailure:d.accessDeniedUploadErrorText,malwareDetected:d.generalUploadErrorText,throttled:d.generalUploadErrorText}),S={general:d.generalSaveErrorText,fileSize:x(d.fileSizeSaveErrorFormat),emptyFileOrFolder:d.emptyFileSaveErrorFormat,overQuota:d.overQuotaCreateItemErrorText,overQuotaSharedFolder:d.overQuotaSharedFolderSaveErrorText,lockMismatch:d.generalSaveErrorText,accessDenied:d.accessDeniedSaveErrorText,invalidName:d.invalidNameUploadErrorText,pathTooLong:d.pathTooLongUploadErrorText,conflict:d.generalSaveErrorText,folderUploadNotSupported:d.generalSaveErrorText,versionMismatch:d.revisionConflictSaveErrorText},T={general:d.generalCreateItemErrorText,fileSize:x(d.fileSizeCreateItemErrorFormat),emptyFileOrFolder:d.generalCreateItemErrorText,overQuota:d.overQuotaCreateItemErrorText,overQuotaSharedFolder:d.overQuotaSharedFolderCreateItemErrorText,lockMismatch:d.generalCreateItemErrorText,accessDenied:d.accessDeniedCreateItemErrorText,invalidName:d.invalidNameUploadErrorText,pathTooLong:d.pathTooLongUploadErrorText,conflict:d.generalCreateItemErrorText,folderUploadNotSupported:d.generalCreateItemErrorText,versionMismatch:d.revisionConflictCreateItemErrorText};function w(e){return"<span data-bind=\"component: { name: '"+s.default.tagName+"', params: { item: "+e+' } }"></span>'}function C(e){var t=e.payloads().shareItem;switch(t&&t.result){case 0:return d.completedDescription;case 1:return d.shareAccessRequestQueued;case-2:case-1:return d.shareAccessDenied;case void 0:return"";default:return g(e)}}function k(e){return e.states().completed?1===e.payloads().shareItem.result?d.shareAccessRequestQueued:1<e.payloads().shareItem.items.length?c(d.shareMultipleTitleFormat,e.payloads().shareItem.items.length):c(d.shareTitleFormat,l.default.encodeText(e.payloads().shareItem.items[0].name)):e.states().failed?M(e.payloads().shareItem.items.length,d.shareFailedTitleFormat,d.shareMultipleFailedTitleFormat):M(e.payloads().shareItem.items.length,d.variousSingleTitleFormat,d.variousMultipleTitleFormat)}function F(e){var t=e.states();return t.completed+t.created+t.started}function M(e,t,i,o){return c(u(e,t,i),e,o)}function R(t,i,o){return function(e){return M(F(e),t,i,o)}}function D(t,i,o){return function(e){return M(e.states().completed,t,i,o)}}function A(t,i,o){return function(e){return M(e.states().failed,t,i,o)}}function P(t,i,o){return function(e){return M(e.states().canceled,t,i,o)}}function L(t){return function(e){return c(t,l.default.encodeText(e.payloads().uploadItems.name))}}function B(t){return function(e){return c(t,l.default.encodeText(e.payloads().triggerFlow.flowDisplayName))}}function V(t){return function(e){return c(t,l.default.encodeText(e.payloads().createColumn.name))}}function O(t){return function(e){return c(t,l.default.encodeText(e.payloads().editColumn.name))}}function E(t){return function(e){return c(t,l.default.encodeText(e.payloads().deleteColumn.name))}}function H(t){return function(e){return c(t,l.default.encodeText(e.payloads().downloadAsZip.fileName))}}function U(t,i){return function(e){return u(e.count(),t,i)}}var N=R(d.variousSingleTitleFormat,d.variousMultipleTitleFormat),K=D(d.completedVariousSingleTitleFormat,d.completedVariousMultipleTitleFormat),z=A(d.failedVariousSingleTitleFormat,d.failedVariousMultipleTitleFormat),q=P(d.failedVariousSingleTitleFormat,d.failedVariousMultipleTitleFormat),G={types:{multiple:{title:N,shortTitle:N,states:{created:{description:h},started:{description:function(e){var t=e.progress.current();return c(d.progressFormat,t%1!=0?t.toFixed(2):t,e.progress.maximum())}},completed:{title:K,shortTitle:K,description:f},failed:{title:z,shortTitle:z,description:g},canceled:{title:q,shortTitle:q,description:b},expired:{description:""}}},renameItems:{title:R(d.startedRenameSingleShortTitleFormat,d.startedRenameMultipleShortTitleFormat),shortTitle:R(d.startedRenameSingleShortTitleFormat,d.startedRenameMultipleShortTitleFormat),states:{completed:{title:D(d.completedRenameSingleTitleFormat,d.completedRenameMultipleTitleFormat)},failed:{title:A(d.failedRenameSingleTitleFormat,d.failedRenameMultipleTitleFormat)},canceled:{title:P(d.failedRenameSingleTitleFormat,d.failedRenameMultipleTitleFormat)}}},requestReview:{title:R(d.startedRequestReviewSingleShortTitleFormat,d.startedRequestReviewMultipleShortTitleFormat),shortTitle:R(d.startedRequestReviewSingleShortTitleFormat,d.startedRequestReviewMultipleShortTitleFormat),states:{completed:{title:D(d.completedRequestReviewSingleTitleFormat,d.completedRequestReviewMultipleTitleFormat)},failed:{title:A(d.failedRequestReviewSingleTitleFormat,d.failedRequestReviewMultipleTitleFormat)},canceled:{title:P(d.failedRequestReviewSingleTitleFormat,d.failedRequestReviewMultipleTitleFormat)}}},reportAbuse:{title:function(e){return c(d.startedReportAbuseSingleShortTitleFormat,l.default.encodeText(e.payloads().reportAbuse.item.name))},shortTitle:d.startedReportAbuseSingleShortTitleFormat,states:{completed:{title:c(d.completedReportAbuseSingleTitleFormat,w("context.payloads().reportAbuse.item"))},failed:{title:c(d.failedReportAbuseSingleTitleFormat,w("context.payloads().reportAbuse.item"))},canceled:{title:c(d.failedReportAbuseSingleTitleFormat,w("context.payloads().reportAbuse.item"))}}},deleteItems:{title:R(d.deleteSingleTitleFormat,d.deleteMultipleTitleFormat,w("context.payloads().deleteItems.parent")),shortTitle:R(d.startedDeleteSingleShortTitleFormat,d.startedDeleteMultipleShortTitleFormat),states:{completed:{title:D(d.completedDeleteSingleTitleFormat,d.completedDeleteMultipleTitleFormat,w("context.payloads().deleteItems.parent"))},failed:{title:A(d.failedDeleteSingleTitleFormat,d.failedDeleteMultipleTitleFormat)},canceled:{title:P(d.failedDeleteSingleTitleFormat,d.failedDeleteMultipleTitleFormat)}},actions:{undo:{mode:1},deleteLocked:{mode:1}}},pointInTimeRestore:{title:R(d.pointInTimeRestoreTitleFormat,d.pointInTimeRestoreTitleFormat),shortTitle:R(d.pointInTimeRestoreTitleFormat,d.pointInTimeRestoreTitleFormat),states:{created:{description:h},started:{description:p},completed:{title:D(d.completedPointInTimeRestoreTitleFormat,d.completedPointInTimeRestoreTitleFormat)},failed:{title:A(d.failedPointInTimeRestoreTitleFormat,d.failedPointInTimeRestoreTitleFormat)},canceled:{title:P(d.canceledPointInTimeRestoreTitleFormat,d.canceledPointInTimeRestoreTitleFormat)}}},restoreItems:{title:R(d.restoreSingleTitleFormat,d.restoreMultipleTitleFormat),shortTitle:R(d.startedRestoreSingleShortTitleFormat,d.startedRestoreMultipleShortTitleFormat),states:{completed:{title:D(d.completedRestoreSingleShortTitleFormat,d.completedRestoreMultipleShortTitleFormat)},failed:{title:A(d.failedRestoreSingleTitleFormat,d.failedRestoreMultipleTitleFormat)},canceled:{title:P(d.failedRestoreSingleTitleFormat,d.failedRestoreMultipleTitleFormat)}}},uploadItems:{title:R(d.uploadSingleTitleFormat,d.uploadMultipleTitleFormat,w("context.payloads().uploadItems.parent")),shortTitle:R(d.startedUploadSingleShortTitleFormat,d.startedUploadMultipleShortTitleFormat),states:{started:{description:m},completed:{title:D(d.completedUploadSingleTitleFormat,d.completedUploadMultipleTitleFormat,w("context.payloads().uploadItems.parent"))},failed:{title:A(d.failedUploadSingleTitleFormat,d.failedUploadMultipleTitleFormat),description:I},canceled:{title:P(d.failedUploadSingleTitleFormat,d.failedUploadMultipleTitleFormat)}},actions:{cancel:{mode:3}}},moveItems:{title:R(d.moveSingleTitleFormat,d.moveMultipleTitleFormat,w("context.payloads().moveItems.destination")),shortTitle:R(d.startedMoveSingleShortTitleFormat,d.startedMoveMultipleShortTitleFormat),states:{started:{description:p},completed:{title:D(d.completedMoveSingleTitleFormat,d.completedMoveMultipleTitleFormat,w("context.payloads().moveItems.destination"))},failed:{title:A(d.failedMoveSingleTitleFormat,d.failedMoveMultipleTitleFormat)},canceled:{title:P(d.canceledMoveSingleTitleFormat,d.canceledMoveMultipleTitleFormat)}},actions:{cancel:{mode:1}}},copyItems:{title:R(d.copySingleTitleFormat,d.copyMultipleTitleFormat,w("context.payloads().copyItems.destination")),shortTitle:R(d.startedCopySingleShortTitleFormat,d.startedCopyMultipleShortTitleFormat),states:{started:{description:p},completed:{title:D(d.completedCopySingleTitleFormat,d.completedCopyMultipleTitleFormat,w("context.payloads().copyItems.destination"))},failed:{title:A(d.failedCopySingleTitleFormat,d.failedCopyMultipleTitleFormat)},canceled:{title:P(d.canceledCopySingleTitleFormat,d.canceledCopyMultipleTitleFormat)}},actions:{cancel:{mode:1}}},rotateItems:{title:R(d.rotateSingleTitleFormat,d.rotateMultipleTitleFormat),shortTitle:R(d.startedRotateSingleShortTitleFormat,d.startedRotateMultipleShortTitleFormat),states:{completed:{title:D(d.completedRotateSingleShortTitleFormat,d.completedRotateMultipleShortTitleFormat)},failed:{title:A(d.failedRotateSingleTitleFormat,d.failedRotateMultipleTitleFormat)},canceled:{title:P(d.failedRotateSingleTitleFormat,d.failedRotateMultipleTitleFormat)}}},downloadAsZip:{title:d.downloadMultipleTitleFormat,shortTitle:d.downloadMultipleTitleFormat,states:{started:{title:H(d.startedDownloadMultipleLongTitleFormat)},completed:{title:H(d.completedDownloadMultipleLongTitleFormat)},canceled:{title:H(d.canceledDownloadMultipleLongTitleFormat)}}},applyOfficeLens:{title:R(d.applyOfficeLensSingleTitleFormat,d.applyOfficeLensMultipleTitleFormat),shortTitle:R(d.startedApplyOfficeLensSingleShortTitleFormat,d.startedApplyOfficeLensMultipleShortTitleFormat),states:{completed:{title:D(d.completedApplyOfficeLensSingleShortTitleFormat,d.completedApplyOfficeLensMultipleShortTitleFormat)},failed:{title:A(d.failedApplyOfficeLensSingleTitleFormat,d.failedApplyOfficeLensMultipleTitleFormat)},canceled:{title:P(d.failedApplyOfficeLensSingleTitleFormat,d.failedApplyOfficeLensMultipleTitleFormat)}}},removeOfficeLens:{title:R(d.removeOfficeLensSingleTitleFormat,d.removeOfficeLensMultipleTitleFormat),shortTitle:R(d.startedRemoveOfficeLensSingleShortTitleFormat,d.startedRemoveOfficeLensMultipleShortTitleFormat),states:{completed:{title:D(d.completedRemoveOfficeLensSingleShortTitleFormat,d.completedRemoveOfficeLensMultipleShortTitleFormat)},failed:{title:A(d.failedRemoveOfficeLensSingleTitleFormat,d.failedRemoveOfficeLensMultipleTitleFormat)},canceled:{title:P(d.failedRemoveOfficeLensSingleTitleFormat,d.failedRemoveOfficeLensMultipleTitleFormat)}}},addItemsToAlbum:{title:R(d.addToAlbumSingleTitleFormat,d.addToAlbumMultipleTitleFormat,w("context.payloads().addItemsToAlbum.album")),shortTitle:R(d.startedAddToAlbumSingleShortTitleFormat,d.startedAddToAlbumMultipleShortTitleFormat),states:{completed:{title:D(d.completedAddToAlbumSingleTitleFormat,d.completedAddToAlbumMultipleTitleFormat,w("context.payloads().addItemsToAlbum.album"))},failed:{title:A(d.failedAddToAlbumSingleTitleFormat,d.failedAddToAlbumMultipleTitleFormat)},canceled:{title:P(d.failedAddToAlbumSingleTitleFormat,d.failedAddToAlbumMultipleTitleFormat)}}},addCoverPhotos:{title:R(d.addAsCoverPhotosSingleTitleFormat,d.addAsCoverPhotosMultipleTitleFormat,w("context.payloads().coverPhotos.parent")),shortTitle:R(d.startedAddAsCoverPhotosSingleShortTitleFormat,d.startedAddAsCoverPhotosMultipleShortTitleFormat),states:{completed:{title:D(d.completedAddAsCoverPhotosSingleTitleFormat,d.completedAddAsCoverPhotosMultipleTitleFormat,w("context.payloads().coverPhotos.parent"))},failed:{title:A(d.failedAddAsCoverPhotosSingleTitleFormat,d.failedAddAsCoverPhotosMultipleTitleFormat)},canceled:{title:P(d.failedAddAsCoverPhotosSingleTitleFormat,d.failedAddAsCoverPhotosMultipleTitleFormat)}}},removeCoverPhotos:{title:R(d.removeAsCoverPhotosSingleTitleFormat,d.removeAsCoverPhotosMultipleTitleFormat,w("context.payloads().coverPhotos.parent")),shortTitle:R(d.startedRemoveAsCoverPhotosSingleShortTitleFormat,d.startedRemoveAsCoverPhotosMultipleShortTitleFormat),states:{completed:{title:D(d.completedRemoveAsCoverPhotosSingleTitleFormat,d.completedRemoveAsCoverPhotosMultipleTitleFormat,w("context.payloads().coverPhotos.parent"))},failed:{title:A(d.failedRemoveAsCoverPhotosSingleTitleFormat,d.failedRemoveAsCoverPhotosMultipleTitleFormat)},canceled:{title:P(d.failedRemoveAsCoverPhotosSingleTitleFormat,d.failedRemoveAsCoverPhotosMultipleTitleFormat)}}},createAlbumFromFolder:{title:c(d.startedCreateAlbumFromFolderSingleTitleFormat,w("context.payloads().createAlbumFromFolder.folder")),states:{completed:{title:c(d.completedCreateAlbumFromFolderSingleTitleFormat,w("context.payloads().createAlbumFromFolder.album"))},failed:{title:c(d.failedCreateAlbumFromFolderSingleTitleFormat,w("context.payloads().createAlbumFromFolder.folder"))}}},createColumn:{title:V(d.startedCreateColumnSingleTitleFormat),shortTitle:d.startedCreateColumnSingleShortTitle,states:{completed:{title:V(d.completedCreateColumnSingleTitleFormat)},failed:{title:V(d.failedCreateColumnSingleTitleFormat)}}},editColumn:{title:O(d.startedEditColumnSingleTitleFormat),shortTitle:d.startedEditColumnSingleShortTitle,states:{completed:{title:O(d.completedEditColumnSingleTitleFormat)},failed:{title:O(d.failedEditColumnSingleTitleFormat)}}},deleteColumn:{title:E(d.startedDeleteColumnSingleTitleFormat),shortTitle:d.startedDeleteColumnSingleShortTitle,states:{completed:{title:E(d.completedDeleteColumnSingleTitleFormat)},failed:{title:E(d.failedDeleteColumnSingleTitleFormat)}}},createAlbum:{title:R(d.addToAlbumSingleTitleFormat,d.addToAlbumMultipleTitleFormat,w("context.payloads().createAlbum.album")),shortTitle:R(d.startedAddToAlbumSingleShortTitleFormat,d.startedAddToAlbumMultipleShortTitleFormat),states:{completed:{title:function(e){return M(e.payloads().createAlbum.album().childCount,d.completedAddToAlbumSingleTitleFormat,d.completedAddToAlbumMultipleTitleFormat,w("context.payloads().createAlbum.album"))}},failed:{title:A(d.failedAddToAlbumSingleTitleFormat,d.failedAddToAlbumMultipleTitleFormat)},canceled:{title:P(d.failedAddToAlbumSingleTitleFormat,d.failedAddToAlbumMultipleTitleFormat)}}},checkInItem:{title:c(d.checkInItemTitleFormat,w("context.payloads().checkInItem.parent")),states:{}},checkOutItem:{title:c(d.checkOutItemTitleFormat,w("context.payloads().checkOutItem.parent")),states:{}},undoCheckOutItem:{title:c(d.undoCheckOutItemTitleFormat,w("context.payloads().undoCheckOutItem.parent")),states:{}},publishItem:{title:c(d.publishItemTitleFormat,w("context.payloads().publishItem.parent")),states:{}},makeHomepage:{title:d.MakeHomepageProgress,states:{completed:{title:d.MakeHomepageCompleted},failed:{title:d.MakeHomepageError}}},setupApprovalFlow:{title:d.SetUpApprovalFlow,states:{completed:{title:d.SetUpApprovalFlowCompleted},failed:{title:d.SetUpApprovalFlowFailure}}},setupReminderFlow:{title:function(e){return c(d.ReminderFlowCreationInProgressFormat,e.payloads().createReminderFlow.dateColumnName)},states:{completed:{title:function(e){return c(d.ReminderFlowCreationSuccessFormat,e.payloads().createReminderFlow.dateColumnName)}},failed:{title:function(e){return c(d.ReminderFlowCreationFailureFormat,e.payloads().createReminderFlow.dateColumnName)}}}},unPublishItem:{title:c(d.unPublishItemTitleFormat,w("context.payloads().unPublishItem.parent")),states:{}},shareItem:{title:k,states:{started:{title:k},completed:{description:C,title:k},failed:{description:C}}},createFolder:{title:c(d.createFolderTitleFormat,w("context.payloads().createFolder.parent")),states:{}},updateBundle:{title:c(d.updateBundle,w("context.payloads().updateBundle.item")),states:{}},setAlbumCoverPhoto:{title:c(d.setCoverPhotoTitleFormat,w("context.payloads().setAlbumCoverPhoto.album")),states:{completed:{title:c(d.completedSetCoverPhotoTitleFormat,w("context.payloads().setAlbumCoverPhoto.album"))},failed:{title:c(d.failedSetCoverPhotoTitleFormat,w("context.payloads().setAlbumCoverPhoto.album"))}}},uploadVideos:{title:function(e){return M(F(e),d.uploadSingleTitleFormat,d.uploadMultipleTitleFormat,l.default.encodeText(e.payloads().uploadItems.parent.name))},states:{started:{description:m},completed:{title:function(e){return M(e.states().completed,d.completedUploadSingleTitleFormat,d.completedUploadMultipleTitleFormat,l.default.encodeText(e.payloads().uploadItems.parent.name))}},failed:{title:A(d.failedUploadSingleTitleFormat,d.failedUploadMultipleTitleFormat),description:I},canceled:{title:P(d.failedAddToAlbumSingleTitleFormat,d.failedAddToAlbumMultipleTitleFormat)}}},saveItem:{title:L(d.saveTitleFormat),shortTitle:L(d.saveTitleFormat),states:{started:{description:m},completed:{title:L(d.completedSaveTitleFormat)},failed:{title:L(d.failedSaveTitleFormat),description:y(S)},canceled:{title:L(d.failedSaveTitleFormat)}},actions:{cancel:{mode:3}}},createItem:{title:L(d.createItemTitleFormat),shortTitle:L(d.createItemTitleFormat),states:{started:{description:m},completed:{title:L(d.completedCreateItemTitleFormat)},failed:{title:L(d.failedCreateItemTitleFormat),description:y(T)},canceled:{title:L(d.failedCreateItemTitleFormat)}},actions:{cancel:{mode:3}}},updateMetadata:{title:R(d.updateSingleTitleFormat,d.updateMultipleTitleFormat),shortTitle:R(d.startedUpdateSingleShortTitleFormat,d.startedUpdateMultipleShortTitleFormat),states:{completed:{title:D(d.completedUpdateSingleShortTitleFormat,d.completedUpdateMultipleShortTitleFormat)},failed:{title:A(d.failedUpdateSingleTitleFormat,d.failedUpdateMultipleTitleFormat)},canceled:{title:P(d.failedUpdateSingleTitleFormat,d.failedUpdateMultipleTitleFormat)}}},createFlow:{title:function(e){return l.default.encodeText(e.payloads().createFlow.successMessage)},states:{}},triggerFlow:{title:B(d.TriggerFlowStarting),shortTitle:B(d.TriggerFlowStarting),states:{created:{title:B(d.TriggerFlowInitializing)},started:{title:B(d.TriggerFlowStarting)},completed:{title:B(d.TriggerFlowStarted)},failed:{title:B(d.TriggerFlowError)}}},saveAutoAlbum:{title:c(d.saveAutoAlbumTitleFormat,w("context.payloads().saveAutoAlbum.album")),states:{completed:{title:c(d.completedSaveAutoAlbumTitleFormat,w("context.payloads().saveAutoAlbum.album"))},failed:{title:c(d.failedSaveAutoAlbumTitleFormat,w("context.payloads().saveAutoAlbum.album"))}}},discardAutoAlbum:{title:c(d.discardAutoAlbumTitleFormat,w("context.payloads().discardAutoAlbum.album")),states:{completed:{title:c(d.completedDiscardAutoAlbumTitleFormat,w("context.payloads().discardAutoAlbum.album"))},failed:{title:c(d.failedDiscardAutoAlbumTitleFormat,w("context.payloads().discardAutoAlbum.album"))}}},removeFromSharedList:{title:R(d.startedRemovalSharedSingleTitleFormat,d.startedRemovalSharedMultipleTitleFormat),states:{completed:{title:D(d.completedRemovalSharedSingleTitleFormat,d.completedRemovalSharedMultipleTitleFormat)},failed:{title:A(d.failedRemovalSharedSingleTitleFormat,d.failedRemovalSharedMultipleTitleFormat)}}}},actions:{cancel:{name:d.cancelActionText,icon:new a.default("Cancel")},close:{name:d.closeActionText,icon:new a.default("Cancel"),mode:1},overwrite:{name:U(d.overwriteSingleActionText,d.overwriteMultipleActionText)},restart:{name:d.restartActionText},undo:{name:U(d.undoSingleActionText,d.undoMultipleActionText)},rename:{name:U(d.renameSingleActionText,d.renameMultipleActionText)},moveAnyway:{name:d.moveAnywayButtonText},moveAnywaySchemaMismatch:{name:U(d.moveAnywaySingleActionText,d.moveAnywayMultipleActionText)},moveAnywayVersionLimit:{name:U(d.moveAnywaySingleActionText,d.moveAnywayMultipleActionText)},deleteLocked:{name:U(d.deleteSingleActionText,d.deleteMultipleActionText)},moveLockedFile:{name:d.moveAnywayButtonText},compare:{name:d.compareActionText},hipCheck:{name:d.hipCheckActionText},verifyAccount:{name:d.verifyAccountActionText}}};t.default=G});define("@ms/odsp-utilities/lib/string/DriveSpaceHelper",["require","exports","@ms/items-view-utilities/lib/string/DriveSpaceHelper.resx","../locale/Locale"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=1073741824,s=1.2.toLocaleString(i.default.language).replace(/\d+/g,""),l=/\.?0+$/;!function(e){(n||(n={})).getDisplayString=function(e,t){void 0===t&&(t={});if("number"!=typeof e||isNaN(e)||t.ignoreZero&&0===e||e<0)return"";var i=t.trimDecimal;return 1===e?r.default.fileSizeBytesSingular:e<1024?o(r.default.fileSizeBytesPlural,e,i):e<1024e3?o(r.default.fileSizeKB,e/1024,i):e<1048576e3?o(r.default.fileSizeMB,e/1048576,i):e<1e3*a?o(r.default.fileSizeGB,e/a,i):o(r.default.fileSizeTB,e/1099511627776,i)};function o(e,t,i){return e.replace("{0}",function(e,t){if(100<=e||e===Math.floor(e))return e.toFixed(0);var i=e.toFixed(10<=e?1:2);return(t?i.replace(l,""):i).replace(".",s)}(t,i))}}();t.default=n});define("odsp-next/controls/itemLink/ItemLink",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemLinkViewModel","./ItemLink.html"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-item-link",template:e("./ItemLink.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/itemLink/ItemLinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../models/item/Item.resx"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._item=t.wrapObservable(e.item);t.name=t.createPureComputed(t._computeName);var i=t.resources.consume(r.actionMap);t.open=new(t.managed(i.OpenAction))({openRelation:2,item:t._item});return t}e.prototype.execute=function(e,t){if(e.isAvailable()){e.execute(t).done();return!1}};e.prototype._computeName=function(){var e=this._item();return e&&(e.displayName||e.name)||n.strings.fileTypeFolder.toLocaleLowerCase()};return e}(o.default);t.default=a});define("odsp-next/controls/itemLink/ItemLink.html",[],function(){return'\x3c!--ko with: open--\x3e\x3c!--ko if: isAvailable--\x3e<a class=od-ItemLink href=# data-bind="click: $component.execute.bind($component), text: $component.name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: isAvailable--\x3e<span class=od-ItemLink data-bind="text: $component.name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("@ms/odsp-utilities/lib/encoding/HtmlEncoding",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=/[<>&'"\\]/g,o={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function r(e){return o[e]}var n=function(){function e(){}e.encodeText=function(e){return e?e.replace(i,r):""};return e}();t.default=n});define("@ms/odsp-shared/lib/utilities/knockout/Renderers",["require","exports","knockout"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderText=function(e,t){var i=document.createElement("div");i.innerHTML=t;r.applyBindings(e,i);var o=i.textContent;r.cleanNode(i);return o}});define("odsp-next/pages/files/FilesCommandSetHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../../controls/commands/Commands.resx","../../controls/list/layouts/LayoutType","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/icons/OfficeFileNameHelper","../../utilities/selection/SelectionHelper","../../utilities/icons/Icon"],function(e,t,o,i,r,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){o.__extends(t,i);function t(e){var t=i.call(this,e)||this;t.selection=t.resources.consume(r.itemsSelection);t.showLabels=e.showLabels;t.layoutType=t.resources.consume(n.files.layoutType);return t}t.prototype.showSelectionActionText=function(){var e=this.selection&&this.selection.selection().length||0;return this.showLabels()?l.format(a.strings.NumberSelected,e):e.toString()};t.prototype.computeOpenInOfficeOnlineText=function(){return d.getOfficeOnlineStringMap(c.getSelectedItemApp(this.selection))||a.strings.Open};t.prototype.computeOpenInOfficeClientText=function(){return d.getOfficeStringMap(c.getSelectedItemApp(this.selection))};t.prototype.computeOfficeIcon=function(){var e,t=c.getSelectedItemApp(this.selection);t&&(e=d.getOfficeIconMap(t));return e||new u.default("Page")};t.prototype.computeOfficeClass=function(){return d.getAppName(c.getSelectedItemApp(this.selection))};t.prototype.computeViewSelectorIcon=function(){return new u.default(this.computeViewSelectorIconName())};t.prototype.computeViewSelectorIconName=function(){var e=this.layoutType();return e===s.SingleAlbum?t.singleAlbumIcon:e===s.CompactDetails?t.compactDetailsIcon:e===s.Grid||e===s.CustomGridList?t.gridIcon:t.detailsIcon};t.compactDetailsIcon="AlignLeft";t.detailsIcon="List";t.gridIcon="ViewAll";t.tilesIcon="Tiles";t.singleAlbumIcon="LargeGrid";return t}(i.default);t.default=p});define("odsp-next/controls/itemContent/folder/FolderItemContent",["require","exports","./FolderItemContentViewModel","../../../bindings/component/ControlBinding","./FolderItemContent.html","../ItemContent.css","../../list/CompactDetailsList","../../list/DetailsList","../../list/GridList"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-folder-item-content",template:e("./FolderItemContent.html"),viewModelType:i.default})});define("odsp-next/controls/itemContent/folder/FolderItemContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../emptyFolder/EmptyFolder","../../../bindings/component/ControlBinding","../../breadcrumbBar/BreadcrumbBar","../../folderSharedIndicator/FolderSharedIndicator","../../../models/itemSet/ItemSetMonitor","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../../models/item/SharingType","../../../actions/toggleListLayout/ToggleListLayoutHelper","../../../utilities/features/Features"],function(e,t,i,o,a,s,l,d,c,u,p,m,h,f,r,g,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this;i.addBindingHandlers({control:d.default});i._urlDataSource=i.resources.consume(h.url);i.breadcrumbBarTagName=c.default.tagName;i.emptyFolderControl=d.toSpecification(l.resourceKey,{isViewOnly:i.createPureComputed(i._computeIsViewOnly,{deferEvaluation:!0})});i.isQuotaBarVisible=i.createObservable(!1);var o=i.resources.consume(a.actionMap);i._uploadAction=new(i.managed(o.UploadAction))({uploadProcessorType:m.UploadProcessorType.Html5file});i.sharedIndicatorTagName=u.default.tagName;i.isShowSharedIndicator=i.createPureComputed(i._computeIsShowSharedIndicator);i._itemSetMonitor=i.resources.consume(p.resourceKey);i.footerItem=e.footerItem;i.itemSet=i._itemSetMonitor.itemSet;i.itemSetSelectionModel=i.resources.consume(a.itemsSelection);i.contentRange=i.resources.consume(s.contentRange);i.layoutType=i.resources.consume(g.resolvedLayoutTypeResourceKey);i.listViewContextMenuHelper=i.resources.isExposed(s.listViewContextMenuHelper)?i.resources.consume(s.listViewContextMenuHelper):void 0;i.title=i._itemSetMonitor.name;i.showBreadcrumb=i._itemSetMonitor.hasParent;i.showEmpty=i._itemSetMonitor.isEmpty;i.showList=i.observables.pureCompute(i._computeShowList);i.item=i._itemSetMonitor.item;i.showTitle=i.createPureComputed(i._computeShowTitle,{deferEvaluation:!0});var r=i.resources.consume(f.bundleLoader);i.createComputed(function(){var e=r&&r.getBundleInfo(3);e&&e.isLoaded()&&(i.itemSet()&&i._urlDataSource.isSearchPassThrough()?i.isQuotaBarVisible(!0):i.isQuotaBarVisible(!1))});return i}e.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()};e.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()};e.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()};e.prototype._computeIsShowSharedIndicator=function(){if(b.isFeatureEnabled(b.EnableFolderShareAccessHint)){var e=this.item().sharingType;return e===r.default.Shared||e===r.default.Public||e===r.default.PublicUnlisted}return!1};return e}(o.default);t.default=n});define("odsp-next/controls/emptyFolder/EmptyFolder",["require","exports","./EmptyFolderViewModel","../../bindings/component/ControlBinding","./EmptyFolder.html","./EmptyFolder.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-empty-folder",name:e("module").id,template:e("./EmptyFolder.html"),viewModelType:i.default});t.default=t.resourceKey});define("odsp-next/controls/emptyFolder/EmptyFolderViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../bindings/html/BindableHtmlBinding","./EmptyFolder.resx","../../utilities/features/Features","../../dataSources/url/PageType","../../dataSources/url/QueryType"],function(s,e,t,i,l,o,a,d,c,u,p,m,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g='<i class="EmptyFolder-icon '+i.getIconClassName("Add")+'" ></i>',r=function(n){t.__extends(e,n);function e(e,t){void 0===e&&(e={});var i=n.call(this,e,t)||this;i.addBindingHandlers({bindableHtml:u.default});var o=i.observables,r=i.resources;i.isDocLib=!0;i._urlDataSource=r.consume(d.url);i._content=o.pureCompute(i._computeContent);i._currentPage=i._urlDataSource.getPageType();i._isViewOnly=e.isViewOnly;i._item=r.consume(a.currentItem);r.consumeAsync(d.rootItems.optional).then(function(e){i._rootItems=e});r.isExposed(c.userInfo)&&(i._userInfoProvider=r.consume(c.userInfo));i._viewParams=r.consume(a.viewParams);i._recentDocsNavigationAction=new(i.managed(t.actionMap.NavigationAction))({target:"blank",url:o.pureCompute(function(){var e=o.unwrap(i._rootItems&&i._rootItems()&&i._rootItems().recent);return e&&i._urlDataSource.getDefaultClickUrl(e)})});i.altText=o.pureCompute(function(){return i._content().altText||""});i.subText=o.pureCompute(function(){return i._content().subText});i.subTextMobile=o.pureCompute(function(){return i._content().subTextMobile||i._content().subText});i.subTextPostIcon=o.pureCompute(function(){return i._content().subTextPostIcon});i.title=o.pureCompute(function(){return i._content().title});i.url=o.pureCompute(function(){return i._content().url});return i}e.prototype.navigateToRecentDocs=function(){this._recentDocsNavigationAction.execute(null)};e.prototype.hasInsertPermission=function(){return!this.observables.unwrap(this._isViewOnly)};e.prototype.emptyFolderSubText=function(){return p.strings.emptyFolderSubText};e.prototype.hasSmartFiltersApplied=function(){return!1};e.prototype._computeContent=function(){var e,t=this._item(),i=t.queryType,o=this.hasInsertPermission();switch(i){case f.default.Recent:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_recent.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_recent.svg"),title:p.strings.emptyRecentTitle,subText:p.strings.emptyRecentSubText};break;case f.default.RecycleBin:case f.default.SecondStageRecycleBin:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_recyclebin.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_recyclebin.svg"),title:p.strings.emptyRecycleBinTitle,subText:p.strings.emptyRecycleBinSubText};break;case f.default.Search:var r=void 0;r=this._currentPage===h.default.Photos?p.strings.emptyPhotosSearchSubText:this.isDocLib?l.format(p.strings.emptySearchSubText,'<a class="EmptyFolder-subTextPart2 EmptyFolder-subTextPart2Link" data-bind="click: navigateToRecentDocs">',"</a>"):p.strings.emptyListSearchSubText;e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_search.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_search.svg"),title:p.strings.emptySearchTitle,subText:r};break;case f.default.SharedWithMe:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_shared.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_shared.svg"),title:p.strings.emptySharedTitle,subText:p.strings.emptySharedSubText};break;case f.default.DocsInCommon:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_shared.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_shared.svg"),title:p.strings.emptyDocsInCommonTitle,subText:p.strings.emptyDocsInCommonSubText};break;case f.default.Subsites:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_sites.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_sites.svg"),title:p.strings.emptySubsitesTitle,subText:""};break;case f.default.Discover:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_discover.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_discover.svg"),title:p.strings.emptyDiscoverTitle,subText:""};break;case f.default.Apps:e=this._getSearchContentOrDefault(p.strings.emptyAppsTitle);break;case f.default.Popular:e=this._getSearchContentOrDefault(p.strings.emptyPopularTitle);break;case f.default.ExternallyShared:e=this._getSearchContentOrDefault(p.strings.emptyExternallySharedTitle);break;case f.default.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:for(var n=!1;t&&t.parent;){"Music"===t.specialFolderCanonicalName&&(n=!0);t=t.parent}if(n){e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_music.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_music.svg"),title:p.strings.emptyMusicFolderTitle,subText:o&&p.strings.emptyMusicFolderSubText||"",subTextMobile:o&&l.format(p.strings.emptyMusicFolderMobileSubText,g)||""};if(this._userInfoProvider){var a=this._userInfoProvider.getMarket();a=a&&a.toLowerCase();if(!m.isFeatureEnabled(m.EnableAudioPlayer)&&this._isGrooveAvailable(a)){e.title=p.strings.emptyGrooveMusicFolderTitle;e.subText=o&&p.strings.emptyGrooveMusicFolderSubText||""}}break}if(this.hasSmartFiltersApplied()){e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_filter.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_filter.svg"),title:p.strings.emptyFilterResultTitle,subText:p.strings.emptyFilterResultSubText,altText:p.strings.emptyFilterResultAltText};break}e=this._item().isRootFolder&&!this.isDocLib?{url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_list.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_list.svg"),title:p.strings.emptyListTitle,subText:p.strings.emptyListSubText,altText:p.strings.emptyListDefaultAltText}:{url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_folder.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_folder.svg"),title:this._item().isRootFolder?p.strings.emptyLibraryTitle:p.strings.emptyFolderTitle,subText:o&&this.emptyFolderSubText()||"",subTextMobile:o&&l.format(p.strings.emptyFolderMobileSubText,g)}}e.altText||(e.altText=p.strings.emptyFolderDefaultAltText);return e};e.prototype._getSearchContentOrDefault=function(e){return this._viewParams().q?{url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_search.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_search.svg"),title:p.strings.emptySearchTitle,subText:""}:{title:e,url:"",subText:""}};e.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case 5:case 1:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_album_albumsview.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_album_albumsview.svg"),title:p.strings.emptyAlbumsListTitle,subText:p.strings.emptyAlbumsListSubText};break;case 2:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_tags.svg"),title:p.strings.emptyPhotosTagsTitle,subText:l.format(p.strings.emptyPhotosTagsSubTextFormat,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case 3:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_places.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_places.svg"),title:p.strings.emptyAllPhotosTitle,subText:""};break;case 9:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_onthisday.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_onthisday.svg"),title:p.strings.emptyOnThisDayTitle,subText:""};break;default:e={url:"undefined"==typeof __webpack_public_path__?s.toUrl("odsp-media/images/emptyfolder/empty_allphotosview.svg"):s("@ms/odsp-media/dist/media/images/emptyFolder/empty_allphotosview.svg"),title:p.strings.emptyAllPhotosTitle,subText:""}}return e};e.prototype._isGrooveAvailable=function(e){var t=e.split("-")[1]||e;return-1<["ar","au","at","be","br","ca","dk","fi","fr","de","ie","it","mx","nl","nz","no","pt","es","se","ch","gb","us"].indexOf(t)};e.dependencies=t.__assign({},o.default.dependencies,{actionMap:a.actionMap});return e}(o.default);e.default=r});define("odsp-next/bindings/html/BindableHtmlBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.controlsDescendantBindings=!0;t.createComputed(t._computeRefreshChildElements);return t}e.prototype._computeRefreshChildElements=function(){var e=r.unwrap(this.valueAccessor());r.virtualElements.emptyNode(this.element);this.element.innerHTML=e;r.applyBindingsToDescendants(this.bindingContext,this.element)};return e}(i.default);t.default=n});define("odsp-next/controls/emptyFolder/EmptyFolder.html",[],function(){return'<div class=EmptyFolder>\x3c!--ko if: url--\x3e<div class=EmptyFolder-image><img id=emptyFolderImg class=EmptyFolder-imageTag data-bind="attr: { src: url, alt: altText }"></div>\x3c!--/ko--\x3e<div role=alert><div class=EmptyFolder-title data-bind="text: title"></div>\x3c!--ko if: subText || subTextMobile--\x3e<div class=EmptyFolder-subText><span class=EmptyFolder-pc data-bind="bindableHtml: subText"></span> <span class=EmptyFolder-mobile data-bind="bindableHtml: subTextMobile"></span></div>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/emptyFolder/EmptyFolder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".EmptyFolder{text-align:center}.EmptyFolder-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.EmptyFolder-image .EmptyFolder-imageTag{height:208px;width:auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-size:17px;font-weight:300}.EmptyFolder-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .EmptyFolder-subText{padding:6px 16px 0 16px}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}"}])});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar",["require","exports","./BreadcrumbBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./BreadcrumbBar.html","./BreadcrumbBar.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-breadcrumb-bar",template:e("./BreadcrumbBar.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/breadcrumbBar/BreadcrumbBarViewModel",["require","exports","tslib","knockout","../commands/CommandViewModel","../../bindings/dismiss/DismissBinding","../../bindings/dragAndDrop/DragAndDropBinding","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/math/Point","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../actions/NavigationAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/icons/Icon","../../bindings/keyboard/KeyboardBinding","../../resources/ControlResourceKeys","../leftPane/LeftPane.resx","./BreadcrumbBar.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,i,d,o,s,l,c,u,p,r,n,m,h,f,g,b,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._currentDroppingCrumb=null;t.addBindingHandlers({dismiss:s.default,dragAndDrop:l.default,keyboard:f.default});var i=e.iconClass,o=void 0===i?new h.default("More").getClass():i,r=e.canShowTooltipOverflow,n=void 0!==r&&r;t._responsiveUI=t.resources.consume(p.resourceKey);t._navigation=t.resources.consume(m.navigation);t.overflowMenuAriaLabel=v.strings.overflowAriaLabel;t.iconClass=o;t._item=e.item;t._maxFoldersVisibleLgUp=e.maxFoldersVisibleLgUp;t._maxFoldersVisibleMdDown=e.maxFoldersVisibleMdDown;t.isDroppable=d.observable(!0);t.isDroppingTarget=d.observable(!1);t.isOverflowOpen=d.observable(!1);t.overflowMenuOffset=d.observable(new u.default(-24,24));t.ariaLabelForBreadCrumbBar=d.observable("");t._openActionItem=d.observable(null);t.overflowCrumbs=d.observableArray();t.mouseOverTrigger=t.createObservable(!1);t._canShowTooltipOverflow=n;t._crumbs=e.crumbs;t._actionMap=t.resources.consume(g.actionMap);t._openAction=new(t.managed(t._actionMap.OpenAction))({item:t._openActionItem,openRelation:2});t.overflowDismissParams={isOpen:t.isOverflowOpen,isAutomatic:t._canShowTooltipOverflow,timeout:100};t._dropHelper=t.resources.consume(c.resourceKey);t.crumbs=t.createComputed(function(){return t._computeCrumbs(e.getCrumbs)});return t}e.prototype.dispose=function(){a.prototype.dispose.call(this);this.crumbs.dispose()};e.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)};e.prototype.onMayReceiveDrop=function(e,t){var i=t?d.dataFor(t):null;if(i&&i.item&&i.showNextChevron){this.onRemoveDropLocation();this._currentDroppingCrumb=i;this._currentDroppingCrumb.isDroppingTarget(!0);return{targetName:i.item.name}}this.onRemoveDropLocation();return null};e.prototype.onReceiveDrop=function(e,t){var i=t?d.dataFor(t):null,o=this._dropHelper.processDrop(e,i.item);o&&this.onRemoveDropLocation();return o};e.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)};e.prototype.onEnter=function(e,t){t.stopPropagation()};e.prototype.onClick=function(e,t){if(e.onClick)e.onClick(e,t);else if(e.isOverflow)this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen());else if(e.item&&!e.isFiltered){this._openActionItem(e.item);this._openAction.execute(t)}else{this._navigation.navigateTo(e.url)}e&&this.ariaLabelForBreadCrumbBar(y.format(v.strings.breadCrumbNavigation,e.ariaLabel))};e.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,i=[],o=[],r=this._responsiveUI;t=r.compareSize(r.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var n=this._item(),a=[];this._crumbs?a=this._crumbs():n&&n.key&&(e?a=e(n):n.parent&&(a=this._getCrumbsForNonRoots(n)));for(var s=0;s<a.length;s++)i.length<t?i.unshift(a[s]):o.unshift(this._commandForCrumb(a[s]));o.length&&i.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""});this.overflowCrumbs().forEach(function(e){e.dispose()});this.overflowCrumbs(o);i&&0<i.length?this.ariaLabelForBreadCrumbBar(y.format(v.strings.breadCrumbNavigation,i[i.length-1].ariaLabel)):n&&n.key&&this.ariaLabelForBreadCrumbBar(y.format(v.strings.breadCrumbNavigation,n.name));return i};e.prototype._getCrumbsForNonRoots=function(e){for(var t=[],i=!1,o=this._getAriaLabelsForBreadCrumbs(e);e;){var r=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),n=r.isAvailable.peek();r.dispose();var a=i,s=!i;n||(s=!(a=!1));e.isStub&&(s=!(a=!1));var l={key:e.key,url:"#"+e.key,name:e.name||b.strings.Files,showNextChevron:i,isDroppingTarget:d.observable(!1),item:e,isOverflow:!1,isNavItem:a,isStaticItem:s,ariaLabel:o.pop()};t.push(l);i=!0;e=e.parent}return t};e.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],i=void 0;e;){if(i){i=y.format(v.strings.breadCrumbItem,i,e.name||b.strings.Files);t.push(i)}else{i=e.name||b.strings.Files;e.parent&&t.push(e.parent.name)}e=e.parent}return t};e.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(o.default))({text:e.name,action:new(this.managed(n.default))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})};return e}(r.default);t.default=a});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.html",[],function(){return'<nav class=BreadcrumbBar data-bind="attr: { \'aria-label\': ariaLabelForBreadCrumbBar }"><ul class=BreadcrumbBar-list role=menu data-bind="foreach: crumbs, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"><li>\x3c!--ko if: isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href=javascript:; aria-haspopup=true role=menuitem data-bind="click: $component.onClick.bind($component), dismiss: $component.overflowDismissParams, attr: { \'aria-expanded\': $component.isOverflowOpen(), \'aria-label\': $component.overflowMenuAriaLabel }, keyboard: { mappings: { \'Enter\': $component.onEnter.bind($component) } }, class: $component.iconClass, event: { mouseover: $component.onOverflowMouseover.bind($parent) }">\x3c!--ko if: $parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if: isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" role=menuitem data-bind="text: name, click: $component.onClick.bind($component), keyboard: { mappings: { \'Enter\': $component.onEnter.bind($component) } }, attr: { href: url, title: name }, css: { dropping: isDroppingTarget }"></a>\x3c!--/ko--\x3e\x3c!--ko if: isStaticItem--\x3e<span class=BreadcrumbBar-item data-bind="text: name, attr: { title: name }"></span>\x3c!--/ko--\x3e\x3c!--ko if: showNextChevron--\x3e<i class=BreadcrumbBar-item-chevron role=presentation></i>\x3c!--/ko--\x3e</li></ul></nav>'});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar,.xxxxlg .BreadcrumbBar{margin-top:7px}.BreadcrumbBar-list{display:block;margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.isFluent .BreadcrumbBar-list li:last-child .BreadcrumbBar-item{font-weight:600;color:#323130}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:8px 4px;cursor:pointer}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:8px 8px}.BreadcrumbBar-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" inset}.BreadcrumbBar-navItem:active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}a.BreadcrumbBar-item{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.isFluent a.BreadcrumbBar-item{color:#605e5c}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-size:17px;font-weight:300}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:21px;font-weight:100;padding-bottom:1px;line-height:28px}.isFluent.xlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px}.isFluent.xxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px}.isFluent.xxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px}.isFluent.xxxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";vertical-align:top;padding:0 2px;margin-top:11px}.isFluent .BreadcrumbBar-item-chevron{color:#605e5c}.lg .BreadcrumbBar-item-chevron{margin-top:13px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{font-size:12px;margin-top:11px;padding:0 4px}.isFluent.xlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76c'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76b'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:21px;font-weight:100}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:28px;font-weight:100;line-height:1}"}])});define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicator",["require","exports","./FolderSharedIndicatorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderSharedIndicator.html","./FolderSharedIndicator.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"folder-shared-indicator",template:e("./FolderSharedIndicator.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicatorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","./FolderSharedIndicator.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/tooltip/TooltipBinding","../../bindings/keyboard/KeyboardBinding"],function(e,t,o,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({tooltip:l.default,keyboard:d.default});t.item=e.item;t._actionMap=t.resources.consume(r.actionMap);t._showPermissionsAction=new(t.managed(t._actionMap.ShowPermissionsAction))({item:t.item,engagementSource:"GlyphClick"});t.sharedTooltip=a.strings.folderIsShared;t.sharedWithSomeIcon=a.strings.sharedWithSomeIcon;t.sharedAriaLabel=t._getSharedGlyphAriaLabel();return t}e.prototype.onSharedIconClick=function(e,t){n.Engagement.logData({name:"folderSharedIndicatorClicked"});this._showPermissionsAction.execute(t).done()};e.prototype._getSharedGlyphAriaLabel=function(){return s.format(a.strings.ariabelForSharedGlyph,this.item().name)};return e}(i.default);t.default=c});define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicator.html",[],function(){return'<button class="od-ItemContent-metadata od-ItemContent-metadata-button" data-bind="attr: { \'aria-label\': sharedAriaLabel }, tooltip: { content: sharedTooltip }, click: onSharedIconClick"><i class="ms-Icon ms-Icon--People" data-bind="icon: true, attr: { alt: sharedWithSomeIcon }"></i></button>'});define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicator.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".lg .od-ItemContent-metadata,.md .od-ItemContent-metadata,.sm .od-ItemContent-metadata{font-size:14px}.xlg .od-ItemContent-metadata,.xxlg .od-ItemContent-metadata,.xxxlg .od-ItemContent-metadata,.xxxxlg .od-ItemContent-metadata{font-size:16px}.od-ItemContent-metadata-button{cursor:pointer;border-width:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-left:0;padding-right:0}.od-ItemContent-metadata-button i{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("odsp-next/controls/itemContent/folder/FolderItemContent.html",[],function(){return'<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if: showTitle() || showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if: showTitle--\x3e<h2 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text: title"></h2>\x3c!--/ko--\x3e\x3c!--ko if: showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component: { name: breadcrumbBarTagName, params: { item: item } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: isShowSharedIndicator--\x3e<div class=od-ItemContent-header-sharedIndicator data-bind="component: { name: sharedIndicatorTagName, params: { item: item } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: isQuotaBarVisible--\x3e<div class=od-ItemContent-progress data-bind="component: { name: \'od-quota-progress-bar\' }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component: { name: layoutType, params: { itemSet: itemSet, selectionModel: itemSetSelectionModel, requiredRange: contentRange, enableMarqueeSelection: true, contextMenuHelper: listViewContextMenuHelper, footerItem: footerItem } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control: emptyFolderControl"></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/itemContent/ItemContent.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemContent-header{box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;-ms-flex-align:end;align-items:flex-end;padding-top:10px;padding-bottom:10px}.xlg .od-ItemContent-header,.xxlg .od-ItemContent-header,.xxxlg .od-ItemContent-header,.xxxxlg .od-ItemContent-header{padding-top:23px;padding-bottom:0}.od-ItemContent-progress{height:31px;padding-top:10px;padding-bottom:10px}[dir=ltr] .od-ItemContent-progress{padding-left:32px}[dir=rtl] .od-ItemContent-progress{padding-right:32px}[dir=ltr] .od-ItemContent-progress{padding-right:32px}[dir=rtl] .od-ItemContent-progress{padding-left:32px}[dir=ltr] .md .od-ItemContent-progress,[dir=ltr] .sm .od-ItemContent-progress{padding-left:16px}[dir=rtl] .md .od-ItemContent-progress,[dir=rtl] .sm .od-ItemContent-progress{padding-right:16px}[dir=ltr] .md .od-ItemContent-progress,[dir=ltr] .sm .od-ItemContent-progress{padding-right:16px}[dir=rtl] .md .od-ItemContent-progress,[dir=rtl] .sm .od-ItemContent-progress{padding-left:16px}.od-ItemContent-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:21px;font-weight:100}.lg .od-ItemContent-title,.md .od-ItemContent-title,.sm .od-ItemContent-title{font-weight:300}.xlg .od-ItemContent-title,.xxlg .od-ItemContent-title,.xxxlg .od-ItemContent-title,.xxxxlg .od-ItemContent-title{font-size:28px;font-weight:100}.od-ItemContent-breadcrumb{font-size:17px;font-weight:300}.md .od-ItemContent-breadcrumb,.sm .od-ItemContent-breadcrumb{font-size:14px;font-weight:400}.xlg .od-ItemContent-breadcrumb,.xxlg .od-ItemContent-breadcrumb,.xxxlg .od-ItemContent-breadcrumb,.xxxxlg .od-ItemContent-breadcrumb{font-size:21px;font-weight:100;margin-bottom:1px}.xlg .od-ItemContent-list,.xxlg .od-ItemContent-list,.xxxlg .od-ItemContent-list,.xxxxlg .od-ItemContent-list{padding-top:20px}[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-left:32px}[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-right:32px}[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-right:32px}[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-left:32px}[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-left:16px}[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-right:16px}[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-right:16px}[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-left:16px}.od-ItemContent-header-sharedIndicator{display:inline-block;position:relative;padding:0}.od-ItemContent-header-sharedIndicator .od-ItemContent-metadata{padding-bottom:3px;margin:0}"}])});define("odsp-next/controls/list/CompactDetailsList",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","./List.css"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r.createComponent("ms-compact-details-list","odsp-next/controls/list/react/detailsList/ReactDetailsList",function(){return new t.default(function(e,t){i(["odsp-next/controls/list/react/detailsList/ReactDetailsList"],e,t)})},{isCompact:!0});o.components.isRegistered(n.tagName)||o.components.register(n.tagName,n);e.default=n});define("odsp-next/controls/list/List.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".List{position:relative;display:block}.List .List-surface{position:relative;min-height:1px}.List .List-surface:focus{outline:0}.List .List-page{position:relative}.List .List-cell{position:absolute;display:inline-block}.List .List-placeHolder{width:1px;position:absolute;visibility:hidden}"}])});define("odsp-next/controls/list/DetailsList",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","./List.css"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r.createComponent("ms-details-list","odsp-next/controls/list/react/detailsList/ReactDetailsList",function(){return new t.default(function(e,t){i(["odsp-next/controls/list/react/detailsList/ReactDetailsList"],e,t)})});o.components.isRegistered(n.tagName)||o.components.register(n.tagName,n);e.default=n});define("odsp-next/controls/list/GridList",["require","exports","knockout","./viewModels/GridListViewModel","@ms/odsp-utilities/lib/async/Promise","../../utilities/features/Features","../reactHost/ReactHost","./List.html","./List.css","../itemTile/ItemTile"],function(i,e,t,o,r,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=window._spPageContextInfo,l=!s||"21"===s.webTemplate,d=n.isFeatureEnabled(n.UseReactGridList)&&!l?a.createComponent("ms-grid-list","odsp-next/controls/list/react/gridList/ReactGridList",function(){return new r.default(function(e,t){i(["odsp-next/controls/list/react/gridList/ReactGridList"],e,t)})}):{tagName:"ms-grid-list",template:i("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};t.components.isRegistered(d.tagName)||t.components.register(d.tagName,d);e.default=d});define("odsp-next/controls/list/viewModels/GridListViewModel",["require","exports","tslib","./ListViewModel","../layouts/GridLayout"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.initialize(new(i.managed(r.default))(e));return i}return e}(o.default);t.default=n});define("odsp-next/controls/list/viewModels/ListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../../../bindings/selection/MultiSelectBinding","../../../bindings/viewport/ViewportBinding","../../../bindings/customRender/CustomRenderBinding","../../../bindings/keyboard/KeyboardBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/contextMenu/ContextMenuBinding","../../../bindings/pulse/PulseBinding","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-utilities/lib/object/ObjectUtil","../../../bindings/selection/MarqueeSelectionBinding","../../../bindings/selection/ClearSelectionBinding","../../../bindings/element/ElementBinding","@ms/odsp-shared/lib/utilities/logging/events/ListViewStartRender.event","../../../providers/engagement/Engagement","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider"],function(e,h,t,i,v,f,g,b,y,x,_,I,S,T,w,C,k,F,M,R,D,A,P,L,B){"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.LIST_VIEW_SURFACE_CLASSNAME="List-surface";h.LIST_VIEW_PAGE_CLASSNAME="List-page";h.LIST_VIEW_CELL_CLASSNAME="List-cell";h.MAX_PAGE_HEIGHT=1e6;var o=function(m){t.__extends(e,m);function e(t,e){var r=m.call(this,t)||this;r.headerParams={};var i=e.element;r.addBindingHandlers({selection:f.default,marqueeSelection:F.default,clearSelection:M.default,viewport:g.default,contextMenu:S.default,customRender:b.default,keyboard:y.default,pulse:T.default,element:R.default,interactionScope:x.default,recoverFocus:_.default});r._renderedCellsByKey={};r._renderedCellsByIndex={};r._visibleCells=[];r.surfaceElement=r.createObservable();r.placeHolderHeight=r.createObservable(0);r.pages=[];r.viewport={viewport:r.createObservable({width:0,height:0,visibleTop:0,visibleBottom:0}),scrollElement:I.getScrollContainer(i)};r._viewport=r.createPureComputed(function(){return r.viewport.viewport()}).extend({rateLimit:0});r._asyncEnqueueOffScreenRenders=r.async.debounce(r._enqueueOffScreenRenders,400);var o=t.isSelectionOnKeyInputEnabled,n=void 0===o||o,a=t.layoutIterationObservable,s=void 0===a?r.createObservable(0):a,l=t.enableMarqueeSelection,d=void 0!==l&&l,c=t.enableClearSelection,u=void 0===c||c;r.isSelectionOnKeyInputEnabled=n;r.visibleModels=v.observable();r.itemSet=t.itemSet;r._itemHistoryProvider=r.resources.isExposed(P.itemHistory)?r.resources.consume(P.itemHistory):null;r.items=r.createComputed(r._computeItems);r.selectionModel=t.selectionModel;r.enableMarqueeSelection=d;r.enableClearSelection=u;r.requiredRange=v.observable({start:0,end:0});r.requiredRange.equalityComparer=k.deepCompare;r.headerType=v.observable("");r.headerStyle=v.observable("");r._findElements(i,t);r.contextMenuHelper=t.contextMenuHelper;r.tooltip=t.tooltip;r._layoutIteration=s;r.requiredGroup=t.requiredGroup;r._isItemSetRendered=r.resources.consume(L.isItemSetRendered);r.activeLayout=v.observable();r.activeLayout.equalityComparer=C.objectStrictEquality;r._isLoading=t.isLoading||v.observable(!0);r._isLoading(!0);r._headerVisibleObservable=v.observable(v.observable(!0));r.headerVisible=r.createPureComputed(r._computeHeaderVisible);r.isActive=r.createObservable(!0);r.tabIndex=r.createObservable(0);r.resources.consume(A.resourceKey).logData({name:"ListView.AppLoad"});r._change=r.async.debounce(function(){r.isDisposed||r._onLayoutChanged()},50,{maxWait:200});r._updateVisibles=r.async.debounce(function(){if(!r.isDisposed&&r.activeLayout().supportsLazyBinding()){for(var e=0,t=r._visibleCells;e<t.length;e++){var i=t[e].element.firstChild,o=i&&v.dataFor(i);o&&o.activateBindings&&o.activateBindings()}r.bindingsActivated=!0}},500);r._updateAnchor=r.async.debounce(r._handleUpdateAnchor,501);r.subscribe(r._viewport,function(){r.activeLayout()&&r.activeLayout().updateViewport(r._viewport())});var p=r.createComputed(function(){t.requiredRange&&t.requiredRange(r.requiredRange())}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});r._itemHistoryProvider&&r.createBackgroundComputed(function(){r._itemHistoryProvider.currentItem()});r.subscribe(r.itemSet,function(){r._isLoading(!0);var e=r.surfaceElement.peek();e&&r.placeHolderHeight.peek()<e.scrollHeight&&r.placeHolderHeight(e.scrollHeight);r._isItemSetRendered(!1);r._removeAll();r.requiredRange({start:0,end:0});p();D.ListViewStartRender.logData()});r.subscribe(r.selectionModel.focusedItem,function(){r.makePages(r.activeLayout.peek().getSurfaceSize().height);r._renderFocusCell();r._change()});r.createBackgroundComputed(function(){var e=r.itemSet();e.content();e.isExpired&&r._removeCells(r.activeLayout().getVisibleRange())});t.visibleItemRange&&r.createBackgroundComputed(function(){r._layoutIteration();var e=r.activeLayout();e?t.visibleItemRange(e.getVisibleItemRange(r.viewport.viewport())):t.visibleItemRange({start:0,end:0})});return r}e.prototype.initialize=function(e){var t=this,i=this.activeLayout.peek();this._isItemSetRendered(!1);if(i){this.events.off(i);i.dispose()}this.events.on(e,"change",function(){t._change();t._updateVisibles();t._updateAnchor()});this.activeLayout(e);B.default.mark("EUPL.ListView.Init");e.updateViewport(this._viewport.peek())};e.prototype.isReadyToBeSelected=function(e){var t=!1;e&&this._renderedCellsByKey[e().key]&&(t=!0);return t};e.prototype.makePages=function(e){for(var t=Math.ceil(e/h.MAX_PAGE_HEIGHT),i=0;i<t;i++){var o=this.pages[i],r=h.MAX_PAGE_HEIGHT;if(!o){var n=document.createElement("div");n.className=h.LIST_VIEW_PAGE_CLASSNAME;n.style.height=r+"px";this._surfaceElement.appendChild(n);o=this.pages[i]={element:n,start:i*h.MAX_PAGE_HEIGHT,index:i}}i===t-1&&(r=e-h.MAX_PAGE_HEIGHT*i);o.element.style.height=r+"px"}if(this.pages.length>t){this.pages.splice(t).map(function(e){v.removeNode(e.element)})}};e.prototype.setCellWidth=function(e,t){e.width=t.width};e.prototype._handleUpdateAnchor=function(){if(!this.isDisposed&&this._itemHistoryProvider){var e=this.activeLayout().getVisibleRange().start,t=this.itemSet.peek(),i=t.content.peek().items;if(0<=e&&e<i.length){var o=i[e],r=this._itemHistoryProvider.getHistoryItemByKey(t.key);r&&o&&r.anchorItem(o.peek())}}};e.prototype._findElements=function(e,t){var i=this;this._surfaceElement=e.getElementsByClassName(h.LIST_VIEW_SURFACE_CLASSNAME)[0];this.events.on(this._surfaceElement,"focus",function(){var e=i.selectionModel.focusedItem.peek();e||(e=i.selectionModel.getItems()[0]);e&&i.selectionModel.setItemFocus(e,{isFocusInput:!1})})};e.prototype._onLayoutChanged=function(){B.default.mark("EUPL.ListViewModel.LayoutChanged");var e=this.activeLayout();if(e){for(var t=e.getSurfaceSize().height;t!==this._lastHeight;){this._lastHeight=t;t=e.getSurfaceSize().height;this._change();return}this.makePages(t);var i=e.supportsGrouping(),o=e.getVisibleRange(),r=e.getVisibleItemRange(),n=e.getMaterializedRange(),a=i?e.getRequiredGroup():null,s=e.getHeaderCell();if(s){this.headerParams=s.viewData;this.headerStyle("margin-"+w.default.safeLeft+": "+s.left+"px; width: "+s.width+"px; height: "+s.height+"px;");this.headerType(s.viewType);this._headerVisibleObservable(s.headerVisible?s.headerVisible:v.observable(!0))}var l=e.getAllFocusableItems();l&&this.selectionModel.setAllFocusableItems(l);B.default.mark("EUPL.ListView.RenderCell.Start");this._visibleCells=this._renderRange(o);B.default.mark("EUPL.ListView.RenderCell.End");this.placeHolderHeight(0===this._visibleCells.length?t:0);this._isLoading(!1);var d=this._viewport.peek().width,c=this.items().length,u=this._lastItemsLength,p=void 0===u?c:u,m=this._lastWidth,h=void 0===m?d:m,f=this.items().length!==p;this._lastItemsLength=p;if(i){var g=e.getVisibleItemCount();f=f||g!==this._lastVisibleItemsLength;this._lastVisibleItemsLength=g}(d!==h||f)&&(o.start<0||o.end<0?this._removeAll():this._removeCells(o));this._lastWidth=d;this._rangesToUpdate=[];this._asyncEnqueueOffScreenRenders(n,o);this._renderFocusCell();a&&this.requiredGroup?this.requiredGroup(a):0<r.end&&this.requiredRange(r);if(this._layoutIteration){var b=this._layoutIteration.peek();this._layoutIteration(b+1)}}};e.prototype._renderFocusCell=function(){var t=this,e=this._getFocusedKey(),i=0;if(e){var o=this.activeLayout().getCellByKey(e),r=this._renderedCellsByKey[e];if(o){r?this._updateCell(o):this._createCell(o);i=-1}else r&&this._removeCell(e)}else document.activeElement===this._surfaceElement&&this.async.setTimeout(function(){var e=t.selectionModel.getItems()[0];e&&document.activeElement===t._surfaceElement&&t.selectionModel.setItemFocus(e,{isFocusInput:!1})},0);this.tabIndex(i)};e.prototype._renderRange=function(e){var i=this,t=this.activeLayout(),o={},r={},n=[];this.bindingsActivated=!1;for(var a=function(e){if(e&&e.viewType){var t=i._renderedCellsByKey[e.key];t?r[e.key]=e:t=i._createCell(e);n.push(t);o[e.key]=!1}},s=e.start;0<=s&&s<=e.end;s++){var l=t.getCellAt(s),d=this._renderedCellsByIndex[s];a(l);!d||l&&d.key===l.key||void 0!==o[d.key]||(o[d.key]=!0)}for(var c in o)o[c]&&this._removeCell(c);for(var u in r){l=r[u];this._updateCell(l)}this._isItemSetRendered(!0);return n};e.prototype._updateCell=function(e){var t=e.cellIndex,i=this._renderedCellsByKey[e.key],o=i.element.style;i.cellIndex!==t&&i===this._renderedCellsByIndex[i.cellIndex]&&delete this._renderedCellsByIndex[i.cellIndex];var r=this.pages[Math.floor(e.top/h.MAX_PAGE_HEIGHT)];i.cellIndex=t;i.top=e.top-r.start;i.left=e.left;this.setCellWidth(i,e);i.height=e.height;i.element.setAttribute("data-index",""+i.index);i.element.setAttribute("data-key",i.key);i.viewData&&i.viewData.cellSize({width:i.width,height:i.height});o[w.default.safeLeft]=i.left+"px";o.top=i.top+"px";o.width=i.width+"px";o.height=i.height+"px";this._renderedCellsByIndex[t]=i};e.prototype._createCell=function(e){var t=e.key,i=e.index,o=e.cellIndex,r=e.width,n=e.height,a=e.left,s=e.top,l=e.viewType,d=e.viewData,c=document.createElement("div");c.className=h.LIST_VIEW_CELL_CLASSNAME;c.setAttribute("role","listitem");var u=k.extend({cellSize:this.createObservable({width:r,height:n})},d),p=this._renderedCellsByKey[e.key]={key:t,index:i,cellIndex:o,width:r,height:n,left:a,top:s,viewType:l,viewData:u,element:c};this._updateCell(e);l&&v.applyBindingsToNode(c,{component:{name:l,params:u}},v.contextFor(this._surfaceElement));this.pages[Math.floor(e.top/h.MAX_PAGE_HEIGHT)].element.appendChild(c);return p};e.prototype._processRanges=function(){var t=this;if(!this._processRangeEnqueued){this._processRangeEnqueued=!0;this.async.setTimeout(function(){t._processRangeEnqueued=!1;var e=t._rangesToUpdate.shift();if(e)if(e.remove)t._removeCells(e);else{t.makePages(t.activeLayout.peek().getSurfaceSize().height);t._renderRange(e)}t._rangesToUpdate.length&&t._processRanges()},4)}};e.prototype._enqueueOffScreenRenders=function(e,t){if(-1<t.start&&-1<t.end){for(var i=t.end+1;i<=e.end;i+=4)this._rangesToUpdate.push({start:i,end:i+4-1});this._rangesToUpdate.push({start:e.start,end:e.end,remove:!0});for(i=t.start-1-4;i>=e.start;i-=4)this._rangesToUpdate.push({start:i,end:i+4-1});this._processRanges()}};e.prototype._removeAll=function(){for(var e in this._renderedCellsByKey){var t=this._renderedCellsByKey[e];v.cleanNode(t.element)}for(var i in this.pages)if(this.pages.hasOwnProperty(i)){var o=this.pages[i];o.element.innerHTML="";o.element.style.height="0px"}this._renderedCellsByIndex={};this._renderedCellsByKey={}};e.prototype._removeCells=function(e){for(var t=v.utils.extend({},this._renderedCellsByKey),i=this.activeLayout(),o=e.start;0<=e.start&&o<=e.end;o++){var r=i.getCellAt(o);r&&delete t[r.key]}var n=this._getFocusedKey();n&&delete t[n];for(var a in t)this._removeCell(a)};e.prototype._removeCell=function(e){var t=this._renderedCellsByKey[e];v.removeNode(t.element);delete this._renderedCellsByKey[e];this._renderedCellsByIndex[t.cellIndex]===t&&delete this._renderedCellsByIndex[t.cellIndex]};e.prototype._computeItems=function(){return this.itemSet().content().items};e.prototype._computeHeaderVisible=function(){return this._headerVisibleObservable()()};e.prototype._getFocusedKey=function(){var e=this.peekUnwrapObservable(this.peekUnwrapObservable(this.selectionModel.focusedItem));return e&&e.key};return e}(i.default);h.default=o});define("odsp-next/bindings/selection/MultiSelectBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/events/EventTargetFilters"],function(e,t,i,o,r,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(u){i.__extends(e,u);function e(e){var t=u.call(this,e)||this,i=e.valueAccessor(),o=i.layout,r=i.selectionModel,n=i.isSelectionOnKeyInputEnabled,a=void 0===n||n,s=i.shouldRespectInputKeyboardEvent,l=void 0!==s&&s,d=i.cancelBubbleOnArrowKey,c=void 0!==d&&d;t._isSelectionOnKeyInputEnabled=a;t._layout=o;t._selectionModel=r;t._shouldRespectInputKeyboardEvent=l;t._cancelBubbleOnArrowKey=c;t.events.on(t.element,"click",t._onClick);t.events.on(t.element,"keydown",t._onKeyDown);return t}e.prototype._onKeyDown=function(e){var t=e.target,i=p.isInputElement(t);if(!this._shouldRespectInputKeyboardEvent&&i)return!0;if(e.altKey)return!0;var o=this._selectionModel,r=this._layout(),n=o.getFocusIndex(),a=-1,s=!!e.shiftKey,l=!!e.metaKey,d=!!e.ctrlKey,c=!0;switch(e.which){case 38:c=(a=r.getItemIndexAbove(n))!==n;break;case 40:c=(a=r.getItemIndexBelow(n))!==n;break;case 37:c=(a=r.getItemIndexLeft(n))!==n;break;case 39:c=(a=r.getItemIndexRight(n))!==n;break;case 36:a=0;break;case 35:a=o.getItems().length-1;break;case 32:if(p.isButtonElement(t))return!0;o.toggleIndexSelected(n);break;case 13:return!(!p.isButtonElement(t)&&this.element.contains(t))||o.invokeFocusedItem(e);default:return}if(0<=a)if(s){d||l||o.clear();o.selectToIndex(a);o.setIndexFocus(a,{preventAnchor:!0})}else if(d||l)o.setIndexFocus(a);else{o.clear();this._isSelectionOnKeyInputEnabled&&o.setIndexSelected(a,!0);o.setIndexFocus(a)}return!this._cancelBubbleOnArrowKey&&!c};e.prototype._onClick=function(e){var t=this._getItemFromElement(e.target);if(t){var i=this._selectionModel,o=!!e.shiftKey,r=!!e.metaKey,n=!!e.ctrlKey;if(o){n||i.clear();i.selectToItem(t);i.setItemFocus(t,{preventAnchor:!0})}else if(n||r){i.setItemSelected(t,!0);i.setItemFocus(t)}else{if(!i.isItemSelected(t)||1<i.selection().length){i.clear();i.setItemSelected(t,!0)}i.setItemFocus(t)}e.stopPropagation();e.preventDefault()}};e.prototype._getItemFromElement=function(e){for(var t,i=o.contextFor(e);i&&!t;){t=i&&i.$data&&"function"==typeof i.$data.getItem?i.$data.getItem():null;i=i.$parentContext}return t};return e}(r.default);t.default=n});define("odsp-next/bindings/viewport/ViewportBinding",["require","exports","knockout","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function u(){}u.init=function(t,e,i,o,r){var n=new m.default(this),a=new h.default(null),s=e(),l=s.scrollElement||document.body,d=s.viewport||s;function c(){n.setTimeout(function(){var e=u.getViewport(t);d(e)},0)}c();a.on(l,"scroll",c);a.on(window,"resize",c);p.utils.domNodeDisposal.addDisposeCallback(t,function(){a.dispose()})};u.getViewport=function(e){var t=e.getBoundingClientRect(),i=window.innerHeight;return{width:t.width,height:i,visibleTop:-t.top,visibleBottom:i-t.top}};return u}();t.default=i});define("odsp-next/bindings/customRender/CustomRenderBinding",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.init=function(){return{controlsDescendantBindings:!0}};return e}();t.default=i});define("odsp-next/bindings/pulse/PulseBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(n){var a=e.call(this,n)||this;a._pulseTargets=[];a._throttledPulse=a.async.debounce(a.pulse,5e3);a.createComputed(function(){var e=n.valueAccessor()();if(e&&e.length){var t=e.length;a._pulseTargets=[];for(var i=0;i<t;i++){var o=e[i];if(o&&o.pulseTarget){var r=o.pulseTarget();r&&r.canPulse()&&a._pulseTargets.splice(Math.floor(Math.random()*(1+a._pulseTargets.length)),0,r)}}a._throttledPulse()}else a._pulseTargets=[]});return a}t.prototype.pulse=function(){var t=this,i=2,o=function(){if(i=Math.min(t._pulseTargets.length,i)){var e=t._pulseTargets.shift();if(e){e.pulse();t._pulseTargets.push(e);i--}}i?t.async.setTimeout(o,150):t._throttledPulse()};o()};return t}(o.default);t.default=r});define("odsp-next/bindings/selection/MarqueeSelectionBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/domUtils/DomUtils","../../resources/ControlResourceKeys","../scrollContainer/ScrollContainerBinding","../autoScroll/AutoScrollBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./MarqueeSelection.css"],function(e,t,i,c,o,u,n,a,r,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(d){i.__extends(e,d);function e(e){var t=d.call(this,e)||this,i=e.valueAccessor(),o=i.selectionModel,r=i.layout,n=void 0===r?c.observable():r,a=i.isEnabled,s=void 0===a||a;t._selectionModel=o;t._layout=n;t._throttledEvaluateSelection=t.async.throttle(t._evaluateSelection,40);t._isSelecting=c.observable(!1);t._yOffset=c.observable(0);t._offsetElement=c.observable(t.element);t._isEnabled=c.isObservable(s)?s:c.observable(s);t._canUserSelect=t.resources.consume(p.canUserSelect.optional)||t.observables.create(!1);var l=t.resources.consume(f.platformDetection.optional);t._isMobile=!!l&&l.isMobile;t._container=m.getScrollContainer(t.element);t.events.on(t._container,"mousedown",t._onMouseDown);t.events.on(window,"click",t._onClick,!0);new(t.managed(h.default))({element:t.element,bindingContext:t.bindingContext,allBindingsAccessor:t.allBindingsAccessor,valueAccessor:function(){return{enabled:t._isSelecting,y:t._yOffset}}});return t}e.prototype._getRegion=function(e,t){var i=this._container,o=i.getBoundingClientRect(),r=i.scrollTop,n=i.scrollLeft,a=Math.max(o.left,t.clientX),s=Math.max(o.top,t.clientY),l=new u.default(Math.min(e.x,a+n)-o.left,Math.min(e.y,Math.max(0,s)+r)-o.top,Math.abs(a+n-e.x),Math.abs(s+r-e.y));l.x=Math.max(0,l.x);l.y=Math.max(0,l.y);l.width=Math.min(i.scrollWidth-l.x,l.width);l.height=Math.min(i.scrollHeight-l.y,l.height);return l};e.prototype._getOffsetRegion=function(e){var t=this._container,i=this._offsetElement.peek(),o=new u.default(e);if(i){var r=t.getBoundingClientRect(),n=i.getBoundingClientRect();o.x-=n.left-r.left+t.scrollLeft;o.y-=n.top-r.top+t.scrollTop;a.default.isRightToLeft&&(o.x=n.width-o.x-o.width)}return o};e.prototype._canSelect=function(e){var t=this._layout();return this._isEnabled.peek()&&!!t&&!this._isMobile&&0===this._selectionModel.mode&&!this._selectionModel.isIndexSelected(t.getItemIndicesInRegion(e)[0])&&this._canUserSelect.peek()};e.prototype._onScroll=function(){if(this._marqueeBox){this._onMouseMove(this._lastMouseEvent);this._throttledEvaluateSelection()}};e.prototype._onMouseDown=function(e){if(0===e.button){var t=this._container,i=new n.default(e.clientX,e.clientY+t.scrollTop),o=this._getRegion(i,e),r=this._getOffsetRegion(o);this._suppressNextClick=!1;if(!this._marqueeBox&&this._canSelect(r)&&e.target!==this._container){this._downPoint=i;this._lastMouseEvent=e;this._downPoint=new n.default(e.clientX,e.clientY+t.scrollTop);this._shouldClearSelection=!e.shiftKey;this.events.on(window,"mousemove",this._onMouseMove,!0);this.events.on(window,"mouseup",this._onMouseUp,!0);this.events.on(t,"scroll",this._onScroll)}}};e.prototype._initializeDrag=function(e){this._marqueeArea=r.default.ce("div",{class:"od-MarqueeSelection"});this._marqueeBox=r.default.ce("div",{class:"od-MarqueeSelection-box"});this._shouldClearSelection&&this._selectionModel.clear();this._isSelecting(!0);this._onMouseMove(e);this._marqueeArea.appendChild(this._marqueeBox);this._container.appendChild(this._marqueeArea);this._canUserSelect(!1);this._suppressNextClick=!0};e.prototype._onMouseMove=function(e){var t=e.buttons;if(1===(void 0===t?1:t)){var i=this._container;if(this._downPoint&&!this._marqueeBox){var o=Math.abs(e.clientX-this._downPoint.x),r=Math.abs(e.clientY+i.scrollTop-this._downPoint.y);(5<o||5<r)&&this._initializeDrag(e)}if(this._marqueeBox){this._marqueeArea.style.height=i.scrollHeight+"px";this._lastMouseEvent=e;var n=this._getRegion(this._downPoint,e),a=this._marqueeBox.style;this._yOffset(e.clientY);a.left=n.x+"px";a.top=n.y+"px";a.width=n.width+"px";a.height=n.height+"px";this._lastRegion=n;this._throttledEvaluateSelection();return!1}}else this._onMouseUp(e)};e.prototype._evaluateSelection=function(){var e,t=this._lastRegion,i=this._getOffsetRegion(t),o=this._layout();if(o){e=o.getItemIndicesInRegion(i);for(var r=this._lastIndicesInRegion||[],n=0;n<e.length;n++){for(var a=e[n];r.length&&r[0]!==a;){this._selectionModel.setIndexSelected(r[0],!1);r.shift()}r.length?r.shift():this._selectionModel.setIndexSelected(e[n],!0)}for(;r.length;){this._selectionModel.setIndexSelected(r[0],!1);r.shift()}}this._lastIndicesInRegion=e};e.prototype._onMouseUp=function(e){var t=this;if(0===e.button){var i=!!this._marqueeBox,o=this._container;if(i){this._container.removeChild(this._marqueeArea);this.async.setTimeout(function(){t._suppressNextClick=!1},0)}else this._lastRegion=null;this._isSelecting(!1);this._lastIndicesInRegion=this._downPoint=this._marqueeArea=this._marqueeBox=null;this.events.off(window,"mousemove",this._onMouseMove,!0);this.events.off(window,"mouseup",this._onMouseUp,!0);this.events.off(o,"scroll",this._onScroll);this._canUserSelect(!0);return!i}};e.prototype._onClick=function(e){if(this._suppressNextClick&&0===e.button){this._suppressNextClick=!1;e.stopImmediatePropagation();return!1}return!0};return e}(o.default);t.default=s});define("odsp-next/bindings/autoScroll/AutoScrollBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding","knockout"],function(e,t,i,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t._container=l.getScrollContainer(t.element);var i=d.unwrap(t.valueAccessor()),o=i.enabled,r=void 0===o?d.observable(!1):o,n=i.y,a=void 0===n?d.observable(0):n;t._enabled=r;t._y=a;t.createComputed(t._computeScrollOnYPosition);return t}e.prototype._computeScrollOnYPosition=function(){var e=this._enabled(),t=this._container;this.async.clearTimeout(this._timeoutId);this._timeoutId=null;if(e){var i=t.getBoundingClientRect(),o=this._y(),r=i.top,n=r+i.height,a=0;o<=r+100?a=-(1-(o-i.top)/100):n-100<=o&&(a=1-(i.top+i.height-o)/100)}if(a){t.scrollTop=Math.min(t.scrollHeight-i.height,Math.max(0,t.scrollTop+15*a));this._timeoutId=this.async.setTimeout(this._computeScrollOnYPosition,30)}};return e}(o.default);t.default=r});define("odsp-next/bindings/selection/MarqueeSelection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-MarqueeSelection{position:absolute;z-index:650;top:0;left:0;width:100%;min-height:100%;background:rgba(255,0,0,0);cursor:default}.od-MarqueeSelection-box{position:absolute;box-sizing:border-box;border:1px solid "},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";background-color:"},{theme:"themeAccentTranslucent10",defaultValue:"rgba(58,150,221,.1)"},{rawString:"}"}])});define("odsp-next/bindings/selection/ClearSelectionBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding","knockout"],function(e,t,i,o,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(d){i.__extends(e,d);function e(e,t){void 0===t&&(t={});var i=d.call(this,e,t)||this,o=i.valueAccessor(),r=o.selectionModel,n=o.isEnabled,a=void 0===n||n;i._selectionModel=r;i._isEnabled=u.isObservable(a)?a:u.observable(a);var s=t.getScrollContainer,l=void 0===s?c.getScrollContainer:s;i._container=l(i.element);i.events.on(i._container,"click",i._onClick);return i}e.prototype._onClick=function(e){if(this._isEnabled.peek()&&this._selectionModel.selectedCount.peek()&&e.target!==this._container){this._selectionModel.clear(!0);return!1}return!0};return e}(o.default);t.default=r});define("@ms/odsp-shared/lib/utilities/logging/events/ListViewStartRender.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListViewStartRender=i.createSingleEvent({eventName:"ListViewStartRender,",shortEventName:"ListViewStartRender",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{});t.default=t.ListViewStartRender});define("odsp-next/controls/list/layouts/GridLayout",["require","exports","tslib","./BaseGridLayout","../../sharing/sharerHeader/SharerHeader","../../headerTile/HeaderTile"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getGroup=function(e,t){var i,o=this._itemSet().content.peek().groupings||[];if(o&&o.length&&o[0].itemGroups)for(var r=0,n=o[0].itemGroups;r<n.length;r++){var a=n[r];if(a){var s=a.startIndex+a.count-1;if(a.startIndex<=e&&e<=s){i=a;break}}}return i};t.prototype.getHeader=function(e,t,i){var o=null,r=t&&t.peek&&t.peek(),n=this.getGroup(i,r);if(n&&!n.isPlaceholder&&this.currentGroup!==n){this.nextGroup=n;var a=this.getHeaderDetails(n,i);0!==i||a.viewType||(a.headerHeight=0);var s=a.key?a.key:r?r.key+"_header":null;s&&(o={key:s,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:a.headerHeight,viewType:a.viewType,viewData:a.viewData})}return o};t.prototype.getHeaderDetails=function(e,t){var i="",o={},r=20;if(e)if("sharer"===e.groupingId){i=n.default.tagName;o={group:e,cellsInGroup:0,resources:this.resources};r=84}else if(e.name){i=a.default.tagName;o={group:e};r=46}return{viewType:i,viewData:o,headerHeight:r}};return t}(o.default);t.default=r});define("odsp-next/controls/list/layouts/BaseGridLayout",["require","exports","tslib","./BaseLayout","@ms/odsp-utilities/lib/locale/Locale","../../../controls/itemTile/ItemTile","../../../utilities/browser/ResponsiveUI","../../../dataSources/url/QueryType"],function(e,t,o,i,r,n,a,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,l="photo";!function(e){e.folder={Small:110,Medium:110,Large:120,XLarge:120,XXLarge:120,XXXLarge:120,XXXXLarge:120};e.documents={Small:130,Medium:130,Large:160,XLarge:160,XXLarge:160,XXXLarge:160,XXXXLarge:160};e.photos={Small:90,Medium:90,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170};e.other={Small:120,Medium:120,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170}}(s=t.MinRowHeights||(t.MinRowHeights={}));var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.visibleRange=null;t.currentGroup=null;t.nextGroup=null;t._headerIndices=[];t.rows=[];t.responsiveHelper=t.resources.consume(a.resourceKey);t.canSelectHeaders=!1;t._footerItem=e.footerItem;t._footerItem&&t.subscribe(t._footerItem,function(){t.evaluateLayout(!0)&&t.change()});return t}e.prototype.getOuterMargin=function(){return{top:0,left:0,bottom:0,right:0}};e.prototype.getMinCellWidth=function(){return 40};e.prototype.getInnerMargin=function(){return this.isSmallWidthLayout?3:8};e.prototype.getMinRowHeight=function(){var e,t=this._getGroupName(this.currentGroup),i=this.responsiveHelper.formFactorSize.peek();switch(t){case"folder":e=s.folder[i];break;case"document":e=s.documents[i];break;case l:e=s.photos[i];break;default:e=s.other[i]}return e};e.prototype.getItemAspectRatio=function(e){var t,i=this._getGroupName(this.currentGroup),o=this.unwrapObservable(e);switch(i){case"folder":t=o&&o.isAlbum?1:this.isSmallWidthLayout?4/3:1.6;break;default:if(o&&o.subsite)t=5.5;else if(o&&(o.photo||o.video)&&o.thumbnail&&o.thumbnail.width){var r=o.orientedThumbnail,n=!!r&&r.rotation%2==1,a=(r||o).thumbnail,s=n?a.height:a.width,l=n?a.width:a.height,d=Math.max(s,this.getMinCellWidth()),c=Math.max(l,this.getMinRowHeight());t=Math.max(.5,Math.min(3,d/c))}else t=(o&&(o.queryType,u.default.Discover),1)}return t};e.prototype.getIsFixed=function(){switch(this._getGroupName(this.currentGroup)){case l:return!1;default:return!0}};e.prototype.getCellByKey=function(e){var t;if(this.cells)for(var i=0,o=this.cells;i<o.length;i++){var r=o[i];if(r.key===e){t=r;break}}return t};e.prototype.getItemViewType=function(e){return e?n.default.tagName:null};e.prototype.getItemViewData=function(e){return{item:e,resources:this.resources,group:this.currentGroup,engagementSource:"GridViewTile"}};e.prototype.getVisibleRange=function(e){void 0===e&&(e=this.viewport);var t=this.getRowRangeForViewport(e),i=t.start,o=t.end,r=this.rows[i],n=this.rows[o-1];this.visibleRange={start:0<=i?r.cells[0].cellIndex:-1,end:0<=o?n.cells[n.cells.length-1].cellIndex+1:-1};return this.visibleRange};e.prototype.getMaterializedRange=function(){var e={start:this.visibleRange.start,end:this.visibleRange.end};if(0<=e.start){var t=this.cells[e.end-1].rowIndex-this.cells[e.start].rowIndex+1,i=this.cells[this.visibleRange.start].rowIndex,o=this.cells[this.visibleRange.end-1].rowIndex,r=Math.max(3*t,30),n=Math.max(3*t,30);i=Math.max(0,i-r);o=Math.min(this.rows.length-1,o+n);e.start=this.rows[i].cells[0].cellIndex;var a=this.rows[o];e.end=a.cells[a.cells.length-1].cellIndex+1}return e};e.prototype.getSurfaceSize=function(){var e=this.lastRow,t=this.getOuterMargin();return{width:this.viewport.width,height:e?e.top+e.height+t.bottom:0}};e.prototype.getCellCount=function(){return this.cells.length};e.prototype.getCellAt=function(e){return this.cells&&this.cells[e]};e.prototype.getItemIndexAbove=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),i=t?t.index:-1;t&&(i=this._findNearestCellInRow(t,-1).index);return i};e.prototype.getItemIndexBelow=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),i=t?t.index:0;t&&(i=this._findNearestCellInRow(t,1).index);return i};e.prototype.getItemIndexLeft=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));t&&(t=this._findNextCell(t,r.default.isRightToLeft?1:-1));return t?t.index:-1};e.prototype.getItemIndexRight=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));t&&(t=this._findNextCell(t,r.default.isRightToLeft?-1:1));return t?t.index:-1};e.prototype.getItemIndicesInRegion=function(e){for(var t=[],i=0;i<this.rows.length;i++){var o=this.rows[i];if(o.top>e.y+e.height)break;if(o.top<=e.y+e.height&&o.top+o.height>=e.y)for(var r=0;r<o.cells.length;r++){var n=o.cells[r];n.item&&n.left<=e.x+e.width&&n.left+n.width>=e.x&&t.push(n.index)}}return t};e.prototype.getToggleClass=function(){return"ItemTile-rowCheck"};e.prototype.evaluateLayout=function(e){var t=this._itemSet.peek(),i=t&&t.content.peek().items;if(!i||!this.viewport||this.viewport.width<100)return!1;if(e){var o=!0,r=this.responsiveHelper;this.isSmallWidthLayout=r.compareSize(r.formFactorSize(),"Medium")<=0;this.cells=[];this._itemIndexToCell={};this.rows=[];this._headerIndices=[];this.lastRow=null;this._lastRowInGroup=null;this.currentGroup=null;this.nextGroup=null;this.currentRow=null;for(var n=0;n<i.length;n++){var a=i[n];a||(o=!1);this.addToCurrentRow(this.getHeader(i[n-1],a,n),!0);this.addToCurrentRow(this.getCell(a,n))}this._footerItem&&this._footerItem.peek()&&o&&this.addToCurrentRow(this.getFooterCell(this._footerItem));this.finalizeRow(!0)}return!0};e.prototype.addToCurrentRow=function(e,t){this.addToRow(this.getCurrentRow(),e,t)};e.prototype.addToRow=function(e,t,i){if(t){if(void 0===t.shouldLineBreak?i:t.shouldLineBreak){this.finalizeRow(!0,e.isHeader);(e=this.getCurrentRow()).isHeader=!0;e.cells.push(t);this.finalizeRow(!1,!0)}else{if(!this.canAddCell(t)){this.finalizeRow(!0,!1);e=this.getCurrentRow()}e.aspectRatio+=t.aspectRatio;e.cells.push(t);t.isHeader||t.shouldLineBreak||e.itemCellCount++}}};e.prototype.getFooterCell=function(e){var t=e.peek(),i=null;t.component&&(i={key:"footer",item:t.component,index:-1,cellIndex:this.cells.length,viewType:t.component.name,viewData:t.component.params,aspectRatio:t.aspectRatio?t.aspectRatio:1});return i};e.prototype.getCell=function(e,t){var i=e&&e.peek&&e.peek();return{key:i?i.key:"item-"+t,item:e,index:t,cellIndex:this.cells.length,viewType:this.getItemViewType(i),viewData:this.getItemViewData(e),aspectRatio:this.getItemAspectRatio(e)}};e.prototype.getCellIndexFromItemIndex=function(e){var t=this._itemIndexToCell&&this._itemIndexToCell[e];return t?t.cellIndex:-1};e.prototype.getAvailableWidth=function(){var e=this.getOuterMargin(),t=this.getInnerMargin(),i=this.currentRow?(this.currentRow.cells.length-1)*t:0;return this.viewport.width-(e.left+e.right)-i};e.prototype.finalizeRow=function(e,t){var i=this.currentRow;if(this.currentRow&&this.currentRow.cells.length){var o=this.getOuterMargin(),r=this.getInnerMargin(),n=this.lastRow,a=Math.ceil(this._getRowHeight(i,t)),s=0,l=null,d=null,c=null,u=void 0,p=!1;i.top=Math.round(n?n.top+n.height+r:o.top);i.height=a;for(u=0;u<i.cells.length;u++){var m=(c=i.cells[u]).aspectRatio||0,h=this._determineCellLeft(o,s,a,r,u),f=this._determineCellWidthWithAspectRatio(m,a,o,h);if(p=this._shouldCreateNewRow(c,i,u,f)){l&&(l.width+=f+r);break}c.isFixedWidth&&(m=c.width/a);t&&this._headerIndices.push(this.cells.length);c.cellIndex=this.cells.length;void 0!==c.index&&-1!==c.index&&(this._itemIndexToCell[c.index]=c);this.cells.push(c);c.left=this._determineCellLeft(o,s,a,r,u);c.top=i.top;c.isFixedWidth||(c.aspectRatio?c.width=this._determineCellWidthWithAspectRatio(m,a,o,c.left):c.width=this.viewport.width-o.right-c.left);c.height=a;c.rowIndex=this.rows.length;s+=m;l=c}p&&i.cells.pop();this.rows.push(i);t?this.currentHeaderCell=i.cells[0]:this.currentHeaderCell&&this.updateHeader(this.currentHeaderCell,i.cells.length);this.lastRow=i;this._lastRowInGroup=t?null:i;this.currentGroup=this.nextGroup;this.currentRow=null;if(p){d=this.makeNewRow();this.addToRow(d,c,c.isHeader);this.currentRow=d;c.cellIndex===this.cells.length-1&&this.finalizeRow()}}};e.prototype.canAddCell=function(e){var t=!1,i=this.getCurrentRow(),o=this.getInnerMargin(),r=this.getMinRowHeight(),n=this.getOuterMargin(),a=this.getRowMaxAspectRatio(n,o,r,i);this._processCell(e);e&&i.aspectRatio+e.aspectRatio<=a?t=!0:i.isFull=!0;return t};e.prototype.getRowMaxAspectRatio=function(e,t,i,o){return(this.viewport.width-(e.left+e.right)-o.cells.length*t)/i};e.prototype.getCurrentRow=function(){this.currentRow||(this.currentRow=this.makeNewRow());return this.currentRow};e.prototype.makeNewRow=function(){return{cells:[],top:0,height:0,aspectRatio:0,itemCellCount:0}};e.prototype.updateHeader=function(e,t){};e.prototype.getRowRangeForViewport=function(e){var t=-1,i=-1;if(this.rows.length&&0<e.width&&0<e.height){var o=this.rows.length-1,r=this.rows[0],n=this.rows[o],a=r.top,s=n.top+n.height,l=Math.max(a,Math.min(e.visibleTop,s-e.height)),d=Math.min(s,Math.max(e.visibleBottom,a+e.height)),c=r;t=0;for(;c&&c.top+c.height<l;)c=this.rows[++t];i=t;for(;c&&i<o&&c.top<d;)c=this.rows[++i];i=Math.min(i,o)+1}return{start:t,end:i}};e.prototype._determineCellLeft=function(e,t,i,o,r){return Math.ceil(e.left+t*i+o*r)};e.prototype._determineCellWidthWithAspectRatio=function(e,t,i,o){return Math.min(Math.ceil(e*t),this.viewport.width-i.right-o)};e.prototype._shouldCreateNewRow=function(e,t,i,o){var r=e.shouldNotBeLastInRow&&1<t.cells.length&&i===t.cells.length-1,n=0<o&&o<=30&&i===t.cells.length-1;return r||n};e.prototype._processCell=function(e){var t=this.getOuterMargin();e.width||(e.width=this.viewport.width-t.left-t.right)};e.prototype._getRowHeight=function(e,t){var i=this.getMinRowHeight(),o=0,r=this.getAvailableWidth(),n=this.getOuterMargin(),a=this.getInnerMargin(),s=e.cells[0],l=this.getIsFixed();if(s.width)if(!e.isFull&&l){var d=s.aspectRatio,c=1,u=void 0,p=void 0;do{u=this.viewport.width-(n.left+n.right)-c++*a;d+=s.aspectRatio;p=u/i}while(d<=p);o=(u+=a)/(d-=s.aspectRatio)}else e.isFull?o=r/e.aspectRatio:this._lastRowInGroup&&(o=r/this._lastRowInGroup.aspectRatio);else o=s.height;return Math.max(t?o:i,o)};e.prototype._findNextCell=function(e,t){for(var i=e.cellIndex+t,o=this.cells[i];0<=i&&i<this.cells.length&&void 0===o.index;){i+=t;o=this.cells[i]}return o};e.prototype._findNearestCellInRow=function(e,t){var i=-1,o=null,r=e.rowIndex+t,n=this.rows[r],a=this.rows[e.rowIndex];if(n&&n.isHeader&&!this.canSelectHeaders){var s=r+t;0<s&&s<this.rows.length&&(n=this.rows[s])}for(;e&&!o&&n;){for(var l=0;l<n.cells.length;l++){var d=n.cells[l],c=Math.abs(this._getPosition(e,a.isHeader)-this._getPosition(d));if(void 0!==d.index&&(-1===i||c<i)){i=c;o=d}}if(!o){r+=t;n=this.rows[r]}}return o||e};e.prototype._getPosition=function(e,t){var i=t&&this.canSelectHeaders?0:e.width;return e.left+i/2};e.prototype._getGroupName=function(e){var t="";e&&e.groupingId?t=e.groupingId:!e||void 0===e.closedFuture&&void 0===e.closedPast||(t=l);return t};return e}(i.default);t.default=d});define("odsp-next/controls/list/layouts/BaseLayout",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/events/EventGroup","knockout","../../../utilities/browser/ResponsiveUI"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e){var t=i.call(this)||this;t.viewport={width:0,height:0,visibleTop:0,visibleBottom:0};t._itemCanary=n.observable().extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});t._itemSet=e.itemSet;t._scrollBarWidth=a.default.getScrollbarWidth();t.subscribe(t._itemSet,t.onItemSetChanged);t._subscribeForContentChange();t._isGrouped=e.isGrouped;t._isGrouped&&t._refreshGroupSubscriptions();t.subscribe(t._itemCanary,t._onItemCanaryChanged);return t}e.prototype.onContentChanged=function(){var e=this;this._disposeItemSubscriptions();this._itemSubscriptions=[];for(var t=this._itemSet.peek().content.peek().items,i=t.length,o=0;o<i;o++){var r=t[o];r&&r.subscribe&&this._itemSubscriptions.push(r.subscribe(function(){return e._itemCanary({})}))}this._isGrouped&&this._refreshGroupSubscriptions();this.evaluateLayout(!0)&&this.change()};e.prototype.onItemSetChanged=function(){this._contentSubscription.dispose();this._subscribeForContentChange();this.onContentChanged()};e.prototype.getHeaderCell=function(){return null};e.prototype.getItemAspectRatio=function(e){return 1};e.prototype.updateViewport=function(e){this.viewport=e;this.evaluateLayout(Math.round(e.width)!==Math.round(this._lastWidth))&&this.change();this._lastWidth=e.width};e.prototype.evaluateLayout=function(e){return!0};e.prototype.change=function(){r.default.raise(this,"change")};e.prototype.dispose=function(){i.prototype.dispose.call(this);this._disposeItemSubscriptions();this._disposeGroupSubscriptions();this._contentSubscription.dispose()};e.prototype.supportsLazyBinding=function(){return!1};e.prototype.supportsGrouping=function(){return!1};e.prototype.getVisibleRange=function(e){void 0===e&&(e=this.viewport);return{start:0,end:0}};e.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);return this.getVisibleRange(e)};e.prototype.getRequiredGroup=function(){return null};e.prototype.getAllFocusableItems=function(){return null};e.prototype.getVisibleItemCount=function(){return 0};e.prototype.onGroupStateChange=function(){this.evaluateLayout(!1)&&this.change()};e.prototype._subscribeForContentChange=function(){this._contentSubscription=this._itemSet.peek().content.subscribe(this.onContentChanged,this)};e.prototype._onItemCanaryChanged=function(){this.evaluateLayout(!0)&&this.change()};e.prototype._disposeItemSubscriptions=function(){if(this._itemSubscriptions)for(var e=0;e<this._itemSubscriptions.length;e++)this._itemSubscriptions[e].dispose();this._itemSubscriptions=null};e.prototype._disposeGroupSubscriptions=function(){if(this._groupSubscriptions&&0<this._groupSubscriptions.length)for(var e=0,t=this._groupSubscriptions;e<t.length;e++){t[e].dispose()}this._groupSubscriptions=null};e.prototype._refreshGroupSubscriptions=function(){var t=this;this._disposeGroupSubscriptions();this._groupSubscriptions=[];var e=this._itemSet.peek().content.peek().groupings;if(e&&e.length)for(var i=0,o=e;i<o.length;i++){var r=o[i].itemGroups;r&&r.length&&r.forEach(function(e){e.state&&t._groupSubscriptions.push(t.subscribe(e.state,t.onGroupStateChange))})}};return e}(i.default);t.default=s});define("odsp-next/controls/itemTile/ItemTile",["require","exports","./ItemTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemTile.html","./ItemTileFolder.html","./ItemTileFile.html","./ItemTilePhoto.html","./ItemTileVideo.html","./ItemTile.css","../folderCoverTile/FolderCoverTile","../fileTypeIcon/FileTypeIcon"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-item-tile",template:e("./ItemTile.html"),viewModel:i.default,synchronous:!0});o.registerTemplate("ms-item-tile-folder",e("./ItemTileFolder.html"));o.registerTemplate("ms-item-tile-file",e("./ItemTileFile.html"));o.registerTemplate("ms-item-tile-photo",e("./ItemTilePhoto.html"));o.registerTemplate("ms-item-tile-video",e("./ItemTileVideo.html"));t.default=r});define("odsp-next/controls/itemTile/ItemTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/ItemType","@ms/odsp-shared/lib/base/Rotation","../../resources/ControlResourceKeys","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/list/SharingTypeHelper","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../../dataSources/url/QueryType","../../controls/list/react/SelectionManager","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../bindings/focus/DelayedHasFocusBinding","../../bindings/dragAndDrop/DragAndDropBinding","../../utilities/features/Features","../../controls/image/frame/ImageFrame","../newBadge/NewBadge","../../dataSources/base/AriaHelper","./ItemTile.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/dom/Dom","../../utilities/selection/SelectionHelper","../../bindings/teachingBubble/TeachingBubbleBinding","../../bindings/react/ReactBinding","../../models/engagement/Engagement","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/logging/events/Qos.event","../../bindings/element/ElementBinding","office-ui-fabric-react/lib/Styling","../fileHoverCard/react/FileHoverCardHelper","../itemCheck/ItemCheck"],function(f,g,t,e,a,i,b,v,y,o,x,r,s,_,I,S,T,w,C,k,F,n,l,d,M,c,R,D,A,P,u,p,m,L,B,V,O){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var E=l.strings;g.itemTileEngagementPart=new P.EngagementPart("ItemTile",3);var h=function(h){t.__extends(e,h);function e(e){var t=h.call(this,e)||this;t.imageFrameTagName=k.default.tagName;t.newBadgeTagName=F.default.tagName;t.itemCheckTagName=O.default.tagName;t.addBindingHandlers({delayedHasFocus:T.default,element:L.default,react:A.default,dragAndDrop:w.default});var i=e.item,o=e.customTemplateName,r=void 0===o?"":o,n=e.cellSize,a=void 0===n?t.createObservable({width:100,height:100}):n,s=e.engagementSource,l=void 0===s?"ItemTile":s,d=e.isInteractable,c=void 0===d||d,u=e.button;t._selectionHelper=t.resources.consume(R.resourceKey);t.inputElement=t.createObservable();t.resources.expose(P.engagementSourceResourceKey,t.resources.consume(P.engagementSourceResourceKey).withPart(g.itemTileEngagementPart));t._urlDataSource=t.resources.consume(x.url);t._displayImageTileNames=!!t.resources.isExposed(b.displayImageTileNames)&&t.resources.consume(b.displayImageTileNames);t.parentItem=t.resources.consume(b.currentItem);t.item=t.resources.expose(b.currentItem,t.wrapObservable(i));t._instrumentationProvider=t.resources.consume(I.instrumentation);t._platform=t.resources.consume(M.platformDetection);t._isSelectionModal=t.resources.consume(_.isSelectionModalResourceKey);var p=t.resources.consume(b.actionMap);t._customTemplateName=r;t.selectionModel=t.resources.consume(b.itemsSelection);t.draggable=c;t.isInteractable=c;t.isDroppingTarget=t.createObservable(!1);t.isReceivingDrop=t.createObservable(!1);t.isSelected=t.createObservable(!1);t.focusState=t.createObservable(0);t.isFocused=t.createPureComputed(function(){return!!t.focusState()});t.ignoreClickTime=t.createObservable(0);t.thumbnailError=t.createObservable();t.isThumbnailLoaded=t.createObservable(!1);t.pulseTarget=t.createObservable();t._folderChildCount=t.createObservable("");t.showPerson=t.createObservable(!1);t.button=u;t.imageRect=a;t.imageRect.equalityComparer=y.deepCompare;t.thumbnail=t.createPureComputed(t._computeThumbnail);t.thumbnail.equalityComparer=y.deepCompare;t._hasThumbnailError=t.createPureComputed(t._computeHasThumbnailError);t.hasThumbnail=t.createPureComputed(t._computeHasThumbnail);t.templateName=t.createPureComputed(t._computeTemplateName);t._action=new(t.child(p.DefaultClickAction))({item:t.item,userInvokedItem:!0,sourceEngagement:l+".Click"});t.isInvokable=t.createPureComputed(t._computeIsInvokable);t.rotation=t.createPureComputed(t._computeRotation);t.linkUrl=t.createPureComputed(t._computeLinkUrl);t.subText=t.createPureComputed(t._computeSubText);t.childCount=t.createComputed(t._computeChildCount);t.tagCount=t.createPureComputed(t._computeTagCount);t.longTagTooltip=t.createPureComputed(t._computeLongTagTooltip);t.isShared=t.createPureComputed(t._computeIsShared);t.isBundle=t.createPureComputed(t._computeIsBundle);t._subTextIconType=t.createPureComputed(t._computeSubTextIconType);t.subTextIconUrl=t.createPureComputed(t._computeSubTextIconUrl);t.subTextIconClass=t.createPureComputed(t._computeSubTextIconClass);t.isSubTextVisible=t.createPureComputed(t._computeIsSubTextVisible);t.isSelectable=t.createPureComputed(t._computeIsSelectable);t.dateText=t.createPureComputed(t._computeDateText);t.isDateVisible=t.createPureComputed(t._computeIsDateVisible);t.showTagCount=C.isFeatureEnabled(C.ShowTagCountInPhotos);t.newBadgeParams={desiredSize:t.createObservable("Small")};t.isCheckVisible=t.createPureComputed(function(){return t._platform.isMobile&&(t._isSelectionModal()||0<t.selectionModel.selection().length)});t._dropHelper=t.resources.consume(v.resourceKey);t.iconSize=t.createPureComputed(t._computeIconSize);t.desiredSize=t.createPureComputed(t._computeDesiredIconSize);t.isDroppable=t.createPureComputed(t._computeIsDroppable);t.tabindex=t.createPureComputed(function(){return t.selectionModel.focusedItem()===t.item?0:-1});t.isNamePlateVisible=t.createPureComputed(t._computeIsNamePlateVisible);t.colorName=t.createPureComputed(t._computeColorName);t.hasImageStack=t.createPureComputed(t._computeHasImageStack);var m=t.resources.consume(I.uploadTeachingBubble.optional);if(m){t.addBindingHandlers({teachingBubble:D.default});t.teachingBubbleOptions=m.getTeachingBubbleForKey(t.item.peek().key)}t.itemAutomationId=t.createPureComputed(function(){var e=t.item();if(e)return e.displayName});t.createBackgroundComputed(function(){t.isReceivingDrop()&&t.isReceivingDrop(!1)}).extend({rateLimit:{timeout:1450,method:"notifyWhenChangesStop"}});t.createBackgroundComputed(function(){var e=t.item();e&&!e.isPlaceholder&&t._instrumentationProvider.userSeeItem(e)});t.createBackgroundComputed(function(){t._updateSelectionSubscription(t.item)});t._deferredLoadedTemplateName=t.createObservable(void 0);t.createBackgroundComputed(t._computeDeferredLoadedTemplateName);t.enableFileHoverCard=t.createPureComputed(t._fileHoverCardAvailable);t.fileHoverCardComponent={componentPath:"odsp-next/controls/fileHoverCard/react/FileHoverCard",getModule:function(){return new S.default(function(e,t){f(["odsp-next/controls/fileHoverCard/react/FileHoverCard"],e,t)})},props:t.createPureComputed(t._computeFileHoverCardProps)};return t}e.prototype.dispose=function(){this._updateSelectionSubscription(null);h.prototype.dispose.call(this)};e.prototype.onItemCheckClick=function(e,t){t.shiftKey?this.selectionModel.selectToItem(this.item):this.selectionModel.toggleItemSelected(this.item);this.selectionModel.setItemFocus(this.item,{preventAnchor:!!t.shiftKey});t.preventDefault();t.stopPropagation();return!1};e.prototype.onClick=function(e,t){var i=this.ignoreClickTime(),o=(new Date).getTime();if(i&&o-i<=50){t.stopPropagation();t.preventDefault();return!1}if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}return!0};e.prototype.onMouseDown=function(e,t){if(!this.isInteractable||2===t.button)return!0;var i=!!c.findAncestor(t.target,"ItemTile-rowCheck"),o=this.selectionModel.isItemSelected(this.item);if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){o||i||this.selectionModel.clear();i||this.selectionModel.setItemSelected(this.item,!0)}};e.prototype.onInvoke=function(e){if(!!!c.findAncestor(e.target,"ItemTile-rowCheck")&&this._action.isAvailable.peek()){this._action.execute(e).done();e.stopPropagation();e.preventDefault();return!1}};e.prototype.getRowAriaLabel=function(){return n.getRowAriaLabel(this.item())};e.prototype.getDragData=function(){var e=this,t=this.item.peek(),i=null,o=this.selectionModel;t.isDraggable&&o.isItemSelected(this.item)&&(i={type:1,item:t,itemSet:o.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:o.selectedCount.peek(),resources:o.resources}});return i};e.prototype.onMayReceiveDrop=function(e){var t=this.item&&this.item.peek&&this.item.peek();return t&&t.isDropEnabled&&e.item!==t&&(1===e.type||0===e.type)?{targetName:t.name}:null};e.prototype.onReceiveDrop=function(e){var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.isReceivingDrop(!0);return t};e.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1);this.pulseTarget().enablePulsing(!0)};e.prototype.getItem=function(){return this.item};e.prototype.isTag=function(){return!!this.item().tagInfo};e.prototype.isFolder=function(){return this.item().type===a.default.Folder};e.prototype.isFile=function(){return this.item().type!==a.default.Folder&&!this.isMedia()};e.prototype.isDiscoverCard=function(){return this.item().queryType===s.default.Discover};e.prototype.isMedia=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames};e.prototype.isAlbum=function(){return this.item().isAlbum};e.prototype.isStory=function(){return C.isFeatureEnabled(C.EnableEvokeAlignments)&&this.isAlbum()};e.prototype.isVideo=function(){return!!this.item().video&&this.hasThumbnail()&&!this._displayImageTileNames};e.prototype.isPhoto=function(){return this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames};e.prototype.hasNewBadge=function(){var e=this.item();return!C.isFeatureEnabled(C.EnableEvokeAlignments)&&!(!e.properties.newTag||!e.properties.autoAlbumTag)};e.prototype.onButtonClick=function(e,t){if(this.button&&this.button.action){t.stopPropagation();return this.button.action.execute(t)}return S.default.wrap({resultType:m.ResultTypeEnum.ExpectedFailure})};e.prototype._fileHoverCardAvailable=function(){var e=this.item();return V.shouldEnableFileHoverCard(e,this.resources)};e.prototype._computeFileHoverCardProps=function(){var e=this.item(),t=this.inputElement();return{item:e,resources:this.resources,target:t}};e.prototype._computeSubTextIconType=function(){var e=this.item();return e.isViolation||e.policyTip&&2<=e.policyTip?4:e.properties.CheckedOutUserId?2:1===e.policyTip?3:this.isVideo()?5:this.isShared()?1:0};e.prototype._computeHasImageStack=function(){return"ms-item-tile-folder"===this.templateName()};e.prototype._computeSubTextIconUrl=function(){return 2!==this._subTextIconType()?"":"undefined"==typeof __webpack_public_path__?f.toUrl("odsp-media/images/overlays/checkoutoverlaygrid.svg"):f("@ms/odsp-media/dist/media/images/overlays/checkOutOverlayGrid.svg")};e.prototype._computeDateText=function(){var e=this.item();if(this.isAlbum()){if(C.isFeatureEnabled(C.EnableEvokeAlignments)&&e.dateCreatedTime){var t={month:"long",day:"numeric",year:void 0};e.dateCreatedTime.getFullYear()!==(new Date).getFullYear()&&(t.year="numeric");return e.dateCreatedTime.toLocaleDateString(p.default.language,t)}return e.dateCreated}return""};e.prototype._computeIsDateVisible=function(){var e=this.dateText();return!(!e||!e.length)};e.prototype._computeIsNamePlateVisible=function(){var e=this.item();return!this.isMedia()||e.isViolation};e.prototype._computeSubTextIconClass=function(){switch(this._subTextIconType()){case 1:return"ItemTile-sharingIcon ItemTile-subTextIcon "+B.getIconClassName("People");case 2:return"ItemTile-subTextImageShort";case 4:return"ItemTile-blockIcon ItemTile-subTextIcon "+B.getIconClassName("DRM");case 3:return" ItemTile-subTextIcon "+B.getIconClassName("IncidentTriangle");case 5:return"ItemTile-playButton "+B.getIconClassName("Play");case 6:return"ItemTile-badPhotoIcon "+B.getIconClassName("IncidentTriangle");default:return""}};e.prototype._computeTemplateName=function(){var e=this._deferredLoadedTemplateName();return this._customTemplateName?this._customTemplateName:this._isUsingDeferredLoadedTemplate()?e:this.isFolder()?"ms-item-tile-folder":this.isPhoto()?"ms-item-tile-photo":this.isVideo()?"ms-item-tile-video":"ms-item-tile-file"};e.prototype._isUsingDeferredLoadedTemplate=function(){return this.isStory()||this.isDiscoverCard()||this.isTag()};e.prototype._computeDeferredLoadedTemplateName=function(){var t,i=this;this.isStory()?t="ms-item-tile-album":this.isDiscoverCard()?t="ms-item-tile-discover":this.isTag()&&(t="ms-item-tile-tag");t&&u.loadModule({path:"odsp-next/controls/itemTile/ItemTileDeferred",getModule:function(){return new S.default(function(e,t){f(["odsp-next/controls/itemTile/ItemTileDeferred"],e,t)})}}).then(function(e){i._deferredLoadedTemplateName(t)})};e.prototype._computeIsSelectable=function(){var e=this.item();return this.isInteractable&&this.selectionModel.canSelectItem(this.item)&&!e.tagInfo};e.prototype._computeThumbnail=function(){var e=this.item();return(e.orientedThumbnail||e).thumbnail};e.prototype._computeRotation=function(){var e=this.item().orientedThumbnail;return e?e.rotation:i.default.none};e.prototype._computeIconSize=function(){return this.hasThumbnail()?32:96};e.prototype._computeDesiredIconSize=function(){var e=.77*(this.imageRect().height-48);return this.hasThumbnail()?32:Math.min(96,Math.ceil(e))};e.prototype._computeIsSubTextVisible=function(){var e=this.item(),t=this.parentItem?this.parentItem():null;return e.type!==a.default.Folder||t&&(t.queryType===s.default.SharedWithMe||t.queryType===s.default.Discover)};e.prototype._computeLinkUrl=function(){var e=this.item(),t=this.resources.consume(b.currentItemSet);return this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0,itemSet:t()})};e.prototype._computeSubText=function(){var e="",t=this.item(),i=this.resources.consume(b.currentItemSet);switch(i?i().sortField:"name"){case"size":e=r.default.getDisplayString(t.size,{ignoreZero:!0});break;case"dateTaken":e=t.dateTaken;break;case"dateModified":e=t.dateModified;break;default:e=t.defaultSubText||""}t.queryType===s.default.Discover&&(e=this._getTidBit(t));return e};e.prototype._getTidBit=function(e){if(5<e.viewersCount){this.showPerson(!1);return E.popular}if(e.editorName&&e.editorsCount&&1<e.editorsCount){this.showPerson(!0);return d.format(E.modifiedByPersonAndOthers,e.editorName,e.editorsCount-1)}if(2<e.viewersCount){this.showPerson(!1);return E.popular}if(e.editorName){this.showPerson(!0);return d.format(E.modifiedBy,e.editorName)}this.showPerson(!1);return E.relevant};e.prototype._computeChildCount=function(){var t=this,i=this.item(),e="",o=this.resources.consume(x.url).getQueryType(),r="number"==typeof i.childCount&&!isNaN(i.childCount);if(i.type===a.default.Folder&&(i.queryType!==s.default.SharedWithMe||!i.isRootFolder)&&(!this._urlDataSource.isRecycleBin(i.queryType)||r||i.folder&&0<i.folder.totalCount))if(r)e=String(i.childCount);else if(o===s.default.Files){var n=this.resources.consume(x.folderItemCount.optional);n&&n.getFolderItemCountInfo(i).then(function(e){if(e){i.childCount=e.itemCount;t._folderChildCount(String(i.childCount))}},function(e){})}this._folderChildCount(e);return this._folderChildCount()};e.prototype._computeHasThumbnailError=function(){var e=this._hasThumbnailError.peek();e||(e=!!this.thumbnailError());return e};e.prototype._computeTagCount=function(){var e=this.item();return e.tagInfo&&e.folder?String(e.folder.childCount):""};e.prototype._computeLongTagTooltip=function(){var e=this.item();return e.tagInfo&&e.name&&50<e.name.length?e.name:""};e.prototype._computeIsShared=function(){var e=this.item().sharingType;return o.showSubTextSharingIcon(e)};e.prototype._computeIsBundle=function(){return this.item().isBundle};e.prototype._computeIsDroppable=function(){return this.item().isDropEnabled&&this.isInteractable};e.prototype._computeIsInvokable=function(){return!this._isSelectionModal()&&this._action.isAvailable()};e.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&this.isInteractable&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{isSelected:this.isSelected,isFocused:this.createObservable(!1),focusState:this.focusState,onInvoke:function(e){return t.onInvoke(e)}}))};e.prototype._computeHasThumbnail=function(){return!!this.thumbnail()&&(this.isThumbnailLoaded()||!this._hasThumbnailError())};e.prototype._computeColorName=function(){return""};return e}(e.default);g.default=h});define("odsp-next/bindings/focus/DelayedHasFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t,i,o=n.call(this,e)||this,r=o.valueAccessor();i=(t=o.isObservable(r)?{hasFocus:r}:r).focusState?t.focusState:t.hasFocus?o.createComputed({read:function(){return t.hasFocus()?2:0},write:function(e){return t.hasFocus(!!e)},pure:!0}):o.createObservable(0);o._focusState=i;o._asyncUpdateFocus=o.async.debounce(o._updateFocus,30);o.events.on(o.element,"focus",o._onFocus);o.events.on(o.element,"blur",o._onBlur);o.subscribe(o._focusState,o._onFocusStateChanged);t.timeout?o.async.setTimeout(o._startUpdateFocus,t.timeout):o._startUpdateFocus();return o}e.prototype._onFocus=function(){this._focusState(2);this._startUpdateFocus()};e.prototype._onBlur=function(){this._focusState(0);this._startUpdateFocus()};e.prototype._onFocusStateChanged=function(){this._startUpdateFocus()};e.prototype._startUpdateFocus=function(){this._focusAttempts=0;this._updateFocus()};e.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=r.getScrollContainer(this.element),i=void 0,o=void 0;t&&(i=t.scrollTop,o=t.scrollLeft);this.element.focus();if(t&&1===e){t.scrollTop!==i&&(t.scrollTop=i);t.scrollLeft!==o&&(t.scrollLeft=o)}!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()};e.prototype._checkIfFocused=function(){var t,i=this.element.ownerDocument;try{t=i.activeElement}catch(e){t=i.body}return t===this.element};return e}(o.default);t.default=n});define("odsp-next/controls/image/frame/ImageFrame",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageFrameViewModel","./ImageFrame.html","./ImageFrame.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-image-frame",template:e("./ImageFrame.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/image/frame/ImageFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/images/ThumbnailCache","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/object/ObjectUtil","../ImageEqualityComparer","../stack/ImageStack"],function(e,t,i,o,S,r,T,w,C,k,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAYOUT_THROTTLE_MS=300;var n=function(I){i.__extends(e,I);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=I.call(this,e,t)||this;i.imageStackTagName=F.default.tagName;var o=e.image,r=e.rotation,n=void 0===r?S.default.none:r,a=e.alignment,s=e.desiredSize,l=e.isLoaded,d=e.isCurrent,c=e.error,u=e.coverage,p=void 0===u?{minimum:1,maximum:1}:u,m=e.scale,h=e.fadeIn,f=e.allowLoading,g=e.position,b=e.loadImageScenarioName,v=t.thumbnailCache,y=void 0===v?i.resources.consume(T.resourceKey):v,x=t.outputExtenders,_=void 0===x?{deferred:!0}:x;i._thumbnailCache=y;i._image=i.wrapObservable(o);i._rotation=i.wrapObservable(n);i._alignment=w.createAlignment(a);i._desiredSize=i.wrapObservable(s);i._isLoaded=l;i._coverage=i.wrapObservable(p);i._loadedImage=i.createObservable();i._effectiveDesiredSize=i.createPureComputed(i._computeEffectiveDesiredSize);i._effectiveDesiredSize.equalityComparer=C.deepCompare;i._idealSize=i.createPureComputed(i._computeIdealSize);i._idealSize.equalityComparer=C.deepCompare;i._idealImage=i.createPureComputed(i._computeIdealImage);i._idealImage.equalityComparer=k.compareImages;i._fallbackImage=i.createPureComputed(i._computeFallbackImage);i._fallbackImage.equalityComparer=k.compareImages;i._cachedImage=i.createPureComputed(i._computeCachedImage);i._cachedImage.equalityComparer=k.compareImages;i._currentImage=i.createPureComputed(i._computeCurrentImage);i._currentImage.equalityComparer=k.compareImages;i._isCurrent=i.createPureComputed(i._computeIsCurrent);i.imageStackParams={image:i._currentImage,rotation:i._rotation,desiredSize:i._desiredSize,loadedImage:i._loadedImage,isLoaded:i._isLoaded,error:c,scale:m,alignment:i._alignment,fadeIn:h,allowLoading:f,position:g,loadImageScenarioName:b};d&&i.createBackgroundComputed(function(){return d(i._isCurrent())}).extend(_);return i}e.prototype._computeIsCurrent=function(){return k.compareImages(this._loadedImage(),this._idealImage())};e.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),i=this._cachedImage(),o=this._fallbackImage();return e?k.compareImages(e,t)?this._currentImage.peek():t:i||o||t};e.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),i=window.devicePixelRatio||1;t&&(e={width:t.width*i,height:t.height*i});return e};e.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var i=t.width,o=t.height,r=this._effectiveDesiredSize();if(r&&r.width&&r.height){if(i&&o){var n=this._alignment.getTransform(t,r);e={width:n.scale*t.width,height:n.scale*t.height}}}else e={width:i,height:o}}return e};e.prototype._computeIdealImage=function(){var e,t=this._image(),i=this._idealSize();t&&(i?(e=this._getDerivedImage(t,i))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,i,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t);return e};e.prototype._computeFallbackImage=function(){var e,t=this._image(),i=this._idealSize();if(i&&t&&t.width){var o=this._coverage(),r=(void 0===o?{}:o).fallback,n=void 0===r?0:r;if(n){var a={width:i.width*n,height:i.height*n};(e=this._getDerivedImage(t,a))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,a,!1)}}return e};e.prototype._computeCachedImage=function(){var e,t=this._image(),i=this._idealSize();if(i&&t&&t.width){var o=this._thumbnailCache.getCoveragePercent(t,i),r=this._coverage(),n=void 0===r?{}:r,a=n.minimum,s=void 0===a?1:a,l=n.maximum,d=s*o,c=(void 0===l?1:l)*o;e=this._thumbnailCache.retrieve(t,c,d)}return e};e.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:r.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}};return e}(o.default);t.default=n});define("odsp-next/controls/image/ImageEqualityComparer",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.compareImages=function(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}});define("odsp-next/controls/image/stack/ImageStack",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageStackViewModel","./ImageStack.html","./ImageStack.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-image-stack",template:e("./ImageStack.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/image/stack/ImageStackViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/BaseModel","../ImageEqualityComparer","@ms/odsp-utilities/lib/object/ObjectUtil","../tile/ImageTile","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,i,o,r,T,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.hasAnimated,o=e.fadeIn,r=e.image,n=e.referenceImage,a=e.referenceRotation;t._fadeIn=o;t._image=r;t._referenceImage=n;t._referenceRotation=a;t.isLoaded=t.createObservable(!1);t._hasAnimated=t._getHasAnimated();t.rotation=t.createPureComputed(t._computeRotation);t.createBackgroundComputed(function(){return i(t._hasAnimated())});return t}e.prototype._getHasAnimated=function(){var t=this,i=this.createObservable(!1);return this.createPureComputed(function(){var e;if(t.isLoaded.peek())(e=i())||t.async.setTimeout(function(){return i(!0)},t._fadeIn.peek()?2e3:50);else{t.isLoaded();e=!1}return e})};e.prototype._computeRotation=function(){var e=this.rotation.peek();(T.compareImages(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation());return e};return e}(r.default);t.AnimationTracker=k;var n=function(S){i.__extends(e,S);function e(e,t){void 0===t&&(t={});var i=S.call(this,e,t)||this;i.imageTileTagName=C.default.tagName;var o=e.image,r=e.rotation,n=e.desiredSize,a=e.scale,s=void 0===a?1:a,l=e.fadeIn,d=void 0===l||l,c=e.allowLoading,u=void 0===c||c,p=e.isLoaded,m=e.isCurrent,h=e.alignment,f=e.position,g=e.loadedImage,b=e.error,v=e.loadImageScenarioName,y=t.outputExtenders,x=void 0===y?{deferred:!0}:y,_=t.AnimationTracker,I=void 0===_?k:_;i._animationTrackerType=I;i._image=i.wrapObservable(o);i._rotation=i.wrapObservable(r);i._desiredSize=n;i._scale=s;i.fadeIn=i.wrapObservable(d);i._allowLoading=i.wrapObservable(u);i._alignment=h;i._scenarioName=v;i._tileDefinitions=i.createPureComputed(i._computeTileDefinitions);i._position=i.createPureComputed(i._computePosition);i._position.equalityComparer=w.deepCompare;i._loadedImage=i.createPureComputed(i._computeLoadedImage);i._loadedImage.equalityComparer=T.compareImages;i._error=i.createPureComputed(i._computeError);i._error.equalityComparer=w.deepCompare;i.tiles=i._getTiles();f&&i.createBackgroundComputed(function(){return f(i._position())}).extend(x);g&&i.createBackgroundComputed(function(){return g(i._loadedImage())}).extend(x);p&&i.createBackgroundComputed(function(){return p(!!i._loadedImage())}).extend(x);m&&i.createBackgroundComputed(function(){return m(T.compareImages(i._loadedImage(),i._image()))}).extend(x);b&&i.createBackgroundComputed(function(){return b(i._error())}).extend(x);return i}e.prototype._computeError=function(){for(var e,t=this.tiles(),i=t.length-1;0<=i;i--){var o=t[i],r=o.isLoaded,n=o.error;if(r())break;if(n()){e=n();break}}return e};e.prototype._computePosition=function(){for(var e,t=this.tiles(),i=t.length-1;0<=i;i--){var o=t[i],r=o.isLoaded,n=o.position;if(r()){e=n();break}}return e};e.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),i=t.length-1;0<=i;i--){var o=t[i],r=o.isLoaded,n=o.image;if(r()){e=this.unwrapObservable(n);break}}return e};e.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),i=void 0===t?[]:t;if(e){if(this._allowLoading()){var o=void 0,r=void 0,n=void 0,a=i[i.length-1];if(a){o=T.compareImages(a.image,e);r=a.hasAnimated.peek();n=!!a.error.peek()}else r=o=!1;if(o)r?i=[a]:a.hasAnimated();else{if(!a||r||n){a={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)};i=i.concat([a])}a.hasAnimated();a.error()}}}else i=[];return i};e.prototype._getTiles=function(){var n=this,e=this.observables.createArray(),t=this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var t=e.image,i=e.error,o=e.hasAnimated,r=new(n.managed(n._animationTrackerType))({hasAnimated:o,image:t,referenceRotation:n._rotation,referenceImage:n._image,fadeIn:n.fadeIn});return{mappedValue:{image:t,rotation:r.rotation,isLoaded:r.isLoaded,error:i,scale:n._scale,desiredSize:n._desiredSize,alignment:n._alignment,position:n.createObservable(),loadImageScenarioName:n._scenarioName},dispose:function(){r.dispose()}}}}));this.createBackgroundComputed(function(){e.splice.apply(e,[0,e.peek().length].concat(n._tileDefinitions()))});return t};return e}(o.default);t.default=n});define("odsp-next/controls/image/stack/ImageStack.html",[],function(){return"<span class=od-ImageStack data-bind=\"css: { 'od-ImageStack--fade': fadeIn }, template: { foreach: tiles }\"><span class=od-ImageStack-tile data-bind=\"css: { 'od-ImageStack-tile--isLoaded': $data.isLoaded, }, component: { name: $component.imageTileTagName, params: $data }\"></span></span>"});define("odsp-next/controls/image/stack/ImageStack.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}])});define("odsp-next/controls/image/frame/ImageFrame.html",[],function(){return'<span class=od-ImageFrame data-bind="component: { name: $component.imageStackTagName, params: $component.imageStackParams }"></span>'});define("odsp-next/controls/image/frame/ImageFrame.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}])});define("odsp-next/controls/newBadge/NewBadge",["require","exports","./NewBadgeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./NewBadge.html","./NewBadge.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-new-badge",template:e("./NewBadge.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/newBadge/NewBadgeViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../controls/commands/Commands.resx"],function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.newItemText=r.strings.Create.toUpperCase();return t}return e}(i.default);t.default=n});define("odsp-next/controls/newBadge/NewBadge.html",[],function(){return'<div class=od-newBadge><span class="od-newBadge-icon ms-Icon ms-Icon--Glimmer" data-bind="icon: true"></span> <span class=od-newBadge-text data-bind="text: newItemText"></span></div>'});define("odsp-next/controls/newBadge/NewBadge.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-newBadge{font-size:11px;font-weight:600}.od-newBadge .od-newBadge-icon{-ms-transform:translate(0,-.6em);transform:translate(0,-.6em)}[dir=ltr] .od-newBadge .od-newBadge-icon{margin-right:-.46em}[dir=rtl] .od-newBadge .od-newBadge-icon{margin-left:-.46em}html[dir=rtl] .od-newBadge .od-newBadge-icon{-ms-transform:translate(0,-.6em) scale(-1,1);transform:translate(0,-.6em) scale(-1,1)}"}])});define("odsp-next/dataSources/base/AriaHelper",["require","exports","../../models/item/SharingType","../../models/item/ItemType","../../models/item/Item.resx","../../models/item/LifeCycleStatus","../../utilities/features/Features","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../url/QueryType","../../utilities/list/ListUtilities.resx","../../utilities/complianceTag/ComplianceTagUtilities","@ms/odsp-utilities/lib/list/SharingTypeHelper","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,p,s,m,h,f,g,i,b,v,l,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRowAriaLabel=function(e){var t,i,o=[],r=x(e)||e.name,n=_(e)||e.dateModified,a=e.defaultSubText,s=e.size,l=h.getStatusToDisplay(e.lifeCycleStatus);r&&o.push(r);f.isFeatureEnabled(f.EnableUpdatedFilesListView)&&f.isFeatureEnabled(f.FlipOnNewGridAndListExperiment)&&0<l&&o.push((t=l,((i={})[3]=b.strings.TrendingStatus,i[2]=b.strings.NewStatus,i)[t]||""));n&&o.push(n);a&&o.push(a);s&&o.push(g.default.getDisplayString(s,{ignoreZero:!0}));if(e.folder){var d=e.folder.totalCount,c=void 0===d?e.childCount:d;o.push(y.format(y.getLocalizedCountValue(m.strings.itemCountFormat,m.strings.itemCountIntervals,c),c))}e.sharingType===p.default.Shared?o.push(b.strings.SharedStatus):o.push(b.strings.NotSharedStatus);if(v.complianceRecordFlagValue(e)){var u=v.getRecordLabelHoverText();o.push(u)}return o.join(", ")||void 0};function o(e){var t=e.extension,i=[];if(e.type===s.default.Folder)i.push(l.useSharedFolderAriaLabel(e.sharingType)?m.strings.fileTypeSharedFolder:m.strings.fileTypeFolder);else{var o=e.appMap;if(o){var r=o.toLowerCase();-1!==r.indexOf("ms-word")?i.push(m.strings.fileTypeDoc):-1!==r.indexOf("ms-excel")?i.push(m.strings.fileTypeXls):-1!==r.indexOf("ms-powerpoint")?i.push(m.strings.fileTypePpt):-1!==r.indexOf("onenote")&&i.push(m.strings.fileTypeOneNotebook)}else if(e.type===s.default.Media&&e.photo)i.push(y.format(m.strings.fileTypeImage,t||"").trim());else if(t){var n="."===t[0]?t.substring(1):t;i.push(y.format(m.strings.fileTypeUnknown,n))}var a=d(e);a&&i.push(a)}return i.join(", ")}t.getIconFieldAriaLabelForItem=o;function x(e){var t=[],i=o(e);t.push(e.name);i&&t.push(i);return t.join(", ")}t.getNameFieldAriaLabelForItem=x;function _(e){return!e.dateDeleted||e.queryType!==i.default.RecycleBin&&e.queryType!==i.default.SecondStageRecycleBin?e.dateModified?y.format(m.strings.dateModifiedLabelFormat,e.dateModified):void 0:y.format(m.strings.dateDeletedLabelFormat,e.dateDeleted)}t.getModifiedFieldAriaLabelForItem=_;function d(e){var t=[];e.itemStatus?t.push(m.strings.sharedViolationWarningViewer):e.isViolation&&t.push(m.strings.sharedViolationWarning);e.policyTip&&(2&e.policyTip?t.push(m.strings.policyTipBlockText):1===e.policyTip&&t.push(m.strings.policyTipNotifyText));e.hasMissingMetadata&&t.push(m.strings.missingMetadataText);if(v.complianceRecordFlagValue(e)){var i=v.getRecordLabelHoverText();t.push(i)}var o=e.properties.CheckoutUser,r=(void 0===o?[]:o)[0],n=(void 0===r?{}:r).title,a=void 0===n?void 0:n;a&&t.push(y.format(m.strings.checkedOutTo,a));return t.join(" ")}t.getTooltipText=d});define("odsp-next/models/item/LifeCycleStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStatusToDisplay=function(e){if(e&&0<Object.keys(e).length){if(e.isMalwareDetected)return 4;if(e.isExternal)return 1;if(e.isTrending)return 3;if(e.isNew)return 2}return 0}});define("odsp-next/utilities/complianceTag/ComplianceTagUtilities",["require","exports","../../controls/fieldEditor/booleanEditor/BooleanEditor.resx","@ms/odsp-utilities/lib/string/StringHelper","./ComplianceTagUtilities.resx"],function(e,i,t,s,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";i.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";i.ASSETID_FIELD_NAME="ComplianceAssetId";i.ASSETID_FIELD_ID="3A6B296C-3F50-445C-A13F-9C679EA9DDA3";i.MAX_ITEM_SIZE=200;i.isClientFormComplianceAssetIdField=function(e){return!!(e&&e.schema&&o(e.schema.FieldType,e.schema.Id))};function o(e,t){return!(!e||"text"!==e.toLowerCase()||!t||t.toLowerCase()!==i.ASSETID_FIELD_ID.toLowerCase())}i.isComplianceAssetIdField=o;i.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&r(e.schema.FieldType,e.schema.Id))};function r(e,t){return!(!e||"lookup"!==e.toLowerCase()||!t||t.toLowerCase()!==i.COMPLIANCETAG_FIELD_ID.toLowerCase())}i.isComplianceTagField=r;i.complianceRecordFlagValueAsYesNoString=function(e){return n(e)?t.strings.yes:t.strings.no};function n(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(4&t&&1&t)return!0}return!1}i.complianceRecordFlagValue=n;i.getRecordLabelHoverText=function(){return l.strings.RecordLabelHoverText};i.getPlaceholder=function(){return l.strings.ComplianceTagFieldPlaceHolder};i.getTagDescription=function(e){if(!e.HasRetentionAction)return"";if(0===e.TagDuration)return e.BlockDelete?l.strings.RetainForeverText:"";var t=a(e.TagDuration);return e.BlockDelete?s.format(l.strings.PreserveTagText,t):e.AutoDelete?s.format(l.strings.DeleteTagText,t):""};i.getTagTooltip=function(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return l.strings.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?l.strings.PreserveForeverTooltip:l.strings.NoRetentionTooltip;var t=a(e.TagDuration),i="",o="";if(e.BlockDelete){i="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(o=l.strings.PreserveIsRecordTooltipModifier);e.ReviewerEmail?o+=l.strings.ReviewTooltip:o+=e.AutoDelete?l.strings.PreserveAutoDeleteTooltipModifier:l.strings.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(i="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var r=l.strings[i];return r?s.format(r,t)+o:null};function a(e){var t="";if(0<e){var i=Math.floor(e/365);if(0<i){var o=1<i?l.strings.RetentionPeriodYears:l.strings.RetentionPeriodYear;t=s.format(o,i)}else{var r=Math.floor(e/30);if(0<r){var n=1<r?l.strings.RetentionPeriodMonths:l.strings.RetentionPeriodMonth;t=s.format(n,r)}else{var a=1<e?l.strings.RetentionPeriodDays:l.strings.RetentionPeriodDay;t=s.format(a,e)}}}return t}i.getDurationAsString=a});define("odsp-next/controls/fileHoverCard/react/FileHoverCardHelper",["require","exports","../../../utilities/features/Features","../../../models/item/ItemType","../../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/ABExperiment","../../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/logging/events/Experiment.event","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,o,r,n,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d,c=o.isFeatureEnabled(o.ItemAnalyticsUX);t.shouldEnableFileHoverCard=function(e,t){var i=o.isFeatureEnabled(o.HoverCardInSharedByMe);return c&&e.type!==r.default.Folder&&(e.queryType===n.default.Files||e.queryType===n.default.DocumentLibraries||i&&e.queryType===n.default.SharedByMe)};function u(){d||(d=new i.ABExperiment({name:"FileHoverCardAssign",startDate:"1/26/2018"}));return d}t.getABExperiment=u;t.shouldShowCard=function(){return u().IsExperimentOn()||a.default.isActivated("10694632-7335-422F-B6FE-A8357D7C475D","02/01/2018","Disable ABExperiemtn in SPDF and MSIT")};t.logExperiment=function(){var e=u();a.default.isActivated("10694632-7335-422F-B6FE-A8357D7C475D","02/01/2018","Disable ABExperiemtn in SPDF and MSIT")||s.default.logData({name:"",isInRamp:e.IsExperimentOn(),experiment:"FileHoverAB",variant:e.IsExperimentOn().toString()})};t.getGraphAccessToken=function(e,t){return e.getAccessToken(t,{apiVersion:l.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E")?"v2.0":"v2.1"})};t.getGraphItemUrl=function(e,t){return e&&e.getItemUrl(t,{useDirectEndpoint:!0,apiVersion:l.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1"})}});define("@ms/odsp-utilities/lib/killswitch/Killswitch",["require","exports","../guid/Guid"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function r(){}r.initKillSwitches=function(e){r._killSwitches=e||{}};r.isActivated=function(e,t,i){var o=window._spPageContextInfo;!r._killSwitches&&o&&o.killSwitches&&r.initKillSwitches(o.killSwitches);return e&&r._killSwitches&&r._killSwitches[n.default.normalizeUpper(e,!1)]};return r}();t.Killswitch=i;t.getKillSwitch=function(e){var o=e&&e.killSwitches;return{isActivated:function(e,t,i){return!!o&&!!o[n.default.normalizeUpper(e,!1)]}}}});define("odsp-next/controls/itemCheck/ItemCheck",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemCheckViewModel","./ItemCheck.html","./ItemCheck.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"ms-item-check",template:e("./ItemCheck.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/itemCheck/ItemCheckViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(a){i.__extends(e,a);function e(e){void 0===e&&(e={});var t=a.call(this,e)||this,i=e.isSelectable,o=void 0!==i&&i,r=e.isSelected,n=void 0!==r&&r;t.isSelectable=t.wrapObservable(o);t.isSelected=t.wrapObservable(n);return t}return e}(o.default);t.default=r});define("odsp-next/controls/itemCheck/ItemCheck.html",[],function(){return'<span class=ItemCheck><i class="ItemCheck-circle ms-Icon ms-Icon--CircleRing" data-bind="icon: true"></i> <i class="ItemCheck-check ms-Icon ms-Icon--StatusCircleCheckmark" data-bind="icon: true"></i></span>'});define("odsp-next/controls/itemCheck/ItemCheck.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ItemCheck{display:none;position:relative;width:18px;height:18px;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.can-select .ItemCheck{display:block}.ItemCheck:before{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";content:'';width:16px;height:16px;position:absolute;border-radius:50%;left:1px;top:1px}.ItemCheck-circle{font-size:18px;position:absolute;left:0;top:0;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.ItemCheck-check{font-size:16px;position:absolute;left:1.5px;top:0;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";opacity:0}.od--isNonMobile .ItemCheck:hover .ItemCheck-check{opacity:1}.is-selected .ItemCheck:before{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.is-selected .ItemCheck .ItemCheck-circle{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.is-selected .ItemCheck .ItemCheck-check{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:1}"}])});define("odsp-next/controls/itemTile/ItemTile.html",[],function(){return"<div class=\"ItemTile od--hasContextMenu\" data-automationid=ms-item-tile data-bind=\"delayedHasFocus: { focusState: focusState }, class: (colorName() ? 'od-ItemTile--color-' + colorName() : ''), css: { 'is-tag': isTag(), 'is-folder': isFolder() && !isAlbum(), 'is-file': isFile(), 'is-media': isMedia(), 'is-receivingDrop': isReceivingDrop, 'is-dropping': isDroppingTarget, 'is-checkVisible': isCheckVisible, 'can-select': isSelectable, 'has-thumbnail': hasThumbnail, 'is-selected': isSelectable() && isSelected(), 'is-focused': isInteractable && isFocused(), 'od-ItemTile--isAlbum': isAlbum(), 'od-ItemTile--isStory': isStory(), 'od-ItemTile--isVideo': isVideo(), 'od-ItemTile--noDate': !isDateVisible(), 'od-ItemTile--isInteractable': isInteractable, 'od-ItemTile--isInvokable': isInvokable, 'od-ItemTile--hasImageStack': hasImageStack, 'od-ItemTile--isDiscover': isDiscoverCard() }, attr: { tabindex: tabindex, 'aria-label': getRowAriaLabel() }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }, automation: itemAutomationId, teachingBubble: teachingBubbleOptions\"><a class=ItemTile-link tabindex=-1 data-bind=\"event: { click: onClick, mousedown: onMouseDown }, element: inputElement, attr: { 'href': linkUrl, 'title': longTagTooltip }, automation: 'link'\"><div class=ItemTile-content data-bind=\"template: { name: templateName, if: templateName }\"></div><div class=ItemTile-selector><div class=ItemTile-frame data-bind=\"attr: { title: item().tooltipText }\"></div><div class=ItemTile-rowCheck data-bind=\"component: { name: itemCheckTagName, params: {} }, automation: 'select-link', event: { click: onItemCheckClick }\"></div></div></a>\x3c!--ko if: enableFileHoverCard--\x3e<div data-bind=\"react: fileHoverCardComponent\"></div>\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/itemTile/ItemTileFolder.html",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, imageRect: imageRect, pulseTarget: pulseTarget } }"></div><div class=ItemTile-dragDropIcon></div><div class=ItemTile-namePlate><div class=ItemTile-folderBeak></div><div class=ItemTile-folderBeakHighlight></div>\x3c!--ko if: !isSubTextVisible() && isShared() && !isAlbum()--\x3e<i class="ItemTile-sharingIcon ms-Icon ms-Icon--People" data-bind="icon: true"></i>\x3c!--/ko--\x3e\x3c!--ko if: hasNewBadge()--\x3e<div class=ItemTile-newBadge>\x3c!--ko component: { name: newBadgeTagName, params: newBadgeParams }--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=ItemTile-name data-bind="text: item().name"></div><div class=ItemTile-childCount data-bind="text: childCount"></div><div class=ItemTile-date data-bind="text: dateText"></div><div class=ItemTile-subText data-bind="if: isSubTextVisible() && !isAlbum()"><i class=ms-Icon data-bind="icon: true, css: { \'ItemTile-sharingIcon ms-Icon--People\': isShared() && !isBundle(), \'ms-Icon--AppIconDefault\': isBundle() }"></i> <span data-bind="text: subText"></span></div></div>'});define("odsp-next/controls/itemTile/ItemTileFile.html",[],function(){return"<div class=ItemTile-fileContainer>\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: ['fitWidth', 'top'],\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=ItemTile-fileIconContainer><div class=ItemTile-fileIcon data-bind=\"css: { 'ItemTile-fileIcon--thumbnail': hasThumbnail(), 'ItemTile-fileIcon--noThumbnail': !hasThumbnail() }, component: { name: 'ms-file-type-icon', params: { iconName: item().iconName, extension: item().extension, iconSize: iconSize(), desiredSize: desiredSize() } }\"></div></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind=\"text: item().displayName\"></div><div class=ItemTile-subText><img class=ItemTile-subTextImage data-bind=\"attr: { src: subTextIconUrl }, visible: subTextIconUrl\"> <i data-bind=\"css: subTextIconClass, visible: !subTextIconUrl()\"></i> <span data-bind=\"text: subText\"></span></div></div></div>"});define("odsp-next/controls/itemTile/ItemTilePhoto.html",[],function(){return'\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n rotation: rotation,\r\n desiredSize: imageRect,\r\n alignment: \'cover\',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isNamePlateVisible--\x3e<div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().displayName"></div><div class=ItemTile-subText><img class=ItemTile-subTextImage data-bind="attr: { src: subTextIconUrl }, visible: subTextIconUrl"> <i data-bind="css: subTextIconClass, visible: !subTextIconUrl()"></i></div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/itemTile/ItemTileVideo.html",[],function(){return"\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: 'cover',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<span class=ItemTile-playButton><i data-bind=\"css: subTextIconClass\"></i></span>"});define("odsp-next/controls/itemTile/ItemTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'@charset "UTF-8";@keyframes fadeAndScale{0%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0;animation-timing-function:ease-out}25%{transform:translate(-50%,-50%) scale(1,1);opacity:1}75%{transform:translate(-50%,-50%) scale(1,1);opacity:1;animation-timing-function:ease-in}100%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0}}@keyframes ItemScope-NewTile{0%{transform:scale(.85);opacity:0}100%{transform:scale(1);opacity:100%}}.ItemTile{position:absolute;left:0;right:0;top:0;bottom:0;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;animation-duration:267ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-iteration-count:1;animation-name:ItemScope-NewTile}@media screen and (-ms-high-contrast:active){.ItemTile{border:1px solid '},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.ItemTile .ItemTile-link{top:0;left:0;bottom:0;right:0;position:absolute}.ItemTile:focus{outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile:focus{outline:0}}.od--isNonMobile .ItemTile{transition:transform .1s linear}.od--isNonMobile .ItemTile:active{-ms-transform:scale(.96);transform:scale(.96)}.ItemTile-entity-container{display:inline}.ItemTile-entity{border-radius:50%;overflow:hidden;height:34px;width:34px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;max-width:20%}html[dir=ltr] .ItemTile-entity{float:left}html[dir=rtl] .ItemTile-entity{float:right}.ItemTile-longText{margin-left:10px;max-width:60%;display:-ms-inline-flexbox;display:inline-flex;white-space:pre-wrap}.ItemTile-image{position:absolute;top:0;left:0;right:0;bottom:0}.ItemTile-dragDropIcon{position:absolute;top:8px;right:2px;bottom:0;left:2px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";opacity:0;-ms-transform:translateY(100%);transform:translateY(100%)}.ItemTile-folderOverlay{position:absolute;display:inline-block;top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:92px;height:92px}.ItemTile-photo{position:absolute;top:0;left:0;bottom:0;right:0}.ItemTile.is-file,.ItemTile.is-media{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ItemTile.is-file .od-ImageStack-tile,.ItemTile.is-folder .od-ImageStack-tile,.ItemTile.is-media .od-ImageStack-tile{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:'}@media screen and (-ms-high-contrast:active){.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:0}}.ItemTile.is-file .od-ImageStack-tile img{box-shadow:0 0 8px 0 rgba(0,0,0,.06)}.ItemTile.is-media .od-ImageFrame::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.ItemTile-fileContainer{background-color:'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-discoverFileContainer{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-fileIconContainer{position:absolute;top:0;bottom:50px;left:0;right:0}.ItemTile.od-ItemTile--isDiscover .ItemTile-fileIconContainer{position:absolute;top:0;bottom:70px;left:0;right:0}.ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{margin:0;top:auto;bottom:0;padding:4px}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:auto}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:auto}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:0}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:0}.ItemTile-fileIcon{text-align:center}.ItemTile-fileIcon--thumbnail{position:absolute;top:50%;left:0;right:0;margin:-48px}.ItemTile-fileIcon--noThumbnail{position:relative;text-align:center;margin-top:14px}.ItemTile-rowCheck{display:none;position:absolute;top:0;width:100%;height:100%;opacity:0}[dir=ltr] .ItemTile-rowCheck{right:0}[dir=rtl] .ItemTile-rowCheck{left:0}.od-ItemTile--isInvokable .ItemTile-rowCheck{width:40px;height:40px}.is-checkVisible .ItemTile-rowCheck{opacity:1}.ItemTile.is-folder .ItemTile-rowCheck{top:6px}[dir=ltr] .ItemTile.is-folder .ItemTile-rowCheck{right:-1px}[dir=rtl] .ItemTile.is-folder .ItemTile-rowCheck{left:-1px}.ItemTile.is-folder.is-dropping .ItemTile-rowCheck,.ItemTile.is-folder.is-receivingDrop .ItemTile-rowCheck{opacity:0}.can-select .ItemTile-rowCheck{display:block}.od--isNonMobile .ItemTile.can-select:hover,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover{opacity:1}.ItemTile.is-selected .ItemTile-rowCheck,.od--isNonMobile .ItemTile:hover .ItemTile-rowCheck{opacity:1}.od-ItemTile-selector{display:none}.od-ItemTile--isInteractable .od-ItemTile-selector{display:block}.ItemTile-frame{position:absolute;display:none;left:2px;top:2px;right:2px;bottom:2px;box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile-frame{outline:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile-frame{outline:2px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-ItemTile--hasImageStack .ItemTile-frame{top:8px}@media screen and (-ms-high-contrast:active){.od-ItemTile--hasImageStack .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-tag .ItemTile-frame{top:2px}.od--isNonMobile .ItemTile.can-select:hover .ItemTile-frame,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:"}.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{display:block;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 0 2px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{-ms-transform:translateY(0);transform:translateY(0);animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ItemTile .ItemCheck{position:absolute;top:8px}[dir=ltr] .ItemTile .ItemCheck{right:8px}[dir=rtl] .ItemTile .ItemCheck{left:8px}.ItemTile-namePlate{position:absolute;bottom:0;left:0;right:0;min-height:20px;padding:4px 8px 8px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";white-space:nowrap;text-overflow:ellipsis}.ItemTile.is-file .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:35px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate{opacity:1;border-top:1px solid rgba(255,255,255,.2);max-height:74px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";height:34px;width:34px;padding-top:5px;font-size:23px}[dir=ltr] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-left:5px}[dir=rtl] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-right:5px}.ItemTile.is-media .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:17px}.ItemTile.is-folder .ItemTile-namePlate{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid rgba(255,255,255,.2);transition:transform 367ms cubic-bezier(.1,.9,.2,1)}.ItemTile.is-folder .ItemTile-namePlate::before{content:'';position:absolute;width:32%;height:16px;border-top:1px solid rgba(255,255,255,.2);top:-16px;background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';overflow:hidden}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{padding-left:1px}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{padding-right:1px}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{right:0}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{left:0}.ItemTile.is-folder.is-dropping .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{-ms-transform:translateY(0);transform:translateY(0);opacity:1;animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:1.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:28px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:';top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:#107c10;top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{animation:none}}.ItemTile-nameCover{background-color:rgba(0,0,0,.25);position:absolute;font-weight:600;text-shadow:0 0 8px #000;top:0;width:100%;height:100%}[dir=ltr] .ItemTile-nameCover{left:0}[dir=rtl] .ItemTile-nameCover{right:0}.ItemTile-tagText{position:relative;text-align:center;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding:0 8px}.ItemTile-folderBeak,.ItemTile-folderBeakHighlight{position:absolute;top:-16px;overflow:hidden}[dir=ltr] .ItemTile-folderBeak,[dir=ltr] .ItemTile-folderBeakHighlight{right:32%}[dir=rtl] .ItemTile-folderBeak,[dir=rtl] .ItemTile-folderBeakHighlight{left:32%}.ItemTile-folderBeak::before{content:'';position:absolute;top:1px;width:20px;height:30px;background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";-ms-transform-origin:top left;transform-origin:top left;-ms-transform:rotate(40deg);transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeak::before{right:-19px}[dir=rtl] .ItemTile-folderBeak::before{left:-19px}.ItemTile-folderBeak{width:18px;height:18px}.ItemTile-folderBeakHighlight{width:16px;height:16px}.ItemTile-folderBeakHighlight::before{content:'';position:absolute;top:0;width:1px;height:30px;background-color:rgba(255,255,255,.2);-ms-transform-origin:top left;transform-origin:top left;-ms-transform:rotate(40deg);transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeakHighlight::before{right:0}[dir=rtl] .ItemTile-folderBeakHighlight::before{left:0}html[dir=rtl] .ItemTile-folderBeak::before,html[dir=rtl] .ItemTile-folderBeakHighlight::before{-ms-transform-origin:top right;transform-origin:top right;-ms-transform:rotate(-40deg);transform:rotate(-40deg)}.ItemTile-childCount,.ItemTile-name,.ItemTile-subText{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ItemTile-name{font-size:15px;line-height:20px}.ItemTile.is-tag .ItemTile-name{max-height:4.1em;font-weight:400;font-size:17px;white-space:normal;text-overflow:normal;word-wrap:break-word;line-height:23px;padding-bottom:4px}.ItemTile-tagCount{font-weight:600;font-size:12px;line-height:10px;opacity:.85}.ItemTile-sharingIcon{font-size:15px}.ItemTile.is-folder .ItemTile-sharingIcon{line-height:20px}html[dir=ltr] .ItemTile.is-folder .ItemTile-sharingIcon{float:right}html[dir=rtl] .ItemTile.is-folder .ItemTile-sharingIcon{float:left}.ItemTile.is-folder .ItemTile-subText .ItemTile-sharingIcon{float:inherit!important;line-height:1}.ItemTile-childCount{position:absolute;top:-14px;padding:0 3px;font-size:11px}[dir=ltr] .ItemTile-childCount{left:68%}[dir=rtl] .ItemTile-childCount{right:68%}.ItemTile.ItemTile.od-ItemTile--isDiscover .ItemTile-subText{padding-top:3px;opacity:1}.ItemTile.is-file .ItemTile-subText{font-size:11px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.ItemTile.is-folder .ItemTile-subText{font-size:11px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.7}.ItemTile-subTextImage{width:14px;height:14px}[dir=ltr] .ItemTile-subTextImage{margin-right:4px}[dir=rtl] .ItemTile-subTextImage{margin-left:4px}.ItemTile-subTextImageShort{width:12px;height:12px}[dir=ltr] .ItemTile-subTextImageShort{margin-right:4px}[dir=rtl] .ItemTile-subTextImageShort{margin-left:4px}.ItemTile-subTextIcon{font-size:14px;position:relative;top:2px}[dir=ltr] .ItemTile-subTextIcon{margin-right:4px}[dir=rtl] .ItemTile-subTextIcon{margin-left:4px}.ItemTile-subTextIcon.ms-Icon.ms-Icon--IncidentTriangle{color:#d83b01}.ItemTile-blockIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeak,.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeakHighlight{display:none}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{font-size:12px;position:absolute;bottom:24px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate{height:50%;background:linear-gradient(0deg,rgba(0,0,0,.58),transparent);color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";left:2px;right:2px}.ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{top:auto;bottom:10px;padding:0;font-size:10px;color:rgba(255,255,255,.8)}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:10px;right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-frame{top:8px}.ItemTile.od-ItemTile--isAlbum .ItemTile-rowCheck{top:6px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,.ItemTile.od-ItemTile--isAlbum .ItemTile-subText{position:absolute;bottom:10px}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{right:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{left:10px}.ItemTile.od-ItemTile--isStory .ItemTile-name{font-size:21px;font-weight:100;text-shadow:0 0 8px #000;bottom:28px;line-height:31px;left:12px;right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name{left:20px;right:20px;bottom:40px}.ItemTile.od-ItemTile--isStory .ItemTile-date{display:block;position:absolute;top:auto;bottom:12px;font-size:14px;text-shadow:0 0 8px #000}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-date{left:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-date{right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{left:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{right:20px}.ItemTile.od-ItemTile--isStory .ItemTile-childCount{font-size:14px;text-shadow:0 0 8px #000;bottom:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:auto}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:auto}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:20px}.ItemTile-newBadge{position:absolute;bottom:45px}[dir=ltr] .ItemTile-newBadge{left:1px}[dir=rtl] .ItemTile-newBadge{right:1px}.ItemTile-newBadge .od-newBadge{position:relative}[dir=ltr] .ItemTile-newBadge .od-newBadge{left:10px}[dir=rtl] .ItemTile-newBadge .od-newBadge{right:10px}.od-ItemTile--isVideo .ItemTile-fileIconContainer{bottom:0}.od-ItemTile--isVideo .ItemTile-namePlate{display:none}.ItemTile-playButton{position:absolute;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:8px;font-size:1.3em}[dir=ltr] .ItemTile-playButton{left:4px}[dir=rtl] .ItemTile-playButton{right:4px}html[dir=ltr] .ItemTile-viewerCount{float:right}html[dir=rtl] .ItemTile-viewerCount{float:left}.od-ItemTile-card{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ItemTile-date{display:none}.od-ItemTile--color-oneDrive.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive .ItemTile-folderBeak:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile-button{position:absolute;top:15px;z-index:1;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8;text-shadow:0 1px 1px #000;border:0;padding:4px;visibility:hidden;background-color:transparent}[dir=ltr] .od-ItemTile-button{right:10px}[dir=rtl] .od-ItemTile-button{left:10px}.od-ItemTile-button:hover{cursor:pointer;background-color:#000;opacity:.3}.ItemTile:hover .od-ItemTile-button{visibility:visible}.od-ItemTile-button .od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:block}"}])});define("odsp-next/controls/folderCoverTile/FolderCoverTile",["require","exports","./FolderCoverTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderCoverTile.html","./FolderCoverTile.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-folder-cover-tile",template:e("./FolderCoverTile.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/folderCoverTile/FolderCoverTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/frame/ImageFrame","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(i,e,t,o,a,r,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l,n=function(n){t.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.thumbnailTagName=a.default.tagName;var i=t.observables,o=t.resources;l||(l=o.consume(s.platformDetection).isRetinaSupported?"64_2x":"64");t.imageRect=e.imageRect;t._item=e.item;t._lastThumbnails=-1;t._thumbnailIndex=-1;t._isPulsingEnabled=!0;t.pulseRecords=i.createArray();i.compute(t._computeRecords);var r=e.pulseTarget;r&&r(t);return t}e.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&1<e.folder.covers.length)};e.prototype.enablePulsing=function(e){this._isPulsingEnabled=e};e.prototype.pulse=function(){if(this.canPulse()&&this._isPulsingEnabled){this._pushNextRecord();this.pulseRecords.shift();this._updatePulseClasses()}};e.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:r.AlignmentType.cover}};e.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",i=e.folder&&e.folder.covers?e.folder.covers.length:-1;if(t!==this._lastKey||i!==this._lastThumbnails){this._lastKey=t;this._lastThumbnails=i;this.pulseRecords.removeAll();this._thumbnailIndex=-1;0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord();this._updatePulseClasses()}}};e.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})};e.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()};e.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})};e.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var i=e[t],o=e.length-t-1;i.isEmpty||i.className("od-FolderCoverTile-item"+o);i.isThumbnailVisible(!(!i.thumbnail()||!(i.isThumbnailVisible()||o<2)));var r=this.unwrapObservable(this._item),n=!r.tagInfo&&!i.isThumbnailVisible()&&(1===o||r.isAlbum||r.isDocSet);i.isWatermarkVisible(n);i.watermarkUrl(n?this._getFolderWatermarkUrl():null)}};e.prototype._getFolderWatermarkUrl=function(){var e=this._item(),t="genericfolder";e.isAlbum&&(t="photofolder");switch(e.isSpecialFolder&&e.specialFolderCanonicalName){case"Music":t="musicfolder";break;case"Documents":t="documentfolder";break;case"Photos":t="photofolder"}e.isDocSet&&(t="Docset");return"undefined"==typeof __webpack_public_path__?i.toUrl("odsp-media/images/watermarks/"+l+"/"+t.toLowerCase()+".png"):i("@ms/odsp-media/dist/media/images/watermarks/"+l+"/"+t+".png")};e.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,i=t&&t.length;if(i){return t[this._thumbnailIndex=(this._thumbnailIndex+1)%i]}};return e}(o.default);e.default=n});define("odsp-next/controls/folderCoverTile/FolderCoverTile.html",[],function(){return'<div class=od-FolderCoverTile data-bind="foreach: pulseRecords"><div data-bind="attr: { \'class\': className }">\x3c!--ko if: isThumbnailVisible--\x3e<div class=od-FolderCoverTile-image data-bind="component: { name: $component.thumbnailTagName, params: $component.getThumbnailParams($data) }"></div>\x3c!--/ko--\x3e\x3c!--ko if: isWatermarkVisible--\x3e<img class=od-FolderCoverTile-watermark data-bind="attr: { src: watermarkUrl }">\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/folderCoverTile/FolderCoverTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";-ms-transform:translateY(100%);transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";transition:transform .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/sharing/sharerHeader/SharerHeader",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharerHeaderViewModel","./SharerHeader.html","./SharerHeader.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"ms-sharer-header",template:e("./SharerHeader.html"),viewModel:o.default});t.default=r});define("odsp-next/controls/sharing/sharerHeader/SharerHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SharerHeader.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/DataSourceResourceKeys"],function(e,t,i,o,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=r.strings,n=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this,i=e.group,o=i.data;t.name=i.name||"";t.showAllText=d.showAll;if(o){var r=o.itemsSharedCount;t.subText=1===r?d.singleShared:s.format(d.multiShared,r);t.profileImageUrl=o.sharerProfileImageUrl;var n=t.resources.consume(l.url);t.sharerUrl=n.getSharedByUrl(o.sharerLongCid,o.sharerCid);t.isShowAllVisible=e.cellsInGroup<r}return t}return e}(o.default);t.default=n});define("odsp-next/controls/sharing/sharerHeader/SharerHeader.html",[],function(){return'<a class=SharerHeader data-bind="attr: { \'href\': sharerUrl }"><div class="SharerHeader-userTile ms-Icon ms-Icon--Contact" data-bind="icon: true"><img data-bind="attr: { \'src\': profileImageUrl }" width=40 height=40></div><div class=SharerHeader-title data-bind=text:name></div><div class=SharerHeader-subText data-bind=text:subText></div>\x3c!--ko if:isShowAllVisible--\x3e<div class=SharerHeader-showAll data-bind=text:showAllText></div>\x3c!--/ko--\x3e</a>'});define("odsp-next/controls/sharing/sharerHeader/SharerHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".SharerHeader{display:block;padding:8px 0;margin:24px 0;text-decoration:none;vertical-align:middle;font-size:12px}.SharerHeader-userTile{width:40px;height:40px;border-radius:50%;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;position:relative;overflow:hidden;text-align:center;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}html[dir=ltr] .SharerHeader-userTile{float:left}html[dir=rtl] .SharerHeader-userTile{float:right}[dir=ltr] .SharerHeader-userTile{margin-right:8px}[dir=rtl] .SharerHeader-userTile{margin-left:8px}.SharerHeader-userTile.ms-Icon{line-height:40px}.SharerHeader-userTile img{position:absolute;top:0;left:0}.SharerHeader-title{font-size:17px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.SharerHeader-subText{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:inline-block}.SharerHeader-showAll{display:inline-block;padding:0 16px}"}])});define("odsp-next/controls/headerTile/HeaderTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./HeaderTileViewModel","./HeaderTile.html","./HeaderTile.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-header-tile",template:e("./HeaderTile.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/headerTile/HeaderTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../list/react/detailsList/ReactDetailsList.resx"],function(e,t,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.group,o=i.name,r=i.count;t.title=o;t.ariaLabel=t._getAriaLabel(o,r);return t}e.prototype._getAriaLabel=function(e,t){var i=r.pluralSelect(t,r.format(a.strings.itemsCountSingular,t),r.format(a.strings.itemCountMulti,t));return r.format(a.strings.groupHeaderAriaLabel,e,i,a.strings.expandedText)};return e}(o.default);t.default=n});define("odsp-next/controls/headerTile/HeaderTile.html",[],function(){return'<div class=od-HeaderTile tabindex=0 data-bind="attr: { \'aria-label\': ariaLabel }"><div class=od-HeaderTile-title data-bind="text: title"></div></div>'});define("odsp-next/controls/headerTile/HeaderTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-HeaderTile{box-sizing:border-box;height:46px;padding:9px 0}.od-HeaderTile:focus{outline:0}.od-focus--enabled .od-HeaderTile:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-HeaderTile-title{font-size:21px;font-weight:100}"}])});define("odsp-next/controls/list/List.html",[],function(){return'<div class=List role=list data-bind="pulse: visibleModels">\x3c!--ko if: headerVisible()--\x3e<div class=List-header data-bind="if: headerType(), attr: { style: headerStyle }">\x3c!--ko component: { name: headerType, params: headerParams }--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=List-placeHolder data-bind="style: { height: placeHolderHeight() + \'px\' }"></div><div class=List-surface role=presentation data-bind="viewport: viewport, marqueeSelection: { selectionModel: selectionModel, layout: activeLayout, isEnabled: enableMarqueeSelection }, clearSelection: { selectionModel: selectionModel, isEnabled: enableClearSelection }, selection: { isSelectionOnKeyInputEnabled: isSelectionOnKeyInputEnabled, items: items, layout: activeLayout, selectionModel: selectionModel, isReadyToBeSelected: $component.isReadyToBeSelected.bind($component) }, interactionScope: { isActive: isActive }, recoverFocus: { isEnabled: isActive, onlyRecoverFromBody: true }, customRender: true, contextMenu: contextMenuHelper, attr: { \'aria-label\': tooltip, \'tabindex\': tabIndex }, element: surfaceElement"></div></div>'});define("odsp-next/controls/itemContent/albumItemContentList/AlbumItemContentList.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new r.ResourceKey({name:i("module").id,loader:new r.AliasResourceLoader(function(){return o.loadModuleExport({path:"./AlbumItemContentList",getModule:function(){return new t.default(function(e,t){i(["./AlbumItemContentList"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("odsp-next/controls/clipboard/ClipboardHelper.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.typeResourceKey=new o.ResourceKey({name:""+i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ClipboardHelper",getModule:function(){return new t.default(function(e,t){i(["./ClipboardHelper"],e,t)})},getExport:function(e){return e.typeResourceKey}})})})});define("odsp-next/utilities/optimizely/experiments/UpdatedListView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=9187370220});define("odsp-next/utilities/optimizely/experiments/NewGridView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=9177020308});define("odsp-next/bindings/contextMenu/ContextMenuHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.items=e.items.filter(n);t.rootElementClass=e.rootElementClass||null;t.boundingElementClass=e.boundingElementClass||null;t.shouldHideIcons=!!e.shouldHideIcons;t.engagementSource=e.engagementSource||null;t.alignment=e.alignment;t.point=e.point;t.anchorElement=e.anchorElement;t.isMenuOpen=e.isMenuOpen;var i=e.dismissOnClick,o=void 0===i||i;t.dismissOnClick=o;return t}return e}(o.default);function n(e){return 8==(8&e.location)}t.default=r});define("odsp-next/models/inAppMessaging/MessagingTypeHelper",["require","exports","../../utilities/features/Features"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertInAppMessageToPremiumUpsellType=function(e,t){void 0===t&&(t=!1);switch(e){case 101:case 102:return 1;case 126:return 2;case 127:return 3;case 151:return 5;case 152:return t?6:5;case 301:return i.isFeatureEnabled(i.InAppMessagingMLUpsellPositioning)?7:void 0}};t.POSITIONING_MESSAGES=[102,101,127,126,151,152];t.UPSELL_MESSAGES=[301];t.isPositioningMessage=function(e){return-1!==t.POSITIONING_MESSAGES.indexOf(e)};t.isUpsellMessage=function(e){return-1!==t.UPSELL_MESSAGES.indexOf(e)}});define("odsp-next/controls/infoPane/InfoPane.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./InfoPane",getModule:function(){return new t.default(function(e,t){i(["./InfoPane"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/listFooter/ListFooter",["require","exports","./ListFooterViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ListFooter.html","./ListFooter.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-list-footer",template:e("./ListFooter.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/listFooter/ListFooterViewModel",["require","exports","tslib","./ListFooter.resx","../../resources/ControlResourceKeys","../dragAndDrop/dragAndDropHint/DragAndDropHint","../../utilities/features/Features","../../models/itemSet/ItemSetMonitor","@ms/odsp-shared/lib/base/ViewModel","../../resources/ProviderResourceKeys"],function(e,t,o,r,n,a,s,l,i,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._actionMap=t.resources.consume(n.actionMap);t._isItemSetRendered=t.resources.consume(n.isItemSetRendered);t._itemSetMonitor=t.resources.consume(l.resourceKey);t._recycleBinProvider=t.resources.consume(d.recycleBin.optional);t.dragAndDropHintTagName=a.default.tagName;t.recycleBinLink=r.strings.RecycleBinLink;t.recycleBinText=r.strings.RecycleBinText;t.isVisible=t.createPureComputed(t._computeShowListFooter);t._recycleBinItem=t.createPureComputed(t._computeRecycleBinItem);t._openRecycleBinAction=new(t.child(t._actionMap.DefaultClickAction))({sourceEngagement:"ListFooter.OpenRecycleBin.Click",item:t._recycleBinItem});t.showRecycleBinInFooter=t.createPureComputed(t._computeShowRecycleBinInFooter);t.dragAndDropHintComponent=e.dragAndDropHintComponent;return t}e.prototype.onRecycleBinClick=function(e,t){this._openRecycleBinAction.execute(t).done()};e.prototype._computeRecycleBinItem=function(){var e=this._itemSetMonitor.itemSet();e.content();return!e.isPlaceholder&&this._recycleBinProvider?this._recycleBinProvider.getRecycleBinItem(this._itemSetMonitor.item.peek()):null};e.prototype._computeShowListFooter=function(){var e=this._itemSetMonitor.itemSet();e.content();return this._isItemSetRendered()&&!e.isPlaceholder};e.prototype._computeShowRecycleBinInFooter=function(){return s.isFeatureEnabled(s.RecycleBinListFooter)&&this._openRecycleBinAction.isAvailable()};return e}(i.default);t.default=c});define("odsp-next/controls/listFooter/ListFooter.html",[],function(){return'\x3c!--ko if: isVisible()--\x3e<div class=od-ListFooter>\x3c!--ko if: !dragAndDropHintComponent--\x3e<div class=od-ListFooter-dragAndDropHint data-bind="component: { name: dragAndDropHintTagName, params: {} }"></div>\x3c!--/ko--\x3e\x3c!--ko if: !!dragAndDropHintComponent--\x3e\x3c!--ko with: dragAndDropHintComponent--\x3e<div class=od-ListFooter-dragAndDropHint data-bind="component: $data"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showRecycleBinInFooter()--\x3e<div class=od-ListFooter-recycleBin><span class=od-ListFooter-recycleBinText data-bind="text: recycleBinText"></span> <a href=; class=od-ListFooter-recycleBinLink data-bind="text: recycleBinLink, click: onRecycleBinClick"></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/listFooter/ListFooter.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ListFooter{text-align:center;margin-top:33px;margin-bottom:24px}.od-ListFooter-dragAndDropHint{margin-bottom:18px}.od-ListFooter-recycleBin{font-size:14px;font-weight:400}.od-ListFooter-recycleBinText{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-ListFooter-recycleBinLink{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("odsp-next/controls/overlays/oneUp/OneUpOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OneUpOverlayViewModel","./OneUpOverlay.html","./OneUpOverlay.css","../Overlay"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-one-up-overlay",template:e("./OneUpOverlay.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/overlays/oneUp/OneUpOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/focus/FocusTrapBinding","../Overlay"],function(e,t,o,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.overlayTagName=d.default.tagName;t.addBindingHandlers({host:r.default,interactionScope:n.default,preserveFocus:a.default,recoverFocus:s.default,focusTrap:l.default});return t}return e}(i.default);t.default=c});define("odsp-next/controls/overlays/oneUp/OneUpOverlay.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n },\r\n alignToParent: false\r\n }\r\n}--\x3e\x3c!--ko focusTrap: {}--\x3e<div class=od-OneUpOverlay data-overlay-parent=true role=presentation tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: $host.isOpen }, host"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/overlays/oneUp/OneUpOverlay.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;opacity:0;visibility:hidden;-ms-transform:none;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{-ms-transform:scale(.8,.8);transform:scale(.8,.8);opacity:0;visibility:hidden}"}])});define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBanner",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UnauthenticatedBannerViewModel","./UnauthenticatedBanner.html","./UnauthenticatedBanner.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAST_SIGN_IN_DIALOG=o.LAST_SIGN_IN_DIALOG;var r=i.registerComponent({tagName:"od-unauthenticated-banner",template:e("./UnauthenticatedBanner.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBannerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ControlResourceKeys","./UnauthenticatedBanner.resx","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../signInDialog/SignInDialog","../../utilities/optimizely/experiments/SignInDialog","../../utilities/browser/ResponsiveUI","../../utilities/features/Features"],function(e,l,t,i,d,c,u,p,m,h,o,f,g){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.LAST_SIGN_IN_DIALOG="lastSignInDialog";var r=function(s){t.__extends(e,s);function e(e){void 0===e&&(e={});var t=s.call(this,e)||this;t.signUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var i=encodeURIComponent(window.location.href);t.signInURL="https://login.live.com/login.srf?wa=wsignin1.0&wreply="+i;t.homePageURL="https://go.microsoft.com/fwlink/?linkid=853503";t.brandingString=u.strings.brandingString;t.signIn=u.strings.signIn;t.signInDialogTagName=h.default.tagName;t.signUp=u.strings.signUp;t._actionMap=t.resources.consume(c.actionMap);t._responsiveUI=t.resources.consume(f.resourceKey);t._navigation=t.resources.consume(d.navigation);t._onClickSignUpAction=new(t.managed(t._actionMap.NavigationAction))({url:t.signUpURL});t._onClickSignInAction=new(t.managed(t._actionMap.NavigationAction))({url:t.signInURL});t._onClickOneDriveAction=new(t.managed(t._actionMap.NavigationAction))({url:t.homePageURL});t.showCloseButton=t.createObservable(!0);t.onClickClose=t.onClickClose.bind(t);t._dataStore=new p.default("SignInDialogCounter",m.default.local);var o=t._dataStore.getValue(l.LAST_SIGN_IN_DIALOG),r=0<t._responsiveUI.compareSize(t._responsiveUI.formFactorSize.peek(),"Small"),n=t.resources.consume(c.didUserEnterPasswordForFile),a=!1;if(g.isFeatureEnabled(g.EnableAnonymousSigninDialog)){a=r&&!n.peek();o&&(a=a&&o+864e5<=Date.now());a&&t._dataStore.setValue(l.LAST_SIGN_IN_DIALOG,Date.now())}t.showSignIn=t.createObservable(a);return t}e.prototype.onClickSignUp=function(e,t){this._onClickSignUpAction.execute(t);o.logOptimizelyEvent("clickedSignUp");o.logOptimizelyEvent("clickedSignUpBanner")};e.prototype.onClickSignIn=function(e,t){var i="1"===this._navigation.viewParams.expectsBusiness;g.isFeatureEnabled(g.UnauthenticatedBannerUseSigninDialog)||i?this.showSignIn(!0):this._onClickSignInAction.execute(t);o.logOptimizelyEvent("clickedSignIn");o.logOptimizelyEvent("clickedSignInBanner")};e.prototype.onClickOneDrive=function(e,t){this._onClickOneDriveAction.execute(t)};e.prototype.onClickClose=function(e){this.showSignIn(!1)};return e}(i.default);l.default=r});define("odsp-next/controls/signInDialog/SignInDialog",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SignInDialogViewModel","./SignInDialog.html","./SignInDialogMSAVar.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"od-SignInDialog",template:e("./SignInDialog.html"),viewModel:o.default,synchronous:!0});t.default=r});define("odsp-next/controls/signInDialog/SignInDialogViewModel",["require","exports","tslib","cookies","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../overlays/Overlay","../../bindings/dismiss/DismissBinding","../../bindings/html/BindableHtmlBinding","./SignInDialog.resx","../../bindings/focus/FocusTrapBinding","../../bindings/focus/RecoverFocusBinding","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/focus/PreserveFocusBinding","../../bindings/keyboard/KeyboardBinding","../../resources/ControlResourceKeys","../../bindings/interactionScope/InteractionScopeBinding","../../resources/DataSourceResourceKeys","../../providers/engagement/Engagement","../../utilities/features/Features"],function(i,r,t,n,a,s,e,l,d,c,u,p,m,h,f,g,b,v,y,x,_,I){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.MSAccountInfoURL="https://go.microsoft.com/fwlink/?linkid=853223";r.MSASignUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var S;!function(e){e.INVALID_EMAIL="Error.Invalid Email";e.API_TIMEOUT="Error.API Timeout";e.MS_ACCOUNT="MSAccount";e.ORG_ID_PLACEHOLDER="OrgId,Placeholder";e.NEITHER="Neither";e.BOTH="Both"}(S||(S={}));var o=function(o){t.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.addBindingHandlers({dismiss:c.default,focusTrap:m.default,bindableHtml:u.default,keyboard:b.default,recoverFocus:h.default,preserveFocus:g.default,interactionScope:y.default});var i=t.resources.consume(v.actionMap);t._identityDataSource=t.resources.consume(x.identity);t._engagement=t.resources.consume(_.resourceKey);t._navigation=t.resources.consume(l.navigation);t._setUpDialogStrings();t._setUpMSAVariation();t._onClickSignUpAction=new(t.managed(i.NavigationAction))({url:t.signUpURL});t._onClickSignInAction=new(t.managed(i.NavigationAction))({url:t._signInURL});t._onCancel=e.onCancel;t.overlayComponent={name:d.default.tagName,params:{animation:{},alignToParent:!1}};t._engagement.logData({name:"Display.SignInDialog"});return t}e.prototype.dismissedDialog=function(e,t){this._onCancel&&this._onCancel(t)};e.prototype.onClickOutCancel=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.OutsideDialog.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickCancelX=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.XButton.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickCancelFooter=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.CancelFooter.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickSignUpDialog=function(e,t){this._onClickSignUpAction.execute(t);this._engagement.logData({name:"SignUp.SignInDialog.CreateOneLink.Click",isIntentional:!0})};e.prototype.onClickSignInDialog=function(e,t){var i=this,o=encodeURIComponent(this.username.peek());this._signInURL=this._signInURL+"&username="+o;var r="1"===this._navigation.viewParams.expectsBusiness;if(I.isFeatureEnabled(I.SigninDialogSupportBusinessAccounts)||r){var n=new s.default({name:"SignInDialog.GetIdentityProvider"});a.default.start({url:"https://odc.officeapps.live.com/odc/emailhrd/getidp?hm=0&emailAddress="+o+"&_="+Date.now(),method:"GET",requestTimeoutInMS:3e3}).then(function(e){if(200<=e.status&&e.status<400){var t=e.responseText;n.end({resultType:s.ResultTypeEnum.Success,extraData:{identityProviderResponse:t}});switch(t){case S.ORG_ID_PLACEHOLDER:i._continueBusinessSignin(o);break;default:i._continueSignin()}}else{n.end({resultType:s.ResultTypeEnum.Failure,resultCode:"ErrorResponse",error:e.status+" - "+e.responseText});i._continueSignin()}},function(e){n.end({resultType:s.ResultTypeEnum.Failure,resultCode:"Generic",error:e.status+" - "+e.responseText});i._continueSignin()})}else this._continueSignin();this._engagement.logData({name:"SignIn.SignInDialog.NextButton.Click",isIntentional:!0})};e.prototype._continueSignin=function(){var e=this.resources.consume(v.actionMap);this._onClickSignInAction=new(this.managed(e.NavigationAction))({url:this._signInURL});this._onClickSignInAction.execute(event)};e.prototype._continueBusinessSignin=function(e){n.set("aad_redirect_url",window.location.href);this._signInURL="https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/oauth2/authorize?response_type=id_token+code&redirect_uri=https%3a%2f%2fonedrive.live.com%2fbusiness&client_id=6a9b9266-8161-4a7b-913a-a9eda19da220&scope=openid&response_mode=form_post&nonce=01F08DF7-CA7E-4BB6-A2D1-AAE2E2F1BF44&msafed=0&state=aad_redirect_url&domain_hint=organizations&login_hint="+e;this._continueSignin()};e.prototype._setUpDialogStrings=function(){this.logoLabelString=p.strings.MicrosoftLogoLabel;this.closeLabel=p.strings.closeLabel;this.upsellText=p.strings.upsellString;this.signUpText=p.strings.signUp;this.dismissText=p.strings.dismiss;this.logoURL="undefined"==typeof __webpack_public_path__?i.toUrl("@ms/odsp-media/lib/images/signindialog/microsoft_logo.svg"):i("@ms/odsp-media/dist/media/images/signInDialog/microsoft_logo.svg");this.cloudsURL="undefined"==typeof __webpack_public_path__?i.toUrl("@ms/odsp-media/lib/images/signindialog/clouds.png"):i("@ms/odsp-media/dist/media/images/signInDialog/clouds.png");var e=encodeURIComponent(window.location.href);this._signInURL=this._identityDataSource.getSignInUrl()+e;this.signUpText=p.strings.signUp;this.signUpURL=r.MSASignUpURL;this.username=this.createObservable("");this.usernameLabel=p.strings.usernameLabelString;this.usernameInputPlaceholder=p.strings.MSAInputPlaceholder;var t=this.resources.consume(v.focusItem);this.dialogLabel=this.createPureComputed(function(){return(t()().displayName||"")+". "+p.strings.dialogLabelString});this.MSAupsellText=p.strings.MSAVarUpsell};e.prototype._setUpMSAVariation=function(){var e="<a href='"+r.MSAccountInfoURL+"'>";this.useMSAccount=f.format(p.strings.UseMSA,e,"</a>");var t='<a data-bind="click: onClickSignUpDialog" href=\''+this.signUpURL+"'>";this.createAccountString=f.format(p.strings.CreateMSA,t,"</a>");this.nextString=p.strings.MSANext;this.nextLabel=p.strings.MSANextLabel};return e}(e.default);r.default=o});define("odsp-next/controls/signInDialog/SignInDialog.html",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div class=od-SignInDialog-modal><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div tabindex=-1 role=dialog class=od-SignInDialogMSAVar data-bind="preserveFocus: true, interactionScope: { isScope: true }, dismiss: { close: onClickOutCancel }, recoverFocus: { isEnabled: true }, attr: { \'aria-labelledby\': \'signInDialog\', \'aria-describedby\': \'od-SignInDialog-content\' }"><div id=signInDialog class=ms-accessible data-bind="text: dialogLabel"></div><div id=od-SignInDialog-content><div class=od-SignInDialogMSAVar-header><img data-bind="attr: { src: logoURL, alt: logoLabelString }"></div><div class=od-SignInDialogMSAVar-content><div class=od-SignInDialogMSAVar-upsell data-bind="text: MSAupsellText"></div><div class=od-SignInDialogMSAVar-useMSA data-bind="bindableHtml: useMSAccount"></div><input type=text class=od-SignInDialogMSAVar-input data-bind="textInput: username, keyboard: { allowButtonEvents: true, mappings: { \'Enter\': onClickSignInDialog } }, attr: { \'aria-label\': usernameLabel, \'placeholder\': usernameInputPlaceholder }"><div id=signInDialog class=ms-accessible data-bind="text: usernameLabel"></div><button class="od-SignInDialogMSAVar-next od-button" data-bind="text: nextString, click: onClickSignInDialog, attr: { \'aria-label\': nextLabel }"></button><div class=od-SignInDialogMSAVar-createMSA data-bind="bindableHtml: createAccountString"></div><div class=od-SignInDialogMSAVar-line></div><button class="od-Button od-SignInDialogMSAVar-dismiss" data-bind="text: dismissText, click: onClickCancelFooter"></button> <button class=od-SignInDialog-close data-bind="attr: { \'aria-label\': closeLabel, title: closeLabel }, click: onClickCancelX"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/signInDialog/SignInDialogMSAVar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SignInDialog-modal{top:0;bottom:0;right:0;left:0;position:absolute;display:-ms-flexbox;display:flex}.sm .od-SignInDialog-modal{display:none}.od-SignInDialog-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8)}.od-SignInDialogMSAVar{width:410px;height:315px;position:relative;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;margin:auto;outline:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-header{height:65px;padding-top:22px;box-sizing:border-box}html[dir=ltr] .od-SignInDialogMSAVar-header{padding-left:32px}html[dir=rtl] .od-SignInDialogMSAVar-header{padding-right:32px}.od-SignInDialogMSAVar-header img{height:41px;display:inline-block;margin:0}.od-SignInDialogMSAVar-content{padding:5px 36px;height:135px;background-repeat:no-repeat;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-upsell{font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-SignInDialogMSAVar-useMSA{font-size:15px;margin:16px 0}.od-SignInDialogMSAVar-useMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-useMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SignInDialogMSAVar-next{margin:auto;background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";height:34px;width:342px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:300;font-size:15px;border:2px;border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-next:focus{border-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-SignInDialogMSAVar-next:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-SignInDialogMSAVar-input{height:34px;width:342px;margin-bottom:12px;font-size:15px;padding:0 4px;box-sizing:border-box}.od-SignInDialogMSAVar-createMSA{font-size:13px;margin:16px 0}.od-SignInDialogMSAVar-createMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-createMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SignInDialogMSAVar-line{width:410px;height:1px;background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";position:absolute;left:0;right:0}.od-SignInDialogMSAVar-dismiss{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;font-weight:400;width:410px;height:35px;cursor:pointer;border:none;position:absolute;left:0;right:0;bottom:0}.od-SignInDialog-close{position:absolute;top:0;background:0 0;border:0;padding:16px;cursor:pointer}html[dir=ltr] .od-SignInDialog-close{right:0}html[dir=rtl] .od-SignInDialog-close{left:0}.od-SignInDialog-close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("odsp-next/utilities/optimizely/experiments/SignInDialog",["require","exports","../OptimizelyHelper"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIGN_IN_EXPERIMENT_ID=8425126308;t.logOptimizelyEvent=function(e){i.OptimizelyHelper.trackEvent(t.SIGN_IN_EXPERIMENT_ID,e)}});define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBanner.html",[],function(){return'<div class=od-unauthenticatedBanner><button class=od-unauthenticatedBanner-OneDrive data-bind="text:brandingString, attr:{href: homePageURL, alt: brandingString}, click: onClickOneDrive"></button><div class=od-unauthenticatedBanner-AccountBox><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignIn" data-bind="attr: { href: signInURL }, text: signIn, click: onClickSignIn"></button> <button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignUp" data-bind="attr: { href: signUpURL }, text: signUp, click: onClickSignUp"></button></div></div>\x3c!--ko if:showSignIn--\x3e\x3c!--ko component: {\r\n name: signInDialogTagName,\r\n params: {\r\n onCancel: onClickClose\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBanner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-unauthenticatedBanner{position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-unauthenticatedBanner-OneDrive{position:absolute;top:0;bottom:0;border:none;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";line-height:48px;display:inline-block;font-weight:300;font-size:14px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:22px;-webkit-font-smoothing:antialiased;cursor:pointer}html[dir=ltr] .od-unauthenticatedBanner-OneDrive{left:10px}html[dir=rtl] .od-unauthenticatedBanner-OneDrive{right:10px}.od-unauthenticatedBanner-AccountBox{position:absolute;top:0;bottom:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{right:0}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{left:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{padding-right:8px}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{padding-left:8px}.od-unauthenticatedBanner-button{display:inline-block;padding:6px;font-weight:600;font-size:14px;border:none;margin:8px;padding-left:16px;padding-right:16px;cursor:pointer}.od-unauthenticatedBanner-SignIn{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-bottom:6px;padding-top:6px}.od-unauthenticatedBanner-SignIn:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-unauthenticatedBanner-SignUp{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding-bottom:7px;padding-top:7px;display:none}.od-unauthenticatedBanner-SignUp:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.lg .od-unauthenticatedBanner-SignUp,.md .od-unauthenticatedBanner-SignUp,.xlg .od-unauthenticatedBanner-SignUp,.xxlg .od-unauthenticatedBanner-SignUp,.xxxlg .od-unauthenticatedBanner-SignUp,.xxxxlg .od-unauthenticatedBanner-SignUp{display:inline}"}])});define("odsp-next/controls/list/viewModels/DetailsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/DetailsLayout","../layouts/MobileDetailsLayout","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../List.html","../../detailsRow/DetailsRow","../../detailsHeader/DetailsHeader"],function(e,t,i,o,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this,o=i.resources.consume(d.platformDetection),r=new(i.managed(o.isMobile&&i.resources.isExposed(l.useMobileList)&&i.resources.consume(l.useMobileList)?s.default:a.default))(e);i.initialize(r);return i}return e}(o.default);t.default=r});define("odsp-next/controls/list/layouts/DetailsLayout",["require","exports","tslib","knockout","./BaseLayout","../react/SelectionManager","../../../resources/ControlResourceKeys","../../detailsRow/DetailsRow","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,o,n,i,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._platform=t.resources.consume(l.platformDetection);t._selectionModel=t.resources.consume(a.itemsSelection);t._isSelectionModal=t.resources.consume(r.isSelectionModalResourceKey);t.cellLocations=n.observable([]);t._checkShown=t.createComputed(function(){return t.isCheckSupported()&&(!t._platform.isMobile||t._isSelectionModal()||0<t._selectionModel.selection().length)});t.rowCheckWidth=t.createComputed(function(){return t._checkShown()?40:0});t.createComputed(function(){t._checksOld!==t._checkShown()&&t.evaluateLayout(!0);t._checksOld=t._checkShown()});return t}e.prototype.isCheckSupported=function(){return!0};e.prototype.getSettings=function(){return{headerHeight:32,rowHeight:36,outerPadding:0,innerPadding:8}};e.prototype.getHeaderCell=function(){var e=this.getSettings();return{key:"details-header",index:0,cellIndex:-1,left:e.outerPadding,top:0,width:this.viewport.width-2*e.outerPadding,height:e.headerHeight,viewType:"ms-details-header",viewData:{itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations}}};e.prototype.getSurfaceSize=function(){return{width:this.viewport.width,height:this.getSettings().rowHeight*this._itemSet.peek().content.peek().items.length}};e.prototype.getVisibleRange=function(){var e=this.viewport,t=this.getSettings();return{start:Math.max(0,Math.floor(e.visibleTop/t.rowHeight)),end:Math.min(this._itemSet.peek().content.peek().items.length-1,Math.floor(e.visibleBottom/t.rowHeight))}};e.prototype.getMaterializedRange=function(){var e=this.getVisibleRange(),t=this.viewport,i=this.getSettings(),o=Math.ceil(t.height/i.rowHeight),r=Math.max(3*o,4),n=Math.max(5*o,4);return{start:Math.max(0,e.start-r),end:Math.min(this._itemSet.peek().content.peek().items.length-1,e.end+n)}};e.prototype.evaluateLayout=function(e){var t=this,i=this._itemSet.peek().schema.peek();if(e||Math.round(this.viewport.width)!==Math.round(this._lastViewportWidth)||this._lastColumnCount!==i.length){this._lastColumnCount=i.length;this._lastViewportWidth=this.viewport.width;this.cellLocations(this.calculateCellLocations(i.filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})))}return!0};e.prototype.calculateCellLocations=function(e){var t,i,o,r=[],n=0,a=this.viewport,s=this.getSettings(),l=a.width-2*s.outerPadding-this.rowCheckWidth.peek();for(i=0;i<e.length;i++){t=e[i];var d=0<i?s.innerPadding:0,c=t.minWidth||t.width;t.isCollapsable&&l<n+d+c?d=c=0:o=i;n+=c+d;r.push({left:0,width:c})}for(;n<l&&0<=o;){if(void 0!==(t=e[o]).minWidth){var u=l-n,p=Math.min(u,t.width-t.minWidth);r[o].width+=p;n+=p}o--}var m=this.rowCheckWidth.peek();for(i=0;i<e.length;i++){r[i].left=m;m+=r[i].width+s.innerPadding}return r};e.prototype.getCellCount=function(){return this._itemSet.peek().content.peek().items.length};e.prototype.getCellAt=function(e){var t=this._itemSet.peek().content.peek().items[e],i=t?s.default.tagName:null,o=this.getSettings();return{key:t?t.peek().key:"item-"+e,item:t,index:e,cellIndex:e,viewType:i,viewData:{item:t,itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations,onInvoke:this.onRowInvoke},left:o.outerPadding,top:o.rowHeight*e,width:this.viewport.width-2*o.outerPadding,height:o.rowHeight}};e.prototype.onRowInvoke=function(e){return!0};e.prototype.getCellByKey=function(e){for(var t,i=this._itemSet.peek().content.peek().items,o=0;o<i.length;o++){var r=n.utils.unwrapObservable(i[o]);if(r&&r.key===e){t=this.getCellAt(o);break}}return t};e.prototype.getItemIndexAbove=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e-1))};e.prototype.getItemIndexBelow=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e+1))};e.prototype.getItemIndexLeft=function(e){return e};e.prototype.getItemIndexRight=function(e){return e};e.prototype.getItemIndicesInRegion=function(e){var t=[],i=this.getSurfaceSize();if(e.x+e.width>this.getSettings().outerPadding&&e.x<i.width-this.getSettings().outerPadding&&0<e.y+e.height&&e.y<i.height)for(var o=this.getSettings(),r=Math.max(0,Math.floor(e.y/o.rowHeight)),n=Math.min(this._itemSet().content().items.length-1,Math.floor((e.y+e.height)/o.rowHeight)),a=r;a<=n;a++)t.push(a);return t};e.prototype.getToggleClass=function(){return"DetailsRow-check"};e.prototype.supportsLazyBinding=function(){return!0};return e}(i.default);t.default=d});define("odsp-next/controls/detailsRow/DetailsRow",["require","exports","knockout","./DetailsRowViewModel","./DetailsRow.html","./DetailsRow.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={tagName:"ms-details-row",template:e("./DetailsRow.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};i.components.isRegistered(r.tagName)||i.components.register(r.tagName,r);t.default=r});define("odsp-next/controls/detailsRow/DetailsRowViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../fieldRender/FieldRenderManager","../dragAndDrop/DropHelper","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/locale/Locale","../../controls/list/react/SelectionManager","../../bindings/keyboard/KeyboardBinding","../../bindings/customRender/CustomRenderBinding","../../bindings/dragAndDrop/DragAndDropBinding","../fieldRender/FieldRender.resx","./DetailsRowRenderer","../../bindings/focus/DelayedHasFocusBinding","../../bindings/element/ElementBinding","../../bindings/longTap/LongTapBinding","../../dataSources/base/AriaHelper","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../bindings/teachingBubble/TeachingBubbleBinding","../../utilities/selection/SelectionHelper"],function(e,t,i,l,o,r,d,c,u,n,p,m,h,f,a,g,b,v,y,x,_,I,S,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e)||this;i.draggable=!0;i.isBasePage=!1;i.isSelected=l.observable(!1);i.focusState=i.createObservable(0);i.isFocused=i.createPureComputed(function(){return!!i.focusState()});i.isDroppingTarget=l.observable(!1);i.targetDropped=l.observable(!1);i.selectionModel=i.resources.consume(c.itemsSelection);i._selectionHelper=i.resources.consume(T.resourceKey);i.ignoreClickTime=l.observable(0);i.isReceivingDrop=l.observable(!1);i._isSelectionModal=i.resources.consume(p.isSelectionModalResourceKey);i._platform=i.resources.consume(I.platformDetection);i._fieldRenderers={};i.item=i.resources.expose(c.currentItem,e.item);i._instrumentationProvider=i.resources.consume(u.instrumentation);var o=e.itemSet.peek().schema;i.columns=i.createComputed(function(){return o().filter(function(e){return e.isVisible&&!i._platform.isMobile||i._platform.isMobile&&e.isVisibleMobile})});i._cellLocations=e.cellLocations;i._onInvoke=e.onInvoke;i._dropHelper=i.resources.consume(d.resourceKey);i.longestRenderedCells=e.longestRenderedCells;var r=i.resources.consume(c.actionMap);i._action=new(i.child(r.DefaultClickAction))({item:i.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"});i.isDroppable=i.createComputed(function(){return i.item().isDropEnabled&&!i.isSelected()});i.isMobile=i._platform.isMobile;i.isCheckVisible=i.createComputed(function(){return i._isSelectionModal()||0<i.selectionModel.selection().length});i._currentFocusColumnIndex=l.observable(-1);i._createFocusObservables();i.subscribe(i._currentFocusColumnIndex,function(e){0<=e&&0<i.columns.peek().length&&i.focusedObservables[e](!1)},!0);i.subscribe(i._currentFocusColumnIndex,function(e){0<=e&&0<i.columns.peek().length&&i.focusedObservables[e](!0)});i._itemKey=i.createComputed(function(){return i.item().key});i.subscribe(i._itemKey,function(){i._updateSelectionSubscription(i.item)});i._updateSelectionSubscription(i.item);i.tabindex=i.createPureComputed(function(){return i.selectionModel.focusedItem()===i.item?0:-1});i._rowRenderer=new g.default({rowViewModel:i,rootElement:t.element});i._rowRenderer.renderRow();i.subscribe(i.item,function(){i._rowRenderer.refreshRow()});i.subscribe(i._cellLocations,function(){i._rowRenderer.refreshRow()});i.subscribe(i.columns,function(){i._createFocusObservables();i._rowRenderer.refreshRow()});i.createComputed(function(){i.isReceivingDrop()&&i.isReceivingDrop(!1)}).extend({rateLimit:{timeout:167,method:"notifyWhenChangesStop"}});i.isSelectable=i.createComputed(i._computeIsSelectable);i.isInvokable=i.createComputed(i._computeIsInvokable);i.isMobileRow=i._platform.isMobile&&i.resources.isExposed(c.useMobileList)&&i.resources.consume(c.useMobileList);i.createBackgroundComputed(function(){var e=i.item();e&&!e.isPlaceholder&&i._instrumentationProvider.userSeeItem(e)});var n={dragAndDrop:f.default,keyboard:m.default,customRender:h.default,delayedHasFocus:b.default,longTap:y.default,teachingBubble:S.default,element:v.default};i.addBindingHandlers(n);var a=i.resources.consume(u.uploadTeachingBubble.optional);a&&(i.teachingBubbleOptions=a.getTeachingBubbleForKey(i.item.peek().key));return i}e.prototype.dispose=function(){s.prototype.dispose.call(this);this._updateSelectionSubscription(null)};e.prototype.activateBindings=function(){this._rowRenderer.activateBindings()};e.prototype.getCellFocusObservable=function(e){return this.focusedObservables[e]};e.prototype.getCellTabindex=function(e){var t=-1;this.focusedObservables[e]()&&(t=0);return t};e.prototype.getCellAriaLabel=function(e){return null};e.prototype.getDragData=function(){var e=this,t=this.item.peek(),i=null,o=this.selectionModel;t.isDraggable&&o.isItemSelected(this.item)&&(i={type:1,item:t,itemSet:o.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:o.selectedCount.peek(),resources:o.resources}});return i};e.prototype.onMayReceiveDrop=function(e){if(!this.isDroppable.peek())return null;var t=this.item&&this.item.peek&&this.item.peek();return!t||1!==e.type&&0!==e.type?null:{targetName:t.name}};e.prototype.onReceiveDrop=function(e){if(!this.isDroppable.peek())return!1;var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.targetDropped(!0);return t};e.prototype.onSelectableItemClick=function(e,t,i){var o=this.ignoreClickTime(),r=(new Date).getTime();if(o&&r-o<=1e3){i.stopPropagation();i.preventDefault();return!1}var n=t.columns.peek()[e];if(!this.isCheckVisible()&&"type"!==n.key)return t.onClick(n,i,!0);this.onItemCheckClick(t,i)};e.prototype.onItemCheckClick=function(e,t){var i=this.resources.consume(c.itemsSelection);if(t.shiftKey)i.selectToItem(this.item);else{i.toggleItemSelected(this.item);i.setItemFocus(this.item)}t.cancelBubble=!0;t.preventDefault();return!1};e.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)};e.prototype.getClass=function(e){return"DetailsRow-cell "+e.key};e.prototype.getStyle=function(e,t){var i=this._cellLocations()[t()];return i&&i.width?"width: "+i.width+"px; "+n.default.safeLeft+": "+i.left+"px;":"display: none"};e.prototype.getTextValue=function(e){var t=this.item(),i="";if(t&&e&&!e.isIcon){void 0===(i=t[e.key])&&(i=t.properties[e.key]);if(i&&e.fieldType===_.ColumnFieldType.User){for(var o="",r=0,n=Array.isArray(i)?i:[i];r<n.length;r++){o&&(o+=", ");o+=n[r].title}i=o}else i=void 0===i?"":Array.isArray(i)?i.join(", "):i}return i};e.prototype.getHtmlValue=function(e){return r.default.RenderFieldByType(this,this.item.peek(),e)};e.prototype.getEmptyAriaLabel=function(e){return e.isRequired?a.strings.RequiredEmptyFieldAriaLabel:a.strings.EmptyFieldAriaLabel};e.prototype.registerFieldRenderer=function(e,t){this._fieldRenderers[e]=t};e.prototype.getFieldRenderer=function(e){return this._fieldRenderers[e]};e.prototype.getItem=function(){return this.item};e.prototype.getRowAriaLabel=function(){return x.getRowAriaLabel(this.item())};e.prototype.getRowAriaSelected=function(){return this.isSelected().toString()};e.prototype.onClick=function(e,t,i){var o=this.ignoreClickTime.peek(),r=(new Date).getTime();if(o&&r-o<=50){t.stopPropagation();t.preventDefault();return!1}var n=e;if(!e||e===this&&this._platform.isMobile||"displayName"===n.key||"name"===n.key||n.fieldType===_.ColumnFieldType.Custom){if(this._action.isAvailable.peek()){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}}else if(i){var a=this.getFieldRenderer(n.key);a&&"function"==typeof a.onClick&&a.onClick(t,this.item,this.resources);t.stopPropagation();t.preventDefault();return!1}};e.prototype.onLongTap=function(e){if(!this.isCheckVisible()){this.ignoreClickTime((new Date).getTime());this.onItemCheckClick(this,e)}};e.prototype.onMouseDown=function(e,t){if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.selectionModel.isItemSelected(this.item)||this.selectionModel.clear();this.selectionModel.setItemSelected(this.item,!0);this.selectionModel.setItemFocus(this.item)}};e.prototype.onInvoke=function(e){if(!1!==this._onInvoke.call(this,e)&&this._action.isAvailable.peek()){this._action.execute(e);e.stopPropagation();e.preventDefault();return!1}};e.prototype.onEnter=function(e,t,i){return t.onClick(t.columns.peek()[e],i,!0)};e.prototype.onLeft=function(e){var t=Math.max(e._currentFocusColumnIndex()-1,0);e._currentFocusColumnIndex(t);return!1};e.prototype.onRight=function(e){var t=Math.min(e._currentFocusColumnIndex()+1,e.columns.peek().length-1);e._currentFocusColumnIndex(t);return!1};e.prototype.detailsRowOnRight=function(e){e._currentFocusColumnIndex(-1);e._currentFocusColumnIndex(0);return!1};e.prototype._computeIsSelectable=function(){return this.item()&&this.selectionModel.canSelectItem(this.item)};e.prototype._computeIsInvokable=function(){return this._action.isAvailable()};e.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{focusState:this.focusState,isSelected:this.isSelected,isFocused:this.createObservable(!1),onInvoke:function(e){return t.onInvoke(e)}}))};e.prototype._createFocusObservables=function(){this.focusedObservables=[];for(var e=0;e<this.columns.peek().length;e++)this.focusedObservables.push(l.observable(!1))};return e}(o.default);t.default=s});define("odsp-next/controls/fieldRender/FieldRenderManager",["require","exports","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","./FieldRenderer","./ComputedFieldRenderer","./CustomFieldRenderer","./FileSizeFieldRenderer","./nameField/NameFieldRenderer","./titleField/TitleFieldRenderer","./dateField/DateFieldRenderer","./sharedField/SharedFieldRenderer","./sharedWithField/SharedWithFieldRenderer","./dotDotDot/DotDotDotFieldRenderer","./userField/UserFieldRenderer","./FileTypeIconFieldRenderer","./tagField/TagFieldRenderer","./urlField/UrlFieldRenderer","./lookupField/LookupFieldRenderer","./taxonomyField/TaxonomyFieldRenderer","./attachmentsField/AttachmentsFieldRenderer","./activityField/ActivityFieldRenderer","./dataBarField/DataBarFieldRenderer","./rating/RatingFieldRenderer","./workflowField/WorkflowFieldRenderer","./like/LikeFieldRenderer","./ComplianceRecordFlagFieldRenderer"],function(e,t,s,l,d,c,u,p,m,h,f,g,b,v,y,x,_,I,S,T,w,C,k,F,M,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function o(){}o.RenderFieldByType=function(e,t,i){return o.GetFieldRenderer(e,i,t).renderField(t)};o.GetFieldRenderer=function(e,t,i){var o=null;if(null!=t.fieldRenderer&&t.fieldRenderer.isCacheable())return t.fieldRenderer;var r=window.SPClientTemplates;if(r){var n=r.TemplateManager;if(n){var a=n.c_templateOverrides;if(a&&a[t.internalName]&&a[t.internalName].View)return new c.default(t,e,a[t.internalName].View)}}switch(t.fieldType){case s.ColumnFieldType.Computed:o=new d.default(t).fieldRenderer();break;case s.ColumnFieldType.ComplianceRecordFlag:o=new R.default(t);break;case s.ColumnFieldType.FileSize:o=new u.default(t);break;case s.ColumnFieldType.Name:o=new p.default(t,e);break;case s.ColumnFieldType.Title:o=new m.default(t,e,i);break;case s.ColumnFieldType.Shared:o=new f.default(t,e);break;case s.ColumnFieldType.SharedWith:o=new g.default(t,e);break;case s.ColumnFieldType.DotDotDot:o=new b.default(t,e);break;case s.ColumnFieldType.User:o=new v.default(t,e);break;case s.ColumnFieldType.FileIcon:o=new y.default(t,e);break;case s.ColumnFieldType.DateTime:o=new h.default(t);break;case s.ColumnFieldType.Tag:o=new x.default(t,e);break;case s.ColumnFieldType.Hyperlink:o=new _.default(t,e);break;case s.ColumnFieldType.Image:o=new _.default(t,e,!0);break;case s.ColumnFieldType.Lookup:o=new I.default(t,e);break;case s.ColumnFieldType.Taxonomy:o=new S.default(t,e);break;case s.ColumnFieldType.Activity:o=new w.default(t,e);break;case s.ColumnFieldType.Attachments:o=new T.default(t,e);break;case s.ColumnFieldType.AverageRating:o=new k.default(t,e);break;case s.ColumnFieldType.WorkflowStatus:o=new F.default(t,e);break;case s.ColumnFieldType.ProgressBar:o=new C.default(t,e);break;case s.ColumnFieldType.RatedBy:case s.ColumnFieldType.Ratings:o=new k.default(t,e);break;case s.ColumnFieldType.Likes:case s.ColumnFieldType.LikedBy:o=new M.default(t,e);break;default:o=new l.default(t)}return o};return o}();t.default=i});define("odsp-next/controls/fieldRender/FieldRenderer",["require","exports","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._column=e;this._parentViewModel=t;this._key=this._column.key;this._isAutoHyperLink=e.isAutoHyperLink;this._parentViewModel&&this._parentViewModel.registerFieldRenderer&&this._parentViewModel.registerFieldRenderer(this._key,this)}e.prototype.isCacheable=function(){return!this._parentViewModel};e.prototype.renderField=function(e){var t;this._column.getValue&&(t=this._column.getValue(e));void 0===t&&(t=e[this._column.key]);void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);t=void 0===t?"":Array.isArray(t)?t.join(", "):t;if(!this._isAutoHyperLink&&!this._column.isAppendOnly&&t){t=i.default.encodeText(t);this._column.isNote&&t&&(t=t.replace(/\n/g,"<br>"))}return t};e.prototype._getThis=function(){return"$data.getFieldRenderer('"+this._key+"')"};e.prototype._getOnClick=function(){return"function(data, evt) { "+this._getThis()+".onClick(evt); }"};return e}();t.default=o});define("odsp-next/controls/fieldRender/ComputedFieldRenderer",["require","exports","tslib","./FieldRenderer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.fieldRenderer=function(){return new o.default(this._column)};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/CustomFieldRenderer",["require","exports","tslib","./FieldRenderer","../../resources/SPOResourceKeys"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t,i){var o=r.call(this,e,t)||this;o._jsCode=i;return o}e.prototype.renderField=function(e){var t={};t.CurrentItem=e.properties;var i=this._parentViewModel.resources.consume(n.listContext);if(i.rawListSchema&&i.rawListSchema.Field)for(var o=0;o<i.rawListSchema.Field.length;o++){var r=i.rawListSchema.Field[o];if(r.Name===this._column.internalName){t.CurrentFieldSchema=r;break}}try{return("string"==typeof this._jsCode?new Function("ctx",this._jsCode):this._jsCode)(t)}catch(e){0}};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/FileSizeFieldRenderer",["require","exports","tslib","./FieldRenderer","@ms/odsp-utilities/lib/string/DriveSpaceHelper"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.renderField=function(e){return r.default.getDisplayString(e.size,{ignoreZero:!0})};return e}(o.default);t.default=n});define("odsp-next/controls/fieldRender/nameField/NameFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../resources/DataSourceResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../dataSources/base/AriaHelper"],function(e,t,i,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,void 0)||this;i._urlDataSource=t.resources.consume(a.url);var o=t.resources.consume(l.platformDetection);i._useCustomColumn=o.isMobile&&t.resources.isExposed(s.useMobileList)&&t.resources.consume(s.useMobileList);return i}e.prototype.renderField=function(e){var t=r.prototype.renderField.call(this,e),i=n.default.encodeText(d.getNameFieldAriaLabelForItem(e)),o=this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0});return'<a tabindex="-1" aria-label="'+i+'" title="'+t+'" href="'+(o?n.default.encodeText(o):"#")+'" data-bind="event: {'+(this._useCustomColumn?"":"click: function(obj, ev) { return $data.onClick(null, ev); },mousedown: function(obj, ev) { return $data.onMouseDown(null, ev); }")+'}">'+t+"</a>"};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/titleField/TitleFieldRenderer",["require","exports","tslib","../FieldRenderer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){i.__extends(e,o);function e(e,t,i){return o.call(this,e,t)||this}e.prototype.renderField=function(e){var t=o.prototype.renderField.call(this,e);return'<a tabindex="-1" href="javascript: " title="'+t+'" data-bind="click: function(obj, ev) { return $data.onClick(null, ev); }">'+t+"</a>"};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/dateField/DateFieldRenderer",["require","exports","tslib","../FieldRenderer","./DateField.css"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(){return null!==r&&r.apply(this,arguments)||this}e.prototype.renderField=function(e){var t="<span>"+r.prototype.renderField.call(this,e)+"</span>",i=null;e.dateModifiedValue?i=e.dateModifiedValue:e.dateDeleted&&(i=e.dateDeleted);if(i&&"dateModified"===this._key){var o=new Date(i).getTime();o&&Math.abs(Date.now()-o)<=36e5&&(t='<span class="od-DateField--newItem">&#10033;<span>'+t)}return t};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/dateField/DateField.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DateField--newItem{color:#107c10;margin-right:3px}"}])});define("odsp-next/controls/fieldRender/sharedField/SharedFieldRenderer",["require","exports","tslib","../FieldRenderer","office-ui-fabric-react/lib/Styling","../FieldRender.css","./SharedField.css"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._column,i=e[t.key];i||(i=e.properties[t.key]);return i?'<i class="od-SharedField--shared '+r.getIconClassName("People")+'"></i><span>'+i+"</span>":""};return t}(o.default);t.default=n});define("odsp-next/controls/fieldRender/FieldRender.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRender{text-decoration:none;text-overflow:ellipsis;overflow:hidden}.od-FieldRender-display{cursor:pointer;white-space:nowrap}.od-FieldRender-icon{display:inline-block}[dir=ltr] .od-FieldRender-icon{margin-right:6px}[dir=rtl] .od-FieldRender-icon{margin-left:6px}.od-FieldRender-location:hover,.od-FieldRender-person:hover,.od-FieldRender-sharedWith:hover{cursor:pointer;text-decoration:underline}.od--isNonMobile .DetailsRow .od-FieldRender-dot{visibility:hidden;padding:0 10px}[dir=ltr] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-left:-10px}[dir=rtl] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-right:-10px}.od--isNonMobile .DetailsRow .od-FieldRender-dot:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od--isNonMobile .DetailsRow .od-FieldRender-dot .ms-Icon--More{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od--isNonMobile .DetailsRow .DetailsRow-cell:focus .od-FieldRender-dot,.od--isNonMobile .DetailsRow:hover .od-FieldRender-dot{visibility:visible}"}])});define("odsp-next/controls/fieldRender/sharedField/SharedField.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"}])});define("odsp-next/controls/fieldRender/sharedWithField/SharedWithFieldRenderer",["require","exports","tslib","../FieldRenderer","./SharedWithFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../FieldRender.css"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this.sharedWithViewModel=new(this._parentViewModel.resources.injected(n.default))({item:e}),i=t.sharingString,o=t.imageClass,r=a.default.encodeText(t.imageAlt);return'<div class="od-FieldRender" href="javascript: " title="'+r+'" data-bind="click: '+this._getOnClick()+'"><span class="od-FieldRender-icon"><i class="'+o+'" alt="'+r+'"></i></span><span class="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock">'+i+"</span></div>"};t.prototype.onClick=function(e){this.sharedWithViewModel.onClick(e)};return t}(o.default);t.default=r});define("odsp-next/controls/fieldRender/sharedWithField/SharedWithFieldViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../FieldRender.resx","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/modules/Modules","office-ui-fabric-react/lib/Styling"],function(r,e,t,n,a,s,i,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(e){var t,i=o.call(this,e)||this;i._item=e.item;if(Number(i._item.properties.PrincipalCount)<1){i.imageClass=d.getIconClassName("Lock");i.imageAlt=a.strings.SharedWithNoneIcon;t=a.strings.SharedWithNone_Short}else{i.imageClass=d.getIconClassName("People");i.imageAlt=a.strings.SharedWithSomeIcon;t=a.strings.SharingHintShared_Short}i.sharingString=s.default.encodeText(t);return i}e.prototype.onClick=function(t){var i=this;this.trackPromise(l.loadModule({path:"../../../actions/ShowPropertiesAction",getModule:function(){return new n.default(function(e,t){r(["../../../actions/ShowPropertiesAction"],e,t)})}})).done(function(e){new(i.resources.injected(e))({useToggleBehavior:!1,isSharingSectionExpanded:!0}).execute(t)})};return e}(i.default);e.default=o});define("odsp-next/controls/fieldRender/dotDotDot/DotDotDotFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./DotDotDotViewModel","office-ui-fabric-react/lib/Styling","./DotDotDot.css"],function(e,t,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.dotDotDotViewModel=new(this._parentViewModel.resources.injected(n.default))({item:o.observable(e)});return'<div class="od-FieldRender-dot" data-bind="click: '+this._getOnClick()+'"><i class="'+a.getIconClassName("More")+'"></i></div>'};t.prototype.onClick=function(e){this.dotDotDotViewModel.onDotDotDotClicked(null,e)};return t}(r.default);t.default=s});define("odsp-next/controls/fieldRender/dotDotDot/DotDotDotViewModel",["require","exports","tslib","../textField/TextFieldViewModel","../../../providers/engagement/Engagement"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.onDotDotDotClicked=function(e,t){var i=document.createEvent("CustomEvent");i.initCustomEvent("contextmenu",!0,!0,t);t.currentTarget.dispatchEvent(i);this.resources.consume(r.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0})};return e}(o.default);t.default=n});define("odsp-next/controls/fieldRender/textField/TextFieldViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._parent=null;t._parent=e.parent;return t}e.prototype.getTextValue=function(e){return this._parent.getTextValue(e)};return e}(i.default);t.default=r});define("odsp-next/controls/fieldRender/dotDotDot/DotDotDot.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-callout{display:inline-block;cursor:pointer}.ms-callout-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("odsp-next/controls/fieldRender/userField/UserFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./UserFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../utilities/features/Features","../FieldRender.css"],function(e,t,i,l,o,d,c,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.userFieldViewModel=new(this._parentViewModel.resources.injected(d.default))({item:l.observable(e),column:this._column});var t=this.userFieldViewModel.users.peek();if(!t)return"";for(var i="",o=0,r=0,n=t;r<n.length;r++){var a=n[r],s=c.default.encodeText(a.title);i+='<div class="od-FieldRender" aria-label="'+c.default.encodeText(this.userFieldViewModel.getAriaLabel(s))+'"><span class="'+this._getUserFieldClassNames()+'" data-bind="event: {click: '+this._getOnClickHandler(o)+",clickBubble: false,mousemove: "+this._getOnMouseMovedHandler(o)+",mouseout: "+this._getOnHoverEndedHandler()+"},element: "+this._getElementBinding()+'">'+s+"</span></div>";o++}return i};t.prototype.onClick=function(e,t){t="number"==typeof t?t:0;this.userFieldViewModel.launchPersonaCard(e,t)};t.prototype.mouseMoved=function(e,t){this.userFieldViewModel.launchPersonaCardAfterDelay(e,t)};t.prototype.hoverEnded=function(){this.userFieldViewModel.cancelDelayedPersonaCardLaunch()};t.prototype._getOnClickHandler=function(e){return"function(data, evt) { "+this._getThis()+".onClick(evt, "+e+"); }"};t.prototype._getOnMouseMovedHandler=function(e){return"function(data, evt) { "+this._getThis()+".mouseMoved(evt, "+e+"); }"};t.prototype._getOnHoverEndedHandler=function(){return"function(data, evt) { "+this._getThis()+".hoverEnded(); }"};t.prototype._getElementBinding=function(){return this._getThis()+".userFieldViewModel.fieldElement"};t.prototype._getUserFieldClassNames=function(){var e="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock";(r.isFeatureEnabled(r.PeopleCardsOnLoki)||r.isFeatureEnabled(r.PeopleCardsReactComponent))&&(e+=" od-FieldRender-person");return e};return t}(o.default);t.default=n});define("odsp-next/controls/fieldRender/userField/UserFieldViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/modules/Modules","../../../resources/ProviderResourceKeys","../../../resources/SPOResourceKeys","../../peopleCard/PeopleCardCommons","../../../utilities/features/Features"],function(d,e,t,c,u,i,p,m,h,r,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(l){t.__extends(e,l);function e(e){var i=l.call(this,e)||this,t=i.observables,o=e.item();i.item=t.create(o);i._column=e.column;i._peopleCardTimeoutId=-1;i._peopleCardDataTimeoutId=-1;i._profileProvider=i.resources.consume(m.profile.optional);i.fieldElement=t.create(null);i.users=t.createArray();var r=o.properties[i._column.key];if(r&&r.length){i.users(r);if(i._profileProvider){var n=r.map(function(e){return e.sip});i._profileProvider.personRendered(n)}}if(f.isFeatureEnabled(f.PeopleCardsReactComponent)){var a=i.users.peek()[0];if(a){var s=i.resources.consume(h.pageContext);i.createBackgroundComputed(function(){var t=i.fieldElement();t&&i.trackPromise(p.loadModule({path:"../../personaCard/PersonaCardLauncher",getModule:function(){return new c.default(function(e,t){d(["../../personaCard/PersonaCardLauncher"],e,t)})}}).then(function(e){e.personaRendered(t,a.sip||a.email,s);u.utils.domNodeDisposal.addDisposeCallback(t,function(){e.personaRemoved(t,a.sip||a.email,s)})}))})}}return i}e.prototype.getAriaLabel=function(e){return this._column.name+", "+e};e.prototype.launchPersonaCardAfterDelay=function(e,t){var i=this;void 0===t&&(t=0);var o=this.users.peek()[t];if(o){this._lastMouseMove=e;this._profileProvider&&-1===this._peopleCardDataTimeoutId&&(this._peopleCardDataTimeoutId=this.async.setTimeout(function(){return i._profileProvider.getPeopleCardData(o.email||o.userId||o.sip)},r.PEOPLE_CARD_DATA_PRELOAD_DELAY));-1===this._peopleCardTimeoutId&&(this._peopleCardTimeoutId=this.async.setTimeout(function(){return i.launchPersonaCard(null,t,!0)},r.PEOPLE_CARD_HOVER_DELAY))}};e.prototype.cancelDelayedPersonaCardLaunch=function(){this._lastMouseMove=null;this.async.clearTimeout(this._peopleCardTimeoutId);this.async.clearTimeout(this._peopleCardDataTimeoutId);this._peopleCardTimeoutId=-1;this._peopleCardDataTimeoutId=-1};e.prototype.launchPersonaCard=function(i,e,o){var r=this;void 0===i&&(i=null);void 0===e&&(e=0);void 0===o&&(o=!1);i=i||this._lastMouseMove;this.cancelDelayedPersonaCardLaunch();var n=this.users.peek()[e];n&&n.sip&&p.loadModule({path:"../../personaCard/PersonaCardLauncher",getModule:function(){return new c.default(function(e,t){d(["../../personaCard/PersonaCardLauncher"],e,t)})}}).then(function(e){var t={name:n.title,email:n.email,image:n.picture,sip:n.sip,userId:n.sip};new(r.managed(e))(t).show(i,o)})};return e}(i.default);e.default=o});define("odsp-next/controls/peopleCard/PeopleCardCommons",["require","exports","@ms/odsp-utilities/lib/navigation/AddressParser","./../../utilities/features/Features"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={edog:"ppe",msit:"msit",spdf:"df"};t.PEOPLE_CARD_HOVER_DELAY=300;t.PEOPLE_CARD_DATA_PRELOAD_DELAY=50;t.PEOPLE_CARD_HOVER_EVENT_NAME="mousemove";t.openNewTab=function(e){window.open(e,"_blank").opener=null};t.getLokiRegion=function(e){if(r.isFeatureEnabled(r.DebugWindow)){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var i=o.deserializeQuery(t);if(i.lokideployment)return i.lokideployment}return function(e){var t=e.farmLabel.toLowerCase().split("_",1)[0],i=n[t];"msit"===i&&r.isFeatureEnabled(r.PeopleCardsLokiDogfood)&&(i="df");return i}(e)}});define("odsp-next/controls/fieldRender/FileTypeIconFieldRenderer",["require","exports","tslib","knockout","./FieldRenderer","../fileTypeIcon/FileTypeIconViewModel","./iconField/IconFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/icons/IconSelector","../../resources/ControlResourceKeys","../../dataSources/base/AriaHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../fileTypeIcon/FileTypeIcon.css"],function(o,e,i,c,t,u,p,m,r,h,f,g){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._parentViewModel.resources,i=c.observable(e),o=t.consume(g.platformDetection).isMobile&&t.consume(h.useMobileList.optional),r={iconName:this._getIconName(e),iconUrl:this._getIconUrl(e,o),extension:e.extension,desiredSize:o?48:16,overlayType:p.default.getOverlayType(i),iconFieldAriaLabel:f.getIconFieldAriaLabelForItem(e),hoverText:p.default.getHoverText(i),onClick:p.default.getOnClick(i,t)};this.fileTypeIconViewModel=new(t.injected(u.default))(r);var n=this.fileTypeIconViewModel.onClick?"FileTypeIcon FileTypeIcon--clickable":"FileTypeIcon",a=this.fileTypeIconViewModel.overlayUrl,s=this.fileTypeIconViewModel.iconFieldAriaLabel.peek(),l=m.default.encodeText(s),d=this.fileTypeIconViewModel.size;return'<span class="'+n+'" title="'+m.default.encodeText(this.fileTypeIconViewModel.hoverText)+'"'+(s?' aria-label="'+l+'"':"")+' data-bind="click: '+this._getOnClick()+'" tabindex="-1"><img class="FileTypeIcon-icon" src="'+m.default.encodeText(this.fileTypeIconViewModel.iconUrl.peek()||"")+'"'+(s?' alt="'+l+'"':"")+' style="width: '+d+"; height: "+d+"; font-size: "+d+'" data-bind="attr: {src: '+this._getThis()+'.fileTypeIconViewModel.iconUrl}" />'+(a?'<img class="FileTypeIcon-overlay" src="'+m.default.encodeText(a)+'" />':"")+"</span>"};t.prototype.onClick=function(e){"function"==typeof this.fileTypeIconViewModel.onClick&&this.fileTypeIconViewModel.onClick(e)};t.prototype._getIconName=function(e){return e.state&&4===e.state.upload.status?r.genericFile:e.iconName};t.prototype._getIconUrl=function(e,t){var i="undefined"==typeof __webpack_public_path__?o.toUrl("odsp-media/images/loading/loadingSpinner.gif"):o("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");if(e.state)switch(e.state.upload.status){case 1:return i;default:return e.iconUrl}return e.iconUrl};return t}(t.default);e.default=n});define("odsp-next/controls/fieldRender/iconField/IconFieldViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../textField/TextFieldViewModel","../../fileTypeIcon/OverlayType","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../dataSources/base/AriaHelper","../../../utilities/complianceTag/ComplianceTagUtilities"],function(r,e,t,n,i,a,s,l,d,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){t.__extends(o,i);function o(e){var t=i.call(this,e)||this;t.item=e.item;t.iconFieldViewModelType=o;return t}o.getOverlayType=function(e){var t=e(),i=a.default.none,o=t.policyTip;if(o){var r=1==(1&o);2==(2&o)?i=a.default.block:r&&(i=a.default.notify)}else t.isViolation?i=a.default.block:t.properties.CheckedOutUserId?i=a.default.checkOut:t.state&&4===t.state.upload.status?i=a.default.notify:c.complianceRecordFlagValue(t)&&(i=a.default.record);return i};o.getHoverText=function(e){var t=e();return d.getTooltipText(t)};o.getOnClick=function(i,o){return 1&i().policyTip?function(t){l.Engagement.logData({name:"PolicyTip.LaunchFromListView"});s.loadModule({path:"../../../actions/PolicyTipAction",getModule:function(){return new n.default(function(e,t){r(["../../../actions/PolicyTipAction"],e,t)})}}).then(function(e){new(o.injected(e))({item:i}).execute(t)});return!1}:null};return o}(i.default);e.default=o});define("odsp-next/controls/fileTypeIcon/OverlayType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"}(i||(i={}));t.default=i});define("odsp-next/controls/fieldRender/tagField/TagFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../photos/Photos.resx","./TagField.css"],function(e,t,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e.childCount,i=n.format(n.pluralSelect(t,s.strings.photosCountSingular,s.strings.photosCount),t),o=e.folder,r=o&&o.covers[0];return'<div class="od-TagField"><div class="od-TagField-image">'+(r?'<img src="'+n.format(r.url,50,50)+'" alt="" />':"")+'</div><div class="od-TagField-name ms-font-m">'+a.default.encodeText(e.name)+'</div><div class="od-TagField-count"'+a.default.encodeText(i)+"</div></div>"};return t}(o.default);t.default=r});define("odsp-next/controls/fieldRender/tagField/TagField.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-TagField{height:54px;box-sizing:border-box;cursor:pointer}.od-TagField .od-TagField-image{width:50px;height:50px;background-color:rgba(0,0,0,.25)}html[dir=ltr] .od-TagField .od-TagField-image{float:left}html[dir=rtl] .od-TagField .od-TagField-image{float:right}.od-TagField .od-TagField-name{max-width:150px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle;height:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-TagField .od-TagField-name{margin-left:10px}[dir=rtl] .od-TagField .od-TagField-name{margin-right:10px}html[dir=ltr] .od-TagField .od-TagField-name{float:left}html[dir=rtl] .od-TagField .od-TagField-name{float:right}[dir=ltr] .od-TagField .od-TagField-name{margin-right:5px}[dir=rtl] .od-TagField .od-TagField-name{margin-left:5px}.od-TagField .od-TagField-count{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";font-weight:400;font-size:11px;font-weight:400;line-height:54px}"}])});define("odsp-next/controls/fieldRender/urlField/UrlFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/encoding/HtmlEncoding","./UrlField.css"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t,i){var o=r.call(this,e,t)||this;o._isPicture=!!i;o._url="";return o}e.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var i=e.properties[this._column.key+".desc"];i||(i=t);this._url=t;var o=n.default.encodeText(t),r=n.default.encodeText(i);return this._isPicture?'<div class="od-FieldRender-image"><img src="'+o+'" title="'+r+'" class="od-FieldRender-imageDisplay" data-bind="click: '+this._getOnClick()+',clickBubble: false"></a></div>':'<div class="od-FieldRender"><a class="od-FieldRender-display od-FieldRender-display--link" href="'+o+'" tabindex="-1" title="'+o+'" target="_blank" data-bind="click: '+this._getOnClick()+',clickBubble: false">'+r+"</a></div>"};e.prototype.onClick=function(e){e&&e.target&&this._url&&window.open(this._url,"_blank")};return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/urlField/UrlField.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}.DetailsRow-cell a.od-FieldRender-display,.DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell a.od-FieldRender-display:hover,.DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("odsp-next/controls/fieldRender/lookupField/LookupFieldRenderer",["require","exports","tslib","../FieldRenderer","./LookupFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._lookupFieldViewModel=new(this._parentViewModel.resources.injected(a.default))({item:e,column:this._column});var t=this._lookupFieldViewModel.lookups,i="";if("string"==typeof t)i=s.default.encodeText(t);else if(t)for(var o=0;o<t.length;o++){var r=t[o],n=s.default.encodeText(r.lookupValue);i+='<div class="od-FieldRender" aria-label="'+n+'"><span class="od-FieldRender-display od-FieldRender-display--link" data-bind="click: function (data, evt) { '+this._getThis()+".onClick(evt, "+o+'); },clickBubble: false">'+n+"</span></div>"}return i};t.prototype.onClick=function(e,t){this._lookupFieldViewModel.launchLookupDisplayForm(e,this._lookupFieldViewModel.lookups[t].lookupId)};return t}(o.default);t.default=r});define("odsp-next/controls/fieldRender/lookupField/LookupFieldViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../iFrameDialog/IFrameDialog.key","../../../bindings/component/ControlBinding"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._column=e.column;var i=e.item.properties[t._column.key];(i&&"string"==typeof i||Array.isArray(i)&&i.length)&&(t.lookups=i);return t}e.prototype.launchLookupDisplayForm=function(e,t){var i=this._column.dispFormUrl;i+="&ID=";i+=t;i+="&RootFolder=*&IsDlg=1";return this.resources.consume(r.resourceKey).requestDialog({title:"",size:"Large",control:s.toSpecification(a.default,{componentUrl:i,showInDialog:!0,heightOffset:.5})}).wait().then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(o.default);t.default=l});define("odsp-next/controls/iFrameDialog/IFrameDialog.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(i,e,t,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return r.loadModuleExport({path:"./IFrameDialog",getModule:function(){return new t.default(function(e,t){i(["./IFrameDialog"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("odsp-next/controls/fieldRender/taxonomyField/TaxonomyFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./TaxonomyFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,i,a,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._taxonomyFieldViewModel=new(this._parentViewModel.resources.injected(s.default))({item:a.observable(e),column:this._column});for(var t="",i=0,o=this._taxonomyFieldViewModel.terms();i<o.length;i++){var r=o[i],n=l.default.encodeText(r.Label);t+='<div class="od-UserField" aria-label="'+n+'"><span class="ms-noWrap ms-imnSpan ms-displayInlineBlock">'+n+"</span></div>"}return t};return t}(o.default);t.default=r});define("odsp-next/controls/fieldRender/taxonomyField/TaxonomyFieldViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.item();t.item=n.observable(i);t._column=e.column;t.terms=n.observableArray(null);var o=i.properties[t._column.key];!o||o instanceof Array||""===o||(o=[{Label:o.Label,TermID:o.TermID}]);o&&0<o.length&&t.terms(o);return t}return e}(o.default);t.default=r});define("odsp-next/controls/fieldRender/attachmentsField/AttachmentsFieldRenderer",["require","exports","tslib","../FieldRenderer","office-ui-fabric-react/lib/Styling","./AttachmentsField.css"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(){return null!==t&&t.apply(this,arguments)||this}e.prototype.renderField=function(e){return'<div class="ms-Attachment-icon">'+("1"===t.prototype.renderField.call(this,e)?'<span class="'+r.getIconClassName("Attach")+'"></span>':"")+"</div>"};return e}(o.default);t.default=n});define("odsp-next/controls/fieldRender/attachmentsField/AttachmentsField.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Attachment-icon{font-size:16px;vertical-align:bottom;padding:0;border:0;width:30px;height:30px}"}])});define("odsp-next/controls/fieldRender/activityField/ActivityFieldRenderer",["require","exports","tslib","../FieldRenderer"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e[this._column.key];void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);return t=void 0===t?"":Array.isArray(t)?t.join(", "):t};return t}(o.default);t.default=r});define("odsp-next/controls/fieldRender/dataBarField/DataBarFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","../../progress/bar/ProgressBarViewModel","./DataBarField.resx","../../progress/bar/ProgressBar.css"],function(e,t,o,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){o.__extends(e,i);function e(e,t){return i.call(this,e,t)||this}e.prototype.renderField=function(e){if(!e.properties||!e.properties.progress)return"";this.viewModel=new(this._parentViewModel.resources.injected(n.default))({progress:e.properties.progress});var t=this._getThis(),i=t+".getTitle()";return'<div class="ProgressBar-listview-track" data-bind="attr: {\'aria-label\': '+i+",'title': "+i+'}"><div class="ProgressBar-listview-value" data-bind="style: {width: '+t+".viewModel.percentage() + '%'}\"></div></div>"};e.prototype.getTitle=function(){return r.format(r.getLocalizedCountValue(a.strings.ViewsText,a.strings.ViewsTextIntervals,this.viewModel.current()),this.viewModel.current())};return e}(i.default);t.default=s});define("odsp-next/controls/progress/bar/ProgressBarViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(u){i.__extends(e,u);function e(e){var t=u.call(this,e)||this,i=e.progress,o=i.minimum,r=void 0===o?t.createObservable(0):o,n=i.maximum,a=void 0===n?t.createObservable(0):n,s=i.current,l=void 0===s?t.createObservable(0):s,d=e.description,c=void 0===d?t.createObservable(""):d;t.minimum=r;t.maximum=a;t.current=l;t.description=c;t.size=t.createPureComputed(t._computeSize);t.value=t.createPureComputed(t._computeValue);t.percentage=t.createPureComputed(t._computePercentage);t.normalizedPercentage=t.createPureComputed(t._computeNormalizedPercentage);return t}e.prototype._computeSize=function(){return this.maximum()-this.minimum()};e.prototype._computeValue=function(){return this.current()-this.minimum()};e.prototype._computePercentage=function(){return 0===this.size()?0:this.value()/this.size()*100};e.prototype._computeNormalizedPercentage=function(){var e=this.percentage();return 100<e?1e4/e:e};return e}(o.default);t.default=r});define("odsp-next/controls/progress/bar/ProgressBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ProgressBar-track{height:2px;position:relative;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ProgressBar-track .ProgressBar-value--under{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .ProgressBar-track .ProgressBar-value--under{left:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--under{right:0}.ProgressBar-track .ProgressBar-value--exceeded{background-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{border-left:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{border-right:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{float:right}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{float:left}[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{right:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{left:0}.ProgressBar-listview-track{height:100%}.ProgressBar-listview-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";transition:width 267ms cubic-bezier(.1,.9,.2,1)}.ProgressBar-value{position:absolute;top:0;bottom:0;transition:width 267ms cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/fieldRender/rating/RatingFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/DataSourceResourceKeys","../../../providers/item/ItemProvider","../FieldRender.resx","../../../resources/SPOResourceKeys","office-ui-fabric-react/lib/Styling","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","./Rating.css"],function(e,t,i,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._ratingDataSource=i._parentViewModel.resources.consume(n.rating);i._itemProvider=i._parentViewModel.resources.consume(a.resourceKey);i._pageContext=i._parentViewModel.resources.consume(l.pageContext);i.onMouseover=function(e){return i._highlightStars(e,!1)};i.onMouseout=function(e){return i._highlightStars(e,!0)};return i}e.prototype.renderField=function(e){this._listItem=e;var t=!c.isCheckedOutByOther(e,this._pageContext.userId);this._rateBylength=e.reputationProperties.RatedBy?e.reputationProperties.RatedBy.length:0;this._averageRating=parseFloat(e.reputationProperties.AverageRating);for(var i='<a tabindex="0">',o=0;o<5;o++){var r="od-Rating-star"+(this._averageRating>=o+1?"Full":this._averageRating>o?"Half":"Empty")+" "+d.getIconClassName("FavoriteStarFill");i+='<div tabindex="0" id="'+o+'" title="" class="'+(r+=t?" od-Rating-enabled":"")+'" ';i+=t?'data-bind="\nclick: '+this._getOnClick()+",\nevent: {\n    mouseover: function(data, evt){"+this._getThis()+".onMouseover(evt)},\n    mouseout: function(data, evt){"+this._getThis()+'.onMouseout(evt)}\n}"':"";i+="></div>"}return i+='</a><span tabindex="0" title="'+s.strings.RatedByCountTitle+'" class="od-Rating-count">'+this._rateBylength+"</span>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.target;this._averageRating=this.computeAverageRating(Number(this._selectedStarid)+1);this._highlightStars(e,!0);this.setRating(e,Number(t.id)+1)}e.cancelBubble=!0;e.preventDefault()};e.prototype._highlightStars=function(e,t){if(e&&e.target){var i=e.target,o=i.parentElement.children,r=t?"od-Rating-starFull":"od-Rating-starHover";this._selectedStarid=Number(i.id);var n=this._averageRating,a=t?n-1:this._selectedStarid;o[this._selectedStarid].setAttribute("title",this.getElementTitle());o[this._selectedStarid].setAttribute("aria-label",this.getAriaLabel());for(var s=0;s<5;s++)o[s].className=(s<=a?r:"od-Rating-starEmpty")+" "+d.getIconClassName("FavoriteStarFill");var l=o[Math.floor(n)];t&&n&&n%1&&l&&(l.className="od-Rating-starHalf "+d.getIconClassName("FavoriteStarFill"))}};e.prototype.setRating=function(e,t){var i=this,o={item:this._listItem,rating:t};return this._ratingDataSource.setRating(o).then(function(e){isNaN(e)||(i._averageRating=e);return i._itemProvider.invalidateItem(i._listItem.parentKey,{triggerFetch:!0})})};e.prototype.rated=function(){for(var e=this._listItem.reputationProperties,t=e.Ratings.split(","),i=e.RatedBy||[],o=0;o<i.length;o++)if(Number(i[o].id)===this._pageContext.userId)return Number(t[o]);return-1};e.prototype.getElementTitle=function(){var e=this.rated();return-1!==e?r.format(s.strings.ModifyRatingTitle,e):r.format(s.strings.ApplyRatingTitle,Number(this._selectedStarid)+1)};e.prototype.getAriaLabel=function(){var e=this.rated(),t=0<this._averageRating?r.format(r.pluralSelect(this._averageRating,s.strings.AverageRatingAriaLabel,s.strings.AverageRatingPluralAriaLabel),this._averageRating):"";t+=-1!==e?r.format(s.strings.ModifyRatingTitle,e):"";return t+=r.format(s.strings.ApplyRatingTitle,Number(this._selectedStarid)+1)};e.prototype.computeAverageRating=function(e){var t=this._averageRating||0,i=this._rateBylength;return-1!==this.rated()&&0!==i?(t*i-this.rated()+e)/i:(t*i+e)/(i+1)};return e}(o.default);t.default=u});define("odsp-next/controls/fieldRender/rating/Rating.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".DetailsRow-cell.AverageRating{overflow:visible}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{width:16px;text-align:center;vertical-align:top;height:36px;position:relative;top:1px;cursor:pointer}.od-Rating-starEmpty:after,.od-Rating-starEmpty:before,.od-Rating-starFull:after,.od-Rating-starFull:before,.od-Rating-starHalf:after,.od-Rating-starHalf:before,.od-Rating-starHover:after,.od-Rating-starHover:before{vertical-align:top;position:relative;top:10px}.od-Rating-enabled.od-Rating-starHalf:focus,.od-Rating-starEmpty.od-Rating-enabled:focus,.od-Rating-starFull.od-Rating-enabled:focus,.od-Rating-starHalf.od-Rating-enabled:focus,.od-Rating-starHover.od-Rating-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-Rating-enabled.od-Rating-starHalf:active,.od-Rating-starEmpty.od-Rating-enabled:active,.od-Rating-starFull.od-Rating-enabled:active,.od-Rating-starHalf.od-Rating-enabled:active,.od-Rating-starHover.od-Rating-enabled:active{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Rating-starFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-Rating-starEmpty,.od-Rating-starHalf{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";position:relative}@media screen and (-ms-high-contrast:active){.ms-Icon.ms-Icon--FavoriteStarFill.od-Rating-starHalf:before,.od-Rating-starEmpty.ms-Icon.ms-Icon--FavoriteStarFill:before{content:'\\E734'}}.od-Rating-starHalf:after{font-family:FabricMDL2Icons;content:'\\E735';width:40%;overflow:hidden;position:absolute;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-Rating-starHalf:after{left:2px}[dir=rtl] .od-Rating-starHalf:after{right:2px}.od-Rating-starHover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Rating-count{display:inline-block;vertical-align:top;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;line-height:36px}[dir=ltr] .od-Rating-count{margin-left:8px}[dir=rtl] .od-Rating-count{margin-right:8px}"}])});define("odsp-next/controls/fieldRender/workflowField/WorkflowFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/encoding/HtmlEncoding","./WorkflowFieldRenderer.css"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._navigation=t.resources.consume(r.navigation);return i}e.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var i=this._getWorkflowStatusUrlAndDisplay(t),o=n.default.encodeText(i.url),r=n.default.encodeText(i.display);return'<a class="ms-workflowStatus--linkText" href="'+o+'" title="'+o+'" target="_blank" data-bind="click: '+this._getOnClick()+', clickBubble: false">'+r+"</a>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,i=null;"A"===t.tagName?i=t.href:"IMG"===t.tagName&&(i=t.src);this._navigation.navigateTo(i)}};e.prototype._getWorkflowStatusUrlAndDisplay=function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelector("a");return{url:i.href,display:i.innerHTML}};return e}(o.default);t.default=a});define("odsp-next/controls/fieldRender/workflowField/WorkflowFieldRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-workflowStatus--linkText>span{font-size:12px}"}])});define("odsp-next/controls/fieldRender/like/LikeFieldRenderer",["require","exports","tslib","../FieldRenderer","../../../resources/DataSourceResourceKeys","../../../providers/item/ItemProvider","../../../resources/SPOResourceKeys","../FieldRender.resx","office-ui-fabric-react/lib/Styling","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","./Like.css"],function(e,t,i,o,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._ratingDataSource=i._parentViewModel.resources.consume(r.rating);i._itemProvider=i._parentViewModel.resources.consume(n.resourceKey);i._pageContext=i._parentViewModel.resources.consume(a.pageContext);return i}e.prototype.renderField=function(e){this._listItem=e;this._likeCount=Number(this._listItem.properties.LikesCount)||0;this._isEnabled=!d.isCheckedOutByOther(e,this._pageContext.userId);return'\n<div class="od-Like" '+(this._isEnabled?'data-bind="click: '+this._getOnClick()+'"':"")+'>\n  <div class="'+this.getHeartClass()+'"></div>\n  <span class="od-Like-count">'+this._likeCount+'</span>\n  <span class="od-Like-text">'+s.strings.LikesCountText+"</span>\n</div>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,i=!this.isLiked();t.firstElementChild.className=this.getHeartClass();this.setLike(i);t.getElementsByClassName("od-Like-count")[0].innerHTML=String(this._likeCount+(i?1:-1))}e.cancelBubble=!0;e.preventDefault()};e.prototype.setLike=function(e){var t=this,i={item:this._listItem,like:e};return this._ratingDataSource.setLike(i).then(function(e){isNaN(e)||(t._likeCount=e);return t._itemProvider.invalidateItem(t._listItem.parentKey,{triggerFetch:!0})})};e.prototype.isLiked=function(){var t=this,e=this._listItem.reputationProperties.LikedBy;return e&&e.some(function(e){return Number(e.id)===t._pageContext.userId})};e.prototype.getHeartClass=function(){var e=this.isLiked()?"od-Like-heartFull "+l.getIconClassName("HeartFill"):"od-Like-heartEmpty "+l.getIconClassName("Heart");return e+=this._isEnabled?" od-Like-enabled":""};return e}(o.default);t.default=c});define("odsp-next/controls/fieldRender/like/Like.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Like{height:34px;line-height:34px;padding:0 8px;display:inline-block;position:relative;top:1px}.od-Like.od-Like-enabled:hover{cursor:pointer}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty,.od-Like.od-Like-enabled:hover .od-Like-heartFull{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty:before{content:'\\e16a'}.od-Like.od-Like-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-Like.is-disabled .od-Like-heartEmpty,.od-Like.is-disabled .od-Like-heartFull{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-Like.is-disabled .od-Like-count,.od-Like.is-disabled .od-Like-text{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-Like-heartEmpty,.od-Like-heartFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:16px}[dir=ltr] .od-Like-count{margin-left:8px}[dir=rtl] .od-Like-count{margin-right:8px}[dir=ltr] .od-Like-count{margin-right:4px}[dir=rtl] .od-Like-count{margin-left:4px}"}])});define("odsp-next/controls/fieldRender/ComplianceRecordFlagFieldRenderer",["require","exports","tslib","./FieldRenderer","../../utilities/complianceTag/ComplianceTagUtilities"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){return r.complianceRecordFlagValueAsYesNoString(e)};return t}(o.default);t.default=n});define("odsp-next/controls/detailsRow/DetailsRowRenderer",["require","exports","knockout","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._detailsRowViewModel=e.rowViewModel;this._rootElement=e.rootElement.getElementsByClassName("DetailsRow")[0];this._bindingsActive=!1}e.prototype.activateBindings=function(){if(!this._bindingsActive){h.applyBindingsToDescendants(this._detailsRowViewModel,this._rootElement);this._bindingsActive=!0}};e.prototype.refreshRow=function(){this.renderRow();this.activateBindings()};e.prototype.renderRow=function(){this._rootElement.innerHTML=this._getRowHtml();this._bindingsActive=!1};e.prototype._getCustomColumnHtmlValue=function(e){for(var t="",i=0,o=0,r=e;o<r.length;o++){var n=r[o];t+='<span class="DetailsRow-cellItem '+(i!==n.customRowNumber?"DetailsRow-cellItem--isLastRowItem":"")+'">'+this._detailsRowViewModel.getHtmlValue(n)+"</span>";i=n.customRowNumber}return t};e.prototype._getRowHtml=function(){for(var e=this._detailsRowViewModel.columns.peek(),t=!1,i=0,o=e;i<o.length;i++){if((l=o[i]).customFields){t=!0;break}}for(var r='<span role="{6}" class="{0}" {5} style="{1}" {2}data-bind="'+(t?"click: $data.onSelectableItemClick.bind($data, {3}), longTap: { callback: $data.onLongTap.bind($data) },":"")+'attr: { tabindex: $data.getCellTabindex({3}) }, hasFocus: $data.getCellFocusObservable({3}),keyboard: { mappings: { Enter: $data.onEnter.bind($data, {3}), Left: $data.onLeft.bind($data), Right: $data.onRight.bind($data) }}">{4}</span>',n=!this._detailsRowViewModel.isMobile||this._detailsRowViewModel.isCheckVisible?'<div class="DetailsRow-check" data-bind="click: onItemCheckClick"><div class="ItemCheck"><div class="ItemCheck-background"></div><div class="ItemCheck-check"></div></div></div>':"",a="",s=0;s<e.length;s++){var l=e[s],d=h.observable(s),c=this._detailsRowViewModel.getCellAriaLabel(d),u=this._detailsRowViewModel.getTextValue(l),p=this._detailsRowViewModel.getHtmlValue(l);if(l.canAutoResize&&this._detailsRowViewModel.longestRenderedCells&&u){var m=this._detailsRowViewModel.longestRenderedCells[l.internalName];(!m||m.text.length<u.length)&&(this._detailsRowViewModel.longestRenderedCells[l.internalName]={text:u,html:p})}a+=f.format(r,this._detailsRowViewModel.getClass(l),this._detailsRowViewModel.getStyle(l,d),c?'aria-label="'+g.default.encodeText(c)+'"':"",s,l.customFields?this._getCustomColumnHtmlValue(l.customFields):p,l.showTooltip?'title="'+g.default.encodeText(u)+'"':"",l.isRowHeader?"rowheader":"gridcell")}return n+'<span class="DetailsRow-columns">'+a+"<span>"};return e}();t.default=i});define("odsp-next/bindings/longTap/LongTapBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=e.valueAccessor();t._callback=i.callback;t._delay=i.delay||1e3;t.events.on(t.element,"mousedown",t._onTouchStart);t.events.on(t.element,"touchstart",t._onTouchStart);t.events.on(t.element,"mouseup",t._onTouchEnd);t.events.on(t.element,"touchend",t._onTouchEnd);return t}e.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=null}};e.prototype._onTouchStart=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onLongTap.bind(this,e),this._delay)};e.prototype._onTouchEnd=function(e){this._clearTimer()};e.prototype._onLongTap=function(e){this._timerID=null;this._callback&&this._callback(e)};return e}(o.default);t.default=r});define("odsp-next/controls/detailsRow/DetailsRow.html",[],function(){return"<div class=DetailsRow role=row data-bind=\"click: onClick, delayedHasFocus: { focusState: focusState }, css: { 'dropping': isDroppingTarget, 'is-selected': isSelected, 'is-focused': isFocused, 'is-checkVisible': isMobile && isCheckVisible, 'is-receivingDrop': isReceivingDrop, 'can-select': isSelectable, 'od-DetailsRow--isInvokable': isInvokable, 'od-DetailsRow--isMobile': isMobileRow }, attr: { tabindex: tabindex, 'aria-label': getRowAriaLabel(), 'aria-selected': getRowAriaSelected() }, keyboard: { mappings: { Right: detailsRowOnRight }, context: $data }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }, customRender: true, teachingBubble: teachingBubbleOptions\"></div>"});define("odsp-next/controls/detailsRow/DetailsRow.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".DetailsRow{overflow:hidden;height:100%;line-height:34px;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.DetailsRow.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsRow.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.DetailsRow.is-selected{background:#00c0ff}}.DetailsRow:focus{outline:1px solid transparent}.od--isNonMobile .DetailsRow.dropping,.od--isNonMobile .DetailsRow:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:";outline:1px solid transparent}.od--isNonMobile .DetailsRow:hover.can-select .DetailsRow-check,.od--isNonMobile .DetailsRow:hover.is-selected .DetailsRow-check{opacity:1}.od--isNonMobile .DetailsRow:hover.can-select{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od--isNonMobile .DetailsRow:hover.is-selected{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:"}.od-focus--enabled .DetailsRow.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsRow-check{display:inline-block;vertical-align:top;padding:7px 8px;opacity:0}.od-Browser--edge .DetailsRow-check,.od-Browser--ie .DetailsRow-check{padding:8px}.DetailsRow.is-checkVisible .DetailsRow-check,.DetailsRow.is-selected .DetailsRow-check{opacity:1}.DetailsRow.dropping .DetailsRow-cell.type .FileTypeIcon-icon{-ms-transform:scale(1.5,1.5);transform:scale(1.5,1.5)}.DetailsRow.is-receivingDrop .DetailsRow-cell.type .FileTypeIcon-icon{-ms-transform:scale(1.6,1.6);transform:scale(1.6,1.6);transition-duration:.1s;transition-timing-function:cubic-bezier(.075,.82,.165,1)}.od-DetailsRow--isMobile .DetailsRow-check{padding:14px 0 17px 8px}html[dir=rtl] .od-DetailsRow--isMobile .DetailsRow-check{padding:14px 8px 17px 0}.od-DetailsRow--isMobile .DetailsRow-check .ItemCheck{vertical-align:baseline}.DetailsRow-cell.type .FileTypeIcon-icon{transition:transform 267ms cubic-bezier(.075,.82,.165,1)}.DetailsRow-cell{cursor:default;padding:0 8px;display:inline-block;vertical-align:top;position:absolute;height:auto;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);outline:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12px;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsRow-cell.type{line-height:30px;overflow:visible}.DetailsRow-cell.type .FileTypeIcon{line-height:16px}.DetailsRow-cell>a,.DetailsRow-cell>a:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell>a:hover,.DetailsRow-cell>a:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.DetailsRow-cell:focus{outline:1px solid transparent}.DetailsRow-cell.custom a{font-size:17px;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.DetailsRow-cell.custom .ms-Icon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.DetailsRow-cell.custom .DetailsRow-cellItem{font-size:12px;line-height:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{float:left}html[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{float:right}[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-right:10px}[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-left:10px}.DetailsRow-cell.custom .DetailsRow-cellItem.DetailsRow-cellItem--isLastRowItem{clear:both}.od-focus--enabled .DetailsRow-cell:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsRow.is-checkVisible .DetailsRow-cell{padding:0}"}])});define("odsp-next/controls/list/layouts/MobileDetailsLayout",["require","exports","tslib","./DetailsLayout"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:15}};t.prototype.getHeaderCell=function(){return null};return t}(o.default);t.default=r});define("odsp-next/controls/detailsHeader/DetailsHeader",["require","exports","./DetailsHeaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DetailsHeader.html","./DetailsHeader.css","../itemCheck/ItemCheck"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"ms-details-header",template:e("./DetailsHeader.html"),viewModel:i.default,synchronous:!0});t.default=r});define("odsp-next/controls/detailsHeader/DetailsHeaderViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/PagesResourceKeys","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/locale/Locale","../../bindings/contextMenu/ContextMenuBinding","../../bindings/contextMenu/ContextMenuHelper","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/string/StringHelper","./DetailsHeader.resx","../../controls/list/react/SelectionManager","../../bindings/keyboard/KeyboardBinding","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../resources/LoggingResourceKeys"],function(u,e,t,n,a,p,s,i,o,m,h,l,f,d,c,g,b,v,y,x,_,I,S,T,w,C,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(i,r);function i(e){var t=r.call(this,e)||this;t.addBindingHandlers({keyboard:b.default});var i=e.itemSet,o=e.cellLocations;t.navigation=t.resources.consume(w.navigation);t.sortManager=t.resources.consume(s.sortManager);t._selectionModel=t.resources.consume(a.itemsSelection);t._isSelectionModal=t.resources.consume(g.isSelectionModalResourceKey);t._platform=t.resources.consume(C.platformDetection);t._urlDataSource=t.resources.consume(p.url);t._currentView=t.resources.isExposed(a.currentView)?t.resources.consume(a.currentView):n.observable(null);t._engagement=t.resources.consume(l.resourceKey);t._itemSet=i;t._cellLocations=o;t.isAllSelected=t._selectionModel.isAllSelected;t.isSelectionActive=t._selectionModel.isActive;t.isMobile=t._platform.isMobile;t._currentFocusColumnIndex=n.observable(-1);t.isItemCheckFocused=n.observable(!1);t.isFilterMenuFocused=n.observable(!1);t.columns=t.createPureComputed(t._computeColumns);t.isCheckVisible=t.createPureComputed(t._computeIsCheckVisible);t.isSelectAllAvailable=t.createPureComputed(t._computeIsSelectAllAvailable);t.checkBoxAriaLabel=t.createPureComputed(t._computeCheckBoxAriaLabel);t.subscribe(t._currentFocusColumnIndex,function(e){0<=e&&0<t.columns().length&&t.columns()[e].isFocused(!1)},!0);t.subscribe(t._currentFocusColumnIndex,function(e){0<=e&&0<t.columns().length&&t.columns()[e].isFocused(!0)});return t}i.prototype.dispose=function(){r.prototype.dispose.call(this);this.columns.dispose()};i.prototype.getStyle=function(e,t){var i=this._cellLocations()[t()];return i&&i.width?"width: "+i.width+"px; "+o.default.safeLeft+": "+i.left+"px;":"display: none"};i.prototype.getClass=function(e){return"DetailsHeader-cell "+e.key+(e.sortable?" isSortable":"")};i.prototype.getCellClass=function(e){return"cellContainer"+(e.filterable?" isFilterable":"")+(!e.isFocused||!e.isFocused()||e.filterable&&this.isFilterMenuFocused()?"":" is-focused")};i.prototype.getSortClass=function(e){return"cellSort"+(e.isSorted?" isSorted":"")+(e.isAscending?" isAscending":"")};i.prototype.getMenuClass=function(e){return"cellMenuLink"+(e.isFiltered()?" isFiltered":"")+(e.isFocused&&e.isFocused()&&this.isFilterMenuFocused()?" is-focused":"")};i.prototype.onClick=function(e,t){if(e.sortable){if(this.resources.isExposed(k.rumOneHelper)){this.resources.consume(k.rumOneHelper).logFilterSort("Sort")}if(e.internalName){var i=[f.capitalizeFirstLetter(e.internalName),"Header","Click"].join(".");this._engagement.logData({name:i,isIntentional:!0})}var o=e.internalName||e.key,r=e.isSorted?!e.isAscending:!e.sortDescFirst,n=new v.Action({name:"ColumnHeaderSort",pageType:x.default[this._urlDataSource.getPageType()],queryType:_.default[this._urlDataSource.getQueryType()]}),a={sortMode:e.isSorted?"Column":"Order",sortColumn:o,sortAscending:r?"Ascending":"Descending"};n.end({resultType:y.ResultTypeEnum.Success,extraData:a});this.sortManager.updateSort(o,r);t.stopPropagation();t.preventDefault();return!1}};i.prototype.onMenuClick=function(n,a){var s=this;if(n.filterable){var e=[f.capitalizeFirstLetter(n.name),"HeaderGlyph",f.ClickName].join(".");this._engagement.logData({name:e,isIntentional:!0,extraData:{action:f.capitalizeFirstLetter(a.type)}});var l=n.internalName||n.key,t=this.resources.consume(p.items),d=I.serializeQuery(this.navigation.viewParams),i=this._currentView&&this._currentView.peek(),o=i&&i.id,r=t.getFilterData(l,d,o),c=S.loadModule({path:"../../utilities/list/ListFilterHelperDeferred",getModule:function(){return new T.default(function(e,t){u(["../../utilities/list/ListFilterHelperDeferred"],e,t)})}});T.default.all({filterData:r,type:c}).then(function(e){var t=e.filterData,i=e.type,o=t?i.getFilterMenuItems(s.resources,n,t,d,l):[],r=new h.default({items:o,rootElementClass:"List",boundingElementClass:"Files-content"});m.default.createContextMenu(a,r,s)});a.stopPropagation();a.preventDefault();return!1}};i.prototype.toggleAllSelected=function(e,t){this._selectionModel.setIsActive(!0);this._selectionModel.toggleSelectAll();t.stopPropagation();t.preventDefault();return!1};i.prototype.onLeft=function(e){if(e.filterable&&this.isFilterMenuFocused())this.isFilterMenuFocused(!1);else{var t=this.getLeftFocusColumnIndex();this._currentFocusColumnIndex(t);-1===t&&this.isItemCheckFocused(!0);this.isFilterMenuFocused(!0)}return!1};i.prototype.onRight=function(e){if(!e.filterable||this.isFilterMenuFocused()){this.isFilterMenuFocused(!1);this._currentFocusColumnIndex(this.getRightFocusColumnIndex())}else this.isFilterMenuFocused(!0);return!1};i.prototype.onDown=function(e,t){if(e.filterable&&this.isFilterMenuFocused()){this.onMenuClick(e,t);return!1}};i.prototype.onEnter=function(e,t){e.filterable&&this.isFilterMenuFocused()?this.onMenuClick(e,t):this.onClick(e,t);return!1};i.prototype.headerContainerOnRight=function(){this.isItemCheckFocused(!0);this._currentFocusColumnIndex(-1);return!1};i.prototype.getColumnAriaSort=function(e){var t="none";e.isSorted&&(t=e.isAscending?i._ascendingAriaSort:i._descendingAriaSort);return t};i.prototype.getColumnFilterAriaLabel=function(e){var t=null;e.isFiltered()&&(t=d.format(c.strings.columnFilterAriaLabel,e.name,e.filterValues()));return t};i.prototype.getRightFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),i=e+1;i<t.length;i++)if(t[i].name){e=i;break}return e};i.prototype.getLeftFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),i=!1,o=e-1;0<=o;o--)if(t[o].name){e=o;i=!0;break}i||(e=-1);return e};i.prototype._computeIsSelectAllAvailable=function(){return 0===this._selectionModel.mode||0<this._selectionModel.selection().length};i.prototype._computeIsCheckVisible=function(){return!this._platform.isMobile||this._isSelectionModal()||0<this._selectionModel.selection().length};i.prototype._computeColumns=function(){var t=this;return this._itemSet().schema().filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})};i.prototype._computeCheckBoxAriaLabel=function(){return this._selectionModel.isAllSelected()?c.strings.deselectAllAriaLabel:c.strings.selectAllAriaLabel};i._ascendingAriaSort="ascending";i._descendingAriaSort="descending";return i}(i.default);e.default=r});define("odsp-next/controls/detailsHeader/DetailsHeader.html",[],function(){return"<div class=DetailsHeaderContainer data-bind=\"if: !isMobile\"><div class=DetailsHeader role=row tabindex=0 data-bind=\"keyboard: { mappings: { Right: $component.headerContainerOnRight.bind($component) }, context: $data }\">\x3c!--ko if: isCheckVisible--\x3e<ms-item-check class=DetailsHeader-check data-bind=\"click: $component.toggleAllSelected.bind($component), css: { 'can-select': isSelectAllAvailable, 'is-selected': isAllSelected, 'is-selection-active': isSelectionActive, 'is-focused': $data.isItemCheckFocused }, hasFocus: $data.isItemCheckFocused, keyboard: { mappings: { Enter: $component.toggleAllSelected.bind($component), Right: $component.onRight.bind($component) }, context: $data }, attr: { tabindex: $data.isItemCheckFocused() ? 0 : -1, 'aria-label': checkBoxAriaLabel }\"></ms-item-check>\x3c!--/ko--\x3e<div class=DetailsHeader-columns data-bind=\"foreach: columns\"><div role=columnheader data-bind=\"if: $data.name, class: $component.getClass($data), attr: { 'style': $component.getStyle($data, $index), 'aria-sort': $component.getColumnAriaSort($data), tabindex: $data.isFocused() ? 0 : -1 }, hasFocus: $data.isFocused, keyboard: { mappings: { Enter: $component.onEnter.bind($component), Space: $component.onEnter.bind($component), Left: $component.onLeft.bind($component), Right: $component.onRight.bind($component), Down: $component.onDown.bind($component) }, context: $data }\"><div data-bind=\"click: $component.onClick.bind($component), class: $component.getCellClass($data)\"><div class=cellBuffer><div data-bind=\"class: $component.getSortClass($data)\"></div><div class=cellText data-bind=\"text: $data.name\"></div></div></div>\x3c!--ko if: $data.filterable--\x3e<div data-bind=\"click: $component.onMenuClick.bind($component), class: $component.getMenuClass($data), attr: { 'aria-label': $component.getColumnFilterAriaLabel($data), role: $data.isFiltered()? 'button': null }\"></div>\x3c!--/ko--\x3e</div></div></div></div>"});define("odsp-next/controls/detailsHeader/DetailsHeader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'@charset "UTF-8";.DetailsHeader{overflow:hidden;height:30px;border-bottom:1px solid '},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.DetailsHeader:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check{position:absolute;z-index:1;display:inline-block;height:22px;padding:4px 8px;vertical-align:top}.DetailsHeader-check:hover .ItemCheck-background{display:inline-block}.DetailsHeader-check:hover .ItemCheck-check:after{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.DetailsHeader-check .ItemCheck-background{display:none}.DetailsHeader-check .ItemCheck-check{display:inline-block}.DetailsHeader-check .ItemCheck-check:after{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.DetailsHeader-check:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader-check.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check.can-select.is-selected:hover .ItemCheck-check:after{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.DetailsHeader-check.can-select.is-selected .ItemCheck-background{display:inline-block}.DetailsHeader-columns{position:absolute;left:0;right:0;height:30px;overflow:hidden;white-space:nowrap}.DetailsHeader-cell{display:inline-block;vertical-align:top;position:absolute;overflow:hidden;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";outline:0;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsHeader-cell.isSortable{cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}.DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.DetailsHeader-cell.isSortable:active{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:'}.DetailsHeader-cell .cellContainer{height:30px;display:inline-block;width:100%}.DetailsHeader-cell .cellContainer.isFilterable{width:calc(100% - 21px)}.DetailsHeader-cell .cellBuffer{position:relative;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellBuffer{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellBuffer{padding-right:4px}.DetailsHeader-cell .cellText{display:inline-block;font-size:11px;text-overflow:ellipsis;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellText{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellText{padding-right:4px}.DetailsHeader-cell .cellSort{display:none}[dir=ltr] .DetailsHeader-cell .cellSort{padding-left:2px}[dir=rtl] .DetailsHeader-cell .cellSort{padding-right:2px}.DetailsHeader-cell .cellSort.isSorted{display:inline-block}.DetailsHeader-cell .cellSort:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-size:10px}.DetailsHeader-cell .cellSort.isAscending:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.DetailsHeader-cell .cellMenuLink{position:absolute;top:0;height:30px;width:21px}[dir=ltr] .DetailsHeader-cell .cellMenuLink{right:0}[dir=rtl] .DetailsHeader-cell .cellMenuLink{left:0}.DetailsHeader-cell .cellMenuLink:after{position:relative;top:3px}[dir=ltr] .DetailsHeader-cell .cellMenuLink:after{left:2px}[dir=rtl] .DetailsHeader-cell .cellMenuLink:after{right:2px}.DetailsHeader-cell .cellMenuLink.isFiltered:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:900}.DetailsHeader-cell .cellMenuLink.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:' inset;outline:1px solid transparent}.DetailsHeader-cell.DetailsHeader-cell:focus .cellMenuLink:not(.isFiltered):after,.DetailsHeader-cell:hover .cellMenuLink:not(.isFiltered):after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.od-focus--enabled .DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px '},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}"}])});define("odsp-next/pages/files/od/Files.html",[],function(){return'<div class="od-Files od-Files-dragAndDrop" data-bind="dragAndDrop: dragAndDrop.getOptions, interactionScope: { isActive: isActive }">\x3c!--ko if: showMobileWebToAppUpsellV2()--\x3e<div class=od-files-mobileWebToAppUpsellV2 data-bind="react: mobileWebToAppUpsellV2"></div>\x3c!--/ko--\x3e\x3c!--ko if: showSmartBanner()--\x3e<div class=Files-smartBanner data-bind="component: { name: smartBannerTagName, params: { isVisible: isSmartBannerVisible, useODCAdjustLink: true } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: !!upsellComponent()--\x3e<div class=SetView-firstRunBanner data-bind="component: upsellComponent()"></div>\x3c!--/ko--\x3e\x3c!--ko with: guidedTourComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko control: contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !isEmptyView()--\x3e\x3c!--ko component: {\r\n name: listFooterTagName,\r\n params: {\r\n dragAndDropHintComponent: dragAndDropFooterHintComponent\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isInfoPaneExpanded() && !isOneUp()--\x3e\x3c!--ko component: { name: transclusionContentTagName, params: infoPaneTransclusionContentParams }--\x3e<div class=od-BasePage-infoPane data-bind="control: infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isOneUp--\x3e\x3c!--ko component: {\r\n name: oneUpOverlayTagName\r\n }--\x3e\x3c!--ko if: showUnauthBanner--\x3e<div class=od-Files-unauthBanner data-bind="component: unauthenticatedBannerTagName"></div>\x3c!--/ko--\x3e<div class=od-Files-oneUp data-bind="control: oneUpSpecification, css: { \'od-Files-OneUp--showUnauthBanner\': showUnauthBanner() && !isOneUpSlideshow() }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with: dragAndDrop.decorationComponent()--\x3e\x3c!--ko control: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with: firstRunComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/pages/files/od/Files.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".NotificationHost{z-index:295}.od-BasePage:not(.od-BasePage--hasSmartBanner) .Files-smartBanner{display:none}.Files-loadingBar{opacity:1}.SetView-firstRunBanner .FirstRunBanner--isContentLoaded{margin-top:20px}.md .SetView-firstRunBanner,.sm .SetView-firstRunBanner{display:none}.od-Files--isReceiving .Files-listView{box-shadow:inset 0 0 0 3px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-Files-dragAndDropHint{text-align:center;margin-top:33px;margin-bottom:24px}.od-Files-unauthBanner{position:absolute;top:0;left:0;right:0;height:50px}.od-Files-oneUp{position:absolute;top:0;left:0;right:0;bottom:0}.od-Files-oneUp.od-Files-OneUp--showUnauthBanner{top:50px}.od-Share{width:320px}.ms-ContextualMenu.ms-FocusZone.is-open{position:relative;border:none;box-shadow:0 0 3px 1px #d3d3d3;max-width:320px;width:auto}"}])});define("odsp-next/controls/list/SingleAlbumList",["require","exports","knockout","./viewModels/SingleAlbumListViewModel","./layouts/LayoutType","./List.html","./List.css","../itemTile/ItemTile"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:r.SingleAlbum,template:e("./List.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("odsp-next/controls/list/viewModels/SingleAlbumListViewModel",["require","exports","tslib","./ListViewModel","../layouts/SingleAlbumLayout"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.initialize(new(i.managed(r.default))(e));return i}return e}(o.default);t.default=n});define("odsp-next/controls/list/layouts/SingleAlbumLayout",["require","exports","tslib","./BaseGridLayout"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Small:130,Medium:130,Large:210,XLarge:300,XXLarge:300,XXXLarge:300,XXXXLarge:300},n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getInnerMargin=function(){return 12};t.prototype.getHeader=function(e,t,i){var o=null,r=t&&t.peek&&t.peek(),n=this.getGroup(i,r);if(n&&this.currentGroup!==n){this.nextGroup=n;var a=this.getHeaderDetails(n,i);0!==i||a.viewType||(a.headerHeight=0);var s=a.key?a.key:r?r.key+"_header":null;s&&(o={key:s,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:a.headerHeight,viewType:a.viewType,viewData:a.viewData})}return o};t.prototype.getGroup=function(e,t){var i,o=this._itemSet().content.peek().groupings||[];if(o&&o.length&&o[0].itemGroups)for(var r=0,n=o[0].itemGroups;r<n.length;r++){var a=n[r];if(a){var s=a.startIndex+a.count-1;if(a.startIndex<=e&&e<=s){i=a;break}}}return i};t.prototype.getMinRowHeight=function(){var e=this.responsiveHelper.formFactorSize();return this.currentGroup&&"folder"===this.currentGroup.groupingId?o.MinRowHeights.folder[e]:this.currentGroup&&"document"===this.currentGroup.groupingId?o.MinRowHeights.documents[e]:r[e]};t.prototype.getHeaderDetails=function(e,t){return{viewType:"",viewData:{},headerHeight:20}};return t}(o.default);t.default=n});define("odsp-next/pages/files/odc/ConsumerFiles.html",[],function(){return"\x3c!--ko component: {\r\n name: filesTagName,\r\n params: filesParams\r\n}--\x3e\x3c!--/ko--\x3e"});